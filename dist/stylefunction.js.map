{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./example/stylefunction.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/deref.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/compound_expression.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/array.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/assertion.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/at.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/case.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/coalesce.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/coercion.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/collator.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/equals.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/index.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/interpolate.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/length.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/let.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/literal.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/match.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/step.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/definitions/var.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/evaluation_context.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/index.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/is_constant.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/parsing_context.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/parsing_error.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/runtime_error.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/scope.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/stops.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/types.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/expression/values.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/feature_filter/index.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/function/convert.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/function/index.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/reference/latest.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/util/color.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/util/color_spaces.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/util/extend.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/util/get_type.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/util/interpolate.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/util/ref_properties.js","webpack:///./node_modules/@mapbox/mapbox-gl-style-spec/util/result.js","webpack:///./node_modules/@mapbox/unitbezier/index.js","webpack:///./node_modules/assert/assert.js","webpack:///./node_modules/ol/ol.css","webpack:///./node_modules/css-loader/lib/css-base.js","webpack:///./node_modules/csscolorparser/csscolorparser.js","webpack:///./node_modules/inherits/inherits_browser.js","webpack:///./node_modules/mapbox-to-css-font/index.js","webpack:///./node_modules/ol/AssertionError.js","webpack:///./node_modules/ol/Collection.js","webpack:///./node_modules/ol/CollectionEventType.js","webpack:///./node_modules/ol/Disposable.js","webpack:///./node_modules/ol/Feature.js","webpack:///./node_modules/ol/ImageBase.js","webpack:///./node_modules/ol/ImageCanvas.js","webpack:///./node_modules/ol/ImageState.js","webpack:///./node_modules/ol/Kinetic.js","webpack:///./node_modules/ol/LayerType.js","webpack:///./node_modules/ol/Map.js","webpack:///./node_modules/ol/MapBrowserEvent.js","webpack:///./node_modules/ol/MapBrowserEventHandler.js","webpack:///./node_modules/ol/MapBrowserEventType.js","webpack:///./node_modules/ol/MapBrowserPointerEvent.js","webpack:///./node_modules/ol/MapEvent.js","webpack:///./node_modules/ol/MapEventType.js","webpack:///./node_modules/ol/MapProperty.js","webpack:///./node_modules/ol/Object.js","webpack:///./node_modules/ol/ObjectEventType.js","webpack:///./node_modules/ol/Observable.js","webpack:///./node_modules/ol/PluggableMap.js","webpack:///./node_modules/ol/TileQueue.js","webpack:///./node_modules/ol/TileRange.js","webpack:///./node_modules/ol/TileState.js","webpack:///./node_modules/ol/View.js","webpack:///./node_modules/ol/ViewHint.js","webpack:///./node_modules/ol/ViewProperty.js","webpack:///./node_modules/ol/array.js","webpack:///./node_modules/ol/asserts.js","webpack:///./node_modules/ol/centerconstraint.js","webpack:///./node_modules/ol/color.js","webpack:///./node_modules/ol/colorlike.js","webpack:///./node_modules/ol/control/Attribution.js","webpack:///./node_modules/ol/control/Control.js","webpack:///./node_modules/ol/control/Rotate.js","webpack:///./node_modules/ol/control/Zoom.js","webpack:///./node_modules/ol/control/util.js","webpack:///./node_modules/ol/coordinate.js","webpack:///./node_modules/ol/css.js","webpack:///./node_modules/ol/dom.js","webpack:///./node_modules/ol/easing.js","webpack:///./node_modules/ol/events.js","webpack:///./node_modules/ol/events/Event.js","webpack:///./node_modules/ol/events/EventTarget.js","webpack:///./node_modules/ol/events/EventType.js","webpack:///./node_modules/ol/events/KeyCode.js","webpack:///./node_modules/ol/events/condition.js","webpack:///./node_modules/ol/extent.js","webpack:///./node_modules/ol/extent/Corner.js","webpack:///./node_modules/ol/extent/Relationship.js","webpack:///./node_modules/ol/featureloader.js","webpack:///./node_modules/ol/format/Feature.js","webpack:///./node_modules/ol/format/FormatType.js","webpack:///./node_modules/ol/format/GeoJSON.js","webpack:///./node_modules/ol/format/JSONFeature.js","webpack:///./node_modules/ol/functions.js","webpack:///./node_modules/ol/geom/Circle.js","webpack:///./node_modules/ol/geom/Geometry.js","webpack:///./node_modules/ol/geom/GeometryCollection.js","webpack:///./node_modules/ol/geom/GeometryLayout.js","webpack:///./node_modules/ol/geom/GeometryType.js","webpack:///./node_modules/ol/geom/LineString.js","webpack:///./node_modules/ol/geom/LinearRing.js","webpack:///./node_modules/ol/geom/MultiLineString.js","webpack:///./node_modules/ol/geom/MultiPoint.js","webpack:///./node_modules/ol/geom/MultiPolygon.js","webpack:///./node_modules/ol/geom/Point.js","webpack:///./node_modules/ol/geom/Polygon.js","webpack:///./node_modules/ol/geom/SimpleGeometry.js","webpack:///./node_modules/ol/geom/flat/area.js","webpack:///./node_modules/ol/geom/flat/center.js","webpack:///./node_modules/ol/geom/flat/closest.js","webpack:///./node_modules/ol/geom/flat/contains.js","webpack:///./node_modules/ol/geom/flat/deflate.js","webpack:///./node_modules/ol/geom/flat/inflate.js","webpack:///./node_modules/ol/geom/flat/interiorpoint.js","webpack:///./node_modules/ol/geom/flat/interpolate.js","webpack:///./node_modules/ol/geom/flat/intersectsextent.js","webpack:///./node_modules/ol/geom/flat/length.js","webpack:///./node_modules/ol/geom/flat/orient.js","webpack:///./node_modules/ol/geom/flat/reverse.js","webpack:///./node_modules/ol/geom/flat/segments.js","webpack:///./node_modules/ol/geom/flat/simplify.js","webpack:///./node_modules/ol/geom/flat/straightchunk.js","webpack:///./node_modules/ol/geom/flat/textpath.js","webpack:///./node_modules/ol/geom/flat/transform.js","webpack:///./node_modules/ol/has.js","webpack:///./node_modules/ol/index.js","webpack:///./node_modules/ol/interaction.js","webpack:///./node_modules/ol/interaction/DoubleClickZoom.js","webpack:///./node_modules/ol/interaction/DragAndDrop.js","webpack:///./node_modules/ol/interaction/DragBox.js","webpack:///./node_modules/ol/interaction/DragPan.js","webpack:///./node_modules/ol/interaction/DragRotate.js","webpack:///./node_modules/ol/interaction/DragRotateAndZoom.js","webpack:///./node_modules/ol/interaction/DragZoom.js","webpack:///./node_modules/ol/interaction/Draw.js","webpack:///./node_modules/ol/interaction/Extent.js","webpack:///./node_modules/ol/interaction/Interaction.js","webpack:///./node_modules/ol/interaction/KeyboardPan.js","webpack:///./node_modules/ol/interaction/KeyboardZoom.js","webpack:///./node_modules/ol/interaction/Modify.js","webpack:///./node_modules/ol/interaction/MouseWheelZoom.js","webpack:///./node_modules/ol/interaction/PinchRotate.js","webpack:///./node_modules/ol/interaction/PinchZoom.js","webpack:///./node_modules/ol/interaction/Pointer.js","webpack:///./node_modules/ol/interaction/Property.js","webpack:///./node_modules/ol/interaction/Select.js","webpack:///./node_modules/ol/interaction/Snap.js","webpack:///./node_modules/ol/interaction/Translate.js","webpack:///./node_modules/ol/layer/Base.js","webpack:///./node_modules/ol/layer/Group.js","webpack:///./node_modules/ol/layer/Layer.js","webpack:///./node_modules/ol/layer/Property.js","webpack:///./node_modules/ol/layer/Vector.js","webpack:///./node_modules/ol/layer/VectorRenderType.js","webpack:///./node_modules/ol/layer/VectorTileRenderType.js","webpack:///./node_modules/ol/loadingstrategy.js","webpack:///./node_modules/ol/math.js","webpack:///./node_modules/ol/obj.js","webpack:///./node_modules/ol/ol.css?f5a7","webpack:///./node_modules/ol/pointer/EventSource.js","webpack:///./node_modules/ol/pointer/EventType.js","webpack:///./node_modules/ol/pointer/MouseSource.js","webpack:///./node_modules/ol/pointer/MsSource.js","webpack:///./node_modules/ol/pointer/NativeSource.js","webpack:///./node_modules/ol/pointer/PointerEvent.js","webpack:///./node_modules/ol/pointer/PointerEventHandler.js","webpack:///./node_modules/ol/pointer/TouchSource.js","webpack:///./node_modules/ol/proj.js","webpack:///./node_modules/ol/proj/Projection.js","webpack:///./node_modules/ol/proj/Units.js","webpack:///./node_modules/ol/proj/epsg3857.js","webpack:///./node_modules/ol/proj/epsg4326.js","webpack:///./node_modules/ol/proj/projections.js","webpack:///./node_modules/ol/proj/transforms.js","webpack:///./node_modules/ol/render/Box.js","webpack:///./node_modules/ol/render/Event.js","webpack:///./node_modules/ol/render/EventType.js","webpack:///./node_modules/ol/render/ReplayGroup.js","webpack:///./node_modules/ol/render/ReplayType.js","webpack:///./node_modules/ol/render/VectorContext.js","webpack:///./node_modules/ol/render/canvas.js","webpack:///./node_modules/ol/render/canvas/ImageReplay.js","webpack:///./node_modules/ol/render/canvas/Immediate.js","webpack:///./node_modules/ol/render/canvas/Instruction.js","webpack:///./node_modules/ol/render/canvas/LineStringReplay.js","webpack:///./node_modules/ol/render/canvas/PolygonReplay.js","webpack:///./node_modules/ol/render/canvas/Replay.js","webpack:///./node_modules/ol/render/canvas/ReplayGroup.js","webpack:///./node_modules/ol/render/canvas/TextReplay.js","webpack:///./node_modules/ol/render/replay.js","webpack:///./node_modules/ol/renderer/Layer.js","webpack:///./node_modules/ol/renderer/Map.js","webpack:///./node_modules/ol/renderer/canvas/ImageLayer.js","webpack:///./node_modules/ol/renderer/canvas/IntermediateCanvas.js","webpack:///./node_modules/ol/renderer/canvas/Layer.js","webpack:///./node_modules/ol/renderer/canvas/Map.js","webpack:///./node_modules/ol/renderer/canvas/TileLayer.js","webpack:///./node_modules/ol/renderer/canvas/VectorLayer.js","webpack:///./node_modules/ol/renderer/canvas/VectorTileLayer.js","webpack:///./node_modules/ol/renderer/vector.js","webpack:///./node_modules/ol/reproj/common.js","webpack:///./node_modules/ol/resolutionconstraint.js","webpack:///./node_modules/ol/rotationconstraint.js","webpack:///./node_modules/ol/size.js","webpack:///./node_modules/ol/source/Source.js","webpack:///./node_modules/ol/source/State.js","webpack:///./node_modules/ol/source/Vector.js","webpack:///./node_modules/ol/source/VectorEventType.js","webpack:///./node_modules/ol/sphere.js","webpack:///./node_modules/ol/string.js","webpack:///./node_modules/ol/structs/LRUCache.js","webpack:///./node_modules/ol/structs/PriorityQueue.js","webpack:///./node_modules/ol/structs/RBush.js","webpack:///./node_modules/ol/style/Circle.js","webpack:///./node_modules/ol/style/Fill.js","webpack:///./node_modules/ol/style/Icon.js","webpack:///./node_modules/ol/style/IconAnchorUnits.js","webpack:///./node_modules/ol/style/IconImage.js","webpack:///./node_modules/ol/style/IconImageCache.js","webpack:///./node_modules/ol/style/IconOrigin.js","webpack:///./node_modules/ol/style/Image.js","webpack:///./node_modules/ol/style/RegularShape.js","webpack:///./node_modules/ol/style/Stroke.js","webpack:///./node_modules/ol/style/Style.js","webpack:///./node_modules/ol/style/Text.js","webpack:///./node_modules/ol/style/TextPlacement.js","webpack:///./node_modules/ol/tilegrid/common.js","webpack:///./node_modules/ol/transform.js","webpack:///./node_modules/ol/webgl.js","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/quickselect/quickselect.js","webpack:///./node_modules/rbush/index.js","webpack:///./node_modules/style-loader/lib/addStyles.js","webpack:///./node_modules/style-loader/lib/urls.js","webpack:///./node_modules/util/support/isBufferBrowser.js","webpack:///./node_modules/util/util.js","webpack:///(webpack)/buildin/global.js","webpack:///./stylefunction.js","webpack:///./util.js"],"names":["layer","VectorLayer","declutter","source","VectorSource","format","GeoJsonFormat","url","map","Map","target","view","View","center","zoom","fetch","then","r","json","glStyle","addLayer","deref","parent","result","k","refProperties","forEach","derefLayers","layers","slice","Object","create","i","length","id","ref","CompoundExpression","name","type","evaluate","args","_evaluate","ctx","fn","undefined","concat","arg","serialize","context","op","definition","definitions","error","Array","isArray","availableOverloads","overloads","filter","signature","parsedArgs","expected","params","parsed","parse","push","signatureContext","ParsingContext","registry","path","scope","checkSubtype","errors","apply","signatures","stringifySignature","join","actualTypes","toString","types","string","StringType","number","NumberType","boolean","BooleanType","ArrayAssertion","input","value","RuntimeError","possibleOutputs","serialized","itemType","kind","N","ValueType","Math","floor","object","ObjectType","Assertion","At","index","array","expectedType","t","Case","branches","otherwise","test","expression","_","out","eachChild","child","outputType","Coalesce","omitTypeAnnotations","needsAnnotation","some","ColorType","Coercion","c","parseColor","JSON","stringify","Color","num","Number","isNaN","Collator","caseSensitive","diacriticSensitive","locale","sensitivity","collator","Intl","usage","lhs","rhs","compare","resolvedOptions","CollatorExpression","CollatorType","options","isComparableType","makeComparison","negate","equal","Comparison","Equals","NotEquals","expressions","Interpolate","Length","Let","Literal","Match","Step","Var","rgba","g","b","a","alpha","has","key","obj","get","v","lt","gt","lteq","gteq","ltCollate","gtCollate","lteqCollate","gteqCollate","binarySearch","j","m","varargs","register","ErrorType","String","Boolean","toArray","properties","geometryType","globals","heatmapDensity","lineProgress","LN2","PI","E","e","pow","x","sqrt","n","log10","log","log2","sin","cos","tan","asin","acos","atan","min","max","abs","round","ceil","indexOf","s","isSupportedScript","toUpperCase","toLowerCase","resolvedLocale","interpolate","interpolation","stops","labels","outputs","label","stopCount","lower","upper","interpolationFactor","outputLower","outputUpper","output","base","controlPoints","exponentialInterpolation","ub","UnitBezier","solve","rest","labelKey","valueKey","lowerValue","upperValue","difference","progress","bindings","binding","expr","inputType","cases","sortedLabels","keys","sort","groupedByOutput","outputLookup","outputIndex","coerceLabel","labelContext","MAX_SAFE_INTEGER","unshift","Infinity","boundExpression","geometryTypes","EvaluationContext","_parseColorCache","feature","cached","isExpression","createExpression","createPropertyExpression","normalizePropertyExpression","isConstant","StyleExpression","propertySpec","_warningHistory","_defaultValue","getDefaultValue","_enumValues","values","_evaluator","val","message","console","warn","parser","getExpectedType","ZoomConstantExpression","_styleExpression","evaluateWithoutErrorHandling","ZoomDependentExpression","zoomCurve","zoomStops","_interpolationType","isFeatureConstant","ParsingError","isZoomConstant","isGlobalPropertyConstant","findZoomCurve","StylePropertyFunction","parameters","specification","_parameters","_specification","Error","err","constant","childResult","spec","color","enum","default","Scope","part","_parse","Expr","actual","ec","isTypeAnnotation","childrenConstant","findStopLessThanOrEqualTo","lowerIndex","upperIndex","currentIndex","currentValue","NullType","valueMemberTypes","memberType","validateRGBA","isValue","typeOf","mixed","item","createFilter","isExpressionFilter","f","filterSpec","convertFilter","compiled","globalProperties","converted","convertComparisonOp","convertNegation","convertDisjunctionOp","convertInOp","convertHasOp","property","filters","convertFunction","defaultExpression","convertValue","zoomAndFeatureDependent","featureDependent","zoomDependent","stop","tokens","convertTokenString","colorSpace","convertZoomAndPropertyFunction","convertZoomFunction","convertPropertyFunction","convertIdentityFunction","featureFunctionParameters","featureFunctionStops","functionType","getFunctionType","z","appendStopPair","fixupDegenerateStepCurve","isStep","curve","function","re","pos","match","exec","literal","lastIndex","isFunction","createFunction","colorSpaces","identityFunction","isColor","innerFun","hashedStops","categoricalKeyType","evaluateExponentialFunction","evaluateIntervalFunction","evaluateCategoricalFunction","evaluateIdentityFunction","featureFunctions","bind","coalesce","keyType","evaluated","interp","colorspace","reverse","forward","evaluatedLower","evaluatedUpper","black","white","transparent","Xn","Yn","Zn","t0","t1","t2","t3","deg2rad","rad2deg","xyz2lab","lab2xyz","xyz2rgb","rgb2xyz","rgbToLab","rgbColor","l","y","labToRgb","labColor","interpolateLab","from","to","rgbToHcl","h","atan2","hclToRgb","hclColor","interpolateHue","d","interpolateHcl","lab","hcl","inputs","getType","success","module","exports","p1x","p1y","p2x","p2y","cx","bx","ax","cy","by","ay","prototype","sampleCurveX","sampleCurveY","sampleCurveDerivativeX","solveCurveX","epsilon","x2","d2","len","isBuffer","global","Buffer","_isBuffer","util","require","hasOwn","hasOwnProperty","pSlice","functionsHaveNames","foo","pToString","call","isView","arrbuf","ArrayBuffer","DataView","buffer","assert","ok","regex","getName","func","str","AssertionError","operator","generatedMessage","getMessage","stackStartFunction","fail","captureStackTrace","stack","fn_name","idx","next_line","substring","inherits","truncate","inspect","something","rawname","self","notEqual","deepEqual","_deepEqual","deepStrictEqual","strict","memos","isDate","getTime","isRegExp","multiline","ignoreCase","Float32Array","Float64Array","Uint8Array","actualIndex","objEquiv","isArguments","actualVisitedObjects","isPrimitive","getPrototypeOf","aIsArgs","bIsArgs","ka","objectKeys","kb","notDeepEqual","notDeepStrictEqual","strictEqual","notStrictEqual","expectedException","isPrototypeOf","_tryBlock","block","_throws","shouldThrow","TypeError","userProvidedMessage","isUnwantedException","isError","isUnexpectedException","throws","doesNotThrow","ifError","useSourceMap","list","content","cssWithMappingToString","modules","mediaQuery","alreadyImportedModules","cssMapping","btoa","sourceMapping","toComment","sourceURLs","sources","sourceRoot","sourceMap","base64","unescape","encodeURIComponent","data","kCSSColorTable","clamp_css_byte","clamp_css_float","parse_css_int","parseFloat","parseInt","parse_css_float","css_hue_to_rgb","m1","m2","parseCSSColor","css_str","replace","iv","substr","ep","fname","split","pop","ctor","superCtor","super_","constructor","enumerable","writable","configurable","TempCtor","fontWeights","thin","hairline","light","book","regular","normal","plain","roman","standard","medium","bold","heavy","fat","poster","sp","italicRE","fontCache","fonts","size","cssData","weight","style","fontFamilies","haveWeight","haveStyle","ii","font","parts","maybeWeight","w","fontFamily","code","VERSION","Property","LENGTH","CollectionEvent","opt_element","Event","element","Collection","opt_array","opt_options","BaseObject","unique_","unique","array_","assertUnique_","updateLength_","clear","getLength","extend","arr","getArray","insertAt","elem","splice","dispatchEvent","CollectionEventType","ADD","removeAt","remove","prev","REMOVE","setAt","set","opt_except","Disposable","disposed_","dispose","disposeInternal","UNDEFINED","createStyleFunction","Feature","opt_geometryOrProperties","id_","geometryName_","style_","styleFunction_","geometryChangeKey_","handleGeometryChanged_","Geometry","geometry","setGeometry","setProperties","clone","getProperties","setGeometryName","getGeometryName","getGeometry","getStyle","setStyle","getId","getStyleFunction","handleGeometryChange_","changed","EventType","CHANGE","setId","styles","Style","ImageBase","extent","resolution","pixelRatio","state","EventTarget","pixelRatio_","getExtent","getImage","getPixelRatio","getResolution","getState","load","ImageCanvas","canvas","opt_loader","loader_","ImageState","IDLE","LOADED","canvas_","error_","getError","handleLoad_","ERROR","LOADING","Kinetic","decay","minVelocity","delay","decay_","minVelocity_","delay_","points_","angle_","initialVelocity_","begin","update","Date","now","end","firstIndex","duration","dx","dy","getDistance","getAngle","IMAGE","TILE","VECTOR_TILE","VECTOR","controls","interactions","PluggableMap","createRenderer","renderer","CanvasMapRenderer","registerLayerRenderers","CanvasImageLayerRenderer","CanvasTileLayerRenderer","CanvasVectorLayerRenderer","CanvasVectorTileLayerRenderer","MapBrowserEvent","browserEvent","opt_dragging","opt_frameState","MapEvent","originalEvent","pixel","getEventPixel","coordinate","getCoordinateFromPixel","dragging","preventDefault","stopPropagation","MapBrowserEventHandler","moveTolerance","map_","clickTimeoutId_","dragging_","dragListenerKeys_","moveTolerance_","DEVICE_PIXEL_RATIO","down_","getViewport","activePointers_","trackedTouches_","pointerEventHandler_","PointerEventHandler","documentPointerEventHandler_","pointerdownListenerKey_","PointerEventType","POINTERDOWN","handlePointerDown_","relayedListenerKey_","POINTERMOVE","relayEvent_","emulateClick_","pointerEvent","newEvent","MapBrowserPointerEvent","MapBrowserEventType","CLICK","clearTimeout","DBLCLICK","setTimeout","SINGLECLICK","updateActivePointers_","event","POINTERUP","POINTERCANCEL","pointerId","handlePointerUp_","propagationStopped","isMouseActionButton_","unlistenByKey","button","document","handlePointerMove_","isMoving_","POINTERDRAG","clientX","clientY","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","frameState","POSTRENDER","MOVESTART","MOVEEND","LAYERGROUP","SIZE","TARGET","VIEW","getChangeEventType","ObjectEvent","oldValue","opt_values","Observable","values_","changeEventTypeCache","getKeys","notify","eventType","ObjectEventType","PROPERTYCHANGE","opt_silent","unset","unByKey","revision_","getRevision","on","listener","once","un","optionsInternal","createOptionsInternal","maxTilesLoading_","maxTilesLoading","loadTilesWhileAnimating_","loadTilesWhileAnimating","loadTilesWhileInteracting_","loadTilesWhileInteracting","animationDelayKey_","animationDelay_","renderFrame_","coordinateToPixelTransform_","pixelToCoordinateTransform_","frameIndex_","frameState_","previousExtent_","viewPropertyListenerKey_","viewChangeListenerKey_","layerGroupPropertyListenerKeys_","viewport_","createElement","className","TOUCH","position","overflow","width","height","msTouchAction","touchAction","overlayContainer_","appendChild","overlayContainerStopEvent_","overlayEvents","MOUSEDOWN","TOUCHSTART","MSPOINTERDOWN","MOUSEWHEEL","WHEEL","mapBrowserEventHandler_","handleMapBrowserEvent","keyboardEventTarget_","keyboardEventTarget","keyHandlerKeys_","CONTEXTMENU","handleBrowserEvent","overlays_","overlays","overlayIdIndex_","renderer_","handleResize_","focus_","postRenderFunctions_","tileQueue_","TileQueue","getTilePriority","handleTileChange_","skippedFeatureUids_","MapProperty","handleLayerGroupChanged_","handleViewChanged_","handleSizeChanged_","handleTargetChanged_","control","setMap","interaction","addOverlayInternal_","overlay","addControl","getControls","addInteraction","getInteractions","getLayerGroup","getLayers","addOverlay","getOverlays","removeEventListener","RESIZE","cancelAnimationFrame","setTarget","forEachFeatureAtPixel","callback","hitTolerance","layerFilter","TRUE","forEachFeatureAtCoordinate","getFeaturesAtPixel","features","forEachLayerAtPixel","opt_this","opt_layerFilter","opt_this2","thisArg","thisArg2","hasFeatureAtPixel","hasFeatureAtCoordinate","getEventCoordinate","viewportPosition","getBoundingClientRect","eventPosition","changedTouches","left","top","getTarget","getTargetElement","getElementById","pixelToCoordinateTransform","getOverlayById","getPixelFromCoordinate","coordinateToPixelTransform","getRenderer","getSize","getView","getOverlayContainer","getOverlayContainerStopEvent","tile","tileSourceKey","tileCenter","tileResolution","wantedTiles","DROP","getKey","deltaX","focus","deltaY","opt_type","mapBrowserEvent","interactionsArray","getActive","cont","handleEvent","handlePostRender","tileQueue","isEmpty","maxTotalLoading","maxNewLoads","hints","viewHints","ViewHint","ANIMATING","INTERACTING","getTilesLoading","reprioritize","loadMoreTiles","postRenderFunctions","render","targetElement","removeLayerRenderers","KEYDOWN","KEYPRESS","updateSize","addEventListener","handleViewPropertyChanged_","setAttribute","layerGroup","isRendered","renderSync","requestAnimationFrame","removeControl","removeInteraction","removeLayer","removeOverlay","time","viewState","previousFrameState","isDef","getHints","layerStatesArray","getLayerStatesArray","layerStates","pixelResolution","animate","skippedFeatureUids","usedTiles","rotation","renderFrame","moveStart","MapEventType","idle","setLayerGroup","setSize","setView","skipFeature","featureUid","computedStyle","getComputedStyle","offsetWidth","offsetHeight","unskipFeature","LayerGroup","tilePriorityFunction","tileChangeCallback","PriorityQueue","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","enqueue","added","handleTileChange","TileState","EMPTY","ABORT","tileKey","newLoads","abortedTiles","getCount","dequeue","createOrUpdate","TileRange","minX","maxX","minY","maxY","tileRange","contains","tileCoord","containsXY","containsTileRange","equals","getHeight","getWidth","intersects","createCenterConstraint","createResolutionConstraint","createRotationConstraint","isNoopAnimation","DEFAULT_MIN_ZOOM","hints_","animations_","updateAnimationKey_","updateAnimations_","projection_","projection","applyOptions_","ViewProperty","CENTER","resolutionConstraintInfo","maxResolution_","maxResolution","minResolution_","minResolution","zoomFactor_","zoomFactor","resolutions_","resolutions","minZoom_","minZoom","centerConstraint","resolutionConstraint","constraint","rotationConstraint","constraints_","RESOLUTION","constrainResolution","ROTATION","options_","getUpdatedOptions_","newOptions","getZoom","getCenter","getRotation","var_args","animationCount","arguments","setCenter","setZoom","setRotation","start","series","animation","complete","anchor","easing","inAndOut","sourceCenter","targetCenter","sourceResolution","targetResolution","sourceRotation","delta","targetRotation","setHint","getAnimating","getInteracting","cancelAnimations","more","seriesComplete","jj","elapsed","fraction","x0","y0","x1","y1","calculateCenterZoom","calculateCenterRotate","currentCenter","currentResolution","getSizeFromViewport_","selector","querySelector","metrics","constrainCenter","opt_delta","opt_direction","direction","constrainRotation","getConstraints","opt_hints","calculateExtent","opt_size","getMaxResolution","getMinResolution","getMaxZoom","getZoomForResolution","setMaxZoom","maxZoom","getMinZoom","setMinZoom","getProjection","getResolutions","getResolutionForExtent","xResolution","yResolution","getResolutionForValueFunction","opt_power","power","getValueForResolutionFunction","offset","nearest","getResolutionForZoom","fit","geometryOrExtent","SimpleGeometry","GeometryType","CIRCLE","rotate","padding","coords","getFlatCoordinates","cosAngle","sinAngle","minRotX","minRotY","maxRotX","maxRotY","stride","getStride","rotX","rotY","constrainedResolution","centerRotX","centerRotY","centerX","centerY","setResolution","centerOn","opt_anchor","hint","centerNone","defaultMaxZoom","defaultZoomFactor","METERS_PER_UNIT","Units","DEGREES","getMetersPerUnit","defaultMaxResolution","DEFAULT_TILE_SIZE","defaultMinResolution","enableRotation","rotationNone","disable","numberSafeCompareFunction","includes","linearFindNearest","reverseSubArray","find","stableSort","findIndex","isSorted","haystack","needle","opt_comparator","mid","cmp","comparator","low","high","found","tmp","extension","arr1","arr2","len1","compareFnc","every","el","opt_func","opt_strict","currentVal","res","assertion","errorCode","createExtent","none","asString","asArray","normalize","HEX_COLOR_RE_","NAMED_COLOR_RE_","fromNamed","body","rgb","removeChild","fromString","MAX_CACHE_SIZE","cache","cacheSize","fromStringInternal_","hasAlpha","asColorLike","isColorLike","CanvasPattern","CanvasGradient","Attribution","ulElement_","collapsed_","collapsed","collapsible_","collapsible","tipLabel","collapseLabel","collapseLabel_","textContent","label_","activeLabel","title","handleClick_","cssClasses","CLASS_UNSELECTABLE","CLASS_CONTROL","CLASS_COLLAPSED","Control","renderedAttributions_","renderedVisible_","getSourceAttributions_","lookup","visibleAttributions","layerState","getSource","attributionGetter","getAttributions","attributions","mapEvent","updateElement_","display","visible","innerHTML","handleToggle_","classList","toggle","getCollapsible","setCollapsible","setCollapsed","getCollapsed","target_","listenerKeys","getMap","Rotate","add","callResetNorth_","resetNorth","duration_","autoHide_","autoHide","rotation_","CLASS_HIDDEN","resetNorth_","easeOut","transform","msTransform","webkitTransform","Zoom","zoomInLabel","zoomOutLabel","zoomInTipLabel","zoomOutTipLabel","inElement","createTextNode","outElement","zoomByDelta_","newResolution","defaults","zoomControl","zoomOptions","rotateControl","rotateOptions","attributionControl","attribution","attributionOptions","closestOnCircle","closestOnSegment","createStringXY","degreesToStringHDMS","scale","squaredDistance","distance","squaredDistanceToSegment","toStringHDMS","toStringXY","circle","getRadius","segment","y2","along","opt_fractionDigits","hemispheres","degrees","normalizedDegrees","dflPrecision","precision","deg","sec","charAt","template","toFixed","coordinate1","coordinate2","angle","coord1","coord2","CLASS_SELECTABLE","CLASS_UNSUPPORTED","getFontFamilies","family","createCanvasContext2D","outerWidth","outerHeight","replaceNode","removeNode","removeChildren","opt_width","opt_height","getContext","marginLeft","marginRight","marginTop","marginBottom","newNode","oldNode","parentNode","replaceChild","node","lastChild","easeIn","linear","upAndDown","bindListener","findListener","getListeners","listen","listenOnce","unlisten","unlistenAll","listenerObj","boundListener","evt","bindTo","callOnce","listeners","opt_setDeleteIndex","deleteIndex","listenerMap","ol_lm","getListenerMap","removeListeners","opt_once","pendingRemovals_","dispatching_","listeners_","propagate","pendingRemovals","hasListener","CLEAR","DRAGENTER","DRAGOVER","LOAD","MOUSEMOVE","MOUSEOUT","MOUSEUP","TOUCHMOVE","TOUCHEND","LEFT","UP","RIGHT","DOWN","altKeyOnly","altKey","metaKey","ctrlKey","shiftKey","altShiftKeysOnly","activeElement","always","click","mouseActionButton","WEBKIT","MAC","never","FALSE","pointerMove","singleClick","doubleClick","noModifierKeys","platformModifierKeyOnly","shiftKeyOnly","targetNotEditable","tagName","mouseOnly","pointerType","primaryAction","isPrimary","boundingExtent","closestSquaredDistanceXY","containsCoordinate","containsExtent","coordinateRelationship","createEmpty","createOrUpdateEmpty","createOrUpdateFromCoordinate","createOrUpdateFromCoordinates","createOrUpdateFromFlatCoordinates","createOrUpdateFromRings","extendCoordinate","extendCoordinates","extendFlatCoordinates","extendRings","extendXY","forEachCorner","getArea","getBottomLeft","getBottomRight","getCorner","getEnlargedArea","getForViewAndSize","getIntersectionArea","getIntersection","getMargin","getTopLeft","getTopRight","returnOrUpdate","scaleFromCenter","intersectsSegment","applyTransform","coordinates","_boundingExtentXYs","xs","ys","opt_extent","extent1","extent2","relationship","Relationship","UNKNOWN","BELOW","ABOVE","INTERSECTING","flatCoordinates","rings","area","corner","Corner","BOTTOM_LEFT","BOTTOM_RIGHT","TOP_LEFT","TOP_RIGHT","cosRotation","sinRotation","xCos","xSin","yCos","ySin","x3","y3","intersection","startRel","endRel","startX","startY","endX","endY","slope","transformFn","loadFeaturesXhr","xhr","failure","XMLHttpRequest","open","FormatType","ARRAY_BUFFER","responseType","onload","status","TEXT","responseText","XML","responseXML","DOMParser","parseFromString","response","readFeatures","featureProjection","readProjection","getLastExtent","onerror","send","dataProjection","addFeatures","transformWithOptions","FeatureFormat","defaultDataProjection","defaultFeatureProjection","getReadOptions","adaptOptions","readFeature","readGeometry","writeFeature","writeFeatures","writeGeometry","write","transformed","decimals","GeoJSON","JSONFeature","geometryName","extractGeometryName_","extractGeometryName","GEOMETRY_READERS","readPointGeometry","readLineStringGeometry","readPolygonGeometry","readMultiPointGeometry","readMultiLineStringGeometry","readMultiPolygonGeometry","readGeometryCollectionGeometry","GEOMETRY_WRITERS","writePointGeometry","writeLineStringGeometry","writePolygonGeometry","writeMultiPointGeometry","writeMultiLineStringGeometry","writeMultiPolygonGeometry","writeGeometryCollectionGeometry","writeEmptyGeometryCollectionGeometry","geometryReader","geometries","GeometryCollection","Point","LineString","MultiLineString","MultiPoint","MultiPolygon","Polygon","geometryWriter","getGeometriesArray","getCoordinates","right","rightHanded","readFeatureFromObject","geoJSONFeature","geometry_name","readFeaturesFromObject","geoJSONObject","geoJSONFeatureCollection","geoJSONFeatures","readGeometryFromObject","readProjectionFromObject","crs","writeFeatureObject","writeFeaturesObject","objects","writeGeometryObject","getObject","Circle","opt_radius","opt_layout","radius","setCenterAndRadius","setFlatCoordinates","layout","closestPointXY","closestPoint","minSquaredDistance","getRadiusSquared_","computeExtent","intersectsExtent","circleExtent","intersectsCoordinate","GeometryLayout","XY","setLayout","setCoordinates","setFlatCoordinatesInternal","setRadius","extent_","extentRevision_","simplifiedGeometryCache","simplifiedGeometryMaxMinSquaredTolerance","simplifiedGeometryRevision","tmpTransform","getClosestPoint","point","opt_closestPoint","NaN","sx","opt_sy","simplify","tolerance","getSimplifiedGeometry","squaredTolerance","translate","destination","getUnits","TILE_PIXELS","inCoordinates","outCoordinates","pixelExtent","projectedExtent","getWorldExtent","opt_geometries","geometries_","listenGeometriesChange_","cloneGeometries","clonedGeometries","unlistenGeometriesChange_","geometryCollection","setGeometries","getGeometries","simplifiedGeometries","simplified","simplifiedGeometry","simplifiedGeometryCollection","setGeometriesArray","GEOMETRY_COLLECTION","XYZ","XYM","XYZM","POINT","LINE_STRING","LINEAR_RING","POLYGON","MULTI_POINT","MULTI_LINE_STRING","MULTI_POLYGON","flatMidpoint_","flatMidpointRevision_","maxDelta_","maxDeltaRevision_","appendCoordinate","lineString","forEachSegment","getCoordinateAtM","opt_extrapolate","extrapolate","getCoordinateAt","opt_dest","getFlatMidpoint","getSimplifiedGeometryInternal","simplifiedFlatCoordinates","simplifiedLineString","LinearRing","linearRing","simplifiedLinearRing","ends_","appendLineString","multiLineString","opt_interpolate","getEnds","getLineString","getLineStrings","ends","lineStrings","getFlatMidpoints","midpoints","midpoint","simplifiedEnds","simplifiedMultiLineString","setLineStrings","getLayout","appendPoint","multiPoint","getPoint","getPoints","points","endss_","flatInteriorPointsRevision_","flatInteriorPoints_","orientedRevision_","orientedFlatCoordinates_","appendPolygon","polygon","multiPolygon","newEndss","getOrientedFlatCoordinates","opt_right","getEndss","getFlatInteriorPoints","flatCenters","getInteriorPoints","interiorPoints","simplifiedEndss","simplifiedMultiPolygon","getPolygon","prevEnds","getPolygons","endss","polygons","lastEnds","setPolygons","circular","fromExtent","fromCircle","makeRegular","flatInteriorPointRevision_","flatInteriorPoint_","appendLinearRing","getFlatInteriorPoint","flatCenter","getInteriorPoint","getLinearRingCount","getLinearRing","getLinearRings","linearRings","simplifiedPolygon","opt_n","opt_sphereRadius","opt_sides","opt_angle","sides","arrayLength","startAngle","getStrideForLayout","transformGeom2D","getLayoutForStride","getFirstCoordinate","getLastCoordinate","nesting","sy","simpleGeometry","linearRingss","twiceArea","maxSquaredDelta","arrayMaxSquaredDelta","multiArrayMaxSquaredDelta","assignClosestPoint","assignClosestArrayPoint","assignClosestMultiArrayPoint","assignClosest","offset1","offset2","squaredDelta","maxDelta","isRing","opt_tmpPoint","tmpPoint","linearRingContainsExtent","linearRingContainsXY","linearRingsContainsXY","linearRingssContainsXY","outside","wn","deflateCoordinate","deflateCoordinates","deflateCoordinatesArray","deflateMultiCoordinatesArray","coordinatess","opt_ends","coordinatesss","opt_endss","inflateCoordinates","inflateCoordinatesArray","inflateMultiCoordinatesArray","opt_coordinates","opt_coordinatess","opt_coordinatesss","getInteriorPointOfArray","getInteriorPointsOfMultiArray","flatCentersOffset","intersections","rr","pointX","maxSegmentLength","segmentLength","interpolatePoint","lineStringCoordinateAtM","lineStringsCoordinateAtM","pointY","cumulativeLengths","o","lo","hi","m0","intersectsLineString","intersectsLineStringArray","intersectsLinearRing","intersectsLinearRingArray","intersectsLinearRingMultiArray","coordinatesExtent","point1","point2","lineStringLength","linearRingLength","perimeter","linearRingIsClockwise","linearRingIsOriented","linearRingsAreOriented","orientLinearRings","orientLinearRingsArray","edge","isClockwise","ret","simplifyLineString","douglasPeucker","douglasPeuckerArray","douglasPeuckerMultiArray","radialDistance","snap","quantize","quantizeArray","quantizeMultiArray","highQuality","opt_simplifiedFlatCoordinates","simplifiedOffset","markers","last","first","maxSquaredDistance","dx1","dy1","dx2","dy2","matchingChunk","maxAngle","chunkStart","chunkEnd","chunkM","m12","m23","x12","y12","x23","y23","drawTextOnPath","text","measure","startM","numChars","segmentM","chunk","chunkLength","previousAngle","char","charLength","charM","segmentPos","transform2D","dest","anchorX","anchorY","ua","navigator","userAgent","FIREFOX","SAFARI","window","devicePixelRatio","CANVAS_LINE_DASH","setLineDash","GEOLOCATION","POINTER","MSPOINTER","msPointerEnabled","WEBGL","HAS_WEBGL","getUid","DEBUG_WEBGL","WEBGL_MAX_TEXTURE_SIZE","WEBGL_EXTENSIONS","gl","failIfMajorPerformanceCaveat","getParameter","MAX_TEXTURE_SIZE","getSupportedExtensions","childCtor","parentCtor","uidCounter_","ol_uid","kinetic","altShiftDragRotate","DragRotate","doubleClickZoom","DoubleClickZoom","zoomDelta","zoomDuration","dragPan","DragPan","pinchRotate","PinchRotate","pinchZoom","PinchZoom","keyboard","KeyboardPan","KeyboardZoom","mouseWheelZoom","MouseWheelZoom","shiftDragZoom","DragZoom","delta_","Interaction","stopEvent","DragAndDropEventType","ADD_FEATURES","DragAndDropEvent","file","opt_features","opt_projection","DragAndDrop","formatConstructors_","formatConstructors","dropListenKeys_","source_","handleDrop","files","dataTransfer","reader","FileReader","handleResult_","readAsText","handleStop","dropEffect","formatConstructor","tryReadFeatures_","registerListeners_","dropArea","setActive","active","unregisterListeners_","DragBoxEventType","BOXSTART","BOXDRAG","BOXEND","DragBoxEvent","DragBox","PointerInteraction","handleDownEvent","handleDragEvent","handleUpEvent","box_","RenderBox","minArea_","minArea","startPixel_","condition_","condition","boxEndCondition_","boxEndCondition","defaultBoxEndCondition","startPixel","endPixel","setPixels","onBoxEnd","kinetic_","lastCentroid","lastPointersCount_","noKinetic_","targetPointers","centroid","centerpx","handlingDownUpSequence","shouldStopEvent","lastAngle_","theta","DragRotateAndZoom","lastMagnitude_","lastScaleDelta_","magnitude","angleDelta","out_","mapExtent","boxPixelExtent","factor","createRegularPolygon","createBox","Mode","DrawEventType","DRAWSTART","DRAWEND","DrawEvent","Draw","shouldHandle_","downPx_","downTimeout_","lastDragTime_","freehand_","features_","snapTolerance_","snapTolerance","type_","mode_","getMode","stopClick_","stopClick","minPoints_","minPoints","maxPoints_","maxPoints","finishCondition_","finishCondition","geometryFunction","opt_geometry","squaredLength","Constructor","mode","geometryFunction_","dragVertexDelay_","dragVertexDelay","finishCoordinate_","sketchFeature_","sketchPoint_","sketchCoords_","sketchLine_","sketchLineCoords_","squaredClickTolerance_","clickTolerance","overlay_","useSpatialIndex","wrapX","getDefaultStyleFunction","updateWhileInteracting","freehandCondition_","freehand","freehandCondition","InteractionProperty","ACTIVE","updateState_","move","pass","addToDrawing_","POINTER_TYPE","handlePointerEvent","startDrawing_","circleMode","finishDrawing","atFinish_","abortDrawing_","downPx","clickPx","modifyDrawing_","createOrUpdateSketchPoint_","at","potentiallyDone","potentiallyFinishCoordinates","finishCoordinate","finishPixel","updateSketchFeatures_","sketchPointGeom","sketchLineGeom","ring","done","removeLastPoint","sketchFeature","addFeature","sketchFeatures","overlaySource","ExtentEventType","EXTENTCHANGED","ExtentInteractionEvent","ExtentInteraction","pointerHandler_","pixelTolerance_","pixelTolerance","snappedToVertex_","extentFeature_","vertexFeature_","extentOverlay_","boxStyle","getDefaultExtentStyleFunction","updateWhileAnimating","vertexOverlay_","pointerStyle","getDefaultPointerStyleFunction","setExtent","vertex","snapToVertex_","getOpposingPoint","x_","y_","getPointHandler","getEdgeHandler","pixelCoordinate","createOrUpdatePointerFeature_","fixedPoint","fixedP1","fixedP2","getSegments","sortByDistance","segments","closestSegment","vertexPixel","pixel1","pixel2","squaredDist1","squaredDist2","dist","createOrUpdateExtentFeature_","extentFeature","vertexFeature","pan","rotateWithoutConstraints","zoomByDelta","zoomWithoutConstraints","opt_duration","currentRotation","defaultCondition_","pixelDelta_","pixelDelta","keyEvent","keyCode","KeyCode","mapUnitsDelta","charCode","charCodeAt","ModifyEventType","MODIFYSTART","MODIFYEND","ModifyEvent","mapBrowserPointerEvent","Modify","defaultDeleteCondition_","deleteCondition_","deleteCondition","insertVertexCondition_","insertVertexCondition","vertexSegments_","lastPixel_","ignoreNextSingleClick_","modified_","rBush_","RBush","changingFeature_","dragSegments_","SEGMENT_WRITERS_","writePointGeometry_","writeLineStringGeometry_","writePolygonGeometry_","writeMultiPointGeometry_","writeMultiLineStringGeometry_","writeMultiPolygonGeometry_","writeCircleGeometry_","writeGeometryCollectionGeometry_","getFeatures","VectorEventType","ADDFEATURE","handleSourceAdd_","REMOVEFEATURE","handleSourceRemove_","addFeature_","handleFeatureAdd_","handleFeatureRemove_","lastPointerEvent_","CIRCLE_CENTER_INDEX","CIRCLE_CIRCUMFERENCE_INDEX","handlePointerAtPixel_","handleFeatureChange_","willModifyFeatures_","removeFeature_","removeFeatureSegmentData_","removeFeature","rBush","nodesToRemove","segmentData","insert","depth","lines","kk","centerSegmentData","circumferenceSegmentData","featureSegments","createOrUpdateVertexFeature_","compareIndexes","insertVertices","vertexExtent","segmentDataMatches","getInExtent","componentSegments","segmentDataMatch","uid","closestVertex","closestOnSegmentData","insertVertex_","dragSegment","setGeometryCoordinates_","handled","removePoint","pointDistanceToSegmentDataSquared","box","nodes","vertexSegments","pointCoordinates","circleGeometry","distanceToCenterSquared","distanceToCircumference","rTree","updateSegmentIndices_","newSegmentData","newSegmentData2","removeVertex_","dragSegments","segmentsByFeature","deleted","component","newIndex","forEachInExtent","MAX_DELTA","TRACKPAD","timeout_","timeout","useAnchor_","useAnchor","constrainResolution_","lastAnchor_","startTime_","timeoutId_","trackpadEventGap_","trackpadTimeoutId_","trackpadDeltaPerZoom_","trackpadZoomBuffer_","wheelEvent","deltaMode","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","wheelDeltaY","decrementInteractingHint_","rebound","timeLeft","handleWheelZoom_","setMouseAnchor","anchor_","rotating_","rotationDelta_","threshold_","threshold","rotationDelta","touch0","touch1","lastDistance_","scaleDelta","handleMoveEvent","handleDownEvent_","handleDragEvent_","handleMoveEvent_","handleUpEvent_","trackedPointers_","pointerEvents","isPointerDraggingEvent","updateTrackedPointers_","handledUp","SelectEventType","SELECT","SelectEvent","selected","deselected","Select","addCondition_","addCondition","removeCondition_","removeCondition","toggleCondition_","toggleCondition","multi_","multi","filter_","hitTolerance_","featureOverlay","featureOverlay_","layerFilter_","featureLayerAssociation_","getFeaturesCollection","addFeatureLayerAssociation_","getHitTolerance","getLayer","removeFeatureLayerAssociation_","setHitTolerance","currentMap","selectedFeatures","Snap","vertex_","edge_","featuresListenerKeys_","featureChangeListenerKeys_","indexedFeaturesExtents_","pendingFeatures_","pixelCoordinate_","sortByDistance_","opt_listen","feature_uid","segmentWriter","forEachFeatureAdd_","forEachFeatureRemove_","getFeatures_","VectorSourceEvent","updateFeature_","opt_unlisten","unregister","snapTo","lowerLeft","upperRight","snappedToVertex","snapped","isCircle","featuresToUpdate","deltaA","deltaB","TranslateEventType","TRANSLATESTART","TRANSLATING","TRANSLATEEND","TranslateEvent","Translate","lastCoordinate_","lastFeature_","handleActiveChanged_","featuresAtPixel_","newCoordinate","geom","oldMap","BaseLayer","LayerProperty","OPACITY","opacity","VISIBLE","Z_INDEX","zIndex","MAX_RESOLUTION","MIN_RESOLUTION","state_","managed","getLayerState","getOpacity","sourceState","getSourceState","getVisible","getZIndex","getLayersArray","opt_states","EXTENT","setMaxResolution","setMinResolution","setOpacity","setVisible","setZIndex","zindex","LAYERS","baseOptions","layersListenerKeys_","listenerKeys_","handleLayersChanged_","setLayers","handleLayerChange_","handleLayersAdd_","handleLayersRemove_","layersArray","collectionEvent","states","ownLayerState","SourceState","READY","visibleAtResolution","Layer","mapPrecomposeKey_","mapRenderKey_","sourceChangeKey_","SOURCE","handleSourcePropertyChange_","setSource","handleSourceChange_","RenderEventType","PRECOMPOSE","RenderType","RENDER_ORDER","renderBuffer","declutter_","renderBuffer_","updateWhileAnimating_","updateWhileInteracting_","renderMode_","renderMode","VectorRenderType","LayerType","getDeclutter","setDeclutter","getRenderBuffer","getRenderOrder","getUpdateWhileAnimating","getUpdateWhileInteracting","setRenderOrder","renderOrder","createDefaultStyle","getRenderMode","HYBRID","all","bbox","tileGrid","getZForResolution","getTileRangeForExtentAndZ","extents","getTileCoordExtent","clamp","roundUpToPowerOfTwo","squaredSegmentDistance","solveLinearSystem","toDegrees","toRadians","modulo","lerp","cosh","exp","mat","maxRow","maxEl","absValue","coef","angleInRadians","angleInDegrees","getValues","assign","var_sources","EventSource","dispatcher","mapping","mapping_","getEvents","getHandlerForEvent","MouseSource","mousedown","mousemove","mouseup","mouseover","mouseout","pointerMap","lastTouches","POINTER_ID","DEDUP_DIST","isEventSimulatedFromTouch_","inEvent","lts","prepareEvent","cloneEvent","pd","cancel","down","p","up","cleanupMouse","enterOver","leaveOut","MsSource","msPointerDown","msPointerMove","msPointerUp","msPointerOut","msPointerOver","msPointerCancel","msGotPointerCapture","msLostPointerCapture","POINTER_TYPES","prepareEvent_","cleanup","makeEvent","NativeSource","pointerDown","pointerUp","pointerOut","pointerOver","pointerCancel","gotPointerCapture","lostPointerCapture","fireNativeEvent","PointerEvent","opt_eventDict","eventDict","buttons","getButtons_","pressure","getPressure_","bubbles","cancelable","detail","screenX","screenY","relatedTarget","tiltX","tiltY","hwTimestamp","HAS_BUTTONS","which","ev","MouseEvent","element_","eventMap_","eventSourceList_","registerSources","CLONE_PROPS","registerSource","mouseSource","TouchSource","register_","newEvents","handler","eventSource","addEvents_","unregister_","removeEvents_","eventHandler_","events","eventName","eventCopy","fireEvent","enter","leave","over","contains_","container","contained","inType","wrapMouseEvent","touchstart","touchmove","touchend","touchcancel","firstTouchId_","clickCount_","resetId_","dedupTimeout_","CLICK_COUNT_TIMEOUT","isPrimaryTouch_","inTouch","identifier","setPrimaryTouch_","count","cancelResetClickCount_","removePrimaryPointer_","inPointer","resetClickCount_","resetClickCountHandler_","touchToPointer_","webkitRadiusX","radiusX","webkitRadiusY","radiusY","webkitForce","force","processTouches_","inFunction","touches","pointer","findTouch_","touchList","searchId","touch","vacuumTouches_","cancelOut_","dedupSynthMouse_","overDown_","outTarget","moveOverOut_","outEvent","upOut_","cleanUpPointer_","cloneTransform","identityTransform","addProjection","addProjections","getPointResolution","addEquivalentProjections","addEquivalentTransforms","clearAllProjections","createProjection","createTransformFromCoordinateTransform","addCoordinateTransforms","fromLonLat","toLonLat","equivalent","getTransformFromProjections","getTransform","transformExtent","transformWithProjections","addCommon","projections","opt_output","opt_dimension","getCode","projectionLike","Projection","opt_units","pointResolution","getter","getPointResolutionFunc","units","toEPSG4326","vertices","metersPerUnit","projections1","projections2","forwardTransform","inverseTransform","projection1","projection2","defaultCode","coordTransform","dimension","inverse","sourceProj","destProj","lonLat","lon","equalUnits","transformFunc","sourceProjection","destinationProjection","sourceCode","destinationCode","EPSG3857_PROJECTIONS","EPSG4326_PROJECTIONS","fromEPSG4326","code_","units_","worldExtent_","worldExtent","axisOrientation_","axisOrientation","global_","canWrapX_","getPointResolutionFunc_","defaultTileGrid_","metersPerUnit_","canWrapX","getAxisOrientation","isGlobal","setGlobal","getDefaultTileGrid","setDefaultTileGrid","setWorldExtent","setGetPointResolution","FEET","METERS","PIXELS","USFEET","RADIUS","HALF_SIZE","WORLD_EXTENT","EPSG3857Projection","PROJECTIONS","halfSize","EPSG4326Projection","opt_axisOrientation","transforms","geometry_","endPixel_","render_","px","createOrUpdateGeometry","pixels","RenderEvent","opt_vectorContext","opt_context","opt_glContext","vectorContext","glContext","POSTCOMPOSE","RENDER","ReplayGroup","getReplay","replayType","DEFAULT","VectorContext","drawCustom","drawGeometry","drawCircle","drawFeature","drawGeometryCollection","geometryCollectionGeometry","drawLineString","lineStringGeometry","drawMultiLineString","multiLineStringGeometry","drawMultiPoint","multiPointGeometry","drawMultiPolygon","multiPolygonGeometry","drawPoint","pointGeometry","drawPolygon","polygonGeometry","drawText","setFillStrokeStyle","fillStyle","strokeStyle","setImageStyle","imageStyle","opt_declutterGroup","setTextStyle","textStyle","measureTextWidth","rotateAtOffset","drawImage","defaultFont","defaultFillStyle","defaultLineCap","defaultLineDash","defaultLineDashOffset","defaultLineJoin","defaultMiterLimit","defaultStrokeStyle","defaultTextAlign","defaultTextBaseline","defaultPadding","defaultLineWidth","labelCache","LRUCache","checkedFonts","measureContext","textHeights","checkFont","retries","checked","referenceFonts","interval","referenceWidth","isAvailable","getMeasureContext","available","referenceFont","measureText","check","clearInterval","fontSpec","setInterval","measureTextHeight","span","heights","margin","offsetX","offsetY","resetTransform","image","originX","originY","globalAlpha","setTransform","CanvasImageReplay","maxExtent","overlaps","declutterTree","CanvasReplay","declutterGroup_","hitDetectionImage_","image_","anchorX_","anchorY_","height_","opacity_","originX_","originY_","rotateWithView_","scale_","snapToPixel_","width_","drawCoordinates_","appendFlatCoordinates","beginGeometry","myBegin","myEnd","instructions","CanvasInstruction","DRAW_IMAGE","hitDetectionInstructions","endGeometry","finish","reverseHitDetectionInstructions","declutterGroup","getAnchor","hitDetectionImage","getHitDetectionImage","origin","getOrigin","getRotateWithView","getScale","getSnapToPixel","CanvasImmediateRenderer","viewRotation","context_","transform_","viewRotation_","contextFillState_","contextStrokeState_","contextTextState_","fillState_","strokeState_","imageAnchorX_","imageAnchorY_","imageHeight_","imageOpacity_","imageOriginX_","imageOriginY_","imageRotateWithView_","imageRotation_","imageScale_","imageSnapToPixel_","imageWidth_","text_","textOffsetX_","textOffsetY_","textRotateWithView_","textRotation_","textScale_","textFillState_","textStrokeState_","textState_","pixelCoordinates_","tmpLocalTransform_","drawImages_","pixelCoordinates","localTransform","drawText_","setContextFillState_","setContextStrokeState_","setContextTextState_","strokeText","fillText","moveToLineTo_","close","moveTo","lineTo","closePath","drawRings_","beginPath","arc","fill","stroke","getFill","getStroke","getText","getGeometryFunction","flatMidpoint","geometryExtent","flatMidpoints","flatInteriorPoint","flatInteriorPoints","fillState","contextFillState","strokeState","contextStrokeState","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","textState","contextTextState","textAlign","textBaseline","fillStyleColor","getColor","strokeStyleColor","strokeStyleLineCap","getLineCap","strokeStyleLineDash","getLineDash","strokeStyleLineDashOffset","getLineDashOffset","strokeStyleLineJoin","getLineJoin","strokeStyleWidth","strokeStyleMiterLimit","getMiterLimit","imageAnchor","imageImage","imageOrigin","imageSize","textFillStyle","textFillStyleColor","textStrokeStyle","textStrokeStyleColor","textStrokeStyleLineCap","textStrokeStyleLineDash","textStrokeStyleLineDashOffset","textStrokeStyleLineJoin","textStrokeStyleWidth","textStrokeStyleMiterLimit","textFont","getFont","textOffsetX","getOffsetX","textOffsetY","getOffsetY","textRotateWithView","textRotation","textScale","textText","textTextAlign","getTextAlign","textTextBaseline","getTextBaseline","Instruction","BEGIN_GEOMETRY","BEGIN_PATH","CLOSE_PATH","CUSTOM","DRAW_CHARS","END_GEOMETRY","FILL","MOVE_TO_LINE_TO","SET_FILL_STYLE","SET_STROKE_STYLE","STROKE","fillInstruction","strokeInstruction","beginPathInstruction","closePathInstruction","CanvasLineStringReplay","drawFlatCoordinates_","moveToLineToInstruction","updateStrokeStyle","applyStroke","lastStroke","CanvasPolygonReplay","drawFlatCoordinatess_","numEnds","setFillStrokeStyles_","circleInstruction","updateFillStyle","createFill","maxLineWidth","alignFill_","beginGeometryInstruction1_","beginGeometryInstruction2_","bufferedMaxExtent_","coordinateCache_","renderedTransform_","tmpExtent","replayTextBackground_","p1","p2","p3","p4","fill_","setStrokeStyle_","replayImage_","snapToPixel","fillStroke","boxW","boxH","boxX","boxY","strokePadding","declutterArgs","applyPixelRatio","dashArray","dash","closed","skipFirst","getBufferedMaxExtent","lastCoord","nextCoord","skipped","lastRel","nextRel","drawCustomCoordinates_","replayEnds","replayEnd","replayBegin","replayEndss","myEnds","repeatSize","instruction","renderDeclutter_","groupCount","collides","declutterData","replay_","skippedFeaturesHash","featureCallback","opt_hitExtent","skipFeatures","dd","prevX","prevY","roundX","roundY","pendingFill","pendingStroke","lastFillInstruction","lastStrokeInstruction","coordinateCache","batchSize","rotateWithView","backgroundFill","backgroundStroke","baseline","fillKey","strokeKey","strokeWidth","textKey","pathLength","textLength","textStates","TEXT_ALIGN","cc","chars","replay","replayHitDetection","opt_featureCallback","createStroke","currentFillStyle","currentStrokeStyle","currentLineCap","currentLineDash","currentLineDashOffset","currentLineJoin","currentLineWidth","currentMiterLimit","endGeometryInstruction","getCircleArray","replayDeclutter","BATCH_CONSTRUCTORS","CanvasTextReplay","CanvasReplayGroup","opt_renderBuffer","declutterTree_","tolerance_","maxExtent_","overlaps_","resolution_","replaysByZIndex_","hitDetectionContext_","hitDetectionTransform_","circleArrayCache","fillCircleArrayRowToMiddle","arraySize","declutterReplays","zs","zz","replayData","addDeclutter","group","clip","flatClipCoords","getClipCoords","hasReplays","replays","candidates","zKey","replayKey","contextSize","clearRect","hitExtent","mask","declutteredFeatures","entry","imageData","getImageData","ReplayType","zIndexKey","ORDER","getReplays","opt_replayTypes","opt_declutterReplays","save","replayTypes","restore","measureTextWidths","labels_","fillStates","strokeStates","textKey_","fillKey_","strokeKey_","widths_","prune","widths","numLines","currentWidth","placement","TextPlacement","LINE","flatOffset","flatEnd","oo","range","drawChars_","drawTextImage_","containsKey","align","lineHeight","renderWidth","leftRight","getOverflow","getMaxAngle","getPlacement","getBackgroundFill","getBackgroundStroke","getPadding","LayerRenderer","layer_","createLoadedTileFinder","tiles","forEachLoadedTile","handleImageChange_","renderIfReadyAndVisible","loadImage","imageState","scheduleExpireCache","tileSource","canExpireCache","postRenderFunction","expireCache","updateUsedTiles","manageTilePyramid","currentZ","preload","opt_tileCallback","getTile","isKeyQueued","getTileCoordCenter","useTile","sortByZIndex","MapRenderer","layerRenderers_","layerRendererListeners_","layerRendererConstructors_","constructors","getLayerRendererConstructors","calculateMatrices2D","removeLayerRendererByKey_","expireIconCache","iconImageCache","expire","viewResolution","translatedCoordinate","projectionExtent","worldWidth","worldsAway","numLayers","layerRenderer","getLayerRenderer","getWrapX","hasFeature","layerKey","candidate","handleLayerRendererChange_","getLayerRendererByKey","getLayerRenderers","removeUnusedLayerRenderers_","scheduleExpireIconCache","scheduleRemoveUnusedLayerRenderers","state1","state2","imageLayer","IntermediateCanvasRenderer","imageTransform_","skippedFeatures_","vectorRenderer_","layerRendererConstructors","mapRenderer","getImageTransform","prepareFrame","viewCenter","imageSource","vectorRenderer","renderedExtent","ENABLE_RASTER_REPROJECTION","skippedFeatures","imageFrameState","newSkippedFeatures","replayGroupChanged","compose","imageExtent","imageResolution","imagePixelRatio","coordinateToCanvasPixelTransform","renderedResolution","CanvasLayerRenderer","hitCanvasContext_","composeFrame","preCompose","clipped","imageTransform","dw","dh","postCompose","forEachLayerAtCoordinate","topLeft","topRight","bottomRight","bottomLeft","dispatchComposeEvent_","opt_transform","composeEvent","dispatchRenderEvent","insertBefore","childNodes","tileLayer","oversampling_","renderedExtent_","renderedRevision","renderedTiles","newTiles_","tmpTileRange_","zDirection","isDrawableTile_","tileState","useInterimTilesOnError","getUseInterimTilesOnError","setState","getPreload","getInterimTile","sourceRevision","getTileGridForProjection","oversampling","getTileRangeExtent","tilePixelRatio","getTilePixelRatio","tilesToDrawByZ","findLoadedTiles","animatingOrInteracting","tmpTileRange","inTransition","getAlpha","childTileRange","getTileCoordChildTileRange","covered","forEachTileCoordParentTileRange","tilePixelSize","getTilePixelSize","currentScale","currentTilePixelSize","tileExtent","tileGutter","tilesToDraw","getGutter","tileCoordKey","getTileCoord","drawTileImage","gutter","transition","getOpaque","alphaChanged","endTransition","vectorLayer","dirty_","renderedRevision_","renderedResolution_","renderedRenderOrder_","replayGroup_","handleFontsChanged_","vectorSource","clipExtent","replayGroup","drawOffsetX","drawOffsetY","replayContext","transparentLayer","hasRenderListeners","drawWidth","drawHeight","drawSize","world","mainContextAlpha","handleStyleImageChange_","animating","interacting","frameStateExtent","vectorLayerRevision","vectorLayerRenderBuffer","vectorLayerRenderOrder","defaultRenderOrder","getOverlaps","loadFeatures","styleFunction","dirty","renderFeature","forEachFeatureInExtent","loading","IMAGE_REPLAYS","VECTOR_REPLAYS","renderedLayerRevision_","tmpTransform_","VectorTileRenderType","createReplayGroup_","renderTileImage_","layerRevision","revision","replayState","getReplayState","renderedRenderOrder","sourceTileGrid","getTileGrid","zIndexKeys","tt","sourceTile","tileKeys","sourceTileCoord","sourceTileExtent","sharedExtent","bufferedExtent","tileProjection","reproject","setProjection","setReplayGroup","getReplayGroup","getReplayTransform_","renderResolution","clips","worldOffset","currentClip","renderedTileRevision","wrappedTileCoord","pixelScale","defaultOrder","getSquaredTolerance","getTolerance","SIMPLIFY_TOLERANCE","GEOMETRY_RENDERERS","renderPointGeometry","renderLineStringGeometry","renderPolygonGeometry","renderMultiPointGeometry","renderMultiLineStringGeometry","renderMultiPolygonGeometry","renderGeometryCollectionGeometry","renderCircleGeometry","feature1","feature2","circleReplay","textReplay","getImageState","unlistenImageChange","listenImageChange","renderFeatureInternal","renderGeometry","geometryRenderer","lineStringReplay","polygonReplay","imageReplay","ERROR_THRESHOLD","createSnapToResolutions","createSnapToPower","opt_maxLevel","oldLevel","newLevel","createSnapToN","createSnapToZero","opt_tolerance","hasArea","toSize","ratio","Source","attributions_","adaptAttributions_","wrapX_","attributionLike","refresh","setAttributions","opt_feature","format_","url_","loader","strategy_","strategy","allStrategy","featuresRtree_","loadedExtentsRtree_","nullGeometryFeatures_","idIndex_","undefIdIndex_","featureChangeKeys_","featuresCollection_","collection","addFeaturesInternal","bindFeaturesCollection_","addFeatureInternal","featureKey","addToIndex_","setupChangeEvents_","valid","newFeatures","geometryFeatures","modifyingCollection","opt_fast","featureId","removeFeatureInternal","clearEvent","forEachFeature","forEachFeatureAtCoordinateDirect","forEachFeatureIntersectingExtent","getAll","getFeaturesAtCoordinate","getFeaturesInExtent","getClosestFeatureToCoordinate","opt_filter","closestFeature","previousMinSquaredDistance","minDistance","getFeatureById","getFormat","getUrl","sid","removeFromIdIndex_","CHANGEFEATURE","loadedExtentsRtree","extentsToLoad","extentToLoad","alreadyLoaded","removeLoadedExtent","removed","setLoader","DEFAULT_RADIUS","c1","c2","lat1","lat2","deltaLatBy2","deltaLonBy2","getLengthInternal","getAreaInternal","bearing","lon1","dByR","lat","padNumber","compareVersions","opt_precision","numberString","decimal","v1","v2","s1","s2","n1","n2","opt_highWaterMark","highWaterMark","count_","entries_","oldest_","newest_","value_","key_","newer","older","peekLast","peekLastKey","peekFirstKey","priorityFunction","keyFunction","priorityFunction_","keyFunction_","elements_","priorities_","queuedElements_","elements","priorities","siftUp_","elementKey","priority","siftDown_","getLeftChildIndex_","getRightChildIndex_","getParentIndex_","heapify_","isQueued","startIndex","lIndex","rIndex","smallerChildIndex","parentIndex","opt_maxEntries","rbush_","items_","items","search","forEach_","rbush","CircleStyle","RegularShape","atlasManager","atlasManager_","setScale","radius_","Fill","color_","checksum_","setColor","getChecksum","Icon","normalizedAnchor_","anchorOrigin_","anchorOrigin","IconOrigin","anchorXUnits_","anchorXUnits","IconAnchorUnits","FRACTION","anchorYUnits_","anchorYUnits","crossOrigin_","crossOrigin","img","imgSize","src","iconImage_","offset_","offsetOrigin_","offsetOrigin","origin_","size_","ImageStyle","getSrc","getImageSize","getHitDetectionImageSize","iconImageSize","IconImage","Image","imageListenerKeys_","imageState_","src_","tainting_","determineTainting_","iconImage","dispatchChangeEvent_","handleImageError_","unlistenImage_","handleImageLoad_","replaceColor_","fillRect","imgData","putImageData","IconImageCache","cache_","cacheSize_","maxCacheSize_","colorString","maxCacheSize","shared","setRotateWithView","setSnapToPixel","checksums_","hitDetectionCanvas_","radius1","radius2_","radius2","stroke_","imageSize_","hitDetectionImageSize_","getRadius2","renderOptions","draw_","createHitDetectionCanvas_","hasCustomHitDetectionImage","renderHitDetectionCallback","drawHitDetectionCanvas_","info","hitImage","angle0","radiusC","strokeChecksum","fillChecksum","recalculate","checksum","Stroke","lineCap_","lineDash_","lineDashOffset_","lineJoin_","miterLimit_","setLineCap","setLineDashOffset","setLineJoin","setMiterLimit","setWidth","toFunction","createEditingStyle","defaultGeometryFunction","zIndex_","setRenderer","setFill","setImage","setStroke","setText","defaultStyles","blue","DEFAULT_FILL_COLOR","Text","font_","textAlign_","textBaseline_","maxAngle_","placement_","overflow_","offsetX_","offsetY_","backgroundFill_","backgroundStroke_","padding_","setOverflow","setFont","setMaxAngle","setOffsetX","setOffsetY","setPlacement","setTextAlign","setTextBaseline","setBackgroundFill","setBackgroundStroke","setPadding","DEFAULT_MAX_ZOOM","reset","multiply","setFromArray","invert","determinant","tmp_","transform1","transform2","a1","b1","d1","e1","f1","a2","b2","e2","f2","det","ONE","SRC_ALPHA","COLOR_ATTACHMENT0","COLOR_BUFFER_BIT","TRIANGLES","TRIANGLE_STRIP","ONE_MINUS_SRC_ALPHA","ELEMENT_ARRAY_BUFFER","STREAM_DRAW","STATIC_DRAW","DYNAMIC_DRAW","CULL_FACE","BLEND","STENCIL_TEST","DEPTH_TEST","SCISSOR_TEST","UNSIGNED_BYTE","UNSIGNED_SHORT","UNSIGNED_INT","FLOAT","RGBA","FRAGMENT_SHADER","VERTEX_SHADER","LINK_STATUS","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE_2D","TEXTURE0","CLAMP_TO_EDGE","COMPILE_STATUS","FRAMEBUFFER","CONTEXT_IDS","opt_attributes","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","run","nextTick","Item","browser","env","argv","version","versions","noop","addListener","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","cwd","chdir","dir","umask","factory","quickselect","quickselectStep","defaultCompare","sd","newLeft","newRight","swap","maxEntries","_maxEntries","_minEntries","_initFormat","_all","toBBox","nodesToSearch","childBBox","children","leaf","_build","_splitRoot","tmpNode","_insert","createNode","equalsFn","indexes","goingUp","findItem","_condense","compareMinX","compareNodeMinX","compareMinY","compareNodeMinY","toJSON","fromJSON","M","calcBBox","N2","N1","right2","right3","multiSelect","_chooseSubtree","level","targetNode","enlargement","minEnlargement","bboxArea","enlargedArea","isNode","insertPath","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","bbox1","bbox2","overlap","minOverlap","distBBox","intersectionArea","xMargin","_allDistMargin","yMargin","leftBBox","rightBBox","bboxMargin","siblings","compareArr","Function","destNode","css","location","baseUrl","protocol","host","currentDir","pathname","fixedCss","fullMatch","origUrl","unquotedOrigUrl","trim","$1","newUrl","copy","readUInt8","formatRegExp","isString","isNull","isObject","deprecate","msg","isUndefined","noDeprecation","warned","deprecated","throwDeprecation","traceDeprecation","trace","debugs","debugEnviron","debuglog","NODE_DEBUG","RegExp","pid","opts","seen","stylize","stylizeNoColor","colors","isBoolean","showHidden","_extend","customInspect","stylizeWithColor","formatValue","styleType","arrayToHash","hash","recurseTimes","primitive","formatPrimitive","visibleKeys","getOwnPropertyNames","formatError","braces","toUTCString","formatArray","formatProperty","reduceToSingleString","simple","isNumber","desc","getOwnPropertyDescriptor","line","numLinesEst","reduce","cur","ar","isNullOrUndefined","isSymbol","objectToString","pad","months","timestamp","getHours","getMinutes","getSeconds","getDate","getMonth","prop","eval","getValue","olLayer","spriteData","spriteImageUrl","getFonts","spriteImage","spriteImgSize","measureCache","wrapText","em","wrappedText","oneEm","words","word","allLayers","layersBySourceLayer","mapboxLayers","mapboxSource","layerId","sourceLayer","functionCache","filterCache","textHalo","textColor","patternCache","stylesLength","layerData","emptyObj","paint","visibility","minzoom","maxzoom","evaluateFilter","strokeColor","fillIcon","icon","fromTemplate","icon_cache_key","pattern","spriteImageData","createPattern","colorWithOpacity","hasImage","iconImg","skipLabel","styleGeom","iconSize","iconColor","circleRadius","circleStrokeColor","circleColor","circleOpacity","circleStrokeWidth","cache_key","textField","textSize","fontArray","textTransform","wrappedLabel","textAnchor","textOffset","haloColor","expressionData","rawExpression","compiledExpression","zoomObj","layoutOrPaint","functions","isExpr","colorCache","colorData","templateRegEx"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;AClFA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;AAEA,IAAMA,QAAQ,IAAIC,gBAAJ,CAAgB;AAC5BC,aAAW,IADiB;AAE5BC,UAAQ,IAAIC,gBAAJ,CAAiB;AACvBC,YAAQ,IAAIC,iBAAJ,EADe;AAEvBC,SAAK;AAFkB,GAAjB;AAFoB,CAAhB,CAAd;;AAQA,IAAMC,MAAM,IAAIC,aAAJ,CAAQ;AAClBC,UAAQ,KADU;AAElBC,QAAM,IAAIC,cAAJ,CAAS;AACbC,YAAQ,CAAC,CAAC,kBAAF,EAAsB,cAAtB,CADK;AAEbC,UAAM;AAFO,GAAT;AAFY,CAAR,CAAZ;;AAQAC,MAAM,kBAAN,EACGC,IADH,CACQ;AAAA,SAAKC,EAAEC,IAAF,EAAL;AAAA,CADR,EAEGF,IAFH,CAEQ,UAACG,OAAD,EAAa;AACjB,+BAAcnB,KAAd,EAAqBmB,OAArB,EAA8B,QAA9B;AACAX,MAAIY,QAAJ,CAAapB,KAAb;AACD,CALH,E;;;;;;;;;;;;;;;;;;ACxBA;;;;;;AAEA,SAASqB,KAAT,CAAerB,KAAf,EAAsBsB,MAAtB,EAA8B;AAC1B,QAAMC,SAAS,EAAf;;AAEA,SAAK,IAAMC,CAAX,IAAgBxB,KAAhB,EAAuB;AACnB,YAAIwB,MAAM,KAAV,EAAiB;AACbD,mBAAOC,CAAP,IAAYxB,MAAMwB,CAAN,CAAZ;AACH;AACJ;;AAEDC,6BAAcC,OAAd,CAAsB,UAACF,CAAD,EAAO;AACzB,YAAIA,KAAKF,MAAT,EAAiB;AACbC,mBAAOC,CAAP,IAAYF,OAAOE,CAAP,CAAZ;AACH;AACJ,KAJD;;AAMA,WAAOD,MAAP;AACH;;kBAEcI,W;;AAEf;;;;;;;;;;;;;;AAaA,SAASA,WAAT,CAAqBC,MAArB,EAA6B;AACzBA,aAASA,OAAOC,KAAP,EAAT;;AAEA,QAAMrB,MAAMsB,OAAOC,MAAP,CAAc,IAAd,CAAZ;AACA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIJ,OAAOK,MAA3B,EAAmCD,GAAnC,EAAwC;AACpCxB,YAAIoB,OAAOI,CAAP,EAAUE,EAAd,IAAoBN,OAAOI,CAAP,CAApB;AACH;;AAED,SAAK,IAAIA,KAAI,CAAb,EAAgBA,KAAIJ,OAAOK,MAA3B,EAAmCD,IAAnC,EAAwC;AACpC,YAAI,SAASJ,OAAOI,EAAP,CAAb,EAAwB;AACpBJ,mBAAOI,EAAP,IAAYX,MAAMO,OAAOI,EAAP,CAAN,EAAiBxB,IAAIoB,OAAOI,EAAP,EAAUG,GAAd,CAAjB,CAAZ;AACH;AACJ;;AAED,WAAOP,MAAP;AACH,C;;;;;;;;;;;;;;;;;;;;;;ACjDD;;AAEA;;;;AACA;;;;AACA;;;;;;;;IAYMQ,kB;AAQF,gCAAYC,IAAZ,EAA0BC,IAA1B,EAAsCC,QAAtC,EAA0DC,IAA1D,EAAmF;AAAA;;AAC/E,aAAKH,IAAL,GAAYA,IAAZ;AACA,aAAKC,IAAL,GAAYA,IAAZ;AACA,aAAKG,SAAL,GAAiBF,QAAjB;AACA,aAAKC,IAAL,GAAYA,IAAZ;AACH;;;;iCAEQE,G,EAAwB;AAC7B,mBAAO,KAAKD,SAAL,CAAeC,GAAf,EAAoB,KAAKF,IAAzB,CAAP;AACH;;;kCAESG,E,EAA0B;AAChC,iBAAKH,IAAL,CAAUd,OAAV,CAAkBiB,EAAlB;AACH;;;0CAEiB;AACd,mBAAO,CAACC,SAAD,CAAP;AACH;;;oCAEW;AACR,mBAAO,CAAC,KAAKP,IAAN,EAAYQ,MAAZ,CAAmB,KAAKL,IAAL,CAAUhC,GAAV,CAAc;AAAA,uBAAOsC,IAAIC,SAAJ,EAAP;AAAA,aAAd,CAAnB,CAAP;AACH;;;8BAEYP,I,EAAoBQ,O,EAAsC;AACnE,gBAAMC,KAAcT,KAAK,CAAL,CAApB;AACA,gBAAMU,aAAad,mBAAmBe,WAAnB,CAA+BF,EAA/B,CAAnB;AACA,gBAAI,CAACC,UAAL,EAAiB;AACb,uBAAOF,QAAQI,KAAR,0BAAqCH,EAArC,gEAAoG,CAApG,CAAP;AACH;;AAED;AACA,gBAAMX,OAAOe,MAAMC,OAAN,CAAcJ,UAAd,IACTA,WAAW,CAAX,CADS,GACOA,WAAWZ,IAD/B;;AAGA,gBAAMiB,qBAAqBF,MAAMC,OAAN,CAAcJ,UAAd,IACvB,CAAC,CAACA,WAAW,CAAX,CAAD,EAAgBA,WAAW,CAAX,CAAhB,CAAD,CADuB,GAEvBA,WAAWM,SAFf;;AAIA,gBAAMA,YAAYD,mBAAmBE,MAAnB,CAA0B;AAAA;AAAA,oBAAEC,SAAF;;AAAA,uBACxC,CAACL,MAAMC,OAAN,CAAcI,SAAd,CAAD,IAA6B;AAC7BA,0BAAUzB,MAAV,KAAqBO,KAAKP,MAAL,GAAc,CAFK,CAEH;AAFG;AAAA,aAA1B,CAAlB;;AAKA;AACA,gBAAM0B,aAAgC,EAAtC;AACA,iBAAK,IAAI3B,IAAI,CAAb,EAAgBA,IAAIQ,KAAKP,MAAzB,EAAiCD,GAAjC,EAAsC;AAClC,oBAAMc,MAAMN,KAAKR,CAAL,CAAZ;AACA,oBAAI4B,iBAAJ;AACA,oBAAIJ,UAAUvB,MAAV,KAAqB,CAAzB,EAA4B;AACxB,wBAAM4B,SAASL,UAAU,CAAV,EAAa,CAAb,CAAf;AACAI,+BAAWP,MAAMC,OAAN,CAAcO,MAAd,IACPA,OAAO7B,IAAI,CAAX,CADO,GAEP6B,OAAOvB,IAFX;AAGH;AACD,oBAAMwB,SAASd,QAAQe,KAAR,CAAcjB,GAAd,EAAmB,IAAIa,WAAW1B,MAAlC,EAA0C2B,QAA1C,CAAf;AACA,oBAAI,CAACE,MAAL,EAAa,OAAO,IAAP;AACbH,2BAAWK,IAAX,CAAgBF,MAAhB;AACH;;AAED,gBAAIG,mBAAoC,IAAxC;;AApCmE;AAAA;AAAA;;AAAA;AAsCnE,qCAAiCT,SAAjC,8HAA4C;AAAA;;AAAA;;AAAA,wBAAhCK,OAAgC;AAAA,wBAAxBtB,QAAwB;;AACxC;AACA;AACA0B,uCAAmB,IAAIC,yBAAJ,CAAmBlB,QAAQmB,QAA3B,EAAqCnB,QAAQoB,IAA7C,EAAmD,IAAnD,EAAyDpB,QAAQqB,KAAjE,CAAnB;;AAEA,wBAAIhB,MAAMC,OAAN,CAAcO,OAAd,CAAJ,EAA2B;AACvB,4BAAIA,QAAO5B,MAAP,KAAkB0B,WAAW1B,MAAjC,EAAyC;AACrCgC,6CAAiBb,KAAjB,eAAmCS,QAAO5B,MAA1C,8BAAyE0B,WAAW1B,MAApF;AACA;AACH;AACJ;;AAED,yBAAK,IAAID,KAAI,CAAb,EAAgBA,KAAI2B,WAAW1B,MAA/B,EAAuCD,IAAvC,EAA4C;AACxC,4BAAM4B,aAAWP,MAAMC,OAAN,CAAcO,OAAd,IAAwBA,QAAO7B,EAAP,CAAxB,GAAoC6B,QAAOvB,IAA5D;AACA,4BAAMQ,OAAMa,WAAW3B,EAAX,CAAZ;AACAiC,yCAAiBpB,MAAjB,CAAwBb,KAAI,CAA5B,EAA+BsC,YAA/B,CAA4CV,UAA5C,EAAsDd,KAAIR,IAA1D;AACH;;AAED,wBAAI2B,iBAAiBM,MAAjB,CAAwBtC,MAAxB,KAAmC,CAAvC,EAA0C;AACtC,+BAAO,IAAIG,kBAAJ,CAAuBa,EAAvB,EAA2BX,IAA3B,EAAiCC,QAAjC,EAA2CoB,UAA3C,CAAP;AACH;AACJ;AA3DkE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AA6DnE,kCAAO,CAACM,gBAAD,IAAqBA,iBAAiBM,MAAjB,CAAwBtC,MAAxB,GAAiC,CAA7D;;AAEA,gBAAIuB,UAAUvB,MAAV,KAAqB,CAAzB,EAA4B;AACxBe,wBAAQuB,MAAR,CAAeP,IAAf,CAAoBQ,KAApB,CAA0BxB,QAAQuB,MAAlC,EAA0CN,iBAAiBM,MAA3D;AACH,aAFD,MAEO;AACH,oBAAMX,YAAWJ,UAAUvB,MAAV,GAAmBuB,SAAnB,GAA+BD,kBAAhD;AACA,oBAAMkB,aAAab,UACdpD,GADc,CACV;AAAA;AAAA,wBAAEqD,MAAF;;AAAA,2BAAca,mBAAmBb,MAAnB,CAAd;AAAA,iBADU,EAEdc,IAFc,CAET,KAFS,CAAnB;AAGA,oBAAMC,cAAcjB,WACfnD,GADe,CACX;AAAA,2BAAO,qBAASsC,IAAIR,IAAb,CAAP;AAAA,iBADW,EAEfqC,IAFe,CAEV,IAFU,CAApB;AAGA3B,wBAAQI,KAAR,iCAA4CqB,UAA5C,qBAAsEG,WAAtE;AACH;;AAED,mBAAO,IAAP;AACH;;;iCAGGT,Q,EACAhB,W,EACF;AACE,kCAAO,CAACf,mBAAmBe,WAA3B;AACAf,+BAAmBe,WAAnB,GAAiCA,WAAjC;AACA,iBAAK,IAAMd,IAAX,IAAmBc,WAAnB,EAAgC;AAC5BgB,yBAAS9B,IAAT,IAAiBD,kBAAjB;AACH;AACJ;;;;;;AAGL,SAASsC,kBAAT,CAA4BhB,SAA5B,EAA0D;AACtD,QAAIL,MAAMC,OAAN,CAAcI,SAAd,CAAJ,EAA8B;AAC1B,qBAAWA,UAAUlD,GAAV,CAAcqE,eAAd,EAAwBF,IAAxB,CAA6B,IAA7B,CAAX;AACH,KAFD,MAEO;AACH,qBAAW,qBAASjB,UAAUpB,IAAnB,CAAX;AACH;AACJ;;kBAEcF,kB;;;;;;;;;;;;;;;;;;;;AClJf;;AAEA;;AACA;;;;;;;;AAOA,IAAM0C,QAAQ;AACVC,YAAQC,iBADE;AAEVC,YAAQC,iBAFE;AAGVC,aAASC;AAHC,CAAd;;IAMMC,c;AAIF,4BAAY/C,IAAZ,EAA6BgD,KAA7B,EAAgD;AAAA;;AAC5C,aAAKhD,IAAL,GAAYA,IAAZ;AACA,aAAKgD,KAAL,GAAaA,KAAb;AACH;;;;iCAoCQ5C,G,EAAwB;AAC7B,gBAAM6C,QAAQ,KAAKD,KAAL,CAAW/C,QAAX,CAAoBG,GAApB,CAAd;AACA,gBAAMU,QAAQ,yBAAa,KAAKd,IAAlB,EAAwB,oBAAOiD,KAAP,CAAxB,CAAd;AACA,gBAAInC,KAAJ,EAAW;AACP,sBAAM,IAAIoC,uBAAJ,mCAAiD,qBAAS,KAAKlD,IAAd,CAAjD,oBAAmF,qBAAS,oBAAOiD,KAAP,CAAT,CAAnF,eAAN;AACH;AACD,mBAAOA,KAAP;AACH;;;kCAES5C,E,EAA0B;AAChCA,eAAG,KAAK2C,KAAR;AACH;;;0CAEiB;AACd,mBAAO,KAAKA,KAAL,CAAWG,eAAX,EAAP;AACH;;;oCAEW;AACR,gBAAMC,aAAa,CAAC,OAAD,CAAnB;AACA,gBAAMC,WAAW,KAAKrD,IAAL,CAAUqD,QAA3B;AACA,gBAAIA,SAASC,IAAT,KAAkB,QAAlB,IACAD,SAASC,IAAT,KAAkB,QADlB,IAEAD,SAASC,IAAT,KAAkB,SAFtB,EAEiC;AAC7BF,2BAAW1B,IAAX,CAAgB2B,SAASC,IAAzB;AACA,oBAAMC,IAAI,KAAKvD,IAAL,CAAUuD,CAApB;AACA,oBAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B;AACvBH,+BAAW1B,IAAX,CAAgB6B,CAAhB;AACH;AACJ;AACDH,uBAAW1B,IAAX,CAAgB,KAAKsB,KAAL,CAAWvC,SAAX,EAAhB;AACA,mBAAO2C,UAAP;AACH;;;8BAjEYlD,I,EAAoBQ,O,EAAsC;AACnE,gBAAIR,KAAKP,MAAL,GAAc,CAAd,IAAmBO,KAAKP,MAAL,GAAc,CAArC,EACI,OAAOe,QAAQI,KAAR,gDAA0DZ,KAAKP,MAAL,GAAc,CAAxE,gBAAP;;AAEJ,gBAAI0D,iBAAJ;AACA,gBAAIE,UAAJ;AACA,gBAAIrD,KAAKP,MAAL,GAAc,CAAlB,EAAqB;AACjB,oBAAMK,QAAOE,KAAK,CAAL,CAAb;AACA,oBAAI,OAAOF,KAAP,KAAgB,QAAhB,IAA4B,EAAEA,SAAQwC,KAAV,CAAhC,EACI,OAAO9B,QAAQI,KAAR,CAAc,0EAAd,EAA0F,CAA1F,CAAP;AACJuC,2BAAWb,MAAMxC,KAAN,CAAX;AACH,aALD,MAKO;AACHqD,2BAAWG,gBAAX;AACH;;AAED,gBAAItD,KAAKP,MAAL,GAAc,CAAlB,EAAqB;AACjB,oBACI,OAAOO,KAAK,CAAL,CAAP,KAAmB,QAAnB,IACAA,KAAK,CAAL,IAAU,CADV,IAEAA,KAAK,CAAL,MAAYuD,KAAKC,KAAL,CAAWxD,KAAK,CAAL,CAAX,CAHhB,EAIE;AACE,2BAAOQ,QAAQI,KAAR,CAAc,mEAAd,EAAmF,CAAnF,CAAP;AACH;AACDyC,oBAAIrD,KAAK,CAAL,CAAJ;AACH;;AAED,gBAAMF,OAAO,kBAAMqD,QAAN,EAAgBE,CAAhB,CAAb;;AAEA,gBAAMP,QAAQtC,QAAQe,KAAR,CAAcvB,KAAKA,KAAKP,MAAL,GAAc,CAAnB,CAAd,EAAqCO,KAAKP,MAAL,GAAc,CAAnD,EAAsD6D,gBAAtD,CAAd;AACA,gBAAI,CAACR,KAAL,EAAY,OAAO,IAAP;;AAEZ,mBAAO,IAAID,cAAJ,CAAmB/C,IAAnB,EAAyBgD,KAAzB,CAAP;AACH;;;;;;kBAoCUD,c;;;;;;;;;;;;;;;;;;;;AC7Ff;;;;AAEA;;AASA;;;;AACA;;;;;;;;AAOA,IAAMP,QAAQ;AACVC,YAAQC,iBADE;AAEVC,YAAQC,iBAFE;AAGVC,aAASC,kBAHC;AAIVa,YAAQC;AAJE,CAAd;;IAOMC,S;AAIF,uBAAY7D,IAAZ,EAAwBE,IAAxB,EAAiD;AAAA;;AAC7C,aAAKF,IAAL,GAAYA,IAAZ;AACA,aAAKE,IAAL,GAAYA,IAAZ;AACH;;;;iCAqBQE,G,EAAwB;AAC7B,iBAAK,IAAIV,IAAI,CAAb,EAAgBA,IAAI,KAAKQ,IAAL,CAAUP,MAA9B,EAAsCD,GAAtC,EAA2C;AACvC,oBAAMuD,QAAQ,KAAK/C,IAAL,CAAUR,CAAV,EAAaO,QAAb,CAAsBG,GAAtB,CAAd;AACA,oBAAMU,QAAQ,yBAAa,KAAKd,IAAlB,EAAwB,oBAAOiD,KAAP,CAAxB,CAAd;AACA,oBAAI,CAACnC,KAAL,EAAY;AACR,2BAAOmC,KAAP;AACH,iBAFD,MAEO,IAAIvD,MAAM,KAAKQ,IAAL,CAAUP,MAAV,GAAmB,CAA7B,EAAgC;AACnC,0BAAM,IAAIuD,uBAAJ,mCAAiD,qBAAS,KAAKlD,IAAd,CAAjD,oBAAmF,qBAAS,oBAAOiD,KAAP,CAAT,CAAnF,eAAN;AACH;AACJ;;AAED,kCAAO,KAAP;AACA,mBAAO,IAAP;AACH;;;kCAES5C,E,EAA0B;AAChC,iBAAKH,IAAL,CAAUd,OAAV,CAAkBiB,EAAlB;AACH;;;0CAEiB;AAAA;;AACd,mBAAO,YAAGE,MAAH,gCAAa,KAAKL,IAAL,CAAUhC,GAAV,CAAc,UAACsC,GAAD;AAAA,uBAASA,IAAI2C,eAAJ,EAAT;AAAA,aAAd,CAAb,EAAP;AACH;;;oCAEW;AACR,mBAAO,CAAC,KAAKnD,IAAL,CAAUsD,IAAX,EAAiB/C,MAAjB,CAAwB,KAAKL,IAAL,CAAUhC,GAAV,CAAc;AAAA,uBAAOsC,IAAIC,SAAJ,EAAP;AAAA,aAAd,CAAxB,CAAP;AACH;;;8BA5CYP,I,EAAoBQ,O,EAAsC;AACnE,gBAAIR,KAAKP,MAAL,GAAc,CAAlB,EACI,OAAOe,QAAQI,KAAR,mCAAP;;AAEJ,gBAAMf,OAAgBG,KAAK,CAAL,CAAtB;AACA,kCAAOsC,MAAMzC,IAAN,CAAP,EAAoBA,IAApB;;AAEA,gBAAMC,OAAOwC,MAAMzC,IAAN,CAAb;;AAEA,gBAAMyB,SAAS,EAAf;AACA,iBAAK,IAAI9B,IAAI,CAAb,EAAgBA,IAAIQ,KAAKP,MAAzB,EAAiCD,GAAjC,EAAsC;AAClC,oBAAMsD,QAAQtC,QAAQe,KAAR,CAAcvB,KAAKR,CAAL,CAAd,EAAuBA,CAAvB,EAA0B8D,gBAA1B,CAAd;AACA,oBAAI,CAACR,KAAL,EAAY,OAAO,IAAP;AACZxB,uBAAOE,IAAP,CAAYsB,KAAZ;AACH;;AAED,mBAAO,IAAIa,SAAJ,CAAc7D,IAAd,EAAoBwB,MAApB,CAAP;AACH;;;;;;kBA8BUqC,S;;;;;;;;;;;;;;;;;;;;AClFf;;AAEA;;;;;;;;IAQMC,E;AAKF,gBAAY9D,IAAZ,EAAwB+D,KAAxB,EAA2Cf,KAA3C,EAA8D;AAAA;;AAC1D,aAAKhD,IAAL,GAAYA,IAAZ;AACA,aAAK+D,KAAL,GAAaA,KAAb;AACA,aAAKf,KAAL,GAAaA,KAAb;AACH;;;;iCAeQ5C,G,EAAwB;AAC7B,gBAAM2D,QAAU,KAAKA,KAAL,CAAW9D,QAAX,CAAoBG,GAApB,CAAhB;AACA,gBAAM4D,QAAU,KAAKhB,KAAL,CAAW/C,QAAX,CAAoBG,GAApB,CAAhB;;AAEA,gBAAI2D,QAAQ,CAAZ,EAAe;AACX,sBAAM,IAAIb,uBAAJ,iCAA+Ca,KAA/C,WAAN;AACH;;AAED,gBAAIA,SAASC,MAAMrE,MAAnB,EAA2B;AACvB,sBAAM,IAAIuD,uBAAJ,iCAA+Ca,KAA/C,YAA0DC,MAAMrE,MAAN,GAAe,CAAzE,QAAN;AACH;;AAED,gBAAIoE,UAAUN,KAAKC,KAAL,CAAWK,KAAX,CAAd,EAAiC;AAC7B,sBAAM,IAAIb,uBAAJ,gDAA8Da,KAA9D,eAAN;AACH;;AAED,mBAAOC,MAAMD,KAAN,CAAP;AACH;;;kCAES1D,E,EAA0B;AAChCA,eAAG,KAAK0D,KAAR;AACA1D,eAAG,KAAK2C,KAAR;AACH;;;0CAEiB;AACd,mBAAO,CAAC1C,SAAD,CAAP;AACH;;;oCAEW;AACR,mBAAO,CAAC,IAAD,EAAO,KAAKyD,KAAL,CAAWtD,SAAX,EAAP,EAA+B,KAAKuC,KAAL,CAAWvC,SAAX,EAA/B,CAAP;AACH;;;8BA3CYP,I,EAAoBQ,O,EAAyB;AACtD,gBAAIR,KAAKP,MAAL,KAAgB,CAApB,EACI,OAAOe,QAAQI,KAAR,uCAAiDZ,KAAKP,MAAL,GAAc,CAA/D,gBAAP;;AAEJ,gBAAMoE,QAAQrD,QAAQe,KAAR,CAAcvB,KAAK,CAAL,CAAd,EAAuB,CAAvB,EAA0B0C,iBAA1B,CAAd;AACA,gBAAMI,QAAQtC,QAAQe,KAAR,CAAcvB,KAAK,CAAL,CAAd,EAAuB,CAAvB,EAA0B,kBAAMQ,QAAQuD,YAAR,IAAwBT,gBAA9B,CAA1B,CAAd;;AAEA,gBAAI,CAACO,KAAD,IAAU,CAACf,KAAf,EAAsB,OAAO,IAAP;;AAEtB,gBAAMkB,IAAgBlB,MAAMhD,IAA5B;AACA,mBAAO,IAAI8D,EAAJ,CAAOI,EAAEb,QAAT,EAAmBU,KAAnB,EAA0Bf,KAA1B,CAAP;AACH;;;;;;kBAmCUc,E;;;;;;;;;;;;;;;;;;;;;;ACnEf;;;;AAEA;;;;;;;;IASMK,I;AAMF,kBAAYnE,IAAZ,EAAwBoE,QAAxB,EAA4CC,SAA5C,EAAmE;AAAA;;AAC/D,aAAKrE,IAAL,GAAYA,IAAZ;AACA,aAAKoE,QAAL,GAAgBA,QAAhB;AACA,aAAKC,SAAL,GAAiBA,SAAjB;AACH;;;;iCAiCQjE,G,EAAwB;AAAA;AAAA;AAAA;;AAAA;AAC7B,qCAAiC,KAAKgE,QAAtC,8HAAgD;AAAA;;AAAA;;AAAA,wBAApCE,IAAoC;AAAA,wBAA9BC,UAA8B;;AAC5C,wBAAID,KAAKrE,QAAL,CAAcG,GAAd,CAAJ,EAAwB;AACpB,+BAAOmE,WAAWtE,QAAX,CAAoBG,GAApB,CAAP;AACH;AACJ;AAL4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAM7B,mBAAO,KAAKiE,SAAL,CAAepE,QAAf,CAAwBG,GAAxB,CAAP;AACH;;;kCAESC,E,EAA0B;AAAA;AAAA;AAAA;;AAAA;AAChC,sCAAiC,KAAK+D,QAAtC,mIAAgD;AAAA;;AAAA;;AAAA,wBAApCE,IAAoC;AAAA,wBAA9BC,UAA8B;;AAC5ClE,uBAAGiE,IAAH;AACAjE,uBAAGkE,UAAH;AACH;AAJ+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKhClE,eAAG,KAAKgE,SAAR;AACH;;;0CAEiB;AAAA;;AACd,mBAAO,aACF9D,MADE,iCACQ,KAAK6D,QAAL,CAAclG,GAAd,CAAkB;AAAA;AAAA,oBAAEsG,CAAF;AAAA,oBAAKC,GAAL;;AAAA,uBAAcA,IAAItB,eAAJ,EAAd;AAAA,aAAlB,CADR,GAEF5C,MAFE,CAEK,KAAK8D,SAAL,CAAelB,eAAf,EAFL,CAAP;AAGH;;;oCAEW;AACR,gBAAMC,aAAa,CAAC,MAAD,CAAnB;AACA,iBAAKsB,SAAL,CAAe,iBAAS;AAAEtB,2BAAW1B,IAAX,CAAgBiD,MAAMlE,SAAN,EAAhB;AAAqC,aAA/D;AACA,mBAAO2C,UAAP;AACH;;;8BA1DYlD,I,EAAoBQ,O,EAAyB;AACtD,gBAAIR,KAAKP,MAAL,GAAc,CAAlB,EACI,OAAOe,QAAQI,KAAR,qDAA+DZ,KAAKP,MAAL,GAAc,CAA7E,QAAP;AACJ,gBAAIO,KAAKP,MAAL,GAAc,CAAd,KAAoB,CAAxB,EACI,OAAOe,QAAQI,KAAR,wCAAP;;AAEJ,gBAAI8D,mBAAJ;AACA,gBAAIlE,QAAQuD,YAAR,IAAwBvD,QAAQuD,YAAR,CAAqBX,IAArB,KAA8B,OAA1D,EAAmE;AAC/DsB,6BAAalE,QAAQuD,YAArB;AACH;;AAED,gBAAMG,WAAW,EAAjB;AACA,iBAAK,IAAI1E,IAAI,CAAb,EAAgBA,IAAIQ,KAAKP,MAAL,GAAc,CAAlC,EAAqCD,KAAK,CAA1C,EAA6C;AACzC,oBAAM4E,OAAO5D,QAAQe,KAAR,CAAcvB,KAAKR,CAAL,CAAd,EAAuBA,CAAvB,EAA0BoD,kBAA1B,CAAb;AACA,oBAAI,CAACwB,IAAL,EAAW,OAAO,IAAP;;AAEX,oBAAMrF,SAASyB,QAAQe,KAAR,CAAcvB,KAAKR,IAAI,CAAT,CAAd,EAA2BA,IAAI,CAA/B,EAAkCkF,UAAlC,CAAf;AACA,oBAAI,CAAC3F,MAAL,EAAa,OAAO,IAAP;;AAEbmF,yBAAS1C,IAAT,CAAc,CAAC4C,IAAD,EAAOrF,MAAP,CAAd;;AAEA2F,6BAAaA,cAAc3F,OAAOe,IAAlC;AACH;;AAED,gBAAMqE,YAAY3D,QAAQe,KAAR,CAAcvB,KAAKA,KAAKP,MAAL,GAAc,CAAnB,CAAd,EAAqCO,KAAKP,MAAL,GAAc,CAAnD,EAAsDiF,UAAtD,CAAlB;AACA,gBAAI,CAACP,SAAL,EAAgB,OAAO,IAAP;;AAEhB,kCAAOO,UAAP;AACA,mBAAO,IAAIT,IAAJ,CAAUS,UAAV,EAA4BR,QAA5B,EAAsCC,SAAtC,CAAP;AACH;;;;;;kBAgCUF,I;;;;;;;;;;;;;;;;;;;;ACpFf;;;;AAEA;;;;;;;;IAOMU,Q;AAIF,sBAAY7E,IAAZ,EAAwBE,IAAxB,EAAiD;AAAA;;AAC7C,aAAKF,IAAL,GAAYA,IAAZ;AACA,aAAKE,IAAL,GAAYA,IAAZ;AACH;;;;iCAkCQE,G,EAAwB;AAC7B,gBAAInB,SAAS,IAAb;AAD6B;AAAA;AAAA;;AAAA;AAE7B,qCAAkB,KAAKiB,IAAvB,8HAA6B;AAAA,wBAAlBM,GAAkB;;AACzBvB,6BAASuB,IAAIP,QAAJ,CAAaG,GAAb,CAAT;AACA,wBAAInB,WAAW,IAAf,EAAqB;AACxB;AAL4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAM7B,mBAAOA,MAAP;AACH;;;kCAESoB,E,EAA0B;AAChC,iBAAKH,IAAL,CAAUd,OAAV,CAAkBiB,EAAlB;AACH;;;0CAEiB;AAAA;;AACd,mBAAO,YAAGE,MAAH,gCAAa,KAAKL,IAAL,CAAUhC,GAAV,CAAc,UAACsC,GAAD;AAAA,uBAASA,IAAI2C,eAAJ,EAAT;AAAA,aAAd,CAAb,EAAP;AACH;;;oCAEW;AACR,gBAAMC,aAAa,CAAC,UAAD,CAAnB;AACA,iBAAKsB,SAAL,CAAe,iBAAS;AAAEtB,2BAAW1B,IAAX,CAAgBiD,MAAMlE,SAAN,EAAhB;AAAqC,aAA/D;AACA,mBAAO2C,UAAP;AACH;;;8BArDYlD,I,EAAoBQ,O,EAAyB;AACtD,gBAAIR,KAAKP,MAAL,GAAc,CAAlB,EAAqB;AACjB,uBAAOe,QAAQI,KAAR,CAAc,oCAAd,CAAP;AACH;AACD,gBAAI8D,aAAoB,IAAxB;AACA,gBAAMX,eAAevD,QAAQuD,YAA7B;AACA,gBAAIA,gBAAgBA,aAAaX,IAAb,KAAsB,OAA1C,EAAmD;AAC/CsB,6BAAaX,YAAb;AACH;AACD,gBAAM5C,aAAa,EAAnB;;AATsD;AAAA;AAAA;;AAAA;AAWtD,sCAAkBnB,KAAKX,KAAL,CAAW,CAAX,CAAlB,mIAAiC;AAAA,wBAAtBiB,GAAsB;;AAC7B,wBAAMgB,SAASd,QAAQe,KAAR,CAAcjB,GAAd,EAAmB,IAAIa,WAAW1B,MAAlC,EAA0CiF,UAA1C,EAAsDtE,SAAtD,EAAiE,EAACwE,qBAAqB,IAAtB,EAAjE,CAAf;AACA,wBAAI,CAACtD,MAAL,EAAa,OAAO,IAAP;AACboD,iCAAaA,cAAcpD,OAAOxB,IAAlC;AACAqB,+BAAWK,IAAX,CAAgBF,MAAhB;AACH;AAhBqD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAiBtD,kCAAOoD,UAAP;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAMG,kBAAkBd,gBACpB5C,WAAW2D,IAAX,CAAgB;AAAA,uBAAO,yBAAaf,YAAb,EAA2BzD,IAAIR,IAA/B,CAAP;AAAA,aAAhB,CADJ;;AAGA,mBAAO+E,kBACH,IAAIF,QAAJ,CAAarB,gBAAb,EAAwBnC,UAAxB,CADG,GAEH,IAAIwD,QAAJ,CAAcD,UAAd,EAAgCvD,UAAhC,CAFJ;AAGH;;;;;;kBA0BUwD,Q;;;;;;;;;;;;;;;;;;;;AC1Ef;;;;AAEA;;AACA;;AACA;;;;;;;;;;AAOA,IAAMrC,QAAQ;AACV,iBAAaI,iBADH;AAEV,gBAAYqC;AAFF,CAAd;;AAKA;;;;;;;;IAOMC,Q;AAIF,sBAAYlF,IAAZ,EAAwBE,IAAxB,EAAiD;AAAA;;AAC7C,aAAKF,IAAL,GAAYA,IAAZ;AACA,aAAKE,IAAL,GAAYA,IAAZ;AACH;;;;iCAqBQE,G,EAAwB;AAC7B,gBAAI,KAAKJ,IAAL,CAAUsD,IAAV,KAAmB,OAAvB,EAAgC;AAC5B,oBAAIN,cAAJ;AACA,oBAAIlC,cAAJ;AAF4B;AAAA;AAAA;;AAAA;AAG5B,yCAAkB,KAAKZ,IAAvB,8HAA6B;AAAA,4BAAlBM,GAAkB;;AACzBwC,gCAAQxC,IAAIP,QAAJ,CAAaG,GAAb,CAAR;AACAU,gCAAQ,IAAR;AACA,4BAAI,OAAOkC,KAAP,KAAiB,QAArB,EAA+B;AAC3B,gCAAMmC,IAAI/E,IAAIgF,UAAJ,CAAepC,KAAf,CAAV;AACA,gCAAImC,CAAJ,EAAO,OAAOA,CAAP;AACV,yBAHD,MAGO,IAAIpE,MAAMC,OAAN,CAAcgC,KAAd,CAAJ,EAA0B;AAC7B,gCAAIA,MAAMrD,MAAN,GAAe,CAAf,IAAoBqD,MAAMrD,MAAN,GAAe,CAAvC,EAA0C;AACtCmB,gEAA8BuE,KAAKC,SAAL,CAAetC,KAAf,CAA9B;AACH,6BAFD,MAEO;AACHlC,wCAAQ,0BAAakC,MAAM,CAAN,CAAb,EAAuBA,MAAM,CAAN,CAAvB,EAAiCA,MAAM,CAAN,CAAjC,EAA2CA,MAAM,CAAN,CAA3C,CAAR;AACH;AACD,gCAAI,CAAClC,KAAL,EAAY;AACR,uCAAO,IAAIyE,aAAJ,CAAWvC,MAAM,CAAN,CAAD,GAAkB,GAA5B,EAAkCA,MAAM,CAAN,CAAD,GAAkB,GAAnD,EAAyDA,MAAM,CAAN,CAAD,GAAkB,GAA1E,EAAgFA,MAAM,CAAN,CAAhF,CAAP;AACH;AACJ;AACJ;AAnB2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAoB5B,sBAAM,IAAIE,uBAAJ,CAAiBpC,kDAA8C,OAAOkC,KAAP,KAAiB,QAAjB,GAA4BA,KAA5B,GAAoCqC,KAAKC,SAAL,CAAetC,KAAf,CAAlF,QAAjB,CAAN;AACH,aArBD,MAqBO;AACH,oBAAIC,QAAQ,IAAZ;AADG;AAAA;AAAA;;AAAA;AAEH,0CAAkB,KAAK/C,IAAvB,mIAA6B;AAAA,4BAAlBM,IAAkB;;AACzByC,gCAAQzC,KAAIP,QAAJ,CAAaG,GAAb,CAAR;AACA,4BAAI6C,UAAU,IAAd,EAAoB;AACpB,4BAAMuC,MAAMC,OAAOxC,KAAP,CAAZ;AACA,4BAAIyC,MAAMF,GAAN,CAAJ,EAAgB;AAChB,+BAAOA,GAAP;AACH;AARE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AASH,sBAAM,IAAItC,uBAAJ,wBAAsCmC,KAAKC,SAAL,CAAerC,KAAf,CAAtC,iBAAN;AACH;AACJ;;;kCAES5C,E,EAA0B;AAChC,iBAAKH,IAAL,CAAUd,OAAV,CAAkBiB,EAAlB;AACH;;;0CAEiB;AAAA;;AACd,mBAAO,YAAGE,MAAH,gCAAa,KAAKL,IAAL,CAAUhC,GAAV,CAAc,UAACsC,GAAD;AAAA,uBAASA,IAAI2C,eAAJ,EAAT;AAAA,aAAd,CAAb,EAAP;AACH;;;oCAEW;AACR,gBAAMC,aAAa,SAAO,KAAKpD,IAAL,CAAUsD,IAAjB,CAAnB;AACA,iBAAKoB,SAAL,CAAe,iBAAS;AAAEtB,2BAAW1B,IAAX,CAAgBiD,MAAMlE,SAAN,EAAhB;AAAqC,aAA/D;AACA,mBAAO2C,UAAP;AACH;;;8BAlEYlD,I,EAAoBQ,O,EAAsC;AACnE,gBAAIR,KAAKP,MAAL,GAAc,CAAlB,EACI,OAAOe,QAAQI,KAAR,mCAAP;;AAEJ,gBAAMf,OAAgBG,KAAK,CAAL,CAAtB;AACA,kCAAOsC,MAAMzC,IAAN,CAAP,EAAoBA,IAApB;;AAEA,gBAAMC,OAAOwC,MAAMzC,IAAN,CAAb;;AAEA,gBAAMyB,SAAS,EAAf;AACA,iBAAK,IAAI9B,IAAI,CAAb,EAAgBA,IAAIQ,KAAKP,MAAzB,EAAiCD,GAAjC,EAAsC;AAClC,oBAAMsD,QAAQtC,QAAQe,KAAR,CAAcvB,KAAKR,CAAL,CAAd,EAAuBA,CAAvB,EAA0B8D,gBAA1B,CAAd;AACA,oBAAI,CAACR,KAAL,EAAY,OAAO,IAAP;AACZxB,uBAAOE,IAAP,CAAYsB,KAAZ;AACH;;AAED,mBAAO,IAAIkC,QAAJ,CAAalF,IAAb,EAAmBwB,MAAnB,CAAP;AACH;;;;;;kBAoDU0D,Q;;;;;;;;;;;;;;;;;;;;;;;ACrGf;;;;AAOA;AACA;;IA+BaS,Q,WAAAA,Q;AAKT,sBAAYC,aAAZ,EAAoCC,kBAApC,EAAiEC,MAAjE,EAAwF;AAAA;;AACpF,YAAIF,aAAJ,EACI,KAAKG,WAAL,GAAmBF,qBAAqB,SAArB,GAAiC,MAApD,CADJ,KAGI,KAAKE,WAAL,GAAmBF,qBAAqB,QAArB,GAAgC,MAAnD;;AAEJ,aAAKC,MAAL,GAAcA,MAAd;AACA,aAAKE,QAAL,GAAgB,IAAIC,KAAKN,QAAT,CAAkB,KAAKG,MAAL,GAAc,KAAKA,MAAnB,GAA4B,EAA9C,EACZ,EAAEC,aAAa,KAAKA,WAApB,EAAiCG,OAAO,QAAxC,EADY,CAAhB;AAEH;;;;gCAEOC,G,EAAaC,G,EAAqB;AACtC,mBAAO,KAAKJ,QAAL,CAAcK,OAAd,CAAsBF,GAAtB,EAA2BC,GAA3B,CAAP;AACH;;;yCAEwB;AACrB;AACA;AACA,mBAAO,IAAIH,KAAKN,QAAT,CAAkB,KAAKG,MAAL,GAAc,KAAKA,MAAnB,GAA4B,EAA9C,EACFQ,eADE,GACgBR,MADvB;AAEH;;;;;;IAGQS,kB,WAAAA,kB;AAMT,gCAAYX,aAAZ,EAAuCC,kBAAvC,EAAuEC,MAAvE,EAAkG;AAAA;;AAC9F,aAAK9F,IAAL,GAAYwG,mBAAZ;AACA,aAAKV,MAAL,GAAcA,MAAd;AACA,aAAKF,aAAL,GAAqBA,aAArB;AACA,aAAKC,kBAAL,GAA0BA,kBAA1B;AACH;;;;iCA2BQzF,G,EAAwB;AAC7B,mBAAO,IAAIuF,QAAJ,CAAa,KAAKC,aAAL,CAAmB3F,QAAnB,CAA4BG,GAA5B,CAAb,EAA+C,KAAKyF,kBAAL,CAAwB5F,QAAxB,CAAiCG,GAAjC,CAA/C,EAAsF,KAAK0F,MAAL,GAAc,KAAKA,MAAL,CAAY7F,QAAZ,CAAqBG,GAArB,CAAd,GAA0C,IAAhI,CAAP;AACH;;;kCAESC,E,EAA0B;AAChCA,eAAG,KAAKuF,aAAR;AACAvF,eAAG,KAAKwF,kBAAR;AACA,gBAAI,KAAKC,MAAT,EAAiB;AACbzF,mBAAG,KAAKyF,MAAR;AACH;AACJ;;;0CAEiB;AACd;AACA;AACA;AACA;AACA,mBAAO,CAACxF,SAAD,CAAP;AACH;;;oCAEW;AACR,gBAAMmG,UAAU,EAAhB;AACAA,oBAAQ,gBAAR,IAA4B,KAAKb,aAAL,CAAmBnF,SAAnB,EAA5B;AACAgG,oBAAQ,qBAAR,IAAiC,KAAKZ,kBAAL,CAAwBpF,SAAxB,EAAjC;AACA,gBAAI,KAAKqF,MAAT,EAAiB;AACbW,wBAAQ,QAAR,IAAoB,KAAKX,MAAL,CAAYrF,SAAZ,EAApB;AACH;AACD,mBAAO,CAAC,UAAD,EAAagG,OAAb,CAAP;AACH;;;8BArDYvG,I,EAAoBQ,O,EAAsC;AACnE,gBAAIR,KAAKP,MAAL,KAAgB,CAApB,EACI,OAAOe,QAAQI,KAAR,0BAAP;;AAEJ,gBAAM2F,UAAWvG,KAAK,CAAL,CAAjB;AACA,gBAAI,QAAOuG,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B1F,MAAMC,OAAN,CAAcyF,OAAd,CAAnC,EACI,OAAO/F,QAAQI,KAAR,gDAAP;;AAEJ,gBAAM8E,gBAAgBlF,QAAQe,KAAR,CAClBgF,QAAQ,gBAAR,MAA8BnG,SAA9B,GAA0C,KAA1C,GAAkDmG,QAAQ,gBAAR,CADhC,EAC2D,CAD3D,EAC8D3D,kBAD9D,CAAtB;AAEA,gBAAI,CAAC8C,aAAL,EAAoB,OAAO,IAAP;;AAEpB,gBAAMC,qBAAqBnF,QAAQe,KAAR,CACvBgF,QAAQ,qBAAR,MAAmCnG,SAAnC,GAA+C,KAA/C,GAAuDmG,QAAQ,qBAAR,CADhC,EACgE,CADhE,EACmE3D,kBADnE,CAA3B;AAEA,gBAAI,CAAC+C,kBAAL,EAAyB,OAAO,IAAP;;AAEzB,gBAAIC,SAAS,IAAb;AACA,gBAAIW,QAAQ,QAAR,CAAJ,EAAuB;AACnBX,yBAASpF,QAAQe,KAAR,CAAcgF,QAAQ,QAAR,CAAd,EAAiC,CAAjC,EAAoC/D,iBAApC,CAAT;AACA,oBAAI,CAACoD,MAAL,EAAa,OAAO,IAAP;AAChB;;AAED,mBAAO,IAAIS,kBAAJ,CAAuBX,aAAvB,EAAsCC,kBAAtC,EAA0DC,MAA1D,CAAP;AACH;;;;;;;;;;;;;;;;;;;;;;;;;ACvGL;;;;AAOA,SAASY,gBAAT,CAA0B1G,IAA1B,EAAsC;AAClC,WAAOA,KAAKsD,IAAL,KAAc,QAAd,IACHtD,KAAKsD,IAAL,KAAc,QADX,IAEHtD,KAAKsD,IAAL,KAAc,SAFX,IAGHtD,KAAKsD,IAAL,KAAc,MAHlB;AAIH;;AAED;;;;;;;;;;;;;;AAcA,SAASqD,cAAT,CAAwBhG,EAAxB,EAAoCiG,MAApC,EAAqD;AACjD;AAMI,4BAAYT,GAAZ,EAA6BC,GAA7B,EAA8CJ,QAA9C,EAA2E;AAAA;;AACvE,iBAAKhG,IAAL,GAAY8C,kBAAZ;AACA,iBAAKqD,GAAL,GAAWA,GAAX;AACA,iBAAKC,GAAL,GAAWA,GAAX;AACA,iBAAKJ,QAAL,GAAgBA,QAAhB;AACH;;AAXL;AAAA;AAAA,qCA0Ca5F,GA1Cb,EA0CqC;AAC7B,oBAAMyG,QAAQ,KAAKb,QAAL,GACV,KAAKA,QAAL,CAAc/F,QAAd,CAAuBG,GAAvB,EAA4BiG,OAA5B,CAAoC,KAAKF,GAAL,CAASlG,QAAT,CAAkBG,GAAlB,CAApC,EAA4D,KAAKgG,GAAL,CAASnG,QAAT,CAAkBG,GAAlB,CAA5D,MAAwF,CAD9E,GAEV,KAAK+F,GAAL,CAASlG,QAAT,CAAkBG,GAAlB,MAA2B,KAAKgG,GAAL,CAASnG,QAAT,CAAkBG,GAAlB,CAF/B;;AAIA,uBAAOwG,SAAS,CAACC,KAAV,GAAkBA,KAAzB;AACH;AAhDL;AAAA;AAAA,sCAkDcxG,EAlDd,EAkDwC;AAChCA,mBAAG,KAAK8F,GAAR;AACA9F,mBAAG,KAAK+F,GAAR;AACA,oBAAI,KAAKJ,QAAT,EAAmB;AACf3F,uBAAG,KAAK2F,QAAR;AACH;AACJ;AAxDL;AAAA;AAAA,8CA0DsB;AACd,uBAAO,CAAC,IAAD,EAAO,KAAP,CAAP;AACH;AA5DL;AAAA;AAAA,wCA8DgB;AACR,oBAAM5C,aAAa,CAACzC,EAAD,CAAnB;AACA,qBAAK+D,SAAL,CAAe,iBAAS;AAAEtB,+BAAW1B,IAAX,CAAgBiD,MAAMlE,SAAN,EAAhB;AAAqC,iBAA/D;AACA,uBAAO2C,UAAP;AACH;AAlEL;AAAA;AAAA,kCAaiBlD,IAbjB,EAaqCQ,OAbrC,EAa2E;AACnE,oBAAIR,KAAKP,MAAL,KAAgB,CAAhB,IAAqBO,KAAKP,MAAL,KAAgB,CAAzC,EACI,OAAOe,QAAQI,KAAR,oCAAP;;AAEJ,oBAAMqF,MAAMzF,QAAQe,KAAR,CAAcvB,KAAK,CAAL,CAAd,EAAuB,CAAvB,EAA0BsD,gBAA1B,CAAZ;AACA,oBAAI,CAAC2C,GAAL,EAAU,OAAO,IAAP;AACV,oBAAMC,MAAM1F,QAAQe,KAAR,CAAcvB,KAAK,CAAL,CAAd,EAAuB,CAAvB,EAA0BsD,gBAA1B,CAAZ;AACA,oBAAI,CAAC4C,GAAL,EAAU,OAAO,IAAP;;AAEV,oBAAI,CAACM,iBAAiBP,IAAInG,IAArB,CAAD,IAA+B,CAAC0G,iBAAiBN,IAAIpG,IAArB,CAApC,EAAgE;AAC5D,2BAAOU,QAAQI,KAAR,0FAAqG,qBAASqF,IAAInG,IAAb,CAArG,UAA4H,qBAASoG,IAAIpG,IAAb,CAA5H,gBAAP;AACH;;AAED,oBAAImG,IAAInG,IAAJ,CAASsD,IAAT,KAAkB8C,IAAIpG,IAAJ,CAASsD,IAA3B,IAAmC6C,IAAInG,IAAJ,CAASsD,IAAT,KAAkB,OAArD,IAAgE8C,IAAIpG,IAAJ,CAASsD,IAAT,KAAkB,OAAtF,EAA+F;AAC3F,2BAAO5C,QAAQI,KAAR,qBAAgC,qBAASqF,IAAInG,IAAb,CAAhC,aAA0D,qBAASoG,IAAIpG,IAAb,CAA1D,OAAP;AACH;;AAED,oBAAIgG,WAAW,IAAf;AACA,oBAAI9F,KAAKP,MAAL,KAAgB,CAApB,EAAuB;AACnB,wBAAIwG,IAAInG,IAAJ,CAASsD,IAAT,KAAkB,QAAlB,IAA8B8C,IAAIpG,IAAJ,CAASsD,IAAT,KAAkB,QAApD,EAA8D;AAC1D,+BAAO5C,QAAQI,KAAR,oDAAP;AACH;AACDkF,+BAAWtF,QAAQe,KAAR,CAAcvB,KAAK,CAAL,CAAd,EAAuB,CAAvB,EAA0BsG,mBAA1B,CAAX;AACA,wBAAI,CAACR,QAAL,EAAe,OAAO,IAAP;AAClB;;AAED,uBAAO,IAAIc,UAAJ,CAAeX,GAAf,EAAoBC,GAApB,EAAyBJ,QAAzB,CAAP;AACH;AAxCL;;AAAA;AAAA;AAoEH;;AAEM,IAAMe,0BAASJ,eAAe,IAAf,EAAqB,KAArB,CAAf;AACA,IAAMK,gCAAYL,eAAe,IAAf,EAAqB,IAArB,CAAlB,C;;;;;;;;;;;;;;;;;;;;;;ACpGP;;AAEA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;;;;;AAMA,IAAMM,cAAkC;AACpC;AACA,UAAMF,cAF8B;AAGpC,UAAMC,iBAH8B;AAIpC,aAASjE,eAJ2B;AAKpC,UAAMe,YAL8B;AAMpC,eAAWD,mBANyB;AAOpC,YAAQM,cAP4B;AAQpC,gBAAYU,kBARwB;AASpC,gBAAY0B,4BATwB;AAUpC,mBAAeW,qBAVqB;AAWpC,cAAUC,gBAX0B;AAYpC,WAAOC,aAZ6B;AAapC,eAAWC,iBAbyB;AAcpC,aAASC,eAd2B;AAepC,cAAUzD,mBAf0B;AAgBpC,cAAUA,mBAhB0B;AAiBpC,YAAQ0D,cAjB4B;AAkBpC,cAAU1D,mBAlB0B;AAmBpC,gBAAYqB,kBAnBwB;AAoBpC,iBAAaA,kBApBuB;AAqBpC,WAAOsC;AArB6B,CAAxC;;AAwBA,SAASC,IAAT,CAAcrH,GAAd,QAAiC;AAAA;AAAA,QAAbzB,CAAa;AAAA,QAAV+I,CAAU;AAAA,QAAPC,CAAO;AAAA,QAAJC,CAAI;;AAC7BjJ,QAAIA,EAAEsB,QAAF,CAAWG,GAAX,CAAJ;AACAsH,QAAIA,EAAEzH,QAAF,CAAWG,GAAX,CAAJ;AACAuH,QAAIA,EAAE1H,QAAF,CAAWG,GAAX,CAAJ;AACA,QAAMyH,QAAQD,IAAIA,EAAE3H,QAAF,CAAWG,GAAX,CAAJ,GAAsB,CAApC;AACA,QAAMU,QAAQ,0BAAanC,CAAb,EAAgB+I,CAAhB,EAAmBC,CAAnB,EAAsBE,KAAtB,CAAd;AACA,QAAI/G,KAAJ,EAAW,MAAM,IAAIoC,uBAAJ,CAAiBpC,KAAjB,CAAN;AACX,WAAO,IAAIyE,aAAJ,CAAU5G,IAAI,GAAJ,GAAUkJ,KAApB,EAA2BH,IAAI,GAAJ,GAAUG,KAArC,EAA4CF,IAAI,GAAJ,GAAUE,KAAtD,EAA6DA,KAA7D,CAAP;AACH;;AAED,SAASC,GAAT,CAAaC,GAAb,EAAkBC,GAAlB,EAAuB;AACnB,WAAOD,OAAOC,GAAd;AACH;;AAED,SAASC,GAAT,CAAaF,GAAb,EAAkBC,GAAlB,EAAuB;AACnB,QAAME,IAAIF,IAAID,GAAJ,CAAV;AACA,WAAO,OAAOG,CAAP,KAAa,WAAb,GAA2B,IAA3B,GAAkCA,CAAzC;AACH;;AAED,SAASC,EAAT,CAAY/H,GAAZ,SAAyB;AAAA;AAAA,QAAPwH,CAAO;AAAA,QAAJD,CAAI;;AAAE,WAAOC,EAAE3H,QAAF,CAAWG,GAAX,IAAkBuH,EAAE1H,QAAF,CAAWG,GAAX,CAAzB;AAA2C;AACtE,SAASgI,EAAT,CAAYhI,GAAZ,SAAyB;AAAA;AAAA,QAAPwH,CAAO;AAAA,QAAJD,CAAI;;AAAE,WAAOC,EAAE3H,QAAF,CAAWG,GAAX,IAAkBuH,EAAE1H,QAAF,CAAWG,GAAX,CAAzB;AAA2C;AACtE,SAASiI,IAAT,CAAcjI,GAAd,SAA2B;AAAA;AAAA,QAAPwH,CAAO;AAAA,QAAJD,CAAI;;AAAE,WAAOC,EAAE3H,QAAF,CAAWG,GAAX,KAAmBuH,EAAE1H,QAAF,CAAWG,GAAX,CAA1B;AAA4C;AACzE,SAASkI,IAAT,CAAclI,GAAd,SAA2B;AAAA;AAAA,QAAPwH,CAAO;AAAA,QAAJD,CAAI;;AAAE,WAAOC,EAAE3H,QAAF,CAAWG,GAAX,KAAmBuH,EAAE1H,QAAF,CAAWG,GAAX,CAA1B;AAA4C;;AAEzE,SAASmI,SAAT,CAAmBnI,GAAnB,UAAmC;AAAA;AAAA,QAAVwH,CAAU;AAAA,QAAPD,CAAO;AAAA,QAAJxC,CAAI;;AAAE,WAAOA,EAAElF,QAAF,CAAWG,GAAX,EAAgBiG,OAAhB,CAAwBuB,EAAE3H,QAAF,CAAWG,GAAX,CAAxB,EAAyCuH,EAAE1H,QAAF,CAAWG,GAAX,CAAzC,IAA4D,CAAnE;AAAuE;AAC5G,SAASoI,SAAT,CAAmBpI,GAAnB,UAAmC;AAAA;AAAA,QAAVwH,CAAU;AAAA,QAAPD,CAAO;AAAA,QAAJxC,CAAI;;AAAE,WAAOA,EAAElF,QAAF,CAAWG,GAAX,EAAgBiG,OAAhB,CAAwBuB,EAAE3H,QAAF,CAAWG,GAAX,CAAxB,EAAyCuH,EAAE1H,QAAF,CAAWG,GAAX,CAAzC,IAA4D,CAAnE;AAAuE;AAC5G,SAASqI,WAAT,CAAqBrI,GAArB,UAAqC;AAAA;AAAA,QAAVwH,CAAU;AAAA,QAAPD,CAAO;AAAA,QAAJxC,CAAI;;AAAE,WAAOA,EAAElF,QAAF,CAAWG,GAAX,EAAgBiG,OAAhB,CAAwBuB,EAAE3H,QAAF,CAAWG,GAAX,CAAxB,EAAyCuH,EAAE1H,QAAF,CAAWG,GAAX,CAAzC,KAA6D,CAApE;AAAwE;AAC/G,SAASsI,WAAT,CAAqBtI,GAArB,UAAqC;AAAA;AAAA,QAAVwH,CAAU;AAAA,QAAPD,CAAO;AAAA,QAAJxC,CAAI;;AAAE,WAAOA,EAAElF,QAAF,CAAWG,GAAX,EAAgBiG,OAAhB,CAAwBuB,EAAE3H,QAAF,CAAWG,GAAX,CAAxB,EAAyCuH,EAAE1H,QAAF,CAAWG,GAAX,CAAzC,KAA6D,CAApE;AAAwE;;AAE/G,SAASuI,YAAT,CAAsBT,CAAtB,EAAyBN,CAAzB,EAA4BlI,CAA5B,EAA+BkJ,CAA/B,EAAkC;AAC9B,WAAOlJ,KAAKkJ,CAAZ,EAAe;AACX,YAAMC,IAAKnJ,IAAIkJ,CAAL,IAAW,CAArB;AACA,YAAIhB,EAAEiB,CAAF,MAASX,CAAb,EACI,OAAO,IAAP;AACJ,YAAIN,EAAEiB,CAAF,IAAOX,CAAX,EACIU,IAAIC,IAAI,CAAR,CADJ,KAGInJ,IAAImJ,IAAI,CAAR;AACP;AACD,WAAO,KAAP;AACH;;AAED,SAASC,OAAT,CAAiB9I,IAAjB,EAAsC;AAClC,WAAO,EAAEA,UAAF,EAAP;AACH;;AAEDF,8BAAmBiJ,QAAnB,CAA4B9B,WAA5B,EAAyC;AACrC,aAAS,CACL+B,gBADK,EAEL,CAACtG,iBAAD,CAFK,EAGL,UAACtC,GAAD,UAAc;AAAA;AAAA,YAAP8H,CAAO;;AAAE,cAAM,IAAIhF,uBAAJ,CAAiBgF,EAAEjI,QAAF,CAAWG,GAAX,CAAjB,CAAN;AAA0C,KAHrD,CAD4B;AAMrC,cAAU,CACNsC,iBADM,EAEN,CAACc,gBAAD,CAFM,EAGN,UAACpD,GAAD;AAAA;AAAA,YAAO8H,CAAP;;AAAA,eAAc,qBAAS,oBAAOA,EAAEjI,QAAF,CAAWG,GAAX,CAAP,CAAT,CAAd;AAAA,KAHM,CAN2B;AAWrC,iBAAa,CACTsC,iBADS,EAET,CAACc,gBAAD,CAFS,EAGT,UAACpD,GAAD,UAAc;AAAA;AAAA,YAAP8H,CAAO;;AACVA,YAAIA,EAAEjI,QAAF,CAAWG,GAAX,CAAJ;AACA,YAAMJ,cAAckI,CAAd,yCAAcA,CAAd,CAAN;AACA,YAAIA,MAAM,IAAV,EAAgB;AACZ,mBAAO,EAAP;AACH,SAFD,MAEO,IAAIlI,SAAS,QAAT,IAAqBA,SAAS,QAA9B,IAA0CA,SAAS,SAAvD,EAAkE;AACrE,mBAAOiJ,OAAOf,CAAP,CAAP;AACH,SAFM,MAEA,IAAIA,aAAa3C,aAAjB,EAAwB;AAC3B,mBAAO2C,EAAE3F,QAAF,EAAP;AACH,SAFM,MAEA;AACH,mBAAO8C,KAAKC,SAAL,CAAe4C,CAAf,CAAP;AACH;AACJ,KAfQ,CAXwB;AA4BrC,kBAAc,CACVpF,kBADU,EAEV,CAACU,gBAAD,CAFU,EAGV,UAACpD,GAAD;AAAA;AAAA,YAAO8H,CAAP;;AAAA,eAAcgB,QAAQhB,EAAEjI,QAAF,CAAWG,GAAX,CAAR,CAAd;AAAA,KAHU,CA5BuB;AAiCrC,eAAW,CACP,kBAAMwC,iBAAN,EAAkB,CAAlB,CADO,EAEP,CAACqC,gBAAD,CAFO,EAGP,UAAC7E,GAAD,UAAc;AAAA;AAAA,YAAP8H,CAAO;;AACV,eAAOA,EAAEjI,QAAF,CAAWG,GAAX,EAAgB+I,OAAhB,EAAP;AACH,KALM,CAjC0B;AAwCrC,WAAO,CACHlE,gBADG,EAEH,CAACrC,iBAAD,EAAaA,iBAAb,EAAyBA,iBAAzB,CAFG,EAGH6E,IAHG,CAxC8B;AA6CrC,YAAQ,CACJxC,gBADI,EAEJ,CAACrC,iBAAD,EAAaA,iBAAb,EAAyBA,iBAAzB,EAAqCA,iBAArC,CAFI,EAGJ6E,IAHI,CA7C6B;AAkDrC,WAAO;AACHzH,cAAM8C,kBADH;AAEH5B,mBAAW,CACP,CACI,CAACwB,iBAAD,CADJ,EAEI,UAACtC,GAAD;AAAA;AAAA,gBAAO2H,GAAP;;AAAA,mBAAgBD,IAAIC,IAAI9H,QAAJ,CAAaG,GAAb,CAAJ,EAAuBA,IAAIgJ,UAAJ,EAAvB,CAAhB;AAAA,SAFJ,CADO,EAIJ,CACC,CAAC1G,iBAAD,EAAakB,iBAAb,CADD,EAEC,UAACxD,GAAD;AAAA;AAAA,gBAAO2H,GAAP;AAAA,gBAAYC,GAAZ;;AAAA,mBAAqBF,IAAIC,IAAI9H,QAAJ,CAAaG,GAAb,CAAJ,EAAuB4H,IAAI/H,QAAJ,CAAaG,GAAb,CAAvB,CAArB;AAAA,SAFD,CAJI;AAFR,KAlD8B;AA8DrC,WAAO;AACHJ,cAAMwD,gBADH;AAEHtC,mBAAW,CACP,CACI,CAACwB,iBAAD,CADJ,EAEI,UAACtC,GAAD;AAAA;AAAA,gBAAO2H,GAAP;;AAAA,mBAAgBE,IAAIF,IAAI9H,QAAJ,CAAaG,GAAb,CAAJ,EAAuBA,IAAIgJ,UAAJ,EAAvB,CAAhB;AAAA,SAFJ,CADO,EAIJ,CACC,CAAC1G,iBAAD,EAAakB,iBAAb,CADD,EAEC,UAACxD,GAAD;AAAA;AAAA,gBAAO2H,GAAP;AAAA,gBAAYC,GAAZ;;AAAA,mBAAqBC,IAAIF,IAAI9H,QAAJ,CAAaG,GAAb,CAAJ,EAAuB4H,IAAI/H,QAAJ,CAAaG,GAAb,CAAvB,CAArB;AAAA,SAFD,CAJI;AAFR,KA9D8B;AA0ErC,kBAAc,CACVwD,iBADU,EAEV,EAFU,EAGV,UAACxD,GAAD;AAAA,eAASA,IAAIgJ,UAAJ,EAAT;AAAA,KAHU,CA1EuB;AA+ErC,qBAAiB,CACb1G,iBADa,EAEb,EAFa,EAGb,UAACtC,GAAD;AAAA,eAASA,IAAIiJ,YAAJ,EAAT;AAAA,KAHa,CA/EoB;AAoFrC,UAAM,CACF7F,gBADE,EAEF,EAFE,EAGF,UAACpD,GAAD;AAAA,eAASA,IAAIR,EAAJ,EAAT;AAAA,KAHE,CApF+B;AAyFrC,YAAQ,CACJgD,iBADI,EAEJ,EAFI,EAGJ,UAACxC,GAAD;AAAA,eAASA,IAAIkJ,OAAJ,CAAY9K,IAArB;AAAA,KAHI,CAzF6B;AA8FrC,uBAAmB,CACfoE,iBADe,EAEf,EAFe,EAGf,UAACxC,GAAD;AAAA,eAASA,IAAIkJ,OAAJ,CAAYC,cAAZ,IAA8B,CAAvC;AAAA,KAHe,CA9FkB;AAmGrC,qBAAiB,CACb3G,iBADa,EAEb,EAFa,EAGb,UAACxC,GAAD;AAAA,eAASA,IAAIkJ,OAAJ,CAAYE,YAAZ,IAA4B,CAArC;AAAA,KAHa,CAnGoB;AAwGrC,SAAK,CACD5G,iBADC,EAEDkG,QAAQlG,iBAAR,CAFC,EAGD,UAACxC,GAAD,EAAMF,IAAN,EAAe;AACX,YAAIjB,SAAS,CAAb;AADW;AAAA;AAAA;;AAAA;AAEX,iCAAkBiB,IAAlB,8HAAwB;AAAA,oBAAbM,GAAa;;AACpBvB,0BAAUuB,IAAIP,QAAJ,CAAaG,GAAb,CAAV;AACH;AAJU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKX,eAAOnB,MAAP;AACH,KATA,CAxGgC;AAmHrC,SAAK,CACD2D,iBADC,EAEDkG,QAAQlG,iBAAR,CAFC,EAGD,UAACxC,GAAD,EAAMF,IAAN,EAAe;AACX,YAAIjB,SAAS,CAAb;AADW;AAAA;AAAA;;AAAA;AAEX,kCAAkBiB,IAAlB,mIAAwB;AAAA,oBAAbM,GAAa;;AACpBvB,0BAAUuB,IAAIP,QAAJ,CAAaG,GAAb,CAAV;AACH;AAJU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKX,eAAOnB,MAAP;AACH,KATA,CAnHgC;AA8HrC,SAAK;AACDe,cAAM4C,iBADL;AAED1B,mBAAW,CACP,CACI,CAAC0B,iBAAD,EAAaA,iBAAb,CADJ,EAEI,UAACxC,GAAD;AAAA;AAAA,gBAAOwH,CAAP;AAAA,gBAAUD,CAAV;;AAAA,mBAAiBC,EAAE3H,QAAF,CAAWG,GAAX,IAAkBuH,EAAE1H,QAAF,CAAWG,GAAX,CAAnC;AAAA,SAFJ,CADO,EAIJ,CACC,CAACwC,iBAAD,CADD,EAEC,UAACxC,GAAD;AAAA;AAAA,gBAAOwH,CAAP;;AAAA,mBAAc,CAACA,EAAE3H,QAAF,CAAWG,GAAX,CAAf;AAAA,SAFD,CAJI;AAFV,KA9HgC;AA0IrC,SAAK,CACDwC,iBADC,EAED,CAACA,iBAAD,EAAaA,iBAAb,CAFC,EAGD,UAACxC,GAAD;AAAA;AAAA,YAAOwH,CAAP;AAAA,YAAUD,CAAV;;AAAA,eAAiBC,EAAE3H,QAAF,CAAWG,GAAX,IAAkBuH,EAAE1H,QAAF,CAAWG,GAAX,CAAnC;AAAA,KAHC,CA1IgC;AA+IrC,SAAK,CACDwC,iBADC,EAED,CAACA,iBAAD,EAAaA,iBAAb,CAFC,EAGD,UAACxC,GAAD;AAAA;AAAA,YAAOwH,CAAP;AAAA,YAAUD,CAAV;;AAAA,eAAiBC,EAAE3H,QAAF,CAAWG,GAAX,IAAkBuH,EAAE1H,QAAF,CAAWG,GAAX,CAAnC;AAAA,KAHC,CA/IgC;AAoJrC,WAAO,CACHwC,iBADG,EAEH,EAFG,EAGH;AAAA,eAAMa,KAAKgG,GAAX;AAAA,KAHG,CApJ8B;AAyJrC,UAAM,CACF7G,iBADE,EAEF,EAFE,EAGF;AAAA,eAAMa,KAAKiG,EAAX;AAAA,KAHE,CAzJ+B;AA8JrC,SAAK,CACD9G,iBADC,EAED,EAFC,EAGD;AAAA,eAAMa,KAAKkG,CAAX;AAAA,KAHC,CA9JgC;AAmKrC,SAAK,CACD/G,iBADC,EAED,CAACA,iBAAD,EAAaA,iBAAb,CAFC,EAGD,UAACxC,GAAD;AAAA;AAAA,YAAOuH,CAAP;AAAA,YAAUiC,CAAV;;AAAA,eAAiBnG,KAAKoG,GAAL,CAASlC,EAAE1H,QAAF,CAAWG,GAAX,CAAT,EAA0BwJ,EAAE3J,QAAF,CAAWG,GAAX,CAA1B,CAAjB;AAAA,KAHC,CAnKgC;AAwKrC,YAAQ,CACJwC,iBADI,EAEJ,CAACA,iBAAD,CAFI,EAGJ,UAACxC,GAAD;AAAA;AAAA,YAAO0J,CAAP;;AAAA,eAAcrG,KAAKsG,IAAL,CAAUD,EAAE7J,QAAF,CAAWG,GAAX,CAAV,CAAd;AAAA,KAHI,CAxK6B;AA6KrC,aAAS,CACLwC,iBADK,EAEL,CAACA,iBAAD,CAFK,EAGL,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAKwG,KAAL,CAAWD,EAAE/J,QAAF,CAAWG,GAAX,CAAX,CAAd;AAAA,KAHK,CA7K4B;AAkLrC,UAAM,CACFwC,iBADE,EAEF,CAACA,iBAAD,CAFE,EAGF,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAKyG,GAAL,CAASF,EAAE/J,QAAF,CAAWG,GAAX,CAAT,CAAd;AAAA,KAHE,CAlL+B;AAuLrC,YAAQ,CACJwC,iBADI,EAEJ,CAACA,iBAAD,CAFI,EAGJ,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAK0G,IAAL,CAAUH,EAAE/J,QAAF,CAAWG,GAAX,CAAV,CAAd;AAAA,KAHI,CAvL6B;AA4LrC,WAAO,CACHwC,iBADG,EAEH,CAACA,iBAAD,CAFG,EAGH,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAK2G,GAAL,CAASJ,EAAE/J,QAAF,CAAWG,GAAX,CAAT,CAAd;AAAA,KAHG,CA5L8B;AAiMrC,WAAO,CACHwC,iBADG,EAEH,CAACA,iBAAD,CAFG,EAGH,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAK4G,GAAL,CAASL,EAAE/J,QAAF,CAAWG,GAAX,CAAT,CAAd;AAAA,KAHG,CAjM8B;AAsMrC,WAAO,CACHwC,iBADG,EAEH,CAACA,iBAAD,CAFG,EAGH,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAK6G,GAAL,CAASN,EAAE/J,QAAF,CAAWG,GAAX,CAAT,CAAd;AAAA,KAHG,CAtM8B;AA2MrC,YAAQ,CACJwC,iBADI,EAEJ,CAACA,iBAAD,CAFI,EAGJ,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAK8G,IAAL,CAAUP,EAAE/J,QAAF,CAAWG,GAAX,CAAV,CAAd;AAAA,KAHI,CA3M6B;AAgNrC,YAAQ,CACJwC,iBADI,EAEJ,CAACA,iBAAD,CAFI,EAGJ,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAK+G,IAAL,CAAUR,EAAE/J,QAAF,CAAWG,GAAX,CAAV,CAAd;AAAA,KAHI,CAhN6B;AAqNrC,YAAQ,CACJwC,iBADI,EAEJ,CAACA,iBAAD,CAFI,EAGJ,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAKgH,IAAL,CAAUT,EAAE/J,QAAF,CAAWG,GAAX,CAAV,CAAd;AAAA,KAHI,CArN6B;AA0NrC,WAAO,CACHwC,iBADG,EAEHkG,QAAQlG,iBAAR,CAFG,EAGH,UAACxC,GAAD,EAAMF,IAAN;AAAA,eAAeuD,KAAKiH,GAAL,gCAAYxK,KAAKhC,GAAL,CAAS;AAAA,mBAAOsC,IAAIP,QAAJ,CAAaG,GAAb,CAAP;AAAA,SAAT,CAAZ,EAAf;AAAA,KAHG,CA1N8B;AA+NrC,WAAO,CACHwC,iBADG,EAEHkG,QAAQlG,iBAAR,CAFG,EAGH,UAACxC,GAAD,EAAMF,IAAN;AAAA,eAAeuD,KAAKkH,GAAL,gCAAYzK,KAAKhC,GAAL,CAAS;AAAA,mBAAOsC,IAAIP,QAAJ,CAAaG,GAAb,CAAP;AAAA,SAAT,CAAZ,EAAf;AAAA,KAHG,CA/N8B;AAoOrC,WAAO,CACHwC,iBADG,EAEH,CAACA,iBAAD,CAFG,EAGH,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAKmH,GAAL,CAASZ,EAAE/J,QAAF,CAAWG,GAAX,CAAT,CAAd;AAAA,KAHG,CApO8B;AAyOrC,aAAS,CACLwC,iBADK,EAEL,CAACA,iBAAD,CAFK,EAGL,UAACxC,GAAD,UAAc;AAAA;AAAA,YAAP4J,CAAO;;AACV,YAAM9B,IAAI8B,EAAE/J,QAAF,CAAWG,GAAX,CAAV;AACA;AACA;AACA;AACA,eAAO8H,IAAI,CAAJ,GAAQ,CAACzE,KAAKoH,KAAL,CAAW,CAAC3C,CAAZ,CAAT,GAA0BzE,KAAKoH,KAAL,CAAW3C,CAAX,CAAjC;AACH,KATI,CAzO4B;AAoPrC,aAAS,CACLtF,iBADK,EAEL,CAACA,iBAAD,CAFK,EAGL,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAKC,KAAL,CAAWsG,EAAE/J,QAAF,CAAWG,GAAX,CAAX,CAAd;AAAA,KAHK,CApP4B;AAyPrC,YAAQ,CACJwC,iBADI,EAEJ,CAACA,iBAAD,CAFI,EAGJ,UAACxC,GAAD;AAAA;AAAA,YAAO4J,CAAP;;AAAA,eAAcvG,KAAKqH,IAAL,CAAUd,EAAE/J,QAAF,CAAWG,GAAX,CAAV,CAAd;AAAA,KAHI,CAzP6B;AA8PrC,iBAAa,CACT0C,kBADS,EAET,CAACJ,iBAAD,EAAac,gBAAb,CAFS,EAGT,UAACpD,GAAD;AAAA;AAAA,YAAOlB,CAAP;AAAA,YAAUgJ,CAAV;;AAAA,eAAiB9H,IAAIgJ,UAAJ,GAAkBlK,CAAD,CAAS+D,KAA1B,MAAsCiF,CAAD,CAASjF,KAA/D;AAAA,KAHS,CA9PwB;AAmQrC,oBAAgB,CACZH,kBADY,EAEZ,CAACU,gBAAD,CAFY,EAGZ,UAACpD,GAAD;AAAA;AAAA,YAAO8H,CAAP;;AAAA,eAAc9H,IAAIR,EAAJ,OAAcsI,CAAD,CAASjF,KAApC;AAAA,KAHY,CAnQqB;AAwQrC,sBAAkB,CACdH,kBADc,EAEd,CAACJ,iBAAD,CAFc,EAGd,UAACtC,GAAD;AAAA;AAAA,YAAO8H,CAAP;;AAAA,eAAc9H,IAAIiJ,YAAJ,OAAwBnB,CAAD,CAASjF,KAA9C;AAAA,KAHc,CAxQmB;AA6QrC,gBAAY,CACRH,kBADQ,EAER,CAACJ,iBAAD,EAAac,gBAAb,CAFQ,EAGR,UAACpD,GAAD,UAAiB;AAAA;AAAA,YAAVlB,CAAU;AAAA,YAAPgJ,CAAO;;AACb,YAAMN,IAAIxH,IAAIgJ,UAAJ,GAAkBlK,CAAD,CAAS+D,KAA1B,CAAV;AACA,YAAM0E,IAAKO,CAAD,CAASjF,KAAnB;AACA,eAAO,QAAO2E,CAAP,yCAAOA,CAAP,eAAoBD,CAApB,yCAAoBA,CAApB,MAAyBC,IAAID,CAApC;AACH,KAPO,CA7QyB;AAsRrC,mBAAe,CACX7E,kBADW,EAEX,CAACU,gBAAD,CAFW,EAGX,UAACpD,GAAD,UAAc;AAAA;AAAA,YAAP8H,CAAO;;AACV,YAAMN,IAAIxH,IAAIR,EAAJ,EAAV;AACA,YAAM+H,IAAKO,CAAD,CAASjF,KAAnB;AACA,eAAO,QAAO2E,CAAP,yCAAOA,CAAP,eAAoBD,CAApB,yCAAoBA,CAApB,MAAyBC,IAAID,CAApC;AACH,KAPU,CAtRsB;AA+RrC,gBAAY,CACR7E,kBADQ,EAER,CAACJ,iBAAD,EAAac,gBAAb,CAFQ,EAGR,UAACpD,GAAD,UAAiB;AAAA;AAAA,YAAVlB,CAAU;AAAA,YAAPgJ,CAAO;;AACb,YAAMN,IAAIxH,IAAIgJ,UAAJ,GAAkBlK,CAAD,CAAS+D,KAA1B,CAAV;AACA,YAAM0E,IAAKO,CAAD,CAASjF,KAAnB;AACA,eAAO,QAAO2E,CAAP,yCAAOA,CAAP,eAAoBD,CAApB,yCAAoBA,CAApB,MAAyBC,IAAID,CAApC;AACH,KAPO,CA/RyB;AAwSrC,mBAAe,CACX7E,kBADW,EAEX,CAACU,gBAAD,CAFW,EAGX,UAACpD,GAAD,UAAc;AAAA;AAAA,YAAP8H,CAAO;;AACV,YAAMN,IAAIxH,IAAIR,EAAJ,EAAV;AACA,YAAM+H,IAAKO,CAAD,CAASjF,KAAnB;AACA,eAAO,QAAO2E,CAAP,yCAAOA,CAAP,eAAoBD,CAApB,yCAAoBA,CAApB,MAAyBC,IAAID,CAApC;AACH,KAPU,CAxSsB;AAiTrC,iBAAa,CACT7E,kBADS,EAET,CAACJ,iBAAD,EAAac,gBAAb,CAFS,EAGT,UAACpD,GAAD,UAAiB;AAAA;AAAA,YAAVlB,CAAU;AAAA,YAAPgJ,CAAO;;AACb,YAAMN,IAAIxH,IAAIgJ,UAAJ,GAAkBlK,CAAD,CAAS+D,KAA1B,CAAV;AACA,YAAM0E,IAAKO,CAAD,CAASjF,KAAnB;AACA,eAAO,QAAO2E,CAAP,yCAAOA,CAAP,eAAoBD,CAApB,yCAAoBA,CAApB,MAAyBC,KAAKD,CAArC;AACH,KAPQ,CAjTwB;AA0TrC,oBAAgB,CACZ7E,kBADY,EAEZ,CAACU,gBAAD,CAFY,EAGZ,UAACpD,GAAD,UAAc;AAAA;AAAA,YAAP8H,CAAO;;AACV,YAAMN,IAAIxH,IAAIR,EAAJ,EAAV;AACA,YAAM+H,IAAKO,CAAD,CAASjF,KAAnB;AACA,eAAO,QAAO2E,CAAP,yCAAOA,CAAP,eAAoBD,CAApB,yCAAoBA,CAApB,MAAyBC,KAAKD,CAArC;AACH,KAPW,CA1TqB;AAmUrC,iBAAa,CACT7E,kBADS,EAET,CAACJ,iBAAD,EAAac,gBAAb,CAFS,EAGT,UAACpD,GAAD,UAAiB;AAAA;AAAA,YAAVlB,CAAU;AAAA,YAAPgJ,CAAO;;AACb,YAAMN,IAAIxH,IAAIgJ,UAAJ,GAAkBlK,CAAD,CAAS+D,KAA1B,CAAV;AACA,YAAM0E,IAAKO,CAAD,CAASjF,KAAnB;AACA,eAAO,QAAO2E,CAAP,yCAAOA,CAAP,eAAoBD,CAApB,yCAAoBA,CAApB,MAAyBC,KAAKD,CAArC;AACH,KAPQ,CAnUwB;AA4UrC,oBAAgB,CACZ7E,kBADY,EAEZ,CAACU,gBAAD,CAFY,EAGZ,UAACpD,GAAD,UAAc;AAAA;AAAA,YAAP8H,CAAO;;AACV,YAAMN,IAAIxH,IAAIR,EAAJ,EAAV;AACA,YAAM+H,IAAKO,CAAD,CAASjF,KAAnB;AACA,eAAO,QAAO2E,CAAP,yCAAOA,CAAP,eAAoBD,CAApB,yCAAoBA,CAApB,MAAyBC,KAAKD,CAArC;AACH,KAPW,CA5UqB;AAqVrC,kBAAc,CACV7E,kBADU,EAEV,CAACU,gBAAD,CAFU,EAGV,UAACpD,GAAD;AAAA;AAAA,YAAOlB,CAAP;;AAAA,eAAeA,CAAD,CAAS+D,KAAT,IAAkB7C,IAAIgJ,UAAJ,EAAhC;AAAA,KAHU,CArVuB;AA0VrC,qBAAiB,CACbtG,kBADa,EAEb,EAFa,EAGb,UAAC1C,GAAD;AAAA,eAASA,IAAIR,EAAJ,OAAa,IAAtB;AAAA,KAHa,CA1VoB;AA+VrC,sBAAkB,CACdkD,kBADc,EAEd,CAAC,kBAAMJ,iBAAN,CAAD,CAFc,EAGd,UAACtC,GAAD;AAAA;AAAA,YAAO8H,CAAP;;AAAA,eAAeA,CAAD,CAASjF,KAAT,CAAe8H,OAAf,CAAuB3K,IAAIiJ,YAAJ,EAAvB,KAA8C,CAA5D;AAAA,KAHc,CA/VmB;AAoWrC,oBAAgB,CACZvG,kBADY,EAEZ,CAAC,kBAAMU,gBAAN,CAAD,CAFY,EAGZ,UAACpD,GAAD;AAAA;AAAA,YAAO8H,CAAP;;AAAA,eAAeA,CAAD,CAASjF,KAAT,CAAe8H,OAAf,CAAuB3K,IAAIR,EAAJ,EAAvB,KAAoC,CAAlD;AAAA,KAHY,CApWqB;AAyWrC,uBAAmB,CACfkD,kBADe,EAEf,CAACJ,iBAAD,EAAa,kBAAMc,gBAAN,CAAb,CAFe;AAGf;AACA,cAACpD,GAAD;AAAA;AAAA,YAAOlB,CAAP;AAAA,YAAUgJ,CAAV;;AAAA,eAAkBA,CAAD,CAASjF,KAAT,CAAe8H,OAAf,CAAuB3K,IAAIgJ,UAAJ,GAAkBlK,CAAD,CAAS+D,KAA1B,CAAvB,KAA4D,CAA7E;AAAA,KAJe,CAzWkB;AA+WrC,uBAAmB,CACfH,kBADe,EAEf,CAACJ,iBAAD,EAAa,kBAAMc,gBAAN,CAAb,CAFe;AAGf;AACA,cAACpD,GAAD;AAAA;AAAA,YAAOlB,CAAP;AAAA,YAAUgJ,CAAV;;AAAA,eAAiBS,aAAavI,IAAIgJ,UAAJ,GAAkBlK,CAAD,CAAS+D,KAA1B,CAAb,EAAgDiF,CAAD,CAASjF,KAAxD,EAA+D,CAA/D,EAAmEiF,CAAD,CAASjF,KAAT,CAAetD,MAAf,GAAwB,CAA1F,CAAjB;AAAA,KAJe,CA/WkB;AAqXrC,SAAK;AACDK,cAAM8C,kBADL;AAED5B,mBAAW,CACP,CAAC,CAAC0B,iBAAD,EAAaA,iBAAb,CAAD,EAA2BwF,EAA3B,CADO,EAEP,CAAC,CAAC1F,iBAAD,EAAaA,iBAAb,CAAD,EAA2B0F,EAA3B,CAFO,EAGP,CAAC,CAAC1F,iBAAD,EAAaA,iBAAb,EAAyB8D,mBAAzB,CAAD,EAAyCgC,SAAzC,CAHO;AAFV,KArXgC;AA6XrC,SAAK;AACDxI,cAAM8C,kBADL;AAED5B,mBAAW,CACP,CAAC,CAAC0B,iBAAD,EAAaA,iBAAb,CAAD,EAA2BuF,EAA3B,CADO,EAEP,CAAC,CAACzF,iBAAD,EAAaA,iBAAb,CAAD,EAA2ByF,EAA3B,CAFO,EAGP,CAAC,CAACzF,iBAAD,EAAaA,iBAAb,EAAyB8D,mBAAzB,CAAD,EAAyC+B,SAAzC,CAHO;AAFV,KA7XgC;AAqYrC,UAAM;AACFvI,cAAM8C,kBADJ;AAEF5B,mBAAW,CACP,CAAC,CAAC0B,iBAAD,EAAaA,iBAAb,CAAD,EAA2B0F,IAA3B,CADO,EAEP,CAAC,CAAC5F,iBAAD,EAAaA,iBAAb,CAAD,EAA2B4F,IAA3B,CAFO,EAGP,CAAC,CAAC5F,iBAAD,EAAaA,iBAAb,EAAyB8D,mBAAzB,CAAD,EAAyCkC,WAAzC,CAHO;AAFT,KArY+B;AA6YrC,UAAM;AACF1I,cAAM8C,kBADJ;AAEF5B,mBAAW,CACP,CAAC,CAAC0B,iBAAD,EAAaA,iBAAb,CAAD,EAA2ByF,IAA3B,CADO,EAEP,CAAC,CAAC3F,iBAAD,EAAaA,iBAAb,CAAD,EAA2B2F,IAA3B,CAFO,EAGP,CAAC,CAAC3F,iBAAD,EAAaA,iBAAb,EAAyB8D,mBAAzB,CAAD,EAAyCiC,WAAzC,CAHO;AAFT,KA7Y+B;AAqZrC,WAAO;AACHzI,cAAM8C,kBADH;AAEH5B,mBAAW,CACP,CACI,CAAC4B,kBAAD,EAAcA,kBAAd,CADJ,EAEI,UAAC1C,GAAD;AAAA;AAAA,gBAAOwH,CAAP;AAAA,gBAAUD,CAAV;;AAAA,mBAAiBC,EAAE3H,QAAF,CAAWG,GAAX,KAAmBuH,EAAE1H,QAAF,CAAWG,GAAX,CAApC;AAAA,SAFJ,CADO,EAKP,CACI0I,QAAQhG,kBAAR,CADJ,EAEI,UAAC1C,GAAD,EAAMF,IAAN,EAAe;AAAA;AAAA;AAAA;;AAAA;AACX,sCAAkBA,IAAlB,mIAAwB;AAAA,wBAAbM,GAAa;;AACpB,wBAAI,CAACA,IAAIP,QAAJ,CAAaG,GAAb,CAAL,EACI,OAAO,KAAP;AACP;AAJU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKX,mBAAO,IAAP;AACH,SARL,CALO;AAFR,KArZ8B;AAwarC,WAAO;AACHJ,cAAM8C,kBADH;AAEH5B,mBAAW,CACP,CACI,CAAC4B,kBAAD,EAAcA,kBAAd,CADJ,EAEI,UAAC1C,GAAD;AAAA;AAAA,gBAAOwH,CAAP;AAAA,gBAAUD,CAAV;;AAAA,mBAAiBC,EAAE3H,QAAF,CAAWG,GAAX,KAAmBuH,EAAE1H,QAAF,CAAWG,GAAX,CAApC;AAAA,SAFJ,CADO,EAKP,CACI0I,QAAQhG,kBAAR,CADJ,EAEI,UAAC1C,GAAD,EAAMF,IAAN,EAAe;AAAA;AAAA;AAAA;;AAAA;AACX,sCAAkBA,IAAlB,mIAAwB;AAAA,wBAAbM,GAAa;;AACpB,wBAAIA,IAAIP,QAAJ,CAAaG,GAAb,CAAJ,EACI,OAAO,IAAP;AACP;AAJU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKX,mBAAO,KAAP;AACH,SARL,CALO;AAFR,KAxa8B;AA2brC,SAAK,CACD0C,kBADC,EAED,CAACA,kBAAD,CAFC,EAGD,UAAC1C,GAAD;AAAA;AAAA,YAAOuH,CAAP;;AAAA,eAAc,CAACA,EAAE1H,QAAF,CAAWG,GAAX,CAAf;AAAA,KAHC,CA3bgC;AAgcrC,2BAAuB,CACnB0C,kBADmB,EAEnB,CAACJ,iBAAD,CAFmB;AAGnB;AACA,cAACtC,GAAD,WAAc;AAAA;AAAA,YAAP4K,CAAO;;AACV,YAAMC,oBAAoB7K,IAAIkJ,OAAJ,IAAelJ,IAAIkJ,OAAJ,CAAY2B,iBAArD;AACA,YAAIA,iBAAJ,EAAuB;AACnB,mBAAOA,kBAAkBD,EAAE/K,QAAF,CAAWG,GAAX,CAAlB,CAAP;AACH;AACD,eAAO,IAAP;AACH,KAVkB,CAhcc;AA4crC,cAAU,CACNsC,iBADM,EAEN,CAACA,iBAAD,CAFM,EAGN,UAACtC,GAAD;AAAA;AAAA,YAAO4K,CAAP;;AAAA,eAAcA,EAAE/K,QAAF,CAAWG,GAAX,EAAgB8K,WAAhB,EAAd;AAAA,KAHM,CA5c2B;AAidrC,gBAAY,CACRxI,iBADQ,EAER,CAACA,iBAAD,CAFQ,EAGR,UAACtC,GAAD;AAAA;AAAA,YAAO4K,CAAP;;AAAA,eAAcA,EAAE/K,QAAF,CAAWG,GAAX,EAAgB+K,WAAhB,EAAd;AAAA,KAHQ,CAjdyB;AAsdrC,cAAU,CACNzI,iBADM,EAENoG,QAAQpG,iBAAR,CAFM,EAGN,UAACtC,GAAD,EAAMF,IAAN;AAAA,eAAeA,KAAKhC,GAAL,CAAS;AAAA,mBAAOsC,IAAIP,QAAJ,CAAaG,GAAb,CAAP;AAAA,SAAT,EAAmCiC,IAAnC,CAAwC,EAAxC,CAAf;AAAA,KAHM,CAtd2B;AA2drC,uBAAmB,CACfK,iBADe,EAEf,CAAC8D,mBAAD,CAFe,EAGf,UAACpG,GAAD;AAAA;AAAA,YAAO4F,QAAP;;AAAA,eAAqBA,SAAS/F,QAAT,CAAkBG,GAAlB,EAAuBgL,cAAvB,EAArB;AAAA,KAHe;AA3dkB,CAAzC;;kBAkeenE,W;;;;;;;;;;;;;;;;;;;;;;ACjkBf;;;;AAEA;;IAAYoE,W;;AACZ;;AACA;;;;;;;;;;;;IAaMnE,W;AAQF,yBAAYlH,IAAZ,EAAwBsL,aAAxB,EAA0DtI,KAA1D,EAA6EuI,KAA7E,EAA2F;AAAA;;AACvF,aAAKvL,IAAL,GAAYA,IAAZ;AACA,aAAKsL,aAAL,GAAqBA,aAArB;AACA,aAAKtI,KAAL,GAAaA,KAAb;;AAEA,aAAKwI,MAAL,GAAc,EAAd;AACA,aAAKC,OAAL,GAAe,EAAf;AANuF;AAAA;AAAA;;AAAA;AAOvF,iCAAkCF,KAAlC,8HAAyC;AAAA;;AAAA;;AAAA,oBAA7BG,KAA6B;AAAA,oBAAtBnH,UAAsB;;AACrC,qBAAKiH,MAAL,CAAY9J,IAAZ,CAAiBgK,KAAjB;AACA,qBAAKD,OAAL,CAAa/J,IAAb,CAAkB6C,UAAlB;AACH;AAVsF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAW1F;;;;iCAuGQnE,G,EAAwB;AAC7B,gBAAMoL,SAAS,KAAKA,MAApB;AACA,gBAAMC,UAAU,KAAKA,OAArB;;AAEA,gBAAID,OAAO7L,MAAP,KAAkB,CAAtB,EAAyB;AACrB,uBAAO8L,QAAQ,CAAR,EAAWxL,QAAX,CAAoBG,GAApB,CAAP;AACH;;AAED,gBAAM6C,QAAU,KAAKD,KAAL,CAAW/C,QAAX,CAAoBG,GAApB,CAAhB;AACA,gBAAI6C,SAASuI,OAAO,CAAP,CAAb,EAAwB;AACpB,uBAAOC,QAAQ,CAAR,EAAWxL,QAAX,CAAoBG,GAApB,CAAP;AACH;;AAED,gBAAMuL,YAAYH,OAAO7L,MAAzB;AACA,gBAAIsD,SAASuI,OAAOG,YAAY,CAAnB,CAAb,EAAoC;AAChC,uBAAOF,QAAQE,YAAY,CAApB,EAAuB1L,QAAvB,CAAgCG,GAAhC,CAAP;AACH;;AAED,gBAAM2D,QAAQ,sCAA0ByH,MAA1B,EAAkCvI,KAAlC,CAAd;AACA,gBAAM2I,QAAQJ,OAAOzH,KAAP,CAAd;AACA,gBAAM8H,QAAQL,OAAOzH,QAAQ,CAAf,CAAd;AACA,gBAAMG,IAAIgD,YAAY4E,mBAAZ,CAAgC,KAAKR,aAArC,EAAoDrI,KAApD,EAA2D2I,KAA3D,EAAkEC,KAAlE,CAAV;;AAEA,gBAAME,cAAcN,QAAQ1H,KAAR,EAAe9D,QAAf,CAAwBG,GAAxB,CAApB;AACA,gBAAM4L,cAAcP,QAAQ1H,QAAQ,CAAhB,EAAmB9D,QAAnB,CAA4BG,GAA5B,CAApB;;AAEA,mBAAQiL,YAAY,KAAKrL,IAAL,CAAUsD,IAAV,CAAe6H,WAAf,EAAZ,CAAD,CAAiDY,WAAjD,EAA8DC,WAA9D,EAA2E9H,CAA3E,CAAP,CA1B6B,CA0ByD;AACzF;;;kCAES7D,E,EAA0B;AAChCA,eAAG,KAAK2C,KAAR;AADgC;AAAA;AAAA;;AAAA;AAEhC,sCAAyB,KAAKyI,OAA9B,mIAAuC;AAAA,wBAA5BlH,UAA4B;;AACnClE,uBAAGkE,UAAH;AACH;AAJ+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKnC;;;0CAEiB;AAAA;;AACd,mBAAO,aAAGhE,MAAH,iCAAa,KAAKkL,OAAL,CAAavN,GAAb,CAAiB,UAAC+N,MAAD;AAAA,uBAAYA,OAAO9I,eAAP,EAAZ;AAAA,aAAjB,CAAb,EAAP;AACH;;;oCAEW;AACR,gBAAImI,sBAAJ;AACA,gBAAI,KAAKA,aAAL,CAAmBvL,IAAnB,KAA4B,QAAhC,EAA0C;AACtCuL,gCAAgB,CAAC,QAAD,CAAhB;AACH,aAFD,MAEO,IAAI,KAAKA,aAAL,CAAmBvL,IAAnB,KAA4B,aAAhC,EAA+C;AAClD,oBAAK,KAAKuL,aAAL,CAAmBY,IAAnB,KAA4B,CAAjC,EAAoC;AAChCZ,oCAAgB,CAAC,QAAD,CAAhB;AACH,iBAFD,MAEO;AACHA,oCAAgB,CAAC,aAAD,EAAgB,KAAKA,aAAL,CAAmBY,IAAnC,CAAhB;AACH;AACJ,aANM,MAMA;AACHZ,gCAAgB,CAAC,cAAD,EAAkB/K,MAAlB,CAAyB,KAAK+K,aAAL,CAAmBa,aAA5C,CAAhB;AACH;;AAED,gBAAM/I,aAAa,CAAC,aAAD,EAAgBkI,aAAhB,EAA+B,KAAKtI,KAAL,CAAWvC,SAAX,EAA/B,CAAnB;;AAEA,iBAAK,IAAIf,IAAI,CAAb,EAAgBA,IAAI,KAAK8L,MAAL,CAAY7L,MAAhC,EAAwCD,GAAxC,EAA6C;AACzC0D,2BAAW1B,IAAX,CACI,KAAK8J,MAAL,CAAY9L,CAAZ,CADJ,EAEI,KAAK+L,OAAL,CAAa/L,CAAb,EAAgBe,SAAhB,EAFJ;AAIH;AACD,mBAAO2C,UAAP;AACH;;;4CApK0BkI,a,EAAkCtI,K,EAAe4I,K,EAAeC,K,EAAe;AACtG,gBAAI3H,IAAI,CAAR;AACA,gBAAIoH,cAAcvL,IAAd,KAAuB,aAA3B,EAA0C;AACtCmE,oBAAIkI,yBAAyBpJ,KAAzB,EAAgCsI,cAAcY,IAA9C,EAAoDN,KAApD,EAA2DC,KAA3D,CAAJ;AACH,aAFD,MAEO,IAAIP,cAAcvL,IAAd,KAAuB,QAA3B,EAAqC;AACxCmE,oBAAIkI,yBAAyBpJ,KAAzB,EAAgC,CAAhC,EAAmC4I,KAAnC,EAA0CC,KAA1C,CAAJ;AACH,aAFM,MAEA,IAAIP,cAAcvL,IAAd,KAAuB,cAA3B,EAA2C;AAC9C,oBAAMoF,IAAImG,cAAca,aAAxB;AACA,oBAAME,KAAK,IAAIC,oBAAJ,CAAenH,EAAE,CAAF,CAAf,EAAqBA,EAAE,CAAF,CAArB,EAA2BA,EAAE,CAAF,CAA3B,EAAiCA,EAAE,CAAF,CAAjC,CAAX;AACAjB,oBAAImI,GAAGE,KAAH,CAASH,yBAAyBpJ,KAAzB,EAAgC,CAAhC,EAAmC4I,KAAnC,EAA0CC,KAA1C,CAAT,CAAJ;AACH;AACD,mBAAO3H,CAAP;AACH;;;8BAEYhE,I,EAAoBQ,O,EAAyB;AAAA,iCACbR,IADa;AAAA,gBAC9CoL,aAD8C;AAAA,gBAC/BtI,KAD+B;AAAA,gBACrBwJ,IADqB;;AAGtD,gBAAI,CAACzL,MAAMC,OAAN,CAAcsK,aAAd,CAAD,IAAiCA,cAAc3L,MAAd,KAAyB,CAA9D,EAAiE;AAC7D,uBAAOe,QAAQI,KAAR,+CAA4D,CAA5D,CAAP;AACH;;AAED,gBAAIwK,cAAc,CAAd,MAAqB,QAAzB,EAAmC;AAC/BA,gCAAgB,EAAEvL,MAAM,QAAR,EAAhB;AACH,aAFD,MAEO,IAAIuL,cAAc,CAAd,MAAqB,aAAzB,EAAwC;AAC3C,oBAAMY,QAAOZ,cAAc,CAAd,CAAb;AACA,oBAAI,OAAOY,KAAP,KAAgB,QAApB,EACI,OAAOxL,QAAQI,KAAR,uDAAoE,CAApE,EAAuE,CAAvE,CAAP;AACJwK,gCAAgB;AACZvL,0BAAM,aADM;AAEZmM;AAFY,iBAAhB;AAIH,aARM,MAQA,IAAIZ,cAAc,CAAd,MAAqB,cAAzB,EAAyC;AAC5C,oBAAMa,iBAAgBb,cAAc/L,KAAd,CAAoB,CAApB,CAAtB;AACA,oBACI4M,eAAcxM,MAAd,KAAyB,CAAzB,IACAwM,eAAcnH,IAAd,CAAmB;AAAA,2BAAK,OAAOd,CAAP,KAAa,QAAb,IAAyBA,IAAI,CAA7B,IAAkCA,IAAI,CAA3C;AAAA,iBAAnB,CAFJ,EAGE;AACE,2BAAOxD,QAAQI,KAAR,CAAc,yFAAd,EAAyG,CAAzG,CAAP;AACH;;AAEDwK,gCAAgB;AACZvL,0BAAM,cADM;AAEZoM,mCAAgBA;AAFJ,iBAAhB;AAIH,aAbM,MAaA;AACH,uBAAOzL,QAAQI,KAAR,iCAA4CmI,OAAOqC,cAAc,CAAd,CAAP,CAA5C,EAAwE,CAAxE,EAA2E,CAA3E,CAAP;AACH;;AAED,gBAAIpL,KAAKP,MAAL,GAAc,CAAd,GAAkB,CAAtB,EAAyB;AACrB,uBAAOe,QAAQI,KAAR,qDAA+DZ,KAAKP,MAAL,GAAc,CAA7E,QAAP;AACH;;AAED,gBAAI,CAACO,KAAKP,MAAL,GAAc,CAAf,IAAoB,CAApB,KAA0B,CAA9B,EAAiC;AAC7B,uBAAOe,QAAQI,KAAR,yCAAP;AACH;;AAEDkC,oBAAQtC,QAAQe,KAAR,CAAcuB,KAAd,EAAqB,CAArB,EAAwBJ,iBAAxB,CAAR;AACA,gBAAI,CAACI,KAAL,EAAY,OAAO,IAAP;;AAEZ,gBAAMuI,QAAe,EAArB;;AAEA,gBAAI3G,aAAoB,IAAxB;AACA,gBAAIlE,QAAQuD,YAAR,IAAwBvD,QAAQuD,YAAR,CAAqBX,IAArB,KAA8B,OAA1D,EAAmE;AAC/DsB,6BAAalE,QAAQuD,YAArB;AACH;;AAED,iBAAK,IAAIvE,IAAI,CAAb,EAAgBA,IAAI8M,KAAK7M,MAAzB,EAAiCD,KAAK,CAAtC,EAAyC;AACrC,oBAAMgM,QAAQc,KAAK9M,CAAL,CAAd;AACA,oBAAMuD,QAAQuJ,KAAK9M,IAAI,CAAT,CAAd;;AAEA,oBAAM+M,WAAW/M,IAAI,CAArB;AACA,oBAAMgN,WAAWhN,IAAI,CAArB;;AAEA,oBAAI,OAAOgM,KAAP,KAAiB,QAArB,EAA+B;AAC3B,2BAAOhL,QAAQI,KAAR,CAAc,gJAAd,EAAgK2L,QAAhK,CAAP;AACH;;AAED,oBAAIlB,MAAM5L,MAAN,IAAgB4L,MAAMA,MAAM5L,MAAN,GAAe,CAArB,EAAwB,CAAxB,KAA8B+L,KAAlD,EAAyD;AACrD,2BAAOhL,QAAQI,KAAR,CAAc,kHAAd,EAAkI2L,QAAlI,CAAP;AACH;;AAED,oBAAMjL,SAASd,QAAQe,KAAR,CAAcwB,KAAd,EAAqByJ,QAArB,EAA+B9H,UAA/B,CAAf;AACA,oBAAI,CAACpD,MAAL,EAAa,OAAO,IAAP;AACboD,6BAAaA,cAAcpD,OAAOxB,IAAlC;AACAuL,sBAAM7J,IAAN,CAAW,CAACgK,KAAD,EAAQlK,MAAR,CAAX;AACH;;AAED,gBAAIoD,WAAWtB,IAAX,KAAoB,QAApB,IACAsB,WAAWtB,IAAX,KAAoB,OADpB,IAEA,EACIsB,WAAWtB,IAAX,KAAoB,OAApB,IACAsB,WAAWvB,QAAX,CAAoBC,IAApB,KAA6B,QAD7B,IAEA,OAAOsB,WAAWrB,CAAlB,KAAwB,QAH5B,CAFJ,EAOE;AACE,uBAAO7C,QAAQI,KAAR,WAAsB,qBAAS8D,UAAT,CAAtB,6BAAP;AACH;;AAED,mBAAO,IAAIsC,WAAJ,CAAgBtC,UAAhB,EAA4B0G,aAA5B,EAA2CtI,KAA3C,EAAkDuI,KAAlD,CAAP;AACH;;;;;;AAoEL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA,SAASa,wBAAT,CAAkCpJ,KAAlC,EAAyCkJ,IAAzC,EAA+CS,UAA/C,EAA2DC,UAA3D,EAAuE;AACnE,QAAMC,aAAaD,aAAaD,UAAhC;AACA,QAAMG,WAAW9J,QAAQ2J,UAAzB;;AAEA,QAAIE,eAAe,CAAnB,EAAsB;AAClB,eAAO,CAAP;AACH,KAFD,MAEO,IAAIX,SAAS,CAAb,EAAgB;AACnB,eAAOY,WAAWD,UAAlB;AACH,KAFM,MAEA;AACH,eAAO,CAACpJ,KAAKoG,GAAL,CAASqC,IAAT,EAAeY,QAAf,IAA2B,CAA5B,KAAkCrJ,KAAKoG,GAAL,CAASqC,IAAT,EAAeW,UAAf,IAA6B,CAA/D,CAAP;AACH;AACJ;;kBAEc3F,W;;;;;;;;;;;;;;;;;;;;AC7Pf;;AAEA;;AACA;;;;;;;;IAOMC,M;AAIF,oBAAYnE,KAAZ,EAA+B;AAAA;;AAC3B,aAAKhD,IAAL,GAAY4C,iBAAZ;AACA,aAAKI,KAAL,GAAaA,KAAb;AACH;;;;iCAeQ5C,G,EAAwB;AAC7B,gBAAM4C,QAAQ,KAAKA,KAAL,CAAW/C,QAAX,CAAoBG,GAApB,CAAd;AACA,gBAAI,OAAO4C,KAAP,KAAiB,QAArB,EAA+B;AAC3B,uBAAOA,MAAMrD,MAAb;AACH,aAFD,MAEO,IAAIoB,MAAMC,OAAN,CAAcgC,KAAd,CAAJ,EAA0B;AAC7B,uBAAOA,MAAMrD,MAAb;AACH,aAFM,MAEA;AACH,sBAAM,IAAIuD,uBAAJ,8DAA4E,qBAAS,oBAAOF,KAAP,CAAT,CAA5E,eAAN;AACH;AACJ;;;kCAES3C,E,EAA0B;AAChCA,eAAG,KAAK2C,KAAR;AACH;;;0CAEiB;AACd,mBAAO,CAAC1C,SAAD,CAAP;AACH;;;oCAEW;AACR,gBAAM8C,aAAa,CAAC,QAAD,CAAnB;AACA,iBAAKsB,SAAL,CAAe,iBAAS;AAAEtB,2BAAW1B,IAAX,CAAgBiD,MAAMlE,SAAN,EAAhB;AAAqC,aAA/D;AACA,mBAAO2C,UAAP;AACH;;;8BApCYlD,I,EAAoBQ,O,EAAyB;AACtD,gBAAIR,KAAKP,MAAL,KAAgB,CAApB,EACI,OAAOe,QAAQI,KAAR,sCAAgDZ,KAAKP,MAAL,GAAc,CAA9D,gBAAP;;AAEJ,gBAAMqD,QAAQtC,QAAQe,KAAR,CAAcvB,KAAK,CAAL,CAAd,EAAuB,CAAvB,CAAd;AACA,gBAAI,CAAC8C,KAAL,EAAY,OAAO,IAAP;;AAEZ,gBAAIA,MAAMhD,IAAN,CAAWsD,IAAX,KAAoB,OAApB,IAA+BN,MAAMhD,IAAN,CAAWsD,IAAX,KAAoB,QAAnD,IAA+DN,MAAMhD,IAAN,CAAWsD,IAAX,KAAoB,OAAvF,EACI,OAAO5C,QAAQI,KAAR,2DAAsE,qBAASkC,MAAMhD,IAAf,CAAtE,eAAP;;AAEJ,mBAAO,IAAImH,MAAJ,CAAWnE,KAAX,CAAP;AACH;;;;;;kBA4BUmE,M;;;;;;;;;;;;;;;;;;;;;;;;;;ICrDTC,G;AAKF,iBAAY2F,QAAZ,EAAmD9N,MAAnD,EAAuE;AAAA;;AACnE,aAAKe,IAAL,GAAYf,OAAOe,IAAnB;AACA,aAAK+M,QAAL,GAAgB,GAAGxM,MAAH,CAAUwM,QAAV,CAAhB;AACA,aAAK9N,MAAL,GAAcA,MAAd;AACH;;;;iCAEQmB,G,EAAwB;AAC7B,mBAAO,KAAKnB,MAAL,CAAYgB,QAAZ,CAAqBG,GAArB,CAAP;AACH;;;kCAESC,E,EAA0B;AAAA;AAAA;AAAA;;AAAA;AAChC,qCAAsB,KAAK0M,QAA3B,8HAAqC;AAAA,wBAA1BC,OAA0B;;AACjC3M,uBAAG2M,QAAQ,CAAR,CAAH;AACH;AAH+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAIhC3M,eAAG,KAAKpB,MAAR;AACH;;;0CA8BiB;AACd,mBAAO,KAAKA,MAAL,CAAYkE,eAAZ,EAAP;AACH;;;oCAEW;AACR,gBAAMC,aAAa,CAAC,KAAD,CAAnB;AADQ;AAAA;AAAA;;AAAA;AAER,sCAA2B,KAAK2J,QAAhC,mIAA0C;AAAA;;AAAA;;AAAA,wBAA9BhN,IAA8B;AAAA,wBAAxBkN,IAAwB;;AACtC7J,+BAAW1B,IAAX,CAAgB3B,IAAhB,EAAsBkN,KAAKxM,SAAL,EAAtB;AACH;AAJO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKR2C,uBAAW1B,IAAX,CAAgB,KAAKzC,MAAL,CAAYwB,SAAZ,EAAhB;AACA,mBAAO2C,UAAP;AACH;;;8BAvCYlD,I,EAAoBQ,O,EAAyB;AACtD,gBAAIR,KAAKP,MAAL,GAAc,CAAlB,EACI,OAAOe,QAAQI,KAAR,gDAA0DZ,KAAKP,MAAL,GAAc,CAAxE,gBAAP;;AAEJ,gBAAMoN,WAAwC,EAA9C;AACA,iBAAK,IAAIrN,IAAI,CAAb,EAAgBA,IAAIQ,KAAKP,MAAL,GAAc,CAAlC,EAAqCD,KAAK,CAA1C,EAA6C;AACzC,oBAAMK,OAAOG,KAAKR,CAAL,CAAb;;AAEA,oBAAI,OAAOK,IAAP,KAAgB,QAApB,EAA8B;AAC1B,2BAAOW,QAAQI,KAAR,yCAAmDf,IAAnD,yCAAmDA,IAAnD,kBAAoEL,CAApE,CAAP;AACH;;AAED,oBAAI,gBAAgB4E,IAAhB,CAAqBvE,IAArB,CAAJ,EAAgC;AAC5B,2BAAOW,QAAQI,KAAR,uEAAkFpB,CAAlF,CAAP;AACH;;AAED,oBAAMuD,QAAQvC,QAAQe,KAAR,CAAcvB,KAAKR,IAAI,CAAT,CAAd,EAA2BA,IAAI,CAA/B,CAAd;AACA,oBAAI,CAACuD,KAAL,EAAY,OAAO,IAAP;;AAEZ8J,yBAASrL,IAAT,CAAc,CAAC3B,IAAD,EAAOkD,KAAP,CAAd;AACH;;AAED,gBAAMhE,SAASyB,QAAQe,KAAR,CAAcvB,KAAKA,KAAKP,MAAL,GAAc,CAAnB,CAAd,EAAqCO,KAAKP,MAAL,GAAc,CAAnD,EAAsDW,SAAtD,EAAiEyM,QAAjE,CAAf;AACA,gBAAI,CAAC9N,MAAL,EAAa,OAAO,IAAP;;AAEb,mBAAO,IAAImI,GAAJ,CAAQ2F,QAAR,EAAkB9N,MAAlB,CAAP;AACH;;;;;;kBAgBUmI,G;;;;;;;;;;;;;;;;;;;;ACrEf;;;;AACA;;;;;;IAOMC,O;AAIF,qBAAYrH,IAAZ,EAAwBiD,KAAxB,EAAsC;AAAA;;AAClC,aAAKjD,IAAL,GAAYA,IAAZ;AACA,aAAKiD,KAAL,GAAaA,KAAb;AACH;;;;mCA2BU;AACP,mBAAO,KAAKA,KAAZ;AACH;;;oCAEW,CAAE;;;0CAEI;AACd,mBAAO,CAAC,KAAKA,KAAN,CAAP;AACH;;;oCAEW;AACR,gBAAI,KAAKjD,IAAL,CAAUsD,IAAV,KAAmB,OAAnB,IAA8B,KAAKtD,IAAL,CAAUsD,IAAV,KAAmB,QAArD,EAA+D;AAC3D,uBAAO,CAAC,SAAD,EAAY,KAAKL,KAAjB,CAAP;AACH,aAFD,MAEO,IAAI,KAAKA,KAAL,YAAsBsC,aAA1B,EAAiC;AACpC;AACA;AACA;AACA,uBAAO,CAAC,MAAD,EAAShF,MAAT,CAAgB,KAAK0C,KAAL,CAAWkG,OAAX,EAAhB,CAAP;AACH,aALM,MAKA;AACH,sCAAO,KAAKlG,KAAL,KAAe,IAAf,IACH,OAAO,KAAKA,KAAZ,KAAsB,QADnB,IAEH,OAAO,KAAKA,KAAZ,KAAsB,QAFnB,IAGH,OAAO,KAAKA,KAAZ,KAAsB,SAH1B;AAIA,uBAAQ,KAAKA,KAAb;AACH;AACJ;;;8BAlDY/C,I,EAAoBQ,O,EAAyB;AACtD,gBAAIR,KAAKP,MAAL,KAAgB,CAApB,EACI,OAAOe,QAAQI,KAAR,uEAA+EZ,KAAKP,MAAL,GAAc,CAA7F,gBAAP;;AAEJ,gBAAI,CAAC,qBAAQO,KAAK,CAAL,CAAR,CAAL,EACI,OAAOQ,QAAQI,KAAR,iBAAP;;AAEJ,gBAAMmC,QAAS/C,KAAK,CAAL,CAAf;AACA,gBAAIF,OAAO,oBAAOiD,KAAP,CAAX;;AAEA;AACA,gBAAM3B,WAAWZ,QAAQuD,YAAzB;AACA,gBACIjE,KAAKsD,IAAL,KAAc,OAAd,IACAtD,KAAKuD,CAAL,KAAW,CADX,IAEAjC,QAFA,IAGAA,SAASgC,IAAT,KAAkB,OAHlB,KAIC,OAAOhC,SAASiC,CAAhB,KAAsB,QAAtB,IAAkCjC,SAASiC,CAAT,KAAe,CAJlD,CADJ,EAME;AACEvD,uBAAOsB,QAAP;AACH;;AAED,mBAAO,IAAI+F,OAAJ,CAAYrH,IAAZ,EAAkBiD,KAAlB,CAAP;AACH;;;;;;kBA8BUoE,O;;;;;;;;;;;;;;;;;;;;;;ACtEf;;;;AAEA;;;;;;;;AAOA;IAGMC,K;AASF,mBAAY4F,SAAZ,EAA6BtI,UAA7B,EAA+C5B,KAA/C,EAAkEmK,KAAlE,EAAgF1B,OAAhF,EAA4GpH,SAA5G,EAAmI;AAAA;;AAC/H,aAAK6I,SAAL,GAAiBA,SAAjB;AACA,aAAKlN,IAAL,GAAY4E,UAAZ;AACA,aAAK5B,KAAL,GAAaA,KAAb;AACA,aAAKmK,KAAL,GAAaA,KAAb;AACA,aAAK1B,OAAL,GAAeA,OAAf;AACA,aAAKpH,SAAL,GAAiBA,SAAjB;AACH;;;;iCAkEQjE,G,EAAwB;AAC7B,gBAAM4C,QAAS,KAAKA,KAAL,CAAW/C,QAAX,CAAoBG,GAApB,CAAf;AACA,mBAAO,CAAC,KAAKqL,OAAL,CAAa,KAAK0B,KAAL,CAAWnK,KAAX,CAAb,KAAmC,KAAKqB,SAAzC,EAAoDpE,QAApD,CAA6DG,GAA7D,CAAP;AACH;;;kCAESC,E,EAA0B;AAChCA,eAAG,KAAK2C,KAAR;AACA,iBAAKyI,OAAL,CAAarM,OAAb,CAAqBiB,EAArB;AACAA,eAAG,KAAKgE,SAAR;AACH;;;0CAEiB;AAAA;;AACd,mBAAO,YACF9D,MADE,gCACQ,KAAKkL,OAAL,CAAavN,GAAb,CAAiB,UAACuG,GAAD;AAAA,uBAASA,IAAItB,eAAJ,EAAT;AAAA,aAAjB,CADR,GAEF5C,MAFE,CAEK,KAAK8D,SAAL,CAAelB,eAAf,EAFL,CAAP;AAGH;;;oCAEW;AAAA;;AACR,gBAAMC,aAAa,CAAC,OAAD,EAAU,KAAKJ,KAAL,CAAWvC,SAAX,EAAV,CAAnB;;AAEA;AACA;AACA,gBAAM2M,eAAe5N,OAAO6N,IAAP,CAAY,KAAKF,KAAjB,EAAwBG,IAAxB,EAArB;;AAEA;AACA;AACA,gBAAMC,kBAA2D,EAAjE;AACA,gBAAMC,eAA0C,EAAhD,CAVQ,CAU4C;AAV5C;AAAA;AAAA;;AAAA;AAWR,qCAAoBJ,YAApB,8HAAkC;AAAA,wBAAvB1B,KAAuB;;AAC9B,wBAAM+B,cAAcD,aAAa,KAAKL,KAAL,CAAWzB,KAAX,CAAb,CAApB;AACA,wBAAI+B,gBAAgBnN,SAApB,EAA+B;AAC3B;AACAkN,qCAAa,KAAKL,KAAL,CAAWzB,KAAX,CAAb,IAAkC6B,gBAAgB5N,MAAlD;AACA4N,wCAAgB7L,IAAhB,CAAqB,CAAC,KAAKyL,KAAL,CAAWzB,KAAX,CAAD,EAAoB,CAACA,KAAD,CAApB,CAArB;AACH,qBAJD,MAIO;AACH;AACA6B,wCAAgBE,WAAhB,EAA6B,CAA7B,EAAgC/L,IAAhC,CAAqCgK,KAArC;AACH;AACJ;AArBO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAuBR,gBAAMgC,cAAc,SAAdA,WAAc,CAAChC,KAAD;AAAA,uBAAW,MAAK1I,KAAL,CAAWhD,IAAX,CAAgBsD,IAAhB,KAAyB,QAAzB,GAAoCmC,OAAOiG,KAAP,CAApC,GAAoDA,KAA/D;AAAA,aAApB;;AAvBQ;AAAA;AAAA;;AAAA;AAyBR,sCAAoC6B,eAApC,mIAAqD;AAAA;;AAAA;;AAAA,wBAAzCE,WAAyC;AAAA,wBAA5BjC,MAA4B;;AACjD,wBAAIA,OAAO7L,MAAP,KAAkB,CAAtB,EAAyB;AACrB;AACAyD,mCAAW1B,IAAX,CAAgBgM,YAAYlC,OAAO,CAAP,CAAZ,CAAhB;AACH,qBAHD,MAGO;AACH;AACApI,mCAAW1B,IAAX,CAAgB8J,OAAOtN,GAAP,CAAWwP,WAAX,CAAhB;AACH;AACDtK,+BAAW1B,IAAX,CAAgB,KAAK+J,OAAL,CAAagC,WAAb,EAA0BhN,SAA1B,EAAhB;AACH;AAlCO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAmCR2C,uBAAW1B,IAAX,CAAgB,KAAK2C,SAAL,CAAe5D,SAAf,EAAhB;AACA,mBAAO2C,UAAP;AACH;;;8BAtHYlD,I,EAAoBQ,O,EAAyB;AACtD,gBAAIR,KAAKP,MAAL,GAAc,CAAlB,EACI,OAAOe,QAAQI,KAAR,qDAA+DZ,KAAKP,MAAL,GAAc,CAA7E,QAAP;AACJ,gBAAIO,KAAKP,MAAL,GAAc,CAAd,KAAoB,CAAxB,EACI,OAAOe,QAAQI,KAAR,yCAAP;;AAEJ,gBAAIoM,kBAAJ;AACA,gBAAItI,mBAAJ;AACA,gBAAIlE,QAAQuD,YAAR,IAAwBvD,QAAQuD,YAAR,CAAqBX,IAArB,KAA8B,OAA1D,EAAmE;AAC/DsB,6BAAalE,QAAQuD,YAArB;AACH;AACD,gBAAMkJ,QAAQ,EAAd;AACA,gBAAM1B,UAAU,EAAhB;AACA,iBAAK,IAAI/L,IAAI,CAAb,EAAgBA,IAAIQ,KAAKP,MAAL,GAAc,CAAlC,EAAqCD,KAAK,CAA1C,EAA6C;AACzC,oBAAI8L,SAAStL,KAAKR,CAAL,CAAb;AACA,oBAAMuD,QAAQ/C,KAAKR,IAAI,CAAT,CAAd;;AAEA,oBAAI,CAACqB,MAAMC,OAAN,CAAcwK,MAAd,CAAL,EAA4B;AACxBA,6BAAS,CAACA,MAAD,CAAT;AACH;;AAED,oBAAMmC,eAAejN,QAAQH,MAAR,CAAeb,CAAf,CAArB;AACA,oBAAI8L,OAAO7L,MAAP,KAAkB,CAAtB,EAAyB;AACrB,2BAAOgO,aAAa7M,KAAb,CAAmB,qCAAnB,CAAP;AACH;;AAXwC;AAAA;AAAA;;AAAA;AAazC,0CAAoB0K,MAApB,mIAA4B;AAAA,4BAAjBE,KAAiB;;AACxB,4BAAI,OAAOA,KAAP,KAAiB,QAAjB,IAA6B,OAAOA,KAAP,KAAiB,QAAlD,EAA4D;AACxD,mCAAOiC,aAAa7M,KAAb,6CAAP;AACH,yBAFD,MAEO,IAAI,OAAO4K,KAAP,KAAiB,QAAjB,IAA6BjI,KAAKmH,GAAL,CAASc,KAAT,IAAkBjG,OAAOmI,gBAA1D,EAA4E;AAC/E,mCAAOD,aAAa7M,KAAb,oDAAoE2E,OAAOmI,gBAA3E,OAAP;AAEH,yBAHM,MAGA,IAAI,OAAOlC,KAAP,KAAiB,QAAjB,IAA6BjI,KAAKC,KAAL,CAAWgI,KAAX,MAAsBA,KAAvD,EAA8D;AACjE,mCAAOiC,aAAa7M,KAAb,iDAAP;AAEH,yBAHM,MAGA,IAAI,CAACoM,SAAL,EAAgB;AACnBA,wCAAY,oBAAOxB,KAAP,CAAZ;AACH,yBAFM,MAEA,IAAIiC,aAAa3L,YAAb,CAA0BkL,SAA1B,EAAqC,oBAAOxB,KAAP,CAArC,CAAJ,EAAyD;AAC5D,mCAAO,IAAP;AACH;;AAED,4BAAI,OAAOyB,MAAMlE,OAAOyC,KAAP,CAAN,CAAP,KAAgC,WAApC,EAAiD;AAC7C,mCAAOiC,aAAa7M,KAAb,CAAmB,+BAAnB,CAAP;AACH;;AAEDqM,8BAAMlE,OAAOyC,KAAP,CAAN,IAAuBD,QAAQ9L,MAA/B;AACH;AAjCwC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAmCzC,oBAAMV,SAASyB,QAAQe,KAAR,CAAcwB,KAAd,EAAqBvD,CAArB,EAAwBkF,UAAxB,CAAf;AACA,oBAAI,CAAC3F,MAAL,EAAa,OAAO,IAAP;AACb2F,6BAAaA,cAAc3F,OAAOe,IAAlC;AACAyL,wBAAQ/J,IAAR,CAAazC,MAAb;AACH;;AAED,gBAAM+D,QAAQtC,QAAQe,KAAR,CAAcvB,KAAK,CAAL,CAAd,EAAuB,CAAvB,EAA0BgN,SAA1B,CAAd;AACA,gBAAI,CAAClK,KAAL,EAAY,OAAO,IAAP;;AAEZ,gBAAMqB,YAAY3D,QAAQe,KAAR,CAAcvB,KAAKA,KAAKP,MAAL,GAAc,CAAnB,CAAd,EAAqCO,KAAKP,MAAL,GAAc,CAAnD,EAAsDiF,UAAtD,CAAlB;AACA,gBAAI,CAACP,SAAL,EAAgB,OAAO,IAAP;;AAEhB,kCAAO6I,aAAatI,UAApB;AACA,mBAAO,IAAI0C,KAAJ,CAAW4F,SAAX,EAA6BtI,UAA7B,EAA+C5B,KAA/C,EAAsDmK,KAAtD,EAA6D1B,OAA7D,EAAsEpH,SAAtE,CAAP;AACH;;;;;;kBA2DUiD,K;;;;;;;;;;;;;;;;;;;;;;ACvJf;;AAEA;;;;;;;;IAQMC,I;AAOF,kBAAYvH,IAAZ,EAAwBgD,KAAxB,EAA2CuI,KAA3C,EAAyD;AAAA;;AACrD,aAAKvL,IAAL,GAAYA,IAAZ;AACA,aAAKgD,KAAL,GAAaA,KAAb;;AAEA,aAAKwI,MAAL,GAAc,EAAd;AACA,aAAKC,OAAL,GAAe,EAAf;AALqD;AAAA;AAAA;;AAAA;AAMrD,iCAAkCF,KAAlC,8HAAyC;AAAA;;AAAA;;AAAA,oBAA7BG,KAA6B;AAAA,oBAAtBnH,UAAsB;;AACrC,qBAAKiH,MAAL,CAAY9J,IAAZ,CAAiBgK,KAAjB;AACA,qBAAKD,OAAL,CAAa/J,IAAb,CAAkB6C,UAAlB;AACH;AAToD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUxD;;;;iCAiDQnE,G,EAAwB;AAC7B,gBAAMoL,SAAS,KAAKA,MAApB;AACA,gBAAMC,UAAU,KAAKA,OAArB;;AAEA,gBAAID,OAAO7L,MAAP,KAAkB,CAAtB,EAAyB;AACrB,uBAAO8L,QAAQ,CAAR,EAAWxL,QAAX,CAAoBG,GAApB,CAAP;AACH;;AAED,gBAAM6C,QAAU,KAAKD,KAAL,CAAW/C,QAAX,CAAoBG,GAApB,CAAhB;AACA,gBAAI6C,SAASuI,OAAO,CAAP,CAAb,EAAwB;AACpB,uBAAOC,QAAQ,CAAR,EAAWxL,QAAX,CAAoBG,GAApB,CAAP;AACH;;AAED,gBAAMuL,YAAYH,OAAO7L,MAAzB;AACA,gBAAIsD,SAASuI,OAAOG,YAAY,CAAnB,CAAb,EAAoC;AAChC,uBAAOF,QAAQE,YAAY,CAApB,EAAuB1L,QAAvB,CAAgCG,GAAhC,CAAP;AACH;;AAED,gBAAM2D,QAAQ,sCAA0ByH,MAA1B,EAAkCvI,KAAlC,CAAd;AACA,mBAAOwI,QAAQ1H,KAAR,EAAe9D,QAAf,CAAwBG,GAAxB,CAAP;AACH;;;kCAESC,E,EAA0B;AAChCA,eAAG,KAAK2C,KAAR;AADgC;AAAA;AAAA;;AAAA;AAEhC,sCAAyB,KAAKyI,OAA9B,mIAAuC;AAAA,wBAA5BlH,UAA4B;;AACnClE,uBAAGkE,UAAH;AACH;AAJ+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKnC;;;0CAEiB;AAAA;;AACd,mBAAO,aAAGhE,MAAH,iCAAa,KAAKkL,OAAL,CAAavN,GAAb,CAAiB,UAAC+N,MAAD;AAAA,uBAAYA,OAAO9I,eAAP,EAAZ;AAAA,aAAjB,CAAb,EAAP;AACH;;;oCAEW;AACR,gBAAMC,aAAa,CAAC,MAAD,EAAS,KAAKJ,KAAL,CAAWvC,SAAX,EAAT,CAAnB;AACA,iBAAK,IAAIf,IAAI,CAAb,EAAgBA,IAAI,KAAK8L,MAAL,CAAY7L,MAAhC,EAAwCD,GAAxC,EAA6C;AACzC,oBAAIA,IAAI,CAAR,EAAW;AACP0D,+BAAW1B,IAAX,CAAgB,KAAK8J,MAAL,CAAY9L,CAAZ,CAAhB;AACH;AACD0D,2BAAW1B,IAAX,CAAgB,KAAK+J,OAAL,CAAa/L,CAAb,EAAgBe,SAAhB,EAAhB;AACH;AACD,mBAAO2C,UAAP;AACH;;;8BAzFYlD,I,EAAoBQ,O,EAAyB;AAAA,iCAC5BR,IAD4B;AAAA,gBAC9C8C,KAD8C;AAAA,gBACpCwJ,IADoC;;AAGtD,gBAAItM,KAAKP,MAAL,GAAc,CAAd,GAAkB,CAAtB,EAAyB;AACrB,uBAAOe,QAAQI,KAAR,qDAA+DZ,KAAKP,MAAL,GAAc,CAA7E,QAAP;AACH;;AAED,gBAAI,CAACO,KAAKP,MAAL,GAAc,CAAf,IAAoB,CAApB,KAA0B,CAA9B,EAAiC;AAC7B,uBAAOe,QAAQI,KAAR,yCAAP;AACH;;AAEDkC,oBAAQtC,QAAQe,KAAR,CAAcuB,KAAd,EAAqB,CAArB,EAAwBJ,iBAAxB,CAAR;AACA,gBAAI,CAACI,KAAL,EAAY,OAAO,IAAP;;AAEZ,gBAAMuI,QAAe,EAArB;;AAEA,gBAAI3G,aAAoB,IAAxB;AACA,gBAAIlE,QAAQuD,YAAR,IAAwBvD,QAAQuD,YAAR,CAAqBX,IAArB,KAA8B,OAA1D,EAAmE;AAC/DsB,6BAAalE,QAAQuD,YAArB;AACH;;AAEDuI,iBAAKqB,OAAL,CAAa,CAACC,QAAd;;AAEA,iBAAK,IAAIpO,IAAI,CAAb,EAAgBA,IAAI8M,KAAK7M,MAAzB,EAAiCD,KAAK,CAAtC,EAAyC;AACrC,oBAAMgM,QAAQc,KAAK9M,CAAL,CAAd;AACA,oBAAMuD,QAAQuJ,KAAK9M,IAAI,CAAT,CAAd;;AAEA,oBAAM+M,WAAW/M,IAAI,CAArB;AACA,oBAAMgN,WAAWhN,IAAI,CAArB;;AAEA,oBAAI,OAAOgM,KAAP,KAAiB,QAArB,EAA+B;AAC3B,2BAAOhL,QAAQI,KAAR,CAAc,yIAAd,EAAyJ2L,QAAzJ,CAAP;AACH;;AAED,oBAAIlB,MAAM5L,MAAN,IAAgB4L,MAAMA,MAAM5L,MAAN,GAAe,CAArB,EAAwB,CAAxB,KAA8B+L,KAAlD,EAAyD;AACrD,2BAAOhL,QAAQI,KAAR,CAAc,2GAAd,EAA2H2L,QAA3H,CAAP;AACH;;AAED,oBAAMjL,SAASd,QAAQe,KAAR,CAAcwB,KAAd,EAAqByJ,QAArB,EAA+B9H,UAA/B,CAAf;AACA,oBAAI,CAACpD,MAAL,EAAa,OAAO,IAAP;AACboD,6BAAaA,cAAcpD,OAAOxB,IAAlC;AACAuL,sBAAM7J,IAAN,CAAW,CAACgK,KAAD,EAAQlK,MAAR,CAAX;AACH;;AAED,mBAAO,IAAI+F,IAAJ,CAAS3C,UAAT,EAAqB5B,KAArB,EAA4BuI,KAA5B,CAAP;AACH;;;;;;kBA+CUhE,I;;;;;;;;;;;;;;;;;;;;;;ICpHTC,G;AAKF,iBAAYzH,IAAZ,EAA0BgO,eAA1B,EAAuD;AAAA;;AACnD,aAAK/N,IAAL,GAAY+N,gBAAgB/N,IAA5B;AACA,aAAKD,IAAL,GAAYA,IAAZ;AACA,aAAKgO,eAAL,GAAuBA,eAAvB;AACH;;;;iCAcQ3N,G,EAAwB;AAC7B,mBAAO,KAAK2N,eAAL,CAAqB9N,QAArB,CAA8BG,GAA9B,CAAP;AACH;;;oCAEW,CAAE;;;0CAEI;AACd,mBAAO,CAACE,SAAD,CAAP;AACH;;;oCAEW;AACR,mBAAO,CAAC,KAAD,EAAQ,KAAKP,IAAb,CAAP;AACH;;;8BAxBYG,I,EAAoBQ,O,EAAyB;AACtD,gBAAIR,KAAKP,MAAL,KAAgB,CAAhB,IAAqB,OAAOO,KAAK,CAAL,CAAP,KAAmB,QAA5C,EACI,OAAOQ,QAAQI,KAAR,oEAAP;;AAEJ,gBAAMf,OAAOG,KAAK,CAAL,CAAb;AACA,gBAAI,CAACQ,QAAQqB,KAAR,CAAc+F,GAAd,CAAkB/H,IAAlB,CAAL,EAA8B;AAC1B,uBAAOW,QAAQI,KAAR,wBAAmCf,IAAnC,sBAAwDA,IAAxD,yEAAkI,CAAlI,CAAP;AACH;;AAED,mBAAO,IAAIyH,GAAJ,CAAQzH,IAAR,EAAcW,QAAQqB,KAAR,CAAckG,GAAd,CAAkBlI,IAAlB,CAAd,CAAP;AACH;;;;;;kBAiBUyH,G;;;;;;;;;;;;;;;;;;;;AC3Cf;;;;AAIA,IAAMwG,gBAAgB,CAAC,SAAD,EAAY,OAAZ,EAAqB,YAArB,EAAmC,SAAnC,CAAtB;;IAEMC,iB;AAMF,iCAAc;AAAA;;AACV,aAAKC,gBAAL,GAAwB,EAAxB;AACH;;;;6BAEI;AACD,mBAAO,KAAKC,OAAL,IAAgB,QAAQ,KAAKA,OAA7B,GAAuC,KAAKA,OAAL,CAAavO,EAApD,GAAyD,IAAhE;AACH;;;uCAEc;AACX,mBAAO,KAAKuO,OAAL,GAAe,OAAO,KAAKA,OAAL,CAAanO,IAApB,KAA6B,QAA7B,GAAwCgO,cAAc,KAAKG,OAAL,CAAanO,IAA3B,CAAxC,GAA2E,KAAKmO,OAAL,CAAanO,IAAvG,GAA8G,IAArH;AACH;;;qCAEY;AACT,mBAAO,KAAKmO,OAAL,IAAgB,KAAKA,OAAL,CAAa/E,UAA7B,IAA2C,EAAlD;AACH;;;mCAEUpG,K,EAAuB;AAC9B,gBAAIoL,SAAS,KAAKF,gBAAL,CAAsBlL,KAAtB,CAAb;AACA,gBAAI,CAACoL,MAAL,EAAa;AACTA,yBAAS,KAAKF,gBAAL,CAAsBlL,KAAtB,IAA+BuC,cAAM9D,KAAN,CAAYuB,KAAZ,CAAxC;AACH;AACD,mBAAOoL,MAAP;AACH;;;;;;kBAGUH,iB;;;;;;;;;;;;;;;;;;;;;QCwDCI,Y,GAAAA,Y;QAcAC,gB,GAAAA,gB;QA4FAC,wB,GAAAA,wB;QAsEAC,2B,GAAAA,2B;;AA7QhB;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;IAAYC,U;;AACZ;;;;AACA;;AA+NA;;AACA;;AAgGA;;;;;;;;IA1SaC,e,WAAAA,e;AAQT,6BAAYnK,UAAZ,EAAoCoK,YAApC,EAA8E;AAAA;;AAC1E,aAAKpK,UAAL,GAAkBA,UAAlB;AACA,aAAKqK,eAAL,GAAuB,EAAvB;AACA,aAAKC,aAAL,GAAqBC,gBAAgBH,YAAhB,CAArB;AACA,YAAIA,aAAa3O,IAAb,KAAsB,MAA1B,EAAkC;AAC9B,iBAAK+O,WAAL,GAAmBJ,aAAaK,MAAhC;AACH;AACJ;;;;qDAE4B1F,O,EAA2B6E,O,EAAwB;AAC5E,gBAAI,CAAC,KAAKc,UAAV,EAAsB;AAClB,qBAAKA,UAAL,GAAkB,IAAIhB,4BAAJ,EAAlB;AACH;;AAED,iBAAKgB,UAAL,CAAgB3F,OAAhB,GAA0BA,OAA1B;AACA,iBAAK2F,UAAL,CAAgBd,OAAhB,GAA0BA,OAA1B;;AAEA,mBAAO,KAAK5J,UAAL,CAAgBtE,QAAhB,CAAyB,KAAKgP,UAA9B,CAAP;AACH;;;iCAEQ3F,O,EAA2B6E,O,EAAwB;AACxD,gBAAI,CAAC,KAAKc,UAAV,EAAsB;AAClB,qBAAKA,UAAL,GAAkB,IAAIhB,4BAAJ,EAAlB;AACH;;AAED,iBAAKgB,UAAL,CAAgB3F,OAAhB,GAA0BA,OAA1B;AACA,iBAAK2F,UAAL,CAAgBd,OAAhB,GAA0BA,OAA1B;;AAEA,gBAAI;AACA,oBAAMe,MAAM,KAAK3K,UAAL,CAAgBtE,QAAhB,CAAyB,KAAKgP,UAA9B,CAAZ;AACA,oBAAIC,QAAQ,IAAR,IAAgBA,QAAQ5O,SAA5B,EAAuC;AACnC,2BAAO,KAAKuO,aAAZ;AACH;AACD,oBAAI,KAAKE,WAAL,IAAoB,EAAEG,OAAO,KAAKH,WAAd,CAAxB,EAAoD;AAChD,0BAAM,IAAI7L,uBAAJ,kCAAgD1D,OAAO6N,IAAP,CAAY,KAAK0B,WAAjB,EAA8B7Q,GAA9B,CAAkC;AAAA,+BAAKmH,KAAKC,SAAL,CAAe4C,CAAf,CAAL;AAAA,qBAAlC,EAA0D7F,IAA1D,CAA+D,IAA/D,CAAhD,oBAAmIgD,KAAKC,SAAL,CAAe4J,GAAf,CAAnI,eAAN;AACH;AACD,uBAAOA,GAAP;AACH,aATD,CASE,OAAOtF,CAAP,EAAU;AACR,oBAAI,CAAC,KAAKgF,eAAL,CAAqBhF,EAAEuF,OAAvB,CAAL,EAAsC;AAClC,yBAAKP,eAAL,CAAqBhF,EAAEuF,OAAvB,IAAkC,IAAlC;AACA,wBAAI,OAAOC,OAAP,KAAmB,WAAvB,EAAoC;AAChCA,gCAAQC,IAAR,CAAazF,EAAEuF,OAAf;AACH;AACJ;AACD,uBAAO,KAAKN,aAAZ;AACH;AACJ;;;;;;AAGE,SAASR,YAAT,CAAsB9J,UAAtB,EAAyC;AAC5C,WAAOxD,MAAMC,OAAN,CAAcuD,UAAd,KAA6BA,WAAW5E,MAAX,GAAoB,CAAjD,IACH,OAAO4E,WAAW,CAAX,CAAP,KAAyB,QADtB,IACkCA,WAAW,CAAX,KAAiB1D,qBAD1D;AAEH;;AAED;;;;;;;;;AASO,SAASyN,gBAAT,CAA0B/J,UAA1B,EAA6CoK,YAA7C,EAAqI;AACxI,QAAMW,SAAS,IAAI1N,yBAAJ,CAAmBf,qBAAnB,EAAgC,EAAhC,EAAoC0O,gBAAgBZ,YAAhB,CAApC,CAAf;AACA,QAAMnN,SAAS8N,OAAO7N,KAAP,CAAa8C,UAAb,CAAf;AACA,QAAI,CAAC/C,MAAL,EAAa;AACT,8BAAO8N,OAAOrN,MAAP,CAActC,MAAd,GAAuB,CAA9B;AACA,eAAO,mBAAM2P,OAAOrN,MAAb,CAAP;AACH;;AAED,WAAO,qBAAQ,IAAIyM,eAAJ,CAAoBlN,MAApB,EAA4BmN,YAA5B,CAAR,CAAP;AACH;;IAEYa,sB,WAAAA,sB;AAIT,oCAAYlM,IAAZ,EAAwBiB,UAAxB,EAAqD;AAAA;;AACjD,aAAKjB,IAAL,GAAYA,IAAZ;AACA,aAAKmM,gBAAL,GAAwBlL,UAAxB;AACH;;;;qDAE4B+E,O,EAA2B6E,O,EAAwB;AAC5E,mBAAO,KAAKsB,gBAAL,CAAsBC,4BAAtB,CAAmDpG,OAAnD,EAA4D6E,OAA5D,CAAP;AACH;;;iCAEQ7E,O,EAA2B6E,O,EAAwB;AACxD,mBAAO,KAAKsB,gBAAL,CAAsBxP,QAAtB,CAA+BqJ,OAA/B,EAAwC6E,OAAxC,CAAP;AACH;;;;;;IAGQwB,uB,WAAAA,uB;AAOT,qCAAYrM,IAAZ,EAAwBiB,UAAxB,EAAqDqL,SAArD,EAAoF;AAAA;;AAChF,aAAKtM,IAAL,GAAYA,IAAZ;AACA,aAAKuM,SAAL,GAAiBD,UAAUpE,MAA3B;AACA,aAAKiE,gBAAL,GAAwBlL,UAAxB;AACA,YAAIqL,qBAAqB1I,qBAAzB,EAAsC;AAClC,iBAAK4I,kBAAL,GAA0BF,UAAUtE,aAApC;AACH;AACJ;;;;qDAE4BhC,O,EAA2B6E,O,EAAwB;AAC5E,mBAAO,KAAKsB,gBAAL,CAAsBC,4BAAtB,CAAmDpG,OAAnD,EAA4D6E,OAA5D,CAAP;AACH;;;iCAEQ7E,O,EAA2B6E,O,EAAwB;AACxD,mBAAO,KAAKsB,gBAAL,CAAsBxP,QAAtB,CAA+BqJ,OAA/B,EAAwC6E,OAAxC,CAAP;AACH;;;4CAEmBnL,K,EAAe4I,K,EAAeC,K,EAAuB;AACrE,gBAAI,KAAKiE,kBAAT,EAA6B;AACzB,uBAAO5I,sBAAY4E,mBAAZ,CAAgC,KAAKgE,kBAArC,EAAyD9M,KAAzD,EAAgE4I,KAAhE,EAAuEC,KAAvE,CAAP;AACH,aAFD,MAEO;AACH,uBAAO,CAAP;AACH;AACJ;;;;;;AAiCE,SAAS0C,wBAAT,CAAkChK,UAAlC,EAAqDoK,YAArD,EAAqJ;AACxJpK,iBAAa+J,iBAAiB/J,UAAjB,EAA6BoK,YAA7B,CAAb;AACA,QAAIpK,WAAWtF,MAAX,KAAsB,OAA1B,EAAmC;AAC/B,eAAOsF,UAAP;AACH;;AAED,QAAM/C,SAAS+C,WAAWtB,KAAX,CAAiBsB,UAAhC;;AAEA,QAAMwL,oBAAoBtB,WAAWsB,iBAAX,CAA6BvO,MAA7B,CAA1B;AACA,QAAI,CAACuO,iBAAD,IAAsB,CAACpB,aAAa,mBAAb,CAA3B,EAA8D;AAC1D,eAAO,mBAAM,CAAC,IAAIqB,uBAAJ,CAAiB,EAAjB,EAAqB,oCAArB,CAAD,CAAN,CAAP;AACH;;AAED,QAAMC,iBAAiBxB,WAAWyB,wBAAX,CAAoC1O,MAApC,EAA4C,CAAC,MAAD,CAA5C,CAAvB;AACA,QAAI,CAACyO,cAAD,IAAmBtB,aAAa,eAAb,MAAkC,KAAzD,EAAgE;AAC5D,eAAO,mBAAM,CAAC,IAAIqB,uBAAJ,CAAiB,EAAjB,EAAqB,gCAArB,CAAD,CAAN,CAAP;AACH;;AAED,QAAMJ,YAAYO,cAAc3O,MAAd,CAAlB;AACA,QAAI,CAACoO,SAAD,IAAc,CAACK,cAAnB,EAAmC;AAC/B,eAAO,mBAAM,CAAC,IAAID,uBAAJ,CAAiB,EAAjB,EAAqB,gGAArB,CAAD,CAAN,CAAP;AACH,KAFD,MAEO,IAAIJ,qBAAqBI,uBAAzB,EAAuC;AAC1C,eAAO,mBAAM,CAACJ,SAAD,CAAN,CAAP;AACH,KAFM,MAEA,IAAIA,qBAAqB1I,qBAArB,IAAoCyH,aAAa,UAAb,MAA6B,oBAArE,EAA2F;AAC9F,eAAO,mBAAM,CAAC,IAAIqB,uBAAJ,CAAiB,EAAjB,EAAqB,6DAArB,CAAD,CAAN,CAAP;AACH;;AAED,QAAI,CAACJ,SAAL,EAAgB;AACZ,eAAO,qBAAQG,oBACV,IAAIP,sBAAJ,CAA2B,UAA3B,EAAuCjL,WAAWtB,KAAlD,CADU,GAEV,IAAIuM,sBAAJ,CAA2B,QAA3B,EAAqCjL,WAAWtB,KAAhD,CAFE,CAAP;AAGH;;AAED,WAAO,qBAAQ8M,oBACV,IAAIJ,uBAAJ,CAA4B,QAA5B,EAAsCpL,WAAWtB,KAAjD,EAAwD2M,SAAxD,CADU,GAEV,IAAID,uBAAJ,CAA4B,WAA5B,EAAyCpL,WAAWtB,KAApD,EAA2D2M,SAA3D,CAFE,CAAP;AAGH;;AAKD;AACA;IACaQ,qB,WAAAA,qB;AAST,mCAAYC,UAAZ,EAAuDC,aAAvD,EAAkG;AAAA;;AAC9F,aAAKC,WAAL,GAAmBF,UAAnB;AACA,aAAKG,cAAL,GAAsBF,aAAtB;AACA,8BAAO,IAAP,EAAa,8BAAe,KAAKC,WAApB,EAAiC,KAAKC,cAAtC,CAAb;AACH;;;;oCAEkBpN,U,EAAsG;AACrH,mBAAS,IAAIgN,qBAAJ,CAA0BhN,WAAWmN,WAArC,EAAkDnN,WAAWoN,cAA7D,CAAT;AACH;;;kCAEgBxN,K,EAAiC;AAC9C,mBAAO;AACHuN,6BAAavN,MAAMuN,WADhB;AAEHC,gCAAgBxN,MAAMwN;AAFnB,aAAP;AAIH;;;;;;AAGE,SAAShC,2BAAT,CAAwCvL,KAAxC,EAA8EqN,aAA9E,EAAkJ;AACrJ,QAAI,0BAAWrN,KAAX,CAAJ,EAAuB;AACnB,eAAQ,IAAImN,qBAAJ,CAA0BnN,KAA1B,EAAiCqN,aAAjC,CAAR;AAEH,KAHD,MAGO,IAAIjC,aAAapL,KAAb,CAAJ,EAAyB;AAC5B,YAAMsB,aAAagK,yBAAyBtL,KAAzB,EAAgCqN,aAAhC,CAAnB;AACA,YAAI/L,WAAWtF,MAAX,KAAsB,OAA1B,EAAmC;AAC/B;AACA,kBAAM,IAAIwR,KAAJ,CAAUlM,WAAWtB,KAAX,CAAiB/E,GAAjB,CAAqB;AAAA,uBAAUwS,IAAI3I,GAAd,UAAsB2I,IAAIvB,OAA1B;AAAA,aAArB,EAA0D9M,IAA1D,CAA+D,IAA/D,CAAV,CAAN;AACH;AACD,eAAOkC,WAAWtB,KAAlB;AAEH,KARM,MAQA;AACH,YAAI0N,WAAgB1N,KAApB;AACA,YAAI,OAAOA,KAAP,KAAiB,QAAjB,IAA6BqN,cAActQ,IAAd,KAAuB,OAAxD,EAAiE;AAC7D2Q,uBAAWpL,cAAM9D,KAAN,CAAYwB,KAAZ,CAAX;AACH;AACD,eAAO;AACHK,kBAAM,UADH;AAEHrD,sBAAU;AAAA,uBAAM0Q,QAAN;AAAA;AAFP,SAAP;AAIH;AACJ;;AAED;AACA;AACA;AACA,SAASR,aAAT,CAAuB5L,UAAvB,EAAyF;AACrF,QAAItF,SAAS,IAAb;AACA,QAAIsF,sBAAsB6C,aAA1B,EAA+B;AAC3BnI,iBAASkR,cAAc5L,WAAWtF,MAAzB,CAAT;AAEH,KAHD,MAGO,IAAIsF,sBAAsBM,kBAA1B,EAAoC;AAAA;AAAA;AAAA;;AAAA;AACvC,iCAAkBN,WAAWrE,IAA7B,8HAAmC;AAAA,oBAAxBM,GAAwB;;AAC/BvB,yBAASkR,cAAc3P,GAAd,CAAT;AACA,oBAAIvB,MAAJ,EAAY;AACR;AACH;AACJ;AANsC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQ1C,KARM,MAQA,IAAI,CAACsF,sBAAsBgD,cAAtB,IAA8BhD,sBAAsB2C,qBAArD,KACP3C,WAAWvB,KAAX,YAA4BlD,6BADrB,IAEPyE,WAAWvB,KAAX,CAAiBjD,IAAjB,KAA0B,MAFvB,EAE+B;;AAElCd,iBAASsF,UAAT;AACH;;AAED,QAAItF,kBAAkB+Q,uBAAtB,EAAoC;AAChC,eAAO/Q,MAAP;AACH;;AAEDsF,eAAWG,SAAX,CAAqB,UAACC,KAAD,EAAW;AAC5B,YAAMiM,cAAcT,cAAcxL,KAAd,CAApB;AACA,YAAIiM,uBAAuBZ,uBAA3B,EAAyC;AACrC/Q,qBAAS2R,WAAT;AACH,SAFD,MAEO,IAAI,CAAC3R,MAAD,IAAW2R,WAAf,EAA4B;AAC/B3R,qBAAS,IAAI+Q,uBAAJ,CAAiB,EAAjB,EAAqB,gGAArB,CAAT;AACH,SAFM,MAEA,IAAI/Q,UAAU2R,WAAV,IAAyB3R,WAAW2R,WAAxC,EAAqD;AACxD3R,qBAAS,IAAI+Q,uBAAJ,CAAiB,EAAjB,EAAqB,yFAArB,CAAT;AACH;AACJ,KATD;;AAWA,WAAO/Q,MAAP;AACH;;AAID,SAASsQ,eAAT,CAAyBsB,IAAzB,EAAwE;AACpE,QAAMrO,QAAQ;AACVsO,eAAO7L,gBADG;AAEVxC,gBAAQC,iBAFE;AAGVC,gBAAQC,iBAHE;AAIVmO,cAAMrO,iBAJI;AAKVG,iBAASC;AALC,KAAd;;AAQA,QAAI+N,KAAK7Q,IAAL,KAAc,OAAlB,EAA2B;AACvB,eAAO,kBAAMwC,MAAMqO,KAAK5N,KAAX,KAAqBO,gBAA3B,EAAsCqN,KAAKlR,MAA3C,CAAP;AACH;;AAED,WAAO6C,MAAMqO,KAAK7Q,IAAX,KAAoB,IAA3B;AACH;;AAED,SAAS8O,eAAT,CAAyB+B,IAAzB,EAAkE;AAC9D,QAAIA,KAAK7Q,IAAL,KAAc,OAAd,IAAyB,0BAAW6Q,KAAKG,OAAhB,CAA7B,EAAuD;AACnD;AACA;AACA;AACA,eAAO,IAAIzL,aAAJ,CAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,CAAP;AACH,KALD,MAKO,IAAIsL,KAAK7Q,IAAL,KAAc,OAAlB,EAA2B;AAC9B,eAAOuF,cAAM9D,KAAN,CAAYoP,KAAKG,OAAjB,KAA6B,IAApC;AACH,KAFM,MAEA,IAAIH,KAAKG,OAAL,KAAiB1Q,SAArB,EAAgC;AACnC,eAAO,IAAP;AACH,KAFM,MAEA;AACH,eAAOuQ,KAAKG,OAAZ;AACH;AACJ,C;;;;;;;;;;;;;;;;;;;AC7WD;;;;;;AAIA,SAASjB,iBAAT,CAA2BnG,CAA3B,EAA0C;AACtC,QAAIA,aAAa9J,6BAAjB,EAAqC;AACjC,YAAI8J,EAAE7J,IAAF,KAAW,KAAX,IAAoB6J,EAAE1J,IAAF,CAAOP,MAAP,KAAkB,CAA1C,EAA6C;AACzC,mBAAO,KAAP;AACH,SAFD,MAEO,IAAIiK,EAAE7J,IAAF,KAAW,KAAX,IAAoB6J,EAAE1J,IAAF,CAAOP,MAAP,KAAkB,CAA1C,EAA6C;AAChD,mBAAO,KAAP;AACH,SAFM,MAEA,IACHiK,EAAE7J,IAAF,KAAW,YAAX,IACA6J,EAAE7J,IAAF,KAAW,eADX,IAEA6J,EAAE7J,IAAF,KAAW,IAHR,EAIL;AACE,mBAAO,KAAP;AACH,SANM,MAMA,IAAI,WAAWuE,IAAX,CAAgBsF,EAAE7J,IAAlB,CAAJ,EAA6B;AAChC,mBAAO,KAAP;AACH;AACJ;;AAED,QAAId,SAAS,IAAb;AACA2K,MAAElF,SAAF,CAAY,eAAO;AACf,YAAIzF,UAAU,CAAC8Q,kBAAkBvP,GAAlB,CAAf,EAAuC;AAAEvB,qBAAS,KAAT;AAAiB;AAC7D,KAFD;AAGA,WAAOA,MAAP;AACH;;AAED,SAASiR,wBAAT,CAAkCtG,CAAlC,EAAiDR,UAAjD,EAA4E;AACxE,QAAIQ,aAAa9J,6BAAb,IAAmCsJ,WAAW2B,OAAX,CAAmBnB,EAAE7J,IAArB,KAA8B,CAArE,EAAwE;AAAE,eAAO,KAAP;AAAe;AACzF,QAAId,SAAS,IAAb;AACA2K,MAAElF,SAAF,CAAY,UAAClE,GAAD,EAAS;AACjB,YAAIvB,UAAU,CAACiR,yBAAyB1P,GAAzB,EAA8B4I,UAA9B,CAAf,EAA0D;AAAEnK,qBAAS,KAAT;AAAiB;AAChF,KAFD;AAGA,WAAOA,MAAP;AACH;;QAEQ8Q,iB,GAAAA,iB;QAAmBG,wB,GAAAA,wB;;;;;;;;;;;;;;;;;;;;;;ACrC5B;;;;AAEA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;;;;;AAMA;;;;IAIMtO,c;AAaF,4BACIC,QADJ,EAME;AAAA,YAJEC,IAIF,uEAJwB,EAIxB;AAAA,YAHEmC,YAGF;AAAA,YAFElC,KAEF,uEAFiB,IAAIkP,eAAJ,EAEjB;AAAA,YADEhP,MACF,uEADgC,EAChC;;AAAA;;AACE,aAAKJ,QAAL,GAAgBA,QAAhB;AACA,aAAKC,IAAL,GAAYA,IAAZ;AACA,aAAKiG,GAAL,GAAWjG,KAAK5D,GAAL,CAAS;AAAA,yBAAYgT,IAAZ;AAAA,SAAT,EAA8B7O,IAA9B,CAAmC,EAAnC,CAAX;AACA,aAAKN,KAAL,GAAaA,KAAb;AACA,aAAKE,MAAL,GAAcA,MAAd;AACA,aAAKgC,YAAL,GAAoBA,YAApB;AACH;;AAED;;;;;;;;;AArBA;AACA;AACA;AACA;;;;;8BA0BIgJ,I,EACAlJ,K,EACAE,Y,EACA8I,Q,EAEW;AAAA,gBADXtG,OACW,uEADgC,EAChC;;AACX,gBAAI1C,KAAJ,EAAW;AACP,uBAAO,KAAKxD,MAAL,CAAYwD,KAAZ,EAAmBE,YAAnB,EAAiC8I,QAAjC,EAA2CoE,MAA3C,CAAkDlE,IAAlD,EAAwDxG,OAAxD,CAAP;AACH;AACD,mBAAO,KAAK0K,MAAL,CAAYlE,IAAZ,EAAkBxG,OAAlB,CAAP;AACH;;;+BAEMwG,I,EAAaxG,O,EAAuD;;AAEvE,gBAAIwG,SAAS,IAAT,IAAiB,OAAOA,IAAP,KAAgB,QAAjC,IAA6C,OAAOA,IAAP,KAAgB,SAA7D,IAA0E,OAAOA,IAAP,KAAgB,QAA9F,EAAwG;AACpGA,uBAAO,CAAC,SAAD,EAAYA,IAAZ,CAAP;AACH;;AAED,gBAAIlM,MAAMC,OAAN,CAAciM,IAAd,CAAJ,EAAyB;AACrB,oBAAIA,KAAKtN,MAAL,KAAgB,CAApB,EAAuB;AACnB,2BAAO,KAAKmB,KAAL,oGAAP;AACH;;AAED,oBAAMH,KAAKsM,KAAK,CAAL,CAAX;AACA,oBAAI,OAAOtM,EAAP,KAAc,QAAlB,EAA4B;AACxB,yBAAKG,KAAL,0DAAiEH,EAAjE,yCAAiEA,EAAjE,yEAAuI,CAAvI;AACA,2BAAO,IAAP;AACH;;AAED,oBAAMyQ,OAAO,KAAKvP,QAAL,CAAclB,EAAd,CAAb;AACA,oBAAIyQ,IAAJ,EAAU;AACN,wBAAI5P,SAAS4P,KAAK3P,KAAL,CAAWwL,IAAX,EAAiB,IAAjB,CAAb;AACA,wBAAI,CAACzL,MAAL,EAAa,OAAO,IAAP;;AAEb,wBAAI,KAAKyC,YAAT,EAAuB;AACnB,4BAAM3C,WAAW,KAAK2C,YAAtB;AACA,4BAAMoN,SAAS7P,OAAOxB,IAAtB;;AAEA;AACA;AACA;AACA;AACA;AACA,4BAAI,CAACsB,SAASgC,IAAT,KAAkB,QAAlB,IAA8BhC,SAASgC,IAAT,KAAkB,QAAhD,IAA4DhC,SAASgC,IAAT,KAAkB,SAA9E,IAA2FhC,SAASgC,IAAT,KAAkB,QAA9G,KAA2H+N,OAAO/N,IAAP,KAAgB,OAA/I,EAAwJ;AACpJ,gCAAI,CAACmD,QAAQ3B,mBAAb,EAAkC;AAC9BtD,yCAAS,IAAIqC,mBAAJ,CAAcvC,QAAd,EAAwB,CAACE,MAAD,CAAxB,CAAT;AACH;AACJ,yBAJD,MAIO,IAAIF,SAASgC,IAAT,KAAkB,OAAlB,IAA6B+N,OAAO/N,IAAP,KAAgB,OAAjD,EAA0D;AAC7D,gCAAI,CAACmD,QAAQ3B,mBAAb,EAAkC;AAC9BtD,yCAAS,IAAIuB,eAAJ,CAAmBzB,QAAnB,EAA6BE,MAA7B,CAAT;AACH;AACJ,yBAJM,MAIA,IAAIF,SAASgC,IAAT,KAAkB,OAAlB,KAA8B+N,OAAO/N,IAAP,KAAgB,OAAhB,IAA2B+N,OAAO/N,IAAP,KAAgB,QAAzE,CAAJ,EAAwF;AAC3F,gCAAI,CAACmD,QAAQ3B,mBAAb,EAAkC;AAC9BtD,yCAAS,IAAI0D,kBAAJ,CAAa5D,QAAb,EAAuB,CAACE,MAAD,CAAvB,CAAT;AACH;AACJ,yBAJM,MAIA,IAAI,KAAKQ,YAAL,CAAkB,KAAKiC,YAAvB,EAAqCzC,OAAOxB,IAA5C,CAAJ,EAAuD;AAC1D,mCAAO,IAAP;AACH;AACJ;;AAED;AACA;AACA;AACA,wBAAI,EAAEwB,kBAAkB6F,iBAApB,KAAgCoH,WAAWjN,MAAX,CAApC,EAAwD;AACpD,4BAAM8P,KAAK,IAAIrD,4BAAJ,EAAX;AACA,4BAAI;AACAzM,qCAAS,IAAI6F,iBAAJ,CAAY7F,OAAOxB,IAAnB,EAAyBwB,OAAOvB,QAAP,CAAgBqR,EAAhB,CAAzB,CAAT;AACH,yBAFD,CAEE,OAAO1H,CAAP,EAAU;AACR,iCAAK9I,KAAL,CAAW8I,EAAEuF,OAAb;AACA,mCAAO,IAAP;AACH;AACJ;;AAED,2BAAO3N,MAAP;AACH;;AAED,uBAAO,KAAKV,KAAL,0BAAkCH,EAAlC,gEAAiG,CAAjG,CAAP;AACH,aA3DD,MA2DO,IAAI,OAAOsM,IAAP,KAAgB,WAApB,EAAiC;AACpC,uBAAO,KAAKnM,KAAL,kDAAP;AACH,aAFM,MAEA,IAAI,QAAOmM,IAAP,yCAAOA,IAAP,OAAgB,QAApB,EAA8B;AACjC,uBAAO,KAAKnM,KAAL,yDAAP;AACH,aAFM,MAEA;AACH,uBAAO,KAAKA,KAAL,2CAAkDmM,IAAlD,yCAAkDA,IAAlD,iBAAP;AACH;AACJ;;AAED;;;;;;;;;;;+BAQOlJ,K,EAAeE,Y,EAAsB8I,Q,EAAwC;AAChF,gBAAMjL,OAAO,OAAOiC,KAAP,KAAiB,QAAjB,GAA4B,KAAKjC,IAAL,CAAUvB,MAAV,CAAiBwD,KAAjB,CAA5B,GAAsD,KAAKjC,IAAxE;AACA,gBAAMC,QAAQgL,WAAW,KAAKhL,KAAL,CAAWxB,MAAX,CAAkBwM,QAAlB,CAAX,GAAyC,KAAKhL,KAA5D;AACA,mBAAO,IAAIH,cAAJ,CACH,KAAKC,QADF,EAEHC,IAFG,EAGHmC,gBAAgB,IAHb,EAIHlC,KAJG,EAKH,KAAKE,MALF,CAAP;AAOH;;AAED;;;;;;;;;;8BAOMnB,M,EAAuC;AAAA,8CAArBuM,IAAqB;AAArBA,oBAAqB;AAAA;;AACzC,gBAAMtF,WAAS,KAAKA,GAAd,GAAoBsF,KAAKnP,GAAL,CAAS;AAAA,6BAASgB,CAAT;AAAA,aAAT,EAAwBmD,IAAxB,CAA6B,EAA7B,CAA1B;AACA,iBAAKJ,MAAL,CAAYP,IAAZ,CAAiB,IAAIsO,uBAAJ,CAAiBjI,GAAjB,EAAsBjH,MAAtB,CAAjB;AACH;;AAED;;;;;;;qCAIaQ,Q,EAAgB4C,C,EAAkB;AAC3C,gBAAMpD,QAAQ,yBAAaQ,QAAb,EAAuB4C,CAAvB,CAAd;AACA,gBAAIpD,KAAJ,EAAW,KAAKA,KAAL,CAAWA,KAAX;AACX,mBAAOA,KAAP;AACH;;;;;;kBAGUc,c;;;AAEf,SAAS6M,UAAT,CAAoBlK,UAApB,EAA4C;AACxC,QAAIA,sBAAsBiD,aAA1B,EAA+B;AAC3B,eAAOiH,WAAWlK,WAAWwJ,eAAtB,CAAP;AACH,KAFD,MAEO,IAAIxJ,sBAAsBzE,6BAAtB,IAA4CyE,WAAWxE,IAAX,KAAoB,OAApE,EAA6E;AAChF,eAAO,KAAP;AACH,KAFM,MAEA,IAAIwE,sBAAsBgC,4BAA1B,EAA8C;AACjD;AACA;AACA;AACA,eAAO,KAAP;AACH;;AAED,QAAMgL,mBAAmBhN,sBAAsBW,kBAAtB,IACrBX,sBAAsBV,mBADD,IAErBU,sBAAsBxB,eAF1B;;AAIA,QAAIyO,mBAAmB,IAAvB;AACAjN,eAAWG,SAAX,CAAqB,iBAAS;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAI6M,gBAAJ,EAAsB;AAClBC,+BAAmBA,oBAAoB/C,WAAW9J,KAAX,CAAvC;AACH,SAFD,MAEO;AACH6M,+BAAmBA,oBAAoB7M,iBAAiB0C,iBAAxD;AACH;AACJ,KAbD;AAcA,QAAI,CAACmK,gBAAL,EAAuB;AACnB,eAAO,KAAP;AACH;;AAED,WAAO,oCAAkBjN,UAAlB,KACH,2CAAyBA,UAAzB,EAAqC,CAAC,MAAD,EAAS,iBAAT,EAA4B,eAA5B,EAA6C,qBAA7C,CAArC,CADJ;AAEH,C;;;;;;;;;;;;;;;;;;;;;;;;IClOKyL,Y;;;AAGF,0BAAYjI,GAAZ,EAAyBoH,OAAzB,EAA0C;AAAA;;AAAA,gIAChCA,OADgC;;AAEtC,cAAKA,OAAL,GAAeA,OAAf;AACA,cAAKpH,GAAL,GAAWA,GAAX;AAHsC;AAIzC;;;EAPsB0I,K;;kBAUZT,Y;;;;;;;;;;;;;;;;;;;;;;ICVT9M,Y;AAIF,0BAAYiM,OAAZ,EAA6B;AAAA;;AACzB,aAAKpP,IAAL,GAAY,2BAAZ;AACA,aAAKoP,OAAL,GAAeA,OAAf;AACH;;;;iCAEQ;AACL,mBAAO,KAAKA,OAAZ;AACH;;;;;;kBAGUjM,Y;;;;;;;;;;;;;;;;;;;;;;;;ACZf;;;;IAIM+N,K;AAGF,mBAAYjS,MAAZ,EAAwE;AAAA,YAA5C+N,QAA4C,uEAAJ,EAAI;;AAAA;;AACpE,aAAK/N,MAAL,GAAcA,MAAd;AACA,aAAK+N,QAAL,GAAgB,EAAhB;AAFoE;AAAA;AAAA;;AAAA;AAGpE,iCAAiCA,QAAjC,8HAA2C;AAAA;;AAAA;;AAAA,oBAA/BhN,IAA+B;AAAA,oBAAzBwE,UAAyB;;AACvC,qBAAKwI,QAAL,CAAchN,IAAd,IAAsBwE,UAAtB;AACH;AALmE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMvE;;;;+BAEMwI,Q,EAAuC;AAC1C,mBAAO,IAAIkE,KAAJ,CAAU,IAAV,EAAgBlE,QAAhB,CAAP;AACH;;;4BAEGhN,I,EAA0B;AAC1B,gBAAI,KAAKgN,QAAL,CAAchN,IAAd,CAAJ,EAAyB;AAAE,uBAAO,KAAKgN,QAAL,CAAchN,IAAd,CAAP;AAA6B;AACxD,gBAAI,KAAKf,MAAT,EAAiB;AAAE,uBAAO,KAAKA,MAAL,CAAYiJ,GAAZ,CAAgBlI,IAAhB,CAAP;AAA+B;AAClD,kBAAM,IAAI0Q,KAAJ,CAAa1Q,IAAb,0BAAN;AACH;;;4BAEGA,I,EAAuB;AACvB,gBAAI,KAAKgN,QAAL,CAAchN,IAAd,CAAJ,EAAyB,OAAO,IAAP;AACzB,mBAAO,KAAKf,MAAL,GAAc,KAAKA,MAAL,CAAY8I,GAAZ,CAAgB/H,IAAhB,CAAd,GAAsC,KAA7C;AACH;;;;;;kBAGUkR,K;;;;;;;;;;;;;;;;;QCvBCQ,yB,GAAAA,yB;;AAVhB;;;;;;AAMA;;;;AAIO,SAASA,yBAAT,CAAmClG,KAAnC,EAAyDvI,KAAzD,EAAwE;AAC3E,QAAMgH,IAAIuB,MAAM5L,MAAhB;AACA,QAAI+R,aAAa,CAAjB;AACA,QAAIC,aAAa3H,IAAI,CAArB;AACA,QAAI4H,eAAe,CAAnB;AACA,QAAIC,qBAAJ;AAAA,QAAkBjF,mBAAlB;;AAEA,WAAO8E,cAAcC,UAArB,EAAiC;AAC7BC,uBAAenO,KAAKC,KAAL,CAAW,CAACgO,aAAaC,UAAd,IAA4B,CAAvC,CAAf;AACAE,uBAAetG,MAAMqG,YAAN,CAAf;AACAhF,qBAAarB,MAAMqG,eAAe,CAArB,CAAb;AACA,YAAI5O,UAAU6O,YAAV,IAA0B7O,QAAQ6O,YAAR,IAAwB7O,QAAQ4J,UAA9D,EAA0E;AAAE;AACxE,mBAAOgF,YAAP;AACH,SAFD,MAEO,IAAIC,eAAe7O,KAAnB,EAA0B;AAC7B0O,yBAAaE,eAAe,CAA5B;AACH,SAFM,MAEA,IAAIC,eAAe7O,KAAnB,EAA0B;AAC7B2O,yBAAaC,eAAe,CAA5B;AACH,SAFM,MAEA;AACH,kBAAM,IAAI1O,uBAAJ,CAAiB,wBAAjB,CAAN;AACH;AACJ;;AAED,WAAOO,KAAKkH,GAAL,CAASiH,eAAe,CAAxB,EAA2B,CAA3B,CAAP;AACH,C;;;;;;;;;;;;;;;;;QCKe5N,K,GAAAA,K;QAQAzB,Q,GAAAA,Q;QA0BAP,Y,GAAAA,Y;AA5CT,IAAM8P,8BAAW,EAAExO,MAAM,MAAR,EAAjB;;AACA,IAAMV,kCAAa,EAAEU,MAAM,QAAR,EAAnB;AACA,IAAMZ,kCAAa,EAAEY,MAAM,QAAR,EAAnB;AACA,IAAMR,oCAAc,EAAEQ,MAAM,SAAR,EAApB;AACA,IAAM2B,gCAAY,EAAE3B,MAAM,OAAR,EAAlB;AACA,IAAMM,kCAAa,EAAEN,MAAM,QAAR,EAAnB;AACA,IAAME,gCAAY,EAAEF,MAAM,OAAR,EAAlB;AACA,IAAM0F,gCAAY,EAAE1F,MAAM,OAAR,EAAlB;AACA,IAAMkD,sCAAe,EAAElD,MAAM,UAAR,EAArB;;AAEA,SAASU,KAAT,CAAeX,QAAf,EAA+BE,CAA/B,EAAsD;AACzD,WAAO;AACHD,cAAM,OADH;AAEHD,0BAFG;AAGHE;AAHG,KAAP;AAKH;;AAEM,SAAShB,QAAT,CAAkBvC,IAAlB,EAAsC;AACzC,QAAIA,KAAKsD,IAAL,KAAc,OAAlB,EAA2B;AACvB,YAAMD,YAAWd,SAASvC,KAAKqD,QAAd,CAAjB;AACA,eAAO,OAAOrD,KAAKuD,CAAZ,KAAkB,QAAlB,cACMF,SADN,UACmBrD,KAAKuD,CADxB,SAEHvD,KAAKqD,QAAL,CAAcC,IAAd,KAAuB,OAAvB,GAAiC,OAAjC,cAAoDD,SAApD,MAFJ;AAGH,KALD,MAKO;AACH,eAAOrD,KAAKsD,IAAZ;AACH;AACJ;;AAED,IAAMyO,mBAAmB,CACrBD,QADqB,EAErBlP,UAFqB,EAGrBF,UAHqB,EAIrBI,WAJqB,EAKrBmC,SALqB,EAMrBrB,UANqB,EAOrBI,MAAMR,SAAN,CAPqB,CAAzB;;AAUA;;;;;AAKO,SAASxB,YAAT,CAAsBV,QAAtB,EAAsC4C,CAAtC,EAAwD;AAC3D,QAAIA,EAAEZ,IAAF,KAAW,OAAf,EAAwB;AACpB;AACA,eAAO,IAAP;AACH,KAHD,MAGO,IAAIhC,SAASgC,IAAT,KAAkB,OAAtB,EAA+B;AAClC,YAAIY,EAAEZ,IAAF,KAAW,OAAX,IACA,CAACtB,aAAaV,SAAS+B,QAAtB,EAAgCa,EAAEb,QAAlC,CADD,KAEC,OAAO/B,SAASiC,CAAhB,KAAsB,QAAtB,IAAkCjC,SAASiC,CAAT,KAAeW,EAAEX,CAFpD,CAAJ,EAE4D;AACxD,mBAAO,IAAP;AACH;AACJ,KANM,MAMA,IAAIjC,SAASgC,IAAT,KAAkBY,EAAEZ,IAAxB,EAA8B;AACjC,eAAO,IAAP;AACH,KAFM,MAEA,IAAIhC,SAASgC,IAAT,KAAkB,OAAtB,EAA+B;AAAA;AAAA;AAAA;;AAAA;AAClC,iCAAyByO,gBAAzB,8HAA2C;AAAA,oBAAhCC,UAAgC;;AACvC,oBAAI,CAAChQ,aAAagQ,UAAb,EAAyB9N,CAAzB,CAAL,EAAkC;AAC9B,2BAAO,IAAP;AACH;AACJ;AALiC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMrC;;AAED,yBAAmB3B,SAASjB,QAAT,CAAnB,mBAAmDiB,SAAS2B,CAAT,CAAnD;AACH,C;;;;;;;;;;;;;;;;;;;;;QCrFe+N,Y,GAAAA,Y;QAqBAC,O,GAAAA,O;QAgCAC,M,GAAAA,M;;AA7DhB;;;;AAEA;;;;AACA;;AACA;;;;AAIO,SAASF,YAAT,CAAsBtT,CAAtB,EAAgC+I,CAAhC,EAA0CC,CAA1C,EAAoDC,CAApD,EAAwE;AAC3E,QAAI,EACA,OAAOjJ,CAAP,KAAa,QAAb,IAAyBA,KAAK,CAA9B,IAAmCA,KAAK,GAAxC,IACA,OAAO+I,CAAP,KAAa,QADb,IACyBA,KAAK,CAD9B,IACmCA,KAAK,GADxC,IAEA,OAAOC,CAAP,KAAa,QAFb,IAEyBA,KAAK,CAF9B,IAEmCA,KAAK,GAHxC,CAAJ,EAIG;AACC,YAAM1E,QAAQ,OAAO2E,CAAP,KAAa,QAAb,GAAwB,CAACjJ,CAAD,EAAI+I,CAAJ,EAAOC,CAAP,EAAUC,CAAV,CAAxB,GAAuC,CAACjJ,CAAD,EAAI+I,CAAJ,EAAOC,CAAP,CAArD;AACA,wCAA8B1E,MAAMZ,IAAN,CAAW,IAAX,CAA9B;AACH;;AAED,QAAI,EACA,OAAOuF,CAAP,KAAa,WAAb,IAA6B,OAAOA,CAAP,KAAa,QAAb,IAAyBA,KAAK,CAA9B,IAAmCA,KAAK,CADrE,CAAJ,EAEG;AACC,wCAA8B,CAACjJ,CAAD,EAAI+I,CAAJ,EAAOC,CAAP,EAAUC,CAAV,EAAavF,IAAb,CAAkB,IAAlB,CAA9B;AACH;;AAED,WAAO,IAAP;AACH;;AAIM,SAAS6P,OAAT,CAAiBE,KAAjB,EAAwC;AAC3C,QAAIA,UAAU,IAAd,EAAoB;AAChB,eAAO,IAAP;AACH,KAFD,MAEO,IAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAClC,eAAO,IAAP;AACH,KAFM,MAEA,IAAI,OAAOA,KAAP,KAAiB,SAArB,EAAgC;AACnC,eAAO,IAAP;AACH,KAFM,MAEA,IAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAClC,eAAO,IAAP;AACH,KAFM,MAEA,IAAIA,iBAAiB7M,eAArB,EAA4B;AAC/B,eAAO,IAAP;AACH,KAFM,MAEA,IAAI6M,iBAAiBzM,kBAArB,EAA+B;AAClC,eAAO,IAAP;AACH,KAFM,MAEA,IAAI5E,MAAMC,OAAN,CAAcoR,KAAd,CAAJ,EAA0B;AAAA;AAAA;AAAA;;AAAA;AAC7B,iCAAmBA,KAAnB,8HAA0B;AAAA,oBAAfC,IAAe;;AACtB,oBAAI,CAACH,QAAQG,IAAR,CAAL,EAAoB;AAChB,2BAAO,KAAP;AACH;AACJ;AAL4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAM7B,eAAO,IAAP;AACH,KAPM,MAOA,IAAI,QAAOD,KAAP,yCAAOA,KAAP,OAAiB,QAArB,EAA+B;AAClC,aAAK,IAAMrK,GAAX,IAAkBqK,KAAlB,EAAyB;AACrB,gBAAI,CAACF,QAAQE,MAAMrK,GAAN,CAAR,CAAL,EAA0B;AACtB,uBAAO,KAAP;AACH;AACJ;AACD,eAAO,IAAP;AACH,KAPM,MAOA;AACH,eAAO,KAAP;AACH;AACJ;;AAEM,SAASoK,MAAT,CAAgBlP,KAAhB,EAAoC;AACvC,QAAIA,UAAU,IAAd,EAAoB;AAChB,eAAO6O,eAAP;AACH,KAFD,MAEO,IAAI,OAAO7O,KAAP,KAAiB,QAArB,EAA+B;AAClC,eAAOP,iBAAP;AACH,KAFM,MAEA,IAAI,OAAOO,KAAP,KAAiB,SAArB,EAAgC;AACnC,eAAOH,kBAAP;AACH,KAFM,MAEA,IAAI,OAAOG,KAAP,KAAiB,QAArB,EAA+B;AAClC,eAAOL,iBAAP;AACH,KAFM,MAEA,IAAIK,iBAAiBsC,eAArB,EAA4B;AAC/B,eAAON,gBAAP;AACH,KAFM,MAEA,IAAIhC,iBAAiB0C,kBAArB,EAA+B;AAClC,eAAOa,mBAAP;AACH,KAFM,MAEA,IAAIzF,MAAMC,OAAN,CAAciC,KAAd,CAAJ,EAA0B;AAC7B,YAAMtD,SAASsD,MAAMtD,MAArB;AACA,YAAI0D,iBAAJ;;AAF6B;AAAA;AAAA;;AAAA;AAI7B,kCAAmBJ,KAAnB,mIAA0B;AAAA,oBAAfoP,IAAe;;AACtB,oBAAMnO,IAAIiO,OAAOE,IAAP,CAAV;AACA,oBAAI,CAAChP,QAAL,EAAe;AACXA,+BAAWa,CAAX;AACH,iBAFD,MAEO,IAAIb,aAAaa,CAAjB,EAAoB;AACvB;AACH,iBAFM,MAEA;AACHb,+BAAWG,gBAAX;AACA;AACH;AACJ;AAd4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAgB7B,eAAO,kBAAMH,YAAYG,gBAAlB,EAA6B7D,MAA7B,CAAP;AACH,KAjBM,MAiBA;AACH,8BAAO,QAAOsD,KAAP,yCAAOA,KAAP,OAAiB,QAAxB;AACA,eAAOW,iBAAP;AACH;AACJ;;QAEQ2B,K,GAAAA,e;QAAOI,Q,GAAAA,kB;;;;;;;;;;;;;;;;;;;;;ACjGhB;;kBAKe2M,Y;QACNC,kB,GAAAA,kB;;;AAET,SAASA,kBAAT,CAA4BpR,MAA5B,EAAyC;AACrC,QAAI,CAACJ,MAAMC,OAAN,CAAcG,MAAd,CAAD,IAA0BA,OAAOxB,MAAP,KAAkB,CAAhD,EAAmD;AAC/C,eAAO,KAAP;AACH;AACD,YAAQwB,OAAO,CAAP,CAAR;AACA,aAAK,KAAL;AACI,mBAAOA,OAAOxB,MAAP,IAAiB,CAAjB,IAAsBwB,OAAO,CAAP,MAAc,KAApC,IAA6CA,OAAO,CAAP,MAAc,OAAlE;;AAEJ,aAAK,IAAL;AACA,aAAK,KAAL;AACA,aAAK,MAAL;AACA,aAAK,MAAL;AACI,mBAAO,KAAP;;AAEJ,aAAK,IAAL;AACA,aAAK,IAAL;AACA,aAAK,GAAL;AACA,aAAK,IAAL;AACA,aAAK,GAAL;AACA,aAAK,IAAL;AACI,mBAAOA,OAAOxB,MAAP,KAAkB,CAAlB,KAAwBoB,MAAMC,OAAN,CAAcG,OAAO,CAAP,CAAd,KAA4BJ,MAAMC,OAAN,CAAcG,OAAO,CAAP,CAAd,CAApD,CAAP;;AAEJ,aAAK,KAAL;AACA,aAAK,KAAL;AAAA;AAAA;AAAA;;AAAA;AACI,qCAAgBA,OAAO5B,KAAP,CAAa,CAAb,CAAhB,8HAAiC;AAAA,wBAAtBiT,CAAsB;;AAC7B,wBAAI,CAACD,mBAAmBC,CAAnB,CAAD,IAA0B,OAAOA,CAAP,KAAa,SAA3C,EAAsD;AAClD,+BAAO,KAAP;AACH;AACJ;AALL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAMI,mBAAO,IAAP;;AAEJ;AACI,mBAAO,IAAP;AA5BJ;AA8BH;;AAED,IAAMC,aAAa;AACf,YAAQ,SADO;AAEf,eAAW,KAFI;AAGf,gBAAY,IAHG;AAIf,yBAAqB,IAJN;AAKf,qBAAiB;AALF,CAAnB;;AAQA;;;;;;;;;AASA,SAASH,YAAT,CAAsBnR,MAAtB,EAAkD;AAC9C,QAAI,CAACA,MAAL,EAAa;AACT,eAAO;AAAA,mBAAM,IAAN;AAAA,SAAP;AACH;;AAED,QAAI,CAACoR,mBAAmBpR,MAAnB,CAAL,EAAiC;AAC7BA,iBAASuR,cAAcvR,MAAd,CAAT;AACH;;AAED,QAAMwR,WAAW,kCAAiBxR,MAAjB,EAAyBsR,UAAzB,CAAjB;AACA,QAAIE,SAAS1T,MAAT,KAAoB,OAAxB,EAAiC;AAC7B,cAAM,IAAIwR,KAAJ,CAAUkC,SAAS1P,KAAT,CAAe/E,GAAf,CAAmB;AAAA,mBAAUwS,IAAI3I,GAAd,UAAsB2I,IAAIvB,OAA1B;AAAA,SAAnB,EAAwD9M,IAAxD,CAA6D,IAA7D,CAAV,CAAN;AACH,KAFD,MAEO;AACH,eAAO,UAACuQ,gBAAD,EAAqCzE,OAArC;AAAA,mBAAoEwE,SAAS1P,KAAT,CAAehD,QAAf,CAAwB2S,gBAAxB,EAA0CzE,OAA1C,CAApE;AAAA,SAAP;AACH;AACJ;;AAED;AACA,SAAS9H,OAAT,CAAiBuB,CAAjB,EAAoBD,CAApB,EAAuB;AACnB,WAAOC,IAAID,CAAJ,GAAQ,CAAC,CAAT,GAAaC,IAAID,CAAJ,GAAQ,CAAR,GAAY,CAAhC;AACH;;AAED,SAAS+K,aAAT,CAAuBvR,MAAvB,EAAmD;AAC/C,QAAI,CAACA,MAAL,EAAa,OAAO,IAAP;AACb,QAAMR,KAAKQ,OAAO,CAAP,CAAX;AACA,QAAIA,OAAOxB,MAAP,IAAiB,CAArB,EAAwB,OAAQgB,OAAO,KAAf;AACxB,QAAMkS,YACFlS,OAAO,IAAP,GAAcmS,oBAAoB3R,OAAO,CAAP,CAApB,EAA+BA,OAAO,CAAP,CAA/B,EAA0C,IAA1C,CAAd,GACAR,OAAO,IAAP,GAAcoS,gBAAgBD,oBAAoB3R,OAAO,CAAP,CAApB,EAA+BA,OAAO,CAAP,CAA/B,EAA0C,IAA1C,CAAhB,CAAd,GACAR,OAAO,GAAP,IACAA,OAAO,GADP,IAEAA,OAAO,IAFP,IAGAA,OAAO,IAHP,GAGcmS,oBAAoB3R,OAAO,CAAP,CAApB,EAA+BA,OAAO,CAAP,CAA/B,EAA0CR,EAA1C,CAHd,GAIAA,OAAO,KAAP,GAAeqS,qBAAqB7R,OAAO5B,KAAP,CAAa,CAAb,CAArB,CAAf,GACAoB,OAAO,KAAP,GAAe,CAAC,KAAD,EAAQJ,MAAR,CAAeY,OAAO5B,KAAP,CAAa,CAAb,EAAgBrB,GAAhB,CAAoBwU,aAApB,CAAf,CAAf,GACA/R,OAAO,MAAP,GAAgB,CAAC,KAAD,EAAQJ,MAAR,CAAeY,OAAO5B,KAAP,CAAa,CAAb,EAAgBrB,GAAhB,CAAoBwU,aAApB,EAAmCxU,GAAnC,CAAuC6U,eAAvC,CAAf,CAAhB,GACApS,OAAO,IAAP,GAAcsS,YAAY9R,OAAO,CAAP,CAAZ,EAAuBA,OAAO5B,KAAP,CAAa,CAAb,CAAvB,CAAd,GACAoB,OAAO,KAAP,GAAeoS,gBAAgBE,YAAY9R,OAAO,CAAP,CAAZ,EAAuBA,OAAO5B,KAAP,CAAa,CAAb,CAAvB,CAAhB,CAAf,GACAoB,OAAO,KAAP,GAAeuS,aAAa/R,OAAO,CAAP,CAAb,CAAf,GACAR,OAAO,MAAP,GAAgBoS,gBAAgBG,aAAa/R,OAAO,CAAP,CAAb,CAAhB,CAAhB,GACA,IAdJ;AAeA,WAAO0R,SAAP;AACH;;AAED,SAASC,mBAAT,CAA6BK,QAA7B,EAA+ClQ,KAA/C,EAA2DtC,EAA3D,EAAuE;AACnE,YAAQwS,QAAR;AACA,aAAK,OAAL;AACI,mBAAO,kBAAgBxS,EAAhB,EAAsBsC,KAAtB,CAAP;AACJ,aAAK,KAAL;AACI,mBAAO,gBAActC,EAAd,EAAoBsC,KAApB,CAAP;AACJ;AACI,mBAAO,aAAWtC,EAAX,EAAiBwS,QAAjB,EAA2BlQ,KAA3B,CAAP;AANJ;AAQH;;AAED,SAAS+P,oBAAT,CAA8BI,OAA9B,EAA0D;AACtD,WAAO,CAAC,KAAD,EAAQ7S,MAAR,CAAe6S,QAAQlV,GAAR,CAAYwU,aAAZ,CAAf,CAAP;AACH;;AAED,SAASO,WAAT,CAAqBE,QAArB,EAAuCnE,MAAvC,EAA2D;AACvD,QAAIA,OAAOrP,MAAP,KAAkB,CAAtB,EAAyB;AAAE,eAAO,KAAP;AAAe;AAC1C,YAAQwT,QAAR;AACA,aAAK,OAAL;AACI,mBAAO,mBAAmB,CAAC,SAAD,EAAYnE,MAAZ,CAAnB,CAAP;AACJ,aAAK,KAAL;AACI,mBAAO,iBAAiB,CAAC,SAAD,EAAYA,MAAZ,CAAjB,CAAP;AACJ;AACI,gBAAIA,OAAOrP,MAAP,GAAgB,GAAhB,IAAuB,CAACqP,OAAOhK,IAAP,CAAY;AAAA,uBAAK,QAAOkD,CAAP,yCAAOA,CAAP,eAAoB8G,OAAO,CAAP,CAApB,CAAL;AAAA,aAAZ,CAA5B,EAA6E;AACzE,uBAAO,CAAC,iBAAD,EAAoBmE,QAApB,EAA8B,CAAC,SAAD,EAAYnE,OAAO1B,IAAP,CAAYjH,OAAZ,CAAZ,CAA9B,CAAP;AACH,aAFD,MAEO;AACH,uBAAO,CAAC,iBAAD,EAAoB8M,QAApB,EAA8B,CAAC,SAAD,EAAYnE,MAAZ,CAA9B,CAAP;AACH;AAVL;AAYH;;AAED,SAASkE,YAAT,CAAsBC,QAAtB,EAAwC;AACpC,YAAQA,QAAR;AACA,aAAK,OAAL;AACI,mBAAO,IAAP;AACJ,aAAK,KAAL;AACI,mBAAO,iBAAP;AACJ;AACI,mBAAO,eAAeA,QAAf,CAAP;AANJ;AAQH;;AAED,SAASJ,eAAT,CAAyB5R,MAAzB,EAAwC;AACpC,WAAO,CAAC,GAAD,EAAMA,MAAN,CAAP;AACH,C;;;;;;;;;;;;;;;;;;;;ACrJD;;;;AAEA;;;;;;kBAIekS,e;;;AAEf,SAASA,eAAT,CAAyBhD,UAAzB,EAAsE1B,YAAtE,EAAgH;AAC5G,QAAIpK,mBAAJ;;AAEA8L,iBAAa,sBAAO,EAAP,EAAWA,UAAX,CAAb;AACA,QAAIiD,0BAAJ;AACA,QAAI,OAAOjD,WAAWW,OAAlB,KAA8B,WAAlC,EAA+C;AAC3CsC,4BAAoBC,aAAalD,WAAWW,OAAxB,EAAiCrC,YAAjC,CAApB;AACH,KAFD,MAEO;AACH2E,4BAAoBC,aAAa5E,aAAaqC,OAA1B,EAAmCrC,YAAnC,CAApB;AACA,YAAI2E,sBAAsB,IAA1B,EAAgC;AAC5BA,gCAAoB,CAAC,OAAD,EAAU,sCAAV,CAApB;AACH;AACJ;;AAED,QAAIjD,WAAW9E,KAAf,EAAsB;AAClB,YAAMiI,0BAA0BnD,WAAW9E,KAAX,IAAoB,QAAO8E,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAP,MAAkC,QAAtF;AACA,YAAMkI,mBAAmBD,2BAA2BnD,WAAW8C,QAAX,KAAwB7S,SAA5E;AACA,YAAMoT,gBAAgBF,2BAA2B,CAACC,gBAAlD;;AAEA,YAAMlI,QAAQ8E,WAAW9E,KAAX,CAAiBrN,GAAjB,CAAqB,UAACyV,IAAD,EAAU;AACzC,gBAAI,CAACF,gBAAD,IAAqB9E,aAAaiF,MAAlC,IAA4C,OAAOD,KAAK,CAAL,CAAP,KAAmB,QAAnE,EAA6E;AACzE,uBAAO,CAACA,KAAK,CAAL,CAAD,EAAUE,mBAAmBF,KAAK,CAAL,CAAnB,CAAV,CAAP;AAEH;AACD,mBAAO,CAACA,KAAK,CAAL,CAAD,EAAUJ,aAAaI,KAAK,CAAL,CAAb,EAAsBhF,YAAtB,CAAV,CAAP;AACH,SANa,CAAd;;AAQA,YAAI0B,WAAWyD,UAAX,IAAyBzD,WAAWyD,UAAX,KAA0B,KAAvD,EAA8D;AAC1D,kBAAM,IAAIrD,KAAJ,CAAU,eAAV,CAAN;AACH;;AAED,YAAI+C,uBAAJ,EAA6B;AACzBjP,yBAAawP,+BAA+B1D,UAA/B,EAA2C1B,YAA3C,EAAyDpD,KAAzD,EAAgE+H,iBAAhE,CAAb;AACH,SAFD,MAEO,IAAII,aAAJ,EAAmB;AACtBnP,yBAAayP,oBAAoB3D,UAApB,EAAgC1B,YAAhC,EAA8CpD,KAA9C,CAAb;AACH,SAFM,MAEA;AACHhH,yBAAa0P,wBAAwB5D,UAAxB,EAAoC1B,YAApC,EAAkDpD,KAAlD,EAAyD+H,iBAAzD,CAAb;AACH;AACJ,KAxBD,MAwBO;AACH;AACA/O,qBAAa2P,wBAAwB7D,UAAxB,EAAoC1B,YAApC,EAAkD2E,iBAAlD,CAAb;AACH;;AAED,WAAO/O,UAAP;AACH;;AAED,SAAS2P,uBAAT,CAAiC7D,UAAjC,EAA6C1B,YAA7C,EAA2D2E,iBAA3D,EAA8E;AAC1E,QAAMrL,MAAM,CAAC,KAAD,EAAQoI,WAAW8C,QAAnB,CAAZ;;AAEA,QAAIxE,aAAa3O,IAAb,KAAsB,OAA1B,EAAmC;AAC/B,eAAOqQ,WAAWW,OAAX,KAAuB1Q,SAAvB,GAAmC2H,GAAnC,GAAyC,CAAC,UAAD,EAAaA,GAAb,EAAkBoI,WAAWW,OAA7B,CAAhD;AACH,KAFD,MAEO,IAAIrC,aAAa3O,IAAb,KAAsB,OAAtB,IAAiC,OAAO2O,aAAahP,MAApB,KAA+B,QAApE,EAA8E;AACjF,eAAO,CAAC,OAAD,EAAUgP,aAAa1L,KAAvB,EAA8B0L,aAAahP,MAA3C,EAAmDsI,GAAnD,CAAP;AACH,KAFM,MAEA,IAAI0G,aAAa3O,IAAb,KAAsB,OAA1B,EAAmC;AACtC,eAAO,CAAC,OAAD,EAAU2O,aAAa1L,KAAvB,EAA8BgF,GAA9B,CAAP;AACH,KAFM,MAEA,IAAI0G,aAAa3O,IAAb,KAAsB,MAA1B,EAAkC;AACrC,eAAO,CACH,KADG,EAEH,gBAFG,EAEe,CAAC,QAAD,EAAWiI,GAAX,CAFf,EAGH,CACI,OADJ,EAEI,CAAC,KAAD,EAAQ,gBAAR,CAFJ,EAGIzI,OAAO6N,IAAP,CAAYsB,aAAaK,MAAzB,CAHJ,EAGsC,CAAC,KAAD,EAAQ,gBAAR,CAHtC,EAIIsE,iBAJJ,CAHG,CAAP;AAUH,KAXM,MAWA;AACH,eAAOjD,WAAWW,OAAX,KAAuB1Q,SAAvB,GAAmC2H,GAAnC,GAAyC,CAAC0G,aAAa3O,IAAd,EAAoBiI,GAApB,EAAyBoI,WAAWW,OAApC,CAAhD;AACH;AACJ;;AAED,SAASuC,YAAT,CAAsBtQ,KAAtB,EAA6B4N,IAA7B,EAAmC;AAC/B,QAAI,OAAO5N,KAAP,KAAiB,WAAjB,IAAgCA,UAAU,IAA9C,EAAoD,OAAO,IAAP;AACpD,QAAI4N,KAAK7Q,IAAL,KAAc,OAAlB,EAA2B;AACvB,eAAOiD,KAAP;AACH,KAFD,MAEO,IAAI4N,KAAK7Q,IAAL,KAAc,OAAlB,EAA2B;AAC9B,eAAO,CAAC,SAAD,EAAYiD,KAAZ,CAAP;AACH,KAFM,MAEA;AACH,eAAOA,KAAP;AACH;AACJ;;AAED,SAAS8Q,8BAAT,CAAwC1D,UAAxC,EAAoD1B,YAApD,EAAkEpD,KAAlE,EAAyE+H,iBAAzE,EAA4F;AACxF,QAAMa,4BAA4B,EAAlC;AACA,QAAMC,uBAAuB,EAA7B;AACA,QAAMvE,YAAY,EAAlB;AACA,SAAK,IAAI7E,IAAI,CAAb,EAAgBA,IAAIO,MAAM5L,MAA1B,EAAkCqL,GAAlC,EAAuC;AACnC,YAAM2I,OAAOpI,MAAMP,CAAN,CAAb;AACA,YAAMxM,OAAOmV,KAAK,CAAL,EAAQnV,IAArB;AACA,YAAI2V,0BAA0B3V,IAA1B,MAAoC8B,SAAxC,EAAmD;AAC/C6T,sCAA0B3V,IAA1B,IAAkC;AAC9BA,sBAAMA,IADwB;AAE9BwB,sBAAMqQ,WAAWrQ,IAFa;AAG9BmT,0BAAU9C,WAAW8C,QAHS;AAI9BnC,yBAASX,WAAWW;AAJU,aAAlC;AAMAoD,iCAAqB5V,IAArB,IAA6B,EAA7B;AACAqR,sBAAUnO,IAAV,CAAelD,IAAf;AACH;AACD4V,6BAAqB5V,IAArB,EAA2BkD,IAA3B,CAAgC,CAACiS,KAAK,CAAL,EAAQ1Q,KAAT,EAAgB0Q,KAAK,CAAL,CAAhB,CAAhC;AACH;;AAED;AACA;AACA;AACA;AACA,QAAMU,eAAeC,gBAAgB,EAAhB,EAAoB3F,YAApB,CAArB;AACA,QAAI0F,iBAAiB,aAArB,EAAoC;AAChC,YAAM9P,aAAa,CAAC,aAAD,EAAgB,CAAC,QAAD,CAAhB,EAA4B,CAAC,MAAD,CAA5B,CAAnB;;AADgC;AAAA;AAAA;;AAAA;AAGhC,iCAAgBsL,SAAhB,8HAA2B;AAAA,oBAAhB0E,CAAgB;;AACvB,oBAAMtI,SAASgI,wBAAwBE,0BAA0BI,CAA1B,CAAxB,EAAsD5F,YAAtD,EAAoEyF,qBAAqBG,CAArB,CAApE,EAA6FjB,iBAA7F,CAAf;AACAkB,+BAAejQ,UAAf,EAA2BgQ,CAA3B,EAA8BtI,MAA9B,EAAsC,KAAtC;AACH;AAN+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAQhC,eAAO1H,UAAP;AACH,KATD,MASO;AACH,YAAMA,cAAa,CAAC,MAAD,EAAS,CAAC,MAAD,CAAT,CAAnB;;AADG;AAAA;AAAA;;AAAA;AAGH,kCAAgBsL,SAAhB,mIAA2B;AAAA,oBAAhB0E,EAAgB;;AACvB,oBAAMtI,UAASgI,wBAAwBE,0BAA0BI,EAA1B,CAAxB,EAAsD5F,YAAtD,EAAoEyF,qBAAqBG,EAArB,CAApE,EAA6FjB,iBAA7F,CAAf;AACAkB,+BAAejQ,WAAf,EAA2BgQ,EAA3B,EAA8BtI,OAA9B,EAAsC,IAAtC;AACH;AANE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAQHwI,iCAAyBlQ,WAAzB;;AAEA,eAAOA,WAAP;AACH;AACJ;;AAED,SAAS0P,uBAAT,CAAiC5D,UAAjC,EAA6C1B,YAA7C,EAA2DpD,KAA3D,EAAkE+H,iBAAlE,EAAqF;AACjF,QAAMtT,OAAOsU,gBAAgBjE,UAAhB,EAA4B1B,YAA5B,CAAb;;AAEA,QAAMzB,oBAAmB3B,MAAM,CAAN,EAAS,CAAT,CAAnB,CAAN;AACA,0BACI2B,cAAc,QAAd,IACAA,cAAc,QADd,IAEAA,cAAc,SAHlB;;AAMA,QAAIlK,QAAQ,CAACkK,SAAD,EAAY,CAAC,KAAD,EAAQmD,WAAW8C,QAAnB,CAAZ,CAAZ;;AAEA,QAAI5O,mBAAJ;AACA,QAAImQ,SAAS,KAAb;AACA,QAAI1U,SAAS,aAAT,IAA0BkN,cAAc,SAA5C,EAAuD;AACnD,8BAAOmD,WAAW9E,KAAX,CAAiB5L,MAAjB,GAA0B,CAA1B,IAA+B0Q,WAAW9E,KAAX,CAAiB5L,MAAjB,IAA2B,CAAjE;AACA,YAAI0Q,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,MAA2B,KAA/B,EAAsC;AAClCvI,oBAAQ,CAAC,GAAD,EAAMA,KAAN,CAAR;AACH;AACDuB,qBAAa,CAAE,MAAF,EAAUvB,KAAV,EAAiBqN,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAjB,CAAb;AACA,YAAI8E,WAAW9E,KAAX,CAAiB5L,MAAjB,GAA0B,CAA9B,EAAiC;AAC7B4E,uBAAW7C,IAAX,CAAgB2O,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAhB;AACH,SAFD,MAEO;AACHhH,uBAAW7C,IAAX,CAAgB4R,iBAAhB;AACH;AACD,eAAO/O,UAAP;AACH,KAZD,MAYO,IAAIvE,SAAS,aAAb,EAA4B;AAC/BuE,qBAAa,CAAC,OAAD,EAAUvB,KAAV,CAAb;AACH,KAFM,MAEA,IAAIhD,SAAS,UAAb,EAAyB;AAC5BuE,qBAAa,CAAC,MAAD,EAASvB,KAAT,CAAb;AACA0R,iBAAS,IAAT;AACH,KAHM,MAGA,IAAI1U,SAAS,aAAb,EAA4B;AAC/B,YAAMkM,OAAOmE,WAAWnE,IAAX,KAAoB5L,SAApB,GAAgC+P,WAAWnE,IAA3C,GAAkD,CAA/D;AACA3H,qBAAa,CAAC,aAAD,EAAgB,CAAC,aAAD,EAAgB2H,IAAhB,CAAhB,EAAuClJ,KAAvC,CAAb;AACH,KAHM,MAGA;AACH,cAAM,IAAIyN,KAAJ,qCAA4CzQ,IAA5C,CAAN;AACH;;AApCgF;AAAA;AAAA;;AAAA;AAsCjF,8BAAmBuL,KAAnB,mIAA0B;AAAA,gBAAfoI,IAAe;;AACtBa,2BAAejQ,UAAf,EAA2BoP,KAAK,CAAL,CAA3B,EAAoCA,KAAK,CAAL,CAApC,EAA6Ce,MAA7C;AACH;AAxCgF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AA0CjF,QAAInQ,WAAW,CAAX,MAAkB,OAAtB,EAA+B;AAC3BA,mBAAW7C,IAAX,CAAgB4R,iBAAhB;AACH;;AAEDmB,6BAAyBlQ,UAAzB;;AAEA,WAAOA,UAAP;AACH;;AAED,SAASyP,mBAAT,CAA6B3D,UAA7B,EAAyC1B,YAAzC,EAAuDpD,KAAvD,EAAgF;AAAA,QAAlBvI,KAAkB,uEAAV,CAAC,MAAD,CAAU;;AAC5E,QAAMhD,OAAOsU,gBAAgBjE,UAAhB,EAA4B1B,YAA5B,CAAb;AACA,QAAIpK,mBAAJ;AACA,QAAImQ,SAAS,KAAb;AACA,QAAI1U,SAAS,UAAb,EAAyB;AACrBuE,qBAAa,CAAC,MAAD,EAASvB,KAAT,CAAb;AACA0R,iBAAS,IAAT;AACH,KAHD,MAGO,IAAI1U,SAAS,aAAb,EAA4B;AAC/B,YAAMkM,OAAOmE,WAAWnE,IAAX,KAAoB5L,SAApB,GAAgC+P,WAAWnE,IAA3C,GAAkD,CAA/D;AACA3H,qBAAa,CAAC,aAAD,EAAgB,CAAC,aAAD,EAAgB2H,IAAhB,CAAhB,EAAuClJ,KAAvC,CAAb;AACH,KAHM,MAGA;AACH,cAAM,IAAIyN,KAAJ,kCAAyCzQ,IAAzC,OAAN;AACH;;AAZ2E;AAAA;AAAA;;AAAA;AAc5E,8BAAmBuL,KAAnB,mIAA0B;AAAA,gBAAfoI,IAAe;;AACtBa,2BAAejQ,UAAf,EAA2BoP,KAAK,CAAL,CAA3B,EAAoCA,KAAK,CAAL,CAApC,EAA6Ce,MAA7C;AACH;AAhB2E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAkB5ED,6BAAyBlQ,UAAzB;;AAEA,WAAOA,UAAP;AACH;;AAED,SAASkQ,wBAAT,CAAkClQ,UAAlC,EAA8C;AAC1C;AACA,QAAIA,WAAW,CAAX,MAAkB,MAAlB,IAA4BA,WAAW5E,MAAX,KAAsB,CAAtD,EAAyD;AACrD4E,mBAAW7C,IAAX,CAAgB,CAAhB;AACA6C,mBAAW7C,IAAX,CAAgB6C,WAAW,CAAX,CAAhB;AACH;AACJ;;AAED,SAASiQ,cAAT,CAAwBG,KAAxB,EAA+B3R,KAA/B,EAAsCiJ,MAAtC,EAA8CyI,MAA9C,EAAsD;AAClD;AACA;AACA,QAAIC,MAAMhV,MAAN,GAAe,CAAf,IAAoBqD,UAAU2R,MAAMA,MAAMhV,MAAN,GAAe,CAArB,CAAlC,EAA2D;AACvD;AACH;AACD;AACA,QAAI,EAAE+U,UAAUC,MAAMhV,MAAN,KAAiB,CAA7B,CAAJ,EAAqC;AACjCgV,cAAMjT,IAAN,CAAWsB,KAAX;AACH;AACD2R,UAAMjT,IAAN,CAAWuK,MAAX;AACH;;AAED,SAASqI,eAAT,CAAyBjE,UAAzB,EAAqC1B,YAArC,EAAmD;AAC/C,QAAI0B,WAAWrQ,IAAf,EAAqB;AACjB,eAAOqQ,WAAWrQ,IAAlB;AACH,KAFD,MAEO,IAAI2O,aAAaiG,QAAjB,EAA2B;AAC9B,eAAOjG,aAAaiG,QAAb,KAA0B,cAA1B,GAA2C,aAA3C,GAA2D,UAAlE;AACH,KAFM,MAEA;AACH,eAAO,aAAP;AACH;AACJ;;AAED;AACA,SAASf,kBAAT,CAA4B7I,CAA5B,EAA+B;AAC3B,QAAM/L,SAAS,CAAC,QAAD,CAAf;AACA,QAAM4V,KAAK,aAAX;AACA,QAAIC,MAAM,CAAV;AACA,QAAIC,cAAJ;AACA,WAAO,CAACA,QAAQF,GAAGG,IAAH,CAAQhK,CAAR,CAAT,MAAyB,IAAhC,EAAsC;AAClC,YAAMiK,UAAUjK,EAAEzL,KAAF,CAAQuV,GAAR,EAAaD,GAAGK,SAAH,GAAeH,MAAM,CAAN,EAASpV,MAArC,CAAhB;AACAmV,cAAMD,GAAGK,SAAT;AACA,YAAID,QAAQtV,MAAR,GAAiB,CAArB,EAAwBV,OAAOyC,IAAP,CAAYuT,OAAZ;AACxBhW,eAAOyC,IAAP,CAAY,CAAC,WAAD,EAAc,CAAC,KAAD,EAAQqT,MAAM,CAAN,CAAR,CAAd,CAAZ;AACH;;AAED,QAAI9V,OAAOU,MAAP,KAAkB,CAAtB,EAAyB;AACrB,eAAOqL,CAAP;AACH;;AAED,QAAI8J,MAAM9J,EAAErL,MAAZ,EAAoB;AAChBV,eAAOyC,IAAP,CAAYsJ,EAAEzL,KAAF,CAAQuV,GAAR,CAAZ;AACH,KAFD,MAEO,IAAI7V,OAAOU,MAAP,KAAkB,CAAtB,EAAyB;AAC5B,eAAOV,OAAO,CAAP,CAAP;AACH;;AAED,WAAOA,MAAP;AACH,C;;;;;;;;;;;;;;;;;;;;QCrQekW,U,GAAAA,U;QAQAC,c,GAAAA,c;;AAfhB;;IAAYC,W;;AACZ;;;;AACA;;;;AACA;;;;AACA;;IAAYhK,W;;AACZ;;;;;;;;AAEO,SAAS8J,UAAT,CAAoBlS,KAApB,EAA2B;AAC9B,WAAO,QAAOA,KAAP,yCAAOA,KAAP,OAAiB,QAAjB,IAA6BA,UAAU,IAAvC,IAA+C,CAAClC,MAAMC,OAAN,CAAciC,KAAd,CAAvD;AACH;;AAED,SAASqS,gBAAT,CAA0BxL,CAA1B,EAA6B;AACzB,WAAOA,CAAP;AACH;;AAEM,SAASsL,cAAT,CAAwB/E,UAAxB,EAAoC1B,YAApC,EAAkD;AACrD,QAAM4G,UAAU5G,aAAa3O,IAAb,KAAsB,OAAtC;AACA,QAAMwT,0BAA0BnD,WAAW9E,KAAX,IAAoB,QAAO8E,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAP,MAAkC,QAAtF;AACA,QAAMkI,mBAAmBD,2BAA2BnD,WAAW8C,QAAX,KAAwB7S,SAA5E;AACA,QAAMoT,gBAAgBF,2BAA2B,CAACC,gBAAlD;AACA,QAAMzT,OAAOqQ,WAAWrQ,IAAX,KAAoB2O,aAAaiG,QAAb,KAA0B,cAA1B,GAA2C,aAA3C,GAA2D,UAA/E,CAAb;;AAEA,QAAIW,OAAJ,EAAa;AACTlF,qBAAa,sBAAO,EAAP,EAAWA,UAAX,CAAb;;AAEA,YAAIA,WAAW9E,KAAf,EAAsB;AAClB8E,uBAAW9E,KAAX,GAAmB8E,WAAW9E,KAAX,CAAiBrN,GAAjB,CAAqB,UAACyV,IAAD,EAAU;AAC9C,uBAAO,CAACA,KAAK,CAAL,CAAD,EAAUpO,gBAAM9D,KAAN,CAAYkS,KAAK,CAAL,CAAZ,CAAV,CAAP;AACH,aAFkB,CAAnB;AAGH;;AAED,YAAItD,WAAWW,OAAf,EAAwB;AACpBX,uBAAWW,OAAX,GAAqBzL,gBAAM9D,KAAN,CAAY4O,WAAWW,OAAvB,CAArB;AACH,SAFD,MAEO;AACHX,uBAAWW,OAAX,GAAqBzL,gBAAM9D,KAAN,CAAYkN,aAAaqC,OAAzB,CAArB;AACH;AACJ;;AAED,QAAIX,WAAWyD,UAAX,IAAyBzD,WAAWyD,UAAX,KAA0B,KAAnD,IAA4D,CAACuB,YAAYhF,WAAWyD,UAAvB,CAAjE,EAAqG;AAAE;AACnG,cAAM,IAAIrD,KAAJ,2BAAkCJ,WAAWyD,UAA7C,CAAN;AACH;;AAED,QAAI0B,iBAAJ;AACA,QAAIC,oBAAJ;AACA,QAAIC,2BAAJ;AACA,QAAI1V,SAAS,aAAb,EAA4B;AACxBwV,mBAAWG,2BAAX;AACH,KAFD,MAEO,IAAI3V,SAAS,UAAb,EAAyB;AAC5BwV,mBAAWI,wBAAX;AACH,KAFM,MAEA,IAAI5V,SAAS,aAAb,EAA4B;AAC/BwV,mBAAWK,2BAAX;;AAEA;AACAJ,sBAAcjW,OAAOC,MAAP,CAAc,IAAd,CAAd;AAJ+B;AAAA;AAAA;;AAAA;AAK/B,iCAAmB4Q,WAAW9E,KAA9B,8HAAqC;AAAA,oBAA1BoI,IAA0B;;AACjC8B,4BAAY9B,KAAK,CAAL,CAAZ,IAAuBA,KAAK,CAAL,CAAvB;AACH;;AAED;AAT+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAU/B+B,qCAA4BrF,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAA5B;AAEH,KAZM,MAYA,IAAIvL,SAAS,UAAb,EAAyB;AAC5BwV,mBAAWM,wBAAX;AACH,KAFM,MAEA;AACH,cAAM,IAAIrF,KAAJ,6BAAoCzQ,IAApC,OAAN;AACH;;AAED,QAAIwT,uBAAJ,EAA6B;AACzB,YAAMuC,mBAAmB,EAAzB;AACA,YAAMlG,YAAY,EAAlB;AACA,aAAK,IAAI7E,IAAI,CAAb,EAAgBA,IAAIqF,WAAW9E,KAAX,CAAiB5L,MAArC,EAA6CqL,GAA7C,EAAkD;AAC9C,gBAAM2I,QAAOtD,WAAW9E,KAAX,CAAiBP,CAAjB,CAAb;AACA,gBAAMxM,OAAOmV,MAAK,CAAL,EAAQnV,IAArB;AACA,gBAAIuX,iBAAiBvX,IAAjB,MAA2B8B,SAA/B,EAA0C;AACtCyV,iCAAiBvX,IAAjB,IAAyB;AACrBA,0BAAMA,IADe;AAErBwB,0BAAMqQ,WAAWrQ,IAFI;AAGrBmT,8BAAU9C,WAAW8C,QAHA;AAIrBnC,6BAASX,WAAWW,OAJC;AAKrBzF,2BAAO;AALc,iBAAzB;AAOAsE,0BAAUnO,IAAV,CAAelD,IAAf;AACH;AACDuX,6BAAiBvX,IAAjB,EAAuB+M,KAAvB,CAA6B7J,IAA7B,CAAkC,CAACiS,MAAK,CAAL,EAAQ1Q,KAAT,EAAgB0Q,MAAK,CAAL,CAAhB,CAAlC;AACH;;AAED,YAAMS,uBAAuB,EAA7B;AAnByB;AAAA;AAAA;;AAAA;AAoBzB,kCAAgBvE,SAAhB,mIAA2B;AAAA,oBAAhB0E,CAAgB;;AACvBH,qCAAqB1S,IAArB,CAA0B,CAACqU,iBAAiBxB,CAAjB,EAAoB/V,IAArB,EAA2B4W,eAAeW,iBAAiBxB,CAAjB,CAAf,EAAoC5F,YAApC,CAA3B,CAA1B;AACH;AAtBwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAwBzB,eAAO;AACHrL,kBAAM,WADH;AAEHwI,iCAAqB5E,sBAAY4E,mBAAZ,CAAgCkK,IAAhC,CAAqC1V,SAArC,EAAgD,EAACP,MAAM,QAAP,EAAhD,CAFlB;AAGH8P,uBAAWuE,qBAAqBlW,GAArB,CAAyB;AAAA,uBAAK8M,EAAE,CAAF,CAAL;AAAA,aAAzB,CAHR;AAIH/K,oBAJG,0BAIcmJ,UAJd,EAI0B;AAAA,oBAAnB5K,IAAmB,QAAnBA,IAAmB;;AACzB,uBAAOmX,4BAA4B;AAC/BpK,2BAAO6I,oBADwB;AAE/BlI,0BAAMmE,WAAWnE;AAFc,iBAA5B,EAGJyC,YAHI,EAGUnQ,IAHV,EAGgByB,QAHhB,CAGyBzB,IAHzB,EAG+B4K,UAH/B,CAAP;AAIH;AATE,SAAP;AAWH,KAnCD,MAmCO,IAAIsK,aAAJ,EAAmB;AACtB,eAAO;AACHpQ,kBAAM,QADH;AAEHwI,iCAAqB9L,SAAS,aAAT,GACjBkH,sBAAY4E,mBAAZ,CAAgCkK,IAAhC,CAAqC1V,SAArC,EAAgD,EAACP,MAAM,aAAP,EAAsBmM,MAAMmE,WAAWnE,IAAX,KAAoB5L,SAApB,GAAgC+P,WAAWnE,IAA3C,GAAkD,CAA9E,EAAhD,CADiB,GAEjB;AAAA,uBAAM,CAAN;AAAA,aAJD;AAKH2D,uBAAWQ,WAAW9E,KAAX,CAAiBrN,GAAjB,CAAqB;AAAA,uBAAK8M,EAAE,CAAF,CAAL;AAAA,aAArB,CALR;AAMH/K,sBAAU;AAAA,oBAAEzB,IAAF,SAAEA,IAAF;AAAA,uBAAYgX,SAASnF,UAAT,EAAqB1B,YAArB,EAAmCnQ,IAAnC,EAAyCiX,WAAzC,EAAsDC,kBAAtD,CAAZ;AAAA;AANP,SAAP;AAQH,KATM,MASA;AACH,eAAO;AACHpS,kBAAM,QADH;AAEHrD,oBAFG,oBAEMuE,CAFN,EAES2J,OAFT,EAEkB;AACjB,oBAAMlL,QAAQkL,WAAWA,QAAQ/E,UAAnB,GAAgC+E,QAAQ/E,UAAR,CAAmBiH,WAAW8C,QAA9B,CAAhC,GAA0E7S,SAAxF;AACA,oBAAI2C,UAAU3C,SAAd,EAAyB;AACrB,2BAAO2V,SAAS5F,WAAWW,OAApB,EAA6BrC,aAAaqC,OAA1C,CAAP;AACH;AACD,uBAAOwE,SAASnF,UAAT,EAAqB1B,YAArB,EAAmC1L,KAAnC,EAA0CwS,WAA1C,EAAuDC,kBAAvD,CAAP;AACH;AARE,SAAP;AAUH;AACJ;;AAED,SAASO,QAAT,CAAkBrO,CAAlB,EAAqBD,CAArB,EAAwBxC,CAAxB,EAA2B;AACvB,QAAIyC,MAAMtH,SAAV,EAAqB,OAAOsH,CAAP;AACrB,QAAID,MAAMrH,SAAV,EAAqB,OAAOqH,CAAP;AACrB,QAAIxC,MAAM7E,SAAV,EAAqB,OAAO6E,CAAP;AACxB;;AAED,SAAS0Q,2BAAT,CAAqCxF,UAArC,EAAiD1B,YAAjD,EAA+D3L,KAA/D,EAAsEyS,WAAtE,EAAmFS,OAAnF,EAA4F;AACxF,QAAMC,YAAY,QAAOnT,KAAP,yCAAOA,KAAP,OAAiBkT,OAAjB,GAA2BT,YAAYzS,KAAZ,CAA3B,GAAgD1C,SAAlE,CADwF,CACX;AAC7E,WAAO2V,SAASE,SAAT,EAAoB9F,WAAWW,OAA/B,EAAwCrC,aAAaqC,OAArD,CAAP;AACH;;AAED,SAAS4E,wBAAT,CAAkCvF,UAAlC,EAA8C1B,YAA9C,EAA4D3L,KAA5D,EAAmE;AAC/D;AACA,QAAI,wBAAQA,KAAR,MAAmB,QAAvB,EAAiC,OAAOiT,SAAS5F,WAAWW,OAApB,EAA6BrC,aAAaqC,OAA1C,CAAP;AACjC,QAAMhH,IAAIqG,WAAW9E,KAAX,CAAiB5L,MAA3B;AACA,QAAIqK,MAAM,CAAV,EAAa,OAAOqG,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAP;AACb,QAAIvI,SAASqN,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAb,EAAqC,OAAO8E,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAP;AACrC,QAAIvI,SAASqN,WAAW9E,KAAX,CAAiBvB,IAAI,CAArB,EAAwB,CAAxB,CAAb,EAAyC,OAAOqG,WAAW9E,KAAX,CAAiBvB,IAAI,CAArB,EAAwB,CAAxB,CAAP;;AAEzC,QAAMjG,QAAQ0N,0BAA0BpB,WAAW9E,KAArC,EAA4CvI,KAA5C,CAAd;;AAEA,WAAOqN,WAAW9E,KAAX,CAAiBxH,KAAjB,EAAwB,CAAxB,CAAP;AACH;;AAED,SAAS4R,2BAAT,CAAqCtF,UAArC,EAAiD1B,YAAjD,EAA+D3L,KAA/D,EAAsE;AAClE,QAAMkJ,OAAOmE,WAAWnE,IAAX,KAAoB5L,SAApB,GAAgC+P,WAAWnE,IAA3C,GAAkD,CAA/D;;AAEA;AACA,QAAI,wBAAQlJ,KAAR,MAAmB,QAAvB,EAAiC,OAAOiT,SAAS5F,WAAWW,OAApB,EAA6BrC,aAAaqC,OAA1C,CAAP;AACjC,QAAMhH,IAAIqG,WAAW9E,KAAX,CAAiB5L,MAA3B;AACA,QAAIqK,MAAM,CAAV,EAAa,OAAOqG,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAP;AACb,QAAIvI,SAASqN,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAb,EAAqC,OAAO8E,WAAW9E,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAP;AACrC,QAAIvI,SAASqN,WAAW9E,KAAX,CAAiBvB,IAAI,CAArB,EAAwB,CAAxB,CAAb,EAAyC,OAAOqG,WAAW9E,KAAX,CAAiBvB,IAAI,CAArB,EAAwB,CAAxB,CAAP;;AAEzC,QAAMjG,QAAQ0N,0BAA0BpB,WAAW9E,KAArC,EAA4CvI,KAA5C,CAAd;AACA,QAAMkB,IAAI4H,oBACN9I,KADM,EACCkJ,IADD,EAENmE,WAAW9E,KAAX,CAAiBxH,KAAjB,EAAwB,CAAxB,CAFM,EAGNsM,WAAW9E,KAAX,CAAiBxH,QAAQ,CAAzB,EAA4B,CAA5B,CAHM,CAAV;;AAKA,QAAMgI,cAAcsE,WAAW9E,KAAX,CAAiBxH,KAAjB,EAAwB,CAAxB,CAApB;AACA,QAAMiI,cAAcqE,WAAW9E,KAAX,CAAiBxH,QAAQ,CAAzB,EAA4B,CAA5B,CAApB;AACA,QAAIqS,SAAS/K,YAAYsD,aAAa3O,IAAzB,KAAkCsV,gBAA/C,CAlBkE,CAkBD;;AAEjE,QAAIjF,WAAWyD,UAAX,IAAyBzD,WAAWyD,UAAX,KAA0B,KAAvD,EAA8D;AAC1D,YAAMuC,aAAahB,YAAYhF,WAAWyD,UAAvB,CAAnB,CAD0D,CACH;AACvDsC,iBAAS,gBAACxO,CAAD,EAAID,CAAJ;AAAA,mBAAU0O,WAAWC,OAAX,CAAmBD,WAAWhL,WAAX,CAAuBgL,WAAWE,OAAX,CAAmB3O,CAAnB,CAAvB,EAA8CyO,WAAWE,OAAX,CAAmB5O,CAAnB,CAA9C,EAAqEzD,CAArE,CAAnB,CAAV;AAAA,SAAT;AACH;;AAED,QAAI,OAAO6H,YAAY9L,QAAnB,KAAgC,UAApC,EAAgD;AAC5C,eAAO;AACHA,oBADG,sBACe;AAAA,kDAANC,IAAM;AAANA,wBAAM;AAAA;;AACd,oBAAMsW,iBAAiBzK,YAAY9L,QAAZ,CAAqBiC,KAArB,CAA2B5B,SAA3B,EAAsCJ,IAAtC,CAAvB;AACA,oBAAMuW,iBAAiBzK,YAAY/L,QAAZ,CAAqBiC,KAArB,CAA2B5B,SAA3B,EAAsCJ,IAAtC,CAAvB;AACA;AACA,oBAAIsW,mBAAmBlW,SAAnB,IAAgCmW,mBAAmBnW,SAAvD,EAAkE;AAC9D,2BAAOA,SAAP;AACH;AACD,uBAAO8V,OAAOI,cAAP,EAAuBC,cAAvB,EAAuCvS,CAAvC,CAAP;AACH;AATE,SAAP;AAWH;;AAED,WAAOkS,OAAOrK,WAAP,EAAoBC,WAApB,EAAiC9H,CAAjC,CAAP;AACH;;AAED,SAAS4R,wBAAT,CAAkCzF,UAAlC,EAA8C1B,YAA9C,EAA4D3L,KAA5D,EAAmE;AAC/D,QAAI2L,aAAa3O,IAAb,KAAsB,OAA1B,EAAmC;AAC/BgD,gBAAQuC,gBAAM9D,KAAN,CAAYuB,KAAZ,CAAR;AACH,KAFD,MAEO,IAAI,wBAAQA,KAAR,MAAmB2L,aAAa3O,IAAhC,KAAyC2O,aAAa3O,IAAb,KAAsB,MAAtB,IAAgC,CAAC2O,aAAaK,MAAb,CAAoBhM,KAApB,CAA1E,CAAJ,EAA2G;AAC9GA,gBAAQ1C,SAAR;AACH;AACD,WAAO2V,SAASjT,KAAT,EAAgBqN,WAAWW,OAA3B,EAAoCrC,aAAaqC,OAAjD,CAAP;AACH;;AAED;;;;;AAKA,SAASS,yBAAT,CAAmClG,KAAnC,EAA0CvI,KAA1C,EAAiD;AAC7C,QAAMgH,IAAIuB,MAAM5L,MAAhB;AACA,QAAI+R,aAAa,CAAjB;AACA,QAAIC,aAAa3H,IAAI,CAArB;AACA,QAAI4H,eAAe,CAAnB;AACA,QAAIC,qBAAJ;AAAA,QAAkBjF,mBAAlB;;AAEA,WAAO8E,cAAcC,UAArB,EAAiC;AAC7BC,uBAAenO,KAAKC,KAAL,CAAW,CAACgO,aAAaC,UAAd,IAA4B,CAAvC,CAAf;AACAE,uBAAetG,MAAMqG,YAAN,EAAoB,CAApB,CAAf;AACAhF,qBAAarB,MAAMqG,eAAe,CAArB,EAAwB,CAAxB,CAAb;AACA,YAAI5O,UAAU6O,YAAV,IAA0B7O,QAAQ6O,YAAR,IAAwB7O,QAAQ4J,UAA9D,EAA0E;AAAE;AACxE,mBAAOgF,YAAP;AACH,SAFD,MAEO,IAAIC,eAAe7O,KAAnB,EAA0B;AAC7B0O,yBAAaE,eAAe,CAA5B;AACH,SAFM,MAEA,IAAIC,eAAe7O,KAAnB,EAA0B;AAC7B2O,yBAAaC,eAAe,CAA5B;AACH;AACJ;;AAED,WAAOnO,KAAKkH,GAAL,CAASiH,eAAe,CAAxB,EAA2B,CAA3B,CAAP;AACH;;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA,SAAS9F,mBAAT,CAA6B9I,KAA7B,EAAoCkJ,IAApC,EAA0CS,UAA1C,EAAsDC,UAAtD,EAAkE;AAC9D,QAAMC,aAAaD,aAAaD,UAAhC;AACA,QAAMG,WAAW9J,QAAQ2J,UAAzB;;AAEA,QAAIE,eAAe,CAAnB,EAAsB;AAClB,eAAO,CAAP;AACH,KAFD,MAEO,IAAIX,SAAS,CAAb,EAAgB;AACnB,eAAOY,WAAWD,UAAlB;AACH,KAFM,MAEA;AACH,eAAO,CAACpJ,KAAKoG,GAAL,CAASqC,IAAT,EAAeY,QAAf,IAA2B,CAA5B,KAAkCrJ,KAAKoG,GAAL,CAASqC,IAAT,EAAeW,UAAf,IAA6B,CAA/D,CAAP;AACH;AACJ,C;;;;;;;;;;;;;;;;;;ACrRD;;;;;;kBACegE,W;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAf;;;;AAEA;;;;;;;;;;;IAWMtL,K;AAMF,mBAAY5G,CAAZ,EAAuB+I,CAAvB,EAAkCC,CAAlC,EAA4D;AAAA,YAAfC,CAAe,uEAAH,CAAG;;AAAA;;AACxD,aAAKjJ,CAAL,GAASA,CAAT;AACA,aAAK+I,CAAL,GAASA,CAAT;AACA,aAAKC,CAAL,GAASA,CAAT;AACA,aAAKC,CAAL,GAASA,CAAT;AACH;;;;;;AAoCD;;;;;;;;;;mCAUmB;AAAA,2BACM,KAAKuB,OAAL,EADN;AAAA;AAAA,gBACRxK,CADQ;AAAA,gBACL+I,CADK;AAAA,gBACFC,CADE;AAAA,gBACCC,CADD;;AAEf,6BAAenE,KAAKoH,KAAL,CAAWlM,CAAX,CAAf,SAAgC8E,KAAKoH,KAAL,CAAWnD,CAAX,CAAhC,SAAiDjE,KAAKoH,KAAL,CAAWlD,CAAX,CAAjD,SAAkEC,CAAlE;AACH;;;kCAE2C;AAAA,gBACjCjJ,CADiC,GACnB,IADmB,CACjCA,CADiC;AAAA,gBAC9B+I,CAD8B,GACnB,IADmB,CAC9BA,CAD8B;AAAA,gBAC3BC,CAD2B,GACnB,IADmB,CAC3BA,CAD2B;AAAA,gBACxBC,CADwB,GACnB,IADmB,CACxBA,CADwB;;AAExC,mBAAOA,MAAM,CAAN,GAAU,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAV,GAAyB,CAC5BjJ,IAAI,GAAJ,GAAUiJ,CADkB,EAE5BF,IAAI,GAAJ,GAAUE,CAFkB,EAG5BD,IAAI,GAAJ,GAAUC,CAHkB,EAI5BA,CAJ4B,CAAhC;AAMH;;;;;AArDD;;;;8BAIa5E,K,EAA8B;AACvC,gBAAI,CAACA,KAAL,EAAY;AACR,uBAAO1C,SAAP;AACH;;AAED,gBAAI0C,iBAAiBuC,KAArB,EAA4B;AACxB,uBAAOvC,KAAP;AACH;;AAED,gBAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC3B,uBAAO1C,SAAP;AACH;;AAED,gBAAMmH,OAAO,mCAAczE,KAAd,CAAb;AACA,gBAAI,CAACyE,IAAL,EAAW;AACP,uBAAOnH,SAAP;AACH;;AAED,mBAAO,IAAIiF,KAAJ,CACHkC,KAAK,CAAL,IAAU,GAAV,GAAgBA,KAAK,CAAL,CADb,EAEHA,KAAK,CAAL,IAAU,GAAV,GAAgBA,KAAK,CAAL,CAFb,EAGHA,KAAK,CAAL,IAAU,GAAV,GAAgBA,KAAK,CAAL,CAHb,EAIHA,KAAK,CAAL,CAJG,CAAP;AAMH;;;;;;AA4BLlC,MAAMmR,KAAN,GAAc,IAAInR,KAAJ,CAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,CAAd;AACAA,MAAMoR,KAAN,GAAc,IAAIpR,KAAJ,CAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,CAAd;AACAA,MAAMqR,WAAN,GAAoB,IAAIrR,KAAJ,CAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,CAApB;;kBAEeA,K;;;;;;;;;;;;;;;;;;;AC1Ff;;;;AAEA;;;;AAgBA;AACA,IAAMsR,KAAK,QAAX;AAAA,IAAqB;AACjBC,KAAK,CADT;AAAA,IAEIC,KAAK,QAFT;AAAA,IAGIC,KAAK,IAAI,EAHb;AAAA,IAIIC,KAAK,IAAI,EAJb;AAAA,IAKIC,KAAK,IAAID,EAAJ,GAASA,EALlB;AAAA,IAMIE,KAAKF,KAAKA,EAAL,GAAUA,EANnB;AAAA,IAOIG,UAAU3T,KAAKiG,EAAL,GAAU,GAPxB;AAAA,IAQI2N,UAAU,MAAM5T,KAAKiG,EARzB;;AAUA;AACA,SAAS4N,OAAT,CAAiBpT,CAAjB,EAAoB;AAChB,WAAOA,IAAIiT,EAAJ,GAAS1T,KAAKoG,GAAL,CAAS3F,CAAT,EAAY,IAAI,CAAhB,CAAT,GAA8BA,IAAIgT,EAAJ,GAASF,EAA9C;AACH;;AAED,SAASO,OAAT,CAAiBrT,CAAjB,EAAoB;AAChB,WAAOA,IAAI+S,EAAJ,GAAS/S,IAAIA,CAAJ,GAAQA,CAAjB,GAAqBgT,MAAMhT,IAAI8S,EAAV,CAA5B;AACH;;AAED,SAASQ,OAAT,CAAiB1N,CAAjB,EAAoB;AAChB,WAAO,OAAOA,KAAK,SAAL,GAAiB,QAAQA,CAAzB,GAA6B,QAAQrG,KAAKoG,GAAL,CAASC,CAAT,EAAY,IAAI,GAAhB,CAAR,GAA+B,KAAnE,CAAP;AACH;;AAED,SAAS2N,OAAT,CAAiB3N,CAAjB,EAAoB;AAChBA,SAAK,GAAL;AACA,WAAOA,KAAK,OAAL,GAAeA,IAAI,KAAnB,GAA2BrG,KAAKoG,GAAL,CAAS,CAACC,IAAI,KAAL,IAAc,KAAvB,EAA8B,GAA9B,CAAlC;AACH;;AAED;AACA,SAAS4N,QAAT,CAAkBC,QAAlB,EAA6C;AACzC,QAAMhQ,IAAI8P,QAAQE,SAAShZ,CAAjB,CAAV;AAAA,QACIiJ,IAAI6P,QAAQE,SAASjQ,CAAjB,CADR;AAAA,QAEIkQ,IAAIH,QAAQE,SAAShQ,CAAjB,CAFR;AAAA,QAGImC,IAAIwN,QAAQ,CAAC,YAAY3P,CAAZ,GAAgB,YAAYC,CAA5B,GAAgC,YAAYgQ,CAA7C,IAAkDf,EAA1D,CAHR;AAAA,QAIIgB,IAAIP,QAAQ,CAAC,YAAY3P,CAAZ,GAAgB,YAAYC,CAA5B,GAAgC,YAAYgQ,CAA7C,IAAkDd,EAA1D,CAJR;AAAA,QAKIvC,IAAI+C,QAAQ,CAAC,YAAY3P,CAAZ,GAAgB,YAAYC,CAA5B,GAAgC,YAAYgQ,CAA7C,IAAkDb,EAA1D,CALR;;AAOA,WAAO;AACHa,WAAG,MAAMC,CAAN,GAAU,EADV;AAEHjQ,WAAG,OAAOkC,IAAI+N,CAAX,CAFA;AAGHlQ,WAAG,OAAOkQ,IAAItD,CAAX,CAHA;AAIH1M,eAAO8P,SAAS/P;AAJb,KAAP;AAMH;;AAED,SAASkQ,QAAT,CAAkBC,QAAlB,EAA6C;AACzC,QAAIF,IAAI,CAACE,SAASH,CAAT,GAAa,EAAd,IAAoB,GAA5B;AAAA,QACI9N,IAAIpE,MAAMqS,SAASnQ,CAAf,IAAoBiQ,CAApB,GAAwBA,IAAIE,SAASnQ,CAAT,GAAa,GADjD;AAAA,QAEI2M,IAAI7O,MAAMqS,SAASpQ,CAAf,IAAoBkQ,CAApB,GAAwBA,IAAIE,SAASpQ,CAAT,GAAa,GAFjD;AAGAkQ,QAAIf,KAAKS,QAAQM,CAAR,CAAT;AACA/N,QAAI+M,KAAKU,QAAQzN,CAAR,CAAT;AACAyK,QAAIwC,KAAKQ,QAAQhD,CAAR,CAAT;AACA,WAAO,IAAIhP,eAAJ,CACHiS,QAAQ,YAAY1N,CAAZ,GAAgB,YAAY+N,CAA5B,GAAgC,YAAYtD,CAApD,CADG,EACqD;AACxDiD,YAAQ,CAAC,SAAD,GAAa1N,CAAb,GAAiB,YAAY+N,CAA7B,GAAiC,YAAYtD,CAArD,CAFG,EAGHiD,QAAQ,YAAY1N,CAAZ,GAAgB,YAAY+N,CAA5B,GAAgC,YAAYtD,CAApD,CAHG,EAIHwD,SAASlQ,KAJN,CAAP;AAMH;;AAED,SAASmQ,cAAT,CAAwBC,IAAxB,EAAwCC,EAAxC,EAAsDhU,CAAtD,EAAiE;AAC7D,WAAO;AACH0T,WAAG,yBAAkBK,KAAKL,CAAvB,EAA0BM,GAAGN,CAA7B,EAAgC1T,CAAhC,CADA;AAEH0D,WAAG,yBAAkBqQ,KAAKrQ,CAAvB,EAA0BsQ,GAAGtQ,CAA7B,EAAgC1D,CAAhC,CAFA;AAGHyD,WAAG,yBAAkBsQ,KAAKtQ,CAAvB,EAA0BuQ,GAAGvQ,CAA7B,EAAgCzD,CAAhC,CAHA;AAIH2D,eAAO,yBAAkBoQ,KAAKpQ,KAAvB,EAA8BqQ,GAAGrQ,KAAjC,EAAwC3D,CAAxC;AAJJ,KAAP;AAMH;;AAED;AACA,SAASiU,QAAT,CAAkBR,QAAlB,EAA6C;AAAA,oBACvBD,SAASC,QAAT,CADuB;AAAA,QAClCC,CADkC,aAClCA,CADkC;AAAA,QAC/BhQ,CAD+B,aAC/BA,CAD+B;AAAA,QAC5BD,CAD4B,aAC5BA,CAD4B;;AAEzC,QAAMyQ,IAAI3U,KAAK4U,KAAL,CAAW1Q,CAAX,EAAcC,CAAd,IAAmByP,OAA7B;AACA,WAAO;AACHe,WAAGA,IAAI,CAAJ,GAAQA,IAAI,GAAZ,GAAkBA,CADlB;AAEHjT,WAAG1B,KAAKsG,IAAL,CAAUnC,IAAIA,CAAJ,GAAQD,IAAIA,CAAtB,CAFA;AAGHiQ,WAAGA,CAHA;AAIH/P,eAAO8P,SAAS/P;AAJb,KAAP;AAMH;;AAED,SAAS0Q,QAAT,CAAkBC,QAAlB,EAA6C;AACzC,QAAMH,IAAIG,SAASH,CAAT,GAAahB,OAAvB;AAAA,QACIjS,IAAIoT,SAASpT,CADjB;AAAA,QAEIyS,IAAIW,SAASX,CAFjB;AAGA,WAAOE,SAAS;AACZF,WAAGA,CADS;AAEZhQ,WAAGnE,KAAK4G,GAAL,CAAS+N,CAAT,IAAcjT,CAFL;AAGZwC,WAAGlE,KAAK2G,GAAL,CAASgO,CAAT,IAAcjT,CAHL;AAIZ0C,eAAO0Q,SAAS1Q;AAJJ,KAAT,CAAP;AAMH;;AAED,SAAS2Q,cAAT,CAAwB5Q,CAAxB,EAAmCD,CAAnC,EAA8CzD,CAA9C,EAAyD;AACrD,QAAMuU,IAAI9Q,IAAIC,CAAd;AACA,WAAOA,IAAI1D,KAAKuU,IAAI,GAAJ,IAAWA,IAAI,CAAC,GAAhB,GAAsBA,IAAI,MAAMhV,KAAKoH,KAAL,CAAW4N,IAAI,GAAf,CAAhC,GAAsDA,CAA3D,CAAX;AACH;;AAED,SAASC,cAAT,CAAwBT,IAAxB,EAAwCC,EAAxC,EAAsDhU,CAAtD,EAAiE;AAC7D,WAAO;AACHkU,WAAGI,eAAeP,KAAKG,CAApB,EAAuBF,GAAGE,CAA1B,EAA6BlU,CAA7B,CADA;AAEHiB,WAAG,yBAAkB8S,KAAK9S,CAAvB,EAA0B+S,GAAG/S,CAA7B,EAAgCjB,CAAhC,CAFA;AAGH0T,WAAG,yBAAkBK,KAAKL,CAAvB,EAA0BM,GAAGN,CAA7B,EAAgC1T,CAAhC,CAHA;AAIH2D,eAAO,yBAAkBoQ,KAAKpQ,KAAvB,EAA8BqQ,GAAGrQ,KAAjC,EAAwC3D,CAAxC;AAJJ,KAAP;AAMH;;AAEM,IAAMyU,oBAAM;AACfpC,aAASmB,QADM;AAEfpB,aAASwB,QAFM;AAGfzM,iBAAa2M;AAHE,CAAZ;;AAMA,IAAMY,oBAAM;AACfrC,aAAS4B,QADM;AAEf7B,aAASgC,QAFM;AAGfjN,iBAAaqN;AAHE,CAAZ,C;;;;;;;;;;;;;;;;;;kBCrIQ,UAAUzM,MAAV,EAA6B;AAAA,sCAAR4M,MAAQ;AAARA,cAAQ;AAAA;;AAAA;AAAA;AAAA;;AAAA;AACxC,6BAAoBA,MAApB,8HAA4B;AAAA,gBAAjB7V,KAAiB;;AACxB,iBAAK,IAAM9D,CAAX,IAAgB8D,KAAhB,EAAuB;AACnBiJ,uBAAO/M,CAAP,IAAY8D,MAAM9D,CAAN,CAAZ;AACH;AACJ;AALuC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAMxC,WAAO+M,MAAP;AACH,C;;;;;;;;;;;;;;;;;;;;kBCPuB6M,O;AAAT,SAASA,OAAT,CAAiB5J,GAAjB,EAAsB;AACjC,QAAIA,eAAezJ,MAAnB,EAA2B;AACvB,eAAO,QAAP;AACH,KAFD,MAEO,IAAIyJ,eAAejG,MAAnB,EAA2B;AAC9B,eAAO,QAAP;AACH,KAFM,MAEA,IAAIiG,eAAehG,OAAnB,EAA4B;AAC/B,eAAO,SAAP;AACH,KAFM,MAEA,IAAInI,MAAMC,OAAN,CAAckO,GAAd,CAAJ,EAAwB;AAC3B,eAAO,OAAP;AACH,KAFM,MAEA,IAAIA,QAAQ,IAAZ,EAAkB;AACrB,eAAO,MAAP;AACH,KAFM,MAEA;AACH,sBAAcA,GAAd,yCAAcA,GAAd;AACH;AACJ,C;;;;;;;;;;;;;;;;;QCXevM,M,GAAAA,M;QAIAmO,K,GAAAA,K;QASA9M,K,GAAAA,K;;AAfhB;;;;;;AAEO,SAASrB,MAAT,CAAgBiF,CAAhB,EAA2BD,CAA3B,EAAsCzD,CAAtC,EAAiD;AACpD,WAAQ0D,KAAK,IAAI1D,CAAT,CAAD,GAAiByD,IAAIzD,CAA5B;AACH;;AAEM,SAAS4M,KAAT,CAAemH,IAAf,EAA4BC,EAA5B,EAAuChU,CAAvC,EAAkD;AACrD,WAAO,IAAIqB,eAAJ,CACH5C,OAAOsV,KAAKtZ,CAAZ,EAAeuZ,GAAGvZ,CAAlB,EAAqBuF,CAArB,CADG,EAEHvB,OAAOsV,KAAKvQ,CAAZ,EAAewQ,GAAGxQ,CAAlB,EAAqBxD,CAArB,CAFG,EAGHvB,OAAOsV,KAAKtQ,CAAZ,EAAeuQ,GAAGvQ,CAAlB,EAAqBzD,CAArB,CAHG,EAIHvB,OAAOsV,KAAKrQ,CAAZ,EAAesQ,GAAGtQ,CAAlB,EAAqB1D,CAArB,CAJG,CAAP;AAMH;;AAEM,SAASF,KAAT,CAAeiU,IAAf,EAAoCC,EAApC,EAAuDhU,CAAvD,EAAkE;AACrE,WAAO+T,KAAK/Z,GAAL,CAAS,UAACua,CAAD,EAAI/Y,CAAJ,EAAU;AACtB,eAAOiD,OAAO8V,CAAP,EAAUP,GAAGxY,CAAH,CAAV,EAAiBwE,CAAjB,CAAP;AACH,KAFM,CAAP;AAGH,C;;;;;;;;;;;;;;;;;kBCpBc,CAAC,MAAD,EAAS,QAAT,EAAmB,cAAnB,EAAmC,SAAnC,EAA8C,SAA9C,EAAyD,QAAzD,EAAmE,QAAnE,C;;;;;;;;;;;;;;;;;QCWC6U,O,GAAAA,O;QAIAjY,K,GAAAA,K;AAJT,SAASiY,OAAT,CAAuB9V,KAAvB,EAA+C;AAClD,WAAO,EAAEhE,QAAQ,SAAV,EAAqBgE,YAArB,EAAP;AACH;;AAZD;;;;;;AAcO,SAASnC,KAAT,CAAqBmC,KAArB,EAA6C;AAChD,WAAO,EAAEhE,QAAQ,OAAV,EAAmBgE,YAAnB,EAAP;AACH,C;;;;;;;;;;;;;;AClBD;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA+V,OAAOC,OAAP,GAAiB3M,UAAjB;;AAEA,SAASA,UAAT,CAAoB4M,GAApB,EAAyBC,GAAzB,EAA8BC,GAA9B,EAAmCC,GAAnC,EAAwC;AACpC;AACA,SAAKC,EAAL,GAAU,MAAMJ,GAAhB;AACA,SAAKK,EAAL,GAAU,OAAOH,MAAMF,GAAb,IAAoB,KAAKI,EAAnC;AACA,SAAKE,EAAL,GAAU,MAAM,KAAKF,EAAX,GAAgB,KAAKC,EAA/B;;AAEA,SAAKE,EAAL,GAAU,MAAMN,GAAhB;AACA,SAAKO,EAAL,GAAU,OAAOL,MAAMF,GAAb,IAAoB,KAAKM,EAAnC;AACA,SAAKE,EAAL,GAAU,MAAM,KAAKF,EAAX,GAAgB,KAAKC,EAA/B;;AAEA,SAAKR,GAAL,GAAWA,GAAX;AACA,SAAKC,GAAL,GAAWE,GAAX;AACA,SAAKD,GAAL,GAAWA,GAAX;AACA,SAAKC,GAAL,GAAWA,GAAX;AACH;;AAED/M,WAAWsN,SAAX,CAAqBC,YAArB,GAAoC,UAAS3V,CAAT,EAAY;AAC5C;AACA,WAAO,CAAC,CAAC,KAAKsV,EAAL,GAAUtV,CAAV,GAAc,KAAKqV,EAApB,IAA0BrV,CAA1B,GAA8B,KAAKoV,EAApC,IAA0CpV,CAAjD;AACH,CAHD;;AAKAoI,WAAWsN,SAAX,CAAqBE,YAArB,GAAoC,UAAS5V,CAAT,EAAY;AAC5C,WAAO,CAAC,CAAC,KAAKyV,EAAL,GAAUzV,CAAV,GAAc,KAAKwV,EAApB,IAA0BxV,CAA1B,GAA8B,KAAKuV,EAApC,IAA0CvV,CAAjD;AACH,CAFD;;AAIAoI,WAAWsN,SAAX,CAAqBG,sBAArB,GAA8C,UAAS7V,CAAT,EAAY;AACtD,WAAO,CAAC,MAAM,KAAKsV,EAAX,GAAgBtV,CAAhB,GAAoB,MAAM,KAAKqV,EAAhC,IAAsCrV,CAAtC,GAA0C,KAAKoV,EAAtD;AACH,CAFD;;AAIAhN,WAAWsN,SAAX,CAAqBI,WAArB,GAAmC,UAASlQ,CAAT,EAAYmQ,OAAZ,EAAqB;AACpD,QAAI,OAAOA,OAAP,KAAmB,WAAvB,EAAoCA,UAAU,IAAV;;AAEpC,QAAIjD,EAAJ,EAAQC,EAAR,EAAYC,EAAZ,EAAgBgD,EAAhB,EAAoBxa,CAApB;;AAEA;AACA,SAAKwX,KAAKpN,CAAL,EAAQpK,IAAI,CAAjB,EAAoBA,IAAI,CAAxB,EAA2BA,GAA3B,EAAgC;;AAE5Bwa,aAAK,KAAKL,YAAL,CAAkB3C,EAAlB,IAAwBpN,CAA7B;AACA,YAAIrG,KAAKmH,GAAL,CAASsP,EAAT,IAAeD,OAAnB,EAA4B,OAAO/C,EAAP;;AAE5B,YAAIiD,KAAK,KAAKJ,sBAAL,CAA4B7C,EAA5B,CAAT;AACA,YAAIzT,KAAKmH,GAAL,CAASuP,EAAT,IAAe,IAAnB,EAAyB;;AAEzBjD,aAAKA,KAAKgD,KAAKC,EAAf;AACH;;AAED;AACAnD,SAAK,GAAL;AACAC,SAAK,GAAL;AACAC,SAAKpN,CAAL;;AAEA,QAAIoN,KAAKF,EAAT,EAAa,OAAOA,EAAP;AACb,QAAIE,KAAKD,EAAT,EAAa,OAAOA,EAAP;;AAEb,WAAOD,KAAKC,EAAZ,EAAgB;;AAEZiD,aAAK,KAAKL,YAAL,CAAkB3C,EAAlB,CAAL;AACA,YAAIzT,KAAKmH,GAAL,CAASsP,KAAKpQ,CAAd,IAAmBmQ,OAAvB,EAAgC,OAAO/C,EAAP;;AAEhC,YAAIpN,IAAIoQ,EAAR,EAAY;AACRlD,iBAAKE,EAAL;AACH,SAFD,MAEO;AACHD,iBAAKC,EAAL;AACH;;AAEDA,aAAK,CAACD,KAAKD,EAAN,IAAY,GAAZ,GAAkBA,EAAvB;AACH;;AAED;AACA,WAAOE,EAAP;AACH,CAzCD;;AA2CA5K,WAAWsN,SAAX,CAAqBrN,KAArB,GAA6B,UAASzC,CAAT,EAAYmQ,OAAZ,EAAqB;AAC9C,WAAO,KAAKH,YAAL,CAAkB,KAAKE,WAAL,CAAiBlQ,CAAjB,EAAoBmQ,OAApB,CAAlB,CAAP;AACH,CAFD,C;;;;;;;;;;;;8CCtGA;;AAEA;AACA;;AAEA;;;;;;;;;AAMA,SAAS5T,OAAT,CAAiBuB,CAAjB,EAAoBD,CAApB,EAAuB;AACrB,MAAIC,MAAMD,CAAV,EAAa;AACX,WAAO,CAAP;AACD;;AAED,MAAImC,IAAIlC,EAAEjI,MAAV;AACA,MAAIkY,IAAIlQ,EAAEhI,MAAV;;AAEA,OAAK,IAAID,IAAI,CAAR,EAAW0a,MAAM3W,KAAKiH,GAAL,CAASZ,CAAT,EAAY+N,CAAZ,CAAtB,EAAsCnY,IAAI0a,GAA1C,EAA+C,EAAE1a,CAAjD,EAAoD;AAClD,QAAIkI,EAAElI,CAAF,MAASiI,EAAEjI,CAAF,CAAb,EAAmB;AACjBoK,UAAIlC,EAAElI,CAAF,CAAJ;AACAmY,UAAIlQ,EAAEjI,CAAF,CAAJ;AACA;AACD;AACF;;AAED,MAAIoK,IAAI+N,CAAR,EAAW;AACT,WAAO,CAAC,CAAR;AACD;AACD,MAAIA,IAAI/N,CAAR,EAAW;AACT,WAAO,CAAP;AACD;AACD,SAAO,CAAP;AACD;AACD,SAASuQ,QAAT,CAAkB1S,CAAlB,EAAqB;AACnB,MAAI2S,OAAOC,MAAP,IAAiB,OAAOD,OAAOC,MAAP,CAAcF,QAArB,KAAkC,UAAvD,EAAmE;AACjE,WAAOC,OAAOC,MAAP,CAAcF,QAAd,CAAuB1S,CAAvB,CAAP;AACD;AACD,SAAO,CAAC,EAAEA,KAAK,IAAL,IAAaA,EAAE6S,SAAjB,CAAR;AACD;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIC,OAAO,mBAAAC,CAAQ,0CAAR,CAAX;AACA,IAAIC,SAASnb,OAAOoa,SAAP,CAAiBgB,cAA9B;AACA,IAAIC,SAAS9Z,MAAM6Y,SAAN,CAAgBra,KAA7B;AACA,IAAIub,qBAAsB,YAAY;AACpC,SAAO,SAASC,GAAT,GAAe,CAAE,CAAjB,CAAkBhb,IAAlB,KAA2B,KAAlC;AACD,CAFyB,EAA1B;AAGA,SAASib,SAAT,CAAoBhT,GAApB,EAAyB;AACvB,SAAOxI,OAAOoa,SAAP,CAAiBrX,QAAjB,CAA0B0Y,IAA1B,CAA+BjT,GAA/B,CAAP;AACD;AACD,SAASkT,MAAT,CAAgBC,MAAhB,EAAwB;AACtB,MAAId,SAASc,MAAT,CAAJ,EAAsB;AACpB,WAAO,KAAP;AACD;AACD,MAAI,OAAOb,OAAOc,WAAd,KAA8B,UAAlC,EAA8C;AAC5C,WAAO,KAAP;AACD;AACD,MAAI,OAAOA,YAAYF,MAAnB,KAA8B,UAAlC,EAA8C;AAC5C,WAAOE,YAAYF,MAAZ,CAAmBC,MAAnB,CAAP;AACD;AACD,MAAI,CAACA,MAAL,EAAa;AACX,WAAO,KAAP;AACD;AACD,MAAIA,kBAAkBE,QAAtB,EAAgC;AAC9B,WAAO,IAAP;AACD;AACD,MAAIF,OAAOG,MAAP,IAAiBH,OAAOG,MAAP,YAAyBF,WAA9C,EAA2D;AACzD,WAAO,IAAP;AACD;AACD,SAAO,KAAP;AACD;AACD;AACA;AACA;;AAEA,IAAIG,SAASvC,OAAOC,OAAP,GAAiBuC,EAA9B;;AAEA;AACA;AACA;AACA;;AAEA,IAAIC,QAAQ,6BAAZ;AACA;AACA,SAASC,OAAT,CAAiBC,IAAjB,EAAuB;AACrB,MAAI,CAAClB,KAAKtF,UAAL,CAAgBwG,IAAhB,CAAL,EAA4B;AAC1B;AACD;AACD,MAAIb,kBAAJ,EAAwB;AACtB,WAAOa,KAAK5b,IAAZ;AACD;AACD,MAAI6b,MAAMD,KAAKpZ,QAAL,EAAV;AACA,MAAIwS,QAAQ6G,IAAI7G,KAAJ,CAAU0G,KAAV,CAAZ;AACA,SAAO1G,SAASA,MAAM,CAAN,CAAhB;AACD;AACDwG,OAAOM,cAAP,GAAwB,SAASA,cAAT,CAAwBpV,OAAxB,EAAiC;AACvD,OAAK1G,IAAL,GAAY,gBAAZ;AACA,OAAKsR,MAAL,GAAc5K,QAAQ4K,MAAtB;AACA,OAAK/P,QAAL,GAAgBmF,QAAQnF,QAAxB;AACA,OAAKwa,QAAL,GAAgBrV,QAAQqV,QAAxB;AACA,MAAIrV,QAAQ0I,OAAZ,EAAqB;AACnB,SAAKA,OAAL,GAAe1I,QAAQ0I,OAAvB;AACA,SAAK4M,gBAAL,GAAwB,KAAxB;AACD,GAHD,MAGO;AACL,SAAK5M,OAAL,GAAe6M,WAAW,IAAX,CAAf;AACA,SAAKD,gBAAL,GAAwB,IAAxB;AACD;AACD,MAAIE,qBAAqBxV,QAAQwV,kBAAR,IAA8BC,IAAvD;AACA,MAAIzL,MAAM0L,iBAAV,EAA6B;AAC3B1L,UAAM0L,iBAAN,CAAwB,IAAxB,EAA8BF,kBAA9B;AACD,GAFD,MAEO;AACL;AACA,QAAIvL,MAAM,IAAID,KAAJ,EAAV;AACA,QAAIC,IAAI0L,KAAR,EAAe;AACb,UAAI3X,MAAMiM,IAAI0L,KAAd;;AAEA;AACA,UAAIC,UAAUX,QAAQO,kBAAR,CAAd;AACA,UAAIK,MAAM7X,IAAIsG,OAAJ,CAAY,OAAOsR,OAAnB,CAAV;AACA,UAAIC,OAAO,CAAX,EAAc;AACZ;AACA;AACA,YAAIC,YAAY9X,IAAIsG,OAAJ,CAAY,IAAZ,EAAkBuR,MAAM,CAAxB,CAAhB;AACA7X,cAAMA,IAAI+X,SAAJ,CAAcD,YAAY,CAA1B,CAAN;AACD;;AAED,WAAKH,KAAL,GAAa3X,GAAb;AACD;AACF;AACF,CAlCD;;AAoCA;AACAgW,KAAKgC,QAAL,CAAclB,OAAOM,cAArB,EAAqCpL,KAArC;;AAEA,SAASiM,QAAT,CAAkB1R,CAAlB,EAAqBhB,CAArB,EAAwB;AACtB,MAAI,OAAOgB,CAAP,KAAa,QAAjB,EAA2B;AACzB,WAAOA,EAAErL,MAAF,GAAWqK,CAAX,GAAegB,CAAf,GAAmBA,EAAEzL,KAAF,CAAQ,CAAR,EAAWyK,CAAX,CAA1B;AACD,GAFD,MAEO;AACL,WAAOgB,CAAP;AACD;AACF;AACD,SAAS2R,OAAT,CAAiBC,SAAjB,EAA4B;AAC1B,MAAI9B,sBAAsB,CAACL,KAAKtF,UAAL,CAAgByH,SAAhB,CAA3B,EAAuD;AACrD,WAAOnC,KAAKkC,OAAL,CAAaC,SAAb,CAAP;AACD;AACD,MAAIC,UAAUnB,QAAQkB,SAAR,CAAd;AACA,MAAI7c,OAAO8c,UAAU,OAAOA,OAAjB,GAA2B,EAAtC;AACA,SAAO,cAAe9c,IAAf,GAAsB,GAA7B;AACD;AACD,SAASic,UAAT,CAAoBc,IAApB,EAA0B;AACxB,SAAOJ,SAASC,QAAQG,KAAKzL,MAAb,CAAT,EAA+B,GAA/B,IAAsC,GAAtC,GACAyL,KAAKhB,QADL,GACgB,GADhB,GAEAY,SAASC,QAAQG,KAAKxb,QAAb,CAAT,EAAiC,GAAjC,CAFP;AAGD;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAAS4a,IAAT,CAAc7K,MAAd,EAAsB/P,QAAtB,EAAgC6N,OAAhC,EAAyC2M,QAAzC,EAAmDG,kBAAnD,EAAuE;AACrE,QAAM,IAAIV,OAAOM,cAAX,CAA0B;AAC9B1M,aAASA,OADqB;AAE9BkC,YAAQA,MAFsB;AAG9B/P,cAAUA,QAHoB;AAI9Bwa,cAAUA,QAJoB;AAK9BG,wBAAoBA;AALU,GAA1B,CAAN;AAOD;;AAED;AACAV,OAAOW,IAAP,GAAcA,IAAd;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASV,EAAT,CAAYvY,KAAZ,EAAmBkM,OAAnB,EAA4B;AAC1B,MAAI,CAAClM,KAAL,EAAYiZ,KAAKjZ,KAAL,EAAY,IAAZ,EAAkBkM,OAAlB,EAA2B,IAA3B,EAAiCoM,OAAOC,EAAxC;AACb;AACDD,OAAOC,EAAP,GAAYA,EAAZ;;AAEA;AACA;AACA;;AAEAD,OAAO1U,KAAP,GAAe,SAASA,KAAT,CAAewK,MAAf,EAAuB/P,QAAvB,EAAiC6N,OAAjC,EAA0C;AACvD,MAAIkC,UAAU/P,QAAd,EAAwB4a,KAAK7K,MAAL,EAAa/P,QAAb,EAAuB6N,OAAvB,EAAgC,IAAhC,EAAsCoM,OAAO1U,KAA7C;AACzB,CAFD;;AAIA;AACA;;AAEA0U,OAAOwB,QAAP,GAAkB,SAASA,QAAT,CAAkB1L,MAAlB,EAA0B/P,QAA1B,EAAoC6N,OAApC,EAA6C;AAC7D,MAAIkC,UAAU/P,QAAd,EAAwB;AACtB4a,SAAK7K,MAAL,EAAa/P,QAAb,EAAuB6N,OAAvB,EAAgC,IAAhC,EAAsCoM,OAAOwB,QAA7C;AACD;AACF,CAJD;;AAMA;AACA;;AAEAxB,OAAOyB,SAAP,GAAmB,SAASA,SAAT,CAAmB3L,MAAnB,EAA2B/P,QAA3B,EAAqC6N,OAArC,EAA8C;AAC/D,MAAI,CAAC8N,WAAW5L,MAAX,EAAmB/P,QAAnB,EAA6B,KAA7B,CAAL,EAA0C;AACxC4a,SAAK7K,MAAL,EAAa/P,QAAb,EAAuB6N,OAAvB,EAAgC,WAAhC,EAA6CoM,OAAOyB,SAApD;AACD;AACF,CAJD;;AAMAzB,OAAO2B,eAAP,GAAyB,SAASA,eAAT,CAAyB7L,MAAzB,EAAiC/P,QAAjC,EAA2C6N,OAA3C,EAAoD;AAC3E,MAAI,CAAC8N,WAAW5L,MAAX,EAAmB/P,QAAnB,EAA6B,IAA7B,CAAL,EAAyC;AACvC4a,SAAK7K,MAAL,EAAa/P,QAAb,EAAuB6N,OAAvB,EAAgC,iBAAhC,EAAmDoM,OAAO2B,eAA1D;AACD;AACF,CAJD;;AAMA,SAASD,UAAT,CAAoB5L,MAApB,EAA4B/P,QAA5B,EAAsC6b,MAAtC,EAA8CC,KAA9C,EAAqD;AACnD;AACA,MAAI/L,WAAW/P,QAAf,EAAyB;AACvB,WAAO,IAAP;AACD,GAFD,MAEO,IAAI+Y,SAAShJ,MAAT,KAAoBgJ,SAAS/Y,QAAT,CAAxB,EAA4C;AACjD,WAAO+E,QAAQgL,MAAR,EAAgB/P,QAAhB,MAA8B,CAArC;;AAEF;AACA;AACC,GALM,MAKA,IAAImZ,KAAK4C,MAAL,CAAYhM,MAAZ,KAAuBoJ,KAAK4C,MAAL,CAAY/b,QAAZ,CAA3B,EAAkD;AACvD,WAAO+P,OAAOiM,OAAP,OAAqBhc,SAASgc,OAAT,EAA5B;;AAEF;AACA;AACA;AACC,GANM,MAMA,IAAI7C,KAAK8C,QAAL,CAAclM,MAAd,KAAyBoJ,KAAK8C,QAAL,CAAcjc,QAAd,CAA7B,EAAsD;AAC3D,WAAO+P,OAAOxT,MAAP,KAAkByD,SAASzD,MAA3B,IACAwT,OAAOiJ,MAAP,KAAkBhZ,SAASgZ,MAD3B,IAEAjJ,OAAOmM,SAAP,KAAqBlc,SAASkc,SAF9B,IAGAnM,OAAO6D,SAAP,KAAqB5T,SAAS4T,SAH9B,IAIA7D,OAAOoM,UAAP,KAAsBnc,SAASmc,UAJtC;;AAMF;AACA;AACC,GATM,MASA,IAAI,CAACpM,WAAW,IAAX,IAAmB,QAAOA,MAAP,yCAAOA,MAAP,OAAkB,QAAtC,MACC/P,aAAa,IAAb,IAAqB,QAAOA,QAAP,yCAAOA,QAAP,OAAoB,QAD1C,CAAJ,EACyD;AAC9D,WAAO6b,SAAS9L,WAAW/P,QAApB,GAA+B+P,UAAU/P,QAAhD;;AAEF;AACA;AACA;AACA;AACA;AACA;AACC,GAVM,MAUA,IAAI4Z,OAAO7J,MAAP,KAAkB6J,OAAO5Z,QAAP,CAAlB,IACA0Z,UAAU3J,MAAV,MAAsB2J,UAAU1Z,QAAV,CADtB,IAEA,EAAE+P,kBAAkBqM,YAAlB,IACArM,kBAAkBsM,YADpB,CAFJ,EAGuC;AAC5C,WAAOtX,QAAQ,IAAIuX,UAAJ,CAAevM,OAAOiK,MAAtB,CAAR,EACQ,IAAIsC,UAAJ,CAAetc,SAASga,MAAxB,CADR,MAC6C,CADpD;;AAGF;AACA;AACA;AACA;AACA;AACA;AACC,GAbM,MAaA,IAAIjB,SAAShJ,MAAT,MAAqBgJ,SAAS/Y,QAAT,CAAzB,EAA6C;AAClD,WAAO,KAAP;AACD,GAFM,MAEA;AACL8b,YAAQA,SAAS,EAAC/L,QAAQ,EAAT,EAAa/P,UAAU,EAAvB,EAAjB;;AAEA,QAAIuc,cAAcT,MAAM/L,MAAN,CAAatG,OAAb,CAAqBsG,MAArB,CAAlB;AACA,QAAIwM,gBAAgB,CAAC,CAArB,EAAwB;AACtB,UAAIA,gBAAgBT,MAAM9b,QAAN,CAAeyJ,OAAf,CAAuBzJ,QAAvB,CAApB,EAAsD;AACpD,eAAO,IAAP;AACD;AACF;;AAED8b,UAAM/L,MAAN,CAAa3P,IAAb,CAAkB2P,MAAlB;AACA+L,UAAM9b,QAAN,CAAeI,IAAf,CAAoBJ,QAApB;;AAEA,WAAOwc,SAASzM,MAAT,EAAiB/P,QAAjB,EAA2B6b,MAA3B,EAAmCC,KAAnC,CAAP;AACD;AACF;;AAED,SAASW,WAAT,CAAqBpa,MAArB,EAA6B;AAC3B,SAAOnE,OAAOoa,SAAP,CAAiBrX,QAAjB,CAA0B0Y,IAA1B,CAA+BtX,MAA/B,KAA0C,oBAAjD;AACD;;AAED,SAASma,QAAT,CAAkBlW,CAAlB,EAAqBD,CAArB,EAAwBwV,MAAxB,EAAgCa,oBAAhC,EAAsD;AACpD,MAAIpW,MAAM,IAAN,IAAcA,MAAMtH,SAApB,IAAiCqH,MAAM,IAAvC,IAA+CA,MAAMrH,SAAzD,EACE,OAAO,KAAP;AACF;AACA,MAAIma,KAAKwD,WAAL,CAAiBrW,CAAjB,KAAuB6S,KAAKwD,WAAL,CAAiBtW,CAAjB,CAA3B,EACE,OAAOC,MAAMD,CAAb;AACF,MAAIwV,UAAU3d,OAAO0e,cAAP,CAAsBtW,CAAtB,MAA6BpI,OAAO0e,cAAP,CAAsBvW,CAAtB,CAA3C,EACE,OAAO,KAAP;AACF,MAAIwW,UAAUJ,YAAYnW,CAAZ,CAAd;AACA,MAAIwW,UAAUL,YAAYpW,CAAZ,CAAd;AACA,MAAKwW,WAAW,CAACC,OAAb,IAA0B,CAACD,OAAD,IAAYC,OAA1C,EACE,OAAO,KAAP;AACF,MAAID,OAAJ,EAAa;AACXvW,QAAIiT,OAAOI,IAAP,CAAYrT,CAAZ,CAAJ;AACAD,QAAIkT,OAAOI,IAAP,CAAYtT,CAAZ,CAAJ;AACA,WAAOsV,WAAWrV,CAAX,EAAcD,CAAd,EAAiBwV,MAAjB,CAAP;AACD;AACD,MAAIkB,KAAKC,WAAW1W,CAAX,CAAT;AACA,MAAI2W,KAAKD,WAAW3W,CAAX,CAAT;AACA,MAAII,GAAJ,EAASrI,CAAT;AACA;AACA;AACA,MAAI2e,GAAG1e,MAAH,KAAc4e,GAAG5e,MAArB,EACE,OAAO,KAAP;AACF;AACA0e,KAAG/Q,IAAH;AACAiR,KAAGjR,IAAH;AACA;AACA,OAAK5N,IAAI2e,GAAG1e,MAAH,GAAY,CAArB,EAAwBD,KAAK,CAA7B,EAAgCA,GAAhC,EAAqC;AACnC,QAAI2e,GAAG3e,CAAH,MAAU6e,GAAG7e,CAAH,CAAd,EACE,OAAO,KAAP;AACH;AACD;AACA;AACA,OAAKA,IAAI2e,GAAG1e,MAAH,GAAY,CAArB,EAAwBD,KAAK,CAA7B,EAAgCA,GAAhC,EAAqC;AACnCqI,UAAMsW,GAAG3e,CAAH,CAAN;AACA,QAAI,CAACud,WAAWrV,EAAEG,GAAF,CAAX,EAAmBJ,EAAEI,GAAF,CAAnB,EAA2BoV,MAA3B,EAAmCa,oBAAnC,CAAL,EACE,OAAO,KAAP;AACH;AACD,SAAO,IAAP;AACD;;AAED;AACA;;AAEAzC,OAAOiD,YAAP,GAAsB,SAASA,YAAT,CAAsBnN,MAAtB,EAA8B/P,QAA9B,EAAwC6N,OAAxC,EAAiD;AACrE,MAAI8N,WAAW5L,MAAX,EAAmB/P,QAAnB,EAA6B,KAA7B,CAAJ,EAAyC;AACvC4a,SAAK7K,MAAL,EAAa/P,QAAb,EAAuB6N,OAAvB,EAAgC,cAAhC,EAAgDoM,OAAOiD,YAAvD;AACD;AACF,CAJD;;AAMAjD,OAAOkD,kBAAP,GAA4BA,kBAA5B;AACA,SAASA,kBAAT,CAA4BpN,MAA5B,EAAoC/P,QAApC,EAA8C6N,OAA9C,EAAuD;AACrD,MAAI8N,WAAW5L,MAAX,EAAmB/P,QAAnB,EAA6B,IAA7B,CAAJ,EAAwC;AACtC4a,SAAK7K,MAAL,EAAa/P,QAAb,EAAuB6N,OAAvB,EAAgC,oBAAhC,EAAsDsP,kBAAtD;AACD;AACF;;AAGD;AACA;;AAEAlD,OAAOmD,WAAP,GAAqB,SAASA,WAAT,CAAqBrN,MAArB,EAA6B/P,QAA7B,EAAuC6N,OAAvC,EAAgD;AACnE,MAAIkC,WAAW/P,QAAf,EAAyB;AACvB4a,SAAK7K,MAAL,EAAa/P,QAAb,EAAuB6N,OAAvB,EAAgC,KAAhC,EAAuCoM,OAAOmD,WAA9C;AACD;AACF,CAJD;;AAMA;AACA;;AAEAnD,OAAOoD,cAAP,GAAwB,SAASA,cAAT,CAAwBtN,MAAxB,EAAgC/P,QAAhC,EAA0C6N,OAA1C,EAAmD;AACzE,MAAIkC,WAAW/P,QAAf,EAAyB;AACvB4a,SAAK7K,MAAL,EAAa/P,QAAb,EAAuB6N,OAAvB,EAAgC,KAAhC,EAAuCoM,OAAOoD,cAA9C;AACD;AACF,CAJD;;AAMA,SAASC,iBAAT,CAA2BvN,MAA3B,EAAmC/P,QAAnC,EAA6C;AAC3C,MAAI,CAAC+P,MAAD,IAAW,CAAC/P,QAAhB,EAA0B;AACxB,WAAO,KAAP;AACD;;AAED,MAAI9B,OAAOoa,SAAP,CAAiBrX,QAAjB,CAA0B0Y,IAA1B,CAA+B3Z,QAA/B,KAA4C,iBAAhD,EAAmE;AACjE,WAAOA,SAASgD,IAAT,CAAc+M,MAAd,CAAP;AACD;;AAED,MAAI;AACF,QAAIA,kBAAkB/P,QAAtB,EAAgC;AAC9B,aAAO,IAAP;AACD;AACF,GAJD,CAIE,OAAOsI,CAAP,EAAU;AACV;AACD;;AAED,MAAI6G,MAAMoO,aAAN,CAAoBvd,QAApB,CAAJ,EAAmC;AACjC,WAAO,KAAP;AACD;;AAED,SAAOA,SAAS2Z,IAAT,CAAc,EAAd,EAAkB5J,MAAlB,MAA8B,IAArC;AACD;;AAED,SAASyN,SAAT,CAAmBC,KAAnB,EAA0B;AACxB,MAAIje,KAAJ;AACA,MAAI;AACFie;AACD,GAFD,CAEE,OAAOnV,CAAP,EAAU;AACV9I,YAAQ8I,CAAR;AACD;AACD,SAAO9I,KAAP;AACD;;AAED,SAASke,OAAT,CAAiBC,WAAjB,EAA8BF,KAA9B,EAAqCzd,QAArC,EAA+C6N,OAA/C,EAAwD;AACtD,MAAIkC,MAAJ;;AAEA,MAAI,OAAO0N,KAAP,KAAiB,UAArB,EAAiC;AAC/B,UAAM,IAAIG,SAAJ,CAAc,qCAAd,CAAN;AACD;;AAED,MAAI,OAAO5d,QAAP,KAAoB,QAAxB,EAAkC;AAChC6N,cAAU7N,QAAV;AACAA,eAAW,IAAX;AACD;;AAED+P,WAASyN,UAAUC,KAAV,CAAT;;AAEA5P,YAAU,CAAC7N,YAAYA,SAASvB,IAArB,GAA4B,OAAOuB,SAASvB,IAAhB,GAAuB,IAAnD,GAA0D,GAA3D,KACCoP,UAAU,MAAMA,OAAhB,GAA0B,GAD3B,CAAV;;AAGA,MAAI8P,eAAe,CAAC5N,MAApB,EAA4B;AAC1B6K,SAAK7K,MAAL,EAAa/P,QAAb,EAAuB,+BAA+B6N,OAAtD;AACD;;AAED,MAAIgQ,sBAAsB,OAAOhQ,OAAP,KAAmB,QAA7C;AACA,MAAIiQ,sBAAsB,CAACH,WAAD,IAAgBxE,KAAK4E,OAAL,CAAahO,MAAb,CAA1C;AACA,MAAIiO,wBAAwB,CAACL,WAAD,IAAgB5N,MAAhB,IAA0B,CAAC/P,QAAvD;;AAEA,MAAK8d,uBACDD,mBADC,IAEDP,kBAAkBvN,MAAlB,EAA0B/P,QAA1B,CAFA,IAGAge,qBAHJ,EAG2B;AACzBpD,SAAK7K,MAAL,EAAa/P,QAAb,EAAuB,2BAA2B6N,OAAlD;AACD;;AAED,MAAK8P,eAAe5N,MAAf,IAAyB/P,QAAzB,IACD,CAACsd,kBAAkBvN,MAAlB,EAA0B/P,QAA1B,CADD,IAC0C,CAAC2d,WAAD,IAAgB5N,MAD9D,EACuE;AACrE,UAAMA,MAAN;AACD;AACF;;AAED;AACA;;AAEAkK,OAAOgE,MAAP,GAAgB,UAASR,KAAT,EAAgB,YAAYje,KAA5B,EAAmC,YAAYqO,OAA/C,EAAwD;AACtE6P,UAAQ,IAAR,EAAcD,KAAd,EAAqBje,KAArB,EAA4BqO,OAA5B;AACD,CAFD;;AAIA;AACAoM,OAAOiE,YAAP,GAAsB,UAAST,KAAT,EAAgB,YAAYje,KAA5B,EAAmC,YAAYqO,OAA/C,EAAwD;AAC5E6P,UAAQ,KAAR,EAAeD,KAAf,EAAsBje,KAAtB,EAA6BqO,OAA7B;AACD,CAFD;;AAIAoM,OAAOkE,OAAP,GAAiB,UAAS/O,GAAT,EAAc;AAAE,MAAIA,GAAJ,EAAS,MAAMA,GAAN;AAAY,CAAtD;;AAEA,IAAI4N,aAAa9e,OAAO6N,IAAP,IAAe,UAAUrF,GAAV,EAAe;AAC7C,MAAIqF,OAAO,EAAX;AACA,OAAK,IAAItF,GAAT,IAAgBC,GAAhB,EAAqB;AACnB,QAAI2S,OAAOM,IAAP,CAAYjT,GAAZ,EAAiBD,GAAjB,CAAJ,EAA2BsF,KAAK3L,IAAL,CAAUqG,GAAV;AAC5B;AACD,SAAOsF,IAAP;AACD,CAND,C;;;;;;;;;;;;ACneA;AACA;;;AAGA;AACA,kCAAmC,2BAA2B,uBAAuB,2BAA2B,GAAG,wBAAwB,aAAa,eAAe,uBAAuB,GAAG,oBAAoB,mCAAmC,uBAAuB,gBAAgB,cAAc,iBAAiB,uBAAuB,GAAG,wBAAwB,2BAA2B,qBAAqB,gBAAgB,oBAAoB,uBAAuB,gBAAgB,iCAAiC,GAAG,yBAAyB,uCAAuC,GAAG,qBAAqB,kBAAkB,GAAG,kCAAkC,gCAAgC,8BAA8B,2BAA2B,0BAA0B,sBAAsB,+CAA+C,GAAG,kBAAkB,mCAAmC,8BAA8B,2BAA2B,0BAA0B,sBAAsB,GAAG,gBAAgB,6BAA6B,0BAA0B,qBAAqB,GAAG,YAAY,iBAAiB,yBAAyB,sBAAsB,iBAAiB,GAAG,eAAe,uBAAuB,4CAA4C,uBAAuB,iBAAiB,GAAG,qBAAqB,4CAA4C,GAAG,YAAY,cAAc,eAAe,GAAG,cAAc,cAAc,gBAAgB,0DAA0D,GAAG,wBAAwB,eAAe,uBAAuB,+DAA+D,GAAG,mBAAmB,iBAAiB,eAAe,GAAG,mBAAmB,gBAAgB,cAAc,GAAG,gBAAgB,iBAAiB,oBAAoB,KAAK,GAAG,wBAAwB,mBAAmB,gBAAgB,eAAe,iBAAiB,sBAAsB,sBAAsB,0BAA0B,uBAAuB,oBAAoB,mBAAmB,sBAAsB,yCAAyC,iBAAiB,uBAAuB,GAAG,wCAAwC,iBAAiB,eAAe,GAAG,0BAA0B,uBAAuB,GAAG,eAAe,mBAAmB,wBAAwB,qBAAqB,2BAA2B,GAAG,gCAAgC,qBAAqB,GAAG,6BAA6B,eAAe,GAAG,uDAAuD,0BAA0B,yCAAyC,GAAG,wBAAwB,+BAA+B,GAAG,yBAAyB,+BAA+B,GAAG,uBAAuB,sBAAsB,iBAAiB,gBAAgB,kCAAkC,GAAG,wBAAwB,cAAc,oBAAoB,qBAAqB,yBAAyB,gBAAgB,8BAA8B,GAAG,sBAAsB,oBAAoB,qBAAqB,yBAAyB,GAAG,6CAA6C,mBAAmB,GAAG,uBAAuB,oBAAoB,uBAAuB,2BAA2B,GAAG,8CAA8C,0BAA0B,GAAG,mCAAmC,kBAAkB,GAAG,sCAAsC,sCAAsC,GAAG,oCAAoC,cAAc,aAAa,2BAA2B,kBAAkB,qBAAqB,GAAG,wCAAwC,sBAAsB,sBAAsB,GAAG,2CAA2C,kBAAkB,GAAG,oBAAoB,eAAe,eAAe,kBAAkB,GAAG,yBAAyB,uBAAuB,iBAAiB,GAAG,8BAA8B,eAAe,GAAG,qBAAqB,gBAAgB,kBAAkB,GAAG,oCAAoC,cAAc,YAAY,6BAA6B,GAAG,gEAAgE,0BAA0B,GAAG,uCAAuC,8BAA8B,kBAAkB,gBAAgB,iBAAiB,GAAG,4CAA4C,gBAAgB,cAAc,uBAAuB,GAAG,8FAA8F,kBAAkB,GAAG,sCAAsC,sCAAsC,GAAG,uBAAuB,0CAA0C,GAAG,+CAA+C,iBAAiB,GAAG;;AAEnpJ;;;;;;;;;;;;;;;ACPA;;;;AAIA;AACA2L,OAAOC,OAAP,GAAiB,UAASyG,YAAT,EAAuB;AACvC,KAAIC,OAAO,EAAX;;AAEA;AACAA,MAAKpd,QAAL,GAAgB,SAASA,QAAT,GAAoB;AACnC,SAAO,KAAKrE,GAAL,CAAS,UAAUmU,IAAV,EAAgB;AAC/B,OAAIuN,UAAUC,uBAAuBxN,IAAvB,EAA6BqN,YAA7B,CAAd;AACA,OAAGrN,KAAK,CAAL,CAAH,EAAY;AACX,WAAO,YAAYA,KAAK,CAAL,CAAZ,GAAsB,GAAtB,GAA4BuN,OAA5B,GAAsC,GAA7C;AACA,IAFD,MAEO;AACN,WAAOA,OAAP;AACA;AACD,GAPM,EAOJvd,IAPI,CAOC,EAPD,CAAP;AAQA,EATD;;AAWA;AACAsd,MAAKjgB,CAAL,GAAS,UAASogB,OAAT,EAAkBC,UAAlB,EAA8B;AACtC,MAAG,OAAOD,OAAP,KAAmB,QAAtB,EACCA,UAAU,CAAC,CAAC,IAAD,EAAOA,OAAP,EAAgB,EAAhB,CAAD,CAAV;AACD,MAAIE,yBAAyB,EAA7B;AACA,OAAI,IAAItgB,IAAI,CAAZ,EAAeA,IAAI,KAAKC,MAAxB,EAAgCD,GAAhC,EAAqC;AACpC,OAAIE,KAAK,KAAKF,CAAL,EAAQ,CAAR,CAAT;AACA,OAAG,OAAOE,EAAP,KAAc,QAAjB,EACCogB,uBAAuBpgB,EAAvB,IAA6B,IAA7B;AACD;AACD,OAAIF,IAAI,CAAR,EAAWA,IAAIogB,QAAQngB,MAAvB,EAA+BD,GAA/B,EAAoC;AACnC,OAAI2S,OAAOyN,QAAQpgB,CAAR,CAAX;AACA;AACA;AACA;AACA;AACA,OAAG,OAAO2S,KAAK,CAAL,CAAP,KAAmB,QAAnB,IAA+B,CAAC2N,uBAAuB3N,KAAK,CAAL,CAAvB,CAAnC,EAAoE;AACnE,QAAG0N,cAAc,CAAC1N,KAAK,CAAL,CAAlB,EAA2B;AAC1BA,UAAK,CAAL,IAAU0N,UAAV;AACA,KAFD,MAEO,IAAGA,UAAH,EAAe;AACrB1N,UAAK,CAAL,IAAU,MAAMA,KAAK,CAAL,CAAN,GAAgB,SAAhB,GAA4B0N,UAA5B,GAAyC,GAAnD;AACA;AACDJ,SAAKje,IAAL,CAAU2Q,IAAV;AACA;AACD;AACD,EAxBD;AAyBA,QAAOsN,IAAP;AACA,CA1CD;;AA4CA,SAASE,sBAAT,CAAgCxN,IAAhC,EAAsCqN,YAAtC,EAAoD;AACnD,KAAIE,UAAUvN,KAAK,CAAL,KAAW,EAAzB;AACA,KAAI4N,aAAa5N,KAAK,CAAL,CAAjB;AACA,KAAI,CAAC4N,UAAL,EAAiB;AAChB,SAAOL,OAAP;AACA;;AAED,KAAIF,gBAAgB,OAAOQ,IAAP,KAAgB,UAApC,EAAgD;AAC/C,MAAIC,gBAAgBC,UAAUH,UAAV,CAApB;AACA,MAAII,aAAaJ,WAAWK,OAAX,CAAmBpiB,GAAnB,CAAuB,UAAUL,MAAV,EAAkB;AACzD,UAAO,mBAAmBoiB,WAAWM,UAA9B,GAA2C1iB,MAA3C,GAAoD,KAA3D;AACA,GAFgB,CAAjB;;AAIA,SAAO,CAAC+hB,OAAD,EAAUrf,MAAV,CAAiB8f,UAAjB,EAA6B9f,MAA7B,CAAoC,CAAC4f,aAAD,CAApC,EAAqD9d,IAArD,CAA0D,IAA1D,CAAP;AACA;;AAED,QAAO,CAACud,OAAD,EAAUvd,IAAV,CAAe,IAAf,CAAP;AACA;;AAED;AACA,SAAS+d,SAAT,CAAmBI,SAAnB,EAA8B;AAC7B;AACA,KAAIC,SAASP,KAAKQ,SAASC,mBAAmBtb,KAAKC,SAAL,CAAekb,SAAf,CAAnB,CAAT,CAAL,CAAb;AACA,KAAII,OAAO,iEAAiEH,MAA5E;;AAEA,QAAO,SAASG,IAAT,GAAgB,KAAvB;AACA,C;;;;;;;;;;;;;;AC3ED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAIC,iBAAiB;AACnB,iBAAe,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,CADI,EACO,aAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CADpB;AAEnB,kBAAgB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAFG,EAEc,QAAQ,CAAC,CAAD,EAAG,GAAH,EAAO,GAAP,EAAW,CAAX,CAFtB;AAGnB,gBAAc,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAHK,EAGY,SAAS,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAHrB;AAInB,WAAS,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAJU,EAIO,UAAU,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAJjB;AAKnB,WAAS,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,CALU,EAKC,kBAAkB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CALnB;AAMnB,UAAQ,CAAC,CAAD,EAAG,CAAH,EAAK,GAAL,EAAS,CAAT,CANW,EAME,cAAc,CAAC,GAAD,EAAK,EAAL,EAAQ,GAAR,EAAY,CAAZ,CANhB;AAOnB,WAAS,CAAC,GAAD,EAAK,EAAL,EAAQ,EAAR,EAAW,CAAX,CAPU,EAOK,aAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAPlB;AAQnB,eAAa,CAAC,EAAD,EAAI,GAAJ,EAAQ,GAAR,EAAY,CAAZ,CARM,EAQU,cAAc,CAAC,GAAD,EAAK,GAAL,EAAS,CAAT,EAAW,CAAX,CARxB;AASnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,EAAT,EAAY,CAAZ,CATM,EASU,SAAS,CAAC,GAAD,EAAK,GAAL,EAAS,EAAT,EAAY,CAAZ,CATnB;AAUnB,oBAAkB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAVC,EAUgB,YAAY,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAV5B;AAWnB,aAAW,CAAC,GAAD,EAAK,EAAL,EAAQ,EAAR,EAAW,CAAX,CAXQ,EAWO,QAAQ,CAAC,CAAD,EAAG,GAAH,EAAO,GAAP,EAAW,CAAX,CAXf;AAYnB,cAAY,CAAC,CAAD,EAAG,CAAH,EAAK,GAAL,EAAS,CAAT,CAZO,EAYM,YAAY,CAAC,CAAD,EAAG,GAAH,EAAO,GAAP,EAAW,CAAX,CAZlB;AAanB,mBAAiB,CAAC,GAAD,EAAK,GAAL,EAAS,EAAT,EAAY,CAAZ,CAbE,EAac,YAAY,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAb1B;AAcnB,eAAa,CAAC,CAAD,EAAG,GAAH,EAAO,CAAP,EAAS,CAAT,CAdM,EAcO,YAAY,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAdnB;AAenB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAfM,EAeW,eAAe,CAAC,GAAD,EAAK,CAAL,EAAO,GAAP,EAAW,CAAX,CAf1B;AAgBnB,oBAAkB,CAAC,EAAD,EAAI,GAAJ,EAAQ,EAAR,EAAW,CAAX,CAhBC,EAgBc,cAAc,CAAC,GAAD,EAAK,GAAL,EAAS,CAAT,EAAW,CAAX,CAhB5B;AAiBnB,gBAAc,CAAC,GAAD,EAAK,EAAL,EAAQ,GAAR,EAAY,CAAZ,CAjBK,EAiBW,WAAW,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,CAjBtB;AAkBnB,gBAAc,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAlBK,EAkBY,gBAAgB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAlB5B;AAmBnB,mBAAiB,CAAC,EAAD,EAAI,EAAJ,EAAO,GAAP,EAAW,CAAX,CAnBE,EAmBa,iBAAiB,CAAC,EAAD,EAAI,EAAJ,EAAO,EAAP,EAAU,CAAV,CAnB9B;AAoBnB,mBAAiB,CAAC,EAAD,EAAI,EAAJ,EAAO,EAAP,EAAU,CAAV,CApBE,EAoBY,iBAAiB,CAAC,CAAD,EAAG,GAAH,EAAO,GAAP,EAAW,CAAX,CApB7B;AAqBnB,gBAAc,CAAC,GAAD,EAAK,CAAL,EAAO,GAAP,EAAW,CAAX,CArBK,EAqBU,YAAY,CAAC,GAAD,EAAK,EAAL,EAAQ,GAAR,EAAY,CAAZ,CArBtB;AAsBnB,iBAAe,CAAC,CAAD,EAAG,GAAH,EAAO,GAAP,EAAW,CAAX,CAtBI,EAsBW,WAAW,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAtBtB;AAuBnB,aAAW,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAvBQ,EAuBS,cAAc,CAAC,EAAD,EAAI,GAAJ,EAAQ,GAAR,EAAY,CAAZ,CAvBvB;AAwBnB,eAAa,CAAC,GAAD,EAAK,EAAL,EAAQ,EAAR,EAAW,CAAX,CAxBM,EAwBS,eAAe,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAxBxB;AAyBnB,iBAAe,CAAC,EAAD,EAAI,GAAJ,EAAQ,EAAR,EAAW,CAAX,CAzBI,EAyBW,WAAW,CAAC,GAAD,EAAK,CAAL,EAAO,GAAP,EAAW,CAAX,CAzBtB;AA0BnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA1BM,EA0BW,cAAc,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA1BzB;AA2BnB,UAAQ,CAAC,GAAD,EAAK,GAAL,EAAS,CAAT,EAAW,CAAX,CA3BW,EA2BI,aAAa,CAAC,GAAD,EAAK,GAAL,EAAS,EAAT,EAAY,CAAZ,CA3BjB;AA4BnB,UAAQ,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA5BW,EA4BM,SAAS,CAAC,CAAD,EAAG,GAAH,EAAO,CAAP,EAAS,CAAT,CA5Bf;AA6BnB,iBAAe,CAAC,GAAD,EAAK,GAAL,EAAS,EAAT,EAAY,CAAZ,CA7BI,EA6BY,QAAQ,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA7BpB;AA8BnB,cAAY,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA9BO,EA8BU,WAAW,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA9BrB;AA+BnB,eAAa,CAAC,GAAD,EAAK,EAAL,EAAQ,EAAR,EAAW,CAAX,CA/BM,EA+BS,UAAU,CAAC,EAAD,EAAI,CAAJ,EAAM,GAAN,EAAU,CAAV,CA/BnB;AAgCnB,WAAS,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAhCU,EAgCO,SAAS,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAhChB;AAiCnB,cAAY,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAjCO,EAiCU,iBAAiB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAjC3B;AAkCnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,CAAT,EAAW,CAAX,CAlCM,EAkCS,gBAAgB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAlCzB;AAmCnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAnCM,EAmCW,cAAc,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAnCzB;AAoCnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CApCM,EAoCW,wBAAwB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CApCnC;AAqCnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CArCM,EAqCW,cAAc,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CArCzB;AAsCnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAtCM,EAsCW,aAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAtCxB;AAuCnB,iBAAe,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAvCI,EAuCa,iBAAiB,CAAC,EAAD,EAAI,GAAJ,EAAQ,GAAR,EAAY,CAAZ,CAvC9B;AAwCnB,kBAAgB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAxCG,EAwCc,kBAAkB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAxChC;AAyCnB,oBAAkB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAzCC,EAyCgB,kBAAkB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAzClC;AA0CnB,iBAAe,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA1CI,EA0Ca,QAAQ,CAAC,CAAD,EAAG,GAAH,EAAO,CAAP,EAAS,CAAT,CA1CrB;AA2CnB,eAAa,CAAC,EAAD,EAAI,GAAJ,EAAQ,EAAR,EAAW,CAAX,CA3CM,EA2CS,SAAS,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA3ClB;AA4CnB,aAAW,CAAC,GAAD,EAAK,CAAL,EAAO,GAAP,EAAW,CAAX,CA5CQ,EA4CO,UAAU,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,CA5CjB;AA6CnB,sBAAoB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA7CD,EA6CkB,cAAc,CAAC,CAAD,EAAG,CAAH,EAAK,GAAL,EAAS,CAAT,CA7ChC;AA8CnB,kBAAgB,CAAC,GAAD,EAAK,EAAL,EAAQ,GAAR,EAAY,CAAZ,CA9CG,EA8Ca,gBAAgB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA9C7B;AA+CnB,oBAAkB,CAAC,EAAD,EAAI,GAAJ,EAAQ,GAAR,EAAY,CAAZ,CA/CC,EA+Ce,mBAAmB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA/ClC;AAgDnB,uBAAqB,CAAC,CAAD,EAAG,GAAH,EAAO,GAAP,EAAW,CAAX,CAhDF,EAgDiB,mBAAmB,CAAC,EAAD,EAAI,GAAJ,EAAQ,GAAR,EAAY,CAAZ,CAhDpC;AAiDnB,qBAAmB,CAAC,GAAD,EAAK,EAAL,EAAQ,GAAR,EAAY,CAAZ,CAjDA,EAiDgB,gBAAgB,CAAC,EAAD,EAAI,EAAJ,EAAO,GAAP,EAAW,CAAX,CAjDhC;AAkDnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAlDM,EAkDW,aAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAlDxB;AAmDnB,cAAY,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAnDO,EAmDU,eAAe,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAnDzB;AAoDnB,UAAQ,CAAC,CAAD,EAAG,CAAH,EAAK,GAAL,EAAS,CAAT,CApDW,EAoDE,WAAW,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CApDb;AAqDnB,WAAS,CAAC,GAAD,EAAK,GAAL,EAAS,CAAT,EAAW,CAAX,CArDU,EAqDK,aAAa,CAAC,GAAD,EAAK,GAAL,EAAS,EAAT,EAAY,CAAZ,CArDlB;AAsDnB,YAAU,CAAC,GAAD,EAAK,GAAL,EAAS,CAAT,EAAW,CAAX,CAtDS,EAsDM,aAAa,CAAC,GAAD,EAAK,EAAL,EAAQ,CAAR,EAAU,CAAV,CAtDnB;AAuDnB,YAAU,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAvDS,EAuDQ,iBAAiB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAvDzB;AAwDnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAxDM,EAwDW,iBAAiB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAxD5B;AAyDnB,mBAAiB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAzDE,EAyDe,cAAc,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAzD7B;AA0DnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA1DM,EA0DW,QAAQ,CAAC,GAAD,EAAK,GAAL,EAAS,EAAT,EAAY,CAAZ,CA1DnB;AA2DnB,UAAQ,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA3DW,EA2DM,QAAQ,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA3Dd;AA4DnB,gBAAc,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA5DK,EA4DY,UAAU,CAAC,GAAD,EAAK,CAAL,EAAO,GAAP,EAAW,CAAX,CA5DtB;AA6DnB,mBAAiB,CAAC,GAAD,EAAK,EAAL,EAAQ,GAAR,EAAY,CAAZ,CA7DE;AA8DnB,SAAO,CAAC,GAAD,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,CA9DY,EA8DC,aAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA9Dd;AA+DnB,eAAa,CAAC,EAAD,EAAI,GAAJ,EAAQ,GAAR,EAAY,CAAZ,CA/DM,EA+DU,eAAe,CAAC,GAAD,EAAK,EAAL,EAAQ,EAAR,EAAW,CAAX,CA/DzB;AAgEnB,YAAU,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAhES,EAgEQ,cAAc,CAAC,GAAD,EAAK,GAAL,EAAS,EAAT,EAAY,CAAZ,CAhEtB;AAiEnB,cAAY,CAAC,EAAD,EAAI,GAAJ,EAAQ,EAAR,EAAW,CAAX,CAjEO,EAiEQ,YAAY,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAjEpB;AAkEnB,YAAU,CAAC,GAAD,EAAK,EAAL,EAAQ,EAAR,EAAW,CAAX,CAlES,EAkEM,UAAU,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAlEhB;AAmEnB,aAAW,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAnEQ,EAmES,aAAa,CAAC,GAAD,EAAK,EAAL,EAAQ,GAAR,EAAY,CAAZ,CAnEtB;AAoEnB,eAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CApEM,EAoEW,aAAa,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CApExB;AAqEnB,UAAQ,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CArEW,EAqEM,eAAe,CAAC,CAAD,EAAG,GAAH,EAAO,GAAP,EAAW,CAAX,CArErB;AAsEnB,eAAa,CAAC,EAAD,EAAI,GAAJ,EAAQ,GAAR,EAAY,CAAZ,CAtEM,EAsEU,OAAO,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAtEjB;AAuEnB,UAAQ,CAAC,CAAD,EAAG,GAAH,EAAO,GAAP,EAAW,CAAX,CAvEW,EAuEI,WAAW,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAvEf;AAwEnB,YAAU,CAAC,GAAD,EAAK,EAAL,EAAQ,EAAR,EAAW,CAAX,CAxES,EAwEM,aAAa,CAAC,EAAD,EAAI,GAAJ,EAAQ,GAAR,EAAY,CAAZ,CAxEnB;AAyEnB,YAAU,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAzES,EAyEQ,SAAS,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CAzEjB;AA0EnB,WAAS,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA1EU,EA0EO,cAAc,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,CAAb,CA1ErB;AA2EnB,YAAU,CAAC,GAAD,EAAK,GAAL,EAAS,CAAT,EAAW,CAAX,CA3ES,EA2EM,eAAe,CAAC,GAAD,EAAK,GAAL,EAAS,EAAT,EAAY,CAAZ,CA3ErB,EAArB;;AA6EA,SAASC,cAAT,CAAwBphB,CAAxB,EAA2B;AAAG;AAC5BA,MAAI+D,KAAKoH,KAAL,CAAWnL,CAAX,CAAJ,CADyB,CACL;AACpB,SAAOA,IAAI,CAAJ,GAAQ,CAAR,GAAYA,IAAI,GAAJ,GAAU,GAAV,GAAgBA,CAAnC;AACD;;AAED,SAASqhB,eAAT,CAAyBvO,CAAzB,EAA4B;AAAG;AAC7B,SAAOA,IAAI,CAAJ,GAAQ,CAAR,GAAYA,IAAI,CAAJ,GAAQ,CAAR,GAAYA,CAA/B;AACD;;AAED,SAASwO,aAAT,CAAuBpF,GAAvB,EAA4B;AAAG;AAC7B,MAAIA,IAAIA,IAAIjc,MAAJ,GAAa,CAAjB,MAAwB,GAA5B,EACE,OAAOmhB,eAAeG,WAAWrF,GAAX,IAAkB,GAAlB,GAAwB,GAAvC,CAAP;AACF,SAAOkF,eAAeI,SAAStF,GAAT,CAAf,CAAP;AACD;;AAED,SAASuF,eAAT,CAAyBvF,GAAzB,EAA8B;AAAG;AAC/B,MAAIA,IAAIA,IAAIjc,MAAJ,GAAa,CAAjB,MAAwB,GAA5B,EACE,OAAOohB,gBAAgBE,WAAWrF,GAAX,IAAkB,GAAlC,CAAP;AACF,SAAOmF,gBAAgBE,WAAWrF,GAAX,CAAhB,CAAP;AACD;;AAED,SAASwF,cAAT,CAAwBC,EAAxB,EAA4BC,EAA5B,EAAgClJ,CAAhC,EAAmC;AACjC,MAAIA,IAAI,CAAR,EAAWA,KAAK,CAAL,CAAX,KACK,IAAIA,IAAI,CAAR,EAAWA,KAAK,CAAL;;AAEhB,MAAIA,IAAI,CAAJ,GAAQ,CAAZ,EAAe,OAAOiJ,KAAK,CAACC,KAAKD,EAAN,IAAYjJ,CAAZ,GAAgB,CAA5B;AACf,MAAIA,IAAI,CAAJ,GAAQ,CAAZ,EAAe,OAAOkJ,EAAP;AACf,MAAIlJ,IAAI,CAAJ,GAAQ,CAAZ,EAAe,OAAOiJ,KAAK,CAACC,KAAKD,EAAN,KAAa,IAAE,CAAF,GAAMjJ,CAAnB,IAAwB,CAApC;AACf,SAAOiJ,EAAP;AACD;;AAED,SAASE,aAAT,CAAuBC,OAAvB,EAAgC;AAC9B;AACA,MAAI5F,MAAM4F,QAAQC,OAAR,CAAgB,IAAhB,EAAsB,EAAtB,EAA0BtW,WAA1B,EAAV;;AAEA;AACA,MAAIyQ,OAAOiF,cAAX,EAA2B,OAAOA,eAAejF,GAAf,EAAoBrc,KAApB,EAAP,CALG,CAKkC;;AAEhE;AACA,MAAIqc,IAAI,CAAJ,MAAW,GAAf,EAAoB;AAClB,QAAIA,IAAIjc,MAAJ,KAAe,CAAnB,EAAsB;AACpB,UAAI+hB,KAAKR,SAAStF,IAAI+F,MAAJ,CAAW,CAAX,CAAT,EAAwB,EAAxB,CAAT,CADoB,CACmB;AACvC,UAAI,EAAED,MAAM,CAAN,IAAWA,MAAM,KAAnB,CAAJ,EAA+B,OAAO,IAAP,CAFX,CAEyB;AAC7C,aAAO,CAAE,CAACA,KAAK,KAAN,KAAgB,CAAjB,GAAuB,CAACA,KAAK,KAAN,KAAgB,CAAxC,EACEA,KAAK,IAAN,GAAe,CAACA,KAAK,IAAN,KAAe,CAD/B,EAEEA,KAAK,GAAN,GAAc,CAACA,KAAK,GAAN,KAAc,CAF7B,EAGC,CAHD,CAAP;AAID,KAPD,MAOO,IAAI9F,IAAIjc,MAAJ,KAAe,CAAnB,EAAsB;AAC3B,UAAI+hB,KAAKR,SAAStF,IAAI+F,MAAJ,CAAW,CAAX,CAAT,EAAwB,EAAxB,CAAT,CAD2B,CACY;AACvC,UAAI,EAAED,MAAM,CAAN,IAAWA,MAAM,QAAnB,CAAJ,EAAkC,OAAO,IAAP,CAFP,CAEqB;AAChD,aAAO,CAAC,CAACA,KAAK,QAAN,KAAmB,EAApB,EACC,CAACA,KAAK,MAAN,KAAiB,CADlB,EAECA,KAAK,IAFN,EAGC,CAHD,CAAP;AAID;;AAED,WAAO,IAAP;AACD;;AAED,MAAI/gB,KAAKib,IAAI7Q,OAAJ,CAAY,GAAZ,CAAT;AAAA,MAA2B6W,KAAKhG,IAAI7Q,OAAJ,CAAY,GAAZ,CAAhC;AACA,MAAIpK,OAAO,CAAC,CAAR,IAAaihB,KAAK,CAAL,KAAWhG,IAAIjc,MAAhC,EAAwC;AACtC,QAAIkiB,QAAQjG,IAAI+F,MAAJ,CAAW,CAAX,EAAchhB,EAAd,CAAZ;AACA,QAAIY,SAASqa,IAAI+F,MAAJ,CAAWhhB,KAAG,CAAd,EAAiBihB,MAAIjhB,KAAG,CAAP,CAAjB,EAA4BmhB,KAA5B,CAAkC,GAAlC,CAAb;AACA,QAAIja,QAAQ,CAAZ,CAHsC,CAGtB;AAChB,YAAQga,KAAR;AACE,WAAK,MAAL;AACE,YAAItgB,OAAO5B,MAAP,KAAkB,CAAtB,EAAyB,OAAO,IAAP;AACzBkI,gBAAQsZ,gBAAgB5f,OAAOwgB,GAAP,EAAhB,CAAR;AACA;AACF,WAAK,KAAL;AACE,YAAIxgB,OAAO5B,MAAP,KAAkB,CAAtB,EAAyB,OAAO,IAAP;AACzB,eAAO,CAACqhB,cAAczf,OAAO,CAAP,CAAd,CAAD,EACCyf,cAAczf,OAAO,CAAP,CAAd,CADD,EAECyf,cAAczf,OAAO,CAAP,CAAd,CAFD,EAGCsG,KAHD,CAAP;AAIF,WAAK,MAAL;AACE,YAAItG,OAAO5B,MAAP,KAAkB,CAAtB,EAAyB,OAAO,IAAP;AACzBkI,gBAAQsZ,gBAAgB5f,OAAOwgB,GAAP,EAAhB,CAAR;AACA;AACF,WAAK,KAAL;AACE,YAAIxgB,OAAO5B,MAAP,KAAkB,CAAtB,EAAyB,OAAO,IAAP;AACzB,YAAIyY,IAAK,CAAE6I,WAAW1f,OAAO,CAAP,CAAX,IAAwB,GAAzB,GAAgC,GAAjC,IAAwC,GAAzC,GAAgD,GAAxD,CAFF,CAEgE;AAC9D;AACA;AACA,YAAIyJ,IAAImW,gBAAgB5f,OAAO,CAAP,CAAhB,CAAR;AACA,YAAIqW,IAAIuJ,gBAAgB5f,OAAO,CAAP,CAAhB,CAAR;AACA,YAAI+f,KAAK1J,KAAK,GAAL,GAAWA,KAAK5M,IAAI,CAAT,CAAX,GAAyB4M,IAAI5M,CAAJ,GAAQ4M,IAAI5M,CAA9C;AACA,YAAIqW,KAAKzJ,IAAI,CAAJ,GAAQ0J,EAAjB;AACA,eAAO,CAACR,eAAeM,eAAeC,EAAf,EAAmBC,EAAnB,EAAuBlJ,IAAE,IAAE,CAA3B,IAAgC,GAA/C,CAAD,EACC0I,eAAeM,eAAeC,EAAf,EAAmBC,EAAnB,EAAuBlJ,CAAvB,IAA4B,GAA3C,CADD,EAEC0I,eAAeM,eAAeC,EAAf,EAAmBC,EAAnB,EAAuBlJ,IAAE,IAAE,CAA3B,IAAgC,GAA/C,CAFD,EAGCvQ,KAHD,CAAP;AAIF;AACE,eAAO,IAAP;AA7BJ;AA+BD;;AAED,SAAO,IAAP;AACD;;AAED,IAAI;AAAEoR,UAAQsI,aAAR,GAAwBA,aAAxB;AAAuC,CAA7C,CAA8C,OAAM3X,CAAN,EAAS,CAAG,C;;;;;;;;;;;;;;ACxM1D,IAAI,OAAOpK,OAAOC,MAAd,KAAyB,UAA7B,EAAyC;AACvC;AACAuZ,SAAOC,OAAP,GAAiB,SAASwD,QAAT,CAAkBuF,IAAlB,EAAwBC,SAAxB,EAAmC;AAClDD,SAAKE,MAAL,GAAcD,SAAd;AACAD,SAAKpI,SAAL,GAAiBpa,OAAOC,MAAP,CAAcwiB,UAAUrI,SAAxB,EAAmC;AAClDuI,mBAAa;AACXlf,eAAO+e,IADI;AAEXI,oBAAY,KAFD;AAGXC,kBAAU,IAHC;AAIXC,sBAAc;AAJH;AADqC,KAAnC,CAAjB;AAQD,GAVD;AAWD,CAbD,MAaO;AACL;AACAtJ,SAAOC,OAAP,GAAiB,SAASwD,QAAT,CAAkBuF,IAAlB,EAAwBC,SAAxB,EAAmC;AAClDD,SAAKE,MAAL,GAAcD,SAAd;AACA,QAAIM,WAAW,SAAXA,QAAW,GAAY,CAAE,CAA7B;AACAA,aAAS3I,SAAT,GAAqBqI,UAAUrI,SAA/B;AACAoI,SAAKpI,SAAL,GAAiB,IAAI2I,QAAJ,EAAjB;AACAP,SAAKpI,SAAL,CAAeuI,WAAf,GAA6BH,IAA7B;AACD,GAND;AAOD,C;;;;;;;;;;;;;;ACtBD,IAAIQ,cAAc;AAChBC,QAAM,GADU;AAEhBC,YAAU,GAFM;AAGhB,iBAAe,GAHC;AAIhB,iBAAe,GAJC;AAKhBC,SAAO,GALS;AAMhBC,QAAM,GANU;AAOhBC,WAAS,GAPO;AAQhBC,UAAQ,GARQ;AAShBC,SAAO,GATS;AAUhBC,SAAO,GAVS;AAWhBC,YAAU,GAXM;AAYhBC,UAAQ,GAZQ;AAahB,eAAa,GAbG;AAchB,eAAa,GAdG;AAehBC,QAAM,GAfU;AAgBhBC,SAAO,GAhBS;AAiBhB1M,SAAO,GAjBS;AAkBhB,gBAAc,GAlBE;AAmBhB,iBAAe,GAnBC;AAoBhB,iBAAe,GApBC;AAqBhB,gBAAc,GArBE;AAsBhB,iBAAe,GAtBC;AAuBhB2M,OAAK,GAvBW;AAwBhBC,UAAQ;AAxBQ,CAAlB;AA0BA,IAAIC,KAAK,GAAT;AACA,IAAIC,WAAW,oBAAf;;AAEA,IAAIC,YAAY,EAAhB;;AAEAzK,OAAOC,OAAP,GAAiB,UAASyK,KAAT,EAAgBC,IAAhB,EAAsB;AACrC,MAAIC,UAAUH,UAAUC,KAAV,CAAd;AACA,MAAI,CAACE,OAAL,EAAc;AACZ,QAAI,CAAC7iB,MAAMC,OAAN,CAAc0iB,KAAd,CAAL,EAA2B;AACzBA,cAAQ,CAACA,KAAD,CAAR;AACD;AACD,QAAIG,SAAS,QAAb;AACA,QAAIC,QAAQ,QAAZ;AACA,QAAIC,eAAe,EAAnB;AACA,QAAIC,UAAJ,EAAgBC,SAAhB;AACA,SAAK,IAAIvkB,IAAI,CAAR,EAAWwkB,KAAKR,MAAM/jB,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,UAAIykB,OAAOT,MAAMhkB,CAAN,CAAX;AACA,UAAI0kB,QAAQD,KAAKrC,KAAL,CAAW,GAAX,CAAZ;AACA,UAAIuC,cAAcD,MAAMA,MAAMzkB,MAAN,GAAe,CAArB,EAAwBwL,WAAxB,EAAlB;AACA,UAAIkZ,eAAe,QAAf,IAA2BA,eAAe,QAA1C,IAAsDA,eAAe,SAAzE,EAAoF;AAClFP,gBAAQG,YAAYH,KAAZ,GAAoBO,WAA5B;AACAD,cAAMrC,GAAN;AACAsC,sBAAcD,MAAMA,MAAMzkB,MAAN,GAAe,CAArB,EAAwBwL,WAAxB,EAAd;AACD,OAJD,MAIO,IAAIqY,SAASlf,IAAT,CAAc+f,WAAd,CAAJ,EAAgC;AACrCA,sBAAcA,YAAY5C,OAAZ,CAAoB+B,QAApB,EAA8B,EAA9B,CAAd;AACAM,gBAAQG,YAAYH,KAAZ,GAAoBM,MAAMA,MAAMzkB,MAAN,GAAe,CAArB,EAAwB8hB,OAAxB,CAAgC4C,WAAhC,EAA6C,EAA7C,CAA5B;AACD;AACD,WAAK,IAAIC,CAAT,IAAc9B,WAAd,EAA2B;AACzB,YAAI6B,eAAeC,CAAf,IAAoBD,eAAeC,EAAE7C,OAAF,CAAU,GAAV,EAAe,EAAf,CAAnC,IAAyD4C,eAAeC,EAAE7C,OAAF,CAAU,GAAV,EAAe8B,EAAf,CAA5E,EAAgG;AAC9FM,mBAASG,aAAaH,MAAb,GAAsBrB,YAAY8B,CAAZ,CAA/B;AACAF,gBAAMrC,GAAN;AACA;AACD;AACF;AACD,UAAI,CAACiC,UAAD,IAAe,OAAOK,WAAP,IAAsB,QAAzC,EAAmD;AACjDR,iBAASQ,WAAT;AACD;AACD,UAAIE,aAAaH,MAAM/hB,IAAN,CAAWkhB,EAAX,EACZ9B,OADY,CACJ,sBADI,EACoB,WADpB,CAAjB;AAEA,UAAI8C,WAAWxZ,OAAX,CAAmBwY,EAAnB,MAA2B,CAAC,CAAhC,EAAmC;AACjCgB,qBAAa,MAAMA,UAAN,GAAmB,GAAhC;AACD;AACDR,mBAAariB,IAAb,CAAkB6iB,UAAlB;AACD;AACD;AACAX,cAAUH,UAAUC,KAAV,IAAmB,CAACI,KAAD,EAAQD,MAAR,EAAgBE,YAAhB,CAA7B;AACD;AACD,SAAOH,QAAQ,CAAR,IAAaL,EAAb,GAAkBK,QAAQ,CAAR,CAAlB,GAA+BL,EAA/B,GAAoCI,IAApC,GAA2C,IAA3C,GAAkDJ,EAAlD,GAAuDK,QAAQ,CAAR,CAA9D;AACD,CA3CD,C;;;;;;;;;;;;;;;;;;AC5BA;;AAEA;;;;;;;;AAQA,IAAM/H,iBAAiB,SAAjBA,cAAiB,CAAS2I,IAAT,EAAe;;AAEpC,MAAM1iB,OAAO2iB,iBAAUA,eAAQ3C,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAV,GAAkC,QAA/C;;AAEA;;;AAGA,OAAK3S,OAAL,GAAe,qDAAqDrN,IAArD,GACX,eADW,GACO0iB,IADP,GACc,eAD7B;;AAGA;;;;;;;;AAQA,OAAKA,IAAL,GAAYA,IAAZ;;AAEA,OAAKzkB,IAAL,GAAY,gBAAZ;AAED,CAtBD,C,CAbA;;;;;AAqCA,qBAAS8b,cAAT,EAAyBpL,KAAzB;;kBAEeoL,c;;;;;;;;;;;;;;;;;;;ACpCf;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAGA;;;;AAIA,IAAM6I,WAAW;AACfC,UAAQ;AADO,CAAjB;;AAKA;;;;;;;;;;AAnBA;;;AA6BO,IAAMC,4CAAkB,SAAlBA,eAAkB,CAAS5kB,IAAT,EAAe6kB,WAAf,EAA4B;;AAEzDC,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAK+kB,OAAL,GAAeF,WAAf;AAED,CAXM;;AAaP,qBAASD,eAAT,EAA0BE,eAA1B;;AAGA;;;;;;AAMA;;;;;;;;;;;;;;;;AAgBA,IAAME,aAAa,SAAbA,UAAa,CAASC,SAAT,EAAoBC,WAApB,EAAiC;;AAElDC,mBAAWlK,IAAX,CAAgB,IAAhB;;AAEA,MAAMxU,UAAUye,eAAe,EAA/B;;AAEA;;;;AAIA,OAAKE,OAAL,GAAe,CAAC,CAAC3e,QAAQ4e,MAAzB;;AAEA;;;;AAIA,OAAKC,MAAL,GAAcL,YAAYA,SAAZ,GAAwB,EAAtC;;AAEA,MAAI,KAAKG,OAAT,EAAkB;AAChB,SAAK,IAAI1lB,IAAI,CAAR,EAAWwkB,KAAK,KAAKoB,MAAL,CAAY3lB,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiD,EAAExkB,CAAnD,EAAsD;AACpD,WAAK6lB,aAAL,CAAmB,KAAKD,MAAL,CAAY5lB,CAAZ,CAAnB,EAAmCA,CAAnC;AACD;AACF;;AAED,OAAK8lB,aAAL;AAED,CA1BD;;AA4BA,qBAASR,UAAT,EAAqBG,gBAArB;;AAGA;;;;AAIAH,WAAWpL,SAAX,CAAqB6L,KAArB,GAA6B,YAAW;AACtC,SAAO,KAAKC,SAAL,KAAmB,CAA1B,EAA6B;AAC3B,SAAK3D,GAAL;AACD;AACF,CAJD;;AAOA;;;;;;;AAOAiD,WAAWpL,SAAX,CAAqB+L,MAArB,GAA8B,UAASC,GAAT,EAAc;AAC1C,OAAK,IAAIlmB,IAAI,CAAR,EAAWwkB,KAAK0B,IAAIjmB,MAAzB,EAAiCD,IAAIwkB,EAArC,EAAyC,EAAExkB,CAA3C,EAA8C;AAC5C,SAAKgC,IAAL,CAAUkkB,IAAIlmB,CAAJ,CAAV;AACD;AACD,SAAO,IAAP;AACD,CALD;;AAQA;;;;;;;AAOAslB,WAAWpL,SAAX,CAAqBxa,OAArB,GAA+B,UAASoT,CAAT,EAAY;AACzC,MAAMxO,QAAQ,KAAKshB,MAAnB;AACA,OAAK,IAAI5lB,IAAI,CAAR,EAAWwkB,KAAKlgB,MAAMrE,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C8S,MAAExO,MAAMtE,CAAN,CAAF,EAAYA,CAAZ,EAAesE,KAAf;AACD;AACF,CALD;;AAQA;;;;;;;;AAQAghB,WAAWpL,SAAX,CAAqBiM,QAArB,GAAgC,YAAW;AACzC,SAAO,KAAKP,MAAZ;AACD,CAFD;;AAKA;;;;;;AAMAN,WAAWpL,SAAX,CAAqBvH,IAArB,GAA4B,UAAStO,KAAT,EAAgB;AAC1C,SAAO,KAAKuhB,MAAL,CAAYvhB,KAAZ,CAAP;AACD,CAFD;;AAKA;;;;;;AAMAihB,WAAWpL,SAAX,CAAqB8L,SAArB,GAAiC,YAAW;AAC1C,SAAO,sBAAuB,KAAKzd,GAAL,CAASyc,SAASC,MAAlB;AAA9B;AACD,CAFD;;AAKA;;;;;;AAMAK,WAAWpL,SAAX,CAAqBkM,QAArB,GAAgC,UAAS/hB,KAAT,EAAgBgiB,IAAhB,EAAsB;AACpD,MAAI,KAAKX,OAAT,EAAkB;AAChB,SAAKG,aAAL,CAAmBQ,IAAnB;AACD;AACD,OAAKT,MAAL,CAAYU,MAAZ,CAAmBjiB,KAAnB,EAA0B,CAA1B,EAA6BgiB,IAA7B;AACA,OAAKP,aAAL;AACA,OAAKS,aAAL,CACE,IAAIrB,eAAJ,CAAoBsB,8BAAoBC,GAAxC,EAA6CJ,IAA7C,CADF;AAED,CARD;;AAWA;;;;;;AAMAf,WAAWpL,SAAX,CAAqBmI,GAArB,GAA2B,YAAW;AACpC,SAAO,KAAKqE,QAAL,CAAc,KAAKV,SAAL,KAAmB,CAAjC,CAAP;AACD,CAFD;;AAKA;;;;;;AAMAV,WAAWpL,SAAX,CAAqBlY,IAArB,GAA4B,UAASqkB,IAAT,EAAe;AACzC,MAAI,KAAKX,OAAT,EAAkB;AAChB,SAAKG,aAAL,CAAmBQ,IAAnB;AACD;AACD,MAAM/b,IAAI,KAAK0b,SAAL,EAAV;AACA,OAAKI,QAAL,CAAc9b,CAAd,EAAiB+b,IAAjB;AACA,SAAO,KAAKL,SAAL,EAAP;AACD,CAPD;;AAUA;;;;;;AAMAV,WAAWpL,SAAX,CAAqByM,MAArB,GAA8B,UAASN,IAAT,EAAe;AAC3C,MAAMH,MAAM,KAAKN,MAAjB;AACA,OAAK,IAAI5lB,IAAI,CAAR,EAAWwkB,KAAK0B,IAAIjmB,MAAzB,EAAiCD,IAAIwkB,EAArC,EAAyC,EAAExkB,CAA3C,EAA8C;AAC5C,QAAIkmB,IAAIlmB,CAAJ,MAAWqmB,IAAf,EAAqB;AACnB,aAAO,KAAKK,QAAL,CAAc1mB,CAAd,CAAP;AACD;AACF;AACD,SAAOY,SAAP;AACD,CARD;;AAWA;;;;;;;AAOA0kB,WAAWpL,SAAX,CAAqBwM,QAArB,GAAgC,UAASriB,KAAT,EAAgB;AAC9C,MAAMuiB,OAAO,KAAKhB,MAAL,CAAYvhB,KAAZ,CAAb;AACA,OAAKuhB,MAAL,CAAYU,MAAZ,CAAmBjiB,KAAnB,EAA0B,CAA1B;AACA,OAAKyhB,aAAL;AACA,OAAKS,aAAL,CAAmB,IAAIrB,eAAJ,CAAoBsB,8BAAoBK,MAAxC,EAAgDD,IAAhD,CAAnB;AACA,SAAOA,IAAP;AACD,CAND;;AASA;;;;;;AAMAtB,WAAWpL,SAAX,CAAqB4M,KAArB,GAA6B,UAASziB,KAAT,EAAgBgiB,IAAhB,EAAsB;AACjD,MAAM/b,IAAI,KAAK0b,SAAL,EAAV;AACA,MAAI3hB,QAAQiG,CAAZ,EAAe;AACb,QAAI,KAAKob,OAAT,EAAkB;AAChB,WAAKG,aAAL,CAAmBQ,IAAnB,EAAyBhiB,KAAzB;AACD;AACD,QAAMuiB,OAAO,KAAKhB,MAAL,CAAYvhB,KAAZ,CAAb;AACA,SAAKuhB,MAAL,CAAYvhB,KAAZ,IAAqBgiB,IAArB;AACA,SAAKE,aAAL,CACE,IAAIrB,eAAJ,CAAoBsB,8BAAoBK,MAAxC,EAAgDD,IAAhD,CADF;AAEA,SAAKL,aAAL,CACE,IAAIrB,eAAJ,CAAoBsB,8BAAoBC,GAAxC,EAA6CJ,IAA7C,CADF;AAED,GAVD,MAUO;AACL,SAAK,IAAInd,IAAIoB,CAAb,EAAgBpB,IAAI7E,KAApB,EAA2B,EAAE6E,CAA7B,EAAgC;AAC9B,WAAKkd,QAAL,CAAcld,CAAd,EAAiBtI,SAAjB;AACD;AACD,SAAKwlB,QAAL,CAAc/hB,KAAd,EAAqBgiB,IAArB;AACD;AACF,CAlBD;;AAqBA;;;AAGAf,WAAWpL,SAAX,CAAqB4L,aAArB,GAAqC,YAAW;AAC9C,OAAKiB,GAAL,CAAS/B,SAASC,MAAlB,EAA0B,KAAKW,MAAL,CAAY3lB,MAAtC;AACD,CAFD;;AAKA;;;;;AAKAqlB,WAAWpL,SAAX,CAAqB2L,aAArB,GAAqC,UAASQ,IAAT,EAAeW,UAAf,EAA2B;AAC9D,OAAK,IAAIhnB,IAAI,CAAR,EAAWwkB,KAAK,KAAKoB,MAAL,CAAY3lB,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiD,EAAExkB,CAAnD,EAAsD;AACpD,QAAI,KAAK4lB,MAAL,CAAY5lB,CAAZ,MAAmBqmB,IAAnB,IAA2BrmB,MAAMgnB,UAArC,EAAiD;AAC/C,YAAM,IAAI7K,wBAAJ,CAAmB,EAAnB,CAAN;AACD;AACF;AACF,CAND;;kBAQemJ,U;;;;;;;;;;;;;;;;;AC3Sf;;;;AAIA;;;kBAGe;AACb;;;;;AAKAmB,OAAK,KANQ;AAOb;;;;;AAKAI,UAAQ;AAZK,C;;;;;;;;;;;;;;;;;;ACJf;;AAEA;;;;AAIA,IAAMI,aAAa,SAAbA,UAAa,GAAW,CAAE,CAAhC;;AAEA;;;;;AAXA;;;AAgBAA,WAAW/M,SAAX,CAAqBgN,SAArB,GAAiC,KAAjC;;AAEA;;;AAGAD,WAAW/M,SAAX,CAAqBiN,OAArB,GAA+B,YAAW;AACxC,MAAI,CAAC,KAAKD,SAAV,EAAqB;AACnB,SAAKA,SAAL,GAAiB,IAAjB;AACA,SAAKE,eAAL;AACD;AACF,CALD;;AAOA;;;;AAIAH,WAAW/M,SAAX,CAAqBkN,eAArB,GAAuCC,oBAAvC;kBACeJ,U;;;;;;;;;;;;;;;;;QCmQCK,mB,GAAAA,mB;;AAjShB;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA,IAAMC,UAAU,SAAVA,OAAU,CAASC,wBAAT,EAAmC;;AAEjD/B,mBAAWlK,IAAX,CAAgB,IAAhB;;AAEA;;;;AAIA,OAAKkM,GAAL,GAAW7mB,SAAX;;AAEA;;;;AAIA,OAAK8mB,aAAL,GAAqB,UAArB;;AAEA;;;;;AAKA,OAAKC,MAAL,GAAc,IAAd;;AAEA;;;;AAIA,OAAKC,cAAL,GAAsBhnB,SAAtB;;AAEA;;;;AAIA,OAAKinB,kBAAL,GAA0B,IAA1B;;AAEA,sBACE,IADF,EACQ,gCAAmB,KAAKH,aAAxB,CADR,EAEE,KAAKI,sBAFP,EAE+B,IAF/B;;AAIA,MAAIN,6BAA6B5mB,SAAjC,EAA4C;AAC1C,QAAI4mB,oCAAoCO,kBAApC,IACA,CAACP,wBADL,EAC+B;AAC7B,UAAMQ,WAAWR,wBAAjB;AACA,WAAKS,WAAL,CAAiBD,QAAjB;AACD,KAJD,MAIO;AACL;AACA,UAAMte,aAAa8d,wBAAnB;AACA,WAAKU,aAAL,CAAmBxe,UAAnB;AACD;AACF;AACF,CAlDD,C,CA7DA;;;;;AAiHA,qBAAS6d,OAAT,EAAkB9B,gBAAlB;;AAGA;;;;;;AAMA8B,QAAQrN,SAAR,CAAkBiO,KAAlB,GAA0B,YAAW;AACnC,MAAMA,QAAQ,IAAIZ,OAAJ,CAAY,KAAKa,aAAL,EAAZ,CAAd;AACAD,QAAME,eAAN,CAAsB,KAAKC,eAAL,EAAtB;AACA,MAAMN,WAAW,KAAKO,WAAL,EAAjB;AACA,MAAIP,QAAJ,EAAc;AACZG,UAAMF,WAAN,CAAkBD,SAASG,KAAT,EAAlB;AACD;AACD,MAAM/D,QAAQ,KAAKoE,QAAL,EAAd;AACA,MAAIpE,KAAJ,EAAW;AACT+D,UAAMM,QAAN,CAAerE,KAAf;AACD;AACD,SAAO+D,KAAP;AACD,CAZD;;AAeA;;;;;;;;AAQAZ,QAAQrN,SAAR,CAAkBqO,WAAlB,GAAgC,YAAW;AACzC;AACE,oDAAkD,KAAKhgB,GAAL,CAAS,KAAKmf,aAAd;AADpD;AAGD,CAJD;;AAOA;;;;;;;AAOAH,QAAQrN,SAAR,CAAkBwO,KAAlB,GAA0B,YAAW;AACnC,SAAO,KAAKjB,GAAZ;AACD,CAFD;;AAKA;;;;;;;AAOAF,QAAQrN,SAAR,CAAkBoO,eAAlB,GAAoC,YAAW;AAC7C,SAAO,KAAKZ,aAAZ;AACD,CAFD;;AAKA;;;;;;AAMAH,QAAQrN,SAAR,CAAkBsO,QAAlB,GAA6B,YAAW;AACtC,SAAO,KAAKb,MAAZ;AACD,CAFD;;AAKA;;;;;;AAMAJ,QAAQrN,SAAR,CAAkByO,gBAAlB,GAAqC,YAAW;AAC9C,SAAO,KAAKf,cAAZ;AACD,CAFD;;AAKA;;;AAGAL,QAAQrN,SAAR,CAAkB0O,qBAAlB,GAA0C,YAAW;AACnD,OAAKC,OAAL;AACD,CAFD;;AAKA;;;AAGAtB,QAAQrN,SAAR,CAAkB4N,sBAAlB,GAA2C,YAAW;AACpD,MAAI,KAAKD,kBAAT,EAA6B;AAC3B,+BAAc,KAAKA,kBAAnB;AACA,SAAKA,kBAAL,GAA0B,IAA1B;AACD;AACD,MAAMG,WAAW,KAAKO,WAAL,EAAjB;AACA,MAAIP,QAAJ,EAAc;AACZ,SAAKH,kBAAL,GAA0B,oBAAOG,QAAP,EACxBc,oBAAUC,MADc,EACN,KAAKH,qBADC,EACsB,IADtB,CAA1B;AAED;AACD,OAAKC,OAAL;AACD,CAXD;;AAcA;;;;;;;AAOAtB,QAAQrN,SAAR,CAAkB+N,WAAlB,GAAgC,UAASD,QAAT,EAAmB;AACjD,OAAKjB,GAAL,CAAS,KAAKW,aAAd,EAA6BM,QAA7B;AACD,CAFD;;AAKA;;;;;;;;AAQAT,QAAQrN,SAAR,CAAkBuO,QAAlB,GAA6B,UAASrE,KAAT,EAAgB;AAC3C,OAAKuD,MAAL,GAAcvD,KAAd;AACA,OAAKwD,cAAL,GAAsB,CAACxD,KAAD,GAASxjB,SAAT,GAAqB0mB,oBAAoBlD,KAApB,CAA3C;AACA,OAAKyE,OAAL;AACD,CAJD;;AAOA;;;;;;;;;AASAtB,QAAQrN,SAAR,CAAkB8O,KAAlB,GAA0B,UAAS9oB,EAAT,EAAa;AACrC,OAAKunB,GAAL,GAAWvnB,EAAX;AACA,OAAK2oB,OAAL;AACD,CAHD;;AAMA;;;;;;;AAOAtB,QAAQrN,SAAR,CAAkBmO,eAAlB,GAAoC,UAAShoB,IAAT,EAAe;AACjD,wBACE,IADF,EACQ,gCAAmB,KAAKqnB,aAAxB,CADR,EAEE,KAAKI,sBAFP,EAE+B,IAF/B;AAGA,OAAKJ,aAAL,GAAqBrnB,IAArB;AACA,sBACE,IADF,EACQ,gCAAmB,KAAKqnB,aAAxB,CADR,EAEE,KAAKI,sBAFP,EAE+B,IAF/B;AAGA,OAAKA,sBAAL;AACD,CATD;;AAYA;;;;;;;;AAQO,SAASR,mBAAT,CAA6Bhf,GAA7B,EAAkC;AACvC,MAAI,OAAOA,GAAP,KAAe,UAAnB,EAA+B;AAC7B,WAAOA,GAAP;AACD,GAFD,MAEO;AACL;;;AAGA,QAAI2gB,eAAJ;AACA,QAAI5nB,MAAMC,OAAN,CAAcgH,GAAd,CAAJ,EAAwB;AACtB2gB,eAAS3gB,GAAT;AACD,KAFD,MAEO;AACL,2BAAOA,eAAe4gB,eAAtB,EACE,EADF,EADK,CAEE;AACPD,eAAS,CAAC3gB,GAAD,CAAT;AACD;AACD,WAAO,YAAW;AAChB,aAAO2gB,MAAP;AACD,KAFD;AAGD;AACF;kBACc1B,O;;;;;;;;;;;;;;;;;;ACrTf;;AACA;;;;AACA;;;;;;AAEA;;;;;;;;;AASA,IAAM4B,YAAY,SAAZA,SAAY,CAASC,MAAT,EAAiBC,UAAjB,EAA6BC,UAA7B,EAAyCC,KAAzC,EAAgD;;AAEhEC,wBAAYjO,IAAZ,CAAiB,IAAjB;;AAEA;;;;AAIA,OAAK6N,MAAL,GAAcA,MAAd;;AAEA;;;;AAIA,OAAKK,WAAL,GAAmBH,UAAnB;;AAEA;;;;AAIA,OAAKD,UAAL,GAAkBA,UAAlB;;AAEA;;;;AAIA,OAAKE,KAAL,GAAaA,KAAb;AAED,CA5BD,C,CAhBA;;;;;AA8CA,qBAASJ,SAAT,EAAoBK,qBAApB;;AAGA;;;AAGAL,UAAUjP,SAAV,CAAoB2O,OAApB,GAA8B,YAAW;AACvC,OAAKtC,aAAL,CAAmBuC,oBAAUC,MAA7B;AACD,CAFD;;AAKA;;;AAGAI,UAAUjP,SAAV,CAAoBwP,SAApB,GAAgC,YAAW;AACzC,SAAO,KAAKN,MAAZ;AACD,CAFD;;AAKA;;;;AAIAD,UAAUjP,SAAV,CAAoByP,QAApB,GAA+B,YAAW,CAAE,CAA5C;;AAGA;;;AAGAR,UAAUjP,SAAV,CAAoB0P,aAApB,GAAoC,YAAW;AAC7C,SAAO,KAAKH,WAAZ;AACD,CAFD;;AAKA;;;AAGAN,UAAUjP,SAAV,CAAoB2P,aAApB,GAAoC,YAAW;AAC7C,SAAO,sBAAuB,KAAKR;AAAnC;AACD,CAFD;;AAKA;;;AAGAF,UAAUjP,SAAV,CAAoB4P,QAApB,GAA+B,YAAW;AACxC,SAAO,KAAKP,KAAZ;AACD,CAFD;;AAKA;;;;AAIAJ,UAAUjP,SAAV,CAAoB6P,IAApB,GAA2B,YAAW,CAAE,CAAxC;;kBAEeZ,S;;;;;;;;;;;;;;;;;;ACnGf;;AACA;;;;AACA;;;;;;AAGA;;;;;;;;;AAUA;;;;;;;;;;AAUA,IAAMa,cAAc,SAAdA,WAAc,CAASZ,MAAT,EAAiBC,UAAjB,EAA6BC,UAA7B,EAAyCW,MAAzC,EAAiDC,UAAjD,EAA6D;;AAE/E;;;;;AAKA,OAAKC,OAAL,GAAeD,eAAetpB,SAAf,GAA2BspB,UAA3B,GAAwC,IAAvD;;AAEA,MAAMX,QAAQW,eAAetpB,SAAf,GAA2BwpB,qBAAWC,IAAtC,GAA6CD,qBAAWE,MAAtE;;AAEAnB,sBAAU5N,IAAV,CAAe,IAAf,EAAqB6N,MAArB,EAA6BC,UAA7B,EAAyCC,UAAzC,EAAqDC,KAArD;;AAEA;;;;AAIA,OAAKgB,OAAL,GAAeN,MAAf;;AAEA;;;;AAIA,OAAKO,MAAL,GAAc,IAAd;AAED,CAzBD,C,CA5BA;;;;;AAuDA,qBAASR,WAAT,EAAsBb,mBAAtB;;AAGA;;;;AAIAa,YAAY9P,SAAZ,CAAsBuQ,QAAtB,GAAiC,YAAW;AAC1C,SAAO,KAAKD,MAAZ;AACD,CAFD;;AAKA;;;;;AAKAR,YAAY9P,SAAZ,CAAsBwQ,WAAtB,GAAoC,UAAS1Z,GAAT,EAAc;AAChD,MAAIA,GAAJ,EAAS;AACP,SAAKwZ,MAAL,GAAcxZ,GAAd;AACA,SAAKuY,KAAL,GAAaa,qBAAWO,KAAxB;AACD,GAHD,MAGO;AACL,SAAKpB,KAAL,GAAaa,qBAAWE,MAAxB;AACD;AACD,OAAKzB,OAAL;AACD,CARD;;AAWA;;;AAGAmB,YAAY9P,SAAZ,CAAsB6P,IAAtB,GAA6B,YAAW;AACtC,MAAI,KAAKR,KAAL,IAAca,qBAAWC,IAA7B,EAAmC;AACjC,SAAKd,KAAL,GAAaa,qBAAWQ,OAAxB;AACA,SAAK/B,OAAL;AACA,SAAKsB,OAAL,CAAa,KAAKO,WAAL,CAAiBpU,IAAjB,CAAsB,IAAtB,CAAb;AACD;AACF,CAND;;AASA;;;AAGA0T,YAAY9P,SAAZ,CAAsByP,QAAtB,GAAiC,YAAW;AAC1C,SAAO,KAAKY,OAAZ;AACD,CAFD;kBAGeP,W;;;;;;;;;;;;;;;;;ACrGf;;;;AAIA;;;kBAGe;AACbK,QAAM,CADO;AAEbO,WAAS,CAFI;AAGbN,UAAQ,CAHK;AAIbK,SAAO;AAJM,C;;;;;;;;;;;;;;;;;ACPf;;;;AAIA;;;;;;;;;;;;AAYA,IAAME,UAAU,SAAVA,OAAU,CAASC,KAAT,EAAgBC,WAAhB,EAA6BC,KAA7B,EAAoC;;AAElD;;;;AAIA,OAAKC,MAAL,GAAcH,KAAd;;AAEA;;;;AAIA,OAAKI,YAAL,GAAoBH,WAApB;;AAEA;;;;AAIA,OAAKI,MAAL,GAAcH,KAAd;;AAEA;;;;AAIA,OAAKI,OAAL,GAAe,EAAf;;AAEA;;;;AAIA,OAAKC,MAAL,GAAc,CAAd;;AAEA;;;;AAIA,OAAKC,gBAAL,GAAwB,CAAxB;AACD,CArCD;;AAwCA;;;AAGAT,QAAQ3Q,SAAR,CAAkBqR,KAAlB,GAA0B,YAAW;AACnC,OAAKH,OAAL,CAAanrB,MAAb,GAAsB,CAAtB;AACA,OAAKorB,MAAL,GAAc,CAAd;AACA,OAAKC,gBAAL,GAAwB,CAAxB;AACD,CAJD;;AAOA;;;;AAIAT,QAAQ3Q,SAAR,CAAkBsR,MAAlB,GAA2B,UAASphB,CAAT,EAAY+N,CAAZ,EAAe;AACxC,OAAKiT,OAAL,CAAappB,IAAb,CAAkBoI,CAAlB,EAAqB+N,CAArB,EAAwBsT,KAAKC,GAAL,EAAxB;AACD,CAFD;;AAKA;;;AAGAb,QAAQ3Q,SAAR,CAAkByR,GAAlB,GAAwB,YAAW;AACjC,MAAI,KAAKP,OAAL,CAAanrB,MAAb,GAAsB,CAA1B,EAA6B;AAC3B;AACA;AACA,WAAO,KAAP;AACD;AACD,MAAM+qB,QAAQS,KAAKC,GAAL,KAAa,KAAKP,MAAhC;AACA,MAAM3V,YAAY,KAAK4V,OAAL,CAAanrB,MAAb,GAAsB,CAAxC;AACA,MAAI,KAAKmrB,OAAL,CAAa5V,YAAY,CAAzB,IAA8BwV,KAAlC,EAAyC;AACvC;AACA;AACA,WAAO,KAAP;AACD;;AAED;AACA,MAAIY,aAAapW,YAAY,CAA7B;AACA,SAAOoW,aAAa,CAAb,IAAkB,KAAKR,OAAL,CAAaQ,aAAa,CAA1B,IAA+BZ,KAAxD,EAA+D;AAC7DY,kBAAc,CAAd;AACD;;AAED,MAAMC,WAAW,KAAKT,OAAL,CAAa5V,YAAY,CAAzB,IAA8B,KAAK4V,OAAL,CAAaQ,aAAa,CAA1B,CAA/C;AACA;AACA;AACA;AACA,MAAIC,WAAW,OAAO,EAAtB,EAA0B;AACxB,WAAO,KAAP;AACD;;AAED,MAAMC,KAAK,KAAKV,OAAL,CAAa5V,SAAb,IAA0B,KAAK4V,OAAL,CAAaQ,UAAb,CAArC;AACA,MAAMG,KAAK,KAAKX,OAAL,CAAa5V,YAAY,CAAzB,IAA8B,KAAK4V,OAAL,CAAaQ,aAAa,CAA1B,CAAzC;AACA,OAAKP,MAAL,GAActnB,KAAK4U,KAAL,CAAWoT,EAAX,EAAeD,EAAf,CAAd;AACA,OAAKR,gBAAL,GAAwBvnB,KAAKsG,IAAL,CAAUyhB,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,IAA+BF,QAAvD;AACA,SAAO,KAAKP,gBAAL,GAAwB,KAAKJ,YAApC;AACD,CAjCD;;AAoCA;;;AAGAL,QAAQ3Q,SAAR,CAAkB8R,WAAlB,GAAgC,YAAW;AACzC,SAAO,CAAC,KAAKd,YAAL,GAAoB,KAAKI,gBAA1B,IAA8C,KAAKL,MAA1D;AACD,CAFD;;AAKA;;;AAGAJ,QAAQ3Q,SAAR,CAAkB+R,QAAlB,GAA6B,YAAW;AACtC,SAAO,KAAKZ,MAAZ;AACD,CAFD;kBAGeR,O;;;;;;;;;;;;;;;;;AChIf;;;;AAIA;;;;kBAIe;AACbqB,SAAO,OADM;AAEbC,QAAM,MAFO;AAGbC,eAAa,aAHA;AAIbC,UAAQ;AAJK,C;;;;;;;;;;;;;;;;;;ACLf;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAdA;;;AAoEA,IAAM5tB,MAAM,SAANA,GAAM,CAASsI,OAAT,EAAkB;AAC5BA,YAAU,iBAAO,EAAP,EAAWA,OAAX,CAAV;AACA,MAAI,CAACA,QAAQulB,QAAb,EAAuB;AACrBvlB,YAAQulB,QAAR,GAAmB,qBAAnB;AACD;AACD,MAAI,CAACvlB,QAAQwlB,YAAb,EAA2B;AACzBxlB,YAAQwlB,YAAR,GAAuB,4BAAvB;AACD;;AAEDC,yBAAajR,IAAb,CAAkB,IAAlB,EAAwBxU,OAAxB;AACD,CAVD;;AAYA,qBAAStI,GAAT,EAAc+tB,sBAAd;;AAEA/tB,IAAIyb,SAAJ,CAAcuS,cAAd,GAA+B,YAAW;AACxC,MAAMC,WAAW,IAAIC,aAAJ,CAAsB,IAAtB,CAAjB;AACAD,WAASE,sBAAT,CAAgC,CAC9BC,oBAD8B,EAE9BC,mBAF8B,EAG9BC,qBAH8B,EAI9BC,yBAJ8B,CAAhC;AAMA,SAAON,QAAP;AACD,CATD;;kBAWejuB,G;;;;;;;;;;;;;;;;;;AC1Ff;;AACA;;;;;;AAEA;;;;;;;;;;;;;AANA;;;AAmBA,IAAMwuB,kBAAkB,SAAlBA,eAAkB,CAAS3sB,IAAT,EAAe9B,GAAf,EAAoB0uB,YAApB,EAAkCC,YAAlC,EAAgDC,cAAhD,EAAgE;;AAEtFC,qBAAS9R,IAAT,CAAc,IAAd,EAAoBjb,IAApB,EAA0B9B,GAA1B,EAA+B4uB,cAA/B;;AAEA;;;;;;AAMA,OAAKE,aAAL,GAAqBJ,YAArB;;AAEA;;;;;AAKA,OAAKK,KAAL,GAAa/uB,IAAIgvB,aAAJ,CAAkBN,YAAlB,CAAb;;AAEA;;;;;AAKA,OAAKO,UAAL,GAAkBjvB,IAAIkvB,sBAAJ,CAA2B,KAAKH,KAAhC,CAAlB;;AAEA;;;;;;;AAOA,OAAKI,QAAL,GAAgBR,iBAAiBvsB,SAAjB,GAA6BusB,YAA7B,GAA4C,KAA5D;AAED,CAnCD;;AAqCA,qBAASF,eAAT,EAA0BI,kBAA1B;;AAGA;;;;;;AAMAJ,gBAAgB/S,SAAhB,CAA0B0T,cAA1B,GAA2C,YAAW;AACpDP,qBAASnT,SAAT,CAAmB0T,cAAnB,CAAkCrS,IAAlC,CAAuC,IAAvC;AACA,OAAK+R,aAAL,CAAmBM,cAAnB;AACD,CAHD;;AAMA;;;;;;AAMAX,gBAAgB/S,SAAhB,CAA0B2T,eAA1B,GAA4C,YAAW;AACrDR,qBAASnT,SAAT,CAAmB2T,eAAnB,CAAmCtS,IAAnC,CAAwC,IAAxC;AACA,OAAK+R,aAAL,CAAmBO,eAAnB;AACD,CAHD;kBAIeZ,e;;;;;;;;;;;;;;;;;;AC9Ef;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;;;;;;;;AAZA;;;AAoBA,IAAMa,yBAAyB,SAAzBA,sBAAyB,CAAStvB,GAAT,EAAcuvB,aAAd,EAA6B;;AAE1DvE,wBAAYjO,IAAZ,CAAiB,IAAjB;;AAEA;;;;;AAKA,OAAKyS,IAAL,GAAYxvB,GAAZ;;AAEA;;;;AAIA,OAAKyvB,eAAL,GAAuB,CAAvB;;AAEA;;;;AAIA,OAAKC,SAAL,GAAiB,KAAjB;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,EAAzB;;AAEA;;;;AAIA,OAAKC,cAAL,GAAsBL,gBACpBA,gBAAgBM,uBADI,GACiBA,uBADvC;;AAGA;;;;;;AAMA,OAAKC,KAAL,GAAa,IAAb;;AAEA,MAAMjJ,UAAU,KAAK2I,IAAL,CAAUO,WAAV,EAAhB;;AAEA;;;;AAIA,OAAKC,eAAL,GAAuB,CAAvB;;AAEA;;;;AAIA,OAAKC,eAAL,GAAuB,EAAvB;;AAEA;;;;;;;AAOA,OAAKC,oBAAL,GAA4B,IAAIC,6BAAJ,CAAwBtJ,OAAxB,CAA5B;;AAEA;;;;;;;AAOA,OAAKuJ,4BAAL,GAAoC,IAApC;;AAEA;;;;AAIA,OAAKC,uBAAL,GAA+B,oBAAO,KAAKH,oBAAZ,EAC7BI,oBAAiBC,WADY,EAE7B,KAAKC,kBAFwB,EAEJ,IAFI,CAA/B;;AAIA;;;;AAIA,OAAKC,mBAAL,GAA2B,oBAAO,KAAKP,oBAAZ,EACzBI,oBAAiBI,WADQ,EAEzB,KAAKC,WAFoB,EAEP,IAFO,CAA3B;AAID,CA5FD;;AA8FA,qBAASrB,sBAAT,EAAiCtE,qBAAjC;;AAGA;;;;;AAKAsE,uBAAuB5T,SAAvB,CAAiCkV,aAAjC,GAAiD,UAASC,YAAT,EAAuB;AACtE,MAAIC,WAAW,IAAIC,gCAAJ,CACbC,8BAAoBC,KADP,EACc,KAAKzB,IADnB,EACyBqB,YADzB,CAAf;AAEA,OAAK9I,aAAL,CAAmB+I,QAAnB;AACA,MAAI,KAAKrB,eAAL,KAAyB,CAA7B,EAAgC;AAC9B;AACAyB,iBAAa,KAAKzB,eAAlB;AACA,SAAKA,eAAL,GAAuB,CAAvB;AACAqB,eAAW,IAAIC,gCAAJ,CACTC,8BAAoBG,QADX,EACqB,KAAK3B,IAD1B,EACgCqB,YADhC,CAAX;AAEA,SAAK9I,aAAL,CAAmB+I,QAAnB;AACD,GAPD,MAOO;AACL;AACA,SAAKrB,eAAL,GAAuB2B,WAAW,YAAW;AAC3C,WAAK3B,eAAL,GAAuB,CAAvB;AACA,UAAMqB,WAAW,IAAIC,gCAAJ,CACfC,8BAAoBK,WADL,EACkB,KAAK7B,IADvB,EAC6BqB,YAD7B,CAAjB;AAEA,WAAK9I,aAAL,CAAmB+I,QAAnB;AACD,KALiC,CAKhChZ,IALgC,CAK3B,IAL2B,CAAX,EAKT,GALS,CAAvB;AAMD;AACF,CApBD;;AAuBA;;;;;;;AAOAwX,uBAAuB5T,SAAvB,CAAiC4V,qBAAjC,GAAyD,UAAST,YAAT,EAAuB;AAC9E,MAAMU,QAAQV,YAAd;;AAEA,MAAIU,MAAMzvB,IAAN,IAAckvB,8BAAoBQ,SAAlC,IACAD,MAAMzvB,IAAN,IAAckvB,8BAAoBS,aADtC,EACqD;AACnD,WAAO,KAAKxB,eAAL,CAAqBsB,MAAMG,SAA3B,CAAP;AACD,GAHD,MAGO,IAAIH,MAAMzvB,IAAN,IAAckvB,8BAAoBT,WAAtC,EAAmD;AACxD,SAAKN,eAAL,CAAqBsB,MAAMG,SAA3B,IAAwC,IAAxC;AACD;AACD,OAAK1B,eAAL,GAAuB1uB,OAAO6N,IAAP,CAAY,KAAK8gB,eAAjB,EAAkCxuB,MAAzD;AACD,CAVD;;AAaA;;;;;AAKA6tB,uBAAuB5T,SAAvB,CAAiCiW,gBAAjC,GAAoD,UAASd,YAAT,EAAuB;AACzE,OAAKS,qBAAL,CAA2BT,YAA3B;AACA,MAAMC,WAAW,IAAIC,gCAAJ,CACfC,8BAAoBQ,SADL,EACgB,KAAKhC,IADrB,EAC2BqB,YAD3B,CAAjB;AAEA,OAAK9I,aAAL,CAAmB+I,QAAnB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAI,CAACA,SAASc,kBAAV,IAAgC,CAAC,KAAKlC,SAAtC,IAAmD,KAAKmC,oBAAL,CAA0BhB,YAA1B,CAAvD,EAAgG;AAC9F,SAAKD,aAAL,CAAmB,KAAKd,KAAxB;AACD;;AAED,MAAI,KAAKE,eAAL,KAAyB,CAA7B,EAAgC;AAC9B,SAAKL,iBAAL,CAAuBzuB,OAAvB,CAA+B4wB,qBAA/B;AACA,SAAKnC,iBAAL,CAAuBluB,MAAvB,GAAgC,CAAhC;AACA,SAAKiuB,SAAL,GAAiB,KAAjB;AACA,SAAKI,KAAL,GAAa,IAAb;AACA,SAAKM,4BAAL,CAAkCzH,OAAlC;AACA,SAAKyH,4BAAL,GAAoC,IAApC;AACD;AACF,CAxBD;;AA2BA;;;;;;AAMAd,uBAAuB5T,SAAvB,CAAiCmW,oBAAjC,GAAwD,UAAShB,YAAT,EAAuB;AAC7E,SAAOA,aAAakB,MAAb,KAAwB,CAA/B;AACD,CAFD;;AAKA;;;;;AAKAzC,uBAAuB5T,SAAvB,CAAiC8U,kBAAjC,GAAsD,UAASK,YAAT,EAAuB;AAC3E,OAAKS,qBAAL,CAA2BT,YAA3B;AACA,MAAMC,WAAW,IAAIC,gCAAJ,CACfC,8BAAoBT,WADL,EACkB,KAAKf,IADvB,EAC6BqB,YAD7B,CAAjB;AAEA,OAAK9I,aAAL,CAAmB+I,QAAnB;;AAEA,OAAKhB,KAAL,GAAae,YAAb;;AAEA,MAAI,KAAKlB,iBAAL,CAAuBluB,MAAvB,KAAkC,CAAtC,EAAyC;AACvC;;;;AAIA,SAAK2uB,4BAAL,GACI,IAAID,6BAAJ,CAAwB6B,QAAxB,CADJ;;AAGA,SAAKrC,iBAAL,CAAuBnsB,IAAvB,CACE,oBAAO,KAAK4sB,4BAAZ,EACEY,8BAAoBN,WADtB,EAEE,KAAKuB,kBAFP,EAE2B,IAF3B,CADF,EAIE,oBAAO,KAAK7B,4BAAZ,EACEY,8BAAoBQ,SADtB,EAEE,KAAKG,gBAFP,EAEyB,IAFzB,CAJF;AAOE;;;;;;;;;;;;;AAaA,wBAAO,KAAKzB,oBAAZ,EACEc,8BAAoBS,aADtB,EAEE,KAAKE,gBAFP,EAEyB,IAFzB,CApBF;AAwBD;AACF,CAzCD;;AA4CA;;;;;AAKArC,uBAAuB5T,SAAvB,CAAiCuW,kBAAjC,GAAsD,UAASpB,YAAT,EAAuB;AAC3E;AACA;AACA;AACA,MAAI,KAAKqB,SAAL,CAAerB,YAAf,CAAJ,EAAkC;AAChC,SAAKnB,SAAL,GAAiB,IAAjB;AACA,QAAMoB,WAAW,IAAIC,gCAAJ,CACfC,8BAAoBmB,WADL,EACkB,KAAK3C,IADvB,EAC6BqB,YAD7B,EAEf,KAAKnB,SAFU,CAAjB;AAGA,SAAK3H,aAAL,CAAmB+I,QAAnB;AACD;;AAED;AACA;AACA;AACA;AACAD,eAAazB,cAAb;AACD,CAjBD;;AAoBA;;;;;;;AAOAE,uBAAuB5T,SAAvB,CAAiCiV,WAAjC,GAA+C,UAASE,YAAT,EAAuB;AACpE,MAAM1B,WAAW,CAAC,EAAE,KAAKW,KAAL,IAAc,KAAKoC,SAAL,CAAerB,YAAf,CAAhB,CAAlB;AACA,OAAK9I,aAAL,CAAmB,IAAIgJ,gCAAJ,CACjBF,aAAa/uB,IADI,EACE,KAAK0tB,IADP,EACaqB,YADb,EAC2B1B,QAD3B,CAAnB;AAED,CAJD;;AAOA;;;;;;AAMAG,uBAAuB5T,SAAvB,CAAiCwW,SAAjC,GAA6C,UAASrB,YAAT,EAAuB;AAClE,SAAO,KAAKnB,SAAL,IACHnqB,KAAKmH,GAAL,CAASmkB,aAAauB,OAAb,GAAuB,KAAKtC,KAAL,CAAWsC,OAA3C,IAAsD,KAAKxC,cADxD,IAEHrqB,KAAKmH,GAAL,CAASmkB,aAAawB,OAAb,GAAuB,KAAKvC,KAAL,CAAWuC,OAA3C,IAAsD,KAAKzC,cAF/D;AAGD,CAJD;;AAOA;;;AAGAN,uBAAuB5T,SAAvB,CAAiCkN,eAAjC,GAAmD,YAAW;AAC5D,MAAI,KAAK6H,mBAAT,EAA8B;AAC5B,+BAAc,KAAKA,mBAAnB;AACA,SAAKA,mBAAL,GAA2B,IAA3B;AACD;AACD,MAAI,KAAKJ,uBAAT,EAAkC;AAChC,+BAAc,KAAKA,uBAAnB;AACA,SAAKA,uBAAL,GAA+B,IAA/B;AACD;;AAED,OAAKV,iBAAL,CAAuBzuB,OAAvB,CAA+B4wB,qBAA/B;AACA,OAAKnC,iBAAL,CAAuBluB,MAAvB,GAAgC,CAAhC;;AAEA,MAAI,KAAK2uB,4BAAT,EAAuC;AACrC,SAAKA,4BAAL,CAAkCzH,OAAlC;AACA,SAAKyH,4BAAL,GAAoC,IAApC;AACD;AACD,MAAI,KAAKF,oBAAT,EAA+B;AAC7B,SAAKA,oBAAL,CAA0BvH,OAA1B;AACA,SAAKuH,oBAAL,GAA4B,IAA5B;AACD;AACDlF,wBAAYtP,SAAZ,CAAsBkN,eAAtB,CAAsC7L,IAAtC,CAA2C,IAA3C;AACD,CAtBD;kBAuBeuS,sB;;;;;;;;;;;;;;;;;;AC5Uf;;;;;;AAEA;;;;kBAIe;;AAEb;;;;;;AAMA+B,eAAa,aARA;;AAUb;;;;;AAKAJ,SAAO3G,oBAAU2G,KAfJ;;AAiBb;;;;;AAKAE,YAAU7G,oBAAU6G,QAtBP;;AAwBb;;;;;AAKAgB,eAAa,aA7BA;;AA+Bb;;;;;;AAMAzB,eAAa,aArCA;;AAuCbH,eAAa,aAvCA;AAwCbiB,aAAW,WAxCE;AAyCbc,eAAa,aAzCA;AA0CbC,cAAY,YA1CC;AA2CbC,gBAAc,cA3CD;AA4CbC,gBAAc,cA5CD;AA6CbhB,iBAAe;AA7CF,C,EATf;;;;;;;;;;;;;;;;;;;;ACGA;;AACA;;;;;;AAEA;;;;;;;;;;AANA;;;AAgBA,IAAMV,yBAAyB,SAAzBA,sBAAyB,CAASjvB,IAAT,EAAe9B,GAAf,EAAoB6wB,YAApB,EAAkClC,YAAlC,EAC7BC,cAD6B,EACb;;AAEhBH,4BAAgB1R,IAAhB,CAAqB,IAArB,EAA2Bjb,IAA3B,EAAiC9B,GAAjC,EAAsC6wB,aAAa/B,aAAnD,EAAkEH,YAAlE,EACEC,cADF;;AAGA;;;;AAIA,OAAKiC,YAAL,GAAoBA,YAApB;AAED,CAZD;;AAcA,qBAASE,sBAAT,EAAiCtC,yBAAjC;kBACesC,sB;;;;;;;;;;;;;;;;;;AC5Bf;;AACA;;;;;;AAEA;;;;;;;;;;;AANA;;;AAiBA,IAAMlC,WAAW,SAAXA,QAAW,CAAS/sB,IAAT,EAAe9B,GAAf,EAAoB4uB,cAApB,EAAoC;;AAEnDhI,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAK9B,GAAL,GAAWA,GAAX;;AAEA;;;;;AAKA,OAAK0yB,UAAL,GAAkB9D,mBAAmBxsB,SAAnB,GAA+BwsB,cAA/B,GAAgD,IAAlE;AAED,CAlBD;;AAoBA,qBAASC,QAAT,EAAmBjI,eAAnB;kBACeiI,Q;;;;;;;;;;;;;;;;;ACtCf;;;;AAIA;;;kBAGe;;AAEb;;;;;AAKA8D,cAAY,YAPC;;AASb;;;;;AAKAC,aAAW,WAdE;;AAgBb;;;;;AAKAC,WAAS;;AArBI,C;;;;;;;;;;;;;;;;;ACPf;;;;AAIA;;;kBAGe;AACbC,cAAY,YADC;AAEbC,QAAM,MAFO;AAGbC,UAAQ,QAHK;AAIbC,QAAM;AAJO,C;;;;;;;;;;;;;;;;;QCmHCC,kB,GAAAA,kB;;AAvHhB;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAGA;;;;;;;;;;;AAWA,IAAMC,cAAc,SAAdA,WAAc,CAASrxB,IAAT,EAAe+H,GAAf,EAAoBupB,QAApB,EAA8B;AAChDxM,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAK+H,GAAL,GAAWA,GAAX;;AAEA;;;;;;AAMA,OAAKupB,QAAL,GAAgBA,QAAhB;AAED,CAlBD,C,CArBA;;;;AAwCA,qBAASD,WAAT,EAAsBvM,eAAtB;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA,IAAMK,aAAa,SAAbA,UAAa,CAASoM,UAAT,EAAqB;AACtCC,uBAAWvW,IAAX,CAAgB,IAAhB;;AAEA;AACA;AACA;AACA;AACA,qBAAO,IAAP;;AAEA;;;;AAIA,OAAKwW,OAAL,GAAe,EAAf;;AAEA,MAAIF,eAAejxB,SAAnB,EAA8B;AAC5B,SAAKsnB,aAAL,CAAmB2J,UAAnB;AACD;AACF,CAlBD;;AAoBA,qBAASpM,UAAT,EAAqBqM,oBAArB;;AAGA;;;AAGA,IAAME,uBAAuB,EAA7B;;AAGA;;;;AAIO,SAASN,kBAAT,CAA4BrpB,GAA5B,EAAiC;AACtC,SAAO2pB,qBAAqB9W,cAArB,CAAoC7S,GAApC,IACL2pB,qBAAqB3pB,GAArB,CADK,GAEJ2pB,qBAAqB3pB,GAArB,IAA4B,YAAYA,GAF3C;AAGD;;AAGD;;;;;;AAMAod,WAAWvL,SAAX,CAAqB3R,GAArB,GAA2B,UAASF,GAAT,EAAc;AACvC,MAAI9E,cAAJ;AACA,MAAI,KAAKwuB,OAAL,CAAa7W,cAAb,CAA4B7S,GAA5B,CAAJ,EAAsC;AACpC9E,YAAQ,KAAKwuB,OAAL,CAAa1pB,GAAb,CAAR;AACD;AACD,SAAO9E,KAAP;AACD,CAND;;AASA;;;;;AAKAkiB,WAAWvL,SAAX,CAAqB+X,OAArB,GAA+B,YAAW;AACxC,SAAOnyB,OAAO6N,IAAP,CAAY,KAAKokB,OAAjB,CAAP;AACD,CAFD;;AAKA;;;;;AAKAtM,WAAWvL,SAAX,CAAqBkO,aAArB,GAAqC,YAAW;AAC9C,SAAO,iBAAO,EAAP,EAAW,KAAK2J,OAAhB,CAAP;AACD,CAFD;;AAKA;;;;AAIAtM,WAAWvL,SAAX,CAAqBgY,MAArB,GAA8B,UAAS7pB,GAAT,EAAcupB,QAAd,EAAwB;AACpD,MAAIO,kBAAJ;AACAA,cAAYT,mBAAmBrpB,GAAnB,CAAZ;AACA,OAAKke,aAAL,CAAmB,IAAIoL,WAAJ,CAAgBQ,SAAhB,EAA2B9pB,GAA3B,EAAgCupB,QAAhC,CAAnB;AACAO,cAAYC,0BAAgBC,cAA5B;AACA,OAAK9L,aAAL,CAAmB,IAAIoL,WAAJ,CAAgBQ,SAAhB,EAA2B9pB,GAA3B,EAAgCupB,QAAhC,CAAnB;AACD,CAND;;AASA;;;;;;;AAOAnM,WAAWvL,SAAX,CAAqB6M,GAArB,GAA2B,UAAS1e,GAAT,EAAc9E,KAAd,EAAqB+uB,UAArB,EAAiC;AAC1D,MAAIA,UAAJ,EAAgB;AACd,SAAKP,OAAL,CAAa1pB,GAAb,IAAoB9E,KAApB;AACD,GAFD,MAEO;AACL,QAAMquB,WAAW,KAAKG,OAAL,CAAa1pB,GAAb,CAAjB;AACA,SAAK0pB,OAAL,CAAa1pB,GAAb,IAAoB9E,KAApB;AACA,QAAIquB,aAAaruB,KAAjB,EAAwB;AACtB,WAAK2uB,MAAL,CAAY7pB,GAAZ,EAAiBupB,QAAjB;AACD;AACF;AACF,CAVD;;AAaA;;;;;;;AAOAnM,WAAWvL,SAAX,CAAqBgO,aAArB,GAAqC,UAAS5Y,MAAT,EAAiBgjB,UAAjB,EAA6B;AAChE,OAAK,IAAMjqB,GAAX,IAAkBiH,MAAlB,EAA0B;AACxB,SAAKyX,GAAL,CAAS1e,GAAT,EAAciH,OAAOjH,GAAP,CAAd,EAA2BiqB,UAA3B;AACD;AACF,CAJD;;AAOA;;;;;;AAMA7M,WAAWvL,SAAX,CAAqBqY,KAArB,GAA6B,UAASlqB,GAAT,EAAciqB,UAAd,EAA0B;AACrD,MAAIjqB,OAAO,KAAK0pB,OAAhB,EAAyB;AACvB,QAAMH,WAAW,KAAKG,OAAL,CAAa1pB,GAAb,CAAjB;AACA,WAAO,KAAK0pB,OAAL,CAAa1pB,GAAb,CAAP;AACA,QAAI,CAACiqB,UAAL,EAAiB;AACf,WAAKJ,MAAL,CAAY7pB,GAAZ,EAAiBupB,QAAjB;AACD;AACF;AACF,CARD;;kBAWenM,U;;;;;;;;;;;;;;;;;ACpOf;;;;AAIA;;;kBAGe;AACb;;;;;AAKA4M,kBAAgB;AANH,C;;;;;;;;;;;;;;;;;QCoCCG,O,GAAAA,O;;AAxChB;;AACA;;AACA;;;;AACA;;;;;;AAEA;;;;;;;;;;;;;;AARA;;;AAsBA,IAAMV,aAAa,SAAbA,UAAa,GAAW;;AAE5BtI,wBAAYjO,IAAZ,CAAiB,IAAjB;;AAEA;;;;AAIA,OAAKkX,SAAL,GAAiB,CAAjB;AAED,CAVD;;AAYA,qBAASX,UAAT,EAAqBtI,qBAArB;;AAGA;;;;;;AAMO,SAASgJ,OAAT,CAAiBnqB,GAAjB,EAAsB;AAC3B,MAAIhH,MAAMC,OAAN,CAAc+G,GAAd,CAAJ,EAAwB;AACtB,SAAK,IAAIrI,IAAI,CAAR,EAAWwkB,KAAKnc,IAAIpI,MAAzB,EAAiCD,IAAIwkB,EAArC,EAAyC,EAAExkB,CAA3C,EAA8C;AAC5C,iCAAcqI,IAAIrI,CAAJ,CAAd;AACD;AACF,GAJD,MAIO;AACL,gCAAc,yCAA2CqI,GAAzD;AACD;AACF;;AAGD;;;;AAIAypB,WAAW5X,SAAX,CAAqB2O,OAArB,GAA+B,YAAW;AACxC,IAAE,KAAK4J,SAAP;AACA,OAAKlM,aAAL,CAAmBuC,oBAAUC,MAA7B;AACD,CAHD;;AAMA;;;;;;;;;;;AAWA+I,WAAW5X,SAAX,CAAqBqM,aAArB;;AAGA;;;;;;AAMAuL,WAAW5X,SAAX,CAAqBwY,WAArB,GAAmC,YAAW;AAC5C,SAAO,KAAKD,SAAZ;AACD,CAFD;;AAKA;;;;;;;;;AASAX,WAAW5X,SAAX,CAAqByY,EAArB,GAA0B,UAASryB,IAAT,EAAesyB,QAAf,EAAyB;AACjD,MAAIvxB,MAAMC,OAAN,CAAchB,IAAd,CAAJ,EAAyB;AACvB,QAAMoa,MAAMpa,KAAKL,MAAjB;AACA,QAAM0N,OAAO,IAAItM,KAAJ,CAAUqZ,GAAV,CAAb;AACA,SAAK,IAAI1a,IAAI,CAAb,EAAgBA,IAAI0a,GAApB,EAAyB,EAAE1a,CAA3B,EAA8B;AAC5B2N,WAAK3N,CAAL,IAAU,oBAAO,IAAP,EAAaM,KAAKN,CAAL,CAAb,EAAsB4yB,QAAtB,CAAV;AACD;AACD,WAAOjlB,IAAP;AACD,GAPD,MAOO;AACL,WAAO,oBAAO,IAAP,EAAa,qBAAuBrN,IAApC,EAA2CsyB,QAA3C,CAAP;AACD;AACF,CAXD;;AAcA;;;;;;;;;AASAd,WAAW5X,SAAX,CAAqB2Y,IAArB,GAA4B,UAASvyB,IAAT,EAAesyB,QAAf,EAAyB;AACnD,MAAIvxB,MAAMC,OAAN,CAAchB,IAAd,CAAJ,EAAyB;AACvB,QAAMoa,MAAMpa,KAAKL,MAAjB;AACA,QAAM0N,OAAO,IAAItM,KAAJ,CAAUqZ,GAAV,CAAb;AACA,SAAK,IAAI1a,IAAI,CAAb,EAAgBA,IAAI0a,GAApB,EAAyB,EAAE1a,CAA3B,EAA8B;AAC5B2N,WAAK3N,CAAL,IAAU,wBAAW,IAAX,EAAiBM,KAAKN,CAAL,CAAjB,EAA0B4yB,QAA1B,CAAV;AACD;AACD,WAAOjlB,IAAP;AACD,GAPD,MAOO;AACL,WAAO,wBAAW,IAAX,EAAiB,qBAAuBrN,IAAxC,EAA+CsyB,QAA/C,CAAP;AACD;AACF,CAXD;;AAcA;;;;;;AAMAd,WAAW5X,SAAX,CAAqB4Y,EAArB,GAA0B,UAASxyB,IAAT,EAAesyB,QAAf,EAAyB;AACjD,MAAIvxB,MAAMC,OAAN,CAAchB,IAAd,CAAJ,EAAyB;AACvB,SAAK,IAAIN,IAAI,CAAR,EAAWwkB,KAAKlkB,KAAKL,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,4BAAS,IAAT,EAAeM,KAAKN,CAAL,CAAf,EAAwB4yB,QAAxB;AACD;AACD;AACD,GALD,MAKO;AACL,0BAAS,IAAT,EAAe,qBAAuBtyB,IAAtC,EAA6CsyB,QAA7C;AACD;AACF,CATD;kBAUed,U;;;;;;;;;;;;;;;;;;ACpJf;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;;;;AAKA;;;;;;;;;;;;AAaA;;;;;;;;;AAUA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;;;;;;;;;;AApIA;;;AA8IA,IAAMtF,eAAe,SAAfA,YAAe,CAASzlB,OAAT,EAAkB;;AAErC0e,mBAAWlK,IAAX,CAAgB,IAAhB;;AAEA,MAAMwX,kBAAkBC,sBAAsBjsB,OAAtB,CAAxB;;AAEA;;;;AAIA,OAAKksB,gBAAL,GAAwBlsB,QAAQmsB,eAAR,KAA4BtyB,SAA5B,GAAwCmG,QAAQmsB,eAAhD,GAAkE,EAA1F;;AAEA;;;;AAIA,OAAKC,wBAAL,GACIpsB,QAAQqsB,uBAAR,KAAoCxyB,SAApC,GACEmG,QAAQqsB,uBADV,GACoC,KAFxC;;AAIA;;;;AAIA,OAAKC,0BAAL,GACItsB,QAAQusB,yBAAR,KAAsC1yB,SAAtC,GACEmG,QAAQusB,yBADV,GACsC,KAF1C;;AAIA;;;;AAIA,OAAK7J,WAAL,GAAmB1iB,QAAQuiB,UAAR,KAAuB1oB,SAAvB,GACjBmG,QAAQuiB,UADS,GACI+E,uBADvB;;AAGA;;;;AAIA,OAAKkF,kBAAL;;AAEA;;;AAGA,OAAKC,eAAL,GAAuB,YAAW;AAChC,SAAKD,kBAAL,GAA0B3yB,SAA1B;AACA,SAAK6yB,YAAL,CAAkBlY,IAAlB,CAAuB,IAAvB,EAA6BkQ,KAAKC,GAAL,EAA7B;AACD,GAHsB,CAGrBpV,IAHqB,CAGhB,IAHgB,CAAvB;;AAKA;;;;AAIA,OAAKod,2BAAL,GAAmC,wBAAnC;;AAEA;;;;AAIA,OAAKC,2BAAL,GAAmC,wBAAnC;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmB,CAAnB;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmB,IAAnB;;AAEA;;;;;AAKA,OAAKC,eAAL,GAAuB,IAAvB;;AAEA;;;;AAIA,OAAKC,wBAAL,GAAgC,IAAhC;;AAEA;;;;AAIA,OAAKC,sBAAL,GAA8B,IAA9B;;AAEA;;;;AAIA,OAAKC,+BAAL,GAAuC,IAAvC;;AAEA;;;;AAIA,OAAKC,SAAL,GAAiB1D,SAAS2D,aAAT,CAAuB,KAAvB,CAAjB;AACA,OAAKD,SAAL,CAAeE,SAAf,GAA2B,iBAAiBC,aAAQ,WAAR,GAAsB,EAAvC,CAA3B;AACA,OAAKH,SAAL,CAAe9P,KAAf,CAAqBkQ,QAArB,GAAgC,UAAhC;AACA,OAAKJ,SAAL,CAAe9P,KAAf,CAAqBmQ,QAArB,GAAgC,QAAhC;AACA,OAAKL,SAAL,CAAe9P,KAAf,CAAqBoQ,KAArB,GAA6B,MAA7B;AACA,OAAKN,SAAL,CAAe9P,KAAf,CAAqBqQ,MAArB,GAA8B,MAA9B;AACA;AACA,OAAKP,SAAL,CAAe9P,KAAf,CAAqBsQ,aAArB,GAAqC,MAArC;AACA,OAAKR,SAAL,CAAe9P,KAAf,CAAqBuQ,WAArB,GAAmC,MAAnC;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyBpE,SAAS2D,aAAT,CAAuB,KAAvB,CAAzB;AACA,OAAKS,iBAAL,CAAuBR,SAAvB,GAAmC,qBAAnC;AACA,OAAKF,SAAL,CAAeW,WAAf,CAA2B,KAAKD,iBAAhC;;AAEA;;;;AAIA,OAAKE,0BAAL,GAAkCtE,SAAS2D,aAAT,CAAuB,KAAvB,CAAlC;AACA,OAAKW,0BAAL,CAAgCV,SAAhC,GAA4C,+BAA5C;AACA,MAAMW,gBAAgB,CACpBjM,oBAAU2G,KADU,EAEpB3G,oBAAU6G,QAFU,EAGpB7G,oBAAUkM,SAHU,EAIpBlM,oBAAUmM,UAJU,EAKpBnM,oBAAUoM,aALU,EAMpB1F,8BAAoBT,WANA,EAOpBjG,oBAAUqM,UAPU,EAQpBrM,oBAAUsM,KARU,CAAtB;AAUA,OAAK,IAAIp1B,IAAI,CAAR,EAAWwkB,KAAKuQ,cAAc90B,MAAnC,EAA2CD,IAAIwkB,EAA/C,EAAmD,EAAExkB,CAArD,EAAwD;AACtD,wBAAO,KAAK80B,0BAAZ,EAAwCC,cAAc/0B,CAAd,CAAxC,EAA0D6tB,sBAA1D;AACD;AACD,OAAKqG,SAAL,CAAeW,WAAf,CAA2B,KAAKC,0BAAhC;;AAEA;;;;AAIA,OAAKO,uBAAL,GAA+B,IAAIvH,gCAAJ,CAA2B,IAA3B,EAAiC/mB,QAAQgnB,aAAzC,CAA/B;AACA,OAAK,IAAM1lB,GAAX,IAAkBmnB,6BAAlB,EAAuC;AACrC,wBAAO,KAAK6F,uBAAZ,EAAqC7F,8BAAoBnnB,GAApB,CAArC,EACE,KAAKitB,qBADP,EAC8B,IAD9B;AAED;;AAED;;;;AAIA,OAAKC,oBAAL,GAA4BxC,gBAAgByC,mBAA5C;;AAEA;;;;AAIA,OAAKC,eAAL,GAAuB,IAAvB;;AAEA,sBAAO,KAAKvB,SAAZ,EAAuBpL,oBAAU4M,WAAjC,EAA8C,KAAKC,kBAAnD,EAAuE,IAAvE;AACA,sBAAO,KAAKzB,SAAZ,EAAuBpL,oBAAUsM,KAAjC,EAAwC,KAAKO,kBAA7C,EAAiE,IAAjE;AACA,sBAAO,KAAKzB,SAAZ,EAAuBpL,oBAAUqM,UAAjC,EAA6C,KAAKQ,kBAAlD,EAAsE,IAAtE;;AAEA;;;;AAIA,OAAKrJ,QAAL,GAAgByG,gBAAgBzG,QAAhB,IAA4B,IAAIhH,oBAAJ,EAA5C;;AAEA;;;;AAIA,OAAKiH,YAAL,GAAoBwG,gBAAgBxG,YAAhB,IAAgC,IAAIjH,oBAAJ,EAApD;;AAEA;;;;AAIA,OAAKsQ,SAAL,GAAiB7C,gBAAgB8C,QAAjC;;AAEA;;;;;AAKA,OAAKC,eAAL,GAAuB,EAAvB;;AAEA;;;;AAIA,OAAKC,SAAL,GAAiB,KAAKtJ,cAAL,CAAoB,KAAKyH,SAAzB,EAAoC,IAApC,CAAjB;;AAEA;;;;AAIA,OAAK8B,aAAL;;AAEA;;;;AAIA,OAAKC,MAAL,GAAc,IAAd;;AAEA;;;;AAIA,OAAKC,oBAAL,GAA4B,EAA5B;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkB,IAAIC,mBAAJ,CAChB,KAAKC,eAAL,CAAqB/f,IAArB,CAA0B,IAA1B,CADgB,EAEhB,KAAKggB,iBAAL,CAAuBhgB,IAAvB,CAA4B,IAA5B,CAFgB,CAAlB;;AAIA;;;;;AAKA,OAAKigB,mBAAL,GAA2B,EAA3B;;AAEA,sBACE,IADF,EACQ,gCAAmBC,sBAAYlF,UAA/B,CADR,EAEE,KAAKmF,wBAFP,EAEiC,IAFjC;AAGA,sBAAO,IAAP,EAAa,gCAAmBD,sBAAY/E,IAA/B,CAAb,EACE,KAAKiF,kBADP,EAC2B,IAD3B;AAEA,sBAAO,IAAP,EAAa,gCAAmBF,sBAAYjF,IAA/B,CAAb,EACE,KAAKoF,kBADP,EAC2B,IAD3B;AAEA,sBAAO,IAAP,EAAa,gCAAmBH,sBAAYhF,MAA/B,CAAb,EACE,KAAKoF,oBADP,EAC6B,IAD7B;;AAGA;AACA;AACA,OAAK1O,aAAL,CAAmB6K,gBAAgBzjB,MAAnC;;AAEA,OAAKgd,QAAL,CAAc5sB,OAAd;AACE;;;;AAIC,YAASm3B,OAAT,EAAkB;AACjBA,YAAQC,MAAR,CAAe,IAAf;AACD,GAFD,CAEGxgB,IAFH,CAEQ,IAFR,CALF;;AASA,sBAAO,KAAKgW,QAAZ,EAAsB9F,8BAAoBC,GAA1C;AACE;;;AAGA,YAASsJ,KAAT,EAAgB;AACdA,UAAM1K,OAAN,CAAcyR,MAAd,CAAqB,IAArB;AACD,GANH,EAMK,IANL;;AAQA,sBAAO,KAAKxK,QAAZ,EAAsB9F,8BAAoBK,MAA1C;AACE;;;AAGA,YAASkJ,KAAT,EAAgB;AACdA,UAAM1K,OAAN,CAAcyR,MAAd,CAAqB,IAArB;AACD,GANH,EAMK,IANL;;AAQA,OAAKvK,YAAL,CAAkB7sB,OAAlB;AACE;;;;AAIC,YAASq3B,WAAT,EAAsB;AACrBA,gBAAYD,MAAZ,CAAmB,IAAnB;AACD,GAFD,CAEGxgB,IAFH,CAEQ,IAFR,CALF;;AASA,sBAAO,KAAKiW,YAAZ,EAA0B/F,8BAAoBC,GAA9C;AACE;;;AAGA,YAASsJ,KAAT,EAAgB;AACdA,UAAM1K,OAAN,CAAcyR,MAAd,CAAqB,IAArB;AACD,GANH,EAMK,IANL;;AAQA,sBAAO,KAAKvK,YAAZ,EAA0B/F,8BAAoBK,MAA9C;AACE;;;AAGA,YAASkJ,KAAT,EAAgB;AACdA,UAAM1K,OAAN,CAAcyR,MAAd,CAAqB,IAArB;AACD,GANH,EAMK,IANL;;AAQA,OAAKlB,SAAL,CAAel2B,OAAf,CAAuB,KAAKs3B,mBAAL,CAAyB1gB,IAAzB,CAA8B,IAA9B,CAAvB;;AAEA,sBAAO,KAAKsf,SAAZ,EAAuBpP,8BAAoBC,GAA3C;AACE;;;AAGA,YAASsJ,KAAT,EAAgB;AACd,SAAKiH,mBAAL,EAAyB,gCAAkCjH,MAAM1K,OAAjE;AACD,GANH,EAMK,IANL;;AAQA,sBAAO,KAAKuQ,SAAZ,EAAuBpP,8BAAoBK,MAA3C;AACE;;;AAGA,YAASkJ,KAAT,EAAgB;AACd,QAAMkH,UAAU,gCAAkClH,MAAM1K,OAAxD;AACA,QAAMnlB,KAAK+2B,QAAQvO,KAAR,EAAX;AACA,QAAIxoB,OAAOU,SAAX,EAAsB;AACpB,aAAO,KAAKk1B,eAAL,CAAqB51B,GAAG2C,QAAH,EAArB,CAAP;AACD;AACDktB,UAAM1K,OAAN,CAAcyR,MAAd,CAAqB,IAArB;AACD,GAXH,EAWK,IAXL;AAaD,CA9TD;;AAgUA,qBAAStK,YAAT,EAAuB/G,gBAAvB;;AAGA+G,aAAatS,SAAb,CAAuBuS,cAAvB,GAAwC,YAAW;AACjD,QAAM,IAAI1b,KAAJ,CAAU,iDAAV,CAAN;AACD,CAFD;;AAKA;;;;;AAKAyb,aAAatS,SAAb,CAAuBgd,UAAvB,GAAoC,UAASL,OAAT,EAAkB;AACpD,OAAKM,WAAL,GAAmBn1B,IAAnB,CAAwB60B,OAAxB;AACD,CAFD;;AAKA;;;;;AAKArK,aAAatS,SAAb,CAAuBkd,cAAvB,GAAwC,UAASL,WAAT,EAAsB;AAC5D,OAAKM,eAAL,GAAuBr1B,IAAvB,CAA4B+0B,WAA5B;AACD,CAFD;;AAKA;;;;;;;AAOAvK,aAAatS,SAAb,CAAuB9a,QAAvB,GAAkC,UAASpB,KAAT,EAAgB;AAChD,MAAM4B,SAAS,KAAK03B,aAAL,GAAqBC,SAArB,EAAf;AACA33B,SAAOoC,IAAP,CAAYhE,KAAZ;AACD,CAHD;;AAMA;;;;;AAKAwuB,aAAatS,SAAb,CAAuBsd,UAAvB,GAAoC,UAASP,OAAT,EAAkB;AACpD,OAAKQ,WAAL,GAAmBz1B,IAAnB,CAAwBi1B,OAAxB;AACD,CAFD;;AAKA;;;;;AAKAzK,aAAatS,SAAb,CAAuB8c,mBAAvB,GAA6C,UAASC,OAAT,EAAkB;AAC7D,MAAM/2B,KAAK+2B,QAAQvO,KAAR,EAAX;AACA,MAAIxoB,OAAOU,SAAX,EAAsB;AACpB,SAAKk1B,eAAL,CAAqB51B,GAAG2C,QAAH,EAArB,IAAsCo0B,OAAtC;AACD;AACDA,UAAQH,MAAR,CAAe,IAAf;AACD,CAND;;AASA;;;;AAIAtK,aAAatS,SAAb,CAAuBkN,eAAvB,GAAyC,YAAW;AAClD,OAAKiO,uBAAL,CAA6BlO,OAA7B;AACA,wBAAS,KAAK+M,SAAd,EAAyBpL,oBAAU4M,WAAnC,EAAgD,KAAKC,kBAArD,EAAyE,IAAzE;AACA,wBAAS,KAAKzB,SAAd,EAAyBpL,oBAAUsM,KAAnC,EAA0C,KAAKO,kBAA/C,EAAmE,IAAnE;AACA,wBAAS,KAAKzB,SAAd,EAAyBpL,oBAAUqM,UAAnC,EAA+C,KAAKQ,kBAApD,EAAwE,IAAxE;AACA,MAAI,KAAKK,aAAL,KAAuBp1B,SAA3B,EAAsC;AACpC82B,wBAAoB5O,oBAAU6O,MAA9B,EAAsC,KAAK3B,aAA3C,EAA0D,KAA1D;AACA,SAAKA,aAAL,GAAqBp1B,SAArB;AACD;AACD,MAAI,KAAK2yB,kBAAT,EAA6B;AAC3BqE,yBAAqB,KAAKrE,kBAA1B;AACA,SAAKA,kBAAL,GAA0B3yB,SAA1B;AACD;AACD,OAAKi3B,SAAL,CAAe,IAAf;AACApS,mBAAWvL,SAAX,CAAqBkN,eAArB,CAAqC7L,IAArC,CAA0C,IAA1C;AACD,CAfD;;AAkBA;;;;;;;;;;;;;;;;;;;AAmBAiR,aAAatS,SAAb,CAAuB4d,qBAAvB,GAA+C,UAASvK,KAAT,EAAgBwK,QAAhB,EAA0BvS,WAA1B,EAAuC;AACpF,MAAI,CAAC,KAAKqO,WAAV,EAAuB;AACrB;AACD;AACD,MAAMpG,aAAa,KAAKC,sBAAL,CAA4BH,KAA5B,CAAnB;AACA/H,gBAAcA,gBAAgB5kB,SAAhB,GAA4B4kB,WAA5B,GAA0C,EAAxD;AACA,MAAMwS,eAAexS,YAAYwS,YAAZ,KAA6Bp3B,SAA7B,GACnB4kB,YAAYwS,YAAZ,GAA2B,KAAKnE,WAAL,CAAiBvK,UADzB,GACsC,CAD3D;AAEA,MAAM2O,cAAczS,YAAYyS,WAAZ,KAA4Br3B,SAA5B,GAClB4kB,YAAYyS,WADM,GACQC,eAD5B;AAEA,SAAO,KAAKnC,SAAL,CAAeoC,0BAAf,CACL1K,UADK,EACO,KAAKoG,WADZ,EACyBmE,YADzB,EACuCD,QADvC,EACiD,IADjD,EAELE,WAFK,EAEQ,IAFR,CAAP;AAGD,CAbD;;AAgBA;;;;;;;;AAQAzL,aAAatS,SAAb,CAAuBke,kBAAvB,GAA4C,UAAS7K,KAAT,EAAgB/H,WAAhB,EAA6B;AACvE,MAAI6S,WAAW,IAAf;AACA,OAAKP,qBAAL,CAA2BvK,KAA3B,EAAkC,UAAS9e,OAAT,EAAkB;AAClD,QAAI,CAAC4pB,QAAL,EAAe;AACbA,iBAAW,EAAX;AACD;AACDA,aAASr2B,IAAT,CAAcyM,OAAd;AACD,GALD,EAKG+W,WALH;AAMA,SAAO6S,QAAP;AACD,CATD;;AAWA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA7L,aAAatS,SAAb,CAAuBoe,mBAAvB,GAA6C,UAAS/K,KAAT,EAAgBwK,QAAhB,EAA0BQ,QAA1B,EAAoCC,eAApC,EAAqDC,SAArD,EAAgE;AAC3G,MAAI,CAAC,KAAK5E,WAAV,EAAuB;AACrB;AACD;AACD,MAAM6E,UAAUH,aAAa33B,SAAb,GAAyB23B,QAAzB,GAAoC,IAApD;AACA,MAAMN,cAAcO,oBAAoB53B,SAApB,GAAgC43B,eAAhC,GAAkDN,eAAtE;AACA,MAAMS,WAAWF,cAAc73B,SAAd,GAA0B63B,SAA1B,GAAsC,IAAvD;AACA,SAAO,KAAK1C,SAAL,CAAeuC,mBAAf,CACL/K,KADK,EACE,KAAKsG,WADP,EACoBkE,QADpB,EAC8BW,OAD9B,EAELT,WAFK,EAEQU,QAFR,CAAP;AAGD,CAVD;;AAaA;;;;;;;;;AASAnM,aAAatS,SAAb,CAAuB0e,iBAAvB,GAA2C,UAASrL,KAAT,EAAgB/H,WAAhB,EAA6B;AACtE,MAAI,CAAC,KAAKqO,WAAV,EAAuB;AACrB,WAAO,KAAP;AACD;AACD,MAAMpG,aAAa,KAAKC,sBAAL,CAA4BH,KAA5B,CAAnB;AACA/H,gBAAcA,gBAAgB5kB,SAAhB,GAA4B4kB,WAA5B,GAA0C,EAAxD;AACA,MAAMyS,cAAczS,YAAYyS,WAAZ,KAA4Br3B,SAA5B,GAAwC4kB,YAAYyS,WAApD,GAAkEC,eAAtF;AACA,MAAMF,eAAexS,YAAYwS,YAAZ,KAA6Bp3B,SAA7B,GACnB4kB,YAAYwS,YAAZ,GAA2B,KAAKnE,WAAL,CAAiBvK,UADzB,GACsC,CAD3D;AAEA,SAAO,KAAKyM,SAAL,CAAe8C,sBAAf,CACLpL,UADK,EACO,KAAKoG,WADZ,EACyBmE,YADzB,EACuCC,WADvC,EACoD,IADpD,CAAP;AAED,CAXD;;AAcA;;;;;;AAMAzL,aAAatS,SAAb,CAAuB4e,kBAAvB,GAA4C,UAAS/I,KAAT,EAAgB;AAC1D,SAAO,KAAKrC,sBAAL,CAA4B,KAAKF,aAAL,CAAmBuC,KAAnB,CAA5B,CAAP;AACD,CAFD;;AAKA;;;;;;AAMAvD,aAAatS,SAAb,CAAuBsT,aAAvB,GAAuC,UAASuC,KAAT,EAAgB;AACrD,MAAMgJ,mBAAmB,KAAK7E,SAAL,CAAe8E,qBAAf,EAAzB;AACA,MAAMC,gBAAgBlJ,MAAMmJ,cAAN,GAAuBnJ,MAAMmJ,cAAN,CAAqB,CAArB,CAAvB,GAAiDnJ,KAAvE;AACA,SAAO,CACLkJ,cAAcrI,OAAd,GAAwBmI,iBAAiBI,IADpC,EAELF,cAAcpI,OAAd,GAAwBkI,iBAAiBK,GAFpC,CAAP;AAID,CAPD;;AAUA;;;;;;;;;AASA5M,aAAatS,SAAb,CAAuBmf,SAAvB,GAAmC,YAAW;AAC5C,SAAO,wCAAyC,KAAK9wB,GAAL,CAASiuB,sBAAYhF,MAArB;AAAhD;AACD,CAFD;;AAKA;;;;;;;AAOAhF,aAAatS,SAAb,CAAuBof,gBAAvB,GAA0C,YAAW;AACnD,MAAM56B,SAAS,KAAK26B,SAAL,EAAf;AACA,MAAI36B,WAAWkC,SAAf,EAA0B;AACxB,WAAO,OAAOlC,MAAP,KAAkB,QAAlB,GAA6B8xB,SAAS+I,cAAT,CAAwB76B,MAAxB,CAA7B,GAA+DA,MAAtE;AACD,GAFD,MAEO;AACL,WAAO,IAAP;AACD;AACF,CAPD;;AAUA;;;;;;;AAOA8tB,aAAatS,SAAb,CAAuBwT,sBAAvB,GAAgD,UAASH,KAAT,EAAgB;AAC9D,MAAM2D,aAAa,KAAK2C,WAAxB;AACA,MAAI,CAAC3C,UAAL,EAAiB;AACf,WAAO,IAAP;AACD,GAFD,MAEO;AACL,WAAO,sBAAeA,WAAWsI,0BAA1B,EAAsDjM,MAAM1tB,KAAN,EAAtD,CAAP;AACD;AACF,CAPD;;AAUA;;;;;;AAMA2sB,aAAatS,SAAb,CAAuBid,WAAvB,GAAqC,YAAW;AAC9C,SAAO,KAAK7K,QAAZ;AACD,CAFD;;AAKA;;;;;;AAMAE,aAAatS,SAAb,CAAuBud,WAAvB,GAAqC,YAAW;AAC9C,SAAO,KAAK7B,SAAZ;AACD,CAFD;;AAKA;;;;;;;;AAQApJ,aAAatS,SAAb,CAAuBuf,cAAvB,GAAwC,UAASv5B,EAAT,EAAa;AACnD,MAAM+2B,UAAU,KAAKnB,eAAL,CAAqB51B,GAAG2C,QAAH,EAArB,CAAhB;AACA,SAAOo0B,YAAYr2B,SAAZ,GAAwBq2B,OAAxB,GAAkC,IAAzC;AACD,CAHD;;AAMA;;;;;;;;AAQAzK,aAAatS,SAAb,CAAuBmd,eAAvB,GAAyC,YAAW;AAClD,SAAO,KAAK9K,YAAZ;AACD,CAFD;;AAKA;;;;;;AAMAC,aAAatS,SAAb,CAAuBod,aAAvB,GAAuC,YAAW;AAChD;AACE,wCAAsC,KAAK/uB,GAAL,CAASiuB,sBAAYlF,UAArB;AADxC;AAGD,CAJD;;AAOA;;;;;AAKA9E,aAAatS,SAAb,CAAuBqd,SAAvB,GAAmC,YAAW;AAC5C,MAAM33B,SAAS,KAAK03B,aAAL,GAAqBC,SAArB,EAAf;AACA,SAAO33B,MAAP;AACD,CAHD;;AAMA;;;;;;;AAOA4sB,aAAatS,SAAb,CAAuBwf,sBAAvB,GAAgD,UAASjM,UAAT,EAAqB;AACnE,MAAMyD,aAAa,KAAK2C,WAAxB;AACA,MAAI,CAAC3C,UAAL,EAAiB;AACf,WAAO,IAAP;AACD,GAFD,MAEO;AACL,WAAO,sBAAeA,WAAWyI,0BAA1B,EAAsDlM,WAAW5tB,KAAX,CAAiB,CAAjB,EAAoB,CAApB,CAAtD,CAAP;AACD;AACF,CAPD;;AAUA;;;;AAIA2sB,aAAatS,SAAb,CAAuB0f,WAAvB,GAAqC,YAAW;AAC9C,SAAO,KAAK7D,SAAZ;AACD,CAFD;;AAKA;;;;;;AAMAvJ,aAAatS,SAAb,CAAuB2f,OAAvB,GAAiC,YAAW;AAC1C;AACE,gDAA8C,KAAKtxB,GAAL,CAASiuB,sBAAYjF,IAArB;AADhD;AAGD,CAJD;;AAOA;;;;;;;AAOA/E,aAAatS,SAAb,CAAuB4f,OAAvB,GAAiC,YAAW;AAC1C;AACE,iCAA+B,KAAKvxB,GAAL,CAASiuB,sBAAY/E,IAArB;AADjC;AAGD,CAJD;;AAOA;;;;;AAKAjF,aAAatS,SAAb,CAAuBqU,WAAvB,GAAqC,YAAW;AAC9C,SAAO,KAAK2F,SAAZ;AACD,CAFD;;AAKA;;;;;;;AAOA1H,aAAatS,SAAb,CAAuB6f,mBAAvB,GAA6C,YAAW;AACtD,SAAO,KAAKnF,iBAAZ;AACD,CAFD;;AAKA;;;;;;;AAOApI,aAAatS,SAAb,CAAuB8f,4BAAvB,GAAsD,YAAW;AAC/D,SAAO,KAAKlF,0BAAZ;AACD,CAFD;;AAKA;;;;;;;AAOAtI,aAAatS,SAAb,CAAuBmc,eAAvB,GAAyC,UAAS4D,IAAT,EAAeC,aAAf,EAA8BC,UAA9B,EAA0CC,cAA1C,EAA0D;AACjG;AACA;AACA,MAAMlJ,aAAa,KAAK2C,WAAxB;AACA,MAAI,CAAC3C,UAAD,IAAe,EAAEgJ,iBAAiBhJ,WAAWmJ,WAA9B,CAAnB,EAA+D;AAC7D,WAAOC,mBAAP;AACD;AACD,MAAI,CAACpJ,WAAWmJ,WAAX,CAAuBH,aAAvB,EAAsCD,KAAKM,MAAL,EAAtC,CAAL,EAA2D;AACzD,WAAOD,mBAAP;AACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA,MAAME,SAASL,WAAW,CAAX,IAAgBjJ,WAAWuJ,KAAX,CAAiB,CAAjB,CAA/B;AACA,MAAMC,SAASP,WAAW,CAAX,IAAgBjJ,WAAWuJ,KAAX,CAAiB,CAAjB,CAA/B;AACA,SAAO,QAAQ12B,KAAKyG,GAAL,CAAS4vB,cAAT,CAAR,GACHr2B,KAAKsG,IAAL,CAAUmwB,SAASA,MAAT,GAAkBE,SAASA,MAArC,IAA+CN,cADnD;AAED,CApBD;;AAuBA;;;;AAIA5N,aAAatS,SAAb,CAAuByb,kBAAvB,GAA4C,UAASzI,YAAT,EAAuByN,QAAvB,EAAiC;AAC3E,MAAMr6B,OAAOq6B,YAAYzN,aAAa5sB,IAAtC;AACA,MAAMs6B,kBAAkB,IAAI3N,yBAAJ,CAAoB3sB,IAApB,EAA0B,IAA1B,EAAgC4sB,YAAhC,CAAxB;AACA,OAAKoI,qBAAL,CAA2BsF,eAA3B;AACD,CAJD;;AAOA;;;AAGApO,aAAatS,SAAb,CAAuBob,qBAAvB,GAA+C,UAASsF,eAAT,EAA0B;AACvE,MAAI,CAAC,KAAK/G,WAAV,EAAuB;AACrB;AACA;AACA;AACD;AACD,OAAKoC,MAAL,GAAc2E,gBAAgBnN,UAA9B;AACAmN,kBAAgB1J,UAAhB,GAA6B,KAAK2C,WAAlC;AACA,MAAMgH,oBAAoB,KAAKxD,eAAL,GAAuBlR,QAAvB,EAA1B;AACA,MAAI,KAAKI,aAAL,CAAmBqU,eAAnB,MAAwC,KAA5C,EAAmD;AACjD,SAAK,IAAI56B,IAAI66B,kBAAkB56B,MAAlB,GAA2B,CAAxC,EAA2CD,KAAK,CAAhD,EAAmDA,GAAnD,EAAwD;AACtD,UAAM+2B,cAAc8D,kBAAkB76B,CAAlB,CAApB;AACA,UAAI,CAAC+2B,YAAY+D,SAAZ,EAAL,EAA8B;AAC5B;AACD;AACD,UAAMC,OAAOhE,YAAYiE,WAAZ,CAAwBJ,eAAxB,CAAb;AACA,UAAI,CAACG,IAAL,EAAW;AACT;AACD;AACF;AACF;AACF,CArBD;;AAwBA;;;AAGAvO,aAAatS,SAAb,CAAuB+gB,gBAAvB,GAA0C,YAAW;;AAEnD,MAAM/J,aAAa,KAAK2C,WAAxB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMqH,YAAY,KAAK/E,UAAvB;AACA,MAAI,CAAC+E,UAAUC,OAAV,EAAL,EAA0B;AACxB,QAAIC,kBAAkB,KAAKnI,gBAA3B;AACA,QAAIoI,cAAcD,eAAlB;AACA,QAAIlK,UAAJ,EAAgB;AACd,UAAMoK,QAAQpK,WAAWqK,SAAzB;AACA,UAAID,MAAME,mBAASC,SAAf,CAAJ,EAA+B;AAC7BL,0BAAkB,KAAKjI,wBAAL,GAAgC,CAAhC,GAAoC,CAAtD;AACAkI,sBAAc,CAAd;AACD;AACD,UAAIC,MAAME,mBAASE,WAAf,CAAJ,EAAiC;AAC/BN,0BAAkB,KAAK/H,0BAAL,GAAkC,CAAlC,GAAsC,CAAxD;AACAgI,sBAAc,CAAd;AACD;AACF;AACD,QAAIH,UAAUS,eAAV,KAA8BP,eAAlC,EAAmD;AACjDF,gBAAUU,YAAV,GADiD,CACvB;AAC1BV,gBAAUW,aAAV,CAAwBT,eAAxB,EAAyCC,WAAzC;AACD;AACF;;AAED,MAAMS,sBAAsB,KAAK5F,oBAAjC;AACA,OAAK,IAAIl2B,IAAI,CAAR,EAAWwkB,KAAKsX,oBAAoB77B,MAAzC,EAAiDD,IAAIwkB,EAArD,EAAyD,EAAExkB,CAA3D,EAA8D;AAC5D87B,wBAAoB97B,CAApB,EAAuB,IAAvB,EAA6BkxB,UAA7B;AACD;AACD4K,sBAAoB77B,MAApB,GAA6B,CAA7B;AACD,CAvCD;;AA0CA;;;AAGAusB,aAAatS,SAAb,CAAuByc,kBAAvB,GAA4C,YAAW;AACrD,OAAKoF,MAAL;AACD,CAFD;;AAKA;;;AAGAvP,aAAatS,SAAb,CAAuB0c,oBAAvB,GAA8C,YAAW;AACvD;AACA;AACA;AACA;;AAEA,MAAIoF,sBAAJ;AACA,MAAI,KAAK3C,SAAL,EAAJ,EAAsB;AACpB2C,oBAAgB,KAAK1C,gBAAL,EAAhB;AACD;;AAED,MAAI,KAAK7D,eAAT,EAA0B;AACxB,SAAK,IAAIz1B,IAAI,CAAR,EAAWwkB,KAAK,KAAKiR,eAAL,CAAqBx1B,MAA1C,EAAkDD,IAAIwkB,EAAtD,EAA0D,EAAExkB,CAA5D,EAA+D;AAC7D,iCAAc,KAAKy1B,eAAL,CAAqBz1B,CAArB,CAAd;AACD;AACD,SAAKy1B,eAAL,GAAuB,IAAvB;AACD;;AAED,MAAI,CAACuG,aAAL,EAAoB;AAClB,SAAKjG,SAAL,CAAekG,oBAAf;AACA,yBAAW,KAAK/H,SAAhB;AACA,QAAI,KAAK8B,aAAL,KAAuBp1B,SAA3B,EAAsC;AACpC82B,0BAAoB5O,oBAAU6O,MAA9B,EAAsC,KAAK3B,aAA3C,EAA0D,KAA1D;AACA,WAAKA,aAAL,GAAqBp1B,SAArB;AACD;AACF,GAPD,MAOO;AACLo7B,kBAAcnH,WAAd,CAA0B,KAAKX,SAA/B;;AAEA,QAAMsB,sBAAsB,CAAC,KAAKD,oBAAN,GAC1ByG,aAD0B,GACV,KAAKzG,oBADvB;AAEA,SAAKE,eAAL,GAAuB,CACrB,oBAAOD,mBAAP,EAA4B1M,oBAAUoT,OAAtC,EAA+C,KAAKvG,kBAApD,EAAwE,IAAxE,CADqB,EAErB,oBAAOH,mBAAP,EAA4B1M,oBAAUqT,QAAtC,EAAgD,KAAKxG,kBAArD,EAAyE,IAAzE,CAFqB,CAAvB;;AAKA,QAAI,CAAC,KAAKK,aAAV,EAAyB;AACvB,WAAKA,aAAL,GAAqB,KAAKoG,UAAL,CAAgB9lB,IAAhB,CAAqB,IAArB,CAArB;AACA+lB,uBAAiBvT,oBAAU6O,MAA3B,EAAmC,KAAK3B,aAAxC,EAAuD,KAAvD;AACD;AACF;;AAED,OAAKoG,UAAL;AACA;AACA;AACD,CA5CD;;AA+CA;;;AAGA5P,aAAatS,SAAb,CAAuBoc,iBAAvB,GAA2C,YAAW;AACpD,OAAKyF,MAAL;AACD,CAFD;;AAKA;;;AAGAvP,aAAatS,SAAb,CAAuBoiB,0BAAvB,GAAoD,YAAW;AAC7D,OAAKP,MAAL;AACD,CAFD;;AAKA;;;AAGAvP,aAAatS,SAAb,CAAuBwc,kBAAvB,GAA4C,YAAW;AACrD,MAAI,KAAK3C,wBAAT,EAAmC;AACjC,+BAAc,KAAKA,wBAAnB;AACA,SAAKA,wBAAL,GAAgC,IAAhC;AACD;AACD,MAAI,KAAKC,sBAAT,EAAiC;AAC/B,+BAAc,KAAKA,sBAAnB;AACA,SAAKA,sBAAL,GAA8B,IAA9B;AACD;AACD,MAAMr1B,OAAO,KAAKm7B,OAAL,EAAb;AACA,MAAIn7B,IAAJ,EAAU;AACR,SAAKu1B,SAAL,CAAeqI,YAAf,CAA4B,WAA5B,EAAyC,mBAAO59B,IAAP,CAAzC;AACA,SAAKo1B,wBAAL,GAAgC,oBAC9Bp1B,IAD8B,EACxByzB,0BAAgBC,cADQ,EAE9B,KAAKiK,0BAFyB,EAEG,IAFH,CAAhC;AAGA,SAAKtI,sBAAL,GAA8B,oBAC5Br1B,IAD4B,EACtBmqB,oBAAUC,MADY,EAE5B,KAAKuT,0BAFuB,EAEK,IAFL,CAA9B;AAGD;AACD,OAAKP,MAAL;AACD,CApBD;;AAuBA;;;AAGAvP,aAAatS,SAAb,CAAuBuc,wBAAvB,GAAkD,YAAW;AAC3D,MAAI,KAAKxC,+BAAT,EAA0C;AACxC,SAAKA,+BAAL,CAAqCv0B,OAArC,CAA6C4wB,qBAA7C;AACA,SAAK2D,+BAAL,GAAuC,IAAvC;AACD;AACD,MAAMuI,aAAa,KAAKlF,aAAL,EAAnB;AACA,MAAIkF,UAAJ,EAAgB;AACd,SAAKvI,+BAAL,GAAuC,CACrC,oBACEuI,UADF,EACcpK,0BAAgBC,cAD9B,EAEE,KAAK0J,MAFP,EAEe,IAFf,CADqC,EAIrC,oBACES,UADF,EACc1T,oBAAUC,MADxB,EAEE,KAAKgT,MAFP,EAEe,IAFf,CAJqC,CAAvC;AAQD;AACD,OAAKA,MAAL;AACD,CAjBD;;AAoBA;;;AAGAvP,aAAatS,SAAb,CAAuBuiB,UAAvB,GAAoC,YAAW;AAC7C,SAAO,CAAC,CAAC,KAAK5I,WAAd;AACD,CAFD;;AAKA;;;;AAIArH,aAAatS,SAAb,CAAuBwiB,UAAvB,GAAoC,YAAW;AAC7C,MAAI,KAAKnJ,kBAAT,EAA6B;AAC3BqE,yBAAqB,KAAKrE,kBAA1B;AACD;AACD,OAAKC,eAAL;AACD,CALD;;AAQA;;;;AAIAhH,aAAatS,SAAb,CAAuB6hB,MAAvB,GAAgC,YAAW;AACzC,MAAI,KAAKxI,kBAAL,KAA4B3yB,SAAhC,EAA2C;AACzC,SAAK2yB,kBAAL,GAA0BoJ,sBAAsB,KAAKnJ,eAA3B,CAA1B;AACD;AACF,CAJD;;AAOA;;;;;;;AAOAhH,aAAatS,SAAb,CAAuB0iB,aAAvB,GAAuC,UAAS/F,OAAT,EAAkB;AACvD,SAAO,KAAKM,WAAL,GAAmBxQ,MAAnB,CAA0BkQ,OAA1B,CAAP;AACD,CAFD;;AAKA;;;;;;;AAOArK,aAAatS,SAAb,CAAuB2iB,iBAAvB,GAA2C,UAAS9F,WAAT,EAAsB;AAC/D,SAAO,KAAKM,eAAL,GAAuB1Q,MAAvB,CAA8BoQ,WAA9B,CAAP;AACD,CAFD;;AAKA;;;;;;;AAOAvK,aAAatS,SAAb,CAAuB4iB,WAAvB,GAAqC,UAAS9+B,KAAT,EAAgB;AACnD,MAAM4B,SAAS,KAAK03B,aAAL,GAAqBC,SAArB,EAAf;AACA,SAAO33B,OAAO+mB,MAAP,CAAc3oB,KAAd,CAAP;AACD,CAHD;;AAMA;;;;;;;AAOAwuB,aAAatS,SAAb,CAAuB6iB,aAAvB,GAAuC,UAAS9F,OAAT,EAAkB;AACvD,SAAO,KAAKQ,WAAL,GAAmB9Q,MAAnB,CAA0BsQ,OAA1B,CAAP;AACD,CAFD;;AAKA;;;;AAIAzK,aAAatS,SAAb,CAAuBuZ,YAAvB,GAAsC,UAASuJ,IAAT,EAAe;AACnD,MAAIC,kBAAJ;;AAEA,MAAMhZ,OAAO,KAAK4V,OAAL,EAAb;AACA,MAAMl7B,OAAO,KAAKm7B,OAAL,EAAb;AACA,MAAM1Q,SAAS,0BAAf;AACA,MAAM8T,qBAAqB,KAAKrJ,WAAhC;AACA;AACA,MAAI3C,aAAa,IAAjB;AACA,MAAIjN,SAASrjB,SAAT,IAAsB,mBAAQqjB,IAAR,CAAtB,IAAuCtlB,IAAvC,IAA+CA,KAAKw+B,KAAL,EAAnD,EAAiE;AAC/D,QAAM5B,YAAY58B,KAAKy+B,QAAL,CAAc,KAAKvJ,WAAL,GAAmB,KAAKA,WAAL,CAAiB0H,SAApC,GAAgD36B,SAA9D,CAAlB;AACA,QAAMy8B,mBAAmB,KAAK/F,aAAL,GAAqBgG,mBAArB,EAAzB;AACA,QAAMC,cAAc,EAApB;AACA,SAAK,IAAIv9B,IAAI,CAAR,EAAWwkB,KAAK6Y,iBAAiBp9B,MAAtC,EAA8CD,IAAIwkB,EAAlD,EAAsD,EAAExkB,CAAxD,EAA2D;AACzDu9B,kBAAY,mBAAOF,iBAAiBr9B,CAAjB,EAAoBhC,KAA3B,CAAZ,IAAiDq/B,iBAAiBr9B,CAAjB,CAAjD;AACD;AACDi9B,gBAAYt+B,KAAKmrB,QAAL,EAAZ;AACA,QAAI2Q,QAAQ,KAAKxE,MAAjB;AACA,QAAI,CAACwE,KAAL,EAAY;AACVA,cAAQwC,UAAUp+B,MAAlB;AACA,UAAM2+B,kBAAkBP,UAAU5T,UAAV,GAAuB,KAAKI,WAApD;AACAgR,YAAM,CAAN,IAAW12B,KAAKoH,KAAL,CAAWsvB,MAAM,CAAN,IAAW+C,eAAtB,IAAyCA,eAApD;AACA/C,YAAM,CAAN,IAAW12B,KAAKoH,KAAL,CAAWsvB,MAAM,CAAN,IAAW+C,eAAtB,IAAyCA,eAApD;AACD;AACDtM,iBAAa,gDAAkD;AAC7DuM,eAAS,KADoD;AAE7D9D,kCAA4B,KAAKjG,2BAF4B;AAG7DtK,cAAQA,MAHqD;AAI7DqR,aAAOA,KAJsD;AAK7Dp2B,aAAO,KAAKuvB,WAAL,EALsD;AAM7D2J,mBAAaA,WANgD;AAO7DF,wBAAkBA,gBAP2C;AAQ7D/T,kBAAY,KAAKG,WAR4C;AAS7D+P,kCAA4B,KAAK7F,2BAT4B;AAU7DmI,2BAAqB,EAVwC;AAW7D7X,YAAMA,IAXuD;AAY7DyZ,0BAAoB,KAAKnH,mBAZoC;AAa7D2E,iBAAW,KAAK/E,UAb6C;AAc7D6G,YAAMA,IAduD;AAe7DW,iBAAW,EAfkD;AAgB7DV,iBAAWA,SAhBkD;AAiB7D1B,iBAAWA,SAjBkD;AAkB7DlB,mBAAa;AAlBgD,KAA/D;AAoBD;;AAED,MAAInJ,UAAJ,EAAgB;AACdA,eAAW9H,MAAX,GAAoB,+BAAkB6T,UAAUp+B,MAA5B,EAClBo+B,UAAU5T,UADQ,EACI4T,UAAUW,QADd,EACwB1M,WAAWjN,IADnC,EACyCmF,MADzC,CAApB;AAED;;AAED,OAAKyK,WAAL,GAAmB3C,UAAnB;AACA,OAAK6E,SAAL,CAAe8H,WAAf,CAA2B3M,UAA3B;;AAEA,MAAIA,UAAJ,EAAgB;AACd,QAAIA,WAAWuM,OAAf,EAAwB;AACtB,WAAK1B,MAAL;AACD;AACD16B,UAAM6Y,SAAN,CAAgBlY,IAAhB,CAAqBQ,KAArB,CAA2B,KAAK0zB,oBAAhC,EAAsDhF,WAAW4K,mBAAjE;;AAEA,QAAIoB,kBAAJ,EAAwB;AACtB,UAAMY,YAAY,CAAC,KAAKhK,eAAN,IACL,CAAC,qBAAQ,KAAKA,eAAb,CAAD,IACD,CAAC,oBAAO5C,WAAW9H,MAAlB,EAA0B,KAAK0K,eAA/B,CAFb;AAGA,UAAIgK,SAAJ,EAAe;AACb,aAAKvX,aAAL,CACE,IAAI8G,kBAAJ,CAAa0Q,uBAAa3M,SAA1B,EAAqC,IAArC,EAA2C8L,kBAA3C,CADF;AAEA,aAAKpJ,eAAL,GAAuB,iCAAoB,KAAKA,eAAzB,CAAvB;AACD;AACF;;AAED,QAAMkK,OAAO,KAAKlK,eAAL,IACT,CAAC5C,WAAWqK,SAAX,CAAqBC,mBAASC,SAA9B,CADQ,IAET,CAACvK,WAAWqK,SAAX,CAAqBC,mBAASE,WAA9B,CAFQ,IAGT,CAAC,oBAAOxK,WAAW9H,MAAlB,EAA0B,KAAK0K,eAA/B,CAHL;;AAKA,QAAIkK,IAAJ,EAAU;AACR,WAAKzX,aAAL,CAAmB,IAAI8G,kBAAJ,CAAa0Q,uBAAa1M,OAA1B,EAAmC,IAAnC,EAAyCH,UAAzC,CAAnB;AACA,yBAAMA,WAAW9H,MAAjB,EAAyB,KAAK0K,eAA9B;AACD;AACF;;AAED,OAAKvN,aAAL,CAAmB,IAAI8G,kBAAJ,CAAa0Q,uBAAa5M,UAA1B,EAAsC,IAAtC,EAA4CD,UAA5C,CAAnB;;AAEAtB,aAAW,KAAKqL,gBAAL,CAAsB3kB,IAAtB,CAA2B,IAA3B,CAAX,EAA6C,CAA7C;AAED,CAtFD;;AAyFA;;;;;;AAMAkW,aAAatS,SAAb,CAAuB+jB,aAAvB,GAAuC,UAASzB,UAAT,EAAqB;AAC1D,OAAKzV,GAAL,CAASyP,sBAAYlF,UAArB,EAAiCkL,UAAjC;AACD,CAFD;;AAKA;;;;;;AAMAhQ,aAAatS,SAAb,CAAuBgkB,OAAvB,GAAiC,UAASja,IAAT,EAAe;AAC9C,OAAK8C,GAAL,CAASyP,sBAAYjF,IAArB,EAA2BtN,IAA3B;AACD,CAFD;;AAKA;;;;;;;AAOAuI,aAAatS,SAAb,CAAuB2d,SAAvB,GAAmC,UAASn5B,MAAT,EAAiB;AAClD,OAAKqoB,GAAL,CAASyP,sBAAYhF,MAArB,EAA6B9yB,MAA7B;AACD,CAFD;;AAKA;;;;;;AAMA8tB,aAAatS,SAAb,CAAuBikB,OAAvB,GAAiC,UAASx/B,IAAT,EAAe;AAC9C,OAAKooB,GAAL,CAASyP,sBAAY/E,IAArB,EAA2B9yB,IAA3B;AACD,CAFD;;AAKA;;;AAGA6tB,aAAatS,SAAb,CAAuBkkB,WAAvB,GAAqC,UAAS3vB,OAAT,EAAkB;AACrD,MAAM4vB,aAAa,mBAAO5vB,OAAP,EAAgB5L,QAAhB,EAAnB;AACA,OAAK0zB,mBAAL,CAAyB8H,UAAzB,IAAuC,IAAvC;AACA,OAAKtC,MAAL;AACD,CAJD;;AAOA;;;;;AAKAvP,aAAatS,SAAb,CAAuBkiB,UAAvB,GAAoC,YAAW;AAC7C,MAAMJ,gBAAgB,KAAK1C,gBAAL,EAAtB;;AAEA,MAAI,CAAC0C,aAAL,EAAoB;AAClB,SAAKkC,OAAL,CAAat9B,SAAb;AACD,GAFD,MAEO;AACL,QAAM09B,gBAAgBC,iBAAiBvC,aAAjB,CAAtB;AACA,SAAKkC,OAAL,CAAa,CACXlC,cAAcwC,WAAd,GACIjd,WAAW+c,cAAc,iBAAd,CAAX,CADJ,GAEI/c,WAAW+c,cAAc,aAAd,CAAX,CAFJ,GAGI/c,WAAW+c,cAAc,cAAd,CAAX,CAHJ,GAII/c,WAAW+c,cAAc,kBAAd,CAAX,CALO,EAMXtC,cAAcyC,YAAd,GACIld,WAAW+c,cAAc,gBAAd,CAAX,CADJ,GAEI/c,WAAW+c,cAAc,YAAd,CAAX,CAFJ,GAGI/c,WAAW+c,cAAc,eAAd,CAAX,CAHJ,GAII/c,WAAW+c,cAAc,mBAAd,CAAX,CAVO,CAAb;AAYD;AACF,CApBD;;AAuBA;;;AAGA9R,aAAatS,SAAb,CAAuBwkB,aAAvB,GAAuC,UAASjwB,OAAT,EAAkB;AACvD,MAAM4vB,aAAa,mBAAO5vB,OAAP,EAAgB5L,QAAhB,EAAnB;AACA,SAAO,KAAK0zB,mBAAL,CAAyB8H,UAAzB,CAAP;AACA,OAAKtC,MAAL;AACD,CAJD;;AAOA;;;;AAIA,SAAS/I,qBAAT,CAA+BjsB,OAA/B,EAAwC;;AAEtC;;;AAGA,MAAIyuB,sBAAsB,IAA1B;AACA,MAAIzuB,QAAQyuB,mBAAR,KAAgC50B,SAApC,EAA+C;AAC7C40B,0BAAsB,OAAOzuB,QAAQyuB,mBAAf,KAAuC,QAAvC,GACpBhF,SAAS+I,cAAT,CAAwBxyB,QAAQyuB,mBAAhC,CADoB,GAEpBzuB,QAAQyuB,mBAFV;AAGD;;AAED;;;AAGA,MAAMlmB,SAAS,EAAf;;AAEA,MAAMktB,aAAcz1B,QAAQnH,MAAR,YAA0B++B,eAA3B,GACjB53B,QAAQnH,MADS,GACA,IAAI++B,eAAJ,CAAe,EAAC/+B,QAAQmH,QAAQnH,MAAjB,EAAf,CADnB;AAEA0P,SAAOknB,sBAAYlF,UAAnB,IAAiCkL,UAAjC;;AAEAltB,SAAOknB,sBAAYhF,MAAnB,IAA6BzqB,QAAQrI,MAArC;;AAEA4Q,SAAOknB,sBAAY/E,IAAnB,IAA2B1qB,QAAQpI,IAAR,KAAiBiC,SAAjB,GACzBmG,QAAQpI,IADiB,GACV,IAAIC,cAAJ,EADjB;;AAGA,MAAI0tB,iBAAJ;AACA,MAAIvlB,QAAQulB,QAAR,KAAqB1rB,SAAzB,EAAoC;AAClC,QAAIS,MAAMC,OAAN,CAAcyF,QAAQulB,QAAtB,CAAJ,EAAqC;AACnCA,iBAAW,IAAIhH,oBAAJ,CAAeve,QAAQulB,QAAR,CAAiBzsB,KAAjB,EAAf,CAAX;AACD,KAFD,MAEO;AACL,2BAAOkH,QAAQulB,QAAR,YAA4BhH,oBAAnC,EACE,EADF,EADK,CAEE;AACPgH,iBAAWvlB,QAAQulB,QAAnB;AACD;AACF;;AAED,MAAIC,qBAAJ;AACA,MAAIxlB,QAAQwlB,YAAR,KAAyB3rB,SAA7B,EAAwC;AACtC,QAAIS,MAAMC,OAAN,CAAcyF,QAAQwlB,YAAtB,CAAJ,EAAyC;AACvCA,qBAAe,IAAIjH,oBAAJ,CAAeve,QAAQwlB,YAAR,CAAqB1sB,KAArB,EAAf,CAAf;AACD,KAFD,MAEO;AACL,2BAAOkH,QAAQwlB,YAAR,YAAgCjH,oBAAvC,EACE,EADF,EADK,CAEE;AACPiH,qBAAexlB,QAAQwlB,YAAvB;AACD;AACF;;AAED,MAAIsJ,iBAAJ;AACA,MAAI9uB,QAAQ8uB,QAAR,KAAqBj1B,SAAzB,EAAoC;AAClC,QAAIS,MAAMC,OAAN,CAAcyF,QAAQ8uB,QAAtB,CAAJ,EAAqC;AACnCA,iBAAW,IAAIvQ,oBAAJ,CAAeve,QAAQ8uB,QAAR,CAAiBh2B,KAAjB,EAAf,CAAX;AACD,KAFD,MAEO;AACL,2BAAOkH,QAAQ8uB,QAAR,YAA4BvQ,oBAAnC,EACE,EADF,EADK,CAEE;AACPuQ,iBAAW9uB,QAAQ8uB,QAAnB;AACD;AACF,GARD,MAQO;AACLA,eAAW,IAAIvQ,oBAAJ,EAAX;AACD;;AAED,SAAO;AACLgH,cAAUA,QADL;AAELC,kBAAcA,YAFT;AAGLiJ,yBAAqBA,mBAHhB;AAILK,cAAUA,QAJL;AAKLvmB,YAAQA;AALH,GAAP;AAQD;kBACckd,Y;;;;;;;;;;;;;;;;;;AC/7Cf;;AACA;;;;AACA;;AACA;;;;AACA;;;;;;AAGA;;;;AAKA;;;;;;;;;AASA,IAAM4J,YAAY,SAAZA,SAAY,CAASwI,oBAAT,EAA+BC,kBAA/B,EAAmD;;AAEnEC,0BAAcvjB,IAAd,CACE,IADF;AAEE;;;;AAIA,YAAS8J,OAAT,EAAkB;AAChB,WAAOuZ,qBAAqBp8B,KAArB,CAA2B,IAA3B,EAAiC6iB,OAAjC,CAAP;AACD,GARH;AASE;;;;AAIA,YAASA,OAAT,EAAkB;AAChB,WAAQ,8BAA+BA,QAAQ,CAAR,CAAD,CAAakV,MAAb;AAAtC;AACD,GAfH;;AAiBA;;;;AAIA,OAAKwE,mBAAL,GAA2BF,kBAA3B;;AAEA;;;;AAIA,OAAKG,aAAL,GAAqB,CAArB;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,EAAzB;AAED,CArCD,C,CAxBA;;;;;AA+DA,qBAAS7I,SAAT,EAAoB0I,uBAApB;;AAGA;;;AAGA1I,UAAUlc,SAAV,CAAoBglB,OAApB,GAA8B,UAAS7Z,OAAT,EAAkB;AAC9C,MAAM8Z,QAAQL,wBAAc5kB,SAAd,CAAwBglB,OAAxB,CAAgC3jB,IAAhC,CAAqC,IAArC,EAA2C8J,OAA3C,CAAd;AACA,MAAI8Z,KAAJ,EAAW;AACT,QAAMlF,OAAO5U,QAAQ,CAAR,CAAb;AACA,wBAAO4U,IAAP,EAAanR,oBAAUC,MAAvB,EAA+B,KAAKqW,gBAApC,EAAsD,IAAtD;AACD;AACD,SAAOD,KAAP;AACD,CAPD;;AAUA;;;AAGA/I,UAAUlc,SAAV,CAAoByhB,eAApB,GAAsC,YAAW;AAC/C,SAAO,KAAKqD,aAAZ;AACD,CAFD;;AAKA;;;;AAIA5I,UAAUlc,SAAV,CAAoBklB,gBAApB,GAAuC,UAASrP,KAAT,EAAgB;AACrD,MAAMkK,OAAO,6BAA+BlK,MAAMrxB,MAAlD;AACA,MAAM6qB,QAAQ0Q,KAAKnQ,QAAL,EAAd;AACA,MAAIP,UAAU8V,oBAAU/U,MAApB,IAA8Bf,UAAU8V,oBAAU1U,KAAlD,IACApB,UAAU8V,oBAAUC,KADpB,IAC6B/V,UAAU8V,oBAAUE,KADrD,EAC4D;AAC1D,0BAAStF,IAAT,EAAenR,oBAAUC,MAAzB,EAAiC,KAAKqW,gBAAtC,EAAwD,IAAxD;AACA,QAAMI,UAAUvF,KAAKM,MAAL,EAAhB;AACA,QAAIiF,WAAW,KAAKP,iBAApB,EAAuC;AACrC,aAAO,KAAKA,iBAAL,CAAuBO,OAAvB,CAAP;AACA,QAAE,KAAKR,aAAP;AACD;AACD,SAAKD,mBAAL;AACD;AACF,CAbD;;AAgBA;;;;AAIA3I,UAAUlc,SAAV,CAAoB2hB,aAApB,GAAoC,UAAST,eAAT,EAA0BC,WAA1B,EAAuC;AACzE,MAAIoE,WAAW,CAAf;AACA,MAAIC,eAAe,KAAnB;AACA,MAAInW,cAAJ;AAAA,MAAW0Q,aAAX;AAAA,MAAiBuF,gBAAjB;AACA,SAAO,KAAKR,aAAL,GAAqB5D,eAArB,IAAwCqE,WAAWpE,WAAnD,IACA,KAAKsE,QAAL,KAAkB,CADzB,EAC4B;AAC1B1F,WAAO,6BAA+B,KAAK2F,OAAL,GAAe,CAAf,CAAtC;AACAJ,cAAUvF,KAAKM,MAAL,EAAV;AACAhR,YAAQ0Q,KAAKnQ,QAAL,EAAR;AACA,QAAIP,UAAU8V,oBAAUE,KAAxB,EAA+B;AAC7BG,qBAAe,IAAf;AACD,KAFD,MAEO,IAAInW,UAAU8V,oBAAUhV,IAApB,IAA4B,EAAEmV,WAAW,KAAKP,iBAAlB,CAAhC,EAAsE;AAC3E,WAAKA,iBAAL,CAAuBO,OAAvB,IAAkC,IAAlC;AACA,QAAE,KAAKR,aAAP;AACA,QAAES,QAAF;AACAxF,WAAKlQ,IAAL;AACD;AACF;AACD,MAAI0V,aAAa,CAAb,IAAkBC,YAAtB,EAAoC;AAClC;AACA;AACA,SAAKX,mBAAL;AACD;AACF,CAvBD;kBAwBe3I,S;;;;;;;;;;;;;;;;;QCxFCyJ,c,GAAAA,c;AA/ChB;;;AAGA;;;;;;;;;;;AAWA,IAAMC,YAAY,SAAZA,SAAY,CAASC,IAAT,EAAeC,IAAf,EAAqBC,IAArB,EAA2BC,IAA3B,EAAiC;;AAEjD;;;AAGA,OAAKH,IAAL,GAAYA,IAAZ;;AAEA;;;AAGA,OAAKC,IAAL,GAAYA,IAAZ;;AAEA;;;AAGA,OAAKC,IAAL,GAAYA,IAAZ;;AAEA;;;AAGA,OAAKC,IAAL,GAAYA,IAAZ;AAED,CAtBD;;AAyBA;;;;;;;;AAQO,SAASL,cAAT,CAAwBE,IAAxB,EAA8BC,IAA9B,EAAoCC,IAApC,EAA0CC,IAA1C,EAAgDC,SAAhD,EAA2D;AAChE,MAAIA,cAAcv/B,SAAlB,EAA6B;AAC3Bu/B,cAAUJ,IAAV,GAAiBA,IAAjB;AACAI,cAAUH,IAAV,GAAiBA,IAAjB;AACAG,cAAUF,IAAV,GAAiBA,IAAjB;AACAE,cAAUD,IAAV,GAAiBA,IAAjB;AACA,WAAOC,SAAP;AACD,GAND,MAMO;AACL,WAAO,IAAIL,SAAJ,CAAcC,IAAd,EAAoBC,IAApB,EAA0BC,IAA1B,EAAgCC,IAAhC,CAAP;AACD;AACF;;AAGD;;;;AAIAJ,UAAU5lB,SAAV,CAAoBkmB,QAApB,GAA+B,UAASC,SAAT,EAAoB;AACjD,SAAO,KAAKC,UAAL,CAAgBD,UAAU,CAAV,CAAhB,EAA8BA,UAAU,CAAV,CAA9B,CAAP;AACD,CAFD;;AAKA;;;;AAIAP,UAAU5lB,SAAV,CAAoBqmB,iBAApB,GAAwC,UAASJ,SAAT,EAAoB;AAC1D,SAAO,KAAKJ,IAAL,IAAaI,UAAUJ,IAAvB,IAA+BI,UAAUH,IAAV,IAAkB,KAAKA,IAAtD,IACH,KAAKC,IAAL,IAAaE,UAAUF,IADpB,IAC4BE,UAAUD,IAAV,IAAkB,KAAKA,IAD1D;AAED,CAHD;;AAMA;;;;;AAKAJ,UAAU5lB,SAAV,CAAoBomB,UAApB,GAAiC,UAASl2B,CAAT,EAAY+N,CAAZ,EAAe;AAC9C,SAAO,KAAK4nB,IAAL,IAAa31B,CAAb,IAAkBA,KAAK,KAAK41B,IAA5B,IAAoC,KAAKC,IAAL,IAAa9nB,CAAjD,IAAsDA,KAAK,KAAK+nB,IAAvE;AACD,CAFD;;AAKA;;;;AAIAJ,UAAU5lB,SAAV,CAAoBsmB,MAApB,GAA6B,UAASL,SAAT,EAAoB;AAC/C,SAAO,KAAKJ,IAAL,IAAaI,UAAUJ,IAAvB,IAA+B,KAAKE,IAAL,IAAaE,UAAUF,IAAtD,IACH,KAAKD,IAAL,IAAaG,UAAUH,IADpB,IAC4B,KAAKE,IAAL,IAAaC,UAAUD,IAD1D;AAED,CAHD;;AAMA;;;AAGAJ,UAAU5lB,SAAV,CAAoB+L,MAApB,GAA6B,UAASka,SAAT,EAAoB;AAC/C,MAAIA,UAAUJ,IAAV,GAAiB,KAAKA,IAA1B,EAAgC;AAC9B,SAAKA,IAAL,GAAYI,UAAUJ,IAAtB;AACD;AACD,MAAII,UAAUH,IAAV,GAAiB,KAAKA,IAA1B,EAAgC;AAC9B,SAAKA,IAAL,GAAYG,UAAUH,IAAtB;AACD;AACD,MAAIG,UAAUF,IAAV,GAAiB,KAAKA,IAA1B,EAAgC;AAC9B,SAAKA,IAAL,GAAYE,UAAUF,IAAtB;AACD;AACD,MAAIE,UAAUD,IAAV,GAAiB,KAAKA,IAA1B,EAAgC;AAC9B,SAAKA,IAAL,GAAYC,UAAUD,IAAtB;AACD;AACF,CAbD;;AAgBA;;;AAGAJ,UAAU5lB,SAAV,CAAoBumB,SAApB,GAAgC,YAAW;AACzC,SAAO,KAAKP,IAAL,GAAY,KAAKD,IAAjB,GAAwB,CAA/B;AACD,CAFD;;AAKA;;;AAGAH,UAAU5lB,SAAV,CAAoB2f,OAApB,GAA8B,YAAW;AACvC,SAAO,CAAC,KAAK6G,QAAL,EAAD,EAAkB,KAAKD,SAAL,EAAlB,CAAP;AACD,CAFD;;AAKA;;;AAGAX,UAAU5lB,SAAV,CAAoBwmB,QAApB,GAA+B,YAAW;AACxC,SAAO,KAAKV,IAAL,GAAY,KAAKD,IAAjB,GAAwB,CAA/B;AACD,CAFD;;AAKA;;;;AAIAD,UAAU5lB,SAAV,CAAoBymB,UAApB,GAAiC,UAASR,SAAT,EAAoB;AACnD,SAAO,KAAKJ,IAAL,IAAaI,UAAUH,IAAvB,IACH,KAAKA,IAAL,IAAaG,UAAUJ,IADpB,IAEH,KAAKE,IAAL,IAAaE,UAAUD,IAFpB,IAGH,KAAKA,IAAL,IAAaC,UAAUF,IAH3B;AAID,CALD;kBAMeH,S;;;;;;;;;;;;;;;;;ACxJf;;;;AAIA;;;kBAGe;AACbzV,QAAM,CADO;AAEbO,WAAS,CAFI;AAGbN,UAAQ,CAHK;AAIbK,SAAO,CAJM;AAKb2U,SAAO,CALM;AAMbC,SAAO;AANM,C;;;;;;;;;;;;;;;;;QCmsCCqB,sB,GAAAA,sB;QAcAC,0B,GAAAA,0B;QAiFAC,wB,GAAAA,wB;QAyBAC,e,GAAAA,e;;AA/zChB;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;;;AAGA;;;;;;;;;;;;;;;;;;AAmBA;;;;;;;AAQA;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA;;;;;;;;;;;;;;;;;;;;AAqBA;;;;;;;;;AAUA;;;;AAIA,IAAMC,mBAAmB,CAAzB;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA9KA;;;AAuOA,IAAMpiC,OAAO,SAAPA,IAAO,CAAS4mB,WAAT,EAAsB;AACjCC,mBAAWlK,IAAX,CAAgB,IAAhB;;AAEA,MAAMxU,UAAU,iBAAO,EAAP,EAAWye,WAAX,CAAhB;;AAEA;;;;AAIA,OAAKyb,MAAL,GAAc,CAAC,CAAD,EAAI,CAAJ,CAAd;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmB,EAAnB;;AAEA;;;;AAIA,OAAKC,mBAAL;;AAEA,OAAKC,iBAAL,GAAyB,KAAKA,iBAAL,CAAuB9qB,IAAvB,CAA4B,IAA5B,CAAzB;;AAEA;;;;;AAKA,OAAK+qB,WAAL,GAAmB,4BAAiBt6B,QAAQu6B,UAAzB,EAAqC,WAArC,CAAnB;;AAEA,OAAKC,aAAL,CAAmBx6B,OAAnB;AACD,CAjCD;;AAmCA,qBAASnI,IAAT,EAAe6mB,gBAAf;;AAGA;;;;AAIA7mB,KAAKsb,SAAL,CAAeqnB,aAAf,GAA+B,UAASx6B,OAAT,EAAkB;;AAE/C;;;AAGA,MAAM2C,aAAa,EAAnB;AACAA,aAAW83B,uBAAaC,MAAxB,IAAkC16B,QAAQlI,MAAR,KAAmB+B,SAAnB,GAChCmG,QAAQlI,MADwB,GACf,IADnB;;AAGA,MAAM6iC,2BAA2Bb,2BAA2B95B,OAA3B,CAAjC;;AAEA;;;;AAIA,OAAK46B,cAAL,GAAsBD,yBAAyBE,aAA/C;;AAEA;;;;AAIA,OAAKC,cAAL,GAAsBH,yBAAyBI,aAA/C;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmBL,yBAAyBM,UAA5C;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoBl7B,QAAQm7B,WAA5B;;AAEA;;;;AAIA,OAAKC,QAAL,GAAgBT,yBAAyBU,OAAzC;;AAEA,MAAMC,mBAAmBzB,uBAAuB75B,OAAvB,CAAzB;AACA,MAAMu7B,uBAAuBZ,yBAAyBa,UAAtD;AACA,MAAMC,qBAAqB1B,yBAAyB/5B,OAAzB,CAA3B;;AAEA;;;;AAIA,OAAK07B,YAAL,GAAoB;AAClB5jC,YAAQwjC,gBADU;AAElBhZ,gBAAYiZ,oBAFM;AAGlB1E,cAAU4E;AAHQ,GAApB;;AAMA,MAAIz7B,QAAQsiB,UAAR,KAAuBzoB,SAA3B,EAAsC;AACpC8I,eAAW83B,uBAAakB,UAAxB,IAAsC37B,QAAQsiB,UAA9C;AACD,GAFD,MAEO,IAAItiB,QAAQjI,IAAR,KAAiB8B,SAArB,EAAgC;AACrC8I,eAAW83B,uBAAakB,UAAxB,IAAsC,KAAKC,mBAAL,CACpC,KAAKhB,cAD+B,EACf56B,QAAQjI,IAAR,GAAe,KAAKqjC,QADL,CAAtC;;AAGA,QAAI,KAAKF,YAAT,EAAuB;AAAE;AACvBv4B,iBAAW83B,uBAAakB,UAAxB,IAAsC,iBACpC38B,OAAO,KAAK8jB,aAAL,MAAwBngB,WAAW83B,uBAAakB,UAAxB,CAA/B,CADoC,EAEpC,KAAKb,cAF+B,EAEf,KAAKF,cAFU,CAAtC;AAGD;AACF;AACDj4B,aAAW83B,uBAAaoB,QAAxB,IAAoC77B,QAAQ62B,QAAR,KAAqBh9B,SAArB,GAAiCmG,QAAQ62B,QAAzC,GAAoD,CAAxF;AACA,OAAK1V,aAAL,CAAmBxe,UAAnB;;AAEA;;;;AAIA,OAAKm5B,QAAL,GAAgB97B,OAAhB;AAED,CA5ED;;AA8EA;;;;;;;;AAQAnI,KAAKsb,SAAL,CAAe4oB,kBAAf,GAAoC,UAASC,UAAT,EAAqB;AACvD,MAAMh8B,UAAU,iBAAO,EAAP,EAAW,KAAK87B,QAAhB,CAAhB;;AAEA;AACA,MAAI97B,QAAQsiB,UAAR,KAAuBzoB,SAA3B,EAAsC;AACpCmG,YAAQsiB,UAAR,GAAqB,KAAKQ,aAAL,EAArB;AACD,GAFD,MAEO;AACL9iB,YAAQjI,IAAR,GAAe,KAAKkkC,OAAL,EAAf;AACD;;AAED;AACAj8B,UAAQlI,MAAR,GAAiB,KAAKokC,SAAL,EAAjB;;AAEA;AACAl8B,UAAQ62B,QAAR,GAAmB,KAAKsF,WAAL,EAAnB;;AAEA,SAAO,iBAAO,EAAP,EAAWn8B,OAAX,EAAoBg8B,UAApB,CAAP;AACD,CAjBD;;AAoBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCAnkC,KAAKsb,SAAL,CAAeujB,OAAf,GAAyB,UAAS0F,QAAT,EAAmB;AAC1C,MAAIC,iBAAiBC,UAAUpjC,MAA/B;AACA,MAAI83B,iBAAJ;AACA,MAAIqL,iBAAiB,CAAjB,IAAsB,OAAOC,UAAUD,iBAAiB,CAA3B,CAAP,KAAyC,UAAnE,EAA+E;AAC7ErL,eAAWsL,UAAUD,iBAAiB,CAA3B,CAAX;AACA,MAAEA,cAAF;AACD;AACD,MAAI,CAAC,KAAKjG,KAAL,EAAL,EAAmB;AACjB;AACA,QAAM5T,QAAQ8Z,UAAUD,iBAAiB,CAA3B,CAAd;AACA,QAAI7Z,MAAM1qB,MAAV,EAAkB;AAChB,WAAKykC,SAAL,CAAe/Z,MAAM1qB,MAArB;AACD;AACD,QAAI0qB,MAAMzqB,IAAN,KAAe8B,SAAnB,EAA8B;AAC5B,WAAK2iC,OAAL,CAAaha,MAAMzqB,IAAnB;AACD;AACD,QAAIyqB,MAAMqU,QAAN,KAAmBh9B,SAAvB,EAAkC;AAChC,WAAK4iC,WAAL,CAAiBja,MAAMqU,QAAvB;AACD;AACD,QAAI7F,QAAJ,EAAc;AACZnI,iBAAW,YAAW;AACpBmI,iBAAS,IAAT;AACD,OAFD,EAEG,CAFH;AAGD;AACD;AACD;AACD,MAAI0L,QAAQhY,KAAKC,GAAL,EAAZ;AACA,MAAI7sB,SAAS,KAAKokC,SAAL,GAAiBpjC,KAAjB,EAAb;AACA,MAAIwpB,aAAa,KAAKQ,aAAL,EAAjB;AACA,MAAI+T,WAAW,KAAKsF,WAAL,EAAf;AACA,MAAMQ,SAAS,EAAf;AACA,OAAK,IAAI1jC,IAAI,CAAb,EAAgBA,IAAIojC,cAApB,EAAoC,EAAEpjC,CAAtC,EAAyC;AACvC,QAAM+G,UAAU,8CAAgDs8B,UAAUrjC,CAAV,CAAhE;;AAEA,QAAM2jC,YAAY,uCAAyC;AACzDF,aAAOA,KADkD;AAEzDG,gBAAU,KAF+C;AAGzDC,cAAQ98B,QAAQ88B,MAHyC;AAIzDhY,gBAAU9kB,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,IAJL;AAKzDiY,cAAQ/8B,QAAQ+8B,MAAR,IAAkBC;AAL+B,KAA3D;;AAQA,QAAIh9B,QAAQlI,MAAZ,EAAoB;AAClB8kC,gBAAUK,YAAV,GAAyBnlC,MAAzB;AACA8kC,gBAAUM,YAAV,GAAyBl9B,QAAQlI,MAAjC;AACAA,eAAS8kC,UAAUM,YAAnB;AACD;;AAED,QAAIl9B,QAAQjI,IAAR,KAAiB8B,SAArB,EAAgC;AAC9B+iC,gBAAUO,gBAAV,GAA6B7a,UAA7B;AACAsa,gBAAUQ,gBAAV,GAA6B,KAAKxB,mBAAL,CAC3B,KAAKhB,cADsB,EACN56B,QAAQjI,IAAR,GAAe,KAAKqjC,QADd,EACwB,CADxB,CAA7B;AAEA9Y,mBAAasa,UAAUQ,gBAAvB;AACD,KALD,MAKO,IAAIp9B,QAAQsiB,UAAZ,EAAwB;AAC7Bsa,gBAAUO,gBAAV,GAA6B7a,UAA7B;AACAsa,gBAAUQ,gBAAV,GAA6Bp9B,QAAQsiB,UAArC;AACAA,mBAAasa,UAAUQ,gBAAvB;AACD;;AAED,QAAIp9B,QAAQ62B,QAAR,KAAqBh9B,SAAzB,EAAoC;AAClC+iC,gBAAUS,cAAV,GAA2BxG,QAA3B;AACA,UAAMyG,QAAQ,kBAAOt9B,QAAQ62B,QAAR,GAAmBA,QAAnB,GAA8B75B,KAAKiG,EAA1C,EAA8C,IAAIjG,KAAKiG,EAAvD,IAA6DjG,KAAKiG,EAAhF;AACA25B,gBAAUW,cAAV,GAA2B1G,WAAWyG,KAAtC;AACAzG,iBAAW+F,UAAUW,cAArB;AACD;;AAEDX,cAAU5L,QAAV,GAAqBA,QAArB;;AAEA;AACA,QAAIgJ,gBAAgB4C,SAAhB,CAAJ,EAAgC;AAC9BA,gBAAUC,QAAV,GAAqB,IAArB;AACA;AACD,KAHD,MAGO;AACLH,eAASE,UAAU9X,QAAnB;AACD;AACD6X,WAAO1hC,IAAP,CAAY2hC,SAAZ;AACD;AACD,OAAKzC,WAAL,CAAiBl/B,IAAjB,CAAsB0hC,MAAtB;AACA,OAAKa,OAAL,CAAa/I,mBAASC,SAAtB,EAAiC,CAAjC;AACA,OAAK2F,iBAAL;AACD,CAhFD;;AAmFA;;;;;AAKAxiC,KAAKsb,SAAL,CAAesqB,YAAf,GAA8B,YAAW;AACvC,SAAO,KAAKvD,MAAL,CAAYzF,mBAASC,SAArB,IAAkC,CAAzC;AACD,CAFD;;AAKA;;;;;AAKA78B,KAAKsb,SAAL,CAAeuqB,cAAf,GAAgC,YAAW;AACzC,SAAO,KAAKxD,MAAL,CAAYzF,mBAASE,WAArB,IAAoC,CAA3C;AACD,CAFD;;AAKA;;;;AAIA98B,KAAKsb,SAAL,CAAewqB,gBAAf,GAAkC,YAAW;AAC3C,OAAKH,OAAL,CAAa/I,mBAASC,SAAtB,EAAiC,CAAC,KAAKwF,MAAL,CAAYzF,mBAASC,SAArB,CAAlC;AACA,OAAK,IAAIz7B,IAAI,CAAR,EAAWwkB,KAAK,KAAK0c,WAAL,CAAiBjhC,MAAtC,EAA8CD,IAAIwkB,EAAlD,EAAsD,EAAExkB,CAAxD,EAA2D;AACzD,QAAM0jC,SAAS,KAAKxC,WAAL,CAAiBlhC,CAAjB,CAAf;AACA,QAAI0jC,OAAO,CAAP,EAAU3L,QAAd,EAAwB;AACtB2L,aAAO,CAAP,EAAU3L,QAAV,CAAmB,KAAnB;AACD;AACF;AACD,OAAKmJ,WAAL,CAAiBjhC,MAAjB,GAA0B,CAA1B;AACD,CATD;;AAWA;;;AAGArB,KAAKsb,SAAL,CAAeknB,iBAAf,GAAmC,YAAW;AAAA;;AAC5C,MAAI,KAAKD,mBAAL,KAA6BvgC,SAAjC,EAA4C;AAC1Cg3B,yBAAqB,KAAKuJ,mBAA1B;AACA,SAAKA,mBAAL,GAA2BvgC,SAA3B;AACD;AACD,MAAI,CAAC,KAAK4jC,YAAL,EAAL,EAA0B;AACxB;AACD;AACD,MAAM9Y,MAAMD,KAAKC,GAAL,EAAZ;AACA,MAAIiZ,OAAO,KAAX;AACA,OAAK,IAAI3kC,IAAI,KAAKkhC,WAAL,CAAiBjhC,MAAjB,GAA0B,CAAvC,EAA0CD,KAAK,CAA/C,EAAkD,EAAEA,CAApD,EAAuD;AACrD,QAAM0jC,SAAS,KAAKxC,WAAL,CAAiBlhC,CAAjB,CAAf;AACA,QAAI4kC,iBAAiB,IAArB;AACA,SAAK,IAAI17B,IAAI,CAAR,EAAW27B,KAAKnB,OAAOzjC,MAA5B,EAAoCiJ,IAAI27B,EAAxC,EAA4C,EAAE37B,CAA9C,EAAiD;AAC/C,UAAMy6B,YAAYD,OAAOx6B,CAAP,CAAlB;AACA,UAAIy6B,UAAUC,QAAd,EAAwB;AACtB;AACD;AACD,UAAMkB,UAAUpZ,MAAMiY,UAAUF,KAAhC;AACA,UAAIsB,WAAWpB,UAAU9X,QAAV,GAAqB,CAArB,GAAyBiZ,UAAUnB,UAAU9X,QAA7C,GAAwD,CAAvE;AACA,UAAIkZ,YAAY,CAAhB,EAAmB;AACjBpB,kBAAUC,QAAV,GAAqB,IAArB;AACAmB,mBAAW,CAAX;AACD,OAHD,MAGO;AACLH,yBAAiB,KAAjB;AACD;AACD,UAAMx3B,WAAWu2B,UAAUG,MAAV,CAAiBiB,QAAjB,CAAjB;AACA,UAAIpB,UAAUK,YAAd,EAA4B;AAC1B,YAAMgB,KAAKrB,UAAUK,YAAV,CAAuB,CAAvB,CAAX;AACA,YAAMiB,KAAKtB,UAAUK,YAAV,CAAuB,CAAvB,CAAX;AACA,YAAMkB,KAAKvB,UAAUM,YAAV,CAAuB,CAAvB,CAAX;AACA,YAAMkB,KAAKxB,UAAUM,YAAV,CAAuB,CAAvB,CAAX;AACA,YAAM75B,IAAI46B,KAAK53B,YAAY83B,KAAKF,EAAjB,CAAf;AACA,YAAM7sB,IAAI8sB,KAAK73B,YAAY+3B,KAAKF,EAAjB,CAAf;AACA,aAAKle,GAAL,CAASya,uBAAaC,MAAtB,EAA8B,CAACr3B,CAAD,EAAI+N,CAAJ,CAA9B;AACD;AACD,UAAIwrB,UAAUO,gBAAV,IAA8BP,UAAUQ,gBAA5C,EAA8D;AAC5D,YAAM9a,aAAajc,aAAa,CAAb,GACjBu2B,UAAUQ,gBADO,GAEjBR,UAAUO,gBAAV,GAA6B92B,YAAYu2B,UAAUQ,gBAAV,GAA6BR,UAAUO,gBAAnD,CAF/B;AAGA,YAAIP,UAAUE,MAAd,EAAsB;AACpB,eAAK9c,GAAL,CAASya,uBAAaC,MAAtB,EACE,KAAK2D,mBAAL,CAAyB/b,UAAzB,EAAqCsa,UAAUE,MAA/C,CADF;AAED;AACD,aAAK9c,GAAL,CAASya,uBAAakB,UAAtB,EAAkCrZ,UAAlC;AACD;AACD,UAAIsa,UAAUS,cAAV,KAA6BxjC,SAA7B,IAA0C+iC,UAAUW,cAAV,KAA6B1jC,SAA3E,EAAsF;AACpF,YAAMg9B,WAAWxwB,aAAa,CAAb,GACf,kBAAOu2B,UAAUW,cAAV,GAA2BvgC,KAAKiG,EAAvC,EAA2C,IAAIjG,KAAKiG,EAApD,IAA0DjG,KAAKiG,EADhD,GAEf25B,UAAUS,cAAV,GAA2Bh3B,YAAYu2B,UAAUW,cAAV,GAA2BX,UAAUS,cAAjD,CAF7B;AAGA,YAAIT,UAAUE,MAAd,EAAsB;AACpB,eAAK9c,GAAL,CAASya,uBAAaC,MAAtB,EACE,KAAK4D,qBAAL,CAA2BzH,QAA3B,EAAqC+F,UAAUE,MAA/C,CADF;AAED;AACD,aAAK9c,GAAL,CAASya,uBAAaoB,QAAtB,EAAgChF,QAAhC;AACD;AACD+G,aAAO,IAAP;AACA,UAAI,CAAChB,UAAUC,QAAf,EAAyB;AACvB;AACD;AACF;AACD,QAAIgB,cAAJ,EAAoB;AAAA;AAClB,cAAK1D,WAAL,CAAiBlhC,CAAjB,IAAsB,IAAtB;AACA,cAAKukC,OAAL,CAAa/I,mBAASC,SAAtB,EAAiC,CAAC,CAAlC;AACA,YAAM1D,WAAW2L,OAAO,CAAP,EAAU3L,QAA3B;AACA,YAAIA,QAAJ,EAAc;AACZnI,qBAAW,YAAW;AACpBmI,qBAAS,IAAT;AACD,WAFD,EAEG,CAFH;AAGD;AARiB;AASnB;AACF;AACD;AACA,OAAKmJ,WAAL,GAAmB,KAAKA,WAAL,CAAiBz/B,MAAjB,CAAwB+H,OAAxB,CAAnB;AACA,MAAIm7B,QAAQ,KAAKxD,mBAAL,KAA6BvgC,SAAzC,EAAoD;AAClD,SAAKugC,mBAAL,GAA2BxE,sBAAsB,KAAKyE,iBAA3B,CAA3B;AACD;AACF,CA7ED;;AA+EA;;;;;AAKAxiC,KAAKsb,SAAL,CAAemrB,qBAAf,GAAuC,UAASzH,QAAT,EAAmBiG,MAAnB,EAA2B;AAChE,MAAIhlC,eAAJ;AACA,MAAMymC,gBAAgB,KAAKrC,SAAL,EAAtB;AACA,MAAIqC,kBAAkB1kC,SAAtB,EAAiC;AAC/B/B,aAAS,CAACymC,cAAc,CAAd,IAAmBzB,OAAO,CAAP,CAApB,EAA+ByB,cAAc,CAAd,IAAmBzB,OAAO,CAAP,CAAlD,CAAT;AACA,4BAAiBhlC,MAAjB,EAAyB++B,WAAW,KAAKsF,WAAL,EAApC;AACA,yBAAcrkC,MAAd,EAAsBglC,MAAtB;AACD;AACD,SAAOhlC,MAAP;AACD,CATD;;AAYA;;;;;AAKAD,KAAKsb,SAAL,CAAekrB,mBAAf,GAAqC,UAAS/b,UAAT,EAAqBwa,MAArB,EAA6B;AAChE,MAAIhlC,eAAJ;AACA,MAAMymC,gBAAgB,KAAKrC,SAAL,EAAtB;AACA,MAAMsC,oBAAoB,KAAK1b,aAAL,EAA1B;AACA,MAAIyb,kBAAkB1kC,SAAlB,IAA+B2kC,sBAAsB3kC,SAAzD,EAAoE;AAClE,QAAMwJ,IAAIy5B,OAAO,CAAP,IAAYxa,cAAcwa,OAAO,CAAP,IAAYyB,cAAc,CAAd,CAA1B,IAA8CC,iBAApE;AACA,QAAMptB,IAAI0rB,OAAO,CAAP,IAAYxa,cAAcwa,OAAO,CAAP,IAAYyB,cAAc,CAAd,CAA1B,IAA8CC,iBAApE;AACA1mC,aAAS,CAACuL,CAAD,EAAI+N,CAAJ,CAAT;AACD;AACD,SAAOtZ,MAAP;AACD,CAVD;;AAaA;;;;AAIAD,KAAKsb,SAAL,CAAesrB,oBAAf,GAAsC,YAAW;AAC/C,MAAMvhB,OAAO,CAAC,GAAD,EAAM,GAAN,CAAb;AACA,MAAMwhB,WAAW,6BAA6B,mBAAO,IAAP,CAA7B,GAA4C,IAA7D;AACA,MAAMpgB,UAAUmL,SAASkV,aAAT,CAAuBD,QAAvB,CAAhB;AACA,MAAIpgB,OAAJ,EAAa;AACX,QAAMsgB,UAAUpH,iBAAiBlZ,OAAjB,CAAhB;AACApB,SAAK,CAAL,IAAUzC,SAASmkB,QAAQnR,KAAjB,EAAwB,EAAxB,CAAV;AACAvQ,SAAK,CAAL,IAAUzC,SAASmkB,QAAQlR,MAAjB,EAAyB,EAAzB,CAAV;AACD;AACD,SAAOxQ,IAAP;AACD,CAVD;;AAaA;;;;;;AAMArlB,KAAKsb,SAAL,CAAe0rB,eAAf,GAAiC,UAAS/mC,MAAT,EAAiB;AAChD,SAAO,KAAK4jC,YAAL,CAAkB5jC,MAAlB,CAAyBA,MAAzB,CAAP;AACD,CAFD;;AAKA;;;;;;;;AAQAD,KAAKsb,SAAL,CAAeyoB,mBAAf,GAAqC,UAAStZ,UAAT,EAAqBwc,SAArB,EAAgCC,aAAhC,EAA+C;AAClF,MAAMzB,QAAQwB,aAAa,CAA3B;AACA,MAAME,YAAYD,iBAAiB,CAAnC;AACA,SAAO,KAAKrD,YAAL,CAAkBpZ,UAAlB,CAA6BA,UAA7B,EAAyCgb,KAAzC,EAAgD0B,SAAhD,CAAP;AACD,CAJD;;AAOA;;;;;;;AAOAnnC,KAAKsb,SAAL,CAAe8rB,iBAAf,GAAmC,UAASpI,QAAT,EAAmBiI,SAAnB,EAA8B;AAC/D,MAAMxB,QAAQwB,aAAa,CAA3B;AACA,SAAO,KAAKpD,YAAL,CAAkB7E,QAAlB,CAA2BA,QAA3B,EAAqCyG,KAArC,CAAP;AACD,CAHD;;AAMA;;;;;;AAMAzlC,KAAKsb,SAAL,CAAe+oB,SAAf,GAA2B,YAAW;AACpC;AACE,4DAA0D,KAAK16B,GAAL,CAASi5B,uBAAaC,MAAtB;AAD5D;AAGD,CAJD;;AAOA;;;AAGA7iC,KAAKsb,SAAL,CAAe+rB,cAAf,GAAgC,YAAW;AACzC,SAAO,KAAKxD,YAAZ;AACD,CAFD;;AAKA;;;;AAIA7jC,KAAKsb,SAAL,CAAekjB,QAAf,GAA0B,UAAS8I,SAAT,EAAoB;AAC5C,MAAIA,cAActlC,SAAlB,EAA6B;AAC3BslC,cAAU,CAAV,IAAe,KAAKjF,MAAL,CAAY,CAAZ,CAAf;AACAiF,cAAU,CAAV,IAAe,KAAKjF,MAAL,CAAY,CAAZ,CAAf;AACA,WAAOiF,SAAP;AACD,GAJD,MAIO;AACL,WAAO,KAAKjF,MAAL,CAAYphC,KAAZ,EAAP;AACD;AACF,CARD;;AAWA;;;;;;;;;;AAUAjB,KAAKsb,SAAL,CAAeisB,eAAf,GAAiC,UAASC,QAAT,EAAmB;AAClD,MAAMniB,OAAOmiB,YAAY,KAAKZ,oBAAL,EAAzB;AACA,MAAM3mC,SAAS,+CAAiD,KAAKokC,SAAL,EAAhE;AACA,uBAAOpkC,MAAP,EAAe,CAAf,EAHkD,CAG/B;AACnB,MAAMwqB,aAAa,sBAAwB,KAAKQ,aAAL,EAA3C;AACA,uBAAOR,eAAezoB,SAAtB,EAAiC,CAAjC,EALkD,CAKb;AACrC,MAAMg9B,WAAW,sBAAwB,KAAKsF,WAAL,EAAzC;AACA,uBAAOtF,aAAah9B,SAApB,EAA+B,CAA/B,EAPkD,CAOf;;AAEnC,SAAO,+BAAkB/B,MAAlB,EAA0BwqB,UAA1B,EAAsCuU,QAAtC,EAAgD3Z,IAAhD,CAAP;AACD,CAVD;;AAaA;;;;;AAKArlB,KAAKsb,SAAL,CAAemsB,gBAAf,GAAkC,YAAW;AAC3C,SAAO,KAAK1E,cAAZ;AACD,CAFD;;AAKA;;;;;AAKA/iC,KAAKsb,SAAL,CAAeosB,gBAAf,GAAkC,YAAW;AAC3C,SAAO,KAAKzE,cAAZ;AACD,CAFD;;AAKA;;;;;AAKAjjC,KAAKsb,SAAL,CAAeqsB,UAAf,GAA4B,YAAW;AACrC,SAAO,sBAAuB,KAAKC,oBAAL,CAA0B,KAAK3E,cAA/B;AAA9B;AACD,CAFD;;AAKA;;;;;AAKAjjC,KAAKsb,SAAL,CAAeusB,UAAf,GAA4B,UAAS3nC,IAAT,EAAe;AACzC,OAAKyiC,aAAL,CAAmB,KAAKuB,kBAAL,CAAwB,EAAC4D,SAAS5nC,IAAV,EAAxB,CAAnB;AACD,CAFD;;AAKA;;;;;AAKAF,KAAKsb,SAAL,CAAeysB,UAAf,GAA4B,YAAW;AACrC,SAAO,sBAAuB,KAAKH,oBAAL,CAA0B,KAAK7E,cAA/B;AAA9B;AACD,CAFD;;AAKA;;;;;AAKA/iC,KAAKsb,SAAL,CAAe0sB,UAAf,GAA4B,UAAS9nC,IAAT,EAAe;AACzC,OAAKyiC,aAAL,CAAmB,KAAKuB,kBAAL,CAAwB,EAACV,SAAStjC,IAAV,EAAxB,CAAnB;AACD,CAFD;;AAKA;;;;;AAKAF,KAAKsb,SAAL,CAAe2sB,aAAf,GAA+B,YAAW;AACxC,SAAO,KAAKxF,WAAZ;AACD,CAFD;;AAKA;;;;;;AAMAziC,KAAKsb,SAAL,CAAe2P,aAAf,GAA+B,YAAW;AACxC,SAAO,gCAAiC,KAAKthB,GAAL,CAASi5B,uBAAakB,UAAtB;AAAxC;AACD,CAFD;;AAKA;;;;;;AAMA9jC,KAAKsb,SAAL,CAAe4sB,cAAf,GAAgC,YAAW;AACzC,SAAO,KAAK7E,YAAZ;AACD,CAFD;;AAKA;;;;;;;;AAQArjC,KAAKsb,SAAL,CAAe6sB,sBAAf,GAAwC,UAAS3d,MAAT,EAAiBgd,QAAjB,EAA2B;AACjE,MAAMniB,OAAOmiB,YAAY,KAAKZ,oBAAL,EAAzB;AACA,MAAMwB,cAAc,sBAAS5d,MAAT,IAAmBnF,KAAK,CAAL,CAAvC;AACA,MAAMgjB,cAAc,uBAAU7d,MAAV,IAAoBnF,KAAK,CAAL,CAAxC;AACA,SAAOlgB,KAAKkH,GAAL,CAAS+7B,WAAT,EAAsBC,WAAtB,CAAP;AACD,CALD;;AAQA;;;;;;AAMAroC,KAAKsb,SAAL,CAAegtB,6BAAf,GAA+C,UAASC,SAAT,EAAoB;AACjE,MAAMC,QAAQD,aAAa,CAA3B;AACA,MAAMvF,gBAAgB,KAAKD,cAA3B;AACA,MAAMG,gBAAgB,KAAKD,cAA3B;AACA,MAAM52B,MAAMlH,KAAKyG,GAAL,CAASo3B,gBAAgBE,aAAzB,IAA0C/9B,KAAKyG,GAAL,CAAS48B,KAAT,CAAtD;AACA;AACE;;;;AAIA,cAAS7jC,KAAT,EAAgB;AACd,UAAM8lB,aAAauY,gBAAgB79B,KAAKoG,GAAL,CAASi9B,KAAT,EAAgB7jC,QAAQ0H,GAAxB,CAAnC;AACA,aAAOoe,UAAP;AACD;AARH;AASD,CAdD;;AAiBA;;;;;;AAMAzqB,KAAKsb,SAAL,CAAegpB,WAAf,GAA6B,YAAW;AACtC,SAAO,sBAAuB,KAAK36B,GAAL,CAASi5B,uBAAaoB,QAAtB;AAA9B;AACD,CAFD;;AAKA;;;;;;AAMAhkC,KAAKsb,SAAL,CAAemtB,6BAAf,GAA+C,UAASF,SAAT,EAAoB;AACjE,MAAMC,QAAQD,aAAa,CAA3B;AACA,MAAMvF,gBAAgB,KAAKD,cAA3B;AACA,MAAMG,gBAAgB,KAAKD,cAA3B;AACA,MAAM52B,MAAMlH,KAAKyG,GAAL,CAASo3B,gBAAgBE,aAAzB,IAA0C/9B,KAAKyG,GAAL,CAAS48B,KAAT,CAAtD;AACA;AACE;;;;AAIA,cAAS/d,UAAT,EAAqB;AACnB,UAAM9lB,QAASQ,KAAKyG,GAAL,CAASo3B,gBAAgBvY,UAAzB,IAAuCtlB,KAAKyG,GAAL,CAAS48B,KAAT,CAAxC,GAA2Dn8B,GAAzE;AACA,aAAO1H,KAAP;AACD;AARH;AASD,CAdD;;AAiBA;;;AAGA3E,KAAKsb,SAAL,CAAe4P,QAAf,GAA0B,YAAW;AACnC,MAAMjrB,SAAS,8CAAgD,KAAKokC,SAAL,EAA/D;AACA,MAAM3B,aAAa,KAAKuF,aAAL,EAAnB;AACA,MAAMxd,aAAa,qBAAuB,KAAKQ,aAAL,EAA1C;AACA,MAAM+T,WAAW,KAAKsF,WAAL,EAAjB;AACA;AACE,uCAAqC;AACnCrkC,cAAQA,OAAOgB,KAAP,EAD2B;AAEnCyhC,kBAAYA,eAAe1gC,SAAf,GAA2B0gC,UAA3B,GAAwC,IAFjB;AAGnCjY,kBAAYA,UAHuB;AAInCuU,gBAAUA,QAJyB;AAKnC9+B,YAAM,KAAKkkC,OAAL;AAL6B;AADvC;AASD,CAdD;;AAiBA;;;;;;;AAOApkC,KAAKsb,SAAL,CAAe8oB,OAAf,GAAyB,YAAW;AAClC,MAAIlkC,aAAJ;AACA,MAAMuqB,aAAa,KAAKQ,aAAL,EAAnB;AACA,MAAIR,eAAezoB,SAAnB,EAA8B;AAC5B9B,WAAO,KAAK0nC,oBAAL,CAA0Bnd,UAA1B,CAAP;AACD;AACD,SAAOvqB,IAAP;AACD,CAPD;;AAUA;;;;;;AAMAF,KAAKsb,SAAL,CAAessB,oBAAf,GAAsC,UAASnd,UAAT,EAAqB;AACzD,MAAIie,SAAS,KAAKnF,QAAL,IAAiB,CAA9B;AACA,MAAIl3B,YAAJ;AAAA,MAAS+2B,mBAAT;AACA,MAAI,KAAKC,YAAT,EAAuB;AACrB,QAAMsF,UAAU,8BAAkB,KAAKtF,YAAvB,EAAqC5Y,UAArC,EAAiD,CAAjD,CAAhB;AACAie,aAASC,OAAT;AACAt8B,UAAM,KAAKg3B,YAAL,CAAkBsF,OAAlB,CAAN;AACA,QAAIA,WAAW,KAAKtF,YAAL,CAAkBhiC,MAAlB,GAA2B,CAA1C,EAA6C;AAC3C+hC,mBAAa,CAAb;AACD,KAFD,MAEO;AACLA,mBAAa/2B,MAAM,KAAKg3B,YAAL,CAAkBsF,UAAU,CAA5B,CAAnB;AACD;AACF,GATD,MASO;AACLt8B,UAAM,KAAK02B,cAAX;AACAK,iBAAa,KAAKD,WAAlB;AACD;AACD,SAAOuF,SAASvjC,KAAKyG,GAAL,CAASS,MAAMoe,UAAf,IAA6BtlB,KAAKyG,GAAL,CAASw3B,UAAT,CAA7C;AACD,CAjBD;;AAoBA;;;;;;AAMApjC,KAAKsb,SAAL,CAAestB,oBAAf,GAAsC,UAAS1oC,IAAT,EAAe;AACnD,SAAO,sBAAuB,KAAK6jC,mBAAL,CAC5B,KAAKhB,cADuB,EACP7iC,OAAO,KAAKqjC,QADL,EACe,CADf;AAA9B;AAED,CAHD;;AAMA;;;;;;;;;;AAUAvjC,KAAKsb,SAAL,CAAeutB,GAAf,GAAqB,UAASC,gBAAT,EAA2BliB,WAA3B,EAAwC;AAC3D,MAAMze,UAAUye,eAAe,EAA/B;AACA,MAAIvB,OAAOld,QAAQkd,IAAnB;AACA,MAAI,CAACA,IAAL,EAAW;AACTA,WAAO,KAAKuhB,oBAAL,EAAP;AACD;AACD;AACA,MAAIxd,iBAAJ;AACA,MAAI,EAAE0f,4BAA4BC,wBAA9B,CAAJ,EAAmD;AACjD,yBAAOtmC,MAAMC,OAAN,CAAcomC,gBAAd,CAAP,EACE,EADF,EADiD,CAE1C;AACP,yBAAO,CAAC,qBAAQA,gBAAR,CAAR,EACE,EADF,EAHiD,CAI1C;AACP1f,eAAW,yBAAkB0f,gBAAlB,CAAX;AACD,GAND,MAMO,IAAIA,iBAAiBtuB,OAAjB,OAA+BwuB,uBAAaC,MAAhD,EAAwD;AAC7DH,uBAAmBA,iBAAiBhe,SAAjB,EAAnB;AACA1B,eAAW,yBAAkB0f,gBAAlB,CAAX;AACA1f,aAAS8f,MAAT,CAAgB,KAAK5E,WAAL,EAAhB,EAAoC,uBAAUwE,gBAAV,CAApC;AACD,GAJM,MAIA;AACL1f,eAAW0f,gBAAX;AACD;;AAED,MAAMK,UAAUhhC,QAAQghC,OAAR,KAAoBnnC,SAApB,GAAgCmG,QAAQghC,OAAxC,GAAkD,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAlE;AACA,MAAMpF,sBAAsB57B,QAAQ47B,mBAAR,KAAgC/hC,SAAhC,GAC1BmG,QAAQ47B,mBADkB,GACI,IADhC;AAEA,MAAM4E,UAAUxgC,QAAQwgC,OAAR,KAAoB3mC,SAApB,GAAgCmG,QAAQwgC,OAAxC,GAAkD,KAAlE;AACA,MAAIzF,sBAAJ;AACA,MAAI/6B,QAAQ+6B,aAAR,KAA0BlhC,SAA9B,EAAyC;AACvCkhC,oBAAgB/6B,QAAQ+6B,aAAxB;AACD,GAFD,MAEO,IAAI/6B,QAAQ2/B,OAAR,KAAoB9lC,SAAxB,EAAmC;AACxCkhC,oBAAgB,KAAKa,mBAAL,CACd,KAAKhB,cADS,EACO56B,QAAQ2/B,OAAR,GAAkB,KAAKvE,QAD9B,EACwC,CADxC,CAAhB;AAED,GAHM,MAGA;AACLL,oBAAgB,CAAhB;AACD;AACD,MAAMkG,SAAShgB,SAASigB,kBAAT,EAAf;;AAEA;AACA,MAAMrK,WAAW,KAAKsF,WAAL,EAAjB;AACA,MAAMgF,WAAWnkC,KAAK4G,GAAL,CAAS,CAACizB,QAAV,CAAjB;AACA,MAAIuK,WAAWpkC,KAAK2G,GAAL,CAAS,CAACkzB,QAAV,CAAf;AACA,MAAIwK,UAAU,CAACh6B,QAAf;AACA,MAAIi6B,UAAU,CAACj6B,QAAf;AACA,MAAIk6B,UAAU,CAACl6B,QAAf;AACA,MAAIm6B,UAAU,CAACn6B,QAAf;AACA,MAAMo6B,SAASxgB,SAASygB,SAAT,EAAf;AACA,OAAK,IAAIzoC,IAAI,CAAR,EAAWwkB,KAAKwjB,OAAO/nC,MAA5B,EAAoCD,IAAIwkB,EAAxC,EAA4CxkB,KAAKwoC,MAAjD,EAAyD;AACvD,QAAME,OAAOV,OAAOhoC,CAAP,IAAYkoC,QAAZ,GAAuBF,OAAOhoC,IAAI,CAAX,IAAgBmoC,QAApD;AACA,QAAMQ,OAAOX,OAAOhoC,CAAP,IAAYmoC,QAAZ,GAAuBH,OAAOhoC,IAAI,CAAX,IAAgBkoC,QAApD;AACAE,cAAUrkC,KAAKiH,GAAL,CAASo9B,OAAT,EAAkBM,IAAlB,CAAV;AACAL,cAAUtkC,KAAKiH,GAAL,CAASq9B,OAAT,EAAkBM,IAAlB,CAAV;AACAL,cAAUvkC,KAAKkH,GAAL,CAASq9B,OAAT,EAAkBI,IAAlB,CAAV;AACAH,cAAUxkC,KAAKkH,GAAL,CAASs9B,OAAT,EAAkBI,IAAlB,CAAV;AACD;;AAED;AACA,MAAItf,aAAa,KAAK0d,sBAAL,CACf,CAACqB,OAAD,EAAUC,OAAV,EAAmBC,OAAnB,EAA4BC,OAA5B,CADe,EAEf,CAACtkB,KAAK,CAAL,IAAU8jB,QAAQ,CAAR,CAAV,GAAuBA,QAAQ,CAAR,CAAxB,EAAoC9jB,KAAK,CAAL,IAAU8jB,QAAQ,CAAR,CAAV,GAAuBA,QAAQ,CAAR,CAA3D,CAFe,CAAjB;AAGA1e,eAAarjB,MAAMqjB,UAAN,IAAoByY,aAApB,GACX/9B,KAAKkH,GAAL,CAASoe,UAAT,EAAqByY,aAArB,CADF;AAEA,MAAIa,mBAAJ,EAAyB;AACvB,QAAIiG,wBAAwB,KAAKjG,mBAAL,CAAyBtZ,UAAzB,EAAqC,CAArC,EAAwC,CAAxC,CAA5B;AACA,QAAI,CAACke,OAAD,IAAYqB,wBAAwBvf,UAAxC,EAAoD;AAClDuf,8BAAwB,KAAKjG,mBAAL,CACtBiG,qBADsB,EACC,CAAC,CADF,EACK,CADL,CAAxB;AAED;AACDvf,iBAAauf,qBAAb;AACD;;AAED;AACAT,aAAW,CAACA,QAAZ,CAvE2D,CAuErC;AACtB,MAAIU,aAAa,CAACT,UAAUE,OAAX,IAAsB,CAAvC;AACA,MAAIQ,aAAa,CAACT,UAAUE,OAAX,IAAsB,CAAvC;AACAM,gBAAc,CAACd,QAAQ,CAAR,IAAaA,QAAQ,CAAR,CAAd,IAA4B,CAA5B,GAAgC1e,UAA9C;AACAyf,gBAAc,CAACf,QAAQ,CAAR,IAAaA,QAAQ,CAAR,CAAd,IAA4B,CAA5B,GAAgC1e,UAA9C;AACA,MAAM0f,UAAUF,aAAaX,QAAb,GAAwBY,aAAaX,QAArD;AACA,MAAMa,UAAUF,aAAaZ,QAAb,GAAwBW,aAAaV,QAArD;AACA,MAAMtpC,SAAS,CAACkqC,OAAD,EAAUC,OAAV,CAAf;AACA,MAAMjR,WAAWhxB,QAAQgxB,QAAR,GAAmBhxB,QAAQgxB,QAA3B,GAAsC1Q,oBAAvD;;AAEA,MAAItgB,QAAQ8kB,QAAR,KAAqBjrB,SAAzB,EAAoC;AAClC,SAAK68B,OAAL,CAAa;AACXpU,kBAAYA,UADD;AAEXxqB,cAAQA,MAFG;AAGXgtB,gBAAU9kB,QAAQ8kB,QAHP;AAIXiY,cAAQ/8B,QAAQ+8B;AAJL,KAAb,EAKG/L,QALH;AAMD,GAPD,MAOO;AACL,SAAKkR,aAAL,CAAmB5f,UAAnB;AACA,SAAKia,SAAL,CAAezkC,MAAf;AACA+wB,eAAWmI,SAASzhB,IAAT,CAAc1V,SAAd,EAAyB,IAAzB,CAAX,EAA2C,CAA3C;AACD;AACF,CA7FD;;AAgGA;;;;;;;AAOAhC,KAAKsb,SAAL,CAAegvB,QAAf,GAA0B,UAASzb,UAAT,EAAqBxJ,IAArB,EAA2BqQ,QAA3B,EAAqC;AAC7D;AACA,MAAMsJ,WAAW,KAAKsF,WAAL,EAAjB;AACA,MAAMgF,WAAWnkC,KAAK4G,GAAL,CAAS,CAACizB,QAAV,CAAjB;AACA,MAAIuK,WAAWpkC,KAAK2G,GAAL,CAAS,CAACkzB,QAAV,CAAf;AACA,MAAI8K,OAAOjb,WAAW,CAAX,IAAgBya,QAAhB,GAA2Bza,WAAW,CAAX,IAAgB0a,QAAtD;AACA,MAAIQ,OAAOlb,WAAW,CAAX,IAAgBya,QAAhB,GAA2Bza,WAAW,CAAX,IAAgB0a,QAAtD;AACA,MAAM9e,aAAa,KAAKQ,aAAL,EAAnB;AACA6e,UAAQ,CAACzkB,KAAK,CAAL,IAAU,CAAV,GAAcqQ,SAAS,CAAT,CAAf,IAA8BjL,UAAtC;AACAsf,UAAQ,CAACrU,SAAS,CAAT,IAAcrQ,KAAK,CAAL,IAAU,CAAzB,IAA8BoF,UAAtC;;AAEA;AACA8e,aAAW,CAACA,QAAZ,CAZ6D,CAYvC;AACtB,MAAMY,UAAUL,OAAOR,QAAP,GAAkBS,OAAOR,QAAzC;AACA,MAAMa,UAAUL,OAAOT,QAAP,GAAkBQ,OAAOP,QAAzC;;AAEA,OAAK7E,SAAL,CAAe,CAACyF,OAAD,EAAUC,OAAV,CAAf;AACD,CAjBD;;AAoBA;;;AAGApqC,KAAKsb,SAAL,CAAeijB,KAAf,GAAuB,YAAW;AAChC,SAAO,CAAC,CAAC,KAAK8F,SAAL,EAAF,IAAsB,KAAKpZ,aAAL,OAAyBjpB,SAAtD;AACD,CAFD;;AAKA;;;;;;AAMAhC,KAAKsb,SAAL,CAAe4tB,MAAf,GAAwB,UAASlK,QAAT,EAAmBuL,UAAnB,EAA+B;AACrD,MAAIA,eAAevoC,SAAnB,EAA8B;AAC5B,QAAM/B,SAAS,KAAKwmC,qBAAL,CAA2BzH,QAA3B,EAAqCuL,UAArC,CAAf;AACA,SAAK7F,SAAL,CAAezkC,MAAf;AACD;AACD,OAAK2kC,WAAL,CAAiB5F,QAAjB;AACD,CAND;;AASA;;;;;;AAMAh/B,KAAKsb,SAAL,CAAeopB,SAAf,GAA2B,UAASzkC,MAAT,EAAiB;AAC1C,OAAKkoB,GAAL,CAASya,uBAAaC,MAAtB,EAA8B5iC,MAA9B;AACA,MAAI,KAAK2lC,YAAL,EAAJ,EAAyB;AACvB,SAAKE,gBAAL;AACD;AACF,CALD;;AAQA;;;;;AAKA9lC,KAAKsb,SAAL,CAAeqqB,OAAf,GAAyB,UAAS6E,IAAT,EAAe/E,KAAf,EAAsB;AAC7C,OAAKpD,MAAL,CAAYmI,IAAZ,KAAqB/E,KAArB;AACA,OAAKxb,OAAL;AACA,SAAO,KAAKoY,MAAL,CAAYmI,IAAZ,CAAP;AACD,CAJD;;AAOA;;;;;;AAMAxqC,KAAKsb,SAAL,CAAe+uB,aAAf,GAA+B,UAAS5f,UAAT,EAAqB;AAClD,OAAKtC,GAAL,CAASya,uBAAakB,UAAtB,EAAkCrZ,UAAlC;AACA,MAAI,KAAKmb,YAAL,EAAJ,EAAyB;AACvB,SAAKE,gBAAL;AACD;AACF,CALD;;AAQA;;;;;;AAMA9lC,KAAKsb,SAAL,CAAespB,WAAf,GAA6B,UAAS5F,QAAT,EAAmB;AAC9C,OAAK7W,GAAL,CAASya,uBAAaoB,QAAtB,EAAgChF,QAAhC;AACA,MAAI,KAAK4G,YAAL,EAAJ,EAAyB;AACvB,SAAKE,gBAAL;AACD;AACF,CALD;;AAQA;;;;;AAKA9lC,KAAKsb,SAAL,CAAeqpB,OAAf,GAAyB,UAASzkC,IAAT,EAAe;AACtC,OAAKmqC,aAAL,CAAmB,KAAKzB,oBAAL,CAA0B1oC,IAA1B,CAAnB;AACD,CAFD;;AAKA;;;;AAIO,SAAS8hC,sBAAT,CAAgC75B,OAAhC,EAAyC;AAC9C,MAAIA,QAAQqiB,MAAR,KAAmBxoB,SAAvB,EAAkC;AAChC,WAAO,oCAAamG,QAAQqiB,MAArB,CAAP;AACD,GAFD,MAEO;AACL,WAAOigB,sBAAP;AACD;AACF;;AAGD;;;;;AAKO,SAASxI,0BAAT,CAAoC95B,OAApC,EAA6C;AAClD,MAAIu7B,6BAAJ;AACA,MAAIV,sBAAJ;AACA,MAAIE,sBAAJ;;AAEA;AACA;AACA,MAAMwH,iBAAiB,EAAvB;AACA,MAAMC,oBAAoB,CAA1B;;AAEA,MAAInH,UAAUr7B,QAAQq7B,OAAR,KAAoBxhC,SAApB,GACZmG,QAAQq7B,OADI,GACMpB,gBADpB;;AAGA,MAAI0F,UAAU3/B,QAAQ2/B,OAAR,KAAoB9lC,SAApB,GACZmG,QAAQ2/B,OADI,GACM4C,cADpB;;AAGA,MAAMtH,aAAaj7B,QAAQi7B,UAAR,KAAuBphC,SAAvB,GACjBmG,QAAQi7B,UADS,GACIuH,iBADvB;;AAGA,MAAIxiC,QAAQm7B,WAAR,KAAwBthC,SAA5B,EAAuC;AACrC,QAAMshC,cAAcn7B,QAAQm7B,WAA5B;AACAN,oBAAgBM,YAAYE,OAAZ,CAAhB;AACAN,oBAAgBI,YAAYwE,OAAZ,MAAyB9lC,SAAzB,GACdshC,YAAYwE,OAAZ,CADc,GACSxE,YAAYA,YAAYjiC,MAAZ,GAAqB,CAAjC,CADzB;AAEAqiC,2BAAuB,mDACrBJ,WADqB,CAAvB;AAED,GAPD,MAOO;AACL;AACA,QAAMZ,aAAa,4BAAiBv6B,QAAQu6B,UAAzB,EAAqC,WAArC,CAAnB;AACA,QAAMlY,SAASkY,WAAW5X,SAAX,EAAf;AACA,QAAMzF,OAAO,CAACmF,MAAD;AACX;AACA,UAAMogB,sBAAgBC,gBAAMC,OAAtB,CAAN,GACMpI,WAAWqI,gBAAX,EAHK,GAIX5lC,KAAKkH,GAAL,CAAS,sBAASme,MAAT,CAAT,EAA2B,uBAAUA,MAAV,CAA3B,CAJF;;AAMA,QAAMwgB,uBAAuB3lB,OAAO4lB,yBAAP,GAA2B9lC,KAAKoG,GAAL,CACtDo/B,iBADsD,EACnCvI,gBADmC,CAAxD;;AAGA,QAAM8I,uBAAuBF,uBAAuB7lC,KAAKoG,GAAL,CAClDo/B,iBADkD,EAC/BD,iBAAiBtI,gBADc,CAApD;;AAGA;AACAY,oBAAgB76B,QAAQ66B,aAAxB;AACA,QAAIA,kBAAkBhhC,SAAtB,EAAiC;AAC/BwhC,gBAAU,CAAV;AACD,KAFD,MAEO;AACLR,sBAAgBgI,uBAAuB7lC,KAAKoG,GAAL,CAAS63B,UAAT,EAAqBI,OAArB,CAAvC;AACD;;AAED;AACAN,oBAAgB/6B,QAAQ+6B,aAAxB;AACA,QAAIA,kBAAkBlhC,SAAtB,EAAiC;AAC/B,UAAImG,QAAQ2/B,OAAR,KAAoB9lC,SAAxB,EAAmC;AACjC,YAAImG,QAAQ66B,aAAR,KAA0BhhC,SAA9B,EAAyC;AACvCkhC,0BAAgBF,gBAAgB79B,KAAKoG,GAAL,CAAS63B,UAAT,EAAqB0E,OAArB,CAAhC;AACD,SAFD,MAEO;AACL5E,0BAAgB8H,uBAAuB7lC,KAAKoG,GAAL,CAAS63B,UAAT,EAAqB0E,OAArB,CAAvC;AACD;AACF,OAND,MAMO;AACL5E,wBAAgBgI,oBAAhB;AACD;AACF;;AAED;AACApD,cAAUtE,UAAUr+B,KAAKC,KAAL,CAClBD,KAAKyG,GAAL,CAASo3B,gBAAgBE,aAAzB,IAA0C/9B,KAAKyG,GAAL,CAASw3B,UAAT,CADxB,CAApB;AAEAF,oBAAgBF,gBAAgB79B,KAAKoG,GAAL,CAAS63B,UAAT,EAAqB0E,UAAUtE,OAA/B,CAAhC;;AAEAE,2BAAuB,6CACrBN,UADqB,EACTJ,aADS,EACM8E,UAAUtE,OADhB,CAAvB;AAED;AACD,SAAO,EAACG,YAAYD,oBAAb,EAAmCV,eAAeA,aAAlD;AACLE,mBAAeA,aADV,EACyBM,SAASA,OADlC,EAC2CJ,YAAYA,UADvD,EAAP;AAED;;AAGD;;;;AAIO,SAASlB,wBAAT,CAAkC/5B,OAAlC,EAA2C;AAChD,MAAMgjC,iBAAiBhjC,QAAQgjC,cAAR,KAA2BnpC,SAA3B,GACrBmG,QAAQgjC,cADa,GACI,IAD3B;AAEA,MAAIA,cAAJ,EAAoB;AAClB,QAAM/D,oBAAoBj/B,QAAQi/B,iBAAlC;AACA,QAAIA,sBAAsBplC,SAAtB,IAAmColC,sBAAsB,IAA7D,EAAmE;AACjE,aAAO,2CAAP;AACD,KAFD,MAEO,IAAIA,sBAAsB,KAA1B,EAAiC;AACtC,aAAOgE,wBAAP;AACD,KAFM,MAEA,IAAI,OAAOhE,iBAAP,KAA6B,QAAjC,EAA2C;AAChD,aAAO,uCAAcA,iBAAd,CAAP;AACD,KAFM,MAEA;AACL,aAAOgE,wBAAP;AACD;AACF,GAXD,MAWO;AACL,WAAOC,2BAAP;AACD;AACF;;AAGD;;;;;AAKO,SAASlJ,eAAT,CAAyB4C,SAAzB,EAAoC;AACzC,MAAIA,UAAUK,YAAV,IAA0BL,UAAUM,YAAxC,EAAsD;AACpD,QAAI,CAAC,wBAAiBN,UAAUK,YAA3B,EAAyCL,UAAUM,YAAnD,CAAL,EAAuE;AACrE,aAAO,KAAP;AACD;AACF;AACD,MAAIN,UAAUO,gBAAV,KAA+BP,UAAUQ,gBAA7C,EAA+D;AAC7D,WAAO,KAAP;AACD;AACD,MAAIR,UAAUS,cAAV,KAA6BT,UAAUW,cAA3C,EAA2D;AACzD,WAAO,KAAP;AACD;AACD,SAAO,IAAP;AACD;;kBAEc1lC,I;;;;;;;;;;;;;;;;;ACj1Cf;;;;AAIA;;;kBAGe;AACb68B,aAAW,CADE;AAEbC,eAAa;AAFA,C;;;;;;;;;;;;;;;;;ACPf;;;;AAIA;;;kBAGe;AACb+F,UAAQ,QADK;AAEbiB,cAAY,YAFC;AAGbE,YAAU;AAHG,C;;;;;;;;;;;;;;;;;QCOC35B,Y,GAAAA,Y;QAkCAihC,yB,GAAAA,yB;QAWAC,Q,GAAAA,Q;QAaAC,iB,GAAAA,iB;QA2CAC,e,GAAAA,e;QAgBApkB,M,GAAAA,M;QAeAU,M,GAAAA,M;QAgBA2jB,I,GAAAA,I;QAmBA9J,M,GAAAA,M;QAkBA+J,U,GAAAA,U;QAqBAC,S,GAAAA,S;QAgBAC,Q,GAAAA,Q;AA5OhB;;;;AAKA;;;;;;;;;AASO,SAASxhC,YAAT,CAAsByhC,QAAtB,EAAgCC,MAAhC,EAAwCC,cAAxC,EAAwD;AAC7D,MAAIC,YAAJ;AAAA,MAASC,YAAT;AACA,MAAMC,aAAaH,kBAAkBV,yBAArC;AACA,MAAIc,MAAM,CAAV;AACA,MAAIC,OAAOP,SAASzqC,MAApB;AACA,MAAIirC,QAAQ,KAAZ;;AAEA,SAAOF,MAAMC,IAAb,EAAmB;AACjB;;AAEAJ,UAAMG,OAAOC,OAAOD,GAAP,IAAc,CAArB,CAAN;AACAF,UAAM,CAACC,WAAWL,SAASG,GAAT,CAAX,EAA0BF,MAA1B,CAAP;;AAEA,QAAIG,MAAM,GAAV,EAAe;AAAE;AACfE,YAAOH,MAAM,CAAb;AAED,KAHD,MAGO;AAAE;AACPI,aAAOJ,GAAP;AACAK,cAAQ,CAACJ,GAAT;AACD;AACF;;AAED;AACA,SAAOI,QAAQF,GAAR,GAAc,CAACA,GAAtB;AACD;;AAGD;;;;;;;AAOO,SAASd,yBAAT,CAAmChiC,CAAnC,EAAsCD,CAAtC,EAAyC;AAC9C,SAAOC,IAAID,CAAJ,GAAQ,CAAR,GAAYC,IAAID,CAAJ,GAAQ,CAAC,CAAT,GAAa,CAAhC;AACD;;AAGD;;;;;;AAMO,SAASkiC,QAAT,CAAkBjkB,GAAlB,EAAuB5d,GAAvB,EAA4B;AACjC,SAAO4d,IAAI7a,OAAJ,CAAY/C,GAAZ,KAAoB,CAA3B;AACD;;AAGD;;;;;;;;AAQO,SAAS8hC,iBAAT,CAA2BlkB,GAA3B,EAAgCxnB,MAAhC,EAAwCqnC,SAAxC,EAAmD;AACxD,MAAMz7B,IAAI4b,IAAIjmB,MAAd;AACA,MAAIimB,IAAI,CAAJ,KAAUxnB,MAAd,EAAsB;AACpB,WAAO,CAAP;AACD,GAFD,MAEO,IAAIA,UAAUwnB,IAAI5b,IAAI,CAAR,CAAd,EAA0B;AAC/B,WAAOA,IAAI,CAAX;AACD,GAFM,MAEA;AACL,QAAItK,UAAJ;AACA,QAAI+lC,YAAY,CAAhB,EAAmB;AACjB,WAAK/lC,IAAI,CAAT,EAAYA,IAAIsK,CAAhB,EAAmB,EAAEtK,CAArB,EAAwB;AACtB,YAAIkmB,IAAIlmB,CAAJ,IAAStB,MAAb,EAAqB;AACnB,iBAAOsB,IAAI,CAAX;AACD;AACF;AACF,KAND,MAMO,IAAI+lC,YAAY,CAAhB,EAAmB;AACxB,WAAK/lC,IAAI,CAAT,EAAYA,IAAIsK,CAAhB,EAAmB,EAAEtK,CAArB,EAAwB;AACtB,YAAIkmB,IAAIlmB,CAAJ,KAAUtB,MAAd,EAAsB;AACpB,iBAAOsB,CAAP;AACD;AACF;AACF,KANM,MAMA;AACL,WAAKA,IAAI,CAAT,EAAYA,IAAIsK,CAAhB,EAAmB,EAAEtK,CAArB,EAAwB;AACtB,YAAIkmB,IAAIlmB,CAAJ,KAAUtB,MAAd,EAAsB;AACpB,iBAAOsB,CAAP;AACD,SAFD,MAEO,IAAIkmB,IAAIlmB,CAAJ,IAAStB,MAAb,EAAqB;AAC1B,cAAIwnB,IAAIlmB,IAAI,CAAR,IAAatB,MAAb,GAAsBA,SAASwnB,IAAIlmB,CAAJ,CAAnC,EAA2C;AACzC,mBAAOA,IAAI,CAAX;AACD,WAFD,MAEO;AACL,mBAAOA,CAAP;AACD;AACF;AACF;AACF;AACD,WAAOsK,IAAI,CAAX;AACD;AACF;;AAGD;;;;;AAKO,SAAS+/B,eAAT,CAAyBnkB,GAAzB,EAA8BqF,KAA9B,EAAqCI,GAArC,EAA0C;AAC/C,SAAOJ,QAAQI,GAAf,EAAoB;AAClB,QAAMwf,MAAMjlB,IAAIqF,KAAJ,CAAZ;AACArF,QAAIqF,KAAJ,IAAarF,IAAIyF,GAAJ,CAAb;AACAzF,QAAIyF,GAAJ,IAAWwf,GAAX;AACA,MAAE5f,KAAF;AACA,MAAEI,GAAF;AACD;AACF;;AAGD;;;;;AAKO,SAAS1F,MAAT,CAAgBC,GAAhB,EAAqBhF,IAArB,EAA2B;AAChC,MAAMkqB,YAAY/pC,MAAMC,OAAN,CAAc4f,IAAd,IAAsBA,IAAtB,GAA6B,CAACA,IAAD,CAA/C;AACA,MAAMjhB,SAASmrC,UAAUnrC,MAAzB;AACA,OAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIC,MAApB,EAA4BD,GAA5B,EAAiC;AAC/BkmB,QAAIA,IAAIjmB,MAAR,IAAkBmrC,UAAUprC,CAAV,CAAlB;AACD;AACF;;AAGD;;;;;;AAMO,SAAS2mB,MAAT,CAAgBT,GAAhB,EAAqB5d,GAArB,EAA0B;AAC/B,MAAMtI,IAAIkmB,IAAI7a,OAAJ,CAAY/C,GAAZ,CAAV;AACA,MAAM4iC,QAAQlrC,IAAI,CAAC,CAAnB;AACA,MAAIkrC,KAAJ,EAAW;AACThlB,QAAII,MAAJ,CAAWtmB,CAAX,EAAc,CAAd;AACD;AACD,SAAOkrC,KAAP;AACD;;AAGD;;;;;;AAMO,SAASZ,IAAT,CAAcpkB,GAAd,EAAmBjK,IAAnB,EAAyB;AAC9B,MAAMhc,SAASimB,IAAIjmB,MAAJ,KAAe,CAA9B;AACA,MAAIsD,cAAJ;;AAEA,OAAK,IAAIvD,IAAI,CAAb,EAAgBA,IAAIC,MAApB,EAA4BD,GAA5B,EAAiC;AAC/BuD,YAAQ2iB,IAAIlmB,CAAJ,CAAR;AACA,QAAIic,KAAK1Y,KAAL,EAAYvD,CAAZ,EAAekmB,GAAf,CAAJ,EAAyB;AACvB,aAAO3iB,KAAP;AACD;AACF;AACD,SAAO,IAAP;AACD;;AAGD;;;;;AAKO,SAASi9B,MAAT,CAAgB6K,IAAhB,EAAsBC,IAAtB,EAA4B;AACjC,MAAMC,OAAOF,KAAKprC,MAAlB;AACA,MAAIsrC,SAASD,KAAKrrC,MAAlB,EAA0B;AACxB,WAAO,KAAP;AACD;AACD,OAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIurC,IAApB,EAA0BvrC,GAA1B,EAA+B;AAC7B,QAAIqrC,KAAKrrC,CAAL,MAAYsrC,KAAKtrC,CAAL,CAAhB,EAAyB;AACvB,aAAO,KAAP;AACD;AACF;AACD,SAAO,IAAP;AACD;;AAGD;;;;AAIO,SAASuqC,UAAT,CAAoBrkB,GAApB,EAAyBslB,UAAzB,EAAqC;AAC1C,MAAMvrC,SAASimB,IAAIjmB,MAAnB;AACA,MAAMkrC,MAAM9pC,MAAM6kB,IAAIjmB,MAAV,CAAZ;AACA,MAAID,UAAJ;AACA,OAAKA,IAAI,CAAT,EAAYA,IAAIC,MAAhB,EAAwBD,GAAxB,EAA6B;AAC3BmrC,QAAInrC,CAAJ,IAAS,EAACqE,OAAOrE,CAAR,EAAWuD,OAAO2iB,IAAIlmB,CAAJ,CAAlB,EAAT;AACD;AACDmrC,MAAIv9B,IAAJ,CAAS,UAAS1F,CAAT,EAAYD,CAAZ,EAAe;AACtB,WAAOujC,WAAWtjC,EAAE3E,KAAb,EAAoB0E,EAAE1E,KAAtB,KAAgC2E,EAAE7D,KAAF,GAAU4D,EAAE5D,KAAnD;AACD,GAFD;AAGA,OAAKrE,IAAI,CAAT,EAAYA,IAAIkmB,IAAIjmB,MAApB,EAA4BD,GAA5B,EAAiC;AAC/BkmB,QAAIlmB,CAAJ,IAASmrC,IAAInrC,CAAJ,EAAOuD,KAAhB;AACD;AACF;;AAGD;;;;;AAKO,SAASinC,SAAT,CAAmBtkB,GAAnB,EAAwBjK,IAAxB,EAA8B;AACnC,MAAI5X,cAAJ;AACA,MAAM6mC,QAAQ,CAAChlB,IAAIulB,KAAJ,CAAU,UAASC,EAAT,EAAa9uB,GAAb,EAAkB;AACzCvY,YAAQuY,GAAR;AACA,WAAO,CAACX,KAAKyvB,EAAL,EAAS9uB,GAAT,EAAcsJ,GAAd,CAAR;AACD,GAHc,CAAf;AAIA,SAAOglB,QAAQ7mC,KAAR,GAAgB,CAAC,CAAxB;AACD;;AAGD;;;;;;AAMO,SAASomC,QAAT,CAAkBvkB,GAAlB,EAAuBylB,QAAvB,EAAiCC,UAAjC,EAA6C;AAClD,MAAMjlC,UAAUglC,YAAYzB,yBAA5B;AACA,SAAOhkB,IAAIulB,KAAJ,CAAU,UAASI,UAAT,EAAqBxnC,KAArB,EAA4B;AAC3C,QAAIA,UAAU,CAAd,EAAiB;AACf,aAAO,IAAP;AACD;AACD,QAAMynC,MAAMnlC,QAAQuf,IAAI7hB,QAAQ,CAAZ,CAAR,EAAwBwnC,UAAxB,CAAZ;AACA,WAAO,EAAEC,MAAM,CAAN,IAAWF,cAAcE,QAAQ,CAAnC,CAAP;AACD,GANM,CAAP;AAOD,C;;;;;;;;;;;;;;;;;QC5OejwB,M,GAAAA,M;;AANhB;;;;;;AAEA;;;;AAIO,SAASA,MAAT,CAAgBkwB,SAAhB,EAA2BC,SAA3B,EAAsC;AAC3C,MAAI,CAACD,SAAL,EAAgB;AACd,UAAM,IAAI5vB,wBAAJ,CAAmB6vB,SAAnB,CAAN;AACD;AACF,C,CAbD;;;;;;;;;;;;;;;;;;;QCegBC,Y,GAAAA,Y;QAwBAC,I,GAAAA,I;;AApChB;;AAGA;;;;AAKA;;;;AAIO,SAASD,YAAT,CAAsB7iB,MAAtB,EAA8B;AACnC;AACE;;;;AAIA,cAASvqB,MAAT,EAAiB;AACf,UAAIA,MAAJ,EAAY;AACV,eAAO,CACL,iBAAMA,OAAO,CAAP,CAAN,EAAiBuqB,OAAO,CAAP,CAAjB,EAA4BA,OAAO,CAAP,CAA5B,CADK,EAEL,iBAAMvqB,OAAO,CAAP,CAAN,EAAiBuqB,OAAO,CAAP,CAAjB,EAA4BA,OAAO,CAAP,CAA5B,CAFK,CAAP;AAID,OALD,MAKO;AACL,eAAOxoB,SAAP;AACD;AACF;AAdH;AAgBD;;AAGD;;;;AAnCA;;;AAuCO,SAASsrC,IAAT,CAAcrtC,MAAd,EAAsB;AAC3B,SAAOA,MAAP;AACD,C;;;;;;;;;;;;;;;;;;QCAestC,Q,GAAAA,Q;QA0FAC,O,GAAAA,O;QAmEAC,S,GAAAA,S;QAaAxpC,Q,GAAAA,Q;;AAhNhB;;AACA;;AAGA;;;;;;;;;AAUA;;;;;;AAjBA;;;AAuBA,IAAMypC,gBAAgB,mDAAtB;;AAGA;;;;;;AAMA,IAAMC,kBAAkB,aAAxB;;AAGA;;;;;;AAMO,SAASJ,QAAT,CAAkB/6B,KAAlB,EAAyB;AAC9B,MAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B,WAAOA,KAAP;AACD,GAFD,MAEO;AACL,WAAOvO,SAASuO,KAAT,CAAP;AACD;AACF;;AAED;;;;;AAKA,SAASo7B,SAAT,CAAmBp7B,KAAnB,EAA0B;AACxB,MAAMs6B,KAAKlb,SAAS2D,aAAT,CAAuB,KAAvB,CAAX;AACAuX,KAAGtnB,KAAH,CAAShT,KAAT,GAAiBA,KAAjB;AACA,MAAIs6B,GAAGtnB,KAAH,CAAShT,KAAT,KAAmB,EAAvB,EAA2B;AACzBof,aAASic,IAAT,CAAc5X,WAAd,CAA0B6W,EAA1B;AACA,QAAMgB,MAAMnO,iBAAiBmN,EAAjB,EAAqBt6B,KAAjC;AACAof,aAASic,IAAT,CAAcE,WAAd,CAA0BjB,EAA1B;AACA,WAAOgB,GAAP;AACD,GALD,MAKO;AACL,WAAO,EAAP;AACD;AACF;;AAGD;;;;AAIO,IAAME,kCACX,YAAW;;AAET;AACA;AACA;;AAEA;;;;AAIA,MAAMC,iBAAiB,IAAvB;;AAEA;;;AAGA,MAAMC,QAAQ,EAAd;;AAEA;;;AAGA,MAAIC,YAAY,CAAhB;;AAEA;AACE;;;;AAIA,cAASzhC,CAAT,EAAY;AACV,UAAI8F,cAAJ;AACA,UAAI07B,MAAM5xB,cAAN,CAAqB5P,CAArB,CAAJ,EAA6B;AAC3B8F,gBAAQ07B,MAAMxhC,CAAN,CAAR;AACD,OAFD,MAEO;AACL,YAAIyhC,aAAaF,cAAjB,EAAiC;AAC/B,cAAI7sC,IAAI,CAAR;AACA,eAAK,IAAMqI,GAAX,IAAkBykC,KAAlB,EAAyB;AACvB,gBAAI,CAAC9sC,MAAM,CAAP,MAAc,CAAlB,EAAqB;AACnB,qBAAO8sC,MAAMzkC,GAAN,CAAP;AACA,gBAAE0kC,SAAF;AACD;AACF;AACF;AACD37B,gBAAQ47B,oBAAoB1hC,CAApB,CAAR;AACAwhC,cAAMxhC,CAAN,IAAW8F,KAAX;AACA,UAAE27B,SAAF;AACD;AACD,aAAO37B,KAAP;AACD;AAxBH;AA2BD,CAlDuB,EAAnB;;AAoDP;;;;;;;AAOO,SAASg7B,OAAT,CAAiBh7B,KAAjB,EAAwB;AAC7B,MAAI/P,MAAMC,OAAN,CAAc8P,KAAd,CAAJ,EAA0B;AACxB,WAAOA,KAAP;AACD,GAFD,MAEO;AACL,WAAOw7B,YAAW,qBAAuBx7B,KAAlC,CAAP;AACD;AACF;;AAED;;;;;AAKA,SAAS47B,mBAAT,CAA6B1hC,CAA7B,EAAgC;AAC9B,MAAIrM,UAAJ;AAAA,MAAO+I,UAAP;AAAA,MAAUC,UAAV;AAAA,MAAaC,UAAb;AAAA,MAAgBkJ,cAAhB;;AAEA,MAAIm7B,gBAAgBj3B,IAAhB,CAAqBhK,CAArB,CAAJ,EAA6B;AAC3BA,QAAIkhC,UAAUlhC,CAAV,CAAJ;AACD;;AAED,MAAIghC,cAAch3B,IAAd,CAAmBhK,CAAnB,CAAJ,EAA2B;AAAE;AAC3B,QAAMhB,IAAIgB,EAAErL,MAAF,GAAW,CAArB,CADyB,CACD;AACxB,QAAI8Y,UAAJ,CAFyB,CAElB;AACP,QAAIzO,KAAK,CAAT,EAAY;AACVyO,UAAI,CAAJ;AACD,KAFD,MAEO;AACLA,UAAI,CAAJ;AACD;AACD,QAAMk0B,WAAW3iC,MAAM,CAAN,IAAWA,MAAM,CAAlC;AACArL,QAAIuiB,SAASlW,EAAE2W,MAAF,CAAS,IAAI,IAAIlJ,CAAjB,EAAoBA,CAApB,CAAT,EAAiC,EAAjC,CAAJ;AACA/Q,QAAIwZ,SAASlW,EAAE2W,MAAF,CAAS,IAAI,IAAIlJ,CAAjB,EAAoBA,CAApB,CAAT,EAAiC,EAAjC,CAAJ;AACA9Q,QAAIuZ,SAASlW,EAAE2W,MAAF,CAAS,IAAI,IAAIlJ,CAAjB,EAAoBA,CAApB,CAAT,EAAiC,EAAjC,CAAJ;AACA,QAAIk0B,QAAJ,EAAc;AACZ/kC,UAAIsZ,SAASlW,EAAE2W,MAAF,CAAS,IAAI,IAAIlJ,CAAjB,EAAoBA,CAApB,CAAT,EAAiC,EAAjC,CAAJ;AACD,KAFD,MAEO;AACL7Q,UAAI,GAAJ;AACD;AACD,QAAI6Q,KAAK,CAAT,EAAY;AACV9Z,UAAI,CAACA,KAAK,CAAN,IAAWA,CAAf;AACA+I,UAAI,CAACA,KAAK,CAAN,IAAWA,CAAf;AACAC,UAAI,CAACA,KAAK,CAAN,IAAWA,CAAf;AACA,UAAIglC,QAAJ,EAAc;AACZ/kC,YAAI,CAACA,KAAK,CAAN,IAAWA,CAAf;AACD;AACF;AACDkJ,YAAQ,CAACnS,CAAD,EAAI+I,CAAJ,EAAOC,CAAP,EAAUC,IAAI,GAAd,CAAR;AACD,GA1BD,MA0BO,IAAIoD,EAAED,OAAF,CAAU,OAAV,KAAsB,CAA1B,EAA6B;AAAE;AACpC+F,YAAQ9F,EAAEzL,KAAF,CAAQ,CAAR,EAAW,CAAC,CAAZ,EAAeuiB,KAAf,CAAqB,GAArB,EAA0B5jB,GAA1B,CAA8BuH,MAA9B,CAAR;AACAsmC,cAAUj7B,KAAV;AACD,GAHM,MAGA,IAAI9F,EAAED,OAAF,CAAU,MAAV,KAAqB,CAAzB,EAA4B;AAAE;AACnC+F,YAAQ9F,EAAEzL,KAAF,CAAQ,CAAR,EAAW,CAAC,CAAZ,EAAeuiB,KAAf,CAAqB,GAArB,EAA0B5jB,GAA1B,CAA8BuH,MAA9B,CAAR;AACAqL,UAAMpP,IAAN,CAAW,CAAX;AACAqqC,cAAUj7B,KAAV;AACD,GAJM,MAIA;AACL,yBAAO,KAAP,EAAc,EAAd,EADK,CACc;AACpB;AACD;AACE,wCAAsCA;AADxC;AAGD;;AAGD;;;;;AAKO,SAASi7B,SAAT,CAAmBj7B,KAAnB,EAA0B;AAC/BA,QAAM,CAAN,IAAW,iBAAOA,MAAM,CAAN,IAAW,GAAZ,GAAmB,CAAzB,EAA4B,CAA5B,EAA+B,GAA/B,CAAX;AACAA,QAAM,CAAN,IAAW,iBAAOA,MAAM,CAAN,IAAW,GAAZ,GAAmB,CAAzB,EAA4B,CAA5B,EAA+B,GAA/B,CAAX;AACAA,QAAM,CAAN,IAAW,iBAAOA,MAAM,CAAN,IAAW,GAAZ,GAAmB,CAAzB,EAA4B,CAA5B,EAA+B,GAA/B,CAAX;AACAA,QAAM,CAAN,IAAW,iBAAMA,MAAM,CAAN,CAAN,EAAgB,CAAhB,EAAmB,CAAnB,CAAX;AACA,SAAOA,KAAP;AACD;;AAGD;;;;AAIO,SAASvO,QAAT,CAAkBuO,KAAlB,EAAyB;AAC9B,MAAInS,IAAImS,MAAM,CAAN,CAAR;AACA,MAAInS,MAAMA,IAAI,CAAV,CAAJ,EAAkB;AAChBA,QAAKA,IAAI,GAAL,GAAY,CAAhB;AACD;AACD,MAAI+I,IAAIoJ,MAAM,CAAN,CAAR;AACA,MAAIpJ,MAAMA,IAAI,CAAV,CAAJ,EAAkB;AAChBA,QAAKA,IAAI,GAAL,GAAY,CAAhB;AACD;AACD,MAAIC,IAAImJ,MAAM,CAAN,CAAR;AACA,MAAInJ,MAAMA,IAAI,CAAV,CAAJ,EAAkB;AAChBA,QAAKA,IAAI,GAAL,GAAY,CAAhB;AACD;AACD,MAAMC,IAAIkJ,MAAM,CAAN,MAAaxQ,SAAb,GAAyB,CAAzB,GAA6BwQ,MAAM,CAAN,CAAvC;AACA,SAAO,UAAUnS,CAAV,GAAc,GAAd,GAAoB+I,CAApB,GAAwB,GAAxB,GAA8BC,CAA9B,GAAkC,GAAlC,GAAwCC,CAAxC,GAA4C,GAAnD;AACD,C;;;;;;;;;;;;;;;;;QC1MeglC,W,GAAAA,W;QAaAC,W,GAAAA,W;;AAlChB;;AAGA;;;;;;;;;;;;AAaA;;;;;AAKO,SAASD,WAAT,CAAqB97B,KAArB,EAA4B;AACjC,MAAI+7B,YAAY/7B,KAAZ,CAAJ,EAAwB;AACtB,WAAO,mDAAoDA;AAA3D;AACD,GAFD,MAEO;AACL,WAAO,sBAAS,oCAAsCA,KAA/C,CAAP;AACD;AACF;;AAGD;;;;AAjCA;;;AAqCO,SAAS+7B,WAAT,CAAqB/7B,KAArB,EAA4B;AACjC,SACE,OAAOA,KAAP,KAAiB,QAAjB,IACAA,iBAAiBg8B,aADjB,IAEAh8B,iBAAiBi8B,cAHnB;AAKD,C;;;;;;;;;;;;;;;;;QC2KetR,M,GAAAA,M;;AAnNhB;;AACA;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AAGA;;;;;;;;;;;;;;;;;;;;;;;AAwBA;;;;;;;;;;;;AArCA;;;AAiDA,IAAMuR,cAAc,SAAdA,WAAc,CAAS9nB,WAAT,EAAsB;;AAExC,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA;;;;AAIA,OAAK+nB,UAAL,GAAkB/c,SAAS2D,aAAT,CAAuB,IAAvB,CAAlB;;AAEA;;;;AAIA,OAAKqZ,UAAL,GAAkBzmC,QAAQ0mC,SAAR,KAAsB7sC,SAAtB,GAAkCmG,QAAQ0mC,SAA1C,GAAsD,IAAxE;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoB3mC,QAAQ4mC,WAAR,KAAwB/sC,SAAxB,GAClBmG,QAAQ4mC,WADU,GACI,IADxB;;AAGA,MAAI,CAAC,KAAKD,YAAV,EAAwB;AACtB,SAAKF,UAAL,GAAkB,KAAlB;AACD;;AAED,MAAMpZ,YAAYrtB,QAAQqtB,SAAR,KAAsBxzB,SAAtB,GAAkCmG,QAAQqtB,SAA1C,GAAsD,gBAAxE;;AAEA,MAAMwZ,WAAW7mC,QAAQ6mC,QAAR,KAAqBhtC,SAArB,GAAiCmG,QAAQ6mC,QAAzC,GAAoD,cAArE;;AAEA,MAAMC,gBAAgB9mC,QAAQ8mC,aAAR,KAA0BjtC,SAA1B,GAAsCmG,QAAQ8mC,aAA9C,GAA8D,MAApF;;AAEA,MAAI,OAAOA,aAAP,KAAyB,QAA7B,EAAuC;AACrC;;;;AAIA,SAAKC,cAAL,GAAsBtd,SAAS2D,aAAT,CAAuB,MAAvB,CAAtB;AACA,SAAK2Z,cAAL,CAAoBC,WAApB,GAAkCF,aAAlC;AACD,GAPD,MAOO;AACL,SAAKC,cAAL,GAAsBD,aAAtB;AACD;;AAED,MAAM7hC,QAAQjF,QAAQiF,KAAR,KAAkBpL,SAAlB,GAA8BmG,QAAQiF,KAAtC,GAA8C,GAA5D;;AAEA,MAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B;;;;AAIA,SAAKgiC,MAAL,GAAcxd,SAAS2D,aAAT,CAAuB,MAAvB,CAAd;AACA,SAAK6Z,MAAL,CAAYD,WAAZ,GAA0B/hC,KAA1B;AACD,GAPD,MAOO;AACL,SAAKgiC,MAAL,GAAchiC,KAAd;AACD;;AAGD,MAAMiiC,cAAe,KAAKP,YAAL,IAAqB,CAAC,KAAKF,UAA5B,GAClB,KAAKM,cADa,GACI,KAAKE,MAD7B;AAEA,MAAMzd,SAASC,SAAS2D,aAAT,CAAuB,QAAvB,CAAf;AACA5D,SAAOgM,YAAP,CAAoB,MAApB,EAA4B,QAA5B;AACAhM,SAAO2d,KAAP,GAAeN,QAAf;AACArd,SAAOsE,WAAP,CAAmBoZ,WAAnB;;AAEA,sBAAO1d,MAAP,EAAezH,oBAAU2G,KAAzB,EAAgC,KAAK0e,YAArC,EAAmD,IAAnD;;AAEA,MAAMC,aAAaha,YAAY,GAAZ,GAAkBia,uBAAlB,GAAuC,GAAvC,GAA6CC,kBAA7C,IACd,KAAKd,UAAL,IAAmB,KAAKE,YAAxB,GAAuC,MAAMa,oBAA7C,GAA+D,EADjD,KAEd,KAAKb,YAAL,GAAoB,EAApB,GAAyB,mBAFX,CAAnB;AAGA,MAAMroB,UAAUmL,SAAS2D,aAAT,CAAuB,KAAvB,CAAhB;AACA9O,UAAQ+O,SAAR,GAAoBga,UAApB;AACA/oB,UAAQwP,WAAR,CAAoB,KAAK0Y,UAAzB;AACAloB,UAAQwP,WAAR,CAAoBtE,MAApB;;AAEAie,oBAAQjzB,IAAR,CAAa,IAAb,EAAmB;AACjB8J,aAASA,OADQ;AAEjB0W,YAAQh1B,QAAQg1B,MAAR,IAAkBA,MAFT;AAGjBr9B,YAAQqI,QAAQrI;AAHC,GAAnB;;AAMA;;;;;AAKA,OAAK+vC,qBAAL,GAA6B,EAA7B;;AAEA;;;;AAIA,OAAKC,gBAAL,GAAwB,IAAxB;AAED,CA9FD;;AAgGA,qBAASpB,WAAT,EAAsBkB,iBAAtB;;AAGA;;;;;;AAMAlB,YAAYpzB,SAAZ,CAAsBy0B,sBAAtB,GAA+C,UAASzd,UAAT,EAAqB;AAClE;;;;AAIA,MAAM0d,SAAS,EAAf;;AAEA;;;;AAIA,MAAMC,sBAAsB,EAA5B;;AAEA,MAAMxR,mBAAmBnM,WAAWmM,gBAApC;AACA,MAAMhU,aAAa6H,WAAW+L,SAAX,CAAqB5T,UAAxC;AACA,OAAK,IAAIrpB,IAAI,CAAR,EAAWwkB,KAAK6Y,iBAAiBp9B,MAAtC,EAA8CD,IAAIwkB,EAAlD,EAAsD,EAAExkB,CAAxD,EAA2D;AACzD,QAAM8uC,aAAazR,iBAAiBr9B,CAAjB,CAAnB;AACA,QAAI,CAAC,gCAAoB8uC,UAApB,EAAgCzlB,UAAhC,CAAL,EAAkD;AAChD;AACD;;AAED,QAAMlrB,SAAS2wC,WAAW9wC,KAAX,CAAiB+wC,SAAjB,EAAf;AACA,QAAI,CAAC5wC,MAAL,EAAa;AACX;AACD;;AAED,QAAM6wC,oBAAoB7wC,OAAO8wC,eAAP,EAA1B;AACA,QAAI,CAACD,iBAAL,EAAwB;AACtB;AACD;;AAED,QAAME,eAAeF,kBAAkB9d,UAAlB,CAArB;AACA,QAAI,CAACge,YAAL,EAAmB;AACjB;AACD;;AAED,QAAI7tC,MAAMC,OAAN,CAAc4tC,YAAd,CAAJ,EAAiC;AAC/B,WAAK,IAAIhmC,IAAI,CAAR,EAAW27B,KAAKqK,aAAajvC,MAAlC,EAA0CiJ,IAAI27B,EAA9C,EAAkD,EAAE37B,CAApD,EAAuD;AACrD,YAAI,EAAEgmC,aAAahmC,CAAb,KAAmB0lC,MAArB,CAAJ,EAAkC;AAChCC,8BAAoB7sC,IAApB,CAAyBktC,aAAahmC,CAAb,CAAzB;AACA0lC,iBAAOM,aAAahmC,CAAb,CAAP,IAA0B,IAA1B;AACD;AACF;AACF,KAPD,MAOO;AACL,UAAI,EAAEgmC,gBAAgBN,MAAlB,CAAJ,EAA+B;AAC7BC,4BAAoB7sC,IAApB,CAAyBktC,YAAzB;AACAN,eAAOM,YAAP,IAAuB,IAAvB;AACD;AACF;AACF;AACD,SAAOL,mBAAP;AACD,CAnDD;;AAsDA;;;;;;AAMO,SAAS9S,MAAT,CAAgBoT,QAAhB,EAA0B;AAC/B,OAAKC,cAAL,CAAoBD,SAASje,UAA7B;AACD;;AAGD;;;;AAIAoc,YAAYpzB,SAAZ,CAAsBk1B,cAAtB,GAAuC,UAASle,UAAT,EAAqB;AAC1D,MAAI,CAACA,UAAL,EAAiB;AACf,QAAI,KAAKwd,gBAAT,EAA2B;AACzB,WAAKrpB,OAAL,CAAajB,KAAb,CAAmBirB,OAAnB,GAA6B,MAA7B;AACA,WAAKX,gBAAL,GAAwB,KAAxB;AACD;AACD;AACD;;AAED,MAAMQ,eAAe,KAAKP,sBAAL,CAA4Bzd,UAA5B,CAArB;;AAEA,MAAMoe,UAAUJ,aAAajvC,MAAb,GAAsB,CAAtC;AACA,MAAI,KAAKyuC,gBAAL,IAAyBY,OAA7B,EAAsC;AACpC,SAAKjqB,OAAL,CAAajB,KAAb,CAAmBirB,OAAnB,GAA6BC,UAAU,EAAV,GAAe,MAA5C;AACA,SAAKZ,gBAAL,GAAwBY,OAAxB;AACD;;AAED,MAAI,mBAAOJ,YAAP,EAAqB,KAAKT,qBAA1B,CAAJ,EAAsD;AACpD;AACD;;AAED,2BAAe,KAAKlB,UAApB;;AAEA;AACA,OAAK,IAAIvtC,IAAI,CAAR,EAAWwkB,KAAK0qB,aAAajvC,MAAlC,EAA0CD,IAAIwkB,EAA9C,EAAkD,EAAExkB,CAApD,EAAuD;AACrD,QAAMqlB,UAAUmL,SAAS2D,aAAT,CAAuB,IAAvB,CAAhB;AACA9O,YAAQkqB,SAAR,GAAoBL,aAAalvC,CAAb,CAApB;AACA,SAAKutC,UAAL,CAAgB1Y,WAAhB,CAA4BxP,OAA5B;AACD;;AAED,OAAKopB,qBAAL,GAA6BS,YAA7B;AACD,CA/BD;;AAkCA;;;;AAIA5B,YAAYpzB,SAAZ,CAAsBi0B,YAAtB,GAAqC,UAASpe,KAAT,EAAgB;AACnDA,QAAMnC,cAAN;AACA,OAAK4hB,aAAL;AACD,CAHD;;AAMA;;;AAGAlC,YAAYpzB,SAAZ,CAAsBs1B,aAAtB,GAAsC,YAAW;AAC/C,OAAKnqB,OAAL,CAAaoqB,SAAb,CAAuBC,MAAvB,CAA8BnB,oBAA9B;AACA,MAAI,KAAKf,UAAT,EAAqB;AACnB,0BAAY,KAAKM,cAAjB,EAAiC,KAAKE,MAAtC;AACD,GAFD,MAEO;AACL,0BAAY,KAAKA,MAAjB,EAAyB,KAAKF,cAA9B;AACD;AACD,OAAKN,UAAL,GAAkB,CAAC,KAAKA,UAAxB;AACD,CARD;;AAWA;;;;;AAKAF,YAAYpzB,SAAZ,CAAsBy1B,cAAtB,GAAuC,YAAW;AAChD,SAAO,KAAKjC,YAAZ;AACD,CAFD;;AAKA;;;;;AAKAJ,YAAYpzB,SAAZ,CAAsB01B,cAAtB,GAAuC,UAASjC,WAAT,EAAsB;AAC3D,MAAI,KAAKD,YAAL,KAAsBC,WAA1B,EAAuC;AACrC;AACD;AACD,OAAKD,YAAL,GAAoBC,WAApB;AACA,OAAKtoB,OAAL,CAAaoqB,SAAb,CAAuBC,MAAvB,CAA8B,kBAA9B;AACA,MAAI,CAAC/B,WAAD,IAAgB,KAAKH,UAAzB,EAAqC;AACnC,SAAKgC,aAAL;AACD;AACF,CATD;;AAYA;;;;;;;AAOAlC,YAAYpzB,SAAZ,CAAsB21B,YAAtB,GAAqC,UAASpC,SAAT,EAAoB;AACvD,MAAI,CAAC,KAAKC,YAAN,IAAsB,KAAKF,UAAL,KAAoBC,SAA9C,EAAyD;AACvD;AACD;AACD,OAAK+B,aAAL;AACD,CALD;;AAQA;;;;;;AAMAlC,YAAYpzB,SAAZ,CAAsB41B,YAAtB,GAAqC,YAAW;AAC9C,SAAO,KAAKtC,UAAZ;AACD,CAFD;kBAGeF,W;;;;;;;;;;;;;;;;;;ACzUf;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAGA;;;;;;;;;;;;AAaA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAxBA;;;AAmDA,IAAMkB,UAAU,SAAVA,OAAU,CAASznC,OAAT,EAAkB;;AAEhC0e,mBAAWlK,IAAX,CAAgB,IAAhB;;AAEA;;;;AAIA,OAAK8J,OAAL,GAAete,QAAQse,OAAR,GAAkBte,QAAQse,OAA1B,GAAoC,IAAnD;;AAEA;;;;AAIA,OAAK0qB,OAAL,GAAe,IAAf;;AAEA;;;;AAIA,OAAK/hB,IAAL,GAAY,IAAZ;;AAEA;;;;AAIA,OAAKgiB,YAAL,GAAoB,EAApB;;AAEA;;;AAGA,OAAKjU,MAAL,GAAch1B,QAAQg1B,MAAR,GAAiBh1B,QAAQg1B,MAAzB,GAAkC1U,oBAAhD;;AAEA,MAAItgB,QAAQrI,MAAZ,EAAoB;AAClB,SAAKm5B,SAAL,CAAe9wB,QAAQrI,MAAvB;AACD;AAEF,CArCD;;AAuCA,qBAAS8vC,OAAT,EAAkB/oB,gBAAlB;;AAGA;;;AAGA+oB,QAAQt0B,SAAR,CAAkBkN,eAAlB,GAAoC,YAAW;AAC7C,uBAAW,KAAK/B,OAAhB;AACAI,mBAAWvL,SAAX,CAAqBkN,eAArB,CAAqC7L,IAArC,CAA0C,IAA1C;AACD,CAHD;;AAMA;;;;;AAKAizB,QAAQt0B,SAAR,CAAkB+1B,MAAlB,GAA2B,YAAW;AACpC,SAAO,KAAKjiB,IAAZ;AACD,CAFD;;AAKA;;;;;;;AAOAwgB,QAAQt0B,SAAR,CAAkB4c,MAAlB,GAA2B,UAASt4B,GAAT,EAAc;AACvC,MAAI,KAAKwvB,IAAT,EAAe;AACb,yBAAW,KAAK3I,OAAhB;AACD;AACD,OAAK,IAAIrlB,IAAI,CAAR,EAAWwkB,KAAK,KAAKwrB,YAAL,CAAkB/vC,MAAvC,EAA+CD,IAAIwkB,EAAnD,EAAuD,EAAExkB,CAAzD,EAA4D;AAC1D,+BAAc,KAAKgwC,YAAL,CAAkBhwC,CAAlB,CAAd;AACD;AACD,OAAKgwC,YAAL,CAAkB/vC,MAAlB,GAA2B,CAA3B;AACA,OAAK+tB,IAAL,GAAYxvB,GAAZ;AACA,MAAI,KAAKwvB,IAAT,EAAe;AACb,QAAMtvB,SAAS,KAAKqxC,OAAL,GACb,KAAKA,OADQ,GACEvxC,IAAIw7B,4BAAJ,EADjB;AAEAt7B,WAAOm2B,WAAP,CAAmB,KAAKxP,OAAxB;AACA,QAAI,KAAK0W,MAAL,KAAgB1U,oBAApB,EAA+B;AAC7B,WAAK2oB,YAAL,CAAkBhuC,IAAlB,CAAuB,oBAAOxD,GAAP,EACrBu/B,uBAAa5M,UADQ,EACI,KAAK4K,MADT,EACiB,IADjB,CAAvB;AAED;AACDv9B,QAAIu9B,MAAJ;AACD;AACF,CAnBD;;AAsBA;;;;;;;;;AASAyS,QAAQt0B,SAAR,CAAkB2d,SAAlB,GAA8B,UAASn5B,MAAT,EAAiB;AAC7C,OAAKqxC,OAAL,GAAe,OAAOrxC,MAAP,KAAkB,QAAlB,GACb8xB,SAAS+I,cAAT,CAAwB76B,MAAxB,CADa,GAEbA,MAFF;AAGD,CAJD;kBAKe8vC,O;;;;;;;;;;;;;;;;;QCICzS,M,GAAAA,M;;AA3JhB;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AAGA;;;;;;;;;;;;;;;;AAiBA;;;;;;;;;;;AA7BA;;;;AAwCA,IAAMmU,SAAS,SAATA,MAAS,CAAS1qB,WAAT,EAAsB;;AAEnC,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA,MAAM4O,YAAYrtB,QAAQqtB,SAAR,KAAsBxzB,SAAtB,GAAkCmG,QAAQqtB,SAA1C,GAAsD,WAAxE;;AAEA,MAAMpoB,QAAQjF,QAAQiF,KAAR,KAAkBpL,SAAlB,GAA8BmG,QAAQiF,KAAtC,GAA8C,QAA5D;;AAEA;;;;AAIA,OAAKgiC,MAAL,GAAc,IAAd;;AAEA,MAAI,OAAOhiC,KAAP,KAAiB,QAArB,EAA+B;AAC7B,SAAKgiC,MAAL,GAAcxd,SAAS2D,aAAT,CAAuB,MAAvB,CAAd;AACA,SAAK6Z,MAAL,CAAY5Z,SAAZ,GAAwB,YAAxB;AACA,SAAK4Z,MAAL,CAAYD,WAAZ,GAA0B/hC,KAA1B;AACD,GAJD,MAIO;AACL,SAAKgiC,MAAL,GAAchiC,KAAd;AACA,SAAKgiC,MAAL,CAAYyB,SAAZ,CAAsBU,GAAtB,CAA0B,YAA1B;AACD;;AAED,MAAMvC,WAAW7mC,QAAQ6mC,QAAR,GAAmB7mC,QAAQ6mC,QAA3B,GAAsC,gBAAvD;;AAEA,MAAMrd,SAASC,SAAS2D,aAAT,CAAuB,QAAvB,CAAf;AACA5D,SAAO6D,SAAP,GAAmBA,YAAY,QAA/B;AACA7D,SAAOgM,YAAP,CAAoB,MAApB,EAA4B,QAA5B;AACAhM,SAAO2d,KAAP,GAAeN,QAAf;AACArd,SAAOsE,WAAP,CAAmB,KAAKmZ,MAAxB;;AAEA,sBAAOzd,MAAP,EAAezH,oBAAU2G,KAAzB,EACEygB,OAAOh2B,SAAP,CAAiBi0B,YADnB,EACiC,IADjC;;AAGA,MAAMC,aAAaha,YAAY,GAAZ,GAAkBia,uBAAlB,GAAuC,GAAvC,GAA6CC,kBAAhE;AACA,MAAMjpB,UAAUmL,SAAS2D,aAAT,CAAuB,KAAvB,CAAhB;AACA9O,UAAQ+O,SAAR,GAAoBga,UAApB;AACA/oB,UAAQwP,WAAR,CAAoBtE,MAApB;;AAEA,OAAK6f,eAAL,GAAuBrpC,QAAQspC,UAAR,GAAqBtpC,QAAQspC,UAA7B,GAA0CzvC,SAAjE;;AAEA4tC,oBAAQjzB,IAAR,CAAa,IAAb,EAAmB;AACjB8J,aAASA,OADQ;AAEjB0W,YAAQh1B,QAAQg1B,MAAR,IAAkBA,MAFT;AAGjBr9B,YAAQqI,QAAQrI;AAHC,GAAnB;;AAMA;;;;AAIA,OAAK4xC,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;;AAEA;;;;AAIA,OAAK0kB,SAAL,GAAiBxpC,QAAQypC,QAAR,KAAqB5vC,SAArB,GAAiCmG,QAAQypC,QAAzC,GAAoD,IAArE;;AAEA;;;;AAIA,OAAKC,SAAL,GAAiB7vC,SAAjB;;AAEA,MAAI,KAAK2vC,SAAT,EAAoB;AAClB,SAAKlrB,OAAL,CAAaoqB,SAAb,CAAuBU,GAAvB,CAA2BO,iBAA3B;AACD;AAEF,CArED;;AAuEA,qBAASR,MAAT,EAAiB1B,iBAAjB;;AAGA;;;;AAIA0B,OAAOh2B,SAAP,CAAiBi0B,YAAjB,GAAgC,UAASpe,KAAT,EAAgB;AAC9CA,QAAMnC,cAAN;AACA,MAAI,KAAKwiB,eAAL,KAAyBxvC,SAA7B,EAAwC;AACtC,SAAKwvC,eAAL;AACD,GAFD,MAEO;AACL,SAAKO,WAAL;AACD;AACF,CAPD;;AAUA;;;AAGAT,OAAOh2B,SAAP,CAAiBy2B,WAAjB,GAA+B,YAAW;AACxC,MAAMnyC,MAAM,KAAKyxC,MAAL,EAAZ;AACA,MAAMtxC,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,MAAI,CAACn7B,IAAL,EAAW;AACT;AACA;AACA;AACD;AACD,MAAIA,KAAKukC,WAAL,OAAuBtiC,SAA3B,EAAsC;AACpC,QAAI,KAAK0vC,SAAL,GAAiB,CAArB,EAAwB;AACtB3xC,WAAK8+B,OAAL,CAAa;AACXG,kBAAU,CADC;AAEX/R,kBAAU,KAAKykB,SAFJ;AAGXxM,gBAAQ8M;AAHG,OAAb;AAKD,KAND,MAMO;AACLjyC,WAAK6kC,WAAL,CAAiB,CAAjB;AACD;AACF;AACF,CAnBD;;AAsBA;;;;;;AAMO,SAASzH,MAAT,CAAgBoT,QAAhB,EAA0B;AAC/B,MAAMje,aAAaie,SAASje,UAA5B;AACA,MAAI,CAACA,UAAL,EAAiB;AACf;AACD;AACD,MAAM0M,WAAW1M,WAAW+L,SAAX,CAAqBW,QAAtC;AACA,MAAIA,YAAY,KAAK6S,SAArB,EAAgC;AAC9B,QAAMI,YAAY,YAAYjT,QAAZ,GAAuB,MAAzC;AACA,QAAI,KAAK2S,SAAT,EAAoB;AAClB,UAAMnQ,WAAW,KAAK/a,OAAL,CAAaoqB,SAAb,CAAuBrP,QAAvB,CAAgCsQ,iBAAhC,CAAjB;AACA,UAAI,CAACtQ,QAAD,IAAaxC,aAAa,CAA9B,EAAiC;AAC/B,aAAKvY,OAAL,CAAaoqB,SAAb,CAAuBU,GAAvB,CAA2BO,iBAA3B;AACD,OAFD,MAEO,IAAItQ,YAAYxC,aAAa,CAA7B,EAAgC;AACrC,aAAKvY,OAAL,CAAaoqB,SAAb,CAAuB9oB,MAAvB,CAA8B+pB,iBAA9B;AACD;AACF;AACD,SAAK1C,MAAL,CAAY5pB,KAAZ,CAAkB0sB,WAAlB,GAAgCD,SAAhC;AACA,SAAK7C,MAAL,CAAY5pB,KAAZ,CAAkB2sB,eAAlB,GAAoCF,SAApC;AACA,SAAK7C,MAAL,CAAY5pB,KAAZ,CAAkBysB,SAAlB,GAA8BA,SAA9B;AACD;AACD,OAAKJ,SAAL,GAAiB7S,QAAjB;AACD;;kBAEcsS,M;;;;;;;;;;;;;;;;;;ACnLf;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAGA;;;;;;;;;;;;;;;AAgBA;;;;;;;;;;;AA3BA;;;AAsCA,IAAMc,OAAO,SAAPA,IAAO,CAASxrB,WAAT,EAAsB;;AAEjC,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA,MAAM4O,YAAYrtB,QAAQqtB,SAAR,KAAsBxzB,SAAtB,GAAkCmG,QAAQqtB,SAA1C,GAAsD,SAAxE;;AAEA,MAAMiQ,QAAQt9B,QAAQs9B,KAAR,KAAkBzjC,SAAlB,GAA8BmG,QAAQs9B,KAAtC,GAA8C,CAA5D;;AAEA,MAAM4M,cAAclqC,QAAQkqC,WAAR,KAAwBrwC,SAAxB,GAAoCmG,QAAQkqC,WAA5C,GAA0D,GAA9E;AACA,MAAMC,eAAenqC,QAAQmqC,YAAR,KAAyBtwC,SAAzB,GAAqCmG,QAAQmqC,YAA7C,GAA4D,QAAjF;;AAEA,MAAMC,iBAAiBpqC,QAAQoqC,cAAR,KAA2BvwC,SAA3B,GACrBmG,QAAQoqC,cADa,GACI,SAD3B;AAEA,MAAMC,kBAAkBrqC,QAAQqqC,eAAR,KAA4BxwC,SAA5B,GACtBmG,QAAQqqC,eADc,GACI,UAD5B;;AAGA,MAAMC,YAAY7gB,SAAS2D,aAAT,CAAuB,QAAvB,CAAlB;AACAkd,YAAUjd,SAAV,GAAsBA,YAAY,KAAlC;AACAid,YAAU9U,YAAV,CAAuB,MAAvB,EAA+B,QAA/B;AACA8U,YAAUnD,KAAV,GAAkBiD,cAAlB;AACAE,YAAUxc,WAAV,CACE,OAAOoc,WAAP,KAAuB,QAAvB,GAAkCzgB,SAAS8gB,cAAT,CAAwBL,WAAxB,CAAlC,GAAyEA,WAD3E;;AAIA,sBAAOI,SAAP,EAAkBvoB,oBAAU2G,KAA5B,EACEuhB,KAAK92B,SAAL,CAAei0B,YAAf,CAA4B73B,IAA5B,CAAiC,IAAjC,EAAuC+tB,KAAvC,CADF;;AAGA,MAAMkN,aAAa/gB,SAAS2D,aAAT,CAAuB,QAAvB,CAAnB;AACAod,aAAWnd,SAAX,GAAuBA,YAAY,MAAnC;AACAmd,aAAWhV,YAAX,CAAwB,MAAxB,EAAgC,QAAhC;AACAgV,aAAWrD,KAAX,GAAmBkD,eAAnB;AACAG,aAAW1c,WAAX,CACE,OAAOqc,YAAP,KAAwB,QAAxB,GAAmC1gB,SAAS8gB,cAAT,CAAwBJ,YAAxB,CAAnC,GAA2EA,YAD7E;;AAIA,sBAAOK,UAAP,EAAmBzoB,oBAAU2G,KAA7B,EACEuhB,KAAK92B,SAAL,CAAei0B,YAAf,CAA4B73B,IAA5B,CAAiC,IAAjC,EAAuC,CAAC+tB,KAAxC,CADF;;AAGA,MAAM+J,aAAaha,YAAY,GAAZ,GAAkBia,uBAAlB,GAAuC,GAAvC,GAA6CC,kBAAhE;AACA,MAAMjpB,UAAUmL,SAAS2D,aAAT,CAAuB,KAAvB,CAAhB;AACA9O,UAAQ+O,SAAR,GAAoBga,UAApB;AACA/oB,UAAQwP,WAAR,CAAoBwc,SAApB;AACAhsB,UAAQwP,WAAR,CAAoB0c,UAApB;;AAEA/C,oBAAQjzB,IAAR,CAAa,IAAb,EAAmB;AACjB8J,aAASA,OADQ;AAEjB3mB,YAAQqI,QAAQrI;AAFC,GAAnB;;AAKA;;;;AAIA,OAAK4xC,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;AAED,CAvDD;;AAyDA,qBAASmlB,IAAT,EAAexC,iBAAf;;AAGA;;;;;AAKAwC,KAAK92B,SAAL,CAAei0B,YAAf,GAA8B,UAAS9J,KAAT,EAAgBtU,KAAhB,EAAuB;AACnDA,QAAMnC,cAAN;AACA,OAAK4jB,YAAL,CAAkBnN,KAAlB;AACD,CAHD;;AAMA;;;;AAIA2M,KAAK92B,SAAL,CAAes3B,YAAf,GAA8B,UAASnN,KAAT,EAAgB;AAC5C,MAAM7lC,MAAM,KAAKyxC,MAAL,EAAZ;AACA,MAAMtxC,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,MAAI,CAACn7B,IAAL,EAAW;AACT;AACA;AACA;AACD;AACD,MAAM4mC,oBAAoB5mC,KAAKkrB,aAAL,EAA1B;AACA,MAAI0b,iBAAJ,EAAuB;AACrB,QAAMkM,gBAAgB9yC,KAAKgkC,mBAAL,CAAyB4C,iBAAzB,EAA4ClB,KAA5C,CAAtB;AACA,QAAI,KAAKiM,SAAL,GAAiB,CAArB,EAAwB;AACtB,UAAI3xC,KAAK6lC,YAAL,EAAJ,EAAyB;AACvB7lC,aAAK+lC,gBAAL;AACD;AACD/lC,WAAK8+B,OAAL,CAAa;AACXpU,oBAAYooB,aADD;AAEX5lB,kBAAU,KAAKykB,SAFJ;AAGXxM,gBAAQ8M;AAHG,OAAb;AAKD,KATD,MASO;AACLjyC,WAAKsqC,aAAL,CAAmBwI,aAAnB;AACD;AACF;AACF,CAxBD;kBAyBeT,I;;;;;;;;;;;;;;;;;QCjGCU,Q,GAAAA,Q;;AAtChB;;;;AACA;;;;AACA;;;;AACA;;;;;;AAGA;;;;;;;;;;;;;;;;AAiBA;;;;;;;;;;;;;;;AA1BA;;;AAyCO,SAASA,QAAT,CAAkBlsB,WAAlB,EAA+B;;AAEpC,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA,MAAM8G,WAAW,IAAIhH,oBAAJ,EAAjB;;AAEA,MAAMqsB,cAAc5qC,QAAQjI,IAAR,KAAiB8B,SAAjB,GAA6BmG,QAAQjI,IAArC,GAA4C,IAAhE;AACA,MAAI6yC,WAAJ,EAAiB;AACfrlB,aAAStqB,IAAT,CAAc,IAAIgvC,cAAJ,CAASjqC,QAAQ6qC,WAAjB,CAAd;AACD;;AAED,MAAMC,gBAAgB9qC,QAAQ+gC,MAAR,KAAmBlnC,SAAnB,GAA+BmG,QAAQ+gC,MAAvC,GAAgD,IAAtE;AACA,MAAI+J,aAAJ,EAAmB;AACjBvlB,aAAStqB,IAAT,CAAc,IAAIkuC,gBAAJ,CAAWnpC,QAAQ+qC,aAAnB,CAAd;AACD;;AAED,MAAMC,qBAAqBhrC,QAAQirC,WAAR,KAAwBpxC,SAAxB,GACzBmG,QAAQirC,WADiB,GACH,IADxB;AAEA,MAAID,kBAAJ,EAAwB;AACtBzlB,aAAStqB,IAAT,CAAc,IAAIsrC,qBAAJ,CAAgBvmC,QAAQkrC,kBAAxB,CAAd;AACD;;AAED,SAAO3lB,QAAP;AACD,C;;;;;;;;;;;;;;;;;QCvBe6jB,G,GAAAA,G;QAcA+B,e,GAAAA,e;QAkCAC,gB,GAAAA,gB;QAwDAC,c,GAAAA,c;QAoBAC,mB,GAAAA,mB;QA0DAh0C,M,GAAAA,M;QAgBAmiC,M,GAAAA,M;QA8BAsH,M,GAAAA,M;QA4BAwK,K,GAAAA,K;QAYAC,e,GAAAA,e;QAYAC,Q,GAAAA,Q;QAaAC,wB,GAAAA,wB;QAgCAC,Y,GAAAA,Y;QAmCAC,U,GAAAA,U;;AA9YhB;;AACA;;AAGA;;;;;;AAOA;;;;;;;;AASA;;;;;;;;;;;;;;;;;;AAvBA;;;AAyCO,SAASxC,GAAT,CAAa1iB,UAAb,EAAyB4W,KAAzB,EAAgC;AACrC5W,aAAW,CAAX,KAAiB4W,MAAM,CAAN,CAAjB;AACA5W,aAAW,CAAX,KAAiB4W,MAAM,CAAN,CAAjB;AACA,SAAO5W,UAAP;AACD;;AAGD;;;;;;;AAOO,SAASykB,eAAT,CAAyBzkB,UAAzB,EAAqCmlB,MAArC,EAA6C;AAClD,MAAM3zC,IAAI2zC,OAAOC,SAAP,EAAV;AACA,MAAMh0C,SAAS+zC,OAAO3P,SAAP,EAAf;AACA,MAAM+B,KAAKnmC,OAAO,CAAP,CAAX;AACA,MAAMomC,KAAKpmC,OAAO,CAAP,CAAX;AACA,MAAMqmC,KAAKzX,WAAW,CAAX,CAAX;AACA,MAAM0X,KAAK1X,WAAW,CAAX,CAAX;;AAEA,MAAI3B,KAAKoZ,KAAKF,EAAd;AACA,MAAMjZ,KAAKoZ,KAAKF,EAAhB;AACA,MAAInZ,OAAO,CAAP,IAAYC,OAAO,CAAvB,EAA0B;AACxBD,SAAK,CAAL;AACD;AACD,MAAM/S,IAAIhV,KAAKsG,IAAL,CAAUyhB,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,CAAV;;AAEA,MAAM3hB,IAAI46B,KAAK/lC,IAAI6sB,EAAJ,GAAS/S,CAAxB;AACA,MAAMZ,IAAI8sB,KAAKhmC,IAAI8sB,EAAJ,GAAShT,CAAxB;;AAEA,SAAO,CAAC3O,CAAD,EAAI+N,CAAJ,CAAP;AACD;;AAGD;;;;;;;;;;;;AAYO,SAASg6B,gBAAT,CAA0B1kB,UAA1B,EAAsCqlB,OAAtC,EAA+C;AACpD,MAAM9N,KAAKvX,WAAW,CAAX,CAAX;AACA,MAAMwX,KAAKxX,WAAW,CAAX,CAAX;AACA,MAAMgW,QAAQqP,QAAQ,CAAR,CAAd;AACA,MAAMnnB,MAAMmnB,QAAQ,CAAR,CAAZ;AACA,MAAM5N,KAAKzB,MAAM,CAAN,CAAX;AACA,MAAM0B,KAAK1B,MAAM,CAAN,CAAX;AACA,MAAMjpB,KAAKmR,IAAI,CAAJ,CAAX;AACA,MAAMonB,KAAKpnB,IAAI,CAAJ,CAAX;AACA,MAAMG,KAAKtR,KAAK0qB,EAAhB;AACA,MAAMnZ,KAAKgnB,KAAK5N,EAAhB;AACA,MAAM6N,QAASlnB,OAAO,CAAP,IAAYC,OAAO,CAApB,GAAyB,CAAzB,GACZ,CAAED,MAAMkZ,KAAKE,EAAX,CAAD,GAAoBnZ,MAAMkZ,KAAKE,EAAX,CAArB,KAA0CrZ,KAAKA,EAAL,GAAUC,KAAKA,EAAhB,IAAuB,CAAhE,CADF;AAEA,MAAI3hB,UAAJ;AAAA,MAAO+N,UAAP;AACA,MAAI66B,SAAS,CAAb,EAAgB;AACd5oC,QAAI86B,EAAJ;AACA/sB,QAAIgtB,EAAJ;AACD,GAHD,MAGO,IAAI6N,SAAS,CAAb,EAAgB;AACrB5oC,QAAIoQ,EAAJ;AACArC,QAAI46B,EAAJ;AACD,GAHM,MAGA;AACL3oC,QAAI86B,KAAK8N,QAAQlnB,EAAjB;AACA3T,QAAIgtB,KAAK6N,QAAQjnB,EAAjB;AACD;AACD,SAAO,CAAC3hB,CAAD,EAAI+N,CAAJ,CAAP;AACD;;AAGD;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BO,SAASi6B,cAAT,CAAwBa,kBAAxB,EAA4C;AACjD;AACE;;;;AAIA,cAASxlB,UAAT,EAAqB;AACnB,aAAOklB,WAAWllB,UAAX,EAAuBwlB,kBAAvB,CAAP;AACD;AAPH;AASD;;AAGD;;;;;;;AAOO,SAASZ,mBAAT,CAA6Ba,WAA7B,EAA0CC,OAA1C,EAAmDF,kBAAnD,EAAuE;AAC5E,MAAMG,oBAAoB,kBAAOD,UAAU,GAAjB,EAAsB,GAAtB,IAA6B,GAAvD;AACA,MAAM/oC,IAAIrG,KAAKmH,GAAL,CAAS,OAAOkoC,iBAAhB,CAAV;AACA,MAAMC,eAAeJ,sBAAsB,CAA3C;AACA,MAAMK,YAAYvvC,KAAKoG,GAAL,CAAS,EAAT,EAAakpC,YAAb,CAAlB;;AAEA,MAAIE,MAAMxvC,KAAKC,KAAL,CAAWoG,IAAI,IAAf,CAAV;AACA,MAAIY,MAAMjH,KAAKC,KAAL,CAAW,CAACoG,IAAImpC,MAAM,IAAX,IAAmB,EAA9B,CAAV;AACA,MAAIC,MAAMppC,IAAKmpC,MAAM,IAAX,GAAoBvoC,MAAM,EAApC;AACAwoC,QAAMzvC,KAAKqH,IAAL,CAAUooC,MAAMF,SAAhB,IAA6BA,SAAnC;;AAEA,MAAIE,OAAO,EAAX,EAAe;AACbA,UAAM,CAAN;AACAxoC,WAAO,CAAP;AACD;;AAED,MAAIA,OAAO,EAAX,EAAe;AACbA,UAAM,CAAN;AACAuoC,WAAO,CAAP;AACD;;AAED,SAAOA,MAAM,OAAN,GAAkB,uBAAUvoC,GAAV,EAAe,CAAf,CAAlB,GAAsC,SAAtC,GACL,uBAAUwoC,GAAV,EAAe,CAAf,EAAkBH,YAAlB,CADK,GAC6B,QAD7B,IAEJD,qBAAqB,CAArB,GAAyB,EAAzB,GAA8B,MAAMF,YAAYO,MAAZ,CAAmBL,oBAAoB,CAApB,GAAwB,CAAxB,GAA4B,CAA/C,CAFhC,CAAP;AAGD;;AAGD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BO,SAAS/0C,MAAT,CAAgBovB,UAAhB,EAA4BimB,QAA5B,EAAsCT,kBAAtC,EAA0D;AAC/D,MAAIxlB,UAAJ,EAAgB;AACd,WAAOimB,SACJ3xB,OADI,CACI,KADJ,EACW0L,WAAW,CAAX,EAAckmB,OAAd,CAAsBV,kBAAtB,CADX,EAEJlxB,OAFI,CAEI,KAFJ,EAEW0L,WAAW,CAAX,EAAckmB,OAAd,CAAsBV,kBAAtB,CAFX,CAAP;AAGD,GAJD,MAIO;AACL,WAAO,EAAP;AACD;AACF;;AAGD;;;;;AAKO,SAASzS,MAAT,CAAgBoT,WAAhB,EAA6BC,WAA7B,EAA0C;AAC/C,MAAIrT,SAAS,IAAb;AACA,OAAK,IAAIxgC,IAAI4zC,YAAY3zC,MAAZ,GAAqB,CAAlC,EAAqCD,KAAK,CAA1C,EAA6C,EAAEA,CAA/C,EAAkD;AAChD,QAAI4zC,YAAY5zC,CAAZ,KAAkB6zC,YAAY7zC,CAAZ,CAAtB,EAAsC;AACpCwgC,eAAS,KAAT;AACA;AACD;AACF;AACD,SAAOA,MAAP;AACD;;AAGD;;;;;;;;;;;;;;;;;;AAkBO,SAASsH,MAAT,CAAgBra,UAAhB,EAA4BqmB,KAA5B,EAAmC;AACxC,MAAM5L,WAAWnkC,KAAK4G,GAAL,CAASmpC,KAAT,CAAjB;AACA,MAAM3L,WAAWpkC,KAAK2G,GAAL,CAASopC,KAAT,CAAjB;AACA,MAAM1pC,IAAIqjB,WAAW,CAAX,IAAgBya,QAAhB,GAA2Bza,WAAW,CAAX,IAAgB0a,QAArD;AACA,MAAMhwB,IAAIsV,WAAW,CAAX,IAAgBya,QAAhB,GAA2Bza,WAAW,CAAX,IAAgB0a,QAArD;AACA1a,aAAW,CAAX,IAAgBrjB,CAAhB;AACAqjB,aAAW,CAAX,IAAgBtV,CAAhB;AACA,SAAOsV,UAAP;AACD;;AAGD;;;;;;;;;;;;;;;;;AAiBO,SAAS6kB,KAAT,CAAe7kB,UAAf,EAA2B6kB,KAA3B,EAAkC;AACvC7kB,aAAW,CAAX,KAAiB6kB,KAAjB;AACA7kB,aAAW,CAAX,KAAiB6kB,KAAjB;AACA,SAAO7kB,UAAP;AACD;;AAGD;;;;;AAKO,SAAS8kB,eAAT,CAAyBwB,MAAzB,EAAiCC,MAAjC,EAAyC;AAC9C,MAAMloB,KAAKioB,OAAO,CAAP,IAAYC,OAAO,CAAP,CAAvB;AACA,MAAMjoB,KAAKgoB,OAAO,CAAP,IAAYC,OAAO,CAAP,CAAvB;AACA,SAAOloB,KAAKA,EAAL,GAAUC,KAAKA,EAAtB;AACD;;AAGD;;;;;AAKO,SAASymB,QAAT,CAAkBuB,MAAlB,EAA0BC,MAA1B,EAAkC;AACvC,SAAOjwC,KAAKsG,IAAL,CAAUkoC,gBAAgBwB,MAAhB,EAAwBC,MAAxB,CAAV,CAAP;AACD;;AAGD;;;;;;;;AAQO,SAASvB,wBAAT,CAAkChlB,UAAlC,EAA8CqlB,OAA9C,EAAuD;AAC5D,SAAOP,gBAAgB9kB,UAAhB,EACL0kB,iBAAiB1kB,UAAjB,EAA6BqlB,OAA7B,CADK,CAAP;AAED;;AAGD;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BO,SAASJ,YAAT,CAAsBjlB,UAAtB,EAAkCwlB,kBAAlC,EAAsD;AAC3D,MAAIxlB,UAAJ,EAAgB;AACd,WAAO4kB,oBAAoB,IAApB,EAA0B5kB,WAAW,CAAX,CAA1B,EAAyCwlB,kBAAzC,IAA+D,GAA/D,GACHZ,oBAAoB,IAApB,EAA0B5kB,WAAW,CAAX,CAA1B,EAAyCwlB,kBAAzC,CADJ;AAED,GAHD,MAGO;AACL,WAAO,EAAP;AACD;AACF;;AAGD;;;;;;;;;;;;;;;;;;;;;;;;;AAyBO,SAASN,UAAT,CAAoBllB,UAApB,EAAgCwlB,kBAAhC,EAAoD;AACzD,SAAO50C,OAAOovB,UAAP,EAAmB,UAAnB,EAA+BwlB,kBAA/B,CAAP;AACD,C;;;;;;;;;;;;;;;;;ACnZD;;;;AAKA;;;;;;AAMO,IAAMvC,sCAAe,WAArB;;AAGP;;;;;;AAMO,IAAMuD,8CAAmB,eAAzB;;AAGP;;;;;;AAMO,IAAM5F,kDAAqB,iBAA3B;;AAGP;;;;;;AAMO,IAAM6F,gDAAoB,gBAA1B;;AAGP;;;;;;AAMO,IAAM5F,wCAAgB,YAAtB;;AAGP;;;;;;;AAOO,IAAMC,4CAAkB,cAAxB;;AAGP;;;;;;AAMO,IAAM4F,4CAAmB,YAAW;AACzC,MAAI/vB,cAAJ;AACA,MAAM0oB,QAAQ,EAAd;AACA,SAAO,UAASroB,IAAT,EAAe;AACpB,QAAI,CAACL,KAAL,EAAY;AACVA,cAAQoM,SAAS2D,aAAT,CAAuB,KAAvB,EAA8B/P,KAAtC;AACD;AACD,QAAI,EAAEK,QAAQqoB,KAAV,CAAJ,EAAsB;AACpB1oB,YAAMK,IAAN,GAAaA,IAAb;AACA,UAAM2vB,SAAShwB,MAAMS,UAArB;AACAT,YAAMK,IAAN,GAAa,EAAb;AACA,UAAI,CAAC2vB,MAAL,EAAa;AACX,eAAO,IAAP;AACD;AACDtH,YAAMroB,IAAN,IAAc2vB,OAAOhyB,KAAP,CAAa,MAAb,CAAd;AACD;AACD,WAAO0qB,MAAMroB,IAAN,CAAP;AACD,GAdD;AAeD,CAlB8B,EAAxB,C;;;;;;;;;;;;;;;;;QCvDS4vB,qB,GAAAA,qB;QAmBAC,U,GAAAA,U;QAgBAC,W,GAAAA,W;QAYAC,W,GAAAA,W;QAWAC,U,GAAAA,U;QAOAC,c,GAAAA,c;AA5EhB;;;;AAKA;;;;;;AAMO,SAASL,qBAAT,CAA+BM,SAA/B,EAA0CC,UAA1C,EAAsD;AAC3D,MAAM3qB,SAAS,gCAAkCuG,SAAS2D,aAAT,CAAuB,QAAvB,CAAjD;AACA,MAAIwgB,SAAJ,EAAe;AACb1qB,WAAOuK,KAAP,GAAemgB,SAAf;AACD;AACD,MAAIC,UAAJ,EAAgB;AACd3qB,WAAOwK,MAAP,GAAgBmgB,UAAhB;AACD;AACD,SAAO,wCAAyC3qB,OAAO4qB,UAAP,CAAkB,IAAlB;AAAhD;AACD;;AAGD;;;;;;;AAOO,SAASP,UAAT,CAAoBjvB,OAApB,EAA6B;AAClC,MAAImP,QAAQnP,QAAQmZ,WAApB;AACA,MAAMpa,QAAQma,iBAAiBlZ,OAAjB,CAAd;AACAmP,WAAShT,SAAS4C,MAAM0wB,UAAf,EAA2B,EAA3B,IAAiCtzB,SAAS4C,MAAM2wB,WAAf,EAA4B,EAA5B,CAA1C;;AAEA,SAAOvgB,KAAP;AACD;;AAGD;;;;;;;AAOO,SAAS+f,WAAT,CAAqBlvB,OAArB,EAA8B;AACnC,MAAIoP,SAASpP,QAAQoZ,YAArB;AACA,MAAMra,QAAQma,iBAAiBlZ,OAAjB,CAAd;AACAoP,YAAUjT,SAAS4C,MAAM4wB,SAAf,EAA0B,EAA1B,IAAgCxzB,SAAS4C,MAAM6wB,YAAf,EAA6B,EAA7B,CAA1C;;AAEA,SAAOxgB,MAAP;AACD;;AAED;;;;AAIO,SAAS+f,WAAT,CAAqBU,OAArB,EAA8BC,OAA9B,EAAuC;AAC5C,MAAM71C,SAAS61C,QAAQC,UAAvB;AACA,MAAI91C,MAAJ,EAAY;AACVA,WAAO+1C,YAAP,CAAoBH,OAApB,EAA6BC,OAA7B;AACD;AACF;;AAED;;;;AAIO,SAASV,UAAT,CAAoBa,IAApB,EAA0B;AAC/B,SAAOA,QAAQA,KAAKF,UAAb,GAA0BE,KAAKF,UAAL,CAAgBzI,WAAhB,CAA4B2I,IAA5B,CAA1B,GAA8D,IAArE;AACD;;AAED;;;AAGO,SAASZ,cAAT,CAAwBY,IAAxB,EAA8B;AACnC,SAAOA,KAAKC,SAAZ,EAAuB;AACrBD,SAAK3I,WAAL,CAAiB2I,KAAKC,SAAtB;AACD;AACF,C;;;;;;;;;;;;;;;;;QCrEeC,M,GAAAA,M;QAWA5E,O,GAAAA,O;QAWA7M,Q,GAAAA,Q;QAWA0R,M,GAAAA,M;QAaAC,S,GAAAA,S;AAzDhB;;;;AAKA;;;;;;AAMO,SAASF,MAAT,CAAgBhxC,CAAhB,EAAmB;AACxB,SAAOT,KAAKoG,GAAL,CAAS3F,CAAT,EAAY,CAAZ,CAAP;AACD;;AAGD;;;;;;AAMO,SAASosC,OAAT,CAAiBpsC,CAAjB,EAAoB;AACzB,SAAO,IAAIgxC,OAAO,IAAIhxC,CAAX,CAAX;AACD;;AAGD;;;;;;AAMO,SAASu/B,QAAT,CAAkBv/B,CAAlB,EAAqB;AAC1B,SAAO,IAAIA,CAAJ,GAAQA,CAAR,GAAY,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAA/B;AACD;;AAGD;;;;;;AAMO,SAASixC,MAAT,CAAgBjxC,CAAhB,EAAmB;AACxB,SAAOA,CAAP;AACD;;AAGD;;;;;;;;AAQO,SAASkxC,SAAT,CAAmBlxC,CAAnB,EAAsB;AAC3B,MAAIA,IAAI,GAAR,EAAa;AACX,WAAOu/B,SAAS,IAAIv/B,CAAb,CAAP;AACD,GAFD,MAEO;AACL,WAAO,IAAIu/B,SAAS,KAAKv/B,IAAI,GAAT,CAAT,CAAX;AACD;AACF,C;;;;;;;;;;;;;;;;;QC9BemxC,Y,GAAAA,Y;QAyBAC,Y,GAAAA,Y;QAqBAC,Y,GAAAA,Y;QA+DAC,M,GAAAA,M;QAgDAC,U,GAAAA,U;QAkBAC,Q,GAAAA,Q;QAoBA1lB,a,GAAAA,a;QAwBA2lB,W,GAAAA,W;;AAzPhB;;AAGA;;;;;;;;;;;;;AAcA;;;;;;;;AASA;;;;AAIO,SAASN,YAAT,CAAsBO,WAAtB,EAAmC;AACxC,MAAMC,gBAAgB,SAAhBA,aAAgB,CAASC,GAAT,EAAc;AAClC,QAAMxjB,WAAWsjB,YAAYtjB,QAA7B;AACA,QAAMyjB,SAASH,YAAYG,MAAZ,IAAsBH,YAAYx3C,MAAjD;AACA,QAAIw3C,YAAYI,QAAhB,EAA0B;AACxBhmB,oBAAc4lB,WAAd;AACD;AACD,WAAOtjB,SAASrX,IAAT,CAAc86B,MAAd,EAAsBD,GAAtB,CAAP;AACD,GAPD;AAQAF,cAAYC,aAAZ,GAA4BA,aAA5B;AACA,SAAOA,aAAP;AACD;;AAGD;;;;;;;;;;;AA/CA;;;AA0DO,SAASP,YAAT,CAAsBW,SAAtB,EAAiC3jB,QAAjC,EAA2C2F,QAA3C,EAAqDie,kBAArD,EAAyE;AAC9E,MAAIN,oBAAJ;AACA,OAAK,IAAIl2C,IAAI,CAAR,EAAWwkB,KAAK+xB,UAAUt2C,MAA/B,EAAuCD,IAAIwkB,EAA3C,EAA+C,EAAExkB,CAAjD,EAAoD;AAClDk2C,kBAAcK,UAAUv2C,CAAV,CAAd;AACA,QAAIk2C,YAAYtjB,QAAZ,KAAyBA,QAAzB,IACAsjB,YAAYG,MAAZ,KAAuB9d,QAD3B,EACqC;AACnC,UAAIie,kBAAJ,EAAwB;AACtBN,oBAAYO,WAAZ,GAA0Bz2C,CAA1B;AACD;AACD,aAAOk2C,WAAP;AACD;AACF;AACD,SAAOt1C,SAAP;AACD;;AAGD;;;;;AAKO,SAASi1C,YAAT,CAAsBn3C,MAAtB,EAA8B4B,IAA9B,EAAoC;AACzC,MAAMo2C,cAAch4C,OAAOi4C,KAA3B;AACA,SAAOD,cAAcA,YAAYp2C,IAAZ,CAAd,GAAkCM,SAAzC;AACD;;AAGD;;;;;;;AAOA,SAASg2C,cAAT,CAAwBl4C,MAAxB,EAAgC;AAC9B,MAAIg4C,cAAch4C,OAAOi4C,KAAzB;AACA,MAAI,CAACD,WAAL,EAAkB;AAChBA,kBAAch4C,OAAOi4C,KAAP,GAAe,EAA7B;AACD;AACD,SAAOD,WAAP;AACD;;AAGD;;;;;;;AAOA,SAASG,eAAT,CAAyBn4C,MAAzB,EAAiC4B,IAAjC,EAAuC;AACrC,MAAMi2C,YAAYV,aAAan3C,MAAb,EAAqB4B,IAArB,CAAlB;AACA,MAAIi2C,SAAJ,EAAe;AACb,SAAK,IAAIv2C,IAAI,CAAR,EAAWwkB,KAAK+xB,UAAUt2C,MAA/B,EAAuCD,IAAIwkB,EAA3C,EAA+C,EAAExkB,CAAjD,EAAoD;AAClDtB,aAAOg5B,mBAAP,CAA2Bp3B,IAA3B,EAAiCi2C,UAAUv2C,CAAV,EAAam2C,aAA9C;AACA,sBAAMI,UAAUv2C,CAAV,CAAN;AACD;AACDu2C,cAAUt2C,MAAV,GAAmB,CAAnB;AACA,QAAMy2C,cAAch4C,OAAOi4C,KAA3B;AACA,QAAID,WAAJ,EAAiB;AACf,aAAOA,YAAYp2C,IAAZ,CAAP;AACA,UAAIR,OAAO6N,IAAP,CAAY+oC,WAAZ,EAAyBz2C,MAAzB,KAAoC,CAAxC,EAA2C;AACzC,eAAOvB,OAAOi4C,KAAd;AACD;AACF;AACF;AACF;;AAGD;;;;;;;;;;;;;;;AAeO,SAASb,MAAT,CAAgBp3C,MAAhB,EAAwB4B,IAAxB,EAA8BsyB,QAA9B,EAAwC2F,QAAxC,EAAkDue,QAAlD,EAA4D;AACjE,MAAMJ,cAAcE,eAAel4C,MAAf,CAApB;AACA,MAAI63C,YAAYG,YAAYp2C,IAAZ,CAAhB;AACA,MAAI,CAACi2C,SAAL,EAAgB;AACdA,gBAAYG,YAAYp2C,IAAZ,IAAoB,EAAhC;AACD;AACD,MAAI41C,cAAcN,aAAaW,SAAb,EAAwB3jB,QAAxB,EAAkC2F,QAAlC,EAA4C,KAA5C,CAAlB;AACA,MAAI2d,WAAJ,EAAiB;AACf,QAAI,CAACY,QAAL,EAAe;AACb;AACAZ,kBAAYI,QAAZ,GAAuB,KAAvB;AACD;AACF,GALD,MAKO;AACLJ,kBAAc,yCAA2C;AACvDG,cAAQ9d,QAD+C;AAEvD+d,gBAAU,CAAC,CAACQ,QAF2C;AAGvDlkB,gBAAUA,QAH6C;AAIvDl0B,cAAQA,MAJ+C;AAKvD4B,YAAMA;AALiD,KAAzD;AAOA5B,WAAO29B,gBAAP,CAAwB/7B,IAAxB,EAA8Bq1C,aAAaO,WAAb,CAA9B;AACAK,cAAUv0C,IAAV,CAAek0C,WAAf;AACD;;AAED,SAAOA,WAAP;AACD;;AAGD;;;;;;;;;;;;;;;;;;;;AAoBO,SAASH,UAAT,CAAoBr3C,MAApB,EAA4B4B,IAA5B,EAAkCsyB,QAAlC,EAA4C2F,QAA5C,EAAsD;AAC3D,SAAOud,OAAOp3C,MAAP,EAAe4B,IAAf,EAAqBsyB,QAArB,EAA+B2F,QAA/B,EAAyC,IAAzC,CAAP;AACD;;AAGD;;;;;;;;;;;;;AAaO,SAASyd,QAAT,CAAkBt3C,MAAlB,EAA0B4B,IAA1B,EAAgCsyB,QAAhC,EAA0C2F,QAA1C,EAAoD;AACzD,MAAMge,YAAYV,aAAan3C,MAAb,EAAqB4B,IAArB,CAAlB;AACA,MAAIi2C,SAAJ,EAAe;AACb,QAAML,cAAcN,aAAaW,SAAb,EAAwB3jB,QAAxB,EAAkC2F,QAAlC,EAA4C,IAA5C,CAApB;AACA,QAAI2d,WAAJ,EAAiB;AACf5lB,oBAAc4lB,WAAd;AACD;AACF;AACF;;AAGD;;;;;;;;;AASO,SAAS5lB,aAAT,CAAuBjoB,GAAvB,EAA4B;AACjC,MAAIA,OAAOA,IAAI3J,MAAf,EAAuB;AACrB2J,QAAI3J,MAAJ,CAAWg5B,mBAAX,CAA+BrvB,IAAI/H,IAAnC,EAAyC+H,IAAI8tC,aAA7C;AACA,QAAMI,YAAYV,aAAaxtC,IAAI3J,MAAjB,EAAyB2J,IAAI/H,IAA7B,CAAlB;AACA,QAAIi2C,SAAJ,EAAe;AACb,UAAMv2C,IAAI,iBAAiBqI,GAAjB,GAAuBA,IAAIouC,WAA3B,GAAyCF,UAAUlrC,OAAV,CAAkBhD,GAAlB,CAAnD;AACA,UAAIrI,MAAM,CAAC,CAAX,EAAc;AACZu2C,kBAAUjwB,MAAV,CAAiBtmB,CAAjB,EAAoB,CAApB;AACD;AACD,UAAIu2C,UAAUt2C,MAAV,KAAqB,CAAzB,EAA4B;AAC1B42C,wBAAgBxuC,IAAI3J,MAApB,EAA4B2J,IAAI/H,IAAhC;AACD;AACF;AACD,oBAAM+H,GAAN;AACD;AACF;;AAGD;;;;;;AAMO,SAAS4tC,WAAT,CAAqBv3C,MAArB,EAA6B;AAClC,MAAMg4C,cAAcE,eAAel4C,MAAf,CAApB;AACA,OAAK,IAAM4B,IAAX,IAAmBo2C,WAAnB,EAAgC;AAC9BG,oBAAgBn4C,MAAhB,EAAwB4B,IAAxB;AACD;AACF,C;;;;;;;;;;;;;;;;;QCrMeutB,e,GAAAA,e;QAQAD,c,GAAAA,c;AApEhB;;;AAGA;;;;;;;;;;;;;AAaA,IAAMxI,QAAQ,SAARA,KAAQ,CAAS9kB,IAAT,EAAe;;AAE3B;;;AAGA,OAAK8vB,kBAAL;;AAEA;;;;;AAKA,OAAK9vB,IAAL,GAAYA,IAAZ;;AAEA;;;;;AAKA,OAAK5B,MAAL,GAAc,IAAd;AAED,CArBD;;AAwBA;;;;;AAKA0mB,MAAMlL,SAAN,CAAgB0T,cAAhB;;AAEE;;;;;AAKAxI,MAAMlL,SAAN,CAAgB2T,eAAhB,GAAkC,YAAW;AAC3C,OAAKuC,kBAAL,GAA0B,IAA1B;AACD,CATH;;AAYA;;;AAGO,SAASvC,eAAT,CAAyBuoB,GAAzB,EAA8B;AACnCA,MAAIvoB,eAAJ;AACD;;AAGD;;;AAGO,SAASD,cAAT,CAAwBwoB,GAAxB,EAA6B;AAClCA,MAAIxoB,cAAJ;AACD;;kBAEcxI,K;;;;;;;;;;;;;;;;;;ACrEf;;AACA;;;;AACA;;AACA;;AACA;;;;;;AAGA;;;;AAKA;;;;;;;;;;;;;;;;;;AAkBA,IAAMoE,cAAc,SAAdA,WAAc,GAAW;;AAE7BvC,uBAAW1L,IAAX,CAAgB,IAAhB;;AAEA;;;;AAIA,OAAKw7B,gBAAL,GAAwB,EAAxB;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoB,EAApB;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkB,EAAlB;AAED,CAtBD,C,CAjCA;;;;;AAyDA,qBAASztB,WAAT,EAAsBvC,oBAAtB;;AAGA;;;;AAIAuC,YAAYtP,SAAZ,CAAsBmiB,gBAAtB,GAAyC,UAAS/7B,IAAT,EAAesyB,QAAf,EAAyB;AAChE,MAAI2jB,YAAY,KAAKU,UAAL,CAAgB32C,IAAhB,CAAhB;AACA,MAAI,CAACi2C,SAAL,EAAgB;AACdA,gBAAY,KAAKU,UAAL,CAAgB32C,IAAhB,IAAwB,EAApC;AACD;AACD,MAAIi2C,UAAUlrC,OAAV,CAAkBunB,QAAlB,MAAgC,CAAC,CAArC,EAAwC;AACtC2jB,cAAUv0C,IAAV,CAAe4wB,QAAf;AACD;AACF,CARD;;AAWA;;;;;;;AAOApJ,YAAYtP,SAAZ,CAAsBqM,aAAtB,GAAsC,UAASwJ,KAAT,EAAgB;AACpD,MAAMqmB,MAAM,OAAOrmB,KAAP,KAAiB,QAAjB,GAA4B,IAAI3K,eAAJ,CAAU2K,KAAV,CAA5B,GAA+CA,KAA3D;AACA,MAAMzvB,OAAO81C,IAAI91C,IAAjB;AACA81C,MAAI13C,MAAJ,GAAa,IAAb;AACA,MAAM63C,YAAY,KAAKU,UAAL,CAAgB32C,IAAhB,CAAlB;AACA,MAAI42C,kBAAJ;AACA,MAAIX,SAAJ,EAAe;AACb,QAAI,EAAEj2C,QAAQ,KAAK02C,YAAf,CAAJ,EAAkC;AAChC,WAAKA,YAAL,CAAkB12C,IAAlB,IAA0B,CAA1B;AACA,WAAKy2C,gBAAL,CAAsBz2C,IAAtB,IAA8B,CAA9B;AACD;AACD,MAAE,KAAK02C,YAAL,CAAkB12C,IAAlB,CAAF;AACA,SAAK,IAAIN,IAAI,CAAR,EAAWwkB,KAAK+xB,UAAUt2C,MAA/B,EAAuCD,IAAIwkB,EAA3C,EAA+C,EAAExkB,CAAjD,EAAoD;AAClD,UAAIu2C,UAAUv2C,CAAV,EAAaub,IAAb,CAAkB,IAAlB,EAAwB66B,GAAxB,MAAiC,KAAjC,IAA0CA,IAAIhmB,kBAAlD,EAAsE;AACpE8mB,oBAAY,KAAZ;AACA;AACD;AACF;AACD,MAAE,KAAKF,YAAL,CAAkB12C,IAAlB,CAAF;AACA,QAAI,KAAK02C,YAAL,CAAkB12C,IAAlB,MAA4B,CAAhC,EAAmC;AACjC,UAAI62C,kBAAkB,KAAKJ,gBAAL,CAAsBz2C,IAAtB,CAAtB;AACA,aAAO,KAAKy2C,gBAAL,CAAsBz2C,IAAtB,CAAP;AACA,aAAO62C,iBAAP,EAA0B;AACxB,aAAKzf,mBAAL,CAAyBp3B,IAAzB,EAA+B+mB,oBAA/B;AACD;AACD,aAAO,KAAK2vB,YAAL,CAAkB12C,IAAlB,CAAP;AACD;AACD,WAAO42C,SAAP;AACD;AACF,CA7BD;;AAgCA;;;AAGA1tB,YAAYtP,SAAZ,CAAsBkN,eAAtB,GAAwC,YAAW;AACjD,2BAAY,IAAZ;AACD,CAFD;;AAKA;;;;;;;AAOAoC,YAAYtP,SAAZ,CAAsB27B,YAAtB,GAAqC,UAASv1C,IAAT,EAAe;AAClD,SAAO,KAAK22C,UAAL,CAAgB32C,IAAhB,CAAP;AACD,CAFD;;AAKA;;;;;AAKAkpB,YAAYtP,SAAZ,CAAsBk9B,WAAtB,GAAoC,UAASzc,QAAT,EAAmB;AACrD,SAAOA,WACLA,YAAY,KAAKsc,UADZ,GAELn3C,OAAO6N,IAAP,CAAY,KAAKspC,UAAjB,EAA6Bh3C,MAA7B,GAAsC,CAFxC;AAGD,CAJD;;AAOA;;;;AAIAupB,YAAYtP,SAAZ,CAAsBwd,mBAAtB,GAA4C,UAASp3B,IAAT,EAAesyB,QAAf,EAAyB;AACnE,MAAM2jB,YAAY,KAAKU,UAAL,CAAgB32C,IAAhB,CAAlB;AACA,MAAIi2C,SAAJ,EAAe;AACb,QAAMlyC,QAAQkyC,UAAUlrC,OAAV,CAAkBunB,QAAlB,CAAd;AACA,QAAItyB,QAAQ,KAAKy2C,gBAAjB,EAAmC;AACjC;AACAR,gBAAUlyC,KAAV,IAAmBgjB,oBAAnB;AACA,QAAE,KAAK0vB,gBAAL,CAAsBz2C,IAAtB,CAAF;AACD,KAJD,MAIO;AACLi2C,gBAAUjwB,MAAV,CAAiBjiB,KAAjB,EAAwB,CAAxB;AACA,UAAIkyC,UAAUt2C,MAAV,KAAqB,CAAzB,EAA4B;AAC1B,eAAO,KAAKg3C,UAAL,CAAgB32C,IAAhB,CAAP;AACD;AACF;AACF;AACF,CAfD;kBAgBekpB,W;;;;;;;;;;;;;;;;;ACtKf;;;;AAIA;;;;kBAIe;AACb;;;;;AAKAT,UAAQ,QANK;;AAQbsuB,SAAO,OARM;AASb3hB,eAAa,aATA;AAUbjG,SAAO,OAVM;AAWbE,YAAU,UAXG;AAYb2nB,aAAW,WAZE;AAabC,YAAU,UAbG;AAcbjd,QAAM,MAdO;AAeb3P,SAAO,OAfM;AAgBbuR,WAAS,SAhBI;AAiBbC,YAAU,UAjBG;AAkBbqb,QAAM,MAlBO;AAmBbxiB,aAAW,WAnBE;AAoBbyiB,aAAW,WApBE;AAqBbC,YAAU,UArBG;AAsBbC,WAAS,SAtBI;AAuBbxiB,cAAY,YAvBC;AAwBbD,iBAAe,eAxBF;AAyBbyC,UAAQ,QAzBK;AA0Bb1C,cAAY,YA1BC;AA2Bb2iB,aAAW,WA3BE;AA4BbC,YAAU,UA5BG;AA6BbziB,SAAO;AA7BM,C;;;;;;;;;;;;;;;;;ACRf;;;;AAIA;;;;kBAIe;AACb0iB,QAAM,EADO;AAEbC,MAAI,EAFS;AAGbC,SAAO,EAHM;AAIbC,QAAM;AAJO,C;;;;;;;;;;;;;;;;;;;ACLf;;;;AACA;;AACA;;AACA;;;;AAGA;;;;;;;AAQA;;;;;;;;AAjBA;;;AAyBO,IAAMC,kCAAa,SAAbA,UAAa,CAAStd,eAAT,EAA0B;AAClD,MAAMtN,gBAAgBsN,gBAAgBtN,aAAtC;AACA,SACEA,cAAc6qB,MAAd,IACE,EAAE7qB,cAAc8qB,OAAd,IAAyB9qB,cAAc+qB,OAAzC,CADF,IAEE,CAAC/qB,cAAcgrB,QAHnB;AAID,CANM;;AASP;;;;;;;;AAQO,IAAMC,8CAAmB,SAAnBA,gBAAmB,CAAS3d,eAAT,EAA0B;AACxD,MAAMtN,gBAAgBsN,gBAAgBtN,aAAtC;AACA,SACEA,cAAc6qB,MAAd,IACE,EAAE7qB,cAAc8qB,OAAd,IAAyB9qB,cAAc+qB,OAAzC,CADF,IAEE/qB,cAAcgrB,QAHlB;AAID,CANM;;AASP;;;;;;;;AAQO,IAAM7d,wBAAQ,SAARA,KAAQ,CAAS1K,KAAT,EAAgB;AACnC,SAAOA,MAAMrxB,MAAN,CAAa46B,gBAAb,OAAoC9I,SAASgoB,aAApD;AACD,CAFM;;AAKP;;;;;;;;AAQO,IAAMC,0BAASvgB,eAAf;;AAGP;;;;;;;AAOO,IAAMwgB,wBAAQ,SAARA,KAAQ,CAAS9d,eAAT,EAA0B;AAC7C,SAAOA,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBC,KAAnD;AACD,CAFM;;AAKP;;;;;;;;;AASO,IAAMkpB,gDAAoB,SAApBA,iBAAoB,CAAS/d,eAAT,EAA0B;AACzD,MAAMtN,gBAAgBsN,gBAAgBtN,aAAtC;AACA,SAAOA,cAAciD,MAAd,IAAwB,CAAxB,IACH,EAAEqoB,eAAUC,QAAV,IAAiBvrB,cAAc+qB,OAAjC,CADJ;AAED,CAJM;;AAOP;;;;;;;;AAQO,IAAMS,wBAAQC,gBAAd;;AAGP;;;;;;;;AAQO,IAAMC,oCAAc,SAAdA,WAAc,CAASpe,eAAT,EAA0B;AACnD,SAAOA,gBAAgBt6B,IAAhB,IAAwB,aAA/B;AACD,CAFM;;AAKP;;;;;;;AAOO,IAAM24C,oCAAc,SAAdA,WAAc,CAASre,eAAT,EAA0B;AACnD,SAAOA,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBK,WAAnD;AACD,CAFM;;AAKP;;;;;;;AAOO,IAAMqpB,oCAAc,SAAdA,WAAc,CAASte,eAAT,EAA0B;AACnD,SAAOA,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBG,QAAnD;AACD,CAFM;;AAKP;;;;;;;;AAQO,IAAMwpB,0CAAiB,SAAjBA,cAAiB,CAASve,eAAT,EAA0B;AACtD,MAAMtN,gBAAgBsN,gBAAgBtN,aAAtC;AACA,SACE,CAACA,cAAc6qB,MAAf,IACE,EAAE7qB,cAAc8qB,OAAd,IAAyB9qB,cAAc+qB,OAAzC,CADF,IAEE,CAAC/qB,cAAcgrB,QAHnB;AAID,CANM;;AASP;;;;;;;;;AASO,IAAMc,4DAA0B,SAA1BA,uBAA0B,CAASxe,eAAT,EAA0B;AAC/D,MAAMtN,gBAAgBsN,gBAAgBtN,aAAtC;AACA,SAAO,CAACA,cAAc6qB,MAAf,KACJU,WAAMvrB,cAAc8qB,OAApB,GAA8B9qB,cAAc+qB,OADxC,KAEL,CAAC/qB,cAAcgrB,QAFjB;AAGD,CALM;;AAQP;;;;;;;;AAQO,IAAMe,sCAAe,SAAfA,YAAe,CAASze,eAAT,EAA0B;AACpD,MAAMtN,gBAAgBsN,gBAAgBtN,aAAtC;AACA,SACE,CAACA,cAAc6qB,MAAf,IACE,EAAE7qB,cAAc8qB,OAAd,IAAyB9qB,cAAc+qB,OAAzC,CADF,IAEE/qB,cAAcgrB,QAHlB;AAID,CANM;;AASP;;;;;;;;AAQO,IAAMgB,gDAAoB,SAApBA,iBAAoB,CAAS1e,eAAT,EAA0B;AACzD,MAAMl8B,SAASk8B,gBAAgBtN,aAAhB,CAA8B5uB,MAA7C;AACA,MAAM66C,UAAU76C,OAAO66C,OAAvB;AACA,SACEA,YAAY,OAAZ,IACEA,YAAY,QADd,IAEEA,YAAY,UAHhB;AAID,CAPM;;AAUP;;;;;;;AAOO,IAAMC,gCAAY,SAAZA,SAAY,CAAS5e,eAAT,EAA0B;AACjD,uBAAOA,gBAAgBvL,YAAvB,EAAqC,EAArC,EADiD,CACP;AAC1C;AACA;AACE,4CAA0CuL,eAAD,CAAkBvL,YAAlB,CAA+BoqB,WAA/B,IAA8C;AADzF;AAGD,CANM;;AASP;;;;;;;;;AASO,IAAMC,wCAAgB,SAAhBA,aAAgB,CAAS9e,eAAT,EAA0B;AACrD,MAAMvL,eAAeuL,gBAAgBvL,YAArC;AACA,SAAOA,aAAasqB,SAAb,IAA0BtqB,aAAakB,MAAb,KAAwB,CAAzD;AACD,CAHM,C;;;;;;;;;;;;;;;;;QChOSqpB,c,GAAAA,c;QAiCAh+B,M,GAAAA,M;QAyBAuM,K,GAAAA,K;QAmBA0xB,wB,GAAAA,wB;QA4BAC,kB,GAAAA,kB;QAiBAC,c,GAAAA,c;QAeAzZ,U,GAAAA,U;QAYA0Z,sB,GAAAA,sB;QA8BAC,W,GAAAA,W;QAcApa,c,GAAAA,c;QAkBAqa,mB,GAAAA,mB;QAWAC,4B,GAAAA,4B;QAYAC,6B,GAAAA,6B;QAcAC,iC,GAAAA,iC;QAUAC,uB,GAAAA,uB;QAaA9Z,M,GAAAA,M;QAaAva,M,GAAAA,M;QAqBAs0B,gB,GAAAA,gB;QAqBAC,iB,GAAAA,iB;QAgBAC,qB,GAAAA,qB;QAaAC,W,GAAAA,W;QAaAC,Q,GAAAA,Q;QAkBAC,a,GAAAA,a;QA4BAC,O,GAAAA,O;QAeAC,a,GAAAA,a;QAWAC,c,GAAAA,c;QAWA9X,S,GAAAA,S;QAWA+X,S,GAAAA,S;QAwBAC,e,GAAAA,e;QAiBAC,iB,GAAAA,iB;QAgCAza,S,GAAAA,S;QAUA0a,mB,GAAAA,mB;QAcAC,e,GAAAA,e;QAkCAC,S,GAAAA,S;QAWAxhB,O,GAAAA,O;QAWAyhB,U,GAAAA,U;QAWAC,W,GAAAA,W;QAWA7a,Q,GAAAA,Q;QAYAC,U,GAAAA,U;QAcAxF,O,GAAAA,O;QAUAqgB,c,GAAAA,c;QAiBAC,e,GAAAA,e;QAkBAC,iB,GAAAA,iB;QAyDAC,c,GAAAA,c;;AA/wBhB;;AACA;;;;AACA;;;;;;AAGA;;;;;;AAMA;;;;;;;AAOO,SAAS/B,cAAT,CAAwBgC,WAAxB,EAAqC;AAC1C,MAAMxyB,SAAS6wB,aAAf;AACA,OAAK,IAAIj6C,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiD,EAAExkB,CAAnD,EAAsD;AACpDu6C,qBAAiBnxB,MAAjB,EAAyBwyB,YAAY57C,CAAZ,CAAzB;AACD;AACD,SAAOopB,MAAP;AACD;;AAGD;;;;;;;AA9BA;;;AAqCA,SAASyyB,kBAAT,CAA4BC,EAA5B,EAAgCC,EAAhC,EAAoCC,UAApC,EAAgD;AAC9C,MAAMjc,OAAOh8B,KAAKiH,GAAL,CAASxI,KAAT,CAAe,IAAf,EAAqBs5C,EAArB,CAAb;AACA,MAAM7b,OAAOl8B,KAAKiH,GAAL,CAASxI,KAAT,CAAe,IAAf,EAAqBu5C,EAArB,CAAb;AACA,MAAM/b,OAAOj8B,KAAKkH,GAAL,CAASzI,KAAT,CAAe,IAAf,EAAqBs5C,EAArB,CAAb;AACA,MAAM5b,OAAOn8B,KAAKkH,GAAL,CAASzI,KAAT,CAAe,IAAf,EAAqBu5C,EAArB,CAAb;AACA,SAAOlc,eAAeE,IAAf,EAAqBE,IAArB,EAA2BD,IAA3B,EAAiCE,IAAjC,EAAuC8b,UAAvC,CAAP;AACD;;AAGD;;;;;;;;AAQO,SAASpgC,MAAT,CAAgBwN,MAAhB,EAAwB7lB,KAAxB,EAA+By4C,UAA/B,EAA2C;AAChD,MAAIA,UAAJ,EAAgB;AACdA,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,IAAY7lB,KAA5B;AACAy4C,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,IAAY7lB,KAA5B;AACAy4C,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,IAAY7lB,KAA5B;AACAy4C,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,IAAY7lB,KAA5B;AACA,WAAOy4C,UAAP;AACD,GAND,MAMO;AACL,WAAO,CACL5yB,OAAO,CAAP,IAAY7lB,KADP,EAEL6lB,OAAO,CAAP,IAAY7lB,KAFP,EAGL6lB,OAAO,CAAP,IAAY7lB,KAHP,EAIL6lB,OAAO,CAAP,IAAY7lB,KAJP,CAAP;AAMD;AACF;;AAGD;;;;;;;AAOO,SAAS4kB,KAAT,CAAeiB,MAAf,EAAuB4yB,UAAvB,EAAmC;AACxC,MAAIA,UAAJ,EAAgB;AACdA,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,CAAhB;AACA4yB,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,CAAhB;AACA4yB,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,CAAhB;AACA4yB,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,CAAhB;AACA,WAAO4yB,UAAP;AACD,GAND,MAMO;AACL,WAAO5yB,OAAOvpB,KAAP,EAAP;AACD;AACF;;AAGD;;;;;;AAMO,SAASg6C,wBAAT,CAAkCzwB,MAAlC,EAA0Chf,CAA1C,EAA6C+N,CAA7C,EAAgD;AACrD,MAAI2T,WAAJ;AAAA,MAAQC,WAAR;AACA,MAAI3hB,IAAIgf,OAAO,CAAP,CAAR,EAAmB;AACjB0C,SAAK1C,OAAO,CAAP,IAAYhf,CAAjB;AACD,GAFD,MAEO,IAAIgf,OAAO,CAAP,IAAYhf,CAAhB,EAAmB;AACxB0hB,SAAK1hB,IAAIgf,OAAO,CAAP,CAAT;AACD,GAFM,MAEA;AACL0C,SAAK,CAAL;AACD;AACD,MAAI3T,IAAIiR,OAAO,CAAP,CAAR,EAAmB;AACjB2C,SAAK3C,OAAO,CAAP,IAAYjR,CAAjB;AACD,GAFD,MAEO,IAAIiR,OAAO,CAAP,IAAYjR,CAAhB,EAAmB;AACxB4T,SAAK5T,IAAIiR,OAAO,CAAP,CAAT;AACD,GAFM,MAEA;AACL2C,SAAK,CAAL;AACD;AACD,SAAOD,KAAKA,EAAL,GAAUC,KAAKA,EAAtB;AACD;;AAGD;;;;;;;;AAQO,SAAS+tB,kBAAT,CAA4B1wB,MAA5B,EAAoCqE,UAApC,EAAgD;AACrD,SAAO6S,WAAWlX,MAAX,EAAmBqE,WAAW,CAAX,CAAnB,EAAkCA,WAAW,CAAX,CAAlC,CAAP;AACD;;AAGD;;;;;;;;;;;;AAYO,SAASssB,cAAT,CAAwBkC,OAAxB,EAAiCC,OAAjC,EAA0C;AAC/C,SAAOD,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CAAd,IAA4BA,QAAQ,CAAR,KAAcD,QAAQ,CAAR,CAA1C,IACHA,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CADX,IACyBA,QAAQ,CAAR,KAAcD,QAAQ,CAAR,CAD9C;AAED;;AAGD;;;;;;;;;AASO,SAAS3b,UAAT,CAAoBlX,MAApB,EAA4Bhf,CAA5B,EAA+B+N,CAA/B,EAAkC;AACvC,SAAOiR,OAAO,CAAP,KAAahf,CAAb,IAAkBA,KAAKgf,OAAO,CAAP,CAAvB,IAAoCA,OAAO,CAAP,KAAajR,CAAjD,IAAsDA,KAAKiR,OAAO,CAAP,CAAlE;AACD;;AAGD;;;;;;;AAOO,SAAS4wB,sBAAT,CAAgC5wB,MAAhC,EAAwCqE,UAAxC,EAAoD;AACzD,MAAMsS,OAAO3W,OAAO,CAAP,CAAb;AACA,MAAM6W,OAAO7W,OAAO,CAAP,CAAb;AACA,MAAM4W,OAAO5W,OAAO,CAAP,CAAb;AACA,MAAM8W,OAAO9W,OAAO,CAAP,CAAb;AACA,MAAMhf,IAAIqjB,WAAW,CAAX,CAAV;AACA,MAAMtV,IAAIsV,WAAW,CAAX,CAAV;AACA,MAAI0uB,eAAeC,uBAAaC,OAAhC;AACA,MAAIjyC,IAAI21B,IAAR,EAAc;AACZoc,mBAAeA,eAAeC,uBAAatE,IAA3C;AACD,GAFD,MAEO,IAAI1tC,IAAI41B,IAAR,EAAc;AACnBmc,mBAAeA,eAAeC,uBAAapE,KAA3C;AACD;AACD,MAAI7/B,IAAI8nB,IAAR,EAAc;AACZkc,mBAAeA,eAAeC,uBAAaE,KAA3C;AACD,GAFD,MAEO,IAAInkC,IAAI+nB,IAAR,EAAc;AACnBic,mBAAeA,eAAeC,uBAAaG,KAA3C;AACD;AACD,MAAIJ,iBAAiBC,uBAAaC,OAAlC,EAA2C;AACzCF,mBAAeC,uBAAaI,YAA5B;AACD;AACD,SAAOL,YAAP;AACD;;AAGD;;;;;AAKO,SAASlC,WAAT,GAAuB;AAC5B,SAAO,CAAC7rC,QAAD,EAAWA,QAAX,EAAqB,CAACA,QAAtB,EAAgC,CAACA,QAAjC,CAAP;AACD;;AAGD;;;;;;;;;AASO,SAASyxB,cAAT,CAAwBE,IAAxB,EAA8BE,IAA9B,EAAoCD,IAApC,EAA0CE,IAA1C,EAAgD8b,UAAhD,EAA4D;AACjE,MAAIA,UAAJ,EAAgB;AACdA,eAAW,CAAX,IAAgBjc,IAAhB;AACAic,eAAW,CAAX,IAAgB/b,IAAhB;AACA+b,eAAW,CAAX,IAAgBhc,IAAhB;AACAgc,eAAW,CAAX,IAAgB9b,IAAhB;AACA,WAAO8b,UAAP;AACD,GAND,MAMO;AACL,WAAO,CAACjc,IAAD,EAAOE,IAAP,EAAaD,IAAb,EAAmBE,IAAnB,CAAP;AACD;AACF;;AAGD;;;;;AAKO,SAASga,mBAAT,CAA6B8B,UAA7B,EAAyC;AAC9C,SAAOnc,eACLzxB,QADK,EACKA,QADL,EACe,CAACA,QADhB,EAC0B,CAACA,QAD3B,EACqC4tC,UADrC,CAAP;AAED;;AAGD;;;;;AAKO,SAAS7B,4BAAT,CAAsC1sB,UAAtC,EAAkDuuB,UAAlD,EAA8D;AACnE,MAAM5xC,IAAIqjB,WAAW,CAAX,CAAV;AACA,MAAMtV,IAAIsV,WAAW,CAAX,CAAV;AACA,SAAOoS,eAAez1B,CAAf,EAAkB+N,CAAlB,EAAqB/N,CAArB,EAAwB+N,CAAxB,EAA2B6jC,UAA3B,CAAP;AACD;;AAGD;;;;;AAKO,SAAS5B,6BAAT,CAAuCwB,WAAvC,EAAoDI,UAApD,EAAgE;AACrE,MAAM5yB,SAAS8wB,oBAAoB8B,UAApB,CAAf;AACA,SAAOxB,kBAAkBpxB,MAAlB,EAA0BwyB,WAA1B,CAAP;AACD;;AAGD;;;;;;;;AAQO,SAASvB,iCAAT,CAA2CoC,eAA3C,EAA4DnV,MAA5D,EAAoE3b,GAApE,EAAyE6c,MAAzE,EAAiFwT,UAAjF,EAA6F;AAClG,MAAM5yB,SAAS8wB,oBAAoB8B,UAApB,CAAf;AACA,SAAOvB,sBAAsBrxB,MAAtB,EAA8BqzB,eAA9B,EAA+CnV,MAA/C,EAAuD3b,GAAvD,EAA4D6c,MAA5D,CAAP;AACD;;AAED;;;;;AAKO,SAAS8R,uBAAT,CAAiCoC,KAAjC,EAAwCV,UAAxC,EAAoD;AACzD,MAAM5yB,SAAS8wB,oBAAoB8B,UAApB,CAAf;AACA,SAAOtB,YAAYtxB,MAAZ,EAAoBszB,KAApB,CAAP;AACD;;AAGD;;;;;;;AAOO,SAASlc,MAAT,CAAgByb,OAAhB,EAAyBC,OAAzB,EAAkC;AACvC,SAAOD,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CAAd,IAA4BD,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CAA1C,IACHD,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CADX,IACyBD,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CAD9C;AAED;;AAGD;;;;;;;AAOO,SAASj2B,MAAT,CAAgBg2B,OAAhB,EAAyBC,OAAzB,EAAkC;AACvC,MAAIA,QAAQ,CAAR,IAAaD,QAAQ,CAAR,CAAjB,EAA6B;AAC3BA,YAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAb;AACD;AACD,MAAIA,QAAQ,CAAR,IAAaD,QAAQ,CAAR,CAAjB,EAA6B;AAC3BA,YAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAb;AACD;AACD,MAAIA,QAAQ,CAAR,IAAaD,QAAQ,CAAR,CAAjB,EAA6B;AAC3BA,YAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAb;AACD;AACD,MAAIA,QAAQ,CAAR,IAAaD,QAAQ,CAAR,CAAjB,EAA6B;AAC3BA,YAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAb;AACD;AACD,SAAOD,OAAP;AACD;;AAGD;;;;AAIO,SAAS1B,gBAAT,CAA0BnxB,MAA1B,EAAkCqE,UAAlC,EAA8C;AACnD,MAAIA,WAAW,CAAX,IAAgBrE,OAAO,CAAP,CAApB,EAA+B;AAC7BA,WAAO,CAAP,IAAYqE,WAAW,CAAX,CAAZ;AACD;AACD,MAAIA,WAAW,CAAX,IAAgBrE,OAAO,CAAP,CAApB,EAA+B;AAC7BA,WAAO,CAAP,IAAYqE,WAAW,CAAX,CAAZ;AACD;AACD,MAAIA,WAAW,CAAX,IAAgBrE,OAAO,CAAP,CAApB,EAA+B;AAC7BA,WAAO,CAAP,IAAYqE,WAAW,CAAX,CAAZ;AACD;AACD,MAAIA,WAAW,CAAX,IAAgBrE,OAAO,CAAP,CAApB,EAA+B;AAC7BA,WAAO,CAAP,IAAYqE,WAAW,CAAX,CAAZ;AACD;AACF;;AAGD;;;;;AAKO,SAAS+sB,iBAAT,CAA2BpxB,MAA3B,EAAmCwyB,WAAnC,EAAgD;AACrD,OAAK,IAAI57C,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiD,EAAExkB,CAAnD,EAAsD;AACpDu6C,qBAAiBnxB,MAAjB,EAAyBwyB,YAAY57C,CAAZ,CAAzB;AACD;AACD,SAAOopB,MAAP;AACD;;AAGD;;;;;;;;AAQO,SAASqxB,qBAAT,CAA+BrxB,MAA/B,EAAuCqzB,eAAvC,EAAwDnV,MAAxD,EAAgE3b,GAAhE,EAAqE6c,MAArE,EAA6E;AAClF,SAAOlB,SAAS3b,GAAhB,EAAqB2b,UAAUkB,MAA/B,EAAuC;AACrCmS,aAASvxB,MAAT,EAAiBqzB,gBAAgBnV,MAAhB,CAAjB,EAA0CmV,gBAAgBnV,SAAS,CAAzB,CAA1C;AACD;AACD,SAAOle,MAAP;AACD;;AAGD;;;;;AAKO,SAASsxB,WAAT,CAAqBtxB,MAArB,EAA6BszB,KAA7B,EAAoC;AACzC,OAAK,IAAI18C,IAAI,CAAR,EAAWwkB,KAAKk4B,MAAMz8C,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9Cw6C,sBAAkBpxB,MAAlB,EAA0BszB,MAAM18C,CAAN,CAA1B;AACD;AACD,SAAOopB,MAAP;AACD;;AAGD;;;;;AAKO,SAASuxB,QAAT,CAAkBvxB,MAAlB,EAA0Bhf,CAA1B,EAA6B+N,CAA7B,EAAgC;AACrCiR,SAAO,CAAP,IAAYrlB,KAAKiH,GAAL,CAASoe,OAAO,CAAP,CAAT,EAAoBhf,CAApB,CAAZ;AACAgf,SAAO,CAAP,IAAYrlB,KAAKiH,GAAL,CAASoe,OAAO,CAAP,CAAT,EAAoBjR,CAApB,CAAZ;AACAiR,SAAO,CAAP,IAAYrlB,KAAKkH,GAAL,CAASme,OAAO,CAAP,CAAT,EAAoBhf,CAApB,CAAZ;AACAgf,SAAO,CAAP,IAAYrlB,KAAKkH,GAAL,CAASme,OAAO,CAAP,CAAT,EAAoBjR,CAApB,CAAZ;AACD;;AAGD;;;;;;;;;;AAUO,SAASyiC,aAAT,CAAuBxxB,MAAvB,EAA+B2O,QAA/B,EAAyCQ,QAAzC,EAAmD;AACxD,MAAI/oB,YAAJ;AACAA,QAAMuoB,SAASxc,IAAT,CAAcgd,QAAd,EAAwBuiB,cAAc1xB,MAAd,CAAxB,CAAN;AACA,MAAI5Z,GAAJ,EAAS;AACP,WAAOA,GAAP;AACD;AACDA,QAAMuoB,SAASxc,IAAT,CAAcgd,QAAd,EAAwBwiB,eAAe3xB,MAAf,CAAxB,CAAN;AACA,MAAI5Z,GAAJ,EAAS;AACP,WAAOA,GAAP;AACD;AACDA,QAAMuoB,SAASxc,IAAT,CAAcgd,QAAd,EAAwBgjB,YAAYnyB,MAAZ,CAAxB,CAAN;AACA,MAAI5Z,GAAJ,EAAS;AACP,WAAOA,GAAP;AACD;AACDA,QAAMuoB,SAASxc,IAAT,CAAcgd,QAAd,EAAwB+iB,WAAWlyB,MAAX,CAAxB,CAAN;AACA,MAAI5Z,GAAJ,EAAS;AACP,WAAOA,GAAP;AACD;AACD,SAAO,KAAP;AACD;;AAGD;;;;;;AAMO,SAASqrC,OAAT,CAAiBzxB,MAAjB,EAAyB;AAC9B,MAAIuzB,OAAO,CAAX;AACA,MAAI,CAACxhB,QAAQ/R,MAAR,CAAL,EAAsB;AACpBuzB,WAAOjc,SAAStX,MAAT,IAAmBqX,UAAUrX,MAAV,CAA1B;AACD;AACD,SAAOuzB,IAAP;AACD;;AAGD;;;;;;AAMO,SAAS7B,aAAT,CAAuB1xB,MAAvB,EAA+B;AACpC,SAAO,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAP;AACD;;AAGD;;;;;;AAMO,SAAS2xB,cAAT,CAAwB3xB,MAAxB,EAAgC;AACrC,SAAO,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAP;AACD;;AAGD;;;;;;AAMO,SAAS6Z,SAAT,CAAmB7Z,MAAnB,EAA2B;AAChC,SAAO,CAAC,CAACA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,IAA0B,CAA3B,EAA8B,CAACA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,IAA0B,CAAxD,CAAP;AACD;;AAGD;;;;;;AAMO,SAAS4xB,SAAT,CAAmB5xB,MAAnB,EAA2BwzB,MAA3B,EAAmC;AACxC,MAAInvB,mBAAJ;AACA,MAAImvB,WAAWC,iBAAOC,WAAtB,EAAmC;AACjCrvB,iBAAaqtB,cAAc1xB,MAAd,CAAb;AACD,GAFD,MAEO,IAAIwzB,WAAWC,iBAAOE,YAAtB,EAAoC;AACzCtvB,iBAAastB,eAAe3xB,MAAf,CAAb;AACD,GAFM,MAEA,IAAIwzB,WAAWC,iBAAOG,QAAtB,EAAgC;AACrCvvB,iBAAa6tB,WAAWlyB,MAAX,CAAb;AACD,GAFM,MAEA,IAAIwzB,WAAWC,iBAAOI,SAAtB,EAAiC;AACtCxvB,iBAAa8tB,YAAYnyB,MAAZ,CAAb;AACD,GAFM,MAEA;AACL,yBAAO,KAAP,EAAc,EAAd,EADK,CACc;AACpB;AACD;AACE,mDAAiDqE;AADnD;AAGD;;AAGD;;;;;AAKO,SAASwtB,eAAT,CAAyBgB,OAAzB,EAAkCC,OAAlC,EAA2C;AAChD,MAAMnc,OAAOh8B,KAAKiH,GAAL,CAASixC,QAAQ,CAAR,CAAT,EAAqBC,QAAQ,CAAR,CAArB,CAAb;AACA,MAAMjc,OAAOl8B,KAAKiH,GAAL,CAASixC,QAAQ,CAAR,CAAT,EAAqBC,QAAQ,CAAR,CAArB,CAAb;AACA,MAAMlc,OAAOj8B,KAAKkH,GAAL,CAASgxC,QAAQ,CAAR,CAAT,EAAqBC,QAAQ,CAAR,CAArB,CAAb;AACA,MAAMhc,OAAOn8B,KAAKkH,GAAL,CAASgxC,QAAQ,CAAR,CAAT,EAAqBC,QAAQ,CAAR,CAArB,CAAb;AACA,SAAO,CAAClc,OAAOD,IAAR,KAAiBG,OAAOD,IAAxB,CAAP;AACD;;AAGD;;;;;;;;AAQO,SAASib,iBAAT,CAA2Br8C,MAA3B,EAAmCwqB,UAAnC,EAA+CuU,QAA/C,EAAyD3Z,IAAzD,EAA+D+3B,UAA/D,EAA2E;AAChF,MAAMlwB,KAAKzC,aAAapF,KAAK,CAAL,CAAb,GAAuB,CAAlC;AACA,MAAM8H,KAAK1C,aAAapF,KAAK,CAAL,CAAb,GAAuB,CAAlC;AACA,MAAMi5B,cAAcn5C,KAAK4G,GAAL,CAASizB,QAAT,CAApB;AACA,MAAMuf,cAAcp5C,KAAK2G,GAAL,CAASkzB,QAAT,CAApB;AACA,MAAMwf,OAAOtxB,KAAKoxB,WAAlB;AACA,MAAMG,OAAOvxB,KAAKqxB,WAAlB;AACA,MAAMG,OAAOvxB,KAAKmxB,WAAlB;AACA,MAAMK,OAAOxxB,KAAKoxB,WAAlB;AACA,MAAM/yC,IAAIvL,OAAO,CAAP,CAAV;AACA,MAAMsZ,IAAItZ,OAAO,CAAP,CAAV;AACA,MAAMmmC,KAAK56B,IAAIgzC,IAAJ,GAAWG,IAAtB;AACA,MAAMrY,KAAK96B,IAAIgzC,IAAJ,GAAWG,IAAtB;AACA,MAAM/iC,KAAKpQ,IAAIgzC,IAAJ,GAAWG,IAAtB;AACA,MAAMC,KAAKpzC,IAAIgzC,IAAJ,GAAWG,IAAtB;AACA,MAAMtY,KAAK9sB,IAAIklC,IAAJ,GAAWC,IAAtB;AACA,MAAMnY,KAAKhtB,IAAIklC,IAAJ,GAAWC,IAAtB;AACA,MAAMvK,KAAK56B,IAAIklC,IAAJ,GAAWC,IAAtB;AACA,MAAMG,KAAKtlC,IAAIklC,IAAJ,GAAWC,IAAtB;AACA,SAAOzd,eACL97B,KAAKiH,GAAL,CAASg6B,EAAT,EAAaE,EAAb,EAAiB1qB,EAAjB,EAAqBgjC,EAArB,CADK,EACqBz5C,KAAKiH,GAAL,CAASi6B,EAAT,EAAaE,EAAb,EAAiB4N,EAAjB,EAAqB0K,EAArB,CADrB,EAEL15C,KAAKkH,GAAL,CAAS+5B,EAAT,EAAaE,EAAb,EAAiB1qB,EAAjB,EAAqBgjC,EAArB,CAFK,EAEqBz5C,KAAKkH,GAAL,CAASg6B,EAAT,EAAaE,EAAb,EAAiB4N,EAAjB,EAAqB0K,EAArB,CAFrB,EAGLzB,UAHK,CAAP;AAID;;AAGD;;;;;;AAMO,SAASvb,SAAT,CAAmBrX,MAAnB,EAA2B;AAChC,SAAOA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAnB;AACD;;AAGD;;;;;AAKO,SAAS+xB,mBAAT,CAA6Bc,OAA7B,EAAsCC,OAAtC,EAA+C;AACpD,MAAMwB,eAAetC,gBAAgBa,OAAhB,EAAyBC,OAAzB,CAArB;AACA,SAAOrB,QAAQ6C,YAAR,CAAP;AACD;;AAGD;;;;;;;;AAQO,SAAStC,eAAT,CAAyBa,OAAzB,EAAkCC,OAAlC,EAA2CF,UAA3C,EAAuD;AAC5D,MAAM0B,eAAe1B,aAAaA,UAAb,GAA0B/B,aAA/C;AACA,MAAItZ,WAAWsb,OAAX,EAAoBC,OAApB,CAAJ,EAAkC;AAChC,QAAID,QAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAjB,EAA6B;AAC3BwB,mBAAa,CAAb,IAAkBzB,QAAQ,CAAR,CAAlB;AACD,KAFD,MAEO;AACLyB,mBAAa,CAAb,IAAkBxB,QAAQ,CAAR,CAAlB;AACD;AACD,QAAID,QAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAjB,EAA6B;AAC3BwB,mBAAa,CAAb,IAAkBzB,QAAQ,CAAR,CAAlB;AACD,KAFD,MAEO;AACLyB,mBAAa,CAAb,IAAkBxB,QAAQ,CAAR,CAAlB;AACD;AACD,QAAID,QAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAjB,EAA6B;AAC3BwB,mBAAa,CAAb,IAAkBzB,QAAQ,CAAR,CAAlB;AACD,KAFD,MAEO;AACLyB,mBAAa,CAAb,IAAkBxB,QAAQ,CAAR,CAAlB;AACD;AACD,QAAID,QAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAjB,EAA6B;AAC3BwB,mBAAa,CAAb,IAAkBzB,QAAQ,CAAR,CAAlB;AACD,KAFD,MAEO;AACLyB,mBAAa,CAAb,IAAkBxB,QAAQ,CAAR,CAAlB;AACD;AACF,GArBD,MAqBO;AACLhC,wBAAoBwD,YAApB;AACD;AACD,SAAOA,YAAP;AACD;;AAGD;;;;AAIO,SAASrC,SAAT,CAAmBjyB,MAAnB,EAA2B;AAChC,SAAOsX,SAAStX,MAAT,IAAmBqX,UAAUrX,MAAV,CAA1B;AACD;;AAGD;;;;;;AAMO,SAASyQ,OAAT,CAAiBzQ,MAAjB,EAAyB;AAC9B,SAAO,CAACA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,EAAwBA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAApC,CAAP;AACD;;AAGD;;;;;;AAMO,SAASkyB,UAAT,CAAoBlyB,MAApB,EAA4B;AACjC,SAAO,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAP;AACD;;AAGD;;;;;;AAMO,SAASmyB,WAAT,CAAqBnyB,MAArB,EAA6B;AAClC,SAAO,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAP;AACD;;AAGD;;;;;;AAMO,SAASsX,QAAT,CAAkBtX,MAAlB,EAA0B;AAC/B,SAAOA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAnB;AACD;;AAGD;;;;;;;AAOO,SAASuX,UAAT,CAAoBsb,OAApB,EAA6BC,OAA7B,EAAsC;AAC3C,SAAOD,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CAAd,IACHD,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CADX,IAEHD,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CAFX,IAGHD,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CAHlB;AAID;;AAGD;;;;;;AAMO,SAAS/gB,OAAT,CAAiB/R,MAAjB,EAAyB;AAC9B,SAAOA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAZ,IAAyBA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAA5C;AACD;;AAGD;;;;;AAKO,SAASoyB,cAAT,CAAwBpyB,MAAxB,EAAgC4yB,UAAhC,EAA4C;AACjD,MAAIA,UAAJ,EAAgB;AACdA,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,CAAhB;AACA4yB,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,CAAhB;AACA4yB,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,CAAhB;AACA4yB,eAAW,CAAX,IAAgB5yB,OAAO,CAAP,CAAhB;AACA,WAAO4yB,UAAP;AACD,GAND,MAMO;AACL,WAAO5yB,MAAP;AACD;AACF;;AAGD;;;;AAIO,SAASqyB,eAAT,CAAyBryB,MAAzB,EAAiC7lB,KAAjC,EAAwC;AAC7C,MAAMi3B,SAAU,CAACpR,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,IAA0B,CAA3B,IAAiC7lB,QAAQ,CAAzC,CAAf;AACA,MAAMm3B,SAAU,CAACtR,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,IAA0B,CAA3B,IAAiC7lB,QAAQ,CAAzC,CAAf;AACA6lB,SAAO,CAAP,KAAaoR,MAAb;AACApR,SAAO,CAAP,KAAaoR,MAAb;AACApR,SAAO,CAAP,KAAasR,MAAb;AACAtR,SAAO,CAAP,KAAasR,MAAb;AACD;;AAGD;;;;;;;;AAQO,SAASghB,iBAAT,CAA2BtyB,MAA3B,EAAmCqa,KAAnC,EAA0C9X,GAA1C,EAA+C;AACpD,MAAIgV,aAAa,KAAjB;AACA,MAAMgd,WAAW3D,uBAAuB5wB,MAAvB,EAA+Bqa,KAA/B,CAAjB;AACA,MAAMma,SAAS5D,uBAAuB5wB,MAAvB,EAA+BuC,GAA/B,CAAf;AACA,MAAIgyB,aAAavB,uBAAaI,YAA1B,IACAoB,WAAWxB,uBAAaI,YAD5B,EAC0C;AACxC7b,iBAAa,IAAb;AACD,GAHD,MAGO;AACL,QAAMZ,OAAO3W,OAAO,CAAP,CAAb;AACA,QAAM6W,OAAO7W,OAAO,CAAP,CAAb;AACA,QAAM4W,OAAO5W,OAAO,CAAP,CAAb;AACA,QAAM8W,OAAO9W,OAAO,CAAP,CAAb;AACA,QAAMy0B,SAASpa,MAAM,CAAN,CAAf;AACA,QAAMqa,SAASra,MAAM,CAAN,CAAf;AACA,QAAMsa,OAAOpyB,IAAI,CAAJ,CAAb;AACA,QAAMqyB,OAAOryB,IAAI,CAAJ,CAAb;AACA,QAAMsyB,QAAQ,CAACD,OAAOF,MAAR,KAAmBC,OAAOF,MAA1B,CAAd;AACA,QAAIzzC,UAAJ;AAAA,QAAO+N,UAAP;AACA,QAAI,CAAC,EAAEylC,SAASxB,uBAAaG,KAAxB,CAAD,IACA,EAAEoB,WAAWvB,uBAAaG,KAA1B,CADJ,EACsC;AACpC;AACAnyC,UAAI2zC,OAAQ,CAACC,OAAO9d,IAAR,IAAgB+d,KAA5B;AACAtd,mBAAav2B,KAAK21B,IAAL,IAAa31B,KAAK41B,IAA/B;AACD;AACD,QAAI,CAACW,UAAD,IAAe,CAAC,EAAEid,SAASxB,uBAAapE,KAAxB,CAAhB,IACA,EAAE2F,WAAWvB,uBAAapE,KAA1B,CADJ,EACsC;AACpC;AACA7/B,UAAI6lC,OAAQ,CAACD,OAAO/d,IAAR,IAAgBie,KAA5B;AACAtd,mBAAaxoB,KAAK8nB,IAAL,IAAa9nB,KAAK+nB,IAA/B;AACD;AACD,QAAI,CAACS,UAAD,IAAe,CAAC,EAAEid,SAASxB,uBAAaE,KAAxB,CAAhB,IACA,EAAEqB,WAAWvB,uBAAaE,KAA1B,CADJ,EACsC;AACpC;AACAlyC,UAAI2zC,OAAQ,CAACC,OAAO/d,IAAR,IAAgBge,KAA5B;AACAtd,mBAAav2B,KAAK21B,IAAL,IAAa31B,KAAK41B,IAA/B;AACD;AACD,QAAI,CAACW,UAAD,IAAe,CAAC,EAAEid,SAASxB,uBAAatE,IAAxB,CAAhB,IACA,EAAE6F,WAAWvB,uBAAatE,IAA1B,CADJ,EACqC;AACnC;AACA3/B,UAAI6lC,OAAQ,CAACD,OAAOhe,IAAR,IAAgBke,KAA5B;AACAtd,mBAAaxoB,KAAK8nB,IAAL,IAAa9nB,KAAK+nB,IAA/B;AACD;AAEF;AACD,SAAOS,UAAP;AACD;;AAGD;;;;;;;;;AASO,SAASgb,cAAT,CAAwBvyB,MAAxB,EAAgC80B,WAAhC,EAA6ClC,UAA7C,EAAyD;AAC9D,MAAMJ,cAAc,CAClBxyB,OAAO,CAAP,CADkB,EACPA,OAAO,CAAP,CADO,EAElBA,OAAO,CAAP,CAFkB,EAEPA,OAAO,CAAP,CAFO,EAGlBA,OAAO,CAAP,CAHkB,EAGPA,OAAO,CAAP,CAHO,EAIlBA,OAAO,CAAP,CAJkB,EAIPA,OAAO,CAAP,CAJO,CAApB;AAMA80B,cAAYtC,WAAZ,EAAyBA,WAAzB,EAAsC,CAAtC;AACA,MAAME,KAAK,CAACF,YAAY,CAAZ,CAAD,EAAiBA,YAAY,CAAZ,CAAjB,EAAiCA,YAAY,CAAZ,CAAjC,EAAiDA,YAAY,CAAZ,CAAjD,CAAX;AACA,MAAMG,KAAK,CAACH,YAAY,CAAZ,CAAD,EAAiBA,YAAY,CAAZ,CAAjB,EAAiCA,YAAY,CAAZ,CAAjC,EAAiDA,YAAY,CAAZ,CAAjD,CAAX;AACA,SAAOC,mBAAmBC,EAAnB,EAAuBC,EAAvB,EAA2BC,UAA3B,CAAP;AACD,C;;;;;;;;;;;;;;;;;AC7xBD;;;;AAIA;;;;kBAIe;AACbc,eAAa,aADA;AAEbC,gBAAc,cAFD;AAGbC,YAAU,UAHG;AAIbC,aAAW;AAJE,C;;;;;;;;;;;;;;;;;ACRf;;;;AAIA;;;;kBAIe;AACbZ,WAAS,CADI;AAEbG,gBAAc,CAFD;AAGbD,SAAO,CAHM;AAIbvE,SAAO,CAJM;AAKbsE,SAAO,CALM;AAMbxE,QAAM;AANO,C;;;;;;;;;;;;;;;;;QCyCCqG,e,GAAAA,e;QAoEAC,G,GAAAA,G;;AAlHhB;;AACA;;;;;;AAGA;;;;;;;;;;;;;;;;;AAkBA;;;;;;;;;;;;AAaA;;;;;;;;;;;AAtCA;;;AAiDO,SAASD,eAAT,CAAyB5/C,GAAzB,EAA8BF,MAA9B,EAAsCgb,OAAtC,EAA+CglC,OAA/C,EAAwD;AAC7D;AACE;;;;;;AAMA,cAASj1B,MAAT,EAAiBC,UAAjB,EAA6BiY,UAA7B,EAAyC;AACvC,UAAM8c,MAAM,IAAIE,cAAJ,EAAZ;AACAF,UAAIG,IAAJ,CAAS,KAAT,EACE,OAAOhgD,GAAP,KAAe,UAAf,GAA4BA,IAAI6qB,MAAJ,EAAYC,UAAZ,EAAwBiY,UAAxB,CAA5B,GAAkE/iC,GADpE,EAEE,IAFF;AAGA,UAAIF,OAAO+a,OAAP,MAAoBolC,qBAAWC,YAAnC,EAAiD;AAC/CL,YAAIM,YAAJ,GAAmB,aAAnB;AACD;AACD;;;;AAIAN,UAAIO,MAAJ,GAAa,UAAS5uB,KAAT,EAAgB;AAC3B;AACA,YAAI,CAACquB,IAAIQ,MAAL,IAAeR,IAAIQ,MAAJ,IAAc,GAAd,IAAqBR,IAAIQ,MAAJ,GAAa,GAArD,EAA0D;AACxD,cAAMt+C,OAAOjC,OAAO+a,OAAP,EAAb;AACA;AACA,cAAIjb,eAAJ;AACA,cAAImC,QAAQk+C,qBAAW74C,IAAnB,IAA2BrF,QAAQk+C,qBAAWK,IAAlD,EAAwD;AACtD1gD,qBAASigD,IAAIU,YAAb;AACD,WAFD,MAEO,IAAIx+C,QAAQk+C,qBAAWO,GAAvB,EAA4B;AACjC5gD,qBAASigD,IAAIY,WAAb;AACA,gBAAI,CAAC7gD,MAAL,EAAa;AACXA,uBAAS,IAAI8gD,SAAJ,GAAgBC,eAAhB,CAAgCd,IAAIU,YAApC,EAAkD,iBAAlD,CAAT;AACD;AACF,WALM,MAKA,IAAIx+C,QAAQk+C,qBAAWC,YAAvB,EAAqC;AAC1CtgD,qBAAS,0BAA4BigD,IAAIe,QAAzC;AACD;AACD,cAAIhhD,MAAJ,EAAY;AACVkb,oBAAQkC,IAAR,CAAa,IAAb,EAAmBld,OAAO+gD,YAAP,CAAoBjhD,MAApB,EACjB,EAACkhD,mBAAmB/d,UAApB,EADiB,CAAnB,EAEAjjC,OAAOihD,cAAP,CAAsBnhD,MAAtB,CAFA,EAE+BE,OAAOkhD,aAAP,EAF/B;AAGD,WAJD,MAIO;AACLlB,oBAAQ9iC,IAAR,CAAa,IAAb;AACD;AACF,SArBD,MAqBO;AACL8iC,kBAAQ9iC,IAAR,CAAa,IAAb;AACD;AACF,OA1BY,CA0BXjF,IA1BW,CA0BN,IA1BM,CAAb;AA2BA;;;AAGA8nC,UAAIoB,OAAJ,GAAc,YAAW;AACvBnB,gBAAQ9iC,IAAR,CAAa,IAAb;AACD,OAFa,CAEZjF,IAFY,CAEP,IAFO,CAAd;AAGA8nC,UAAIqB,IAAJ;AACD;AArDH;AAuDD;;AAGD;;;;;;;;;AASO,SAASrB,GAAT,CAAa7/C,GAAb,EAAkBF,MAAlB,EAA0B;AAC/B,SAAO8/C,gBAAgB5/C,GAAhB,EAAqBF,MAArB;AACL;;;;;;AAMA,YAASg6B,QAAT,EAAmBqnB,cAAnB,EAAmC;AACjC,SAAKC,WAAL,CAAiBtnB,QAAjB;AACD,GATI,EASF,wBAAyBhR,oBATvB,CAAP;AAUD,C;;;;;;;;;;;;;;;;;QCwFeu4B,oB,GAAAA,oB;;AArNhB;;;;AACA;;AACA;;;;AAGA;;;;;;;;;;;;;;AAeA;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;;;;;;;;;;;;;AAaA,IAAMC,gBAAgB,SAAhBA,aAAgB,GAAW;;AAE/B;;;;AAIA,OAAKC,qBAAL,GAA6B,IAA7B;;AAEA;;;;AAIA,OAAKC,wBAAL,GAAgC,IAAhC;AAED,CAdD;;AAiBA;;;;;;;AA/EA;;;AAsFAF,cAAc3lC,SAAd,CAAwB8lC,cAAxB,GAAyC,UAAS7hD,MAAT,EAAiBqnB,WAAjB,EAA8B;AACrE,MAAIze,gBAAJ;AACA,MAAIye,WAAJ,EAAiB;AACfze,cAAU;AACR24C,sBAAgBl6B,YAAYk6B,cAAZ,GACdl6B,YAAYk6B,cADE,GACe,KAAKJ,cAAL,CAAoBnhD,MAApB,CAFvB;AAGRkhD,yBAAmB75B,YAAY65B;AAHvB,KAAV;AAKD;AACD,SAAO,KAAKY,YAAL,CAAkBl5C,OAAlB,CAAP;AACD,CAVD;;AAaA;;;;;;;;;AASA84C,cAAc3lC,SAAd,CAAwB+lC,YAAxB,GAAuC,UAASl5C,OAAT,EAAkB;AACvD,SAAO,iBAAO;AACZ24C,oBAAgB,KAAKI,qBADT;AAEZT,uBAAmB,KAAKU;AAFZ,GAAP,EAGJh5C,OAHI,CAAP;AAID,CALD;;AAQA;;;;AAIA84C,cAAc3lC,SAAd,CAAwBqlC,aAAxB,GAAwC,YAAW;AACjD,SAAO,IAAP;AACD,CAFD;;AAKA;;;;AAIAM,cAAc3lC,SAAd,CAAwBd,OAAxB,GAAkC,YAAW,CAAE,CAA/C;;AAGA;;;;;;;;AAQAymC,cAAc3lC,SAAd,CAAwBgmC,WAAxB,GAAsC,UAAS/hD,MAAT,EAAiBqnB,WAAjB,EAA8B,CAAE,CAAtE;;AAGA;;;;;;;;AAQAq6B,cAAc3lC,SAAd,CAAwBklC,YAAxB,GAAuC,UAASjhD,MAAT,EAAiBqnB,WAAjB,EAA8B,CAAE,CAAvE;;AAGA;;;;;;;;AAQAq6B,cAAc3lC,SAAd,CAAwBimC,YAAxB,GAAuC,UAAShiD,MAAT,EAAiBqnB,WAAjB,EAA8B,CAAE,CAAvE;;AAGA;;;;;;;AAOAq6B,cAAc3lC,SAAd,CAAwBolC,cAAxB,GAAyC,UAASnhD,MAAT,EAAiB,CAAE,CAA5D;;AAGA;;;;;;;;AAQA0hD,cAAc3lC,SAAd,CAAwBkmC,YAAxB,GAAuC,UAAS3xC,OAAT,EAAkB+W,WAAlB,EAA+B,CAAE,CAAxE;;AAGA;;;;;;;;AAQAq6B,cAAc3lC,SAAd,CAAwBmmC,aAAxB,GAAwC,UAAShoB,QAAT,EAAmB7S,WAAnB,EAAgC,CAAE,CAA1E;;AAGA;;;;;;;;AAQAq6B,cAAc3lC,SAAd,CAAwBomC,aAAxB,GAAwC,UAASt4B,QAAT,EAAmBxC,WAAnB,EAAgC,CAAE,CAA1E;;kBAEeq6B,a;;AAEf;;;;;;;;AAOO,SAASD,oBAAT,CAA8B53B,QAA9B,EAAwCu4B,KAAxC,EAA+C/6B,WAA/C,EAA4D;AACjE,MAAM65B,oBAAoB75B,cACxB,eAAcA,YAAY65B,iBAA1B,CADwB,GACuB,IADjD;AAEA,MAAMK,iBAAiBl6B,cACrB,eAAcA,YAAYk6B,cAA1B,CADqB,GACuB,IAD9C;AAEA;;;AAGA,MAAIc,oBAAJ;AACA,MAAInB,qBAAqBK,cAArB,IACA,CAAC,sBAAqBL,iBAArB,EAAwCK,cAAxC,CADL,EAC8D;AAC5D,QAAI13B,oBAAoBD,kBAAxB,EAAkC;AAChCy4B,oBAAc,CAACD,QAAQv4B,SAASG,KAAT,EAAR,GAA2BH,QAA5B,EAAsC6oB,SAAtC,CACZ0P,QAAQlB,iBAAR,GAA4BK,cADhB,EAEZa,QAAQb,cAAR,GAAyBL,iBAFb,CAAd;AAGD,KAJD,MAIO;AACL;AACA;AACAmB,oBAAc,2BACZx4B,QADY,EAEZ03B,cAFY,EAGZL,iBAHY,CAAd;AAID;AACF,GAdD,MAcO;AACLmB,kBAAcx4B,QAAd;AACD;AACD,MAAIu4B,SAAS/6B,WAAT,IAAwBA,YAAYi7B,QAAZ,KAAyB7/C,SAArD,EAAgE;AAC9D,QAAMwmC,QAAQrjC,KAAKoG,GAAL,CAAS,EAAT,EAAaqb,YAAYi7B,QAAzB,CAAd;AACA;AACA;;;;AAIA,QAAM5P,YAAY,SAAZA,SAAY,CAAS+K,WAAT,EAAsB;AACtC,WAAK,IAAI57C,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiD,EAAExkB,CAAnD,EAAsD;AACpD47C,oBAAY57C,CAAZ,IAAiB+D,KAAKoH,KAAL,CAAWywC,YAAY57C,CAAZ,IAAiBonC,KAA5B,IAAqCA,KAAtD;AACD;AACD,aAAOwU,WAAP;AACD,KALD;AAMA,QAAI4E,gBAAgBx4B,QAApB,EAA8B;AAC5Bw4B,oBAAcA,YAAYr4B,KAAZ,EAAd;AACD;AACDq4B,gBAAY7E,cAAZ,CAA2B9K,SAA3B;AACD;AACD,SAAO2P,WAAP;AACD,C;;;;;;;;;;;;;;;;;ACrQD;;;;AAIA;;;kBAGe;AACb/B,gBAAc,aADD;AAEb94C,QAAM,MAFO;AAGbk5C,QAAM,MAHO;AAIbE,OAAK;AAJQ,C;;;;;;;;;;;;;;;;;;ACDf;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAGA;;;;;;;;;;;;AAaA;;;;;;;;;AAnCA;;;AAGA;AACA;;AAwCA,IAAM2B,UAAU,SAAVA,OAAU,CAASl7B,WAAT,EAAsB;;AAEpC,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEAm7B,wBAAYplC,IAAZ,CAAiB,IAAjB;;AAEA;;;AAGA,OAAKukC,qBAAL,GAA6B,eAC3B/4C,QAAQ+4C,qBAAR,GACE/4C,QAAQ+4C,qBADV,GACkC,WAFP,CAA7B;;AAKA,MAAI/4C,QAAQs4C,iBAAZ,EAA+B;AAC7B,SAAKU,wBAAL,GAAgC,eAAch5C,QAAQs4C,iBAAtB,CAAhC;AACD;;AAED;;;;;AAKA,OAAK33B,aAAL,GAAqB3gB,QAAQ65C,YAA7B;;AAEA;;;;;AAKA,OAAKC,oBAAL,GAA4B95C,QAAQ+5C,mBAApC;AAED,CAhCD;;AAkCA,qBAASJ,OAAT,EAAkBC,qBAAlB;;AAGA;;;;AAIA,IAAMI,mBAAmB;AACvB,WAASC,iBADc;AAEvB,gBAAcC,sBAFS;AAGvB,aAAWC,mBAHY;AAIvB,gBAAcC,sBAJS;AAKvB,qBAAmBC,2BALI;AAMvB,kBAAgBC,wBANO;AAOvB,wBAAsBC;AAPC,CAAzB;;AAWA;;;;AAIA,IAAMC,mBAAmB;AACvB,WAASC,kBADc;AAEvB,gBAAcC,uBAFS;AAGvB,aAAWC,oBAHY;AAIvB,gBAAcC,uBAJS;AAKvB,qBAAmBC,4BALI;AAMvB,kBAAgBC,yBANO;AAOvB,wBAAsBC,+BAPC;AAQvB,YAAUC;AARa,CAAzB;;AAYA;;;;;AAKA,SAAS5B,YAAT,CAAsBl8C,MAAtB,EAA8BuhB,WAA9B,EAA2C;AACzC,MAAI,CAACvhB,MAAL,EAAa;AACX,WAAO,IAAP;AACD;AACD,MAAM+9C,iBAAiBjB,iBAAiB98C,OAAO3D,IAAxB,CAAvB;AACA;AACE,0CAAwC,oCAAqB0hD,eAAe/9C,MAAf,CAArB,EAA6C,KAA7C,EAAoDuhB,WAApD;AAD1C;AAGD;;AAGD;;;;;AAKA,SAAS87B,8BAAT,CAAwCr9C,MAAxC,EAAgDuhB,WAAhD,EAA6D;AAC3D,MAAMy8B,aAAah+C,OAAOg+C,UAAP,CAAkBzjD,GAAlB;AACjB;;;;AAIA,YAASwpB,QAAT,EAAmB;AACjB,WAAOm4B,aAAan4B,QAAb,EAAuBxC,WAAvB,CAAP;AACD,GAPgB,CAAnB;AAQA,SAAO,IAAI08B,4BAAJ,CAAuBD,UAAvB,CAAP;AACD;;AAGD;;;;AAIA,SAASjB,iBAAT,CAA2B/8C,MAA3B,EAAmC;AACjC,SAAO,IAAIk+C,eAAJ,CAAUl+C,OAAO23C,WAAjB,CAAP;AACD;;AAGD;;;;AAIA,SAASqF,sBAAT,CAAgCh9C,MAAhC,EAAwC;AACtC,SAAO,IAAIm+C,oBAAJ,CAAen+C,OAAO23C,WAAtB,CAAP;AACD;;AAGD;;;;AAIA,SAASwF,2BAAT,CAAqCn9C,MAArC,EAA6C;AAC3C,SAAO,IAAIo+C,yBAAJ,CAAoBp+C,OAAO23C,WAA3B,CAAP;AACD;;AAGD;;;;AAIA,SAASuF,sBAAT,CAAgCl9C,MAAhC,EAAwC;AACtC,SAAO,IAAIq+C,oBAAJ,CAAer+C,OAAO23C,WAAtB,CAAP;AACD;;AAGD;;;;AAIA,SAASyF,wBAAT,CAAkCp9C,MAAlC,EAA0C;AACxC,SAAO,IAAIs+C,sBAAJ,CAAiBt+C,OAAO23C,WAAxB,CAAP;AACD;;AAGD;;;;AAIA,SAASsF,mBAAT,CAA6Bj9C,MAA7B,EAAqC;AACnC,SAAO,IAAIu+C,iBAAJ,CAAYv+C,OAAO23C,WAAnB,CAAP;AACD;;AAGD;;;;;AAKA,SAAS0E,aAAT,CAAuBt4B,QAAvB,EAAiCxC,WAAjC,EAA8C;AAC5C,MAAMi9B,iBAAiBlB,iBAAiBv5B,SAAS5O,OAAT,EAAjB,CAAvB;AACA,SAAOqpC,gBAAe,sCACpB,oCAAqBz6B,QAArB,EAA+B,IAA/B,EAAqCxC,WAArC,CADK,EAC+CA,WAD/C,CAAP;AAED;;AAGD;;;;AAIA,SAASu8B,oCAAT,CAA8C/5B,QAA9C,EAAwD;AACtD,SAAO,yCAA0C;AAC/C1nB,YAAM,oBADyC;AAE/C2hD,kBAAY;AAFmC;AAAjD;AAID;;AAGD;;;;;AAKA,SAASH,+BAAT,CAAyC95B,QAAzC,EAAmDxC,WAAnD,EAAgE;AAC9D,MAAMy8B,aAAaj6B,SAAS06B,kBAAT,GAA8BlkD,GAA9B,CAAkC,UAASwpB,QAAT,EAAmB;AACtE,QAAMjhB,UAAU,iBAAO,EAAP,EAAWye,WAAX,CAAhB;AACA,WAAOze,QAAQs4C,iBAAf;AACA,WAAOiB,cAAct4B,QAAd,EAAwBjhB,OAAxB,CAAP;AACD,GAJkB,CAAnB;AAKA,SAAO,yCAA0C;AAC/CzG,YAAM,oBADyC;AAE/C2hD,kBAAYA;AAFmC;AAAjD;AAID;;AAGD;;;;;AAKA,SAASR,uBAAT,CAAiCz5B,QAAjC,EAA2CxC,WAA3C,EAAwD;AACtD,SAAO,+BAAgC;AACrCllB,YAAM,YAD+B;AAErCs7C,mBAAa5zB,SAAS26B,cAAT;AAFwB;AAAvC;AAID;;AAGD;;;;;AAKA,SAASf,4BAAT,CAAsC55B,QAAtC,EAAgDxC,WAAhD,EAA6D;AAC3D,SAAO,+BAAgC;AACrCllB,YAAM,iBAD+B;AAErCs7C,mBAAa5zB,SAAS26B,cAAT;AAFwB;AAAvC;AAID;;AAGD;;;;;AAKA,SAAShB,uBAAT,CAAiC35B,QAAjC,EAA2CxC,WAA3C,EAAwD;AACtD,SAAO,+BAAgC;AACrCllB,YAAM,YAD+B;AAErCs7C,mBAAa5zB,SAAS26B,cAAT;AAFwB;AAAvC;AAID;;AAGD;;;;;AAKA,SAASd,yBAAT,CAAmC75B,QAAnC,EAA6CxC,WAA7C,EAA0D;AACxD,MAAIo9B,cAAJ;AACA,MAAIp9B,WAAJ,EAAiB;AACfo9B,YAAQp9B,YAAYq9B,WAApB;AACD;AACD,SAAO,+BAAgC;AACrCviD,YAAM,cAD+B;AAErCs7C,mBAAa5zB,SAAS26B,cAAT,CAAwBC,KAAxB;AAFwB;AAAvC;AAID;;AAGD;;;;;AAKA,SAASpB,kBAAT,CAA4Bx5B,QAA5B,EAAsCxC,WAAtC,EAAmD;AACjD,SAAO,+BAAgC;AACrCllB,YAAM,OAD+B;AAErCs7C,mBAAa5zB,SAAS26B,cAAT;AAFwB;AAAvC;AAID;;AAGD;;;;;AAKA,SAASjB,oBAAT,CAA8B15B,QAA9B,EAAwCxC,WAAxC,EAAqD;AACnD,MAAIo9B,cAAJ;AACA,MAAIp9B,WAAJ,EAAiB;AACfo9B,YAAQp9B,YAAYq9B,WAApB;AACD;AACD,SAAO,+BAAgC;AACrCviD,YAAM,SAD+B;AAErCs7C,mBAAa5zB,SAAS26B,cAAT,CAAwBC,KAAxB;AAFwB;AAAvC;AAID;;AAGD;;;;;;;;;;;;AAYAlC,QAAQxmC,SAAR,CAAkBgmC,WAAlB;;AAGA;;;;;;;;;;;AAWAQ,QAAQxmC,SAAR,CAAkBklC,YAAlB;;AAGA;;;AAGAsB,QAAQxmC,SAAR,CAAkB4oC,qBAAlB,GAA0C,UAAS7+C,MAAT,EAAiBuhB,WAAjB,EAA8B;AACtE;;;AAGA,MAAIu9B,iBAAiB,IAArB;AACA,MAAI9+C,OAAO3D,IAAP,KAAgB,SAApB,EAA+B;AAC7ByiD,qBAAiB,6BAA+B9+C,MAAhD;AACD,GAFD,MAEO;AACL8+C,qBAAiB,6BAA+B;AAC9CziD,YAAM,SADwC;AAE9C0nB,gBAAU,wDAA0D/jB;AAFtB,KAAhD;AAID;;AAED,MAAM+jB,WAAWm4B,aAAa4C,eAAe/6B,QAA5B,EAAsCxC,WAAtC,CAAjB;AACA,MAAM/W,UAAU,IAAI8Y,iBAAJ,EAAhB;AACA,MAAI,KAAKG,aAAT,EAAwB;AACtBjZ,YAAQ4Z,eAAR,CAAwB,KAAKX,aAA7B;AACD,GAFD,MAEO,IAAI,KAAKm5B,oBAAL,IAA6BkC,eAAeC,aAAf,KAAiCpiD,SAAlE,EAA6E;AAClF6N,YAAQ4Z,eAAR,CAAwB06B,eAAeC,aAAvC;AACD;AACDv0C,UAAQwZ,WAAR,CAAoBD,QAApB;AACA,MAAI+6B,eAAe7iD,EAAf,KAAsBU,SAA1B,EAAqC;AACnC6N,YAAQua,KAAR,CAAc+5B,eAAe7iD,EAA7B;AACD;AACD,MAAI6iD,eAAer5C,UAAnB,EAA+B;AAC7B+E,YAAQyZ,aAAR,CAAsB66B,eAAer5C,UAArC;AACD;AACD,SAAO+E,OAAP;AACD,CA7BD;;AAgCA;;;AAGAiyC,QAAQxmC,SAAR,CAAkB+oC,sBAAlB,GAA2C,UAASh/C,MAAT,EAAiBuhB,WAAjB,EAA8B;AACvE,MAAM09B,gBAAgB,4BAA8Bj/C,MAApD;AACA;AACA,MAAIo0B,WAAW,IAAf;AACA,MAAI6qB,cAAc5iD,IAAd,KAAuB,mBAA3B,EAAgD;AAC9C,QAAM6iD,2BAA2B,uCAAyCl/C,MAA1E;AACAo0B,eAAW,EAAX;AACA,QAAM+qB,kBAAkBD,yBAAyB9qB,QAAjD;AACA,SAAK,IAAIr4B,IAAI,CAAR,EAAWwkB,KAAK4+B,gBAAgBnjD,MAArC,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxDq4B,eAASr2B,IAAT,CAAc,KAAK8gD,qBAAL,CAA2BM,gBAAgBpjD,CAAhB,CAA3B,EAA+CwlB,WAA/C,CAAd;AACD;AACF,GAPD,MAOO;AACL6S,eAAW,CAAC,KAAKyqB,qBAAL,CAA2B7+C,MAA3B,EAAmCuhB,WAAnC,CAAD,CAAX;AACD;AACD,SAAO6S,QAAP;AACD,CAfD;;AAkBA;;;;;;;;;AASAqoB,QAAQxmC,SAAR,CAAkBimC,YAAlB;;AAGA;;;AAGAO,QAAQxmC,SAAR,CAAkBmpC,sBAAlB,GAA2C,UAASp/C,MAAT,EAAiBuhB,WAAjB,EAA8B;AACvE,SAAO26B,cAAa,8BAAgCl8C,MAA7C,EAAsDuhB,WAAtD,CAAP;AACD,CAFD;;AAKA;;;;;;;;AAQAk7B,QAAQxmC,SAAR,CAAkBolC,cAAlB;;AAGA;;;AAGAoB,QAAQxmC,SAAR,CAAkBopC,wBAAlB,GAA6C,UAASr/C,MAAT,EAAiB;AAC5D,MAAMi/C,gBAAgB,4BAA8Bj/C,MAApD;AACA,MAAMs/C,MAAML,cAAcK,GAA1B;AACA,MAAIjiB,mBAAJ;AACA,MAAIiiB,GAAJ,EAAS;AACP,QAAIA,IAAIjjD,IAAJ,IAAY,MAAhB,EAAwB;AACtBghC,mBAAa,eAAciiB,IAAI75C,UAAJ,CAAerJ,IAA7B,CAAb;AACD,KAFD,MAEO;AACL,2BAAO,KAAP,EAAc,EAAd,EADK,CACc;AACpB;AACF,GAND,MAMO;AACLihC,iBAAa,KAAKwe,qBAAlB;AACD;AACD;AACE,4CAA0Cxe;AAD5C;AAGD,CAhBD;;AAmBA;;;;;;;;;;AAUAof,QAAQxmC,SAAR,CAAkBkmC,YAAlB;;AAGA;;;;;;;;;AASAM,QAAQxmC,SAAR,CAAkBspC,kBAAlB,GAAuC,UAAS/0C,OAAT,EAAkB+W,WAAlB,EAA+B;AACpEA,gBAAc,KAAKy6B,YAAL,CAAkBz6B,WAAlB,CAAd;;AAEA,MAAMvhB,SAAS,6BAA+B;AAC5C,YAAQ;AADoC,GAA9C;AAGA,MAAM/D,KAAKuO,QAAQia,KAAR,EAAX;AACA,MAAIxoB,OAAOU,SAAX,EAAsB;AACpBqD,WAAO/D,EAAP,GAAYA,EAAZ;AACD;AACD,MAAM8nB,WAAWvZ,QAAQ8Z,WAAR,EAAjB;AACA,MAAIP,QAAJ,EAAc;AACZ/jB,WAAO+jB,QAAP,GAAkBs4B,cAAct4B,QAAd,EAAwBxC,WAAxB,CAAlB;AACD,GAFD,MAEO;AACLvhB,WAAO+jB,QAAP,GAAkB,IAAlB;AACD;AACD,MAAMte,aAAa+E,QAAQ2Z,aAAR,EAAnB;AACA,SAAO1e,WAAW+E,QAAQ6Z,eAAR,EAAX,CAAP;AACA,MAAI,CAAC,kBAAQ5e,UAAR,CAAL,EAA0B;AACxBzF,WAAOyF,UAAP,GAAoBA,UAApB;AACD,GAFD,MAEO;AACLzF,WAAOyF,UAAP,GAAoB,IAApB;AACD;AACD,SAAOzF,MAAP;AACD,CAxBD;;AA2BA;;;;;;;;;AASAy8C,QAAQxmC,SAAR,CAAkBmmC,aAAlB;;AAGA;;;;;;;;;AASAK,QAAQxmC,SAAR,CAAkBupC,mBAAlB,GAAwC,UAASprB,QAAT,EAAmB7S,WAAnB,EAAgC;AACtEA,gBAAc,KAAKy6B,YAAL,CAAkBz6B,WAAlB,CAAd;AACA,MAAMk+B,UAAU,EAAhB;AACA,OAAK,IAAI1jD,IAAI,CAAR,EAAWwkB,KAAK6T,SAASp4B,MAA9B,EAAsCD,IAAIwkB,EAA1C,EAA8C,EAAExkB,CAAhD,EAAmD;AACjD0jD,YAAQ1hD,IAAR,CAAa,KAAKwhD,kBAAL,CAAwBnrB,SAASr4B,CAAT,CAAxB,EAAqCwlB,WAArC,CAAb;AACD;AACD,SAAO,wCAAyC;AAC9CllB,YAAM,mBADwC;AAE9C+3B,gBAAUqrB;AAFoC;AAAhD;AAID,CAVD;;AAaA;;;;;;;;;AASAhD,QAAQxmC,SAAR,CAAkBomC,aAAlB;;AAGA;;;;;;;;;AASAI,QAAQxmC,SAAR,CAAkBypC,mBAAlB,GAAwC,UAAS37B,QAAT,EAAmBxC,WAAnB,EAAgC;AACtE,SAAO86B,cAAct4B,QAAd,EAAwB,KAAKi4B,YAAL,CAAkBz6B,WAAlB,CAAxB,CAAP;AACD,CAFD;kBAGek7B,O;;;;;;;;;;;;;;;;;;AC1jBf;;AACA;;;;AACA;;;;;;AAEA;;;;;;;;;;AAUA,IAAMC,cAAc,SAAdA,WAAc,GAAW;AAC7Bd,oBAActkC,IAAd,CAAmB,IAAnB;AACD,CAFD,C,CAjBA;;;;;AAqBA,qBAASolC,WAAT,EAAsBd,iBAAtB;;AAGA;;;;AAIA,SAAS+D,SAAT,CAAmBzlD,MAAnB,EAA2B;AACzB,MAAI,OAAOA,MAAP,KAAkB,QAAtB,EAAgC;AAC9B,QAAM8F,SAAS0B,KAAK5D,KAAL,CAAW5D,MAAX,CAAf;AACA,WAAO8F,SAAS,qBAAuBA,MAAhC,GAA0C,IAAjD;AACD,GAHD,MAGO,IAAI9F,WAAW,IAAf,EAAqB;AAC1B,WAAOA,MAAP;AACD,GAFM,MAEA;AACL,WAAO,IAAP;AACD;AACF;;AAGD;;;AAGAwiD,YAAYzmC,SAAZ,CAAsBd,OAAtB,GAAgC,YAAW;AACzC,SAAOolC,qBAAW74C,IAAlB;AACD,CAFD;;AAKA;;;AAGAg7C,YAAYzmC,SAAZ,CAAsBgmC,WAAtB,GAAoC,UAAS/hD,MAAT,EAAiBqnB,WAAjB,EAA8B;AAChE,SAAO,KAAKs9B,qBAAL,CACLc,UAAUzlD,MAAV,CADK,EACc,KAAK6hD,cAAL,CAAoB7hD,MAApB,EAA4BqnB,WAA5B,CADd,CAAP;AAED,CAHD;;AAMA;;;AAGAm7B,YAAYzmC,SAAZ,CAAsBklC,YAAtB,GAAqC,UAASjhD,MAAT,EAAiBqnB,WAAjB,EAA8B;AACjE,SAAO,KAAKy9B,sBAAL,CACLW,UAAUzlD,MAAV,CADK,EACc,KAAK6hD,cAAL,CAAoB7hD,MAApB,EAA4BqnB,WAA5B,CADd,CAAP;AAED,CAHD;;AAMA;;;;;;;AAOAm7B,YAAYzmC,SAAZ,CAAsB4oC,qBAAtB,GAA8C,UAAS7+C,MAAT,EAAiBuhB,WAAjB,EAA8B,CAAE,CAA9E;;AAGA;;;;;;;AAOAm7B,YAAYzmC,SAAZ,CAAsB+oC,sBAAtB,GAA+C,UAASh/C,MAAT,EAAiBuhB,WAAjB,EAA8B,CAAE,CAA/E;;AAGA;;;AAGAm7B,YAAYzmC,SAAZ,CAAsBimC,YAAtB,GAAqC,UAAShiD,MAAT,EAAiBqnB,WAAjB,EAA8B;AACjE,SAAO,KAAK69B,sBAAL,CACLO,UAAUzlD,MAAV,CADK,EACc,KAAK6hD,cAAL,CAAoB7hD,MAApB,EAA4BqnB,WAA5B,CADd,CAAP;AAED,CAHD;;AAMA;;;;;;;AAOAm7B,YAAYzmC,SAAZ,CAAsBmpC,sBAAtB,GAA+C,UAASp/C,MAAT,EAAiBuhB,WAAjB,EAA8B,CAAE,CAA/E;;AAGA;;;AAGAm7B,YAAYzmC,SAAZ,CAAsBolC,cAAtB,GAAuC,UAASnhD,MAAT,EAAiB;AACtD,SAAO,KAAKmlD,wBAAL,CAA8BM,UAAUzlD,MAAV,CAA9B,CAAP;AACD,CAFD;;AAKA;;;;;;AAMAwiD,YAAYzmC,SAAZ,CAAsBopC,wBAAtB,GAAiD,UAASr/C,MAAT,EAAiB,CAAE,CAApE;;AAGA;;;AAGA08C,YAAYzmC,SAAZ,CAAsBkmC,YAAtB,GAAqC,UAAS3xC,OAAT,EAAkB+W,WAAlB,EAA+B;AAClE,SAAO7f,KAAKC,SAAL,CAAe,KAAK49C,kBAAL,CAAwB/0C,OAAxB,EAAiC+W,WAAjC,CAAf,CAAP;AACD,CAFD;;AAKA;;;;;;AAMAm7B,YAAYzmC,SAAZ,CAAsBspC,kBAAtB,GAA2C,UAAS/0C,OAAT,EAAkB+W,WAAlB,EAA+B,CAAE,CAA5E;;AAGA;;;AAGAm7B,YAAYzmC,SAAZ,CAAsBmmC,aAAtB,GAAsC,UAAShoB,QAAT,EAAmB7S,WAAnB,EAAgC;AACpE,SAAO7f,KAAKC,SAAL,CAAe,KAAK69C,mBAAL,CAAyBprB,QAAzB,EAAmC7S,WAAnC,CAAf,CAAP;AACD,CAFD;;AAKA;;;;;;AAMAm7B,YAAYzmC,SAAZ,CAAsBupC,mBAAtB,GAA4C,UAASprB,QAAT,EAAmB7S,WAAnB,EAAgC,CAAE,CAA9E;;AAGA;;;AAGAm7B,YAAYzmC,SAAZ,CAAsBomC,aAAtB,GAAsC,UAASt4B,QAAT,EAAmBxC,WAAnB,EAAgC;AACpE,SAAO7f,KAAKC,SAAL,CAAe,KAAK+9C,mBAAL,CAAyB37B,QAAzB,EAAmCxC,WAAnC,CAAf,CAAP;AACD,CAFD;;AAKA;;;;;;AAMAm7B,YAAYzmC,SAAZ,CAAsBypC,mBAAtB,GAA4C,UAAS37B,QAAT,EAAmBxC,WAAnB,EAAgC,CAAE,CAA9E;kBACem7B,W;;;;;;;;;;;;;;;;;QCnKCzoB,I,GAAAA,I;QAQA6gB,K,GAAAA,K;QASA1xB,S,GAAAA,S;AAzBhB;;;;AAIA;;;;AAIO,SAAS6Q,IAAT,GAAgB;AACrB,SAAO,IAAP;AACD;;AAED;;;;AAIO,SAAS6gB,KAAT,GAAiB;AACtB,SAAO,KAAP;AACD;;AAED;;;;;AAKO,SAAS1xB,SAAT,GAAqB,CAAE,C;;;;;;;;;;;;;;;;;;ACtB9B;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;;;;;;AAVA;;;AAqBA,IAAMw8B,SAAS,SAATA,MAAS,CAAShlD,MAAT,EAAiBilD,UAAjB,EAA6BC,UAA7B,EAAyC;AACtDpc,2BAAepsB,IAAf,CAAoB,IAApB;AACA,MAAMyoC,SAASF,aAAaA,UAAb,GAA0B,CAAzC;AACA,OAAKG,kBAAL,CAAwBplD,MAAxB,EAAgCmlD,MAAhC,EAAwCD,UAAxC;AACD,CAJD;;AAMA,qBAASF,MAAT,EAAiBlc,wBAAjB;;AAGA;;;;;;AAMAkc,OAAO3pC,SAAP,CAAiBiO,KAAjB,GAAyB,YAAW;AAClC,MAAMyqB,SAAS,IAAIiR,MAAJ,CAAW,IAAX,CAAf;AACAjR,SAAOsR,kBAAP,CAA0B,KAAKC,MAA/B,EAAuC,KAAK1H,eAAL,CAAqB58C,KAArB,EAAvC;AACA,SAAO+yC,MAAP;AACD,CAJD;;AAOA;;;AAGAiR,OAAO3pC,SAAP,CAAiBkqC,cAAjB,GAAkC,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD;AACjF,MAAM7H,kBAAkB,KAAKA,eAA7B;AACA,MAAM3wB,KAAK1hB,IAAIqyC,gBAAgB,CAAhB,CAAf;AACA,MAAM1wB,KAAK5T,IAAIskC,gBAAgB,CAAhB,CAAf;AACA,MAAMlK,kBAAkBzmB,KAAKA,EAAL,GAAUC,KAAKA,EAAvC;AACA,MAAIwmB,kBAAkB+R,kBAAtB,EAA0C;AACxC,QAAI/R,oBAAoB,CAAxB,EAA2B;AACzB,WAAK,IAAIvyC,IAAI,CAAb,EAAgBA,IAAI,KAAKwoC,MAAzB,EAAiC,EAAExoC,CAAnC,EAAsC;AACpCqkD,qBAAarkD,CAAb,IAAkBy8C,gBAAgBz8C,CAAhB,CAAlB;AACD;AACF,KAJD,MAIO;AACL,UAAMqkC,QAAQ,KAAKwO,SAAL,KAAmB9uC,KAAKsG,IAAL,CAAUkoC,eAAV,CAAjC;AACA8R,mBAAa,CAAb,IAAkB5H,gBAAgB,CAAhB,IAAqBpY,QAAQvY,EAA/C;AACAu4B,mBAAa,CAAb,IAAkB5H,gBAAgB,CAAhB,IAAqBpY,QAAQtY,EAA/C;AACA,WAAK,IAAI/rB,KAAI,CAAb,EAAgBA,KAAI,KAAKwoC,MAAzB,EAAiC,EAAExoC,EAAnC,EAAsC;AACpCqkD,qBAAarkD,EAAb,IAAkBy8C,gBAAgBz8C,EAAhB,CAAlB;AACD;AACF;AACDqkD,iBAAapkD,MAAb,GAAsB,KAAKuoC,MAA3B;AACA,WAAO+J,eAAP;AACD,GAfD,MAeO;AACL,WAAO+R,kBAAP;AACD;AACF,CAvBD;;AA0BA;;;AAGAT,OAAO3pC,SAAP,CAAiBomB,UAAjB,GAA8B,UAASl2B,CAAT,EAAY+N,CAAZ,EAAe;AAC3C,MAAMskC,kBAAkB,KAAKA,eAA7B;AACA,MAAM3wB,KAAK1hB,IAAIqyC,gBAAgB,CAAhB,CAAf;AACA,MAAM1wB,KAAK5T,IAAIskC,gBAAgB,CAAhB,CAAf;AACA,SAAO3wB,KAAKA,EAAL,GAAUC,KAAKA,EAAf,IAAqB,KAAKw4B,iBAAL,EAA5B;AACD,CALD;;AAQA;;;;;AAKAV,OAAO3pC,SAAP,CAAiB+oB,SAAjB,GAA6B,YAAW;AACtC,SAAO,KAAKwZ,eAAL,CAAqB58C,KAArB,CAA2B,CAA3B,EAA8B,KAAK2oC,MAAnC,CAAP;AACD,CAFD;;AAKA;;;AAGAqb,OAAO3pC,SAAP,CAAiBsqC,aAAjB,GAAiC,UAASp7B,MAAT,EAAiB;AAChD,MAAMqzB,kBAAkB,KAAKA,eAA7B;AACA,MAAMuH,SAASvH,gBAAgB,KAAKjU,MAArB,IAA+BiU,gBAAgB,CAAhB,CAA9C;AACA,SAAO,4BACLA,gBAAgB,CAAhB,IAAqBuH,MADhB,EACwBvH,gBAAgB,CAAhB,IAAqBuH,MAD7C,EAELvH,gBAAgB,CAAhB,IAAqBuH,MAFhB,EAEwBvH,gBAAgB,CAAhB,IAAqBuH,MAF7C,EAGL56B,MAHK,CAAP;AAID,CAPD;;AAUA;;;;;AAKAy6B,OAAO3pC,SAAP,CAAiB24B,SAAjB,GAA6B,YAAW;AACtC,SAAO9uC,KAAKsG,IAAL,CAAU,KAAKk6C,iBAAL,EAAV,CAAP;AACD,CAFD;;AAKA;;;;AAIAV,OAAO3pC,SAAP,CAAiBqqC,iBAAjB,GAAqC,YAAW;AAC9C,MAAMz4B,KAAK,KAAK2wB,eAAL,CAAqB,KAAKjU,MAA1B,IAAoC,KAAKiU,eAAL,CAAqB,CAArB,CAA/C;AACA,MAAM1wB,KAAK,KAAK0wB,eAAL,CAAqB,KAAKjU,MAAL,GAAc,CAAnC,IAAwC,KAAKiU,eAAL,CAAqB,CAArB,CAAnD;AACA,SAAO3wB,KAAKA,EAAL,GAAUC,KAAKA,EAAtB;AACD,CAJD;;AAOA;;;;AAIA83B,OAAO3pC,SAAP,CAAiBd,OAAjB,GAA2B,YAAW;AACpC,SAAOwuB,uBAAaC,MAApB;AACD,CAFD;;AAKA;;;;AAIAgc,OAAO3pC,SAAP,CAAiBuqC,gBAAjB,GAAoC,UAASr7B,MAAT,EAAiB;AACnD,MAAMs7B,eAAe,KAAKh7B,SAAL,EAArB;AACA,MAAI,wBAAWN,MAAX,EAAmBs7B,YAAnB,CAAJ,EAAsC;AACpC,QAAM7lD,SAAS,KAAKokC,SAAL,EAAf;;AAEA,QAAI7Z,OAAO,CAAP,KAAavqB,OAAO,CAAP,CAAb,IAA0BuqB,OAAO,CAAP,KAAavqB,OAAO,CAAP,CAA3C,EAAsD;AACpD,aAAO,IAAP;AACD;AACD,QAAIuqB,OAAO,CAAP,KAAavqB,OAAO,CAAP,CAAb,IAA0BuqB,OAAO,CAAP,KAAavqB,OAAO,CAAP,CAA3C,EAAsD;AACpD,aAAO,IAAP;AACD;;AAED,WAAO,2BAAcuqB,MAAd,EAAsB,KAAKu7B,oBAA3B,EAAiD,IAAjD,CAAP;AACD;AACD,SAAO,KAAP;AAED,CAhBD;;AAmBA;;;;;AAKAd,OAAO3pC,SAAP,CAAiBopB,SAAjB,GAA6B,UAASzkC,MAAT,EAAiB;AAC5C,MAAM2pC,SAAS,KAAKA,MAApB;AACA,MAAMwb,SAAS,KAAKvH,eAAL,CAAqBjU,MAArB,IAA+B,KAAKiU,eAAL,CAAqB,CAArB,CAA9C;AACA,MAAMA,kBAAkB59C,OAAOgB,KAAP,EAAxB;AACA48C,kBAAgBjU,MAAhB,IAA0BiU,gBAAgB,CAAhB,IAAqBuH,MAA/C;AACA,OAAK,IAAIhkD,IAAI,CAAb,EAAgBA,IAAIwoC,MAApB,EAA4B,EAAExoC,CAA9B,EAAiC;AAC/By8C,oBAAgBjU,SAASxoC,CAAzB,IAA8BnB,OAAOmB,CAAP,CAA9B;AACD;AACD,OAAKkkD,kBAAL,CAAwB,KAAKC,MAA7B,EAAqC1H,eAArC;AACD,CATD;;AAYA;;;;;;;;AAQAoH,OAAO3pC,SAAP,CAAiB+pC,kBAAjB,GAAsC,UAASplD,MAAT,EAAiBmlD,MAAjB,EAAyBD,UAAzB,EAAqC;AACzE,MAAI,CAACllD,MAAL,EAAa;AACX,SAAKqlD,kBAAL,CAAwBU,yBAAeC,EAAvC,EAA2C,IAA3C;AACD,GAFD,MAEO;AACL,SAAKC,SAAL,CAAef,UAAf,EAA2BllD,MAA3B,EAAmC,CAAnC;AACA,QAAI,CAAC,KAAK49C,eAAV,EAA2B;AACzB,WAAKA,eAAL,GAAuB,EAAvB;AACD;AACD;AACA,QAAMA,kBAAkB,KAAKA,eAA7B;AACA,QAAInV,SAAS,gCACXmV,eADW,EACM,CADN,EACS59C,MADT,EACiB,KAAK2pC,MADtB,CAAb;AAEAiU,oBAAgBnV,QAAhB,IAA4BmV,gBAAgB,CAAhB,IAAqBuH,MAAjD;AACA,SAAK,IAAIhkD,IAAI,CAAR,EAAWwkB,KAAK,KAAKgkB,MAA1B,EAAkCxoC,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7Cy8C,sBAAgBnV,QAAhB,IAA4BmV,gBAAgBz8C,CAAhB,CAA5B;AACD;AACDy8C,oBAAgBx8C,MAAhB,GAAyBqnC,MAAzB;AACA,SAAKze,OAAL;AACD;AACF,CAnBD;;AAsBA;;;AAGAg7B,OAAO3pC,SAAP,CAAiByoC,cAAjB,GAAkC,YAAW,CAAE,CAA/C;;AAGA;;;AAGAkB,OAAO3pC,SAAP,CAAiB6qC,cAAjB,GAAkC,UAASnJ,WAAT,EAAsBmI,UAAtB,EAAkC,CAAE,CAAtE;;AAGA;;;;AAIAF,OAAO3pC,SAAP,CAAiBgqC,kBAAjB,GAAsC,UAASC,MAAT,EAAiB1H,eAAjB,EAAkC;AACtE,OAAKuI,0BAAL,CAAgCb,MAAhC,EAAwC1H,eAAxC;AACA,OAAK5zB,OAAL;AACD,CAHD;;AAMA;;;;;AAKAg7B,OAAO3pC,SAAP,CAAiB+qC,SAAjB,GAA6B,UAASjB,MAAT,EAAiB;AAC5C,OAAKvH,eAAL,CAAqB,KAAKjU,MAA1B,IAAoC,KAAKiU,eAAL,CAAqB,CAArB,IAA0BuH,MAA9D;AACA,OAAKn7B,OAAL;AACD,CAHD;;AAMA;;;;;;;;;;;;;;;;;;;;;;AAsBAg7B,OAAO3pC,SAAP,CAAiB22B,SAAjB;kBACegT,M;;;;;;;;;;;;;;;;;;ACnQf;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AAGA;;;;;;;;;;;;;;AAbA;;;AA2BA,IAAM97B,WAAW,SAAXA,QAAW,GAAW;;AAE1BtC,mBAAWlK,IAAX,CAAgB,IAAhB;;AAEA;;;;AAIA,OAAK2pC,OAAL,GAAe,0BAAf;;AAEA;;;;AAIA,OAAKC,eAAL,GAAuB,CAAC,CAAxB;;AAEA;;;;AAIA,OAAKC,uBAAL,GAA+B,EAA/B;;AAEA;;;;AAIA,OAAKC,wCAAL,GAAgD,CAAhD;;AAEA;;;;AAIA,OAAKC,0BAAL,GAAkC,CAAlC;AAED,CAlCD;;AAoCA,qBAASv9B,QAAT,EAAmBtC,gBAAnB;;AAGA;;;AAGA,IAAM8/B,eAAe,yBAArB;;AAGA;;;;;AAKAx9B,SAAS7N,SAAT,CAAmBiO,KAAnB,GAA2B,YAAW,CAAE,CAAxC;;AAGA;;;;;;;;AAQAJ,SAAS7N,SAAT,CAAmBkqC,cAAnB,GAAoC,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD,CAAE,CAAvF;;AAGA;;;;;;;;AAQAv8B,SAAS7N,SAAT,CAAmBsrC,eAAnB,GAAqC,UAASC,KAAT,EAAgBC,gBAAhB,EAAkC;AACrE,MAAMrB,eAAeqB,mBAAmBA,gBAAnB,GAAsC,CAACC,GAAD,EAAMA,GAAN,CAA3D;AACA,OAAKvB,cAAL,CAAoBqB,MAAM,CAAN,CAApB,EAA8BA,MAAM,CAAN,CAA9B,EAAwCpB,YAAxC,EAAsDj2C,QAAtD;AACA,SAAOi2C,YAAP;AACD,CAJD;;AAOA;;;;;;;AAOAt8B,SAAS7N,SAAT,CAAmByqC,oBAAnB,GAA0C,UAASl3B,UAAT,EAAqB;AAC7D,SAAO,KAAK6S,UAAL,CAAgB7S,WAAW,CAAX,CAAhB,EAA+BA,WAAW,CAAX,CAA/B,CAAP;AACD,CAFD;;AAKA;;;;;;AAMA1F,SAAS7N,SAAT,CAAmBsqC,aAAnB,GAAmC,UAASp7B,MAAT,EAAiB,CAAE,CAAtD;;AAGA;;;;;AAKArB,SAAS7N,SAAT,CAAmBomB,UAAnB,GAAgCyY,gBAAhC;;AAGA;;;;;;AAMAhxB,SAAS7N,SAAT,CAAmBwP,SAAnB,GAA+B,UAASsyB,UAAT,EAAqB;AAClD,MAAI,KAAKmJ,eAAL,IAAwB,KAAKzyB,WAAL,EAA5B,EAAgD;AAC9C,SAAKwyB,OAAL,GAAe,KAAKV,aAAL,CAAmB,KAAKU,OAAxB,CAAf;AACA,SAAKC,eAAL,GAAuB,KAAKzyB,WAAL,EAAvB;AACD;AACD,SAAO,4BAAe,KAAKwyB,OAApB,EAA6BlJ,UAA7B,CAAP;AACD,CAND;;AASA;;;;;;;;AAQAj0B,SAAS7N,SAAT,CAAmB4tB,MAAnB,GAA4B,UAASgM,KAAT,EAAgBjQ,MAAhB,EAAwB,CAAE,CAAtD;;AAGA;;;;;;;;;;;AAWA9b,SAAS7N,SAAT,CAAmBo4B,KAAnB,GAA2B,UAASsT,EAAT,EAAaC,MAAb,EAAqB1c,UAArB,EAAiC,CAAE,CAA9D;;AAGA;;;;;;;;;;;;AAYAphB,SAAS7N,SAAT,CAAmB4rC,QAAnB,GAA8B,UAASC,SAAT,EAAoB;AAChD,SAAO,KAAKC,qBAAL,CAA2BD,YAAYA,SAAvC,CAAP;AACD,CAFD;;AAKA;;;;;;;;AAQAh+B,SAAS7N,SAAT,CAAmB8rC,qBAAnB,GAA2C,UAASC,gBAAT,EAA2B,CAAE,CAAxE;;AAGA;;;;;AAKAl+B,SAAS7N,SAAT,CAAmBd,OAAnB,GAA6B,YAAW,CAAE,CAA1C;;AAGA;;;;;;;;AAQA2O,SAAS7N,SAAT,CAAmByhC,cAAnB,GAAoC,UAASuC,WAAT,EAAsB,CAAE,CAA5D;;AAGA;;;;;;AAMAn2B,SAAS7N,SAAT,CAAmBuqC,gBAAnB,GAAsC,UAASr7B,MAAT,EAAiB,CAAE,CAAzD;;AAGA;;;;;;;AAOArB,SAAS7N,SAAT,CAAmBgsC,SAAnB,GAA+B,UAAS1rB,MAAT,EAAiBE,MAAjB,EAAyB,CAAE,CAA1D;;AAGA;;;;;;;;;;;;;;;AAeA3S,SAAS7N,SAAT,CAAmB22B,SAAnB,GAA+B,UAAS1yC,MAAT,EAAiBgoD,WAAjB,EAA8B;AAC3DhoD,WAAS,eAAcA,MAAd,CAAT;AACA,MAAM+/C,cAAc//C,OAAOioD,QAAP,MAAqB3c,gBAAM4c,WAA3B,GAClB,UAASC,aAAT,EAAwBC,cAAxB,EAAwC/d,MAAxC,EAAgD;AAC9C,QAAMge,cAAcroD,OAAOurB,SAAP,EAApB;AACA,QAAM+8B,kBAAkBtoD,OAAOuoD,cAAP,EAAxB;AACA,QAAMpU,QAAQ,uBAAUmU,eAAV,IAA6B,uBAAUD,WAAV,CAA3C;AACA,6BAAiBjB,YAAjB,EACEkB,gBAAgB,CAAhB,CADF,EACsBA,gBAAgB,CAAhB,CADtB,EAEEnU,KAFF,EAES,CAACA,KAFV,EAEiB,CAFjB,EAGE,CAHF,EAGK,CAHL;AAIA,gCAAYgU,aAAZ,EAA2B,CAA3B,EAA8BA,cAAcrmD,MAA5C,EAAoDuoC,MAApD,EACE+c,YADF,EACgBgB,cADhB;AAEA,WAAO,wBAAapoD,MAAb,EAAqBgoD,WAArB,EAAkCG,aAAlC,EAAiDC,cAAjD,EAAiE/d,MAAjE,CAAP;AACD,GAZiB,GAalB,wBAAarqC,MAAb,EAAqBgoD,WAArB,CAbF;AAcA,OAAKxK,cAAL,CAAoBuC,WAApB;AACA,SAAO,IAAP;AACD,CAlBD;kBAmBen2B,Q;;;;;;;;;;;;;;;;;;AChRf;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;;;;AASA,IAAMm6B,qBAAqB,SAArBA,kBAAqB,CAASyE,cAAT,EAAyB;;AAElD5+B,qBAASxM,IAAT,CAAc,IAAd;;AAEA;;;;AAIA,OAAKqrC,WAAL,GAAmBD,iBAAiBA,cAAjB,GAAkC,IAArD;;AAEA,OAAKE,uBAAL;AACD,CAXD,C,CApBA;;;;;AAiCA,qBAAS3E,kBAAT,EAA6Bn6B,kBAA7B;;AAGA;;;;AAIA,SAAS++B,eAAT,CAAyB7E,UAAzB,EAAqC;AACnC,MAAM8E,mBAAmB,EAAzB;AACA,OAAK,IAAI/mD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnD+mD,qBAAiB/kD,IAAjB,CAAsBigD,WAAWjiD,CAAX,EAAcmoB,KAAd,EAAtB;AACD;AACD,SAAO4+B,gBAAP;AACD;;AAGD;;;AAGA7E,mBAAmBhoC,SAAnB,CAA6B8sC,yBAA7B,GAAyD,YAAW;AAClE,MAAI,CAAC,KAAKJ,WAAV,EAAuB;AACrB;AACD;AACD,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAK,KAAKoiC,WAAL,CAAiB3mD,MAAtC,EAA8CD,IAAIwkB,EAAlD,EAAsD,EAAExkB,CAAxD,EAA2D;AACzD,0BACE,KAAK4mD,WAAL,CAAiB5mD,CAAjB,CADF,EACuB8oB,oBAAUC,MADjC,EAEE,KAAKF,OAFP,EAEgB,IAFhB;AAGD;AACF,CATD;;AAYA;;;AAGAq5B,mBAAmBhoC,SAAnB,CAA6B2sC,uBAA7B,GAAuD,YAAW;AAChE,MAAI,CAAC,KAAKD,WAAV,EAAuB;AACrB;AACD;AACD,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAK,KAAKoiC,WAAL,CAAiB3mD,MAAtC,EAA8CD,IAAIwkB,EAAlD,EAAsD,EAAExkB,CAAxD,EAA2D;AACzD,wBACE,KAAK4mD,WAAL,CAAiB5mD,CAAjB,CADF,EACuB8oB,oBAAUC,MADjC,EAEE,KAAKF,OAFP,EAEgB,IAFhB;AAGD;AACF,CATD;;AAYA;;;;;;AAMAq5B,mBAAmBhoC,SAAnB,CAA6BiO,KAA7B,GAAqC,YAAW;AAC9C,MAAM8+B,qBAAqB,IAAI/E,kBAAJ,CAAuB,IAAvB,CAA3B;AACA+E,qBAAmBC,aAAnB,CAAiC,KAAKN,WAAtC;AACA,SAAOK,kBAAP;AACD,CAJD;;AAOA;;;AAGA/E,mBAAmBhoC,SAAnB,CAA6BkqC,cAA7B,GAA8C,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD;AAC7F,MAAIA,qBAAqB,sCAAyB,KAAK56B,SAAL,EAAzB,EAA2Ctf,CAA3C,EAA8C+N,CAA9C,CAAzB,EAA2E;AACzE,WAAOmsC,kBAAP;AACD;AACD,MAAMrC,aAAa,KAAK2E,WAAxB;AACA,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnDskD,yBAAqBrC,WAAWjiD,CAAX,EAAcokD,cAAd,CACnBh6C,CADmB,EAChB+N,CADgB,EACbksC,YADa,EACCC,kBADD,CAArB;AAED;AACD,SAAOA,kBAAP;AACD,CAVD;;AAaA;;;AAGApC,mBAAmBhoC,SAAnB,CAA6BomB,UAA7B,GAA0C,UAASl2B,CAAT,EAAY+N,CAAZ,EAAe;AACvD,MAAM8pC,aAAa,KAAK2E,WAAxB;AACA,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnD,QAAIiiD,WAAWjiD,CAAX,EAAcsgC,UAAd,CAAyBl2B,CAAzB,EAA4B+N,CAA5B,CAAJ,EAAoC;AAClC,aAAO,IAAP;AACD;AACF;AACD,SAAO,KAAP;AACD,CARD;;AAWA;;;AAGA+pC,mBAAmBhoC,SAAnB,CAA6BsqC,aAA7B,GAA6C,UAASp7B,MAAT,EAAiB;AAC5D,mCAAoBA,MAApB;AACA,MAAM64B,aAAa,KAAK2E,WAAxB;AACA,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnD,wBAAOopB,MAAP,EAAe64B,WAAWjiD,CAAX,EAAc0pB,SAAd,EAAf;AACD;AACD,SAAON,MAAP;AACD,CAPD;;AAUA;;;;;AAKA84B,mBAAmBhoC,SAAnB,CAA6BitC,aAA7B,GAA6C,YAAW;AACtD,SAAOL,gBAAgB,KAAKF,WAArB,CAAP;AACD,CAFD;;AAKA;;;AAGA1E,mBAAmBhoC,SAAnB,CAA6BwoC,kBAA7B,GAAkD,YAAW;AAC3D,SAAO,KAAKkE,WAAZ;AACD,CAFD;;AAKA;;;AAGA1E,mBAAmBhoC,SAAnB,CAA6B8rC,qBAA7B,GAAqD,UAASC,gBAAT,EAA2B;AAC9E,MAAI,KAAKX,0BAAL,IAAmC,KAAK5yB,WAAL,EAAvC,EAA2D;AACzD,oBAAM,KAAK0yB,uBAAX;AACA,SAAKC,wCAAL,GAAgD,CAAhD;AACA,SAAKC,0BAAL,GAAkC,KAAK5yB,WAAL,EAAlC;AACD;AACD,MAAIuzB,mBAAmB,CAAnB,IACC,KAAKZ,wCAAL,KAAkD,CAAlD,IACAY,mBAAmB,KAAKZ,wCAF7B,EAEwE;AACtE,WAAO,IAAP;AACD;AACD,MAAMh9C,MAAM49C,iBAAiBpjD,QAAjB,EAAZ;AACA,MAAI,KAAKuiD,uBAAL,CAA6BlqC,cAA7B,CAA4C7S,GAA5C,CAAJ,EAAsD;AACpD,WAAO,KAAK+8C,uBAAL,CAA6B/8C,GAA7B,CAAP;AACD,GAFD,MAEO;AACL,QAAM++C,uBAAuB,EAA7B;AACA,QAAMnF,aAAa,KAAK2E,WAAxB;AACA,QAAIS,aAAa,KAAjB;AACA,SAAK,IAAIrnD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnD,UAAMgoB,WAAWi6B,WAAWjiD,CAAX,CAAjB;AACA,UAAMsnD,qBAAqBt/B,SAASg+B,qBAAT,CAA+BC,gBAA/B,CAA3B;AACAmB,2BAAqBplD,IAArB,CAA0BslD,kBAA1B;AACA,UAAIA,uBAAuBt/B,QAA3B,EAAqC;AACnCq/B,qBAAa,IAAb;AACD;AACF;AACD,QAAIA,UAAJ,EAAgB;AACd,UAAME,+BAA+B,IAAIrF,kBAAJ,CAAuB,IAAvB,CAArC;AACAqF,mCAA6BC,kBAA7B,CAAgDJ,oBAAhD;AACA,WAAKhC,uBAAL,CAA6B/8C,GAA7B,IAAoCk/C,4BAApC;AACA,aAAOA,4BAAP;AACD,KALD,MAKO;AACL,WAAKlC,wCAAL,GAAgDY,gBAAhD;AACA,aAAO,IAAP;AACD;AACF;AACF,CApCD;;AAuCA;;;;AAIA/D,mBAAmBhoC,SAAnB,CAA6Bd,OAA7B,GAAuC,YAAW;AAChD,SAAOwuB,uBAAa6f,mBAApB;AACD,CAFD;;AAKA;;;;AAIAvF,mBAAmBhoC,SAAnB,CAA6BuqC,gBAA7B,GAAgD,UAASr7B,MAAT,EAAiB;AAC/D,MAAM64B,aAAa,KAAK2E,WAAxB;AACA,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnD,QAAIiiD,WAAWjiD,CAAX,EAAcykD,gBAAd,CAA+Br7B,MAA/B,CAAJ,EAA4C;AAC1C,aAAO,IAAP;AACD;AACF;AACD,SAAO,KAAP;AACD,CARD;;AAWA;;;AAGA84B,mBAAmBhoC,SAAnB,CAA6BihB,OAA7B,GAAuC,YAAW;AAChD,SAAO,KAAKyrB,WAAL,CAAiB3mD,MAAjB,KAA4B,CAAnC;AACD,CAFD;;AAKA;;;;AAIAiiD,mBAAmBhoC,SAAnB,CAA6B4tB,MAA7B,GAAsC,UAASgM,KAAT,EAAgBjQ,MAAhB,EAAwB;AAC5D,MAAMoe,aAAa,KAAK2E,WAAxB;AACA,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnDiiD,eAAWjiD,CAAX,EAAc8nC,MAAd,CAAqBgM,KAArB,EAA4BjQ,MAA5B;AACD;AACD,OAAKhb,OAAL;AACD,CAND;;AASA;;;;AAIAq5B,mBAAmBhoC,SAAnB,CAA6Bo4B,KAA7B,GAAqC,UAASsT,EAAT,EAAaC,MAAb,EAAqB1c,UAArB,EAAiC;AACpE,MAAItF,SAASsF,UAAb;AACA,MAAI,CAACtF,MAAL,EAAa;AACXA,aAAS,uBAAU,KAAKna,SAAL,EAAV,CAAT;AACD;AACD,MAAMu4B,aAAa,KAAK2E,WAAxB;AACA,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnDiiD,eAAWjiD,CAAX,EAAcsyC,KAAd,CAAoBsT,EAApB,EAAwBC,MAAxB,EAAgChiB,MAAhC;AACD;AACD,OAAKhb,OAAL;AACD,CAVD;;AAaA;;;;;AAKAq5B,mBAAmBhoC,SAAnB,CAA6BgtC,aAA7B,GAA6C,UAASjF,UAAT,EAAqB;AAChE,OAAKuF,kBAAL,CAAwBV,gBAAgB7E,UAAhB,CAAxB;AACD,CAFD;;AAKA;;;AAGAC,mBAAmBhoC,SAAnB,CAA6BstC,kBAA7B,GAAkD,UAASvF,UAAT,EAAqB;AACrE,OAAK+E,yBAAL;AACA,OAAKJ,WAAL,GAAmB3E,UAAnB;AACA,OAAK4E,uBAAL;AACA,OAAKh+B,OAAL;AACD,CALD;;AAQA;;;;AAIAq5B,mBAAmBhoC,SAAnB,CAA6ByhC,cAA7B,GAA8C,UAASuC,WAAT,EAAsB;AAClE,MAAM+D,aAAa,KAAK2E,WAAxB;AACA,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnDiiD,eAAWjiD,CAAX,EAAc27C,cAAd,CAA6BuC,WAA7B;AACD;AACD,OAAKr1B,OAAL;AACD,CAND;;AASA;;;;;;;AAOAq5B,mBAAmBhoC,SAAnB,CAA6BgsC,SAA7B,GAAyC,UAAS1rB,MAAT,EAAiBE,MAAjB,EAAyB;AAChE,MAAMunB,aAAa,KAAK2E,WAAxB;AACA,OAAK,IAAI5mD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnDiiD,eAAWjiD,CAAX,EAAckmD,SAAd,CAAwB1rB,MAAxB,EAAgCE,MAAhC;AACD;AACD,OAAK7R,OAAL;AACD,CAND;;AASA;;;AAGAq5B,mBAAmBhoC,SAAnB,CAA6BkN,eAA7B,GAA+C,YAAW;AACxD,OAAK4/B,yBAAL;AACAj/B,qBAAS7N,SAAT,CAAmBkN,eAAnB,CAAmC7L,IAAnC,CAAwC,IAAxC;AACD,CAHD;kBAIe2mC,kB;;;;;;;;;;;;;;;;;AC1Tf;;;;AAIA;;;;;;kBAMe;AACb2C,MAAI,IADS;AAEb6C,OAAK,KAFQ;AAGbC,OAAK,KAHQ;AAIbC,QAAM;AAJO,C;;;;;;;;;;;;;;;;;ACVf;;;;AAIA;;;;;;kBAMe;AACbC,SAAO,OADM;AAEbC,eAAa,YAFA;AAGbC,eAAa,YAHA;AAIbC,WAAS,SAJI;AAKbC,eAAa,YALA;AAMbC,qBAAmB,iBANN;AAObC,iBAAe,cAPF;AAQbV,uBAAqB,oBARR;AASb5f,UAAQ;AATK,C;;;;;;;;;;;;;;;;;;ACPf;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA;;;;;;;;;;AAlBA;;;AA4BA,IAAMua,aAAa,SAAbA,UAAa,CAASxG,WAAT,EAAsBmI,UAAtB,EAAkC;;AAEnDpc,2BAAepsB,IAAf,CAAoB,IAApB;;AAEA;;;;AAIA,OAAK6sC,aAAL,GAAqB,IAArB;;AAEA;;;;AAIA,OAAKC,qBAAL,GAA6B,CAAC,CAA9B;;AAEA;;;;AAIA,OAAKC,SAAL,GAAiB,CAAC,CAAlB;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,CAAC,CAA1B;;AAEA,OAAKxD,cAAL,CAAoBnJ,WAApB,EAAiCmI,UAAjC;AAED,CA9BD;;AAgCA,qBAAS3B,UAAT,EAAqBza,wBAArB;;AAGA;;;;;AAKAya,WAAWloC,SAAX,CAAqBsuC,gBAArB,GAAwC,UAAS/6B,UAAT,EAAqB;AAC3D,MAAI,CAAC,KAAKgvB,eAAV,EAA2B;AACzB,SAAKA,eAAL,GAAuBhvB,WAAW5tB,KAAX,EAAvB;AACD,GAFD,MAEO;AACL,uBAAO,KAAK48C,eAAZ,EAA6BhvB,UAA7B;AACD;AACD,OAAK5E,OAAL;AACD,CAPD;;AAUA;;;;;;AAMAu5B,WAAWloC,SAAX,CAAqBiO,KAArB,GAA6B,YAAW;AACtC,MAAMsgC,aAAa,IAAIrG,UAAJ,CAAe,IAAf,CAAnB;AACAqG,aAAWvE,kBAAX,CAA8B,KAAKC,MAAnC,EAA2C,KAAK1H,eAAL,CAAqB58C,KAArB,EAA3C;AACA,SAAO4oD,UAAP;AACD,CAJD;;AAOA;;;AAGArG,WAAWloC,SAAX,CAAqBkqC,cAArB,GAAsC,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD;AACrF,MAAIA,qBAAqB,sCAAyB,KAAK56B,SAAL,EAAzB,EAA2Ctf,CAA3C,EAA8C+N,CAA9C,CAAzB,EAA2E;AACzE,WAAOmsC,kBAAP;AACD;AACD,MAAI,KAAKiE,iBAAL,IAA0B,KAAK71B,WAAL,EAA9B,EAAkD;AAChD,SAAK41B,SAAL,GAAiBvkD,KAAKsG,IAAL,CAAU,8BACzB,KAAKoyC,eADoB,EACH,CADG,EACA,KAAKA,eAAL,CAAqBx8C,MADrB,EAC6B,KAAKuoC,MADlC,EAC0C,CAD1C,CAAV,CAAjB;AAEA,SAAK+f,iBAAL,GAAyB,KAAK71B,WAAL,EAAzB;AACD;AACD,SAAO,iCACL,KAAK+pB,eADA,EACiB,CADjB,EACoB,KAAKA,eAAL,CAAqBx8C,MADzC,EACiD,KAAKuoC,MADtD,EAEL,KAAK8f,SAFA,EAEW,KAFX,EAEkBl+C,CAFlB,EAEqB+N,CAFrB,EAEwBksC,YAFxB,EAEsCC,kBAFtC,CAAP;AAGD,CAZD;;AAeA;;;;;;;;;;;AAWAlC,WAAWloC,SAAX,CAAqBwuC,cAArB,GAAsC,UAAS3wB,QAAT,EAAmB;AACvD,SAAO,uBAAe,KAAK0kB,eAApB,EAAqC,CAArC,EAAwC,KAAKA,eAAL,CAAqBx8C,MAA7D,EAAqE,KAAKuoC,MAA1E,EAAkFzQ,QAAlF,CAAP;AACD,CAFD;;AAKA;;;;;;;;;;;;;;AAcAqqB,WAAWloC,SAAX,CAAqByuC,gBAArB,GAAwC,UAASx/C,CAAT,EAAYy/C,eAAZ,EAA6B;AACnE,MAAI,KAAKzE,MAAL,IAAeS,yBAAe+C,GAA9B,IACA,KAAKxD,MAAL,IAAeS,yBAAegD,IADlC,EACwC;AACtC,WAAO,IAAP;AACD;AACD,MAAMiB,cAAcD,oBAAoBhoD,SAApB,GAAgCgoD,eAAhC,GAAkD,KAAtE;AACA,SAAO,0CAAwB,KAAKnM,eAA7B,EAA8C,CAA9C,EACL,KAAKA,eAAL,CAAqBx8C,MADhB,EACwB,KAAKuoC,MAD7B,EACqCr/B,CADrC,EACwC0/C,WADxC,CAAP;AAED,CARD;;AAWA;;;;;;AAMAzG,WAAWloC,SAAX,CAAqByoC,cAArB,GAAsC,YAAW;AAC/C,SAAO,iCACL,KAAKlG,eADA,EACiB,CADjB,EACoB,KAAKA,eAAL,CAAqBx8C,MADzC,EACiD,KAAKuoC,MADtD,CAAP;AAED,CAHD;;AAMA;;;;;;;;;;AAUA4Z,WAAWloC,SAAX,CAAqB4uC,eAArB,GAAuC,UAAS/jB,QAAT,EAAmBgkB,QAAnB,EAA6B;AAClE,SAAO,mCACL,KAAKtM,eADA,EACiB,CADjB,EACoB,KAAKA,eAAL,CAAqBx8C,MADzC,EACiD,KAAKuoC,MADtD,EAELzD,QAFK,EAEKgkB,QAFL,CAAP;AAGD,CAJD;;AAOA;;;;;AAKA3G,WAAWloC,SAAX,CAAqB8L,SAArB,GAAiC,YAAW;AAC1C,SAAO,8BACL,KAAKy2B,eADA,EACiB,CADjB,EACoB,KAAKA,eAAL,CAAqBx8C,MADzC,EACiD,KAAKuoC,MADtD,CAAP;AAED,CAHD;;AAMA;;;AAGA4Z,WAAWloC,SAAX,CAAqB8uC,eAArB,GAAuC,YAAW;AAChD,MAAI,KAAKX,qBAAL,IAA8B,KAAK31B,WAAL,EAAlC,EAAsD;AACpD,SAAK01B,aAAL,GAAqB,KAAKU,eAAL,CAAqB,GAArB,EAA0B,KAAKV,aAA/B,CAArB;AACA,SAAKC,qBAAL,GAA6B,KAAK31B,WAAL,EAA7B;AACD;AACD,SAAO,KAAK01B,aAAZ;AACD,CAND;;AASA;;;AAGAhG,WAAWloC,SAAX,CAAqB+uC,6BAArB,GAAqD,UAAShD,gBAAT,EAA2B;AAC9E,MAAMiD,4BAA4B,EAAlC;AACAA,4BAA0BjpD,MAA1B,GAAmC,8BACjC,KAAKw8C,eAD4B,EACX,CADW,EACR,KAAKA,eAAL,CAAqBx8C,MADb,EACqB,KAAKuoC,MAD1B,EAEjCyd,gBAFiC,EAEfiD,yBAFe,EAEY,CAFZ,CAAnC;AAGA,MAAMC,uBAAuB,IAAI/G,UAAJ,CAAe,IAAf,CAA7B;AACA+G,uBAAqBjF,kBAArB,CACEU,yBAAeC,EADjB,EACqBqE,yBADrB;AAEA,SAAOC,oBAAP;AACD,CATD;;AAYA;;;;AAIA/G,WAAWloC,SAAX,CAAqBd,OAArB,GAA+B,YAAW;AACxC,SAAOwuB,uBAAakgB,WAApB;AACD,CAFD;;AAKA;;;;AAIA1F,WAAWloC,SAAX,CAAqBuqC,gBAArB,GAAwC,UAASr7B,MAAT,EAAiB;AACvD,SAAO,4CACL,KAAKqzB,eADA,EACiB,CADjB,EACoB,KAAKA,eAAL,CAAqBx8C,MADzC,EACiD,KAAKuoC,MADtD,EAELpf,MAFK,CAAP;AAGD,CAJD;;AAOA;;;;;;;AAOAg5B,WAAWloC,SAAX,CAAqB6qC,cAArB,GAAsC,UAASnJ,WAAT,EAAsBmI,UAAtB,EAAkC;AACtE,MAAI,CAACnI,WAAL,EAAkB;AAChB,SAAKsI,kBAAL,CAAwBU,yBAAeC,EAAvC,EAA2C,IAA3C;AACD,GAFD,MAEO;AACL,SAAKC,SAAL,CAAef,UAAf,EAA2BnI,WAA3B,EAAwC,CAAxC;AACA,QAAI,CAAC,KAAKa,eAAV,EAA2B;AACzB,WAAKA,eAAL,GAAuB,EAAvB;AACD;AACD,SAAKA,eAAL,CAAqBx8C,MAArB,GAA8B,iCAC5B,KAAKw8C,eADuB,EACN,CADM,EACHb,WADG,EACU,KAAKpT,MADf,CAA9B;AAEA,SAAK3f,OAAL;AACD;AACF,CAZD;;AAeA;;;;AAIAu5B,WAAWloC,SAAX,CAAqBgqC,kBAArB,GAA0C,UAASC,MAAT,EAAiB1H,eAAjB,EAAkC;AAC1E,OAAKuI,0BAAL,CAAgCb,MAAhC,EAAwC1H,eAAxC;AACA,OAAK5zB,OAAL;AACD,CAHD;kBAIeu5B,U;;;;;;;;;;;;;;;;;;ACxQf;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA;;;;;;;;;;;AAdA;;;AAyBA,IAAMgH,aAAa,SAAbA,UAAa,CAASxN,WAAT,EAAsBmI,UAAtB,EAAkC;;AAEnDpc,2BAAepsB,IAAf,CAAoB,IAApB;;AAEA;;;;AAIA,OAAK+sC,SAAL,GAAiB,CAAC,CAAlB;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,CAAC,CAA1B;;AAEA,OAAKxD,cAAL,CAAoBnJ,WAApB,EAAiCmI,UAAjC;AAED,CAlBD;;AAoBA,qBAASqF,UAAT,EAAqBzhB,wBAArB;;AAGA;;;;;;AAMAyhB,WAAWlvC,SAAX,CAAqBiO,KAArB,GAA6B,YAAW;AACtC,MAAMkhC,aAAa,IAAID,UAAJ,CAAe,IAAf,CAAnB;AACAC,aAAWnF,kBAAX,CAA8B,KAAKC,MAAnC,EAA2C,KAAK1H,eAAL,CAAqB58C,KAArB,EAA3C;AACA,SAAOwpD,UAAP;AACD,CAJD;;AAOA;;;AAGAD,WAAWlvC,SAAX,CAAqBkqC,cAArB,GAAsC,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD;AACrF,MAAIA,qBAAqB,sCAAyB,KAAK56B,SAAL,EAAzB,EAA2Ctf,CAA3C,EAA8C+N,CAA9C,CAAzB,EAA2E;AACzE,WAAOmsC,kBAAP;AACD;AACD,MAAI,KAAKiE,iBAAL,IAA0B,KAAK71B,WAAL,EAA9B,EAAkD;AAChD,SAAK41B,SAAL,GAAiBvkD,KAAKsG,IAAL,CAAU,8BACzB,KAAKoyC,eADoB,EACH,CADG,EACA,KAAKA,eAAL,CAAqBx8C,MADrB,EAC6B,KAAKuoC,MADlC,EAC0C,CAD1C,CAAV,CAAjB;AAEA,SAAK+f,iBAAL,GAAyB,KAAK71B,WAAL,EAAzB;AACD;AACD,SAAO,iCACL,KAAK+pB,eADA,EACiB,CADjB,EACoB,KAAKA,eAAL,CAAqBx8C,MADzC,EACiD,KAAKuoC,MADtD,EAEL,KAAK8f,SAFA,EAEW,IAFX,EAEiBl+C,CAFjB,EAEoB+N,CAFpB,EAEuBksC,YAFvB,EAEqCC,kBAFrC,CAAP;AAGD,CAZD;;AAeA;;;;;AAKA8E,WAAWlvC,SAAX,CAAqB2gC,OAArB,GAA+B,YAAW;AACxC,SAAO,sBAAe,KAAK4B,eAApB,EAAqC,CAArC,EAAwC,KAAKA,eAAL,CAAqBx8C,MAA7D,EAAqE,KAAKuoC,MAA1E,CAAP;AACD,CAFD;;AAKA;;;;;;AAMA4gB,WAAWlvC,SAAX,CAAqByoC,cAArB,GAAsC,YAAW;AAC/C,SAAO,iCACL,KAAKlG,eADA,EACiB,CADjB,EACoB,KAAKA,eAAL,CAAqBx8C,MADzC,EACiD,KAAKuoC,MADtD,CAAP;AAED,CAHD;;AAMA;;;AAGA4gB,WAAWlvC,SAAX,CAAqB+uC,6BAArB,GAAqD,UAAShD,gBAAT,EAA2B;AAC9E,MAAMiD,4BAA4B,EAAlC;AACAA,4BAA0BjpD,MAA1B,GAAmC,8BACjC,KAAKw8C,eAD4B,EACX,CADW,EACR,KAAKA,eAAL,CAAqBx8C,MADb,EACqB,KAAKuoC,MAD1B,EAEjCyd,gBAFiC,EAEfiD,yBAFe,EAEY,CAFZ,CAAnC;AAGA,MAAMI,uBAAuB,IAAIF,UAAJ,CAAe,IAAf,CAA7B;AACAE,uBAAqBpF,kBAArB,CACEU,yBAAeC,EADjB,EACqBqE,yBADrB;AAEA,SAAOI,oBAAP;AACD,CATD;;AAYA;;;;AAIAF,WAAWlvC,SAAX,CAAqBd,OAArB,GAA+B,YAAW;AACxC,SAAOwuB,uBAAamgB,WAApB;AACD,CAFD;;AAKA;;;AAGAqB,WAAWlvC,SAAX,CAAqBuqC,gBAArB,GAAwC,UAASr7B,MAAT,EAAiB,CAAE,CAA3D;;AAGA;;;;;;;AAOAggC,WAAWlvC,SAAX,CAAqB6qC,cAArB,GAAsC,UAASnJ,WAAT,EAAsBmI,UAAtB,EAAkC;AACtE,MAAI,CAACnI,WAAL,EAAkB;AAChB,SAAKsI,kBAAL,CAAwBU,yBAAeC,EAAvC,EAA2C,IAA3C;AACD,GAFD,MAEO;AACL,SAAKC,SAAL,CAAef,UAAf,EAA2BnI,WAA3B,EAAwC,CAAxC;AACA,QAAI,CAAC,KAAKa,eAAV,EAA2B;AACzB,WAAKA,eAAL,GAAuB,EAAvB;AACD;AACD,SAAKA,eAAL,CAAqBx8C,MAArB,GAA8B,iCAC5B,KAAKw8C,eADuB,EACN,CADM,EACHb,WADG,EACU,KAAKpT,MADf,CAA9B;AAEA,SAAK3f,OAAL;AACD;AACF,CAZD;;AAeA;;;;AAIAugC,WAAWlvC,SAAX,CAAqBgqC,kBAArB,GAA0C,UAASC,MAAT,EAAiB1H,eAAjB,EAAkC;AAC1E,OAAKuI,0BAAL,CAAgCb,MAAhC,EAAwC1H,eAAxC;AACA,OAAK5zB,OAAL;AACD,CAHD;kBAIeugC,U;;;;;;;;;;;;;;;;;;AC9Jf;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA;;;;;;;;;;AAUA,IAAM/G,kBAAkB,SAAlBA,eAAkB,CAASzG,WAAT,EAAsBmI,UAAtB,EAAkC;;AAExDpc,2BAAepsB,IAAf,CAAoB,IAApB;;AAEA;;;;AAIA,OAAKguC,KAAL,GAAa,EAAb;;AAEA;;;;AAIA,OAAKjB,SAAL,GAAiB,CAAC,CAAlB;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,CAAC,CAA1B;;AAEA,OAAKxD,cAAL,CAAoBnJ,WAApB,EAAiCmI,UAAjC;AAED,CAxBD,C,CA3BA;;;;;AAqDA,qBAAS1B,eAAT,EAA0B1a,wBAA1B;;AAGA;;;;;AAKA0a,gBAAgBnoC,SAAhB,CAA0BsvC,gBAA1B,GAA6C,UAASf,UAAT,EAAqB;AAChE,MAAI,CAAC,KAAKhM,eAAV,EAA2B;AACzB,SAAKA,eAAL,GAAuBgM,WAAWxgB,kBAAX,GAAgCpoC,KAAhC,EAAvB;AACD,GAFD,MAEO;AACL,uBAAO,KAAK48C,eAAZ,EAA6BgM,WAAWxgB,kBAAX,GAAgCpoC,KAAhC,EAA7B;AACD;AACD,OAAK0pD,KAAL,CAAWvnD,IAAX,CAAgB,KAAKy6C,eAAL,CAAqBx8C,MAArC;AACA,OAAK4oB,OAAL;AACD,CARD;;AAWA;;;;;;AAMAw5B,gBAAgBnoC,SAAhB,CAA0BiO,KAA1B,GAAkC,YAAW;AAC3C,MAAMshC,kBAAkB,IAAIpH,eAAJ,CAAoB,IAApB,CAAxB;AACAoH,kBAAgBvF,kBAAhB,CACE,KAAKC,MADP,EACe,KAAK1H,eAAL,CAAqB58C,KAArB,EADf,EAC6C,KAAK0pD,KAAL,CAAW1pD,KAAX,EAD7C;AAEA,SAAO4pD,eAAP;AACD,CALD;;AAQA;;;AAGApH,gBAAgBnoC,SAAhB,CAA0BkqC,cAA1B,GAA2C,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD;AAC1F,MAAIA,qBAAqB,sCAAyB,KAAK56B,SAAL,EAAzB,EAA2Ctf,CAA3C,EAA8C+N,CAA9C,CAAzB,EAA2E;AACzE,WAAOmsC,kBAAP;AACD;AACD,MAAI,KAAKiE,iBAAL,IAA0B,KAAK71B,WAAL,EAA9B,EAAkD;AAChD,SAAK41B,SAAL,GAAiBvkD,KAAKsG,IAAL,CAAU,mCACzB,KAAKoyC,eADoB,EACH,CADG,EACA,KAAK8M,KADL,EACY,KAAK/gB,MADjB,EACyB,CADzB,CAAV,CAAjB;AAEA,SAAK+f,iBAAL,GAAyB,KAAK71B,WAAL,EAAzB;AACD;AACD,SAAO,sCACL,KAAK+pB,eADA,EACiB,CADjB,EACoB,KAAK8M,KADzB,EACgC,KAAK/gB,MADrC,EAEL,KAAK8f,SAFA,EAEW,KAFX,EAEkBl+C,CAFlB,EAEqB+N,CAFrB,EAEwBksC,YAFxB,EAEsCC,kBAFtC,CAAP;AAGD,CAZD;;AAeA;;;;;;;;;;;;;;;;;;;;;;AAsBAjC,gBAAgBnoC,SAAhB,CAA0ByuC,gBAA1B,GAA6C,UAASx/C,CAAT,EAAYy/C,eAAZ,EAA6Bc,eAA7B,EAA8C;AACzF,MAAK,KAAKvF,MAAL,IAAeS,yBAAe+C,GAA9B,IACA,KAAKxD,MAAL,IAAeS,yBAAegD,IAD/B,IAEA,KAAKnL,eAAL,CAAqBx8C,MAArB,KAAgC,CAFpC,EAEuC;AACrC,WAAO,IAAP;AACD;AACD,MAAM4oD,cAAcD,oBAAoBhoD,SAApB,GAAgCgoD,eAAhC,GAAkD,KAAtE;AACA,MAAMj9C,cAAc+9C,oBAAoB9oD,SAApB,GAAgC8oD,eAAhC,GAAkD,KAAtE;AACA,SAAO,2CAAyB,KAAKjN,eAA9B,EAA+C,CAA/C,EACL,KAAK8M,KADA,EACO,KAAK/gB,MADZ,EACoBr/B,CADpB,EACuB0/C,WADvB,EACoCl9C,WADpC,CAAP;AAED,CAVD;;AAaA;;;;;;AAMA02C,gBAAgBnoC,SAAhB,CAA0ByoC,cAA1B,GAA2C,YAAW;AACpD,SAAO,sCACL,KAAKlG,eADA,EACiB,CADjB,EACoB,KAAK8M,KADzB,EACgC,KAAK/gB,MADrC,CAAP;AAED,CAHD;;AAMA;;;AAGA6Z,gBAAgBnoC,SAAhB,CAA0ByvC,OAA1B,GAAoC,YAAW;AAC7C,SAAO,KAAKJ,KAAZ;AACD,CAFD;;AAKA;;;;;;AAMAlH,gBAAgBnoC,SAAhB,CAA0B0vC,aAA1B,GAA0C,UAASvlD,KAAT,EAAgB;AACxD,MAAIA,QAAQ,CAAR,IAAa,KAAKklD,KAAL,CAAWtpD,MAAX,IAAqBoE,KAAtC,EAA6C;AAC3C,WAAO,IAAP;AACD;AACD,MAAMokD,aAAa,IAAIrG,oBAAJ,CAAe,IAAf,CAAnB;AACAqG,aAAWvE,kBAAX,CAA8B,KAAKC,MAAnC,EAA2C,KAAK1H,eAAL,CAAqB58C,KAArB,CACzCwE,UAAU,CAAV,GAAc,CAAd,GAAkB,KAAKklD,KAAL,CAAWllD,QAAQ,CAAnB,CADuB,EACA,KAAKklD,KAAL,CAAWllD,KAAX,CADA,CAA3C;AAEA,SAAOokD,UAAP;AACD,CARD;;AAWA;;;;;AAKApG,gBAAgBnoC,SAAhB,CAA0B2vC,cAA1B,GAA2C,YAAW;AACpD,MAAMpN,kBAAkB,KAAKA,eAA7B;AACA,MAAMqN,OAAO,KAAKP,KAAlB;AACA,MAAMpF,SAAS,KAAKA,MAApB;AACA;AACA,MAAM4F,cAAc,EAApB;AACA,MAAIziB,SAAS,CAAb;AACA,OAAK,IAAItnC,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACA,QAAMyoD,aAAa,IAAIrG,oBAAJ,CAAe,IAAf,CAAnB;AACAqG,eAAWvE,kBAAX,CAA8BC,MAA9B,EAAsC1H,gBAAgB58C,KAAhB,CAAsBynC,MAAtB,EAA8B3b,GAA9B,CAAtC;AACAo+B,gBAAY/nD,IAAZ,CAAiBymD,UAAjB;AACAnhB,aAAS3b,GAAT;AACD;AACD,SAAOo+B,WAAP;AACD,CAfD;;AAkBA;;;AAGA1H,gBAAgBnoC,SAAhB,CAA0B8vC,gBAA1B,GAA6C,YAAW;AACtD,MAAMC,YAAY,EAAlB;AACA,MAAMxN,kBAAkB,KAAKA,eAA7B;AACA,MAAInV,SAAS,CAAb;AACA,MAAMwiB,OAAO,KAAKP,KAAlB;AACA,MAAM/gB,SAAS,KAAKA,MAApB;AACA,OAAK,IAAIxoC,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACA,QAAMkqD,WAAW,mCACfzN,eADe,EACEnV,MADF,EACU3b,GADV,EACe6c,MADf,EACuB,GADvB,CAAjB;AAEA,uBAAOyhB,SAAP,EAAkBC,QAAlB;AACA5iB,aAAS3b,GAAT;AACD;AACD,SAAOs+B,SAAP;AACD,CAdD;;AAiBA;;;AAGA5H,gBAAgBnoC,SAAhB,CAA0B+uC,6BAA1B,GAA0D,UAAShD,gBAAT,EAA2B;AACnF,MAAMiD,4BAA4B,EAAlC;AACA,MAAMiB,iBAAiB,EAAvB;AACAjB,4BAA0BjpD,MAA1B,GAAmC,mCACjC,KAAKw8C,eAD4B,EACX,CADW,EACR,KAAK8M,KADG,EACI,KAAK/gB,MADT,EACiByd,gBADjB,EAEjCiD,yBAFiC,EAEN,CAFM,EAEHiB,cAFG,CAAnC;AAGA,MAAMC,4BAA4B,IAAI/H,eAAJ,CAAoB,IAApB,CAAlC;AACA+H,4BAA0BlG,kBAA1B,CACEU,yBAAeC,EADjB,EACqBqE,yBADrB,EACgDiB,cADhD;AAEA,SAAOC,yBAAP;AACD,CAVD;;AAaA;;;;AAIA/H,gBAAgBnoC,SAAhB,CAA0Bd,OAA1B,GAAoC,YAAW;AAC7C,SAAOwuB,uBAAasgB,iBAApB;AACD,CAFD;;AAKA;;;;AAIA7F,gBAAgBnoC,SAAhB,CAA0BuqC,gBAA1B,GAA6C,UAASr7B,MAAT,EAAiB;AAC5D,SAAO,iDACL,KAAKqzB,eADA,EACiB,CADjB,EACoB,KAAK8M,KADzB,EACgC,KAAK/gB,MADrC,EAC6Cpf,MAD7C,CAAP;AAED,CAHD;;AAMA;;;;;;;AAOAi5B,gBAAgBnoC,SAAhB,CAA0B6qC,cAA1B,GAA2C,UAASnJ,WAAT,EAAsBmI,UAAtB,EAAkC;AAC3E,MAAI,CAACnI,WAAL,EAAkB;AAChB,SAAKsI,kBAAL,CAAwBU,yBAAeC,EAAvC,EAA2C,IAA3C,EAAiD,KAAK0E,KAAtD;AACD,GAFD,MAEO;AACL,SAAKzE,SAAL,CAAef,UAAf,EAA2BnI,WAA3B,EAAwC,CAAxC;AACA,QAAI,CAAC,KAAKa,eAAV,EAA2B;AACzB,WAAKA,eAAL,GAAuB,EAAvB;AACD;AACD,QAAMqN,OAAO,sCACX,KAAKrN,eADM,EACW,CADX,EACcb,WADd,EAC2B,KAAKpT,MADhC,EACwC,KAAK+gB,KAD7C,CAAb;AAEA,SAAK9M,eAAL,CAAqBx8C,MAArB,GAA8B6pD,KAAK7pD,MAAL,KAAgB,CAAhB,GAAoB,CAApB,GAAwB6pD,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAtD;AACA,SAAK4oB,OAAL;AACD;AACF,CAbD;;AAgBA;;;;;AAKAw5B,gBAAgBnoC,SAAhB,CAA0BgqC,kBAA1B,GAA+C,UAASC,MAAT,EAAiB1H,eAAjB,EAAkCqN,IAAlC,EAAwC;AACrF,OAAK9E,0BAAL,CAAgCb,MAAhC,EAAwC1H,eAAxC;AACA,OAAK8M,KAAL,GAAaO,IAAb;AACA,OAAKjhC,OAAL;AACD,CAJD;;AAOA;;;AAGAw5B,gBAAgBnoC,SAAhB,CAA0BmwC,cAA1B,GAA2C,UAASN,WAAT,EAAsB;AAC/D,MAAI5F,SAAS,KAAKmG,SAAL,EAAb;AACA,MAAM7N,kBAAkB,EAAxB;AACA,MAAMqN,OAAO,EAAb;AACA,OAAK,IAAI9pD,IAAI,CAAR,EAAWwkB,KAAKulC,YAAY9pD,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiD,EAAExkB,CAAnD,EAAsD;AACpD,QAAMyoD,aAAasB,YAAY/pD,CAAZ,CAAnB;AACA,QAAIA,MAAM,CAAV,EAAa;AACXmkD,eAASsE,WAAW6B,SAAX,EAAT;AACD;AACD,uBAAO7N,eAAP,EAAwBgM,WAAWxgB,kBAAX,EAAxB;AACA6hB,SAAK9nD,IAAL,CAAUy6C,gBAAgBx8C,MAA1B;AACD;AACD,OAAKikD,kBAAL,CAAwBC,MAAxB,EAAgC1H,eAAhC,EAAiDqN,IAAjD;AACD,CAbD;kBAcezH,e;;;;;;;;;;;;;;;;;;AC/Sf;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AAEA;;;;;;;;;;AAdA;;;AAwBA,IAAMC,aAAa,SAAbA,UAAa,CAAS1G,WAAT,EAAsBmI,UAAtB,EAAkC;AACnDpc,2BAAepsB,IAAf,CAAoB,IAApB;AACA,OAAKwpC,cAAL,CAAoBnJ,WAApB,EAAiCmI,UAAjC;AACD,CAHD;;AAKA,qBAASzB,UAAT,EAAqB3a,wBAArB;;AAGA;;;;;AAKA2a,WAAWpoC,SAAX,CAAqBqwC,WAArB,GAAmC,UAAS9E,KAAT,EAAgB;AACjD,MAAI,CAAC,KAAKhJ,eAAV,EAA2B;AACzB,SAAKA,eAAL,GAAuBgJ,MAAMxd,kBAAN,GAA2BpoC,KAA3B,EAAvB;AACD,GAFD,MAEO;AACL,uBAAO,KAAK48C,eAAZ,EAA6BgJ,MAAMxd,kBAAN,EAA7B;AACD;AACD,OAAKpf,OAAL;AACD,CAPD;;AAUA;;;;;;AAMAy5B,WAAWpoC,SAAX,CAAqBiO,KAArB,GAA6B,YAAW;AACtC,MAAMqiC,aAAa,IAAIlI,UAAJ,CAAe,IAAf,CAAnB;AACAkI,aAAWtG,kBAAX,CAA8B,KAAKC,MAAnC,EAA2C,KAAK1H,eAAL,CAAqB58C,KAArB,EAA3C;AACA,SAAO2qD,UAAP;AACD,CAJD;;AAOA;;;AAGAlI,WAAWpoC,SAAX,CAAqBkqC,cAArB,GAAsC,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD;AACrF,MAAIA,qBAAqB,sCAAyB,KAAK56B,SAAL,EAAzB,EAA2Ctf,CAA3C,EAA8C+N,CAA9C,CAAzB,EAA2E;AACzE,WAAOmsC,kBAAP;AACD;AACD,MAAM7H,kBAAkB,KAAKA,eAA7B;AACA,MAAMjU,SAAS,KAAKA,MAApB;AACA,OAAK,IAAIxoC,IAAI,CAAR,EAAWwkB,KAAKi4B,gBAAgBx8C,MAArC,EAA6CD,IAAIwkB,EAAjD,EAAqDxkB,KAAKwoC,MAA1D,EAAkE;AAChE,QAAM+J,kBAAkB,2BACtBnoC,CADsB,EACnB+N,CADmB,EAChBskC,gBAAgBz8C,CAAhB,CADgB,EACIy8C,gBAAgBz8C,IAAI,CAApB,CADJ,CAAxB;AAEA,QAAIuyC,kBAAkB+R,kBAAtB,EAA0C;AACxCA,2BAAqB/R,eAArB;AACA,WAAK,IAAIrpC,IAAI,CAAb,EAAgBA,IAAIs/B,MAApB,EAA4B,EAAEt/B,CAA9B,EAAiC;AAC/Bm7C,qBAAan7C,CAAb,IAAkBuzC,gBAAgBz8C,IAAIkJ,CAApB,CAAlB;AACD;AACDm7C,mBAAapkD,MAAb,GAAsBuoC,MAAtB;AACD;AACF;AACD,SAAO8b,kBAAP;AACD,CAlBD;;AAqBA;;;;;;AAMAhC,WAAWpoC,SAAX,CAAqByoC,cAArB,GAAsC,YAAW;AAC/C,SAAO,iCACL,KAAKlG,eADA,EACiB,CADjB,EACoB,KAAKA,eAAL,CAAqBx8C,MADzC,EACiD,KAAKuoC,MADtD,CAAP;AAED,CAHD;;AAMA;;;;;;AAMA8Z,WAAWpoC,SAAX,CAAqBuwC,QAArB,GAAgC,UAASpmD,KAAT,EAAgB;AAC9C,MAAMiG,IAAI,CAAC,KAAKmyC,eAAN,GAAwB,CAAxB,GAA4B,KAAKA,eAAL,CAAqBx8C,MAArB,GAA8B,KAAKuoC,MAAzE;AACA,MAAInkC,QAAQ,CAAR,IAAaiG,KAAKjG,KAAtB,EAA6B;AAC3B,WAAO,IAAP;AACD;AACD,MAAMohD,QAAQ,IAAItD,eAAJ,CAAU,IAAV,CAAd;AACAsD,QAAMvB,kBAAN,CAAyB,KAAKC,MAA9B,EAAsC,KAAK1H,eAAL,CAAqB58C,KAArB,CACpCwE,QAAQ,KAAKmkC,MADuB,EACf,CAACnkC,QAAQ,CAAT,IAAc,KAAKmkC,MADJ,CAAtC;AAEA,SAAOid,KAAP;AACD,CATD;;AAYA;;;;;AAKAnD,WAAWpoC,SAAX,CAAqBwwC,SAArB,GAAiC,YAAW;AAC1C,MAAMjO,kBAAkB,KAAKA,eAA7B;AACA,MAAM0H,SAAS,KAAKA,MAApB;AACA,MAAM3b,SAAS,KAAKA,MAApB;AACA;AACA,MAAMmiB,SAAS,EAAf;AACA,OAAK,IAAI3qD,IAAI,CAAR,EAAWwkB,KAAKi4B,gBAAgBx8C,MAArC,EAA6CD,IAAIwkB,EAAjD,EAAqDxkB,KAAKwoC,MAA1D,EAAkE;AAChE,QAAMid,QAAQ,IAAItD,eAAJ,CAAU,IAAV,CAAd;AACAsD,UAAMvB,kBAAN,CAAyBC,MAAzB,EAAiC1H,gBAAgB58C,KAAhB,CAAsBG,CAAtB,EAAyBA,IAAIwoC,MAA7B,CAAjC;AACAmiB,WAAO3oD,IAAP,CAAYyjD,KAAZ;AACD;AACD,SAAOkF,MAAP;AACD,CAZD;;AAeA;;;;AAIArI,WAAWpoC,SAAX,CAAqBd,OAArB,GAA+B,YAAW;AACxC,SAAOwuB,uBAAaqgB,WAApB;AACD,CAFD;;AAKA;;;;AAIA3F,WAAWpoC,SAAX,CAAqBuqC,gBAArB,GAAwC,UAASr7B,MAAT,EAAiB;AACvD,MAAMqzB,kBAAkB,KAAKA,eAA7B;AACA,MAAMjU,SAAS,KAAKA,MAApB;AACA,OAAK,IAAIxoC,IAAI,CAAR,EAAWwkB,KAAKi4B,gBAAgBx8C,MAArC,EAA6CD,IAAIwkB,EAAjD,EAAqDxkB,KAAKwoC,MAA1D,EAAkE;AAChE,QAAMp+B,IAAIqyC,gBAAgBz8C,CAAhB,CAAV;AACA,QAAMmY,IAAIskC,gBAAgBz8C,IAAI,CAApB,CAAV;AACA,QAAI,wBAAWopB,MAAX,EAAmBhf,CAAnB,EAAsB+N,CAAtB,CAAJ,EAA8B;AAC5B,aAAO,IAAP;AACD;AACF;AACD,SAAO,KAAP;AACD,CAXD;;AAcA;;;;;;;AAOAmqC,WAAWpoC,SAAX,CAAqB6qC,cAArB,GAAsC,UAASnJ,WAAT,EAAsBmI,UAAtB,EAAkC;AACtE,MAAI,CAACnI,WAAL,EAAkB;AAChB,SAAKsI,kBAAL,CAAwBU,yBAAeC,EAAvC,EAA2C,IAA3C;AACD,GAFD,MAEO;AACL,SAAKC,SAAL,CAAef,UAAf,EAA2BnI,WAA3B,EAAwC,CAAxC;AACA,QAAI,CAAC,KAAKa,eAAV,EAA2B;AACzB,WAAKA,eAAL,GAAuB,EAAvB;AACD;AACD,SAAKA,eAAL,CAAqBx8C,MAArB,GAA8B,iCAC5B,KAAKw8C,eADuB,EACN,CADM,EACHb,WADG,EACU,KAAKpT,MADf,CAA9B;AAEA,SAAK3f,OAAL;AACD;AACF,CAZD;;AAeA;;;;AAIAy5B,WAAWpoC,SAAX,CAAqBgqC,kBAArB,GAA0C,UAASC,MAAT,EAAiB1H,eAAjB,EAAkC;AAC1E,OAAKuI,0BAAL,CAAgCb,MAAhC,EAAwC1H,eAAxC;AACA,OAAK5zB,OAAL;AACD,CAHD;kBAIey5B,U;;;;;;;;;;;;;;;;;;AC5Lf;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA;;;;;;;;;;AAtBA;;;AAgCA,IAAMC,eAAe,SAAfA,YAAe,CAAS3G,WAAT,EAAsBmI,UAAtB,EAAkC;;AAErDpc,2BAAepsB,IAAf,CAAoB,IAApB;;AAEA;;;;AAIA,OAAKqvC,MAAL,GAAc,EAAd;;AAEA;;;;AAIA,OAAKC,2BAAL,GAAmC,CAAC,CAApC;;AAEA;;;;AAIA,OAAKC,mBAAL,GAA2B,IAA3B;;AAEA;;;;AAIA,OAAKxC,SAAL,GAAiB,CAAC,CAAlB;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,CAAC,CAA1B;;AAEA;;;;AAIA,OAAKwC,iBAAL,GAAyB,CAAC,CAA1B;;AAEA;;;;AAIA,OAAKC,wBAAL,GAAgC,IAAhC;;AAEA,OAAKjG,cAAL,CAAoBnJ,WAApB,EAAiCmI,UAAjC;AAED,CAhDD;;AAkDA,qBAASxB,YAAT,EAAuB5a,wBAAvB;;AAGA;;;;;AAKA4a,aAAaroC,SAAb,CAAuB+wC,aAAvB,GAAuC,UAASC,OAAT,EAAkB;AACvD;AACA,MAAIpB,aAAJ;AACA,MAAI,CAAC,KAAKrN,eAAV,EAA2B;AACzB,SAAKA,eAAL,GAAuByO,QAAQjjB,kBAAR,GAA6BpoC,KAA7B,EAAvB;AACAiqD,WAAOoB,QAAQvB,OAAR,GAAkB9pD,KAAlB,EAAP;AACA,SAAK+qD,MAAL,CAAY5oD,IAAZ;AACD,GAJD,MAIO;AACL,QAAMslC,SAAS,KAAKmV,eAAL,CAAqBx8C,MAApC;AACA,uBAAO,KAAKw8C,eAAZ,EAA6ByO,QAAQjjB,kBAAR,EAA7B;AACA6hB,WAAOoB,QAAQvB,OAAR,GAAkB9pD,KAAlB,EAAP;AACA,SAAK,IAAIG,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C8pD,WAAK9pD,CAAL,KAAWsnC,MAAX;AACD;AACF;AACD,OAAKsjB,MAAL,CAAY5oD,IAAZ,CAAiB8nD,IAAjB;AACA,OAAKjhC,OAAL;AACD,CAjBD;;AAoBA;;;;;;AAMA05B,aAAaroC,SAAb,CAAuBiO,KAAvB,GAA+B,YAAW;AACxC,MAAMgjC,eAAe,IAAI5I,YAAJ,CAAiB,IAAjB,CAArB;;AAEA,MAAM7nC,MAAM,KAAKkwC,MAAL,CAAY3qD,MAAxB;AACA,MAAMmrD,WAAW,IAAI/pD,KAAJ,CAAUqZ,GAAV,CAAjB;AACA,OAAK,IAAI1a,IAAI,CAAb,EAAgBA,IAAI0a,GAApB,EAAyB,EAAE1a,CAA3B,EAA8B;AAC5BorD,aAASprD,CAAT,IAAc,KAAK4qD,MAAL,CAAY5qD,CAAZ,EAAeH,KAAf,EAAd;AACD;;AAEDsrD,eAAajH,kBAAb,CACE,KAAKC,MADP,EACe,KAAK1H,eAAL,CAAqB58C,KAArB,EADf,EAC6CurD,QAD7C;AAEA,SAAOD,YAAP;AACD,CAZD;;AAeA;;;AAGA5I,aAAaroC,SAAb,CAAuBkqC,cAAvB,GAAwC,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD;AACvF,MAAIA,qBAAqB,sCAAyB,KAAK56B,SAAL,EAAzB,EAA2Ctf,CAA3C,EAA8C+N,CAA9C,CAAzB,EAA2E;AACzE,WAAOmsC,kBAAP;AACD;AACD,MAAI,KAAKiE,iBAAL,IAA0B,KAAK71B,WAAL,EAA9B,EAAkD;AAChD,SAAK41B,SAAL,GAAiBvkD,KAAKsG,IAAL,CAAU,wCACzB,KAAKoyC,eADoB,EACH,CADG,EACA,KAAKmO,MADL,EACa,KAAKpiB,MADlB,EAC0B,CAD1B,CAAV,CAAjB;AAEA,SAAK+f,iBAAL,GAAyB,KAAK71B,WAAL,EAAzB;AACD;AACD,SAAO,2CACL,KAAK24B,0BAAL,EADK,EAC8B,CAD9B,EACiC,KAAKT,MADtC,EAC8C,KAAKpiB,MADnD,EAEL,KAAK8f,SAFA,EAEW,IAFX,EAEiBl+C,CAFjB,EAEoB+N,CAFpB,EAEuBksC,YAFvB,EAEqCC,kBAFrC,CAAP;AAGD,CAZD;;AAeA;;;AAGA/B,aAAaroC,SAAb,CAAuBomB,UAAvB,GAAoC,UAASl2B,CAAT,EAAY+N,CAAZ,EAAe;AACjD,SAAO,sCAAuB,KAAKkzC,0BAAL,EAAvB,EAA0D,CAA1D,EAA6D,KAAKT,MAAlE,EAA0E,KAAKpiB,MAA/E,EAAuFp+B,CAAvF,EAA0F+N,CAA1F,CAAP;AACD,CAFD;;AAKA;;;;;AAKAoqC,aAAaroC,SAAb,CAAuB2gC,OAAvB,GAAiC,YAAW;AAC1C,SAAO,wBAAiB,KAAKwQ,0BAAL,EAAjB,EAAoD,CAApD,EAAuD,KAAKT,MAA5D,EAAoE,KAAKpiB,MAAzE,CAAP;AACD,CAFD;;AAKA;;;;;;;;;;;;;;AAcA+Z,aAAaroC,SAAb,CAAuByoC,cAAvB,GAAwC,UAAS2I,SAAT,EAAoB;AAC1D,MAAI7O,wBAAJ;AACA,MAAI6O,cAAc1qD,SAAlB,EAA6B;AAC3B67C,sBAAkB,KAAK4O,0BAAL,GAAkCxrD,KAAlC,EAAlB;AACA,wCACE48C,eADF,EACmB,CADnB,EACsB,KAAKmO,MAD3B,EACmC,KAAKpiB,MADxC,EACgD8iB,SADhD;AAED,GAJD,MAIO;AACL7O,sBAAkB,KAAKA,eAAvB;AACD;;AAED,SAAO,2CACLA,eADK,EACY,CADZ,EACe,KAAKmO,MADpB,EAC4B,KAAKpiB,MADjC,CAAP;AAED,CAZD;;AAeA;;;AAGA+Z,aAAaroC,SAAb,CAAuBqxC,QAAvB,GAAkC,YAAW;AAC3C,SAAO,KAAKX,MAAZ;AACD,CAFD;;AAKA;;;AAGArI,aAAaroC,SAAb,CAAuBsxC,qBAAvB,GAA+C,YAAW;AACxD,MAAI,KAAKX,2BAAL,IAAoC,KAAKn4B,WAAL,EAAxC,EAA4D;AAC1D,QAAM+4B,cAAc,0BAClB,KAAKhP,eADa,EACI,CADJ,EACO,KAAKmO,MADZ,EACoB,KAAKpiB,MADzB,CAApB;AAEA,SAAKsiB,mBAAL,GAA2B,kDACzB,KAAKO,0BAAL,EADyB,EACU,CADV,EACa,KAAKT,MADlB,EAC0B,KAAKpiB,MAD/B,EAEzBijB,WAFyB,CAA3B;AAGA,SAAKZ,2BAAL,GAAmC,KAAKn4B,WAAL,EAAnC;AACD;AACD,SAAO,KAAKo4B,mBAAZ;AACD,CAVD;;AAaA;;;;;;AAMAvI,aAAaroC,SAAb,CAAuBwxC,iBAAvB,GAA2C,YAAW;AACpD,MAAMC,iBAAiB,IAAIrJ,oBAAJ,CAAe,IAAf,CAAvB;AACAqJ,iBAAezH,kBAAf,CAAkCU,yBAAe+C,GAAjD,EACE,KAAK6D,qBAAL,GAA6B3rD,KAA7B,EADF;AAEA,SAAO8rD,cAAP;AACD,CALD;;AAQA;;;AAGApJ,aAAaroC,SAAb,CAAuBmxC,0BAAvB,GAAoD,YAAW;AAC7D,MAAI,KAAKN,iBAAL,IAA0B,KAAKr4B,WAAL,EAA9B,EAAkD;AAChD,QAAM+pB,kBAAkB,KAAKA,eAA7B;AACA,QAAI,oCACFA,eADE,EACe,CADf,EACkB,KAAKmO,MADvB,EAC+B,KAAKpiB,MADpC,CAAJ,EACiD;AAC/C,WAAKwiB,wBAAL,GAAgCvO,eAAhC;AACD,KAHD,MAGO;AACL,WAAKuO,wBAAL,GAAgCvO,gBAAgB58C,KAAhB,EAAhC;AACA,WAAKmrD,wBAAL,CAA8B/qD,MAA9B,GACI,oCACE,KAAK+qD,wBADP,EACiC,CADjC,EACoC,KAAKJ,MADzC,EACiD,KAAKpiB,MADtD,CADJ;AAGD;AACD,SAAKuiB,iBAAL,GAAyB,KAAKr4B,WAAL,EAAzB;AACD;AACD,SAAO,KAAKs4B,wBAAZ;AACD,CAfD;;AAkBA;;;AAGAzI,aAAaroC,SAAb,CAAuB+uC,6BAAvB,GAAuD,UAAShD,gBAAT,EAA2B;AAChF,MAAMiD,4BAA4B,EAAlC;AACA,MAAM0C,kBAAkB,EAAxB;AACA1C,4BAA0BjpD,MAA1B,GAAmC,kCACjC,KAAKw8C,eAD4B,EACX,CADW,EACR,KAAKmO,MADG,EACK,KAAKpiB,MADV,EAEjCzkC,KAAKsG,IAAL,CAAU47C,gBAAV,CAFiC,EAGjCiD,yBAHiC,EAGN,CAHM,EAGH0C,eAHG,CAAnC;AAIA,MAAMC,yBAAyB,IAAItJ,YAAJ,CAAiB,IAAjB,CAA/B;AACAsJ,yBAAuB3H,kBAAvB,CACEU,yBAAeC,EADjB,EACqBqE,yBADrB,EACgD0C,eADhD;AAEA,SAAOC,sBAAP;AACD,CAXD;;AAcA;;;;;;AAMAtJ,aAAaroC,SAAb,CAAuB4xC,UAAvB,GAAoC,UAASznD,KAAT,EAAgB;AAClD,MAAIA,QAAQ,CAAR,IAAa,KAAKumD,MAAL,CAAY3qD,MAAZ,IAAsBoE,KAAvC,EAA8C;AAC5C,WAAO,IAAP;AACD;AACD,MAAIijC,eAAJ;AACA,MAAIjjC,UAAU,CAAd,EAAiB;AACfijC,aAAS,CAAT;AACD,GAFD,MAEO;AACL,QAAMykB,WAAW,KAAKnB,MAAL,CAAYvmD,QAAQ,CAApB,CAAjB;AACAijC,aAASykB,SAASA,SAAS9rD,MAAT,GAAkB,CAA3B,CAAT;AACD;AACD,MAAM6pD,OAAO,KAAKc,MAAL,CAAYvmD,KAAZ,EAAmBxE,KAAnB,EAAb;AACA,MAAM8rB,MAAMm+B,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAZ;AACA,MAAIqnC,WAAW,CAAf,EAAkB;AAChB,SAAK,IAAItnC,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C8pD,WAAK9pD,CAAL,KAAWsnC,MAAX;AACD;AACF;AACD,MAAM4jB,UAAU,IAAI1I,iBAAJ,CAAY,IAAZ,CAAhB;AACA0I,UAAQhH,kBAAR,CACE,KAAKC,MADP,EACe,KAAK1H,eAAL,CAAqB58C,KAArB,CAA2BynC,MAA3B,EAAmC3b,GAAnC,CADf,EACwDm+B,IADxD;AAEA,SAAOoB,OAAP;AACD,CAtBD;;AAyBA;;;;;AAKA3I,aAAaroC,SAAb,CAAuB8xC,WAAvB,GAAqC,YAAW;AAC9C,MAAM7H,SAAS,KAAKA,MAApB;AACA,MAAM1H,kBAAkB,KAAKA,eAA7B;AACA,MAAMwP,QAAQ,KAAKrB,MAAnB;AACA,MAAMsB,WAAW,EAAjB;AACA,MAAI5kB,SAAS,CAAb;AACA,OAAK,IAAItnC,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,EAASH,KAAT,EAAb;AACA,QAAM8rB,MAAMm+B,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAZ;AACA,QAAIqnC,WAAW,CAAf,EAAkB;AAChB,WAAK,IAAIp+B,IAAI,CAAR,EAAW27B,KAAKilB,KAAK7pD,MAA1B,EAAkCiJ,IAAI27B,EAAtC,EAA0C,EAAE37B,CAA5C,EAA+C;AAC7C4gD,aAAK5gD,CAAL,KAAWo+B,MAAX;AACD;AACF;AACD,QAAM4jB,UAAU,IAAI1I,iBAAJ,CAAY,IAAZ,CAAhB;AACA0I,YAAQhH,kBAAR,CACEC,MADF,EACU1H,gBAAgB58C,KAAhB,CAAsBynC,MAAtB,EAA8B3b,GAA9B,CADV,EAC8Cm+B,IAD9C;AAEAoC,aAASlqD,IAAT,CAAckpD,OAAd;AACA5jB,aAAS3b,GAAT;AACD;AACD,SAAOugC,QAAP;AACD,CArBD;;AAwBA;;;;AAIA3J,aAAaroC,SAAb,CAAuBd,OAAvB,GAAiC,YAAW;AAC1C,SAAOwuB,uBAAaugB,aAApB;AACD,CAFD;;AAKA;;;;AAIA5F,aAAaroC,SAAb,CAAuBuqC,gBAAvB,GAA0C,UAASr7B,MAAT,EAAiB;AACzD,SAAO,sDACL,KAAKiiC,0BAAL,EADK,EAC8B,CAD9B,EACiC,KAAKT,MADtC,EAC8C,KAAKpiB,MADnD,EAC2Dpf,MAD3D,CAAP;AAED,CAHD;;AAMA;;;;;;;AAOAm5B,aAAaroC,SAAb,CAAuB6qC,cAAvB,GAAwC,UAASnJ,WAAT,EAAsBmI,UAAtB,EAAkC;AACxE,MAAI,CAACnI,WAAL,EAAkB;AAChB,SAAKsI,kBAAL,CAAwBU,yBAAeC,EAAvC,EAA2C,IAA3C,EAAiD,KAAK+F,MAAtD;AACD,GAFD,MAEO;AACL,SAAK9F,SAAL,CAAef,UAAf,EAA2BnI,WAA3B,EAAwC,CAAxC;AACA,QAAI,CAAC,KAAKa,eAAV,EAA2B;AACzB,WAAKA,eAAL,GAAuB,EAAvB;AACD;AACD,QAAMwP,QAAQ,2CACZ,KAAKxP,eADO,EACU,CADV,EACab,WADb,EAC0B,KAAKpT,MAD/B,EACuC,KAAKoiB,MAD5C,CAAd;AAEA,QAAIqB,MAAMhsD,MAAN,KAAiB,CAArB,EAAwB;AACtB,WAAKw8C,eAAL,CAAqBx8C,MAArB,GAA8B,CAA9B;AACD,KAFD,MAEO;AACL,UAAMksD,WAAWF,MAAMA,MAAMhsD,MAAN,GAAe,CAArB,CAAjB;AACA,WAAKw8C,eAAL,CAAqBx8C,MAArB,GAA8BksD,SAASlsD,MAAT,KAAoB,CAApB,GAC5B,CAD4B,GACxBksD,SAASA,SAASlsD,MAAT,GAAkB,CAA3B,CADN;AAED;AACD,SAAK4oB,OAAL;AACD;AACF,CAnBD;;AAsBA;;;;;AAKA05B,aAAaroC,SAAb,CAAuBgqC,kBAAvB,GAA4C,UAASC,MAAT,EAAiB1H,eAAjB,EAAkCwP,KAAlC,EAAyC;AACnF,OAAKjH,0BAAL,CAAgCb,MAAhC,EAAwC1H,eAAxC;AACA,OAAKmO,MAAL,GAAcqB,KAAd;AACA,OAAKpjC,OAAL;AACD,CAJD;;AAOA;;;AAGA05B,aAAaroC,SAAb,CAAuBkyC,WAAvB,GAAqC,UAASF,QAAT,EAAmB;AACtD,MAAI/H,SAAS,KAAKmG,SAAL,EAAb;AACA,MAAM7N,kBAAkB,EAAxB;AACA,MAAMwP,QAAQ,EAAd;AACA,OAAK,IAAIjsD,IAAI,CAAR,EAAWwkB,KAAK0nC,SAASjsD,MAA9B,EAAsCD,IAAIwkB,EAA1C,EAA8C,EAAExkB,CAAhD,EAAmD;AACjD,QAAMkrD,UAAUgB,SAASlsD,CAAT,CAAhB;AACA,QAAIA,MAAM,CAAV,EAAa;AACXmkD,eAAS+G,QAAQZ,SAAR,EAAT;AACD;AACD,QAAMhjB,SAASmV,gBAAgBx8C,MAA/B;AACA,QAAM6pD,OAAOoB,QAAQvB,OAAR,EAAb;AACA,SAAK,IAAIzgD,IAAI,CAAR,EAAW27B,KAAKilB,KAAK7pD,MAA1B,EAAkCiJ,IAAI27B,EAAtC,EAA0C,EAAE37B,CAA5C,EAA+C;AAC7C4gD,WAAK5gD,CAAL,KAAWo+B,MAAX;AACD;AACD,uBAAOmV,eAAP,EAAwByO,QAAQjjB,kBAAR,EAAxB;AACAgkB,UAAMjqD,IAAN,CAAW8nD,IAAX;AACD;AACD,OAAK5F,kBAAL,CAAwBC,MAAxB,EAAgC1H,eAAhC,EAAiDwP,KAAjD;AACD,CAlBD;;kBAoBe1J,Y;;;;;;;;;;;;;;;;;;AC5Zf;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAEA;;;;;;;;;;AAUA,IAAMJ,QAAQ,SAARA,KAAQ,CAASvG,WAAT,EAAsBmI,UAAtB,EAAkC;AAC9Cpc,2BAAepsB,IAAf,CAAoB,IAApB;AACA,OAAKwpC,cAAL,CAAoBnJ,WAApB,EAAiCmI,UAAjC;AACD,CAHD,C,CArBA;;;;;AA0BA,qBAAS5B,KAAT,EAAgBxa,wBAAhB;;AAGA;;;;;;AAMAwa,MAAMjoC,SAAN,CAAgBiO,KAAhB,GAAwB,YAAW;AACjC,MAAMs9B,QAAQ,IAAItD,KAAJ,CAAU,IAAV,CAAd;AACAsD,QAAMvB,kBAAN,CAAyB,KAAKC,MAA9B,EAAsC,KAAK1H,eAAL,CAAqB58C,KAArB,EAAtC;AACA,SAAO4lD,KAAP;AACD,CAJD;;AAOA;;;AAGAtD,MAAMjoC,SAAN,CAAgBkqC,cAAhB,GAAiC,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD;AAChF,MAAM7H,kBAAkB,KAAKA,eAA7B;AACA,MAAMlK,kBAAkB,2BAAUnoC,CAAV,EAAa+N,CAAb,EAAgBskC,gBAAgB,CAAhB,CAAhB,EAAoCA,gBAAgB,CAAhB,CAApC,CAAxB;AACA,MAAIlK,kBAAkB+R,kBAAtB,EAA0C;AACxC,QAAM9b,SAAS,KAAKA,MAApB;AACA,SAAK,IAAIxoC,IAAI,CAAb,EAAgBA,IAAIwoC,MAApB,EAA4B,EAAExoC,CAA9B,EAAiC;AAC/BqkD,mBAAarkD,CAAb,IAAkBy8C,gBAAgBz8C,CAAhB,CAAlB;AACD;AACDqkD,iBAAapkD,MAAb,GAAsBuoC,MAAtB;AACA,WAAO+J,eAAP;AACD,GAPD,MAOO;AACL,WAAO+R,kBAAP;AACD;AACF,CAbD;;AAgBA;;;;;;AAMAnC,MAAMjoC,SAAN,CAAgByoC,cAAhB,GAAiC,YAAW;AAC1C,SAAO,CAAC,KAAKlG,eAAN,GAAwB,EAAxB,GAA6B,KAAKA,eAAL,CAAqB58C,KAArB,EAApC;AACD,CAFD;;AAKA;;;AAGAsiD,MAAMjoC,SAAN,CAAgBsqC,aAAhB,GAAgC,UAASp7B,MAAT,EAAiB;AAC/C,SAAO,0CAA6B,KAAKqzB,eAAlC,EAAmDrzB,MAAnD,CAAP;AACD,CAFD;;AAKA;;;;AAIA+4B,MAAMjoC,SAAN,CAAgBd,OAAhB,GAA0B,YAAW;AACnC,SAAOwuB,uBAAaigB,KAApB;AACD,CAFD;;AAKA;;;;AAIA1F,MAAMjoC,SAAN,CAAgBuqC,gBAAhB,GAAmC,UAASr7B,MAAT,EAAiB;AAClD,SAAO,wBAAWA,MAAX,EAAmB,KAAKqzB,eAAL,CAAqB,CAArB,CAAnB,EAA4C,KAAKA,eAAL,CAAqB,CAArB,CAA5C,CAAP;AACD,CAFD;;AAKA;;;;AAIA0F,MAAMjoC,SAAN,CAAgB6qC,cAAhB,GAAiC,UAASnJ,WAAT,EAAsBmI,UAAtB,EAAkC;AACjE,MAAI,CAACnI,WAAL,EAAkB;AAChB,SAAKsI,kBAAL,CAAwBU,yBAAeC,EAAvC,EAA2C,IAA3C;AACD,GAFD,MAEO;AACL,SAAKC,SAAL,CAAef,UAAf,EAA2BnI,WAA3B,EAAwC,CAAxC;AACA,QAAI,CAAC,KAAKa,eAAV,EAA2B;AACzB,WAAKA,eAAL,GAAuB,EAAvB;AACD;AACD,SAAKA,eAAL,CAAqBx8C,MAArB,GAA8B,gCAC5B,KAAKw8C,eADuB,EACN,CADM,EACHb,WADG,EACU,KAAKpT,MADf,CAA9B;AAEA,SAAK3f,OAAL;AACD;AACF,CAZD;;AAeA;;;;AAIAs5B,MAAMjoC,SAAN,CAAgBgqC,kBAAhB,GAAqC,UAASC,MAAT,EAAiB1H,eAAjB,EAAkC;AACrE,OAAKuI,0BAAL,CAAgCb,MAAhC,EAAwC1H,eAAxC;AACA,OAAK5zB,OAAL;AACD,CAHD;kBAIes5B,K;;;;;;;;;;;;;;;;;QCgQCkK,Q,GAAAA,Q;QAoBAC,U,GAAAA,U;QAuBAC,U,GAAAA,U;QAyBAC,W,GAAAA,W;;AA9bhB;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA;;;;;;;;;;;;;;;AAeA,IAAMhK,UAAU,SAAVA,OAAU,CAAS5G,WAAT,EAAsBmI,UAAtB,EAAkC;;AAEhDpc,2BAAepsB,IAAf,CAAoB,IAApB;;AAEA;;;;AAIA,OAAKguC,KAAL,GAAa,EAAb;;AAEA;;;;AAIA,OAAKkD,0BAAL,GAAkC,CAAC,CAAnC;;AAEA;;;;AAIA,OAAKC,kBAAL,GAA0B,IAA1B;;AAEA;;;;AAIA,OAAKpE,SAAL,GAAiB,CAAC,CAAlB;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,CAAC,CAA1B;;AAEA;;;;AAIA,OAAKwC,iBAAL,GAAyB,CAAC,CAA1B;;AAEA;;;;AAIA,OAAKC,wBAAL,GAAgC,IAAhC;;AAEA,OAAKjG,cAAL,CAAoBnJ,WAApB,EAAiCmI,UAAjC;AAED,CAhDD,C,CAtCA;;;;;AAwFA,qBAASvB,OAAT,EAAkB7a,wBAAlB;;AAGA;;;;;AAKA6a,QAAQtoC,SAAR,CAAkByyC,gBAAlB,GAAqC,UAAStD,UAAT,EAAqB;AACxD,MAAI,CAAC,KAAK5M,eAAV,EAA2B;AACzB,SAAKA,eAAL,GAAuB4M,WAAWphB,kBAAX,GAAgCpoC,KAAhC,EAAvB;AACD,GAFD,MAEO;AACL,uBAAO,KAAK48C,eAAZ,EAA6B4M,WAAWphB,kBAAX,EAA7B;AACD;AACD,OAAKshB,KAAL,CAAWvnD,IAAX,CAAgB,KAAKy6C,eAAL,CAAqBx8C,MAArC;AACA,OAAK4oB,OAAL;AACD,CARD;;AAWA;;;;;;AAMA25B,QAAQtoC,SAAR,CAAkBiO,KAAlB,GAA0B,YAAW;AACnC,MAAM+iC,UAAU,IAAI1I,OAAJ,CAAY,IAAZ,CAAhB;AACA0I,UAAQhH,kBAAR,CACE,KAAKC,MADP,EACe,KAAK1H,eAAL,CAAqB58C,KAArB,EADf,EAC6C,KAAK0pD,KAAL,CAAW1pD,KAAX,EAD7C;AAEA,SAAOqrD,OAAP;AACD,CALD;;AAQA;;;AAGA1I,QAAQtoC,SAAR,CAAkBkqC,cAAlB,GAAmC,UAASh6C,CAAT,EAAY+N,CAAZ,EAAeksC,YAAf,EAA6BC,kBAA7B,EAAiD;AAClF,MAAIA,qBAAqB,sCAAyB,KAAK56B,SAAL,EAAzB,EAA2Ctf,CAA3C,EAA8C+N,CAA9C,CAAzB,EAA2E;AACzE,WAAOmsC,kBAAP;AACD;AACD,MAAI,KAAKiE,iBAAL,IAA0B,KAAK71B,WAAL,EAA9B,EAAkD;AAChD,SAAK41B,SAAL,GAAiBvkD,KAAKsG,IAAL,CAAU,mCACzB,KAAKoyC,eADoB,EACH,CADG,EACA,KAAK8M,KADL,EACY,KAAK/gB,MADjB,EACyB,CADzB,CAAV,CAAjB;AAEA,SAAK+f,iBAAL,GAAyB,KAAK71B,WAAL,EAAzB;AACD;AACD,SAAO,sCACL,KAAK+pB,eADA,EACiB,CADjB,EACoB,KAAK8M,KADzB,EACgC,KAAK/gB,MADrC,EAEL,KAAK8f,SAFA,EAEW,IAFX,EAEiBl+C,CAFjB,EAEoB+N,CAFpB,EAEuBksC,YAFvB,EAEqCC,kBAFrC,CAAP;AAGD,CAZD;;AAeA;;;AAGA9B,QAAQtoC,SAAR,CAAkBomB,UAAlB,GAA+B,UAASl2B,CAAT,EAAY+N,CAAZ,EAAe;AAC5C,SAAO,qCAAsB,KAAKkzC,0BAAL,EAAtB,EAAyD,CAAzD,EAA4D,KAAK9B,KAAjE,EAAwE,KAAK/gB,MAA7E,EAAqFp+B,CAArF,EAAwF+N,CAAxF,CAAP;AACD,CAFD;;AAKA;;;;;AAKAqqC,QAAQtoC,SAAR,CAAkB2gC,OAAlB,GAA4B,YAAW;AACrC,SAAO,uBAAgB,KAAKwQ,0BAAL,EAAhB,EAAmD,CAAnD,EAAsD,KAAK9B,KAA3D,EAAkE,KAAK/gB,MAAvE,CAAP;AACD,CAFD;;AAKA;;;;;;;;;;;;;;AAcAga,QAAQtoC,SAAR,CAAkByoC,cAAlB,GAAmC,UAAS2I,SAAT,EAAoB;AACrD,MAAI7O,wBAAJ;AACA,MAAI6O,cAAc1qD,SAAlB,EAA6B;AAC3B67C,sBAAkB,KAAK4O,0BAAL,GAAkCxrD,KAAlC,EAAlB;AACA,mCACE48C,eADF,EACmB,CADnB,EACsB,KAAK8M,KAD3B,EACkC,KAAK/gB,MADvC,EAC+C8iB,SAD/C;AAED,GAJD,MAIO;AACL7O,sBAAkB,KAAKA,eAAvB;AACD;;AAED,SAAO,sCACLA,eADK,EACY,CADZ,EACe,KAAK8M,KADpB,EAC2B,KAAK/gB,MADhC,CAAP;AAED,CAZD;;AAeA;;;AAGAga,QAAQtoC,SAAR,CAAkByvC,OAAlB,GAA4B,YAAW;AACrC,SAAO,KAAKJ,KAAZ;AACD,CAFD;;AAKA;;;AAGA/G,QAAQtoC,SAAR,CAAkB0yC,oBAAlB,GAAyC,YAAW;AAClD,MAAI,KAAKH,0BAAL,IAAmC,KAAK/5B,WAAL,EAAvC,EAA2D;AACzD,QAAMm6B,aAAa,uBAAU,KAAKnjC,SAAL,EAAV,CAAnB;AACA,SAAKgjC,kBAAL,GAA0B,4CACxB,KAAKrB,0BAAL,EADwB,EACW,CADX,EACc,KAAK9B,KADnB,EAC0B,KAAK/gB,MAD/B,EAExBqkB,UAFwB,EAEZ,CAFY,CAA1B;AAGA,SAAKJ,0BAAL,GAAkC,KAAK/5B,WAAL,EAAlC;AACD;AACD,SAAO,KAAKg6B,kBAAZ;AACD,CATD;;AAYA;;;;;;AAMAlK,QAAQtoC,SAAR,CAAkB4yC,gBAAlB,GAAqC,YAAW;AAC9C,SAAO,IAAI3K,eAAJ,CAAU,KAAKyK,oBAAL,EAAV,EAAuChI,yBAAe+C,GAAtD,CAAP;AACD,CAFD;;AAKA;;;;;;;AAOAnF,QAAQtoC,SAAR,CAAkB6yC,kBAAlB,GAAuC,YAAW;AAChD,SAAO,KAAKxD,KAAL,CAAWtpD,MAAlB;AACD,CAFD;;AAKA;;;;;;;;;;AAUAuiD,QAAQtoC,SAAR,CAAkB8yC,aAAlB,GAAkC,UAAS3oD,KAAT,EAAgB;AAChD,MAAIA,QAAQ,CAAR,IAAa,KAAKklD,KAAL,CAAWtpD,MAAX,IAAqBoE,KAAtC,EAA6C;AAC3C,WAAO,IAAP;AACD;AACD,MAAMglD,aAAa,IAAID,oBAAJ,CAAe,IAAf,CAAnB;AACAC,aAAWnF,kBAAX,CAA8B,KAAKC,MAAnC,EAA2C,KAAK1H,eAAL,CAAqB58C,KAArB,CACzCwE,UAAU,CAAV,GAAc,CAAd,GAAkB,KAAKklD,KAAL,CAAWllD,QAAQ,CAAnB,CADuB,EACA,KAAKklD,KAAL,CAAWllD,KAAX,CADA,CAA3C;AAEA,SAAOglD,UAAP;AACD,CARD;;AAWA;;;;;AAKA7G,QAAQtoC,SAAR,CAAkB+yC,cAAlB,GAAmC,YAAW;AAC5C,MAAM9I,SAAS,KAAKA,MAApB;AACA,MAAM1H,kBAAkB,KAAKA,eAA7B;AACA,MAAMqN,OAAO,KAAKP,KAAlB;AACA,MAAM2D,cAAc,EAApB;AACA,MAAI5lB,SAAS,CAAb;AACA,OAAK,IAAItnC,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACA,QAAMqpD,aAAa,IAAID,oBAAJ,CAAe,IAAf,CAAnB;AACAC,eAAWnF,kBAAX,CAA8BC,MAA9B,EAAsC1H,gBAAgB58C,KAAhB,CAAsBynC,MAAtB,EAA8B3b,GAA9B,CAAtC;AACAuhC,gBAAYlrD,IAAZ,CAAiBqnD,UAAjB;AACA/hB,aAAS3b,GAAT;AACD;AACD,SAAOuhC,WAAP;AACD,CAdD;;AAiBA;;;AAGA1K,QAAQtoC,SAAR,CAAkBmxC,0BAAlB,GAA+C,YAAW;AACxD,MAAI,KAAKN,iBAAL,IAA0B,KAAKr4B,WAAL,EAA9B,EAAkD;AAChD,QAAM+pB,kBAAkB,KAAKA,eAA7B;AACA,QAAI,kCACFA,eADE,EACe,CADf,EACkB,KAAK8M,KADvB,EAC8B,KAAK/gB,MADnC,CAAJ,EACgD;AAC9C,WAAKwiB,wBAAL,GAAgCvO,eAAhC;AACD,KAHD,MAGO;AACL,WAAKuO,wBAAL,GAAgCvO,gBAAgB58C,KAAhB,EAAhC;AACA,WAAKmrD,wBAAL,CAA8B/qD,MAA9B,GACI,+BACE,KAAK+qD,wBADP,EACiC,CADjC,EACoC,KAAKzB,KADzC,EACgD,KAAK/gB,MADrD,CADJ;AAGD;AACD,SAAKuiB,iBAAL,GAAyB,KAAKr4B,WAAL,EAAzB;AACD;AACD,SAAO,KAAKs4B,wBAAZ;AACD,CAfD;;AAkBA;;;AAGAxI,QAAQtoC,SAAR,CAAkB+uC,6BAAlB,GAAkD,UAAShD,gBAAT,EAA2B;AAC3E,MAAMiD,4BAA4B,EAAlC;AACA,MAAMiB,iBAAiB,EAAvB;AACAjB,4BAA0BjpD,MAA1B,GAAmC,6BACjC,KAAKw8C,eAD4B,EACX,CADW,EACR,KAAK8M,KADG,EACI,KAAK/gB,MADT,EAEjCzkC,KAAKsG,IAAL,CAAU47C,gBAAV,CAFiC,EAGjCiD,yBAHiC,EAGN,CAHM,EAGHiB,cAHG,CAAnC;AAIA,MAAMgD,oBAAoB,IAAI3K,OAAJ,CAAY,IAAZ,CAA1B;AACA2K,oBAAkBjJ,kBAAlB,CACEU,yBAAeC,EADjB,EACqBqE,yBADrB,EACgDiB,cADhD;AAEA,SAAOgD,iBAAP;AACD,CAXD;;AAcA;;;;AAIA3K,QAAQtoC,SAAR,CAAkBd,OAAlB,GAA4B,YAAW;AACrC,SAAOwuB,uBAAaogB,OAApB;AACD,CAFD;;AAKA;;;;AAIAxF,QAAQtoC,SAAR,CAAkBuqC,gBAAlB,GAAqC,UAASr7B,MAAT,EAAiB;AACpD,SAAO,iDACL,KAAKiiC,0BAAL,EADK,EAC8B,CAD9B,EACiC,KAAK9B,KADtC,EAC6C,KAAK/gB,MADlD,EAC0Dpf,MAD1D,CAAP;AAED,CAHD;;AAMA;;;;;;;AAOAo5B,QAAQtoC,SAAR,CAAkB6qC,cAAlB,GAAmC,UAASnJ,WAAT,EAAsBmI,UAAtB,EAAkC;AACnE,MAAI,CAACnI,WAAL,EAAkB;AAChB,SAAKsI,kBAAL,CAAwBU,yBAAeC,EAAvC,EAA2C,IAA3C,EAAiD,KAAK0E,KAAtD;AACD,GAFD,MAEO;AACL,SAAKzE,SAAL,CAAef,UAAf,EAA2BnI,WAA3B,EAAwC,CAAxC;AACA,QAAI,CAAC,KAAKa,eAAV,EAA2B;AACzB,WAAKA,eAAL,GAAuB,EAAvB;AACD;AACD,QAAMqN,OAAO,sCACX,KAAKrN,eADM,EACW,CADX,EACcb,WADd,EAC2B,KAAKpT,MADhC,EACwC,KAAK+gB,KAD7C,CAAb;AAEA,SAAK9M,eAAL,CAAqBx8C,MAArB,GAA8B6pD,KAAK7pD,MAAL,KAAgB,CAAhB,GAAoB,CAApB,GAAwB6pD,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAtD;AACA,SAAK4oB,OAAL;AACD;AACF,CAbD;;AAgBA;;;;;AAKA25B,QAAQtoC,SAAR,CAAkBgqC,kBAAlB,GAAuC,UAASC,MAAT,EAAiB1H,eAAjB,EAAkCqN,IAAlC,EAAwC;AAC7E,OAAK9E,0BAAL,CAAgCb,MAAhC,EAAwC1H,eAAxC;AACA,OAAK8M,KAAL,GAAaO,IAAb;AACA,OAAKjhC,OAAL;AACD,CAJD;;kBAMe25B,O;;AAGf;;;;;;;;;;;;;AAYO,SAAS6J,QAAT,CAAkBxtD,MAAlB,EAA0BmlD,MAA1B,EAAkCoJ,KAAlC,EAAyCC,gBAAzC,EAA2D;AAChE,MAAM/iD,IAAI8iD,QAAQA,KAAR,GAAgB,EAA1B;AACA;AACA,MAAM3Q,kBAAkB,EAAxB;AACA,OAAK,IAAIz8C,IAAI,CAAb,EAAgBA,IAAIsK,CAApB,EAAuB,EAAEtK,CAAzB,EAA4B;AAC1B,uBAAOy8C,eAAP,EAAwB,oBAAa59C,MAAb,EAAqBmlD,MAArB,EAA6B,IAAIjgD,KAAKiG,EAAT,GAAchK,CAAd,GAAkBsK,CAA/C,EAAkD+iD,gBAAlD,CAAxB;AACD;AACD5Q,kBAAgBz6C,IAAhB,CAAqBy6C,gBAAgB,CAAhB,CAArB,EAAyCA,gBAAgB,CAAhB,CAAzC;AACA,MAAMyO,UAAU,IAAI1I,OAAJ,CAAY,IAAZ,CAAhB;AACA0I,UAAQhH,kBAAR,CAA2BU,yBAAeC,EAA1C,EAA8CpI,eAA9C,EAA+D,CAACA,gBAAgBx8C,MAAjB,CAA/D;AACA,SAAOirD,OAAP;AACD;;AAGD;;;;;;AAMO,SAASoB,UAAT,CAAoBljC,MAApB,EAA4B;AACjC,MAAM2W,OAAO3W,OAAO,CAAP,CAAb;AACA,MAAM6W,OAAO7W,OAAO,CAAP,CAAb;AACA,MAAM4W,OAAO5W,OAAO,CAAP,CAAb;AACA,MAAM8W,OAAO9W,OAAO,CAAP,CAAb;AACA,MAAMqzB,kBACF,CAAC1c,IAAD,EAAOE,IAAP,EAAaF,IAAb,EAAmBG,IAAnB,EAAyBF,IAAzB,EAA+BE,IAA/B,EAAqCF,IAArC,EAA2CC,IAA3C,EAAiDF,IAAjD,EAAuDE,IAAvD,CADJ;AAEA,MAAMirB,UAAU,IAAI1I,OAAJ,CAAY,IAAZ,CAAhB;AACA0I,UAAQhH,kBAAR,CACEU,yBAAeC,EADjB,EACqBpI,eADrB,EACsC,CAACA,gBAAgBx8C,MAAjB,CADtC;AAEA,SAAOirD,OAAP;AACD;;AAGD;;;;;;;;;AASO,SAASqB,UAAT,CAAoB3Z,MAApB,EAA4B0a,SAA5B,EAAuCC,SAAvC,EAAkD;AACvD,MAAMC,QAAQF,YAAYA,SAAZ,GAAwB,EAAtC;AACA,MAAM9kB,SAASoK,OAAOnK,SAAP,EAAf;AACA,MAAM0b,SAASvR,OAAO0X,SAAP,EAAf;AACA,MAAMY,UAAU,IAAI1I,OAAJ,CAAY,IAAZ,EAAkB2B,MAAlB,CAAhB;AACA,MAAMsJ,cAAcjlB,UAAUglB,QAAQ,CAAlB,CAApB;AACA,MAAM/Q,kBAAkB,IAAIp7C,KAAJ,CAAUosD,WAAV,CAAxB;AACA,OAAK,IAAIztD,IAAI,CAAb,EAAgBA,IAAIytD,WAApB,EAAiCztD,GAAjC,EAAsC;AACpCy8C,oBAAgBz8C,CAAhB,IAAqB,CAArB;AACD;AACD,MAAM8pD,OAAO,CAACrN,gBAAgBx8C,MAAjB,CAAb;AACAirD,UAAQhH,kBAAR,CAA2BC,MAA3B,EAAmC1H,eAAnC,EAAoDqN,IAApD;AACA0C,cAAYtB,OAAZ,EAAqBtY,OAAO3P,SAAP,EAArB,EAAyC2P,OAAOC,SAAP,EAAzC,EAA6D0a,SAA7D;AACA,SAAOrC,OAAP;AACD;;AAGD;;;;;;;;AAQO,SAASsB,WAAT,CAAqBtB,OAArB,EAA8BrsD,MAA9B,EAAsCmlD,MAAtC,EAA8CuJ,SAA9C,EAAyD;AAC9D,MAAM9Q,kBAAkByO,QAAQjjB,kBAAR,EAAxB;AACA,MAAMkc,SAAS+G,QAAQZ,SAAR,EAAf;AACA,MAAM9hB,SAAS0iB,QAAQziB,SAAR,EAAf;AACA,MAAMqhB,OAAOoB,QAAQvB,OAAR,EAAb;AACA,MAAM6D,QAAQ/Q,gBAAgBx8C,MAAhB,GAAyBuoC,MAAzB,GAAkC,CAAhD;AACA,MAAMklB,aAAaH,YAAYA,SAAZ,GAAwB,CAA3C;AACA,OAAK,IAAIvtD,IAAI,CAAb,EAAgBA,KAAKwtD,KAArB,EAA4B,EAAExtD,CAA9B,EAAiC;AAC/B,QAAMsnC,SAAStnC,IAAIwoC,MAAnB;AACA,QAAMsL,QAAQ4Z,aAAc,kBAAO1tD,CAAP,EAAUwtD,KAAV,IAAmB,CAAnB,GAAuBzpD,KAAKiG,EAA5B,GAAiCwjD,KAA7D;AACA/Q,oBAAgBnV,MAAhB,IAA0BzoC,OAAO,CAAP,IAAamlD,SAASjgD,KAAK4G,GAAL,CAASmpC,KAAT,CAAhD;AACA2I,oBAAgBnV,SAAS,CAAzB,IAA8BzoC,OAAO,CAAP,IAAamlD,SAASjgD,KAAK2G,GAAL,CAASopC,KAAT,CAApD;AACD;AACDoX,UAAQhH,kBAAR,CAA2BC,MAA3B,EAAmC1H,eAAnC,EAAoDqN,IAApD;AACD,C;;;;;;;;;;;;;;;;;QCxYe6D,kB,GAAAA,kB;QA8PAC,e,GAAAA,e;;AAlUhB;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAEA;;;;;;;;;;AAUA,IAAMjmB,iBAAiB,SAAjBA,cAAiB,GAAW;;AAEhC5f,qBAASxM,IAAT,CAAc,IAAd;;AAEA;;;;AAIA,OAAK4oC,MAAL,GAAcS,yBAAeC,EAA7B;;AAEA;;;;AAIA,OAAKrc,MAAL,GAAc,CAAd;;AAEA;;;;AAIA,OAAKiU,eAAL,GAAuB,IAAvB;AAED,CAtBD,C,CArBA;;;;;AA6CA,qBAAS9U,cAAT,EAAyB5f,kBAAzB;;AAGA;;;;AAIA,SAAS8lC,kBAAT,CAA4BrlB,MAA5B,EAAoC;AAClC,MAAI2b,eAAJ;AACA,MAAI3b,UAAU,CAAd,EAAiB;AACf2b,aAASS,yBAAeC,EAAxB;AACD,GAFD,MAEO,IAAIrc,UAAU,CAAd,EAAiB;AACtB2b,aAASS,yBAAe8C,GAAxB;AACD,GAFM,MAEA,IAAIlf,UAAU,CAAd,EAAiB;AACtB2b,aAASS,yBAAegD,IAAxB;AACD;AACD;AACE,gDAA8CzD;AADhD;AAGD;;AAGD;;;;AAIO,SAASwJ,kBAAT,CAA4BxJ,MAA5B,EAAoC;AACzC,MAAI3b,eAAJ;AACA,MAAI2b,UAAUS,yBAAeC,EAA7B,EAAiC;AAC/Brc,aAAS,CAAT;AACD,GAFD,MAEO,IAAI2b,UAAUS,yBAAe8C,GAAzB,IAAgCvD,UAAUS,yBAAe+C,GAA7D,EAAkE;AACvEnf,aAAS,CAAT;AACD,GAFM,MAEA,IAAI2b,UAAUS,yBAAegD,IAA7B,EAAmC;AACxCpf,aAAS,CAAT;AACD;AACD,SAAO,sBAAuBA;AAA9B;AACD;;AAGD;;;AAGAb,eAAeztB,SAAf,CAAyBomB,UAAzB,GAAsCyY,gBAAtC;;AAGA;;;AAGApR,eAAeztB,SAAf,CAAyBsqC,aAAzB,GAAyC,UAASp7B,MAAT,EAAiB;AACxD,SAAO,+CAAkC,KAAKqzB,eAAvC,EACL,CADK,EACF,KAAKA,eAAL,CAAqBx8C,MADnB,EAC2B,KAAKuoC,MADhC,EACwCpf,MADxC,CAAP;AAED,CAHD;;AAMA;;;;AAIAue,eAAeztB,SAAf,CAAyByoC,cAAzB,GAA0C,YAAW,CAAE,CAAvD;;AAGA;;;;;AAKAhb,eAAeztB,SAAf,CAAyB4zC,kBAAzB,GAA8C,YAAW;AACvD,SAAO,KAAKrR,eAAL,CAAqB58C,KAArB,CAA2B,CAA3B,EAA8B,KAAK2oC,MAAnC,CAAP;AACD,CAFD;;AAKA;;;AAGAb,eAAeztB,SAAf,CAAyB+tB,kBAAzB,GAA8C,YAAW;AACvD,SAAO,KAAKwU,eAAZ;AACD,CAFD;;AAKA;;;;;AAKA9U,eAAeztB,SAAf,CAAyB6zC,iBAAzB,GAA6C,YAAW;AACtD,SAAO,KAAKtR,eAAL,CAAqB58C,KAArB,CAA2B,KAAK48C,eAAL,CAAqBx8C,MAArB,GAA8B,KAAKuoC,MAA9D,CAAP;AACD,CAFD;;AAKA;;;;;AAKAb,eAAeztB,SAAf,CAAyBowC,SAAzB,GAAqC,YAAW;AAC9C,SAAO,KAAKnG,MAAZ;AACD,CAFD;;AAKA;;;AAGAxc,eAAeztB,SAAf,CAAyB8rC,qBAAzB,GAAiD,UAASC,gBAAT,EAA2B;AAC1E,MAAI,KAAKX,0BAAL,IAAmC,KAAK5yB,WAAL,EAAvC,EAA2D;AACzD,oBAAM,KAAK0yB,uBAAX;AACA,SAAKC,wCAAL,GAAgD,CAAhD;AACA,SAAKC,0BAAL,GAAkC,KAAK5yB,WAAL,EAAlC;AACD;AACD;AACA;AACA,MAAIuzB,mBAAmB,CAAnB,IACC,KAAKZ,wCAAL,KAAkD,CAAlD,IACAY,oBAAoB,KAAKZ,wCAF9B,EAEyE;AACvE,WAAO,IAAP;AACD;AACD,MAAMh9C,MAAM49C,iBAAiBpjD,QAAjB,EAAZ;AACA,MAAI,KAAKuiD,uBAAL,CAA6BlqC,cAA7B,CAA4C7S,GAA5C,CAAJ,EAAsD;AACpD,WAAO,KAAK+8C,uBAAL,CAA6B/8C,GAA7B,CAAP;AACD,GAFD,MAEO;AACL,QAAMi/C,qBACF,KAAK2B,6BAAL,CAAmChD,gBAAnC,CADJ;AAEA,QAAMiD,4BAA4B5B,mBAAmBrf,kBAAnB,EAAlC;AACA,QAAIihB,0BAA0BjpD,MAA1B,GAAmC,KAAKw8C,eAAL,CAAqBx8C,MAA5D,EAAoE;AAClE,WAAKmlD,uBAAL,CAA6B/8C,GAA7B,IAAoCi/C,kBAApC;AACA,aAAOA,kBAAP;AACD,KAHD,MAGO;AACL;AACA;AACA;AACA;AACA;AACA;AACA,WAAKjC,wCAAL,GAAgDY,gBAAhD;AACA,aAAO,IAAP;AACD;AACF;AACF,CAlCD;;AAqCA;;;;;AAKAte,eAAeztB,SAAf,CAAyB+uC,6BAAzB,GAAyD,UAAShD,gBAAT,EAA2B;AAClF,SAAO,IAAP;AACD,CAFD;;AAKA;;;AAGAte,eAAeztB,SAAf,CAAyBuuB,SAAzB,GAAqC,YAAW;AAC9C,SAAO,KAAKD,MAAZ;AACD,CAFD;;AAKA;;;;;AAKAb,eAAeztB,SAAf,CAAyB8qC,0BAAzB,GAAsD,UAASb,MAAT,EAAiB1H,eAAjB,EAAkC;AACtF,OAAKjU,MAAL,GAAcmlB,mBAAmBxJ,MAAnB,CAAd;AACA,OAAKA,MAAL,GAAcA,MAAd;AACA,OAAK1H,eAAL,GAAuBA,eAAvB;AACD,CAJD;;AAOA;;;;;AAKA9U,eAAeztB,SAAf,CAAyB6qC,cAAzB,GAA0C,UAASnJ,WAAT,EAAsBmI,UAAtB,EAAkC,CAAE,CAA9E;;AAGA;;;;;;AAMApc,eAAeztB,SAAf,CAAyB4qC,SAAzB,GAAqC,UAASX,MAAT,EAAiBvI,WAAjB,EAA8BoS,OAA9B,EAAuC;AAC1E;AACA,MAAIxlB,eAAJ;AACA,MAAI2b,MAAJ,EAAY;AACV3b,aAASmlB,mBAAmBxJ,MAAnB,CAAT;AACD,GAFD,MAEO;AACL,SAAK,IAAInkD,IAAI,CAAb,EAAgBA,IAAIguD,OAApB,EAA6B,EAAEhuD,CAA/B,EAAkC;AAChC,UAAI47C,YAAY37C,MAAZ,KAAuB,CAA3B,EAA8B;AAC5B,aAAKkkD,MAAL,GAAcS,yBAAeC,EAA7B;AACA,aAAKrc,MAAL,GAAc,CAAd;AACA;AACD,OAJD,MAIO;AACLoT,sBAAc,oBAAsBA,YAAY,CAAZ,CAApC;AACD;AACF;AACDpT,aAASoT,YAAY37C,MAArB;AACAkkD,aAAS0J,mBAAmBrlB,MAAnB,CAAT;AACD;AACD,OAAK2b,MAAL,GAAcA,MAAd;AACA,OAAK3b,MAAL,GAAcA,MAAd;AACD,CApBD;;AAuBA;;;;AAIAb,eAAeztB,SAAf,CAAyByhC,cAAzB,GAA0C,UAASuC,WAAT,EAAsB;AAC9D,MAAI,KAAKzB,eAAT,EAA0B;AACxByB,gBAAY,KAAKzB,eAAjB,EAAkC,KAAKA,eAAvC,EAAwD,KAAKjU,MAA7D;AACA,SAAK3f,OAAL;AACD;AACF,CALD;;AAQA;;;;AAIA8e,eAAeztB,SAAf,CAAyB4tB,MAAzB,GAAkC,UAASgM,KAAT,EAAgBjQ,MAAhB,EAAwB;AACxD,MAAM4Y,kBAAkB,KAAKxU,kBAAL,EAAxB;AACA,MAAIwU,eAAJ,EAAqB;AACnB,QAAMjU,SAAS,KAAKC,SAAL,EAAf;AACA,2BACEgU,eADF,EACmB,CADnB,EACsBA,gBAAgBx8C,MADtC,EAEEuoC,MAFF,EAEUsL,KAFV,EAEiBjQ,MAFjB,EAEyB4Y,eAFzB;AAGA,SAAK5zB,OAAL;AACD;AACF,CATD;;AAYA;;;;AAIA8e,eAAeztB,SAAf,CAAyBo4B,KAAzB,GAAiC,UAASsT,EAAT,EAAaC,MAAb,EAAqB1c,UAArB,EAAiC;AAChE,MAAI8kB,KAAKpI,MAAT;AACA,MAAIoI,OAAOrtD,SAAX,EAAsB;AACpBqtD,SAAKrI,EAAL;AACD;AACD,MAAI/hB,SAASsF,UAAb;AACA,MAAI,CAACtF,MAAL,EAAa;AACXA,aAAS,uBAAU,KAAKna,SAAL,EAAV,CAAT;AACD;AACD,MAAM+yB,kBAAkB,KAAKxU,kBAAL,EAAxB;AACA,MAAIwU,eAAJ,EAAqB;AACnB,QAAMjU,SAAS,KAAKC,SAAL,EAAf;AACA,0BACEgU,eADF,EACmB,CADnB,EACsBA,gBAAgBx8C,MADtC,EAEEuoC,MAFF,EAEUod,EAFV,EAEcqI,EAFd,EAEkBpqB,MAFlB,EAE0B4Y,eAF1B;AAGA,SAAK5zB,OAAL;AACD;AACF,CAjBD;;AAoBA;;;;AAIA8e,eAAeztB,SAAf,CAAyBgsC,SAAzB,GAAqC,UAAS1rB,MAAT,EAAiBE,MAAjB,EAAyB;AAC5D,MAAM+hB,kBAAkB,KAAKxU,kBAAL,EAAxB;AACA,MAAIwU,eAAJ,EAAqB;AACnB,QAAMjU,SAAS,KAAKC,SAAL,EAAf;AACA,8BACEgU,eADF,EACmB,CADnB,EACsBA,gBAAgBx8C,MADtC,EAC8CuoC,MAD9C,EAEEhO,MAFF,EAEUE,MAFV,EAEkB+hB,eAFlB;AAGA,SAAK5zB,OAAL;AACD;AACF,CATD;;AAYA;;;;;;AAMO,SAAS+kC,eAAT,CAAyBM,cAAzB,EAAyCrd,SAAzC,EAAoDkY,QAApD,EAA8D;AACnE,MAAMtM,kBAAkByR,eAAejmB,kBAAf,EAAxB;AACA,MAAI,CAACwU,eAAL,EAAsB;AACpB,WAAO,IAAP;AACD,GAFD,MAEO;AACL,QAAMjU,SAAS0lB,eAAezlB,SAAf,EAAf;AACA,WAAO,4BACLgU,eADK,EACY,CADZ,EACeA,gBAAgBx8C,MAD/B,EACuCuoC,MADvC,EAELqI,SAFK,EAEMkY,QAFN,CAAP;AAGD;AACF;;kBAEcphB,c;;;;;;;;;;;;;;;;;QCrUC0hB,U,GAAAA,U;QAsBA6D,W,GAAAA,W;QAkBAiB,Y,GAAAA,Y;AApDhB;;;;AAKA;;;;;;;AAOO,SAAS9E,UAAT,CAAoB5M,eAApB,EAAqCnV,MAArC,EAA6C3b,GAA7C,EAAkD6c,MAAlD,EAA0D;AAC/D,MAAI4lB,YAAY,CAAhB;AACA,MAAIlpB,KAAKuX,gBAAgB9wB,MAAM6c,MAAtB,CAAT;AACA,MAAIrD,KAAKsX,gBAAgB9wB,MAAM6c,MAAN,GAAe,CAA/B,CAAT;AACA,SAAOlB,SAAS3b,GAAhB,EAAqB2b,UAAUkB,MAA/B,EAAuC;AACrC,QAAMhuB,KAAKiiC,gBAAgBnV,MAAhB,CAAX;AACA,QAAMyL,KAAK0J,gBAAgBnV,SAAS,CAAzB,CAAX;AACA8mB,iBAAajpB,KAAK3qB,EAAL,GAAU0qB,KAAK6N,EAA5B;AACA7N,SAAK1qB,EAAL;AACA2qB,SAAK4N,EAAL;AACD;AACD,SAAOqb,YAAY,CAAnB;AACD;;AAGD;;;;;;;AAOO,SAASlB,WAAT,CAAqBzQ,eAArB,EAAsCnV,MAAtC,EAA8CwiB,IAA9C,EAAoDthB,MAApD,EAA4D;AACjE,MAAImU,OAAO,CAAX;AACA,OAAK,IAAI38C,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACA28C,YAAQ0M,WAAW5M,eAAX,EAA4BnV,MAA5B,EAAoC3b,GAApC,EAAyC6c,MAAzC,CAAR;AACAlB,aAAS3b,GAAT;AACD;AACD,SAAOgxB,IAAP;AACD;;AAGD;;;;;;;AAOO,SAASwR,YAAT,CAAsB1R,eAAtB,EAAuCnV,MAAvC,EAA+C2kB,KAA/C,EAAsDzjB,MAAtD,EAA8D;AACnE,MAAImU,OAAO,CAAX;AACA,OAAK,IAAI38C,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACA28C,YAAQuQ,YAAYzQ,eAAZ,EAA6BnV,MAA7B,EAAqCwiB,IAArC,EAA2CthB,MAA3C,CAAR;AACAlB,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD,SAAO08C,IAAP;AACD,C;;;;;;;;;;;;;;;;;QC/CewR,Y,GAAAA,Y;;AAVhB;;AAGA;;;;;;;AAOO,SAASA,YAAT,CAAsB1R,eAAtB,EAAuCnV,MAAvC,EAA+C2kB,KAA/C,EAAsDzjB,MAAtD,EAA8D;AACnE,MAAMijB,cAAc,EAApB;AACA,MAAIriC,SAAS,0BAAb;AACA,OAAK,IAAIppB,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACAopB,aAAS,+CAAkCqzB,eAAlC,EAAmDnV,MAAnD,EAA2DwiB,KAAK,CAAL,CAA3D,EAAoEthB,MAApE,CAAT;AACAijB,gBAAYzpD,IAAZ,CAAiB,CAAConB,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,IAA0B,CAA3C,EAA8C,CAACA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,IAA0B,CAAxE;AACAke,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD,SAAOwrD,WAAP;AACD,C,CAvBD;;;;;;;;;;;;;;;;;;;QC0DgB4C,e,GAAAA,e;QAyBAC,oB,GAAAA,oB;QAmBAC,yB,GAAAA,yB;QAyBAC,kB,GAAAA,kB;QAiFAC,uB,GAAAA,uB;QA6BAC,4B,GAAAA,4B;;AA1OhB;;AAGA;;;;;;;;;;;;AAYA,SAASC,aAAT,CAAuBlS,eAAvB,EAAwCmS,OAAxC,EAAiDC,OAAjD,EAA0DrmB,MAA1D,EAAkEp+B,CAAlE,EAAqE+N,CAArE,EAAwEksC,YAAxE,EAAsF;AACpF,MAAMnf,KAAKuX,gBAAgBmS,OAAhB,CAAX;AACA,MAAMzpB,KAAKsX,gBAAgBmS,UAAU,CAA1B,CAAX;AACA,MAAM9iC,KAAK2wB,gBAAgBoS,OAAhB,IAA2B3pB,EAAtC;AACA,MAAMnZ,KAAK0wB,gBAAgBoS,UAAU,CAA1B,IAA+B1pB,EAA1C;AACA,MAAImC,eAAJ;AACA,MAAIxb,OAAO,CAAP,IAAYC,OAAO,CAAvB,EAA0B;AACxBub,aAASsnB,OAAT;AACD,GAFD,MAEO;AACL,QAAMpqD,IAAI,CAAC,CAAC4F,IAAI86B,EAAL,IAAWpZ,EAAX,GAAgB,CAAC3T,IAAIgtB,EAAL,IAAWpZ,EAA5B,KAAmCD,KAAKA,EAAL,GAAUC,KAAKA,EAAlD,CAAV;AACA,QAAIvnB,IAAI,CAAR,EAAW;AACT8iC,eAASunB,OAAT;AACD,KAFD,MAEO,IAAIrqD,IAAI,CAAR,EAAW;AAChB,WAAK,IAAIxE,IAAI,CAAb,EAAgBA,IAAIwoC,MAApB,EAA4B,EAAExoC,CAA9B,EAAiC;AAC/BqkD,qBAAarkD,CAAb,IAAkB,gBAAKy8C,gBAAgBmS,UAAU5uD,CAA1B,CAAL,EAChBy8C,gBAAgBoS,UAAU7uD,CAA1B,CADgB,EACcwE,CADd,CAAlB;AAED;AACD6/C,mBAAapkD,MAAb,GAAsBuoC,MAAtB;AACA;AACD,KAPM,MAOA;AACLlB,eAASsnB,OAAT;AACD;AACF;AACD,OAAK,IAAI5uD,KAAI,CAAb,EAAgBA,KAAIwoC,MAApB,EAA4B,EAAExoC,EAA9B,EAAiC;AAC/BqkD,iBAAarkD,EAAb,IAAkBy8C,gBAAgBnV,SAAStnC,EAAzB,CAAlB;AACD;AACDqkD,eAAapkD,MAAb,GAAsBuoC,MAAtB;AACD;;AAGD;;;;;;;;;;AAhDA;;;AA0DO,SAAS6lB,eAAT,CAAyB5R,eAAzB,EAA0CnV,MAA1C,EAAkD3b,GAAlD,EAAuD6c,MAAvD,EAA+Dv9B,GAA/D,EAAoE;AACzE,MAAIi6B,KAAKuX,gBAAgBnV,MAAhB,CAAT;AACA,MAAInC,KAAKsX,gBAAgBnV,SAAS,CAAzB,CAAT;AACA,OAAKA,UAAUkB,MAAf,EAAuBlB,SAAS3b,GAAhC,EAAqC2b,UAAUkB,MAA/C,EAAuD;AACrD,QAAMhuB,KAAKiiC,gBAAgBnV,MAAhB,CAAX;AACA,QAAMyL,KAAK0J,gBAAgBnV,SAAS,CAAzB,CAAX;AACA,QAAMwnB,eAAe,2BAAU5pB,EAAV,EAAcC,EAAd,EAAkB3qB,EAAlB,EAAsBu4B,EAAtB,CAArB;AACA,QAAI+b,eAAe7jD,GAAnB,EAAwB;AACtBA,YAAM6jD,YAAN;AACD;AACD5pB,SAAK1qB,EAAL;AACA2qB,SAAK4N,EAAL;AACD;AACD,SAAO9nC,GAAP;AACD;;AAGD;;;;;;;;AAQO,SAASqjD,oBAAT,CAA8B7R,eAA9B,EAA+CnV,MAA/C,EAAuDwiB,IAAvD,EAA6DthB,MAA7D,EAAqEv9B,GAArE,EAA0E;AAC/E,OAAK,IAAIjL,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACAiL,UAAMojD,gBACJ5R,eADI,EACanV,MADb,EACqB3b,GADrB,EAC0B6c,MAD1B,EACkCv9B,GADlC,CAAN;AAEAq8B,aAAS3b,GAAT;AACD;AACD,SAAO1gB,GAAP;AACD;;AAGD;;;;;;;;AAQO,SAASsjD,yBAAT,CAAmC9R,eAAnC,EAAoDnV,MAApD,EAA4D2kB,KAA5D,EAAmEzjB,MAAnE,EAA2Ev9B,GAA3E,EAAgF;AACrF,OAAK,IAAIjL,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACAiL,UAAMqjD,qBACJ7R,eADI,EACanV,MADb,EACqBwiB,IADrB,EAC2BthB,MAD3B,EACmCv9B,GADnC,CAAN;AAEAq8B,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD,SAAOgL,GAAP;AACD;;AAGD;;;;;;;;;;;;;;AAcO,SAASujD,kBAAT,CAA4B/R,eAA5B,EAA6CnV,MAA7C,EAAqD3b,GAArD,EACL6c,MADK,EACGumB,QADH,EACaC,MADb,EACqB5kD,CADrB,EACwB+N,CADxB,EAC2BksC,YAD3B,EACyCC,kBADzC,EAEL2K,YAFK,EAES;AACd,MAAI3nB,UAAU3b,GAAd,EAAmB;AACjB,WAAO24B,kBAAP;AACD;AACD,MAAItkD,UAAJ;AAAA,MAAOuyC,wBAAP;AACA,MAAIwc,aAAa,CAAjB,EAAoB;AAClB;AACAxc,sBAAkB,2BAChBnoC,CADgB,EACb+N,CADa,EACVskC,gBAAgBnV,MAAhB,CADU,EACemV,gBAAgBnV,SAAS,CAAzB,CADf,CAAlB;AAEA,QAAIiL,kBAAkB+R,kBAAtB,EAA0C;AACxC,WAAKtkD,IAAI,CAAT,EAAYA,IAAIwoC,MAAhB,EAAwB,EAAExoC,CAA1B,EAA6B;AAC3BqkD,qBAAarkD,CAAb,IAAkBy8C,gBAAgBnV,SAAStnC,CAAzB,CAAlB;AACD;AACDqkD,mBAAapkD,MAAb,GAAsBuoC,MAAtB;AACA,aAAO+J,eAAP;AACD,KAND,MAMO;AACL,aAAO+R,kBAAP;AACD;AACF;AACD,MAAM4K,WAAWD,eAAeA,YAAf,GAA8B,CAACtJ,GAAD,EAAMA,GAAN,CAA/C;AACA,MAAIthD,QAAQijC,SAASkB,MAArB;AACA,SAAOnkC,QAAQsnB,GAAf,EAAoB;AAClBgjC,kBACElS,eADF,EACmBp4C,QAAQmkC,MAD3B,EACmCnkC,KADnC,EAC0CmkC,MAD1C,EACkDp+B,CADlD,EACqD+N,CADrD,EACwD+2C,QADxD;AAEA3c,sBAAkB,2BAAUnoC,CAAV,EAAa+N,CAAb,EAAgB+2C,SAAS,CAAT,CAAhB,EAA6BA,SAAS,CAAT,CAA7B,CAAlB;AACA,QAAI3c,kBAAkB+R,kBAAtB,EAA0C;AACxCA,2BAAqB/R,eAArB;AACA,WAAKvyC,IAAI,CAAT,EAAYA,IAAIwoC,MAAhB,EAAwB,EAAExoC,CAA1B,EAA6B;AAC3BqkD,qBAAarkD,CAAb,IAAkBkvD,SAASlvD,CAAT,CAAlB;AACD;AACDqkD,mBAAapkD,MAAb,GAAsBuoC,MAAtB;AACAnkC,eAASmkC,MAAT;AACD,KAPD,MAOO;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAnkC,eAASmkC,SAASzkC,KAAKkH,GAAL,CACf,CAAClH,KAAKsG,IAAL,CAAUkoC,eAAV,IACExuC,KAAKsG,IAAL,CAAUi6C,kBAAV,CADH,IACoCyK,QADrC,GACiD,CAFjC,EAEoC,CAFpC,CAAlB;AAGD;AACF;AACD,MAAIC,MAAJ,EAAY;AACV;AACAL,kBACElS,eADF,EACmB9wB,MAAM6c,MADzB,EACiClB,MADjC,EACyCkB,MADzC,EACiDp+B,CADjD,EACoD+N,CADpD,EACuD+2C,QADvD;AAEA3c,sBAAkB,2BAAUnoC,CAAV,EAAa+N,CAAb,EAAgB+2C,SAAS,CAAT,CAAhB,EAA6BA,SAAS,CAAT,CAA7B,CAAlB;AACA,QAAI3c,kBAAkB+R,kBAAtB,EAA0C;AACxCA,2BAAqB/R,eAArB;AACA,WAAKvyC,IAAI,CAAT,EAAYA,IAAIwoC,MAAhB,EAAwB,EAAExoC,CAA1B,EAA6B;AAC3BqkD,qBAAarkD,CAAb,IAAkBkvD,SAASlvD,CAAT,CAAlB;AACD;AACDqkD,mBAAapkD,MAAb,GAAsBuoC,MAAtB;AACD;AACF;AACD,SAAO8b,kBAAP;AACD;;AAGD;;;;;;;;;;;;;;AAcO,SAASmK,uBAAT,CAAiChS,eAAjC,EAAkDnV,MAAlD,EAA0DwiB,IAA1D,EACLthB,MADK,EACGumB,QADH,EACaC,MADb,EACqB5kD,CADrB,EACwB+N,CADxB,EAC2BksC,YAD3B,EACyCC,kBADzC,EAEL2K,YAFK,EAES;AACd,MAAMC,WAAWD,eAAeA,YAAf,GAA8B,CAACtJ,GAAD,EAAMA,GAAN,CAA/C;AACA,OAAK,IAAI3lD,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACAskD,yBAAqBkK,mBACnB/R,eADmB,EACFnV,MADE,EACM3b,GADN,EACW6c,MADX,EAEnBumB,QAFmB,EAETC,MAFS,EAED5kD,CAFC,EAEE+N,CAFF,EAEKksC,YAFL,EAEmBC,kBAFnB,EAEuC4K,QAFvC,CAArB;AAGA5nB,aAAS3b,GAAT;AACD;AACD,SAAO24B,kBAAP;AACD;;AAGD;;;;;;;;;;;;;;AAcO,SAASoK,4BAAT,CAAsCjS,eAAtC,EAAuDnV,MAAvD,EACL2kB,KADK,EACEzjB,MADF,EACUumB,QADV,EACoBC,MADpB,EAC4B5kD,CAD5B,EAC+B+N,CAD/B,EACkCksC,YADlC,EACgDC,kBADhD,EAEL2K,YAFK,EAES;AACd,MAAMC,WAAWD,eAAeA,YAAf,GAA8B,CAACtJ,GAAD,EAAMA,GAAN,CAA/C;AACA,OAAK,IAAI3lD,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACAskD,yBAAqBmK,wBACnBhS,eADmB,EACFnV,MADE,EACMwiB,IADN,EACYthB,MADZ,EAEnBumB,QAFmB,EAETC,MAFS,EAED5kD,CAFC,EAEE+N,CAFF,EAEKksC,YAFL,EAEmBC,kBAFnB,EAEuC4K,QAFvC,CAArB;AAGA5nB,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD,SAAOqkD,kBAAP;AACD,C;;;;;;;;;;;;;;;;;QC3Oe6K,wB,GAAAA,wB;QAsBAC,oB,GAAAA,oB;QAqCAC,qB,GAAAA,qB;QAyBAC,sB,GAAAA,sB;;AA/FhB;;AAGA;;;;;;;;AAQO,SAASH,wBAAT,CAAkC1S,eAAlC,EAAmDnV,MAAnD,EAA2D3b,GAA3D,EAAgE6c,MAAhE,EAAwEpf,MAAxE,EAAgF;AACrF,MAAMmmC,UAAU,2BAAcnmC,MAAd;AACd;;;;AAIA,YAASqE,UAAT,EAAqB;AACnB,WAAO,CAAC2hC,qBAAqB3S,eAArB,EAAsCnV,MAAtC,EAA8C3b,GAA9C,EAAmD6c,MAAnD,EAA2D/a,WAAW,CAAX,CAA3D,EAA0EA,WAAW,CAAX,CAA1E,CAAR;AACD,GAPa,CAAhB;AAQA,SAAO,CAAC8hC,OAAR;AACD;;AAGD;;;;;;;;;AA3BA;;;AAoCO,SAASH,oBAAT,CAA8B3S,eAA9B,EAA+CnV,MAA/C,EAAuD3b,GAAvD,EAA4D6c,MAA5D,EAAoEp+B,CAApE,EAAuE+N,CAAvE,EAA0E;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAIq3C,KAAK,CAAT;AACA,MAAItqB,KAAKuX,gBAAgB9wB,MAAM6c,MAAtB,CAAT;AACA,MAAIrD,KAAKsX,gBAAgB9wB,MAAM6c,MAAN,GAAe,CAA/B,CAAT;AACA,SAAOlB,SAAS3b,GAAhB,EAAqB2b,UAAUkB,MAA/B,EAAuC;AACrC,QAAMhuB,KAAKiiC,gBAAgBnV,MAAhB,CAAX;AACA,QAAMyL,KAAK0J,gBAAgBnV,SAAS,CAAzB,CAAX;AACA,QAAInC,MAAMhtB,CAAV,EAAa;AACX,UAAI46B,KAAK56B,CAAL,IAAW,CAACqC,KAAK0qB,EAAN,KAAa/sB,IAAIgtB,EAAjB,CAAD,GAA0B,CAAC/6B,IAAI86B,EAAL,KAAY6N,KAAK5N,EAAjB,CAA1B,GAAkD,CAAhE,EAAmE;AACjEqqB;AACD;AACF,KAJD,MAIO,IAAIzc,MAAM56B,CAAN,IAAY,CAACqC,KAAK0qB,EAAN,KAAa/sB,IAAIgtB,EAAjB,CAAD,GAA0B,CAAC/6B,IAAI86B,EAAL,KAAY6N,KAAK5N,EAAjB,CAA1B,GAAkD,CAAjE,EAAoE;AACzEqqB;AACD;AACDtqB,SAAK1qB,EAAL;AACA2qB,SAAK4N,EAAL;AACD;AACD,SAAOyc,OAAO,CAAd;AACD;;AAGD;;;;;;;;;AASO,SAASH,qBAAT,CAA+B5S,eAA/B,EAAgDnV,MAAhD,EAAwDwiB,IAAxD,EAA8DthB,MAA9D,EAAsEp+B,CAAtE,EAAyE+N,CAAzE,EAA4E;AACjF,MAAI2xC,KAAK7pD,MAAL,KAAgB,CAApB,EAAuB;AACrB,WAAO,KAAP;AACD;AACD,MAAI,CAACmvD,qBAAqB3S,eAArB,EAAsCnV,MAAtC,EAA8CwiB,KAAK,CAAL,CAA9C,EAAuDthB,MAAvD,EAA+Dp+B,CAA/D,EAAkE+N,CAAlE,CAAL,EAA2E;AACzE,WAAO,KAAP;AACD;AACD,OAAK,IAAInY,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAIovD,qBAAqB3S,eAArB,EAAsCqN,KAAK9pD,IAAI,CAAT,CAAtC,EAAmD8pD,KAAK9pD,CAAL,CAAnD,EAA4DwoC,MAA5D,EAAoEp+B,CAApE,EAAuE+N,CAAvE,CAAJ,EAA+E;AAC7E,aAAO,KAAP;AACD;AACF;AACD,SAAO,IAAP;AACD;;AAGD;;;;;;;;;AASO,SAASm3C,sBAAT,CAAgC7S,eAAhC,EAAiDnV,MAAjD,EAAyD2kB,KAAzD,EAAgEzjB,MAAhE,EAAwEp+B,CAAxE,EAA2E+N,CAA3E,EAA8E;AACnF,MAAI8zC,MAAMhsD,MAAN,KAAiB,CAArB,EAAwB;AACtB,WAAO,KAAP;AACD;AACD,OAAK,IAAID,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACA,QAAIqvD,sBAAsB5S,eAAtB,EAAuCnV,MAAvC,EAA+CwiB,IAA/C,EAAqDthB,MAArD,EAA6Dp+B,CAA7D,EAAgE+N,CAAhE,CAAJ,EAAwE;AACtE,aAAO,IAAP;AACD;AACDmvB,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD,SAAO,KAAP;AACD,C;;;;;;;;;;;;;;;;;QClGewvD,iB,GAAAA,iB;QAeAC,kB,GAAAA,kB;QAmBAC,uB,GAAAA,uB;QAsBAC,4B,GAAAA,4B;AApEhB;;;;AAKA;;;;;;;AAOO,SAASH,iBAAT,CAA2BhT,eAA3B,EAA4CnV,MAA5C,EAAoD7Z,UAApD,EAAgE+a,MAAhE,EAAwE;AAC7E,OAAK,IAAIxoC,IAAI,CAAR,EAAWwkB,KAAKiJ,WAAWxtB,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnDy8C,oBAAgBnV,QAAhB,IAA4B7Z,WAAWztB,CAAX,CAA5B;AACD;AACD,SAAOsnC,MAAP;AACD;;AAGD;;;;;;;AAOO,SAASooB,kBAAT,CAA4BjT,eAA5B,EAA6CnV,MAA7C,EAAqDsU,WAArD,EAAkEpT,MAAlE,EAA0E;AAC/E,OAAK,IAAIxoC,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiD,EAAExkB,CAAnD,EAAsD;AACpD,QAAMytB,aAAamuB,YAAY57C,CAAZ,CAAnB;AACA,SAAK,IAAIkJ,IAAI,CAAb,EAAgBA,IAAIs/B,MAApB,EAA4B,EAAEt/B,CAA9B,EAAiC;AAC/BuzC,sBAAgBnV,QAAhB,IAA4B7Z,WAAWvkB,CAAX,CAA5B;AACD;AACF;AACD,SAAOo+B,MAAP;AACD;;AAGD;;;;;;;;AAQO,SAASqoB,uBAAT,CAAiClT,eAAjC,EAAkDnV,MAAlD,EAA0DuoB,YAA1D,EAAwErnB,MAAxE,EAAgFsnB,QAAhF,EAA0F;AAC/F,MAAMhG,OAAOgG,WAAWA,QAAX,GAAsB,EAAnC;AACA,MAAI9vD,IAAI,CAAR;AACA,OAAK,IAAIkJ,IAAI,CAAR,EAAW27B,KAAKgrB,aAAa5vD,MAAlC,EAA0CiJ,IAAI27B,EAA9C,EAAkD,EAAE37B,CAApD,EAAuD;AACrD,QAAMyiB,MAAM+jC,mBACVjT,eADU,EACOnV,MADP,EACeuoB,aAAa3mD,CAAb,CADf,EACgCs/B,MADhC,CAAZ;AAEAshB,SAAK9pD,GAAL,IAAY2rB,GAAZ;AACA2b,aAAS3b,GAAT;AACD;AACDm+B,OAAK7pD,MAAL,GAAcD,CAAd;AACA,SAAO8pD,IAAP;AACD;;AAGD;;;;;;;;AAQO,SAAS8F,4BAAT,CAAsCnT,eAAtC,EAAuDnV,MAAvD,EAA+DyoB,aAA/D,EAA8EvnB,MAA9E,EAAsFwnB,SAAtF,EAAiG;AACtG,MAAM/D,QAAQ+D,YAAYA,SAAZ,GAAwB,EAAtC;AACA,MAAIhwD,IAAI,CAAR;AACA,OAAK,IAAIkJ,IAAI,CAAR,EAAW27B,KAAKkrB,cAAc9vD,MAAnC,EAA2CiJ,IAAI27B,EAA/C,EAAmD,EAAE37B,CAArD,EAAwD;AACtD,QAAM4gD,OAAO6F,wBACXlT,eADW,EACMnV,MADN,EACcyoB,cAAc7mD,CAAd,CADd,EACgCs/B,MADhC,EACwCyjB,MAAMjsD,CAAN,CADxC,CAAb;AAEAisD,UAAMjsD,GAAN,IAAa8pD,IAAb;AACAxiB,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACDgsD,QAAMhsD,MAAN,GAAeD,CAAf;AACA,SAAOisD,KAAP;AACD,C;;;;;;;;;;;;;;;;;QClEegE,kB,GAAAA,kB;QAmBAC,uB,GAAAA,uB;QAuBAC,4B,GAAAA,4B;AAvDhB;;;;AAKA;;;;;;;;AAQO,SAASF,kBAAT,CAA4BxT,eAA5B,EAA6CnV,MAA7C,EAAqD3b,GAArD,EAA0D6c,MAA1D,EAAkE4nB,eAAlE,EAAmF;AACxF,MAAMxU,cAAcwU,oBAAoBxvD,SAApB,GAAgCwvD,eAAhC,GAAkD,EAAtE;AACA,MAAIpwD,IAAI,CAAR;AACA,OAAK,IAAIkJ,IAAIo+B,MAAb,EAAqBp+B,IAAIyiB,GAAzB,EAA8BziB,KAAKs/B,MAAnC,EAA2C;AACzCoT,gBAAY57C,GAAZ,IAAmBy8C,gBAAgB58C,KAAhB,CAAsBqJ,CAAtB,EAAyBA,IAAIs/B,MAA7B,CAAnB;AACD;AACDoT,cAAY37C,MAAZ,GAAqBD,CAArB;AACA,SAAO47C,WAAP;AACD;;AAGD;;;;;;;;AAQO,SAASsU,uBAAT,CAAiCzT,eAAjC,EAAkDnV,MAAlD,EAA0DwiB,IAA1D,EAAgEthB,MAAhE,EAAwE6nB,gBAAxE,EAA0F;AAC/F,MAAMR,eAAeQ,qBAAqBzvD,SAArB,GAAiCyvD,gBAAjC,GAAoD,EAAzE;AACA,MAAIrwD,IAAI,CAAR;AACA,OAAK,IAAIkJ,IAAI,CAAR,EAAW27B,KAAKilB,KAAK7pD,MAA1B,EAAkCiJ,IAAI27B,EAAtC,EAA0C,EAAE37B,CAA5C,EAA+C;AAC7C,QAAMyiB,MAAMm+B,KAAK5gD,CAAL,CAAZ;AACA2mD,iBAAa7vD,GAAb,IAAoBiwD,mBAClBxT,eADkB,EACDnV,MADC,EACO3b,GADP,EACY6c,MADZ,EACoBqnB,aAAa7vD,CAAb,CADpB,CAApB;AAEAsnC,aAAS3b,GAAT;AACD;AACDkkC,eAAa5vD,MAAb,GAAsBD,CAAtB;AACA,SAAO6vD,YAAP;AACD;;AAGD;;;;;;;;;AASO,SAASM,4BAAT,CAAsC1T,eAAtC,EAAuDnV,MAAvD,EAA+D2kB,KAA/D,EAAsEzjB,MAAtE,EAA8E8nB,iBAA9E,EAAiG;AACtG,MAAMP,gBAAgBO,sBAAsB1vD,SAAtB,GAAkC0vD,iBAAlC,GAAsD,EAA5E;AACA,MAAItwD,IAAI,CAAR;AACA,OAAK,IAAIkJ,IAAI,CAAR,EAAW27B,KAAKonB,MAAMhsD,MAA3B,EAAmCiJ,IAAI27B,EAAvC,EAA2C,EAAE37B,CAA7C,EAAgD;AAC9C,QAAM4gD,OAAOmC,MAAM/iD,CAAN,CAAb;AACA6mD,kBAAc/vD,GAAd,IAAqBkwD,wBACnBzT,eADmB,EACFnV,MADE,EACMwiB,IADN,EACYthB,MADZ,EACoBunB,cAAc/vD,CAAd,CADpB,CAArB;AAEAsnC,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD8vD,gBAAc9vD,MAAd,GAAuBD,CAAvB;AACA,SAAO+vD,aAAP;AACD,C;;;;;;;;;;;;;;;;;QC9CeQ,uB,GAAAA,uB;QA+DAC,6B,GAAAA,6B;;AAhFhB;;AACA;;AAGA;;;;;;;;;;;;;AAPA;;;AAoBO,SAASD,uBAAT,CAAiC9T,eAAjC,EAAkDnV,MAAlD,EACLwiB,IADK,EACCthB,MADD,EACSijB,WADT,EACsBgF,iBADtB,EACyC1H,QADzC,EACmD;AACxD,MAAI/oD,UAAJ;AAAA,MAAOwkB,WAAP;AAAA,MAAWpa,UAAX;AAAA,MAAc86B,WAAd;AAAA,MAAkB1qB,WAAlB;AAAA,MAAsB2qB,WAAtB;AAAA,MAA0B4N,WAA1B;AACA,MAAM56B,IAAIszC,YAAYgF,oBAAoB,CAAhC,CAAV;AACA;AACA,MAAMC,gBAAgB,EAAtB;AACA;AACA,OAAK,IAAIzxD,IAAI,CAAR,EAAW0xD,KAAK7G,KAAK7pD,MAA1B,EAAkChB,IAAI0xD,EAAtC,EAA0C,EAAE1xD,CAA5C,EAA+C;AAC7C,QAAM0sB,MAAMm+B,KAAK7qD,CAAL,CAAZ;AACAimC,SAAKuX,gBAAgB9wB,MAAM6c,MAAtB,CAAL;AACArD,SAAKsX,gBAAgB9wB,MAAM6c,MAAN,GAAe,CAA/B,CAAL;AACA,SAAKxoC,IAAIsnC,MAAT,EAAiBtnC,IAAI2rB,GAArB,EAA0B3rB,KAAKwoC,MAA/B,EAAuC;AACrChuB,WAAKiiC,gBAAgBz8C,CAAhB,CAAL;AACA+yC,WAAK0J,gBAAgBz8C,IAAI,CAApB,CAAL;AACA,UAAKmY,KAAKgtB,EAAL,IAAW4N,MAAM56B,CAAlB,IAAyBgtB,MAAMhtB,CAAN,IAAWA,KAAK46B,EAA7C,EAAkD;AAChD3oC,YAAI,CAAC+N,IAAIgtB,EAAL,KAAY4N,KAAK5N,EAAjB,KAAwB3qB,KAAK0qB,EAA7B,IAAmCA,EAAvC;AACAwrB,sBAAc1uD,IAAd,CAAmBoI,CAAnB;AACD;AACD86B,WAAK1qB,EAAL;AACA2qB,WAAK4N,EAAL;AACD;AACF;AACD;AACA;AACA,MAAI6d,SAASjL,GAAb;AACA,MAAIkL,mBAAmB,CAACziD,QAAxB;AACAsiD,gBAAc9iD,IAAd,CAAmBs8B,gCAAnB;AACAhF,OAAKwrB,cAAc,CAAd,CAAL;AACA,OAAK1wD,IAAI,CAAJ,EAAOwkB,KAAKksC,cAAczwD,MAA/B,EAAuCD,IAAIwkB,EAA3C,EAA+C,EAAExkB,CAAjD,EAAoD;AAClDwa,SAAKk2C,cAAc1wD,CAAd,CAAL;AACA,QAAM8wD,gBAAgB/sD,KAAKmH,GAAL,CAASsP,KAAK0qB,EAAd,CAAtB;AACA,QAAI4rB,gBAAgBD,gBAApB,EAAsC;AACpCzmD,UAAI,CAAC86B,KAAK1qB,EAAN,IAAY,CAAhB;AACA,UAAI,qCAAsBiiC,eAAtB,EAAuCnV,MAAvC,EAA+CwiB,IAA/C,EAAqDthB,MAArD,EAA6Dp+B,CAA7D,EAAgE+N,CAAhE,CAAJ,EAAwE;AACtEy4C,iBAASxmD,CAAT;AACAymD,2BAAmBC,aAAnB;AACD;AACF;AACD5rB,SAAK1qB,EAAL;AACD;AACD,MAAIxU,MAAM4qD,MAAN,CAAJ,EAAmB;AACjB;AACA;AACAA,aAASnF,YAAYgF,iBAAZ,CAAT;AACD;AACD,MAAI1H,QAAJ,EAAc;AACZA,aAAS/mD,IAAT,CAAc4uD,MAAd,EAAsBz4C,CAAtB,EAAyB04C,gBAAzB;AACA,WAAO9H,QAAP;AACD,GAHD,MAGO;AACL,WAAO,CAAC6H,MAAD,EAASz4C,CAAT,EAAY04C,gBAAZ,CAAP;AACD;AACF;;AAGD;;;;;;;;;AASO,SAASL,6BAAT,CAAuC/T,eAAvC,EAAwDnV,MAAxD,EAAgE2kB,KAAhE,EAAuEzjB,MAAvE,EAA+EijB,WAA/E,EAA4F;AACjG,MAAIE,iBAAiB,EAArB;AACA,OAAK,IAAI3rD,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACA2rD,qBAAiB4E,wBAAwB9T,eAAxB,EACfnV,MADe,EACPwiB,IADO,EACDthB,MADC,EACOijB,WADP,EACoB,IAAIzrD,CADxB,EAC2B2rD,cAD3B,CAAjB;AAEArkB,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD,SAAO0rD,cAAP;AACD,C;;;;;;;;;;;;;;;;;QC5EeoF,gB,GAAAA,gB;QA2DAC,uB,GAAAA,uB;QA8DAC,wB,GAAAA,wB;;AAtIhB;;AACA;;AAGA;;;;;;;;;AAPA;;;AAgBO,SAASF,gBAAT,CAA0BtU,eAA1B,EAA2CnV,MAA3C,EAAmD3b,GAAnD,EAAwD6c,MAAxD,EAAgEzD,QAAhE,EAA0EgkB,QAA1E,EAAoF;AACzF,MAAI6H,SAASjL,GAAb;AACA,MAAIuL,SAASvL,GAAb;AACA,MAAMr7C,IAAI,CAACqhB,MAAM2b,MAAP,IAAiBkB,MAA3B;AACA,MAAIl+B,MAAM,CAAV,EAAa;AACXsmD,aAASnU,gBAAgBnV,MAAhB,CAAT;AACA4pB,aAASzU,gBAAgBnV,SAAS,CAAzB,CAAT;AACD,GAHD,MAGO,IAAIh9B,KAAK,CAAT,EAAY;AACjBsmD,aAAS,CAAC,IAAI7rB,QAAL,IAAiB0X,gBAAgBnV,MAAhB,CAAjB,GACLvC,WAAW0X,gBAAgBnV,SAASkB,MAAzB,CADf;AAEA0oB,aAAS,CAAC,IAAInsB,QAAL,IAAiB0X,gBAAgBnV,SAAS,CAAzB,CAAjB,GACLvC,WAAW0X,gBAAgBnV,SAASkB,MAAT,GAAkB,CAAlC,CADf;AAED,GALM,MAKA,IAAIl+B,MAAM,CAAV,EAAa;AAClB,QAAI46B,KAAKuX,gBAAgBnV,MAAhB,CAAT;AACA,QAAInC,KAAKsX,gBAAgBnV,SAAS,CAAzB,CAAT;AACA,QAAIrnC,SAAS,CAAb;AACA,QAAMkxD,oBAAoB,CAAC,CAAD,CAA1B;AACA,SAAK,IAAInxD,IAAIsnC,SAASkB,MAAtB,EAA8BxoC,IAAI2rB,GAAlC,EAAuC3rB,KAAKwoC,MAA5C,EAAoD;AAClD,UAAMhuB,KAAKiiC,gBAAgBz8C,CAAhB,CAAX;AACA,UAAM+yC,KAAK0J,gBAAgBz8C,IAAI,CAApB,CAAX;AACAC,gBAAU8D,KAAKsG,IAAL,CAAU,CAACmQ,KAAK0qB,EAAN,KAAa1qB,KAAK0qB,EAAlB,IAAwB,CAAC6N,KAAK5N,EAAN,KAAa4N,KAAK5N,EAAlB,CAAlC,CAAV;AACAgsB,wBAAkBnvD,IAAlB,CAAuB/B,MAAvB;AACAilC,WAAK1qB,EAAL;AACA2qB,WAAK4N,EAAL;AACD;AACD,QAAMr0C,SAASqmC,WAAW9kC,MAA1B;AACA,QAAMoE,QAAQ,yBAAa8sD,iBAAb,EAAgCzyD,MAAhC,CAAd;AACA,QAAI2F,QAAQ,CAAZ,EAAe;AACb,UAAMG,IAAI,CAAC9F,SAASyyD,kBAAkB,CAAC9sD,KAAD,GAAS,CAA3B,CAAV,KACL8sD,kBAAkB,CAAC9sD,KAAD,GAAS,CAA3B,IAAgC8sD,kBAAkB,CAAC9sD,KAAD,GAAS,CAA3B,CAD3B,CAAV;AAEA,UAAM+sD,IAAI9pB,SAAS,CAAC,CAACjjC,KAAD,GAAS,CAAV,IAAemkC,MAAlC;AACAooB,eAAS,gBACPnU,gBAAgB2U,CAAhB,CADO,EACa3U,gBAAgB2U,IAAI5oB,MAApB,CADb,EAC0ChkC,CAD1C,CAAT;AAEA0sD,eAAS,gBACPzU,gBAAgB2U,IAAI,CAApB,CADO,EACiB3U,gBAAgB2U,IAAI5oB,MAAJ,GAAa,CAA7B,CADjB,EACkDhkC,CADlD,CAAT;AAED,KARD,MAQO;AACLosD,eAASnU,gBAAgBnV,SAASjjC,QAAQmkC,MAAjC,CAAT;AACA0oB,eAASzU,gBAAgBnV,SAASjjC,QAAQmkC,MAAjB,GAA0B,CAA1C,CAAT;AACD;AACF;AACD,MAAIugB,QAAJ,EAAc;AACZA,aAAS,CAAT,IAAc6H,MAAd;AACA7H,aAAS,CAAT,IAAcmI,MAAd;AACA,WAAOnI,QAAP;AACD,GAJD,MAIO;AACL,WAAO,CAAC6H,MAAD,EAASM,MAAT,CAAP;AACD;AACF;;AAGD;;;;;;;;;AASO,SAASF,uBAAT,CAAiCvU,eAAjC,EAAkDnV,MAAlD,EAA0D3b,GAA1D,EAA+D6c,MAA/D,EAAuEr/B,CAAvE,EAA0E0/C,WAA1E,EAAuF;AAC5F,MAAIl9B,OAAO2b,MAAX,EAAmB;AACjB,WAAO,IAAP;AACD;AACD,MAAI7Z,mBAAJ;AACA,MAAItkB,IAAIszC,gBAAgBnV,SAASkB,MAAT,GAAkB,CAAlC,CAAR,EAA8C;AAC5C,QAAIqgB,WAAJ,EAAiB;AACfp7B,mBAAagvB,gBAAgB58C,KAAhB,CAAsBynC,MAAtB,EAA8BA,SAASkB,MAAvC,CAAb;AACA/a,iBAAW+a,SAAS,CAApB,IAAyBr/B,CAAzB;AACA,aAAOskB,UAAP;AACD,KAJD,MAIO;AACL,aAAO,IAAP;AACD;AACF,GARD,MAQO,IAAIgvB,gBAAgB9wB,MAAM,CAAtB,IAA2BxiB,CAA/B,EAAkC;AACvC,QAAI0/C,WAAJ,EAAiB;AACfp7B,mBAAagvB,gBAAgB58C,KAAhB,CAAsB8rB,MAAM6c,MAA5B,EAAoC7c,GAApC,CAAb;AACA8B,iBAAW+a,SAAS,CAApB,IAAyBr/B,CAAzB;AACA,aAAOskB,UAAP;AACD,KAJD,MAIO;AACL,aAAO,IAAP;AACD;AACF;AACD;AACA,MAAItkB,KAAKszC,gBAAgBnV,SAASkB,MAAT,GAAkB,CAAlC,CAAT,EAA+C;AAC7C,WAAOiU,gBAAgB58C,KAAhB,CAAsBynC,MAAtB,EAA8BA,SAASkB,MAAvC,CAAP;AACD;AACD,MAAI6oB,KAAK/pB,SAASkB,MAAlB;AACA,MAAI8oB,KAAK3lC,MAAM6c,MAAf;AACA,SAAO6oB,KAAKC,EAAZ,EAAgB;AACd,QAAMzmB,MAAOwmB,KAAKC,EAAN,IAAa,CAAzB;AACA,QAAInoD,IAAIszC,gBAAgB,CAAC5R,MAAM,CAAP,IAAYrC,MAAZ,GAAqB,CAArC,CAAR,EAAiD;AAC/C8oB,WAAKzmB,GAAL;AACD,KAFD,MAEO;AACLwmB,WAAKxmB,MAAM,CAAX;AACD;AACF;AACD,MAAM0mB,KAAK9U,gBAAgB4U,KAAK7oB,MAAL,GAAc,CAA9B,CAAX;AACA,MAAIr/B,KAAKooD,EAAT,EAAa;AACX,WAAO9U,gBAAgB58C,KAAhB,CAAsB,CAACwxD,KAAK,CAAN,IAAW7oB,MAAjC,EAAyC,CAAC6oB,KAAK,CAAN,IAAW7oB,MAAX,GAAoBA,MAA7D,CAAP;AACD;AACD,MAAM7mB,KAAK86B,gBAAgB,CAAC4U,KAAK,CAAN,IAAW7oB,MAAX,GAAoB,CAApC,CAAX;AACA,MAAMhkC,IAAI,CAAC2E,IAAIooD,EAAL,KAAY5vC,KAAK4vC,EAAjB,CAAV;AACA9jC,eAAa,EAAb;AACA,OAAK,IAAIztB,IAAI,CAAb,EAAgBA,IAAIwoC,SAAS,CAA7B,EAAgC,EAAExoC,CAAlC,EAAqC;AACnCytB,eAAWzrB,IAAX,CAAgB,gBAAKy6C,gBAAgB,CAAC4U,KAAK,CAAN,IAAW7oB,MAAX,GAAoBxoC,CAApC,CAAL,EACdy8C,gBAAgB4U,KAAK7oB,MAAL,GAAcxoC,CAA9B,CADc,EACoBwE,CADpB,CAAhB;AAED;AACDipB,aAAWzrB,IAAX,CAAgBmH,CAAhB;AACA,SAAOskB,UAAP;AACD;;AAGD;;;;;;;;;;AAUO,SAASwjC,wBAAT,CACLxU,eADK,EACYnV,MADZ,EACoBwiB,IADpB,EAC0BthB,MAD1B,EACkCr/B,CADlC,EACqC0/C,WADrC,EACkDl9C,WADlD,EAC+D;AACpE,MAAIA,WAAJ,EAAiB;AACf,WAAOqlD,wBACLvU,eADK,EACYnV,MADZ,EACoBwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CADpB,EAC2CuoC,MAD3C,EACmDr/B,CADnD,EACsD0/C,WADtD,CAAP;AAED;AACD,MAAIp7B,mBAAJ;AACA,MAAItkB,IAAIszC,gBAAgBjU,SAAS,CAAzB,CAAR,EAAqC;AACnC,QAAIqgB,WAAJ,EAAiB;AACfp7B,mBAAagvB,gBAAgB58C,KAAhB,CAAsB,CAAtB,EAAyB2oC,MAAzB,CAAb;AACA/a,iBAAW+a,SAAS,CAApB,IAAyBr/B,CAAzB;AACA,aAAOskB,UAAP;AACD,KAJD,MAIO;AACL,aAAO,IAAP;AACD;AACF;AACD,MAAIgvB,gBAAgBA,gBAAgBx8C,MAAhB,GAAyB,CAAzC,IAA8CkJ,CAAlD,EAAqD;AACnD,QAAI0/C,WAAJ,EAAiB;AACfp7B,mBAAagvB,gBAAgB58C,KAAhB,CAAsB48C,gBAAgBx8C,MAAhB,GAAyBuoC,MAA/C,CAAb;AACA/a,iBAAW+a,SAAS,CAApB,IAAyBr/B,CAAzB;AACA,aAAOskB,UAAP;AACD,KAJD,MAIO;AACL,aAAO,IAAP;AACD;AACF;AACD,OAAK,IAAIztB,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACA,QAAIsnC,UAAU3b,GAAd,EAAmB;AACjB;AACD;AACD,QAAIxiB,IAAIszC,gBAAgBnV,SAASkB,MAAT,GAAkB,CAAlC,CAAR,EAA8C;AAC5C,aAAO,IAAP;AACD,KAFD,MAEO,IAAIr/B,KAAKszC,gBAAgB9wB,MAAM,CAAtB,CAAT,EAAmC;AACxC,aAAOqlC,wBACLvU,eADK,EACYnV,MADZ,EACoB3b,GADpB,EACyB6c,MADzB,EACiCr/B,CADjC,EACoC,KADpC,CAAP;AAED;AACDm+B,aAAS3b,GAAT;AACD;AACD,SAAO,IAAP;AACD,C;;;;;;;;;;;;;;;;;QChKe6lC,oB,GAAAA,oB;QAsCAC,yB,GAAAA,yB;QAoBAC,oB,GAAAA,oB;QA6BAC,yB,GAAAA,yB;QAyBAC,8B,GAAAA,8B;;AA7HhB;;AACA;;AACA;;AAGA;;;;;;;;AAQO,SAASJ,oBAAT,CAA8B/U,eAA9B,EAA+CnV,MAA/C,EAAuD3b,GAAvD,EAA4D6c,MAA5D,EAAoEpf,MAApE,EAA4E;AACjF,MAAMyoC,oBAAoB,mCACxB,0BADwB,EACTpV,eADS,EACQnV,MADR,EACgB3b,GADhB,EACqB6c,MADrB,CAA1B;AAEA,MAAI,CAAC,wBAAWpf,MAAX,EAAmByoC,iBAAnB,CAAL,EAA4C;AAC1C,WAAO,KAAP;AACD;AACD,MAAI,4BAAezoC,MAAf,EAAuByoC,iBAAvB,CAAJ,EAA+C;AAC7C,WAAO,IAAP;AACD;AACD,MAAIA,kBAAkB,CAAlB,KAAwBzoC,OAAO,CAAP,CAAxB,IACAyoC,kBAAkB,CAAlB,KAAwBzoC,OAAO,CAAP,CAD5B,EACuC;AACrC,WAAO,IAAP;AACD;AACD,MAAIyoC,kBAAkB,CAAlB,KAAwBzoC,OAAO,CAAP,CAAxB,IACAyoC,kBAAkB,CAAlB,KAAwBzoC,OAAO,CAAP,CAD5B,EACuC;AACrC,WAAO,IAAP;AACD;AACD,SAAO,uBAAeqzB,eAAf,EAAgCnV,MAAhC,EAAwC3b,GAAxC,EAA6C6c,MAA7C;AACL;;;;;;AAMA,YAASspB,MAAT,EAAiBC,MAAjB,EAAyB;AACvB,WAAO,+BAAkB3oC,MAAlB,EAA0B0oC,MAA1B,EAAkCC,MAAlC,CAAP;AACD,GATI,CAAP;AAUD;;AAGD;;;;;;;;AA9CA;;;AAsDO,SAASN,yBAAT,CAAmChV,eAAnC,EAAoDnV,MAApD,EAA4DwiB,IAA5D,EAAkEthB,MAAlE,EAA0Epf,MAA1E,EAAkF;AACvF,OAAK,IAAIppB,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAIwxD,qBACF/U,eADE,EACenV,MADf,EACuBwiB,KAAK9pD,CAAL,CADvB,EACgCwoC,MADhC,EACwCpf,MADxC,CAAJ,EACqD;AACnD,aAAO,IAAP;AACD;AACDke,aAASwiB,KAAK9pD,CAAL,CAAT;AACD;AACD,SAAO,KAAP;AACD;;AAGD;;;;;;;;AAQO,SAAS0xD,oBAAT,CAA8BjV,eAA9B,EAA+CnV,MAA/C,EAAuD3b,GAAvD,EAA4D6c,MAA5D,EAAoEpf,MAApE,EAA4E;AACjF,MAAIooC,qBACF/U,eADE,EACenV,MADf,EACuB3b,GADvB,EAC4B6c,MAD5B,EACoCpf,MADpC,CAAJ,EACiD;AAC/C,WAAO,IAAP;AACD;AACD,MAAI,oCAAqBqzB,eAArB,EAAsCnV,MAAtC,EAA8C3b,GAA9C,EAAmD6c,MAAnD,EAA2Dpf,OAAO,CAAP,CAA3D,EAAsEA,OAAO,CAAP,CAAtE,CAAJ,EAAsF;AACpF,WAAO,IAAP;AACD;AACD,MAAI,oCAAqBqzB,eAArB,EAAsCnV,MAAtC,EAA8C3b,GAA9C,EAAmD6c,MAAnD,EAA2Dpf,OAAO,CAAP,CAA3D,EAAsEA,OAAO,CAAP,CAAtE,CAAJ,EAAsF;AACpF,WAAO,IAAP;AACD;AACD,MAAI,oCAAqBqzB,eAArB,EAAsCnV,MAAtC,EAA8C3b,GAA9C,EAAmD6c,MAAnD,EAA2Dpf,OAAO,CAAP,CAA3D,EAAsEA,OAAO,CAAP,CAAtE,CAAJ,EAAsF;AACpF,WAAO,IAAP;AACD;AACD,MAAI,oCAAqBqzB,eAArB,EAAsCnV,MAAtC,EAA8C3b,GAA9C,EAAmD6c,MAAnD,EAA2Dpf,OAAO,CAAP,CAA3D,EAAsEA,OAAO,CAAP,CAAtE,CAAJ,EAAsF;AACpF,WAAO,IAAP;AACD;AACD,SAAO,KAAP;AACD;;AAGD;;;;;;;;AAQO,SAASuoC,yBAAT,CAAmClV,eAAnC,EAAoDnV,MAApD,EAA4DwiB,IAA5D,EAAkEthB,MAAlE,EAA0Epf,MAA1E,EAAkF;AACvF,MAAI,CAACsoC,qBACHjV,eADG,EACcnV,MADd,EACsBwiB,KAAK,CAAL,CADtB,EAC+BthB,MAD/B,EACuCpf,MADvC,CAAL,EACqD;AACnD,WAAO,KAAP;AACD;AACD,MAAI0gC,KAAK7pD,MAAL,KAAgB,CAApB,EAAuB;AACrB,WAAO,IAAP;AACD;AACD,OAAK,IAAID,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAI,wCAAyBy8C,eAAzB,EAA0CqN,KAAK9pD,IAAI,CAAT,CAA1C,EAAuD8pD,KAAK9pD,CAAL,CAAvD,EAAgEwoC,MAAhE,EAAwEpf,MAAxE,CAAJ,EAAqF;AACnF,aAAO,KAAP;AACD;AACF;AACD,SAAO,IAAP;AACD;;AAGD;;;;;;;;AAQO,SAASwoC,8BAAT,CAAwCnV,eAAxC,EAAyDnV,MAAzD,EAAiE2kB,KAAjE,EAAwEzjB,MAAxE,EAAgFpf,MAAhF,EAAwF;AAC7F,OAAK,IAAIppB,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACA,QAAI2xD,0BACFlV,eADE,EACenV,MADf,EACuBwiB,IADvB,EAC6BthB,MAD7B,EACqCpf,MADrC,CAAJ,EACkD;AAChD,aAAO,IAAP;AACD;AACDke,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD,SAAO,KAAP;AACD,C;;;;;;;;;;;;;;;;;QC9He+xD,gB,GAAAA,gB;QAsBAC,gB,GAAAA,gB;AAlChB;;;;AAKA;;;;;;;AAOO,SAASD,gBAAT,CAA0BvV,eAA1B,EAA2CnV,MAA3C,EAAmD3b,GAAnD,EAAwD6c,MAAxD,EAAgE;AACrE,MAAItD,KAAKuX,gBAAgBnV,MAAhB,CAAT;AACA,MAAInC,KAAKsX,gBAAgBnV,SAAS,CAAzB,CAAT;AACA,MAAIrnC,SAAS,CAAb;AACA,OAAK,IAAID,IAAIsnC,SAASkB,MAAtB,EAA8BxoC,IAAI2rB,GAAlC,EAAuC3rB,KAAKwoC,MAA5C,EAAoD;AAClD,QAAMhuB,KAAKiiC,gBAAgBz8C,CAAhB,CAAX;AACA,QAAM+yC,KAAK0J,gBAAgBz8C,IAAI,CAApB,CAAX;AACAC,cAAU8D,KAAKsG,IAAL,CAAU,CAACmQ,KAAK0qB,EAAN,KAAa1qB,KAAK0qB,EAAlB,IAAwB,CAAC6N,KAAK5N,EAAN,KAAa4N,KAAK5N,EAAlB,CAAlC,CAAV;AACAD,SAAK1qB,EAAL;AACA2qB,SAAK4N,EAAL;AACD;AACD,SAAO9yC,MAAP;AACD;;AAGD;;;;;;;AAOO,SAASgyD,gBAAT,CAA0BxV,eAA1B,EAA2CnV,MAA3C,EAAmD3b,GAAnD,EAAwD6c,MAAxD,EAAgE;AACrE,MAAI0pB,YAAYF,iBAAiBvV,eAAjB,EAAkCnV,MAAlC,EAA0C3b,GAA1C,EAA+C6c,MAA/C,CAAhB;AACA,MAAM1c,KAAK2wB,gBAAgB9wB,MAAM6c,MAAtB,IAAgCiU,gBAAgBnV,MAAhB,CAA3C;AACA,MAAMvb,KAAK0wB,gBAAgB9wB,MAAM6c,MAAN,GAAe,CAA/B,IAAoCiU,gBAAgBnV,SAAS,CAAzB,CAA/C;AACA4qB,eAAanuD,KAAKsG,IAAL,CAAUyhB,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,CAAb;AACA,SAAOmmC,SAAP;AACD,C;;;;;;;;;;;;;;;;;QC3BeC,qB,GAAAA,qB;QA8BAC,oB,GAAAA,oB;QAkCAC,sB,GAAAA,sB;QAwBAC,iB,GAAAA,iB;QA+BAC,sB,GAAAA,sB;;AAjIhB;;AAGA;;;;;;;AAOO,SAASJ,qBAAT,CAA+B1V,eAA/B,EAAgDnV,MAAhD,EAAwD3b,GAAxD,EAA6D6c,MAA7D,EAAqE;AAC1E;AACA;AACA,MAAIgqB,OAAO,CAAX;AACA,MAAIttB,KAAKuX,gBAAgB9wB,MAAM6c,MAAtB,CAAT;AACA,MAAIrD,KAAKsX,gBAAgB9wB,MAAM6c,MAAN,GAAe,CAA/B,CAAT;AACA,SAAOlB,SAAS3b,GAAhB,EAAqB2b,UAAUkB,MAA/B,EAAuC;AACrC,QAAMhuB,KAAKiiC,gBAAgBnV,MAAhB,CAAX;AACA,QAAMyL,KAAK0J,gBAAgBnV,SAAS,CAAzB,CAAX;AACAkrB,YAAQ,CAACh4C,KAAK0qB,EAAN,KAAa6N,KAAK5N,EAAlB,CAAR;AACAD,SAAK1qB,EAAL;AACA2qB,SAAK4N,EAAL;AACD;AACD,SAAOyf,OAAO,CAAd;AACD;;AAGD;;;;;;;;;;;;;AA9BA;;;AA2CO,SAASJ,oBAAT,CAA8B3V,eAA9B,EAA+CnV,MAA/C,EAAuDwiB,IAAvD,EAA6DthB,MAA7D,EAAqE8iB,SAArE,EAAgF;AACrF,MAAM1I,QAAQ0I,cAAc1qD,SAAd,GAA0B0qD,SAA1B,GAAsC,KAApD;AACA,OAAK,IAAItrD,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACA,QAAMyyD,cAAcN,sBAClB1V,eADkB,EACDnV,MADC,EACO3b,GADP,EACY6c,MADZ,CAApB;AAEA,QAAIxoC,MAAM,CAAV,EAAa;AACX,UAAK4iD,SAAS6P,WAAV,IAA2B,CAAC7P,KAAD,IAAU,CAAC6P,WAA1C,EAAwD;AACtD,eAAO,KAAP;AACD;AACF,KAJD,MAIO;AACL,UAAK7P,SAAS,CAAC6P,WAAX,IAA4B,CAAC7P,KAAD,IAAU6P,WAA1C,EAAwD;AACtD,eAAO,KAAP;AACD;AACF;AACDnrB,aAAS3b,GAAT;AACD;AACD,SAAO,IAAP;AACD;;AAGD;;;;;;;;;;;;;AAaO,SAAS0mC,sBAAT,CAAgC5V,eAAhC,EAAiDnV,MAAjD,EAAyD2kB,KAAzD,EAAgEzjB,MAAhE,EAAwE8iB,SAAxE,EAAmF;AACxF,OAAK,IAAItrD,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAI,CAACoyD,qBACH3V,eADG,EACcnV,MADd,EACsB2kB,MAAMjsD,CAAN,CADtB,EACgCwoC,MADhC,EACwC8iB,SADxC,CAAL,EACyD;AACvD,aAAO,KAAP;AACD;AACF;AACD,SAAO,IAAP;AACD;;AAGD;;;;;;;;;;;;;AAaO,SAASgH,iBAAT,CAA2B7V,eAA3B,EAA4CnV,MAA5C,EAAoDwiB,IAApD,EAA0DthB,MAA1D,EAAkE8iB,SAAlE,EAA6E;AAClF,MAAM1I,QAAQ0I,cAAc1qD,SAAd,GAA0B0qD,SAA1B,GAAsC,KAApD;AACA,OAAK,IAAItrD,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACA,QAAMyyD,cAAcN,sBAClB1V,eADkB,EACDnV,MADC,EACO3b,GADP,EACY6c,MADZ,CAApB;AAEA,QAAM5xB,UAAU5W,MAAM,CAAN,GACb4iD,SAAS6P,WAAV,IAA2B,CAAC7P,KAAD,IAAU,CAAC6P,WADxB,GAEb7P,SAAS,CAAC6P,WAAX,IAA4B,CAAC7P,KAAD,IAAU6P,WAFxC;AAGA,QAAI77C,OAAJ,EAAa;AACX,gCAAmB6lC,eAAnB,EAAoCnV,MAApC,EAA4C3b,GAA5C,EAAiD6c,MAAjD;AACD;AACDlB,aAAS3b,GAAT;AACD;AACD,SAAO2b,MAAP;AACD;;AAGD;;;;;;;;;;;;;AAaO,SAASirB,sBAAT,CAAgC9V,eAAhC,EAAiDnV,MAAjD,EAAyD2kB,KAAzD,EAAgEzjB,MAAhE,EAAwE8iB,SAAxE,EAAmF;AACxF,OAAK,IAAItrD,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9CsnC,aAASgrB,kBACP7V,eADO,EACUnV,MADV,EACkB2kB,MAAMjsD,CAAN,CADlB,EAC4BwoC,MAD5B,EACoC8iB,SADpC,CAAT;AAED;AACD,SAAOhkB,MAAP;AACD,C;;;;;;;;;;;;;;;;;QC/HesU,W,GAAAA,W;AAXhB;;;;AAKA;;;;;;AAMO,SAASA,WAAT,CAAqBa,eAArB,EAAsCnV,MAAtC,EAA8C3b,GAA9C,EAAmD6c,MAAnD,EAA2D;AAChE,SAAOlB,SAAS3b,MAAM6c,MAAtB,EAA8B;AAC5B,SAAK,IAAIxoC,IAAI,CAAb,EAAgBA,IAAIwoC,MAApB,EAA4B,EAAExoC,CAA9B,EAAiC;AAC/B,UAAMmrC,MAAMsR,gBAAgBnV,SAAStnC,CAAzB,CAAZ;AACAy8C,sBAAgBnV,SAAStnC,CAAzB,IAA8By8C,gBAAgB9wB,MAAM6c,MAAN,GAAexoC,CAA/B,CAA9B;AACAy8C,sBAAgB9wB,MAAM6c,MAAN,GAAexoC,CAA/B,IAAoCmrC,GAApC;AACD;AACD7D,cAAUkB,MAAV;AACA7c,WAAO6c,MAAP;AACD;AACF,C;;;;;;;;;;;;;;;;;QCDe9oC,O,GAAAA,O;AApBhB;;;;AAKA;;;;;;;;;;;;;;;AAeO,SAASA,OAAT,CAAiB+8C,eAAjB,EAAkCnV,MAAlC,EAA0C3b,GAA1C,EAA+C6c,MAA/C,EAAuDzQ,QAAvD,EAAiEQ,QAAjE,EAA2E;AAChF,MAAMu5B,SAAS,CAACrV,gBAAgBnV,MAAhB,CAAD,EAA0BmV,gBAAgBnV,SAAS,CAAzB,CAA1B,CAAf;AACA,MAAMyqB,SAAS,EAAf;AACA,MAAIW,YAAJ;AACA,SAAQprB,SAASkB,MAAV,GAAoB7c,GAA3B,EAAgC2b,UAAUkB,MAA1C,EAAkD;AAChDupB,WAAO,CAAP,IAAYtV,gBAAgBnV,SAASkB,MAAzB,CAAZ;AACAupB,WAAO,CAAP,IAAYtV,gBAAgBnV,SAASkB,MAAT,GAAkB,CAAlC,CAAZ;AACAkqB,UAAM36B,SAASxc,IAAT,CAAcgd,QAAd,EAAwBu5B,MAAxB,EAAgCC,MAAhC,CAAN;AACA,QAAIW,GAAJ,EAAS;AACP,aAAOA,GAAP;AACD;AACDZ,WAAO,CAAP,IAAYC,OAAO,CAAP,CAAZ;AACAD,WAAO,CAAP,IAAYC,OAAO,CAAP,CAAZ;AACD;AACD,SAAO,KAAP;AACD,C;;;;;;;;;;;;;;;;;QCQeY,kB,GAAAA,kB;QA8BAC,c,GAAAA,c;QAuEAC,mB,GAAAA,mB;QA2BAC,wB,GAAAA,wB;QA2BAC,c,GAAAA,c;QA2CAC,I,GAAAA,I;QAwBAC,Q,GAAAA,Q;QAqFAC,a,GAAAA,a;QA6BAC,kB,GAAAA,kB;;AA9VhB;;AAGA;;;;;;;;;;;AAWO,SAASR,kBAAT,CAA4BlW,eAA5B,EAA6CnV,MAA7C,EAAqD3b,GAArD,EACL6c,MADK,EACGyd,gBADH,EACqBmN,WADrB,EACkCC,6BADlC,EACiE;AACtE,MAAMnK,4BAA4BmK,kCAAkCzyD,SAAlC,GAChCyyD,6BADgC,GACA,EADlC;AAEA,MAAI,CAACD,WAAL,EAAkB;AAChBznC,UAAMonC,eAAetW,eAAf,EAAgCnV,MAAhC,EAAwC3b,GAAxC,EACJ6c,MADI,EACIyd,gBADJ,EAEJiD,yBAFI,EAEuB,CAFvB,CAAN;AAGAzM,sBAAkByM,yBAAlB;AACA5hB,aAAS,CAAT;AACAkB,aAAS,CAAT;AACD;AACD0gB,4BAA0BjpD,MAA1B,GAAmC2yD,eACjCnW,eADiC,EAChBnV,MADgB,EACR3b,GADQ,EACH6c,MADG,EACKyd,gBADL,EAEjCiD,yBAFiC,EAEN,CAFM,CAAnC;AAGA,SAAOA,yBAAP;AACD;;AAGD;;;;;;;;;;;AA9DA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AA8CO,SAAS0J,cAAT,CAAwBnW,eAAxB,EAAyCnV,MAAzC,EAAiD3b,GAAjD,EACL6c,MADK,EACGyd,gBADH,EACqBiD,yBADrB,EACgDoK,gBADhD,EACkE;AACvE,MAAMhpD,IAAI,CAACqhB,MAAM2b,MAAP,IAAiBkB,MAA3B;AACA,MAAIl+B,IAAI,CAAR,EAAW;AACT,WAAOg9B,SAAS3b,GAAhB,EAAqB2b,UAAUkB,MAA/B,EAAuC;AACrC0gB,gCAA0BoK,kBAA1B,IACI7W,gBAAgBnV,MAAhB,CADJ;AAEA4hB,gCAA0BoK,kBAA1B,IACI7W,gBAAgBnV,SAAS,CAAzB,CADJ;AAED;AACD,WAAOgsB,gBAAP;AACD;AACD;AACA,MAAMC,UAAU,IAAIlyD,KAAJ,CAAUiJ,CAAV,CAAhB;AACAipD,UAAQ,CAAR,IAAa,CAAb;AACAA,UAAQjpD,IAAI,CAAZ,IAAiB,CAAjB;AACA;AACA,MAAMoS,QAAQ,CAAC4qB,MAAD,EAAS3b,MAAM6c,MAAf,CAAd;AACA,MAAInkC,QAAQ,CAAZ;AACA,SAAOqY,MAAMzc,MAAN,GAAe,CAAtB,EAAyB;AACvB,QAAMuzD,OAAO92C,MAAM2F,GAAN,EAAb;AACA,QAAMoxC,QAAQ/2C,MAAM2F,GAAN,EAAd;AACA,QAAIqxC,qBAAqB,CAAzB;AACA,QAAMxuB,KAAKuX,gBAAgBgX,KAAhB,CAAX;AACA,QAAMtuB,KAAKsX,gBAAgBgX,QAAQ,CAAxB,CAAX;AACA,QAAMj5C,KAAKiiC,gBAAgB+W,IAAhB,CAAX;AACA,QAAMzgB,KAAK0J,gBAAgB+W,OAAO,CAAvB,CAAX;AACA,SAAK,IAAIxzD,IAAIyzD,QAAQjrB,MAArB,EAA6BxoC,IAAIwzD,IAAjC,EAAuCxzD,KAAKwoC,MAA5C,EAAoD;AAClD,UAAMp+B,IAAIqyC,gBAAgBz8C,CAAhB,CAAV;AACA,UAAMmY,IAAIskC,gBAAgBz8C,IAAI,CAApB,CAAV;AACA,UAAMuyC,mBAAkB,kCACtBnoC,CADsB,EACnB+N,CADmB,EAChB+sB,EADgB,EACZC,EADY,EACR3qB,EADQ,EACJu4B,EADI,CAAxB;AAEA,UAAIR,mBAAkBmhB,kBAAtB,EAA0C;AACxCrvD,gBAAQrE,CAAR;AACA0zD,6BAAqBnhB,gBAArB;AACD;AACF;AACD,QAAImhB,qBAAqBzN,gBAAzB,EAA2C;AACzCsN,cAAQ,CAAClvD,QAAQijC,MAAT,IAAmBkB,MAA3B,IAAqC,CAArC;AACA,UAAIirB,QAAQjrB,MAAR,GAAiBnkC,KAArB,EAA4B;AAC1BqY,cAAM1a,IAAN,CAAWyxD,KAAX,EAAkBpvD,KAAlB;AACD;AACD,UAAIA,QAAQmkC,MAAR,GAAiBgrB,IAArB,EAA2B;AACzB92C,cAAM1a,IAAN,CAAWqC,KAAX,EAAkBmvD,IAAlB;AACD;AACF;AACF;AACD,OAAK,IAAIxzD,KAAI,CAAb,EAAgBA,KAAIsK,CAApB,EAAuB,EAAEtK,EAAzB,EAA4B;AAC1B,QAAIuzD,QAAQvzD,EAAR,CAAJ,EAAgB;AACdkpD,gCAA0BoK,kBAA1B,IACI7W,gBAAgBnV,SAAStnC,KAAIwoC,MAA7B,CADJ;AAEA0gB,gCAA0BoK,kBAA1B,IACI7W,gBAAgBnV,SAAStnC,KAAIwoC,MAAb,GAAsB,CAAtC,CADJ;AAED;AACF;AACD,SAAO8qB,gBAAP;AACD;;AAGD;;;;;;;;;;;;AAYO,SAAST,mBAAT,CAA6BpW,eAA7B,EAA8CnV,MAA9C,EACLwiB,IADK,EACCthB,MADD,EACSyd,gBADT,EAC2BiD,yBAD3B,EAELoK,gBAFK,EAEanJ,cAFb,EAE6B;AAClC,OAAK,IAAInqD,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACAszD,uBAAmBV,eACjBnW,eADiB,EACAnV,MADA,EACQ3b,GADR,EACa6c,MADb,EACqByd,gBADrB,EAEjBiD,yBAFiB,EAEUoK,gBAFV,CAAnB;AAGAnJ,mBAAenoD,IAAf,CAAoBsxD,gBAApB;AACAhsB,aAAS3b,GAAT;AACD;AACD,SAAO2nC,gBAAP;AACD;;AAGD;;;;;;;;;;;;AAYO,SAASR,wBAAT,CACLrW,eADK,EACYnV,MADZ,EACoB2kB,KADpB,EAC2BzjB,MAD3B,EACmCyd,gBADnC,EAELiD,yBAFK,EAEsBoK,gBAFtB,EAEwC1H,eAFxC,EAEyD;AAC9D,OAAK,IAAI5rD,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACA,QAAMmqD,iBAAiB,EAAvB;AACAmJ,uBAAmBT,oBACjBpW,eADiB,EACAnV,MADA,EACQwiB,IADR,EACcthB,MADd,EACsByd,gBADtB,EAEjBiD,yBAFiB,EAEUoK,gBAFV,EAE4BnJ,cAF5B,CAAnB;AAGAyB,oBAAgB5pD,IAAhB,CAAqBmoD,cAArB;AACA7iB,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD,SAAOqzD,gBAAP;AACD;;AAGD;;;;;;;;;;;AAWO,SAASP,cAAT,CAAwBtW,eAAxB,EAAyCnV,MAAzC,EAAiD3b,GAAjD,EACL6c,MADK,EACGyd,gBADH,EACqBiD,yBADrB,EACgDoK,gBADhD,EACkE;AACvE,MAAI3nC,OAAO2b,SAASkB,MAApB,EAA4B;AAC1B;AACA,WAAOlB,SAAS3b,GAAhB,EAAqB2b,UAAUkB,MAA/B,EAAuC;AACrC0gB,gCAA0BoK,kBAA1B,IAAgD7W,gBAAgBnV,MAAhB,CAAhD;AACA4hB,gCAA0BoK,kBAA1B,IACI7W,gBAAgBnV,SAAS,CAAzB,CADJ;AAED;AACD,WAAOgsB,gBAAP;AACD;AACD,MAAIpuB,KAAKuX,gBAAgBnV,MAAhB,CAAT;AACA,MAAInC,KAAKsX,gBAAgBnV,SAAS,CAAzB,CAAT;AACA;AACA4hB,4BAA0BoK,kBAA1B,IAAgDpuB,EAAhD;AACAgkB,4BAA0BoK,kBAA1B,IAAgDnuB,EAAhD;AACA,MAAI3qB,KAAK0qB,EAAT;AACA,MAAI6N,KAAK5N,EAAT;AACA,OAAKmC,UAAUkB,MAAf,EAAuBlB,SAAS3b,GAAhC,EAAqC2b,UAAUkB,MAA/C,EAAuD;AACrDhuB,SAAKiiC,gBAAgBnV,MAAhB,CAAL;AACAyL,SAAK0J,gBAAgBnV,SAAS,CAAzB,CAAL;AACA,QAAI,2BAAgBpC,EAAhB,EAAoBC,EAApB,EAAwB3qB,EAAxB,EAA4Bu4B,EAA5B,IAAkCkT,gBAAtC,EAAwD;AACtD;AACAiD,gCAA0BoK,kBAA1B,IAAgD94C,EAAhD;AACA0uC,gCAA0BoK,kBAA1B,IAAgDvgB,EAAhD;AACA7N,WAAK1qB,EAAL;AACA2qB,WAAK4N,EAAL;AACD;AACF;AACD,MAAIv4B,MAAM0qB,EAAN,IAAY6N,MAAM5N,EAAtB,EAA0B;AACxB;AACA+jB,8BAA0BoK,kBAA1B,IAAgD94C,EAAhD;AACA0uC,8BAA0BoK,kBAA1B,IAAgDvgB,EAAhD;AACD;AACD,SAAOugB,gBAAP;AACD;;AAGD;;;;;AAKO,SAASN,IAAT,CAAczvD,KAAd,EAAqBwiD,SAArB,EAAgC;AACrC,SAAOA,YAAYhiD,KAAKoH,KAAL,CAAW5H,QAAQwiD,SAAnB,CAAnB;AACD;;AAGD;;;;;;;;;;;;;;;;;;;AAmBO,SAASkN,QAAT,CAAkBxW,eAAlB,EAAmCnV,MAAnC,EAA2C3b,GAA3C,EAAgD6c,MAAhD,EACLud,SADK,EACMmD,yBADN,EACiCoK,gBADjC,EACmD;AACxD;AACA,MAAIhsB,UAAU3b,GAAd,EAAmB;AACjB,WAAO2nC,gBAAP;AACD;AACD;AACA,MAAIpuB,KAAK8tB,KAAKvW,gBAAgBnV,MAAhB,CAAL,EAA8Bye,SAA9B,CAAT;AACA,MAAI5gB,KAAK6tB,KAAKvW,gBAAgBnV,SAAS,CAAzB,CAAL,EAAkCye,SAAlC,CAAT;AACAze,YAAUkB,MAAV;AACA;AACA0gB,4BAA0BoK,kBAA1B,IAAgDpuB,EAAhD;AACAgkB,4BAA0BoK,kBAA1B,IAAgDnuB,EAAhD;AACA;AACA;AACA,MAAI3qB,WAAJ;AAAA,MAAQu4B,WAAR;AACA,KAAG;AACDv4B,SAAKw4C,KAAKvW,gBAAgBnV,MAAhB,CAAL,EAA8Bye,SAA9B,CAAL;AACAhT,SAAKigB,KAAKvW,gBAAgBnV,SAAS,CAAzB,CAAL,EAAkCye,SAAlC,CAAL;AACAze,cAAUkB,MAAV;AACA,QAAIlB,UAAU3b,GAAd,EAAmB;AACjB;AACA;AACA;AACA;AACAu9B,gCAA0BoK,kBAA1B,IAAgD94C,EAAhD;AACA0uC,gCAA0BoK,kBAA1B,IAAgDvgB,EAAhD;AACA,aAAOugB,gBAAP;AACD;AACF,GAbD,QAaS94C,MAAM0qB,EAAN,IAAY6N,MAAM5N,EAb3B;AAcA,SAAOmC,SAAS3b,GAAhB,EAAqB;AACnB;AACA,QAAM6xB,KAAKwV,KAAKvW,gBAAgBnV,MAAhB,CAAL,EAA8Bye,SAA9B,CAAX;AACA,QAAMtI,KAAKuV,KAAKvW,gBAAgBnV,SAAS,CAAzB,CAAL,EAAkCye,SAAlC,CAAX;AACAze,cAAUkB,MAAV;AACA;AACA,QAAIgV,MAAMhjC,EAAN,IAAYijC,MAAM1K,EAAtB,EAA0B;AACxB;AACD;AACD;AACA,QAAM4gB,MAAMn5C,KAAK0qB,EAAjB;AACA,QAAM0uB,MAAM7gB,KAAK5N,EAAjB;AACA;AACA,QAAM0uB,MAAMrW,KAAKtY,EAAjB;AACA,QAAM4uB,MAAMrW,KAAKtY,EAAjB;AACA;AACA;AACA;AACA,QAAKwuB,MAAMG,GAAN,IAAaF,MAAMC,GAApB,KACEF,MAAM,CAAN,IAAWE,MAAMF,GAAlB,IAA0BA,OAAOE,GAAjC,IAAyCF,MAAM,CAAN,IAAWE,MAAMF,GAD3D,MAEEC,MAAM,CAAN,IAAWE,MAAMF,GAAlB,IAA0BA,OAAOE,GAAjC,IAAyCF,MAAM,CAAN,IAAWE,MAAMF,GAF3D,CAAJ,EAEsE;AACpE;AACAp5C,WAAKgjC,EAAL;AACAzK,WAAK0K,EAAL;AACA;AACD;AACD;AACA;AACA;AACAyL,8BAA0BoK,kBAA1B,IAAgD94C,EAAhD;AACA0uC,8BAA0BoK,kBAA1B,IAAgDvgB,EAAhD;AACA7N,SAAK1qB,EAAL;AACA2qB,SAAK4N,EAAL;AACAv4B,SAAKgjC,EAAL;AACAzK,SAAK0K,EAAL;AACD;AACD;AACAyL,4BAA0BoK,kBAA1B,IAAgD94C,EAAhD;AACA0uC,4BAA0BoK,kBAA1B,IAAgDvgB,EAAhD;AACA,SAAOugB,gBAAP;AACD;;AAGD;;;;;;;;;;;;AAYO,SAASJ,aAAT,CACLzW,eADK,EACYnV,MADZ,EACoBwiB,IADpB,EAC0BthB,MAD1B,EAELud,SAFK,EAGLmD,yBAHK,EAGsBoK,gBAHtB,EAGwCnJ,cAHxC,EAGwD;AAC7D,OAAK,IAAInqD,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACAszD,uBAAmBL,SACjBxW,eADiB,EACAnV,MADA,EACQ3b,GADR,EACa6c,MADb,EAEjBud,SAFiB,EAGjBmD,yBAHiB,EAGUoK,gBAHV,CAAnB;AAIAnJ,mBAAenoD,IAAf,CAAoBsxD,gBAApB;AACAhsB,aAAS3b,GAAT;AACD;AACD,SAAO2nC,gBAAP;AACD;;AAGD;;;;;;;;;;;;AAYO,SAASH,kBAAT,CACL1W,eADK,EACYnV,MADZ,EACoB2kB,KADpB,EAC2BzjB,MAD3B,EAELud,SAFK,EAGLmD,yBAHK,EAGsBoK,gBAHtB,EAGwC1H,eAHxC,EAGyD;AAC9D,OAAK,IAAI5rD,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACA,QAAMmqD,iBAAiB,EAAvB;AACAmJ,uBAAmBJ,cACjBzW,eADiB,EACAnV,MADA,EACQwiB,IADR,EACcthB,MADd,EAEjBud,SAFiB,EAGjBmD,yBAHiB,EAGUoK,gBAHV,EAG4BnJ,cAH5B,CAAnB;AAIAyB,oBAAgB5pD,IAAhB,CAAqBmoD,cAArB;AACA7iB,aAASwiB,KAAKA,KAAK7pD,MAAL,GAAc,CAAnB,CAAT;AACD;AACD,SAAOqzD,gBAAP;AACD,C;;;;;;;;;;;;;;;;;QC5XeS,a,GAAAA,a;AAdhB;;;;AAKA;;;;;;;;;AASO,SAASA,aAAT,CAAuBC,QAAvB,EAAiCvX,eAAjC,EAAkDnV,MAAlD,EAA0D3b,GAA1D,EAA+D6c,MAA/D,EAAuE;AAC5E,MAAIyrB,aAAa3sB,MAAjB;AACA,MAAI4sB,WAAW5sB,MAAf;AACA,MAAI6sB,SAAS,CAAb;AACA,MAAIhrD,IAAI,CAAR;AACA,MAAIs6B,QAAQ6D,MAAZ;AACA,MAAIx8B,aAAJ;AAAA,MAAU9K,UAAV;AAAA,MAAao0D,YAAb;AAAA,MAAkBC,YAAlB;AAAA,MAAuBnvB,WAAvB;AAAA,MAA2BC,WAA3B;AAAA,MAA+BmvB,YAA/B;AAAA,MAAoCC,YAApC;AAAA,MAAyCC,YAAzC;AAAA,MAA8CC,YAA9C;AACA,OAAKz0D,IAAIsnC,MAAT,EAAiBtnC,IAAI2rB,GAArB,EAA0B3rB,KAAKwoC,MAA/B,EAAuC;AACrC,QAAMhuB,KAAKiiC,gBAAgBz8C,CAAhB,CAAX;AACA,QAAM+yC,KAAK0J,gBAAgBz8C,IAAI,CAApB,CAAX;AACA,QAAIklC,OAAOtkC,SAAX,EAAsB;AACpB4zD,YAAMh6C,KAAK0qB,EAAX;AACAuvB,YAAM1hB,KAAK5N,EAAX;AACAkvB,YAAMtwD,KAAKsG,IAAL,CAAUmqD,MAAMA,GAAN,GAAYC,MAAMA,GAA5B,CAAN;AACA,UAAIH,QAAQ1zD,SAAZ,EAAuB;AACrBuI,aAAKirD,GAAL;AACAtpD,eAAO/G,KAAK+G,IAAL,CAAU,CAACwpD,MAAME,GAAN,GAAYD,MAAME,GAAnB,KAA2BL,MAAMC,GAAjC,CAAV,CAAP;AACA,YAAIvpD,OAAOkpD,QAAX,EAAqB;AACnB,cAAI7qD,IAAIgrD,MAAR,EAAgB;AACdA,qBAAShrD,CAAT;AACA8qD,yBAAaxwB,KAAb;AACAywB,uBAAWl0D,CAAX;AACD;AACDmJ,cAAI,CAAJ;AACAs6B,kBAAQzjC,IAAIwoC,MAAZ;AACD;AACF;AACD4rB,YAAMC,GAAN;AACAC,YAAME,GAAN;AACAD,YAAME,GAAN;AACD;AACDvvB,SAAK1qB,EAAL;AACA2qB,SAAK4N,EAAL;AACD;AACD5pC,OAAKkrD,GAAL;AACA,SAAOlrD,IAAIgrD,MAAJ,GAAa,CAAC1wB,KAAD,EAAQzjC,CAAR,CAAb,GAA0B,CAACi0D,UAAD,EAAaC,QAAb,CAAjC;AACD,C;;;;;;;;;;;;;;;;;QC/BeQ,c,GAAAA,c;;AAhBhB;;AAGA;;;;;;;;;;;;;AAaO,SAASA,cAAT,CACLjY,eADK,EACYnV,MADZ,EACoB3b,GADpB,EACyB6c,MADzB,EACiCmsB,IADjC,EACuCC,OADvC,EACgDC,MADhD,EACwDb,QADxD,EACkE;AACvE,MAAMz0D,SAAS,EAAf;;AAEA;AACA,MAAMqX,UAAU6lC,gBAAgBnV,MAAhB,IAA0BmV,gBAAgB9wB,MAAM6c,MAAtB,CAA1C;;AAEA,MAAMssB,WAAWH,KAAK10D,MAAtB;;AAEA,MAAIilC,KAAKuX,gBAAgBnV,MAAhB,CAAT;AACA,MAAInC,KAAKsX,gBAAgBnV,SAAS,CAAzB,CAAT;AACAA,YAAUkB,MAAV;AACA,MAAIhuB,KAAKiiC,gBAAgBnV,MAAhB,CAAT;AACA,MAAIyL,KAAK0J,gBAAgBnV,SAAS,CAAzB,CAAT;AACA,MAAIytB,WAAW,CAAf;AACA,MAAIjE,gBAAgB/sD,KAAKsG,IAAL,CAAUtG,KAAKoG,GAAL,CAASqQ,KAAK0qB,EAAd,EAAkB,CAAlB,IAAuBnhC,KAAKoG,GAAL,CAAS4oC,KAAK5N,EAAd,EAAkB,CAAlB,CAAjC,CAApB;;AAEA,MAAI6vB,QAAQ,EAAZ;AACA,MAAIC,cAAc,CAAlB;AACA,MAAI/zC,aAAJ;AAAA,MAAU7c,cAAV;AAAA,MAAiB6wD,sBAAjB;AACA,OAAK,IAAIl1D,IAAI,CAAb,EAAgBA,IAAI80D,QAApB,EAA8B,EAAE90D,CAAhC,EAAmC;AACjCqE,YAAQuS,UAAUk+C,WAAW90D,CAAX,GAAe,CAAzB,GAA6BA,CAArC;AACA,QAAMm1D,OAAOR,KAAKlhB,MAAL,CAAYpvC,KAAZ,CAAb;AACA2wD,YAAQp+C,UAAUu+C,OAAOH,KAAjB,GAAyBA,QAAQG,IAAzC;AACA,QAAMC,aAAaR,QAAQI,KAAR,IAAiBC,WAApC;AACAA,mBAAeG,UAAf;AACA,QAAMC,QAAQR,SAASO,aAAa,CAApC;AACA,WAAO9tB,SAAS3b,MAAM6c,MAAf,IAAyBusB,WAAWjE,aAAX,GAA2BuE,KAA3D,EAAkE;AAChEnwB,WAAK1qB,EAAL;AACA2qB,WAAK4N,EAAL;AACAzL,gBAAUkB,MAAV;AACAhuB,WAAKiiC,gBAAgBnV,MAAhB,CAAL;AACAyL,WAAK0J,gBAAgBnV,SAAS,CAAzB,CAAL;AACAytB,kBAAYjE,aAAZ;AACAA,sBAAgB/sD,KAAKsG,IAAL,CAAUtG,KAAKoG,GAAL,CAASqQ,KAAK0qB,EAAd,EAAkB,CAAlB,IAAuBnhC,KAAKoG,GAAL,CAAS4oC,KAAK5N,EAAd,EAAkB,CAAlB,CAAjC,CAAhB;AACD;AACD,QAAMmwB,aAAaD,QAAQN,QAA3B;AACA,QAAIjhB,QAAQ/vC,KAAK4U,KAAL,CAAWo6B,KAAK5N,EAAhB,EAAoB3qB,KAAK0qB,EAAzB,CAAZ;AACA,QAAItuB,OAAJ,EAAa;AACXk9B,eAASA,QAAQ,CAAR,GAAY,CAAC/vC,KAAKiG,EAAlB,GAAuBjG,KAAKiG,EAArC;AACD;AACD,QAAIkrD,kBAAkBt0D,SAAtB,EAAiC;AAC/B,UAAIyjC,QAAQyP,QAAQohB,aAApB;AACA7wB,eAAUA,QAAQtgC,KAAKiG,EAAd,GAAoB,CAAC,CAAD,GAAKjG,KAAKiG,EAA9B,GAAoCq6B,QAAQ,CAACtgC,KAAKiG,EAAf,GAAqB,IAAIjG,KAAKiG,EAA9B,GAAmC,CAA/E;AACA,UAAIjG,KAAKmH,GAAL,CAASm5B,KAAT,IAAkB2vB,QAAtB,EAAgC;AAC9B,eAAO,IAAP;AACD;AACF;AACD,QAAMroD,cAAc2pD,aAAaxE,aAAjC;AACA,QAAM1mD,IAAI,gBAAK86B,EAAL,EAAS1qB,EAAT,EAAa7O,WAAb,CAAV;AACA,QAAMwM,IAAI,gBAAKgtB,EAAL,EAAS4N,EAAT,EAAapnC,WAAb,CAAV;AACA,QAAIupD,iBAAiBphB,KAArB,EAA4B;AAC1B,UAAIl9B,OAAJ,EAAa;AACXsK,aAAK,CAAL,IAAU9W,CAAV;AACA8W,aAAK,CAAL,IAAU/I,CAAV;AACA+I,aAAK,CAAL,IAAUk0C,aAAa,CAAvB;AACD;AACDl0C,WAAK,CAAL,IAAU8zC,KAAV;AACD,KAPD,MAOO;AACLA,cAAQG,IAAR;AACAF,oBAAcG,UAAd;AACAl0C,aAAO,CAAC9W,CAAD,EAAI+N,CAAJ,EAAOi9C,aAAa,CAApB,EAAuBthB,KAAvB,EAA8BkhB,KAA9B,CAAP;AACA,UAAIp+C,OAAJ,EAAa;AACXrX,eAAO4O,OAAP,CAAe+S,IAAf;AACD,OAFD,MAEO;AACL3hB,eAAOyC,IAAP,CAAYkf,IAAZ;AACD;AACDg0C,sBAAgBphB,KAAhB;AACD;AACD+gB,cAAUO,UAAV;AACD;AACD,SAAO71D,MAAP;AACD,C,CA3FD;;;;;;;;;;;;;;;;;;;QCcgBg2D,W,GAAAA,W;QA0BAztB,M,GAAAA,M;QAmCAwK,K,GAAAA,K;QA+BA4T,S,GAAAA,S;AA1GhB;;;;AAKA;;;;;;;;;AASO,SAASqP,WAAT,CAAqB9Y,eAArB,EAAsCnV,MAAtC,EAA8C3b,GAA9C,EAAmD6c,MAAnD,EAA2DqI,SAA3D,EAAsEkY,QAAtE,EAAgF;AACrF,MAAMyM,OAAOzM,WAAWA,QAAX,GAAsB,EAAnC;AACA,MAAI/oD,IAAI,CAAR;AACA,OAAK,IAAIkJ,IAAIo+B,MAAb,EAAqBp+B,IAAIyiB,GAAzB,EAA8BziB,KAAKs/B,MAAnC,EAA2C;AACzC,QAAMp+B,IAAIqyC,gBAAgBvzC,CAAhB,CAAV;AACA,QAAMiP,IAAIskC,gBAAgBvzC,IAAI,CAApB,CAAV;AACAssD,SAAKx1D,GAAL,IAAY6wC,UAAU,CAAV,IAAezmC,CAAf,GAAmBymC,UAAU,CAAV,IAAe14B,CAAlC,GAAsC04B,UAAU,CAAV,CAAlD;AACA2kB,SAAKx1D,GAAL,IAAY6wC,UAAU,CAAV,IAAezmC,CAAf,GAAmBymC,UAAU,CAAV,IAAe14B,CAAlC,GAAsC04B,UAAU,CAAV,CAAlD;AACD;AACD,MAAIkY,YAAYyM,KAAKv1D,MAAL,IAAeD,CAA/B,EAAkC;AAChCw1D,SAAKv1D,MAAL,GAAcD,CAAd;AACD;AACD,SAAOw1D,IAAP;AACD;;AAGD;;;;;;;;;;AAUO,SAAS1tB,MAAT,CAAgB2U,eAAhB,EAAiCnV,MAAjC,EAAyC3b,GAAzC,EAA8C6c,MAA9C,EAAsDsL,KAAtD,EAA6DjQ,MAA7D,EAAqEklB,QAArE,EAA+E;AACpF,MAAMyM,OAAOzM,WAAWA,QAAX,GAAsB,EAAnC;AACA,MAAMp+C,MAAM5G,KAAK4G,GAAL,CAASmpC,KAAT,CAAZ;AACA,MAAMppC,MAAM3G,KAAK2G,GAAL,CAASopC,KAAT,CAAZ;AACA,MAAM2hB,UAAU5xB,OAAO,CAAP,CAAhB;AACA,MAAM6xB,UAAU7xB,OAAO,CAAP,CAAhB;AACA,MAAI7jC,IAAI,CAAR;AACA,OAAK,IAAIkJ,IAAIo+B,MAAb,EAAqBp+B,IAAIyiB,GAAzB,EAA8BziB,KAAKs/B,MAAnC,EAA2C;AACzC,QAAMhO,SAASiiB,gBAAgBvzC,CAAhB,IAAqBusD,OAApC;AACA,QAAM/6B,SAAS+hB,gBAAgBvzC,IAAI,CAApB,IAAyBwsD,OAAxC;AACAF,SAAKx1D,GAAL,IAAYy1D,UAAUj7B,SAAS7vB,GAAnB,GAAyB+vB,SAAShwB,GAA9C;AACA8qD,SAAKx1D,GAAL,IAAY01D,UAAUl7B,SAAS9vB,GAAnB,GAAyBgwB,SAAS/vB,GAA9C;AACA,SAAK,IAAInL,IAAI0J,IAAI,CAAjB,EAAoB1J,IAAI0J,IAAIs/B,MAA5B,EAAoC,EAAEhpC,CAAtC,EAAyC;AACvCg2D,WAAKx1D,GAAL,IAAYy8C,gBAAgBj9C,CAAhB,CAAZ;AACD;AACF;AACD,MAAIupD,YAAYyM,KAAKv1D,MAAL,IAAeD,CAA/B,EAAkC;AAChCw1D,SAAKv1D,MAAL,GAAcD,CAAd;AACD;AACD,SAAOw1D,IAAP;AACD;;AAGD;;;;;;;;;;;;AAYO,SAASljB,KAAT,CAAemK,eAAf,EAAgCnV,MAAhC,EAAwC3b,GAAxC,EAA6C6c,MAA7C,EAAqDod,EAArD,EAAyDqI,EAAzD,EAA6DpqB,MAA7D,EAAqEklB,QAArE,EAA+E;AACpF,MAAMyM,OAAOzM,WAAWA,QAAX,GAAsB,EAAnC;AACA,MAAM0M,UAAU5xB,OAAO,CAAP,CAAhB;AACA,MAAM6xB,UAAU7xB,OAAO,CAAP,CAAhB;AACA,MAAI7jC,IAAI,CAAR;AACA,OAAK,IAAIkJ,IAAIo+B,MAAb,EAAqBp+B,IAAIyiB,GAAzB,EAA8BziB,KAAKs/B,MAAnC,EAA2C;AACzC,QAAMhO,SAASiiB,gBAAgBvzC,CAAhB,IAAqBusD,OAApC;AACA,QAAM/6B,SAAS+hB,gBAAgBvzC,IAAI,CAApB,IAAyBwsD,OAAxC;AACAF,SAAKx1D,GAAL,IAAYy1D,UAAU7P,KAAKprB,MAA3B;AACAg7B,SAAKx1D,GAAL,IAAY01D,UAAUzH,KAAKvzB,MAA3B;AACA,SAAK,IAAIl7B,IAAI0J,IAAI,CAAjB,EAAoB1J,IAAI0J,IAAIs/B,MAA5B,EAAoC,EAAEhpC,CAAtC,EAAyC;AACvCg2D,WAAKx1D,GAAL,IAAYy8C,gBAAgBj9C,CAAhB,CAAZ;AACD;AACF;AACD,MAAIupD,YAAYyM,KAAKv1D,MAAL,IAAeD,CAA/B,EAAkC;AAChCw1D,SAAKv1D,MAAL,GAAcD,CAAd;AACD;AACD,SAAOw1D,IAAP;AACD;;AAGD;;;;;;;;;;AAUO,SAAStP,SAAT,CAAmBzJ,eAAnB,EAAoCnV,MAApC,EAA4C3b,GAA5C,EAAiD6c,MAAjD,EAAyDhO,MAAzD,EAAiEE,MAAjE,EAAyEquB,QAAzE,EAAmF;AACxF,MAAMyM,OAAOzM,WAAWA,QAAX,GAAsB,EAAnC;AACA,MAAI/oD,IAAI,CAAR;AACA,OAAK,IAAIkJ,IAAIo+B,MAAb,EAAqBp+B,IAAIyiB,GAAzB,EAA8BziB,KAAKs/B,MAAnC,EAA2C;AACzCgtB,SAAKx1D,GAAL,IAAYy8C,gBAAgBvzC,CAAhB,IAAqBsxB,MAAjC;AACAg7B,SAAKx1D,GAAL,IAAYy8C,gBAAgBvzC,IAAI,CAApB,IAAyBwxB,MAArC;AACA,SAAK,IAAIl7B,IAAI0J,IAAI,CAAjB,EAAoB1J,IAAI0J,IAAIs/B,MAA5B,EAAoC,EAAEhpC,CAAtC,EAAyC;AACvCg2D,WAAKx1D,GAAL,IAAYy8C,gBAAgBj9C,CAAhB,CAAZ;AACD;AACF;AACD,MAAIupD,YAAYyM,KAAKv1D,MAAL,IAAeD,CAA/B,EAAkC;AAChCw1D,SAAKv1D,MAAL,GAAcD,CAAd;AACD;AACD,SAAOw1D,IAAP;AACD,C;;;;;;;;;;;;;;;;;;;ACrHD;;AAEA,IAAMG,KAAK,OAAOC,SAAP,KAAqB,WAArB,GACTA,UAAUC,SAAV,CAAoBpqD,WAApB,EADS,GAC2B,EADtC;;AAGA;;;;AARA;;;AAYO,IAAMqqD,4BAAUH,GAAGtqD,OAAH,CAAW,SAAX,MAA0B,CAAC,CAA3C;;AAEP;;;;AAIO,IAAM0qD,0BAASJ,GAAGtqD,OAAH,CAAW,QAAX,MAAyB,CAAC,CAA1B,IAA+BsqD,GAAGtqD,OAAH,CAAW,OAAX,KAAuB,CAAC,CAAtE;;AAEP;;;;AAIO,IAAMutC,0BAAS+c,GAAGtqD,OAAH,CAAW,QAAX,MAAyB,CAAC,CAA1B,IAA+BsqD,GAAGtqD,OAAH,CAAW,MAAX,KAAsB,CAAC,CAArE;;AAEP;;;;AAIO,IAAMwtC,oBAAM8c,GAAGtqD,OAAH,CAAW,WAAX,MAA4B,CAAC,CAAzC;;AAGP;;;;;;;AAOO,IAAMgjB,kDAAqB2nC,OAAOC,gBAAP,IAA2B,CAAtD;;AAGP;;;;AAIO,IAAMC,8CAAmB,YAAW;AACzC,MAAI9tD,MAAM,KAAV;AACA,MAAI;AACFA,UAAM,CAAC,CAACooB,SAAS2D,aAAT,CAAuB,QAAvB,EAAiC0gB,UAAjC,CAA4C,IAA5C,EAAkDshB,WAA1D;AACD,GAFD,CAEE,OAAOjsD,CAAP,EAAU;AACV;AACD;AACD,SAAO9B,GAAP;AACD,CAR+B,EAAzB;;AAWP;;;;;;AAMO,IAAMguD,oCAAc,iBAAiBR,SAArC;;AAGP;;;;;;AAMO,IAAMvhC,wBAAQ,kBAAkB2hC,MAAhC;;AAGP;;;;;AAKO,IAAMK,4BAAU,kBAAkBL,MAAlC;;AAGP;;;;;AAKO,IAAMM,gCAAY,CAAC,CAAEV,UAAUW,gBAA/B;;AAGP;;;;;;AAMO,IAAMC,wBAAQC,gBAAd,C;;;;;;;;;;;;;;;;;;QCHS15C,Q,GAAAA,Q;QAqBA25C,M,GAAAA,M;;AAhHhB;;AAGA;;;;;;;AAQA;;;;;;AAMO,IAAMC,oCAAc,IAApB;;AAGP;;;;;;AAxBA;;;;AA8BA,IAAIC,+BAAJ,C,CAA4B;;;AAG5B;;;;;AAKA,IAAIC,yBAAJ,C,CAAsB;;;AAGtB;;;;;AAKA,IAAIJ,YAAY,KAAhB;;AAGA,IAAI,OAAOT,MAAP,KAAkB,WAAlB,IAAiC,2BAA2BA,MAAhE,EAAwE;AACtE,MAAI;AACF,QAAM/rC,SAAS,gCAAkCuG,SAAS2D,aAAT,CAAuB,QAAvB,CAAjD;AACA,QAAM2iC,KAAK,uBAAW7sC,MAAX,EAAmB,EAAC8sC,8BAA8B,IAA/B,EAAnB,CAAX;AACA,QAAID,EAAJ,EAAQ;AACN,cASEL,SATF,eAAY,IAAZ;AACA,cAQaG,sBARb,4BAAyB,qBAAuBE,GAAGE,YAAH,CAAgBF,GAAGG,gBAAnB,CAAhD;AACA,cAOqCJ,gBAPrC,sBAAmBC,GAAGI,sBAAH,EAAnB;AACD;AACF,GARD,CAQE,OAAOhtD,CAAP,EAAU;AACV;AACD;AACF;;QAEOusD,S,GAAAA,S;QAAWG,sB,GAAAA,sB;QAAwBC,gB,GAAAA,gB;;AAG3C;;;;;AAIO,IAAM9xC,4BAAU,QAAhB;;AAGP;;;;;;;;;;;;;;;;;;;;;;AAsBO,SAAShI,QAAT,CAAkBo6C,SAAlB,EAA6BC,UAA7B,EAAyC;AAC9CD,YAAUj9C,SAAV,GAAsBpa,OAAOC,MAAP,CAAcq3D,WAAWl9C,SAAzB,CAAtB;AACAi9C,YAAUj9C,SAAV,CAAoBuI,WAApB,GAAkC00C,SAAlC;AACD;;AAGD;;;;;AAKA,IAAIE,cAAc,CAAlB;;AAEA;;;;;;;;AAQO,SAASX,MAAT,CAAgBpuD,GAAhB,EAAqB;AAC1B,SAAOA,IAAIgvD,MAAJ,KAAehvD,IAAIgvD,MAAJ,GAAa,EAAED,WAA9B,CAAP;AACD,C;;;;;;;;;;;;;;;;;;;ACjHD;;;;;oDAUQ/lD,O;;;;;;;;;gDACAA,O;;;;;;;;;4CACAA,O;;;;AAXR;;;;;4CAYQA,O;;;;AAXR;;;;;+CAYQA,O;;;;;;;;;sDACAA,O;;;;AAZR;;;;;6CAaQA,O;;;;;;;;;yCACAA,O;;;;;;;;;2CACAA,O;;;;;;;;;gDACAA,O;;;;AAfR;;;;;gDAgBQA,O;;;;AAfR;;;;;iDAgBQA,O;;;;;;;;;2CACAA,O;;;;AAhBR;;;;;mDAiBQA,O;;;;AAhBR;;;;;gDAiBQA,O;;;;AAhBR;;;;;8CAiBQA,O;;;;;;;;;4CACAA,O;;;;;;;;;2CACAA,O;;;;;;;;;yCACAA,O;;;;;;;;;8CACAA,O;;;QAkDQogC,Q,GAAAA,Q;;AAjFhB;;;;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;;;;;;;;;;;;;;;;;;;;AAqBA;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BO,SAASA,QAAT,CAAkBlsB,WAAlB,EAA+B;;AAEpC,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA,MAAM+G,eAAe,IAAIjH,oBAAJ,EAArB;;AAEA,MAAMiyC,UAAU,IAAI1sC,iBAAJ,CAAY,CAAC,KAAb,EAAoB,IAApB,EAA0B,GAA1B,CAAhB;;AAEA,MAAM2sC,qBAAqBzwD,QAAQywD,kBAAR,KAA+B52D,SAA/B,GACzBmG,QAAQywD,kBADiB,GACI,IAD/B;AAEA,MAAIA,kBAAJ,EAAwB;AACtBjrC,iBAAavqB,IAAb,CAAkB,IAAIy1D,oBAAJ,EAAlB;AACD;;AAED,MAAMC,kBAAkB3wD,QAAQ2wD,eAAR,KAA4B92D,SAA5B,GACtBmG,QAAQ2wD,eADc,GACI,IAD5B;AAEA,MAAIA,eAAJ,EAAqB;AACnBnrC,iBAAavqB,IAAb,CAAkB,IAAI21D,yBAAJ,CAAoB;AACpCtzB,aAAOt9B,QAAQ6wD,SADqB;AAEpC/rC,gBAAU9kB,QAAQ8wD;AAFkB,KAApB,CAAlB;AAID;;AAED,MAAMC,UAAU/wD,QAAQ+wD,OAAR,KAAoBl3D,SAApB,GAAgCmG,QAAQ+wD,OAAxC,GAAkD,IAAlE;AACA,MAAIA,OAAJ,EAAa;AACXvrC,iBAAavqB,IAAb,CAAkB,IAAI+1D,iBAAJ,CAAY;AAC5BR,eAASA;AADmB,KAAZ,CAAlB;AAGD;;AAED,MAAMS,cAAcjxD,QAAQixD,WAAR,KAAwBp3D,SAAxB,GAAoCmG,QAAQixD,WAA5C,GAClB,IADF;AAEA,MAAIA,WAAJ,EAAiB;AACfzrC,iBAAavqB,IAAb,CAAkB,IAAIi2D,qBAAJ,EAAlB;AACD;;AAED,MAAMC,YAAYnxD,QAAQmxD,SAAR,KAAsBt3D,SAAtB,GAAkCmG,QAAQmxD,SAA1C,GAAsD,IAAxE;AACA,MAAIA,SAAJ,EAAe;AACb3rC,iBAAavqB,IAAb,CAAkB,IAAIm2D,mBAAJ,CAAc;AAC9Bx1B,2BAAqB57B,QAAQ47B,mBADC;AAE9B9W,gBAAU9kB,QAAQ8wD;AAFY,KAAd,CAAlB;AAID;;AAED,MAAMO,WAAWrxD,QAAQqxD,QAAR,KAAqBx3D,SAArB,GAAiCmG,QAAQqxD,QAAzC,GAAoD,IAArE;AACA,MAAIA,QAAJ,EAAc;AACZ7rC,iBAAavqB,IAAb,CAAkB,IAAIq2D,qBAAJ,EAAlB;AACA9rC,iBAAavqB,IAAb,CAAkB,IAAIs2D,sBAAJ,CAAiB;AACjCj0B,aAAOt9B,QAAQ6wD,SADkB;AAEjC/rC,gBAAU9kB,QAAQ8wD;AAFe,KAAjB,CAAlB;AAID;;AAED,MAAMU,iBAAiBxxD,QAAQwxD,cAAR,KAA2B33D,SAA3B,GACrBmG,QAAQwxD,cADa,GACI,IAD3B;AAEA,MAAIA,cAAJ,EAAoB;AAClBhsC,iBAAavqB,IAAb,CAAkB,IAAIw2D,wBAAJ,CAAmB;AACnC71B,2BAAqB57B,QAAQ47B,mBADM;AAEnC9W,gBAAU9kB,QAAQ8wD;AAFiB,KAAnB,CAAlB;AAID;;AAED,MAAMY,gBAAgB1xD,QAAQ0xD,aAAR,KAA0B73D,SAA1B,GACpBmG,QAAQ0xD,aADY,GACI,IAD1B;AAEA,MAAIA,aAAJ,EAAmB;AACjBlsC,iBAAavqB,IAAb,CAAkB,IAAI02D,kBAAJ,CAAa;AAC7B7sC,gBAAU9kB,QAAQ8wD;AADW,KAAb,CAAlB;AAGD;;AAED,SAAOtrC,YAAP;AAED,C;;;;;;;;;;;;;;;;;;ACzJD;;AACA;;;;AACA;;;;;;AAGA;;;;;;AAOA;;;;;;;;;AASA,IAAMorC,kBAAkB,SAAlBA,eAAkB,CAASnyC,WAAT,EAAsB;;AAE5C,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA;;;;AAIA,OAAKmzC,MAAL,GAAc5xD,QAAQs9B,KAAR,GAAgBt9B,QAAQs9B,KAAxB,GAAgC,CAA9C;;AAEAu0B,wBAAYr9C,IAAZ,CAAiB,IAAjB,EAAuB;AACrByf,iBAAaA;AADQ,GAAvB;;AAIA;;;;AAIA,OAAKsV,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;AAED,CApBD,C,CAxBA;;;;;AA8CA,qBAAS8rC,eAAT,EAA0BiB,qBAA1B;;AAGA;;;;;;;AAOA,SAAS59B,WAAT,CAAqBJ,eAArB,EAAsC;AACpC,MAAIi+B,YAAY,KAAhB;AACA,MAAM3rC,eAAe0N,gBAAgBtN,aAArC;AACA,MAAIsN,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBG,QAAhD,EAA0D;AACxD,QAAMnxB,MAAMo8B,gBAAgBp8B,GAA5B;AACA,QAAMqlC,SAASjJ,gBAAgBnN,UAA/B;AACA,QAAM4W,QAAQnX,aAAaorB,QAAb,GAAwB,CAAC,KAAKqgB,MAA9B,GAAuC,KAAKA,MAA1D;AACA,QAAMh6D,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,kCAAYn7B,IAAZ,EAAkB0lC,KAAlB,EAAyBR,MAAzB,EAAiC,KAAKyM,SAAtC;AACA1V,oBAAgBhN,cAAhB;AACAirC,gBAAY,IAAZ;AACD;AACD,SAAO,CAACA,SAAR;AACD;;kBAEclB,e;;;;;;;;;;;;;;;;;;AClEf;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAGA;;;;;;;;;;;;AAaA;;;AAGA,IAAMmB,uBAAuB;AAC3B;;;;;AAKAC,gBAAc;AANa,CAA7B;;AAUA;;;;;;;;;;;;AAxCA;;;AAGA;;AAiDA,IAAMC,mBAAmB,SAAnBA,gBAAmB,CAAS14D,IAAT,EAAe24D,IAAf,EAAqBC,YAArB,EAAmCC,cAAnC,EAAmD;;AAE1E/zC,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAK+3B,QAAL,GAAgB6gC,YAAhB;;AAEA;;;;;AAKA,OAAKD,IAAL,GAAYA,IAAZ;;AAEA;;;;;AAKA,OAAK33B,UAAL,GAAkB63B,cAAlB;AAED,CAzBD;AA0BA,qBAASH,gBAAT,EAA2B5zC,eAA3B;;AAGA;;;;;;;;;;AAUA,IAAMg0C,cAAc,SAAdA,WAAc,CAAS5zC,WAAT,EAAsB;;AAExC,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEAozC,wBAAYr9C,IAAZ,CAAiB,IAAjB,EAAuB;AACrByf,iBAAa9C;AADQ,GAAvB;;AAIA;;;;AAIA,OAAKmhC,mBAAL,GAA2BtyD,QAAQuyD,kBAAR,GACzBvyD,QAAQuyD,kBADiB,GACI,EAD/B;;AAGA;;;;AAIA,OAAKj4B,WAAL,GAAmBt6B,QAAQu6B,UAAR,GACjB,eAAcv6B,QAAQu6B,UAAtB,CADiB,GACmB,IADtC;;AAGA;;;;AAIA,OAAKi4B,eAAL,GAAuB,IAAvB;;AAEA;;;;AAIA,OAAKC,OAAL,GAAezyD,QAAQ5I,MAAR,IAAkB,IAAjC;;AAEA;;;;AAIA,OAAKO,MAAL,GAAcqI,QAAQrI,MAAR,GAAiBqI,QAAQrI,MAAzB,GAAkC,IAAhD;AAED,CAxCD;;AA0CA,qBAAS06D,WAAT,EAAsBR,qBAAtB;;AAGA;;;;AAIA,SAASa,UAAT,CAAoB1pC,KAApB,EAA2B;AACzB,MAAM2pC,QAAQ3pC,MAAM4pC,YAAN,CAAmBD,KAAjC;AACA,OAAK,IAAI15D,IAAI,CAAR,EAAWwkB,KAAKk1C,MAAMz5D,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,QAAMi5D,OAAOS,MAAM/mD,IAAN,CAAW3S,CAAX,CAAb;AACA,QAAM45D,SAAS,IAAIC,UAAJ,EAAf;AACAD,WAAOv9B,gBAAP,CAAwBvT,oBAAU0uB,IAAlC,EAAwC,KAAKsiB,aAAL,CAAmBxjD,IAAnB,CAAwB,IAAxB,EAA8B2iD,IAA9B,CAAxC;AACAW,WAAOG,UAAP,CAAkBd,IAAlB;AACD;AACF;;AAGD;;;AAGA,SAASe,UAAT,CAAoBjqC,KAApB,EAA2B;AACzBA,QAAMlC,eAAN;AACAkC,QAAMnC,cAAN;AACAmC,QAAM4pC,YAAN,CAAmBM,UAAnB,GAAgC,MAAhC;AACD;;AAGD;;;;;AAKAb,YAAYl/C,SAAZ,CAAsB4/C,aAAtB,GAAsC,UAASb,IAAT,EAAelpC,KAAf,EAAsB;AAC1D,MAAMxwB,SAASwwB,MAAMrxB,MAAN,CAAaa,MAA5B;AACA,MAAMf,MAAM,KAAKyxC,MAAL,EAAZ;AACA,MAAI3O,aAAa,KAAKD,WAAtB;AACA,MAAI,CAACC,UAAL,EAAiB;AACf,QAAM3iC,OAAOH,IAAIs7B,OAAJ,EAAb;AACAwH,iBAAa3iC,KAAKkoC,aAAL,EAAb;AACD;;AAED,MAAMyyB,qBAAqB,KAAKD,mBAAhC;AACA,MAAIhhC,WAAW,EAAf;AACA,OAAK,IAAIr4B,IAAI,CAAR,EAAWwkB,KAAK80C,mBAAmBr5D,MAAxC,EAAgDD,IAAIwkB,EAApD,EAAwD,EAAExkB,CAA1D,EAA6D;AAC3D;;;;AAIA,QAAMk6D,oBAAoBZ,mBAAmBt5D,CAAnB,CAA1B;AACA;;;AAGA,QAAM3B,SAAS,IAAI67D,iBAAJ,EAAf;AACA7hC,eAAW,KAAK8hC,gBAAL,CAAsB97D,MAAtB,EAA8BkB,MAA9B,EAAsC;AAC/C8/C,yBAAmB/d;AAD4B,KAAtC,CAAX;AAGA,QAAIjJ,YAAYA,SAASp4B,MAAT,GAAkB,CAAlC,EAAqC;AACnC;AACD;AACF;AACD,MAAI,KAAKu5D,OAAT,EAAkB;AAChB,SAAKA,OAAL,CAAazzC,KAAb;AACA,SAAKyzC,OAAL,CAAa7Z,WAAb,CAAyBtnB,QAAzB;AACD;AACD,OAAK9R,aAAL,CACE,IAAIyyC,gBAAJ,CACEF,qBAAqBC,YADvB,EACqCE,IADrC,EAEE5gC,QAFF,EAEYiJ,UAFZ,CADF;AAID,CApCD;;AAuCA;;;AAGA83B,YAAYl/C,SAAZ,CAAsBkgD,kBAAtB,GAA2C,YAAW;AACpD,MAAM57D,MAAM,KAAKyxC,MAAL,EAAZ;AACA,MAAIzxC,GAAJ,EAAS;AACP,QAAM67D,WAAW,KAAK37D,MAAL,GAAc,KAAKA,MAAnB,GAA4BF,IAAI+vB,WAAJ,EAA7C;AACA,SAAKgrC,eAAL,GAAuB,CACrB,oBAAOc,QAAP,EAAiBvxC,oBAAUwR,IAA3B,EAAiCm/B,UAAjC,EAA6C,IAA7C,CADqB,EAErB,oBAAOY,QAAP,EAAiBvxC,oBAAUwuB,SAA3B,EAAsC0iB,UAAtC,EAAkD,IAAlD,CAFqB,EAGrB,oBAAOK,QAAP,EAAiBvxC,oBAAUyuB,QAA3B,EAAqCyiB,UAArC,EAAiD,IAAjD,CAHqB,EAIrB,oBAAOK,QAAP,EAAiBvxC,oBAAUwR,IAA3B,EAAiC0/B,UAAjC,EAA6C,IAA7C,CAJqB,CAAvB;AAMD;AACF,CAXD;;AAcA;;;AAGAZ,YAAYl/C,SAAZ,CAAsBogD,SAAtB,GAAkC,UAASC,MAAT,EAAiB;AACjD3B,wBAAY1+C,SAAZ,CAAsBogD,SAAtB,CAAgC/+C,IAAhC,CAAqC,IAArC,EAA2Cg/C,MAA3C;AACA,MAAIA,MAAJ,EAAY;AACV,SAAKH,kBAAL;AACD,GAFD,MAEO;AACL,SAAKI,oBAAL;AACD;AACF,CAPD;;AAUA;;;AAGApB,YAAYl/C,SAAZ,CAAsB4c,MAAtB,GAA+B,UAASt4B,GAAT,EAAc;AAC3C,OAAKg8D,oBAAL;AACA5B,wBAAY1+C,SAAZ,CAAsB4c,MAAtB,CAA6Bvb,IAA7B,CAAkC,IAAlC,EAAwC/c,GAAxC;AACA,MAAI,KAAKs8B,SAAL,EAAJ,EAAsB;AACpB,SAAKs/B,kBAAL;AACD;AACF,CAND;;AASA;;;;;;;AAOAhB,YAAYl/C,SAAZ,CAAsBigD,gBAAtB,GAAyC,UAAS97D,MAAT,EAAiBs2D,IAAjB,EAAuB5tD,OAAvB,EAAgC;AACvE,MAAI;AACF,WAAO1I,OAAO+gD,YAAP,CAAoBuV,IAApB,EAA0B5tD,OAA1B,CAAP;AACD,GAFD,CAEE,OAAOmD,CAAP,EAAU;AACV,WAAO,IAAP;AACD;AACF,CAND;;AASA;;;AAGAkvD,YAAYl/C,SAAZ,CAAsBsgD,oBAAtB,GAA6C,YAAW;AACtD,MAAI,KAAKjB,eAAT,EAA0B;AACxB,SAAKA,eAAL,CAAqB75D,OAArB,CAA6B4wB,qBAA7B;AACA,SAAKipC,eAAL,GAAuB,IAAvB;AACD;AACF,CALD;;kBAQeH,W;;;;;;;;;;;;;;;;;;AC9Qf;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;;;AAGA;;;;;;;AAQA;;;;;;;;;;;;;AAcA;;;AAlCA;;;AAGA;AAkCA,IAAMqB,mBAAmB;AACvB;;;;;AAKAC,YAAU,UANa;;AAQvB;;;;;AAKAC,WAAS,SAbc;;AAevB;;;;;AAKAC,UAAQ;AApBe,CAAzB;;AAwBA;;;;;;;;;;;AAWA,IAAMC,eAAe,SAAfA,YAAe,CAASv6D,IAAT,EAAemtB,UAAf,EAA2BmN,eAA3B,EAA4C;AAC/DxV,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;;AAMA,OAAKmtB,UAAL,GAAkBA,UAAlB;;AAEA;;;;;AAKA,OAAKmN,eAAL,GAAuBA,eAAvB;AAED,CAlBD;;AAoBA,qBAASigC,YAAT,EAAuBz1C,eAAvB;;AAGA;;;;;;;;;;;;;;;;;AAiBA,IAAM01C,UAAU,SAAVA,OAAU,CAASt1C,WAAT,EAAsB;;AAEpCu1C,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BC,qBAAiBA,eAFW;AAG5BC,mBAAeA;AAHa,GAA9B;;AAMA,MAAMn0D,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA;;;;AAIA,OAAK21C,IAAL,GAAY,IAAIC,aAAJ,CAAcr0D,QAAQqtB,SAAR,IAAqB,YAAnC,CAAZ;;AAEA;;;;AAIA,OAAKinC,QAAL,GAAgBt0D,QAAQu0D,OAAR,KAAoB16D,SAApB,GAAgCmG,QAAQu0D,OAAxC,GAAkD,EAAlE;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmB,IAAnB;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkBz0D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwChjB,iBAA1D;;AAEA;;;;AAIA,OAAKijB,gBAAL,GAAwB30D,QAAQ40D,eAAR,GACtB50D,QAAQ40D,eADc,GACIC,sBAD5B;AAED,CAxCD;;AA0CA,qBAASd,OAAT,EAAkBC,iBAAlB;;AAGA;;;;;;;;;;AAUA,SAASa,sBAAT,CAAgChhC,eAAhC,EAAiDihC,UAAjD,EAA6DC,QAA7D,EAAuE;AACrE,MAAMtnC,QAAQsnC,SAAS,CAAT,IAAcD,WAAW,CAAX,CAA5B;AACA,MAAMpnC,SAASqnC,SAAS,CAAT,IAAcD,WAAW,CAAX,CAA7B;AACA,SAAOrnC,QAAQA,KAAR,GAAgBC,SAASA,MAAzB,IAAmC,KAAK4mC,QAA/C;AACD;;AAGD;;;;AAIA,SAASJ,eAAT,CAAyBrgC,eAAzB,EAA0C;AACxC,MAAI,CAAC,0BAAUA,eAAV,CAAL,EAAiC;AAC/B;AACD;;AAED,OAAKugC,IAAL,CAAUY,SAAV,CAAoB,KAAKR,WAAzB,EAAsC3gC,gBAAgBrN,KAAtD;;AAEA,OAAKhH,aAAL,CAAmB,IAAIs0C,YAAJ,CAAiBJ,iBAAiBE,OAAlC,EACjB//B,gBAAgBnN,UADC,EACWmN,eADX,CAAnB;AAED;;AAGD;;;;;AAKAkgC,QAAQ5gD,SAAR,CAAkBqO,WAAlB,GAAgC,YAAW;AACzC,SAAO,KAAK4yC,IAAL,CAAU5yC,WAAV,EAAP;AACD,CAFD;;AAKA;;;;;;AAMAuyC,QAAQ5gD,SAAR,CAAkB8hD,QAAlB,GAA6B30C,oBAA7B;;AAGA;;;;;AAKA,SAAS6zC,aAAT,CAAuBtgC,eAAvB,EAAwC;AACtC,MAAI,CAAC,0BAAUA,eAAV,CAAL,EAAiC;AAC/B,WAAO,IAAP;AACD;;AAED,OAAKugC,IAAL,CAAUrkC,MAAV,CAAiB,IAAjB;;AAEA,MAAI,KAAK4kC,gBAAL,CAAsB9gC,eAAtB,EACF,KAAK2gC,WADH,EACgB3gC,gBAAgBrN,KADhC,CAAJ,EAC4C;AAC1C,SAAKyuC,QAAL,CAAcphC,eAAd;AACA,SAAKrU,aAAL,CAAmB,IAAIs0C,YAAJ,CAAiBJ,iBAAiBG,MAAlC,EACjBhgC,gBAAgBnN,UADC,EACWmN,eADX,CAAnB;AAED;AACD,SAAO,KAAP;AACD;;AAGD;;;;;AAKA,SAASogC,eAAT,CAAyBpgC,eAAzB,EAA0C;AACxC,MAAI,CAAC,0BAAUA,eAAV,CAAL,EAAiC;AAC/B,WAAO,KAAP;AACD;;AAED,MAAI,kCAAkBA,eAAlB,KACA,KAAK4gC,UAAL,CAAgB5gC,eAAhB,CADJ,EACsC;AACpC,SAAK2gC,WAAL,GAAmB3gC,gBAAgBrN,KAAnC;AACA,SAAK4tC,IAAL,CAAUrkC,MAAV,CAAiB8D,gBAAgBp8B,GAAjC;AACA,SAAK28D,IAAL,CAAUY,SAAV,CAAoB,KAAKR,WAAzB,EAAsC,KAAKA,WAA3C;AACA,SAAKh1C,aAAL,CAAmB,IAAIs0C,YAAJ,CAAiBJ,iBAAiBC,QAAlC,EACjB9/B,gBAAgBnN,UADC,EACWmN,eADX,CAAnB;AAEA,WAAO,IAAP;AACD,GARD,MAQO;AACL,WAAO,KAAP;AACD;AACF;;kBAGckgC,O;;;;;;;;;;;;;;;;;;AC5Pf;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;AAGA;;;;;;;;AASA;;;;;;;;;AASA,IAAM/C,UAAU,SAAVA,OAAU,CAASvyC,WAAT,EAAsB;;AAEpCu1C,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BC,qBAAiBA,eAFW;AAG5BC,mBAAeA;AAHa,GAA9B;;AAMA,MAAMn0D,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA;;;;AAIA,OAAKy2C,QAAL,GAAgBl1D,QAAQwwD,OAAxB;;AAEA;;;AAGA,OAAK2E,YAAL,GAAoB,IAApB;;AAEA;;;AAGA,OAAKC,kBAAL;;AAEA;;;;AAIA,OAAKX,UAAL,GAAkBz0D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwCtiB,yBAA1D;;AAEA;;;;AAIA,OAAKijB,UAAL,GAAkB,KAAlB;AAED,CAtCD,C,CA9BA;;;;;AAsEA,qBAASrE,OAAT,EAAkBgD,iBAAlB;;AAGA;;;;AAIA,SAASE,eAAT,CAAyBrgC,eAAzB,EAA0C;AACxC,MAAMyhC,iBAAiB,KAAKA,cAA5B;AACA,MAAMC,WAAW,uBAAqBD,cAArB,CAAjB;AACA,MAAIA,eAAep8D,MAAf,IAAyB,KAAKk8D,kBAAlC,EAAsD;AACpD,QAAI,KAAKF,QAAT,EAAmB;AACjB,WAAKA,QAAL,CAAczwC,MAAd,CAAqB8wC,SAAS,CAAT,CAArB,EAAkCA,SAAS,CAAT,CAAlC;AACD;AACD,QAAI,KAAKJ,YAAT,EAAuB;AACrB,UAAM1hC,SAAS,KAAK0hC,YAAL,CAAkB,CAAlB,IAAuBI,SAAS,CAAT,CAAtC;AACA,UAAM5hC,SAAS4hC,SAAS,CAAT,IAAc,KAAKJ,YAAL,CAAkB,CAAlB,CAA7B;AACA,UAAM19D,MAAMo8B,gBAAgBp8B,GAA5B;AACA,UAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,UAAIj7B,SAAS,CAAC27B,MAAD,EAASE,MAAT,CAAb;AACA,6BAAgB77B,MAAhB,EAAwBF,KAAKkrB,aAAL,EAAxB;AACA,8BAAiBhrB,MAAjB,EAAyBF,KAAKukC,WAAL,EAAzB;AACA,2BAAcrkC,MAAd,EAAsBF,KAAKskC,SAAL,EAAtB;AACApkC,eAASF,KAAKinC,eAAL,CAAqB/mC,MAArB,CAAT;AACAF,WAAK2kC,SAAL,CAAezkC,MAAf;AACD;AACF,GAhBD,MAgBO,IAAI,KAAKo9D,QAAT,EAAmB;AACxB;AACA;AACA,SAAKA,QAAL,CAAc1wC,KAAd;AACD;AACD,OAAK2wC,YAAL,GAAoBI,QAApB;AACA,OAAKH,kBAAL,GAA0BE,eAAep8D,MAAzC;AACD;;AAGD;;;;;AAKA,SAASi7D,aAAT,CAAuBtgC,eAAvB,EAAwC;AACtC,MAAMp8B,MAAMo8B,gBAAgBp8B,GAA5B;AACA,MAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,MAAI,KAAKuiC,cAAL,CAAoBp8D,MAApB,KAA+B,CAAnC,EAAsC;AACpC,QAAI,CAAC,KAAKm8D,UAAN,IAAoB,KAAKH,QAAzB,IAAqC,KAAKA,QAAL,CAActwC,GAAd,EAAzC,EAA8D;AAC5D,UAAM6mB,WAAW,KAAKypB,QAAL,CAAcjwC,WAAd,EAAjB;AACA,UAAM8nB,QAAQ,KAAKmoB,QAAL,CAAchwC,QAAd,EAAd;AACA,UAAMptB,SAAS,+CAAiDF,KAAKskC,SAAL,EAAhE;AACA,UAAMs5B,WAAW/9D,IAAIk7B,sBAAJ,CAA2B76B,MAA3B,CAAjB;AACA,UAAM22D,OAAOh3D,IAAIkvB,sBAAJ,CAA2B,CACtC6uC,SAAS,CAAT,IAAc/pB,WAAWzuC,KAAK4G,GAAL,CAASmpC,KAAT,CADa,EAEtCyoB,SAAS,CAAT,IAAc/pB,WAAWzuC,KAAK2G,GAAL,CAASopC,KAAT,CAFa,CAA3B,CAAb;AAIAn1C,WAAK8+B,OAAL,CAAa;AACX5+B,gBAAQF,KAAKinC,eAAL,CAAqB4vB,IAArB,CADG;AAEX3pC,kBAAU,GAFC;AAGXiY,gBAAQ8M;AAHG,OAAb;AAKD;AACDjyC,SAAK4lC,OAAL,CAAa/I,mBAASE,WAAtB,EAAmC,CAAC,CAApC;AACA,WAAO,KAAP;AACD,GAlBD,MAkBO;AACL,QAAI,KAAKugC,QAAT,EAAmB;AACjB;AACA;AACA,WAAKA,QAAL,CAAc1wC,KAAd;AACD;AACD,SAAK2wC,YAAL,GAAoB,IAApB;AACA,WAAO,IAAP;AACD;AACF;;AAGD;;;;;AAKA,SAASlB,eAAT,CAAyBpgC,eAAzB,EAA0C;AACxC,MAAI,KAAKyhC,cAAL,CAAoBp8D,MAApB,GAA6B,CAA7B,IAAkC,KAAKu7D,UAAL,CAAgB5gC,eAAhB,CAAtC,EAAwE;AACtE,QAAMp8B,MAAMo8B,gBAAgBp8B,GAA5B;AACA,QAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,SAAKoiC,YAAL,GAAoB,IAApB;AACA,QAAI,CAAC,KAAKM,sBAAV,EAAkC;AAChC79D,WAAK4lC,OAAL,CAAa/I,mBAASE,WAAtB,EAAmC,CAAnC;AACD;AACD;AACA,QAAI/8B,KAAK6lC,YAAL,EAAJ,EAAyB;AACvB7lC,WAAK2kC,SAAL,CAAe1I,gBAAgB1J,UAAhB,CAA2B+L,SAA3B,CAAqCp+B,MAApD;AACD;AACD,QAAI,KAAKo9D,QAAT,EAAmB;AACjB,WAAKA,QAAL,CAAc1wC,KAAd;AACD;AACD;AACA;AACA,SAAK6wC,UAAL,GAAkB,KAAKC,cAAL,CAAoBp8D,MAApB,GAA6B,CAA/C;AACA,WAAO,IAAP;AACD,GAlBD,MAkBO;AACL,WAAO,KAAP;AACD;AACF;;AAGD;;;AAGA83D,QAAQ79C,SAAR,CAAkBuiD,eAAlB,GAAoC1jB,gBAApC;kBACegf,O;;;;;;;;;;;;;;;;;;AC/Kf;;AACA;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;;;AAGA;;;;;;;;;AAUA;;;;;;;;;;;;;AAaA,IAAMN,aAAa,SAAbA,UAAa,CAASjyC,WAAT,EAAsB;;AAEvC,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEAu1C,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BC,qBAAiBA,eAFW;AAG5BC,mBAAeA;AAHa,GAA9B;;AAMA;;;;AAIA,OAAKM,UAAL,GAAkBz0D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwCljB,2BAA1D;;AAEA;;;;AAIA,OAAKmkB,UAAL,GAAkB97D,SAAlB;;AAEA;;;;AAIA,OAAK0vC,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;AACD,CA3BD,C,CAnCA;;;;;AAgEA,qBAAS4rC,UAAT,EAAqBsD,iBAArB;;AAGA;;;;AAIA,SAASE,eAAT,CAAyBrgC,eAAzB,EAA0C;AACxC,MAAI,CAAC,0BAAUA,eAAV,CAAL,EAAiC;AAC/B;AACD;;AAED,MAAMp8B,MAAMo8B,gBAAgBp8B,GAA5B;AACA,MAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,MAAIn7B,KAAKsnC,cAAL,GAAsBrI,QAAtB,KAAmCqM,2BAAvC,EAAgD;AAC9C;AACD;AACD,MAAMhmB,OAAOzlB,IAAIq7B,OAAJ,EAAb;AACA,MAAMyN,SAAS1M,gBAAgBrN,KAA/B;AACA,MAAMovC,QACF54D,KAAK4U,KAAL,CAAWsL,KAAK,CAAL,IAAU,CAAV,GAAcqjB,OAAO,CAAP,CAAzB,EAAoCA,OAAO,CAAP,IAAYrjB,KAAK,CAAL,IAAU,CAA1D,CADJ;AAEA,MAAI,KAAKy4C,UAAL,KAAoB97D,SAAxB,EAAmC;AACjC,QAAMyjC,QAAQs4B,QAAQ,KAAKD,UAA3B;AACA,QAAM9+B,WAAWj/B,KAAKukC,WAAL,EAAjB;AACA,+CAAyBvkC,IAAzB,EAA+Bi/B,WAAWyG,KAA1C;AACD;AACD,OAAKq4B,UAAL,GAAkBC,KAAlB;AACD;;AAGD;;;;;AAKA,SAASzB,aAAT,CAAuBtgC,eAAvB,EAAwC;AACtC,MAAI,CAAC,0BAAUA,eAAV,CAAL,EAAiC;AAC/B,WAAO,IAAP;AACD;;AAED,MAAMp8B,MAAMo8B,gBAAgBp8B,GAA5B;AACA,MAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACAn7B,OAAK4lC,OAAL,CAAa/I,mBAASE,WAAtB,EAAmC,CAAC,CAApC;AACA,MAAMkC,WAAWj/B,KAAKukC,WAAL,EAAjB;AACA,2BAAOvkC,IAAP,EAAai/B,QAAb,EAAuBh9B,SAAvB,EAAkC,KAAK0vC,SAAvC;AACA,SAAO,KAAP;AACD;;AAGD;;;;;AAKA,SAAS0qB,eAAT,CAAyBpgC,eAAzB,EAA0C;AACxC,MAAI,CAAC,0BAAUA,eAAV,CAAL,EAAiC;AAC/B,WAAO,KAAP;AACD;;AAED,MAAI,kCAAkBA,eAAlB,KAAsC,KAAK4gC,UAAL,CAAgB5gC,eAAhB,CAA1C,EAA4E;AAC1E,QAAMp8B,MAAMo8B,gBAAgBp8B,GAA5B;AACAA,QAAIs7B,OAAJ,GAAcyK,OAAd,CAAsB/I,mBAASE,WAA/B,EAA4C,CAA5C;AACA,SAAKghC,UAAL,GAAkB97D,SAAlB;AACA,WAAO,IAAP;AACD,GALD,MAKO;AACL,WAAO,KAAP;AACD;AACF;;AAGD;;;AAGA62D,WAAWv9C,SAAX,CAAqBuiD,eAArB,GAAuC1jB,gBAAvC;kBACe0e,U;;;;;;;;;;;;;;;;;;ACvIf;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;;;AAGA;;;;;;;;;AAUA;;;;;;;;;;;;;;;AArBA;;;AAoCA,IAAMmF,oBAAoB,SAApBA,iBAAoB,CAASp3C,WAAT,EAAsB;;AAE9C,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEAu1C,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BC,qBAAiBA,eAFW;AAG5BC,mBAAeA;AAHa,GAA9B;;AAMA;;;;AAIA,OAAKM,UAAL,GAAkBz0D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwCpiB,uBAA1D;;AAEA;;;;AAIA,OAAKqjB,UAAL,GAAkB97D,SAAlB;;AAEA;;;;AAIA,OAAKi8D,cAAL,GAAsBj8D,SAAtB;;AAEA;;;;AAIA,OAAKk8D,eAAL,GAAuB,CAAvB;;AAEA;;;;AAIA,OAAKxsB,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;AAED,CAxCD;;AA0CA,qBAAS+wC,iBAAT,EAA4B7B,iBAA5B;;AAGA;;;;AAIA,SAASE,eAAT,CAAyBrgC,eAAzB,EAA0C;AACxC,MAAI,CAAC,0BAAUA,eAAV,CAAL,EAAiC;AAC/B;AACD;;AAED,MAAMp8B,MAAMo8B,gBAAgBp8B,GAA5B;AACA,MAAMylB,OAAOzlB,IAAIq7B,OAAJ,EAAb;AACA,MAAMyN,SAAS1M,gBAAgBrN,KAA/B;AACA,MAAMiN,SAAS8M,OAAO,CAAP,IAAYrjB,KAAK,CAAL,IAAU,CAArC;AACA,MAAMyW,SAASzW,KAAK,CAAL,IAAU,CAAV,GAAcqjB,OAAO,CAAP,CAA7B;AACA,MAAMq1B,QAAQ54D,KAAK4U,KAAL,CAAW+hB,MAAX,EAAmBF,MAAnB,CAAd;AACA,MAAMuiC,YAAYh5D,KAAKsG,IAAL,CAAUmwB,SAASA,MAAT,GAAkBE,SAASA,MAArC,CAAlB;AACA,MAAM/7B,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,MAAIn7B,KAAKsnC,cAAL,GAAsBrI,QAAtB,KAAmCqM,2BAAnC,IAA8C,KAAKyyB,UAAL,KAAoB97D,SAAtE,EAAiF;AAC/E,QAAMo8D,aAAaL,QAAQ,KAAKD,UAAhC;AACA,+CAAyB/9D,IAAzB,EAA+BA,KAAKukC,WAAL,KAAqB85B,UAApD;AACD;AACD,OAAKN,UAAL,GAAkBC,KAAlB;AACA,MAAI,KAAKE,cAAL,KAAwBj8D,SAA5B,EAAuC;AACrC,QAAMyoB,aAAa,KAAKwzC,cAAL,IAAuBl+D,KAAKkrB,aAAL,KAAuBkzC,SAA9C,CAAnB;AACA,6CAAuBp+D,IAAvB,EAA6B0qB,UAA7B;AACD;AACD,MAAI,KAAKwzC,cAAL,KAAwBj8D,SAA5B,EAAuC;AACrC,SAAKk8D,eAAL,GAAuB,KAAKD,cAAL,GAAsBE,SAA7C;AACD;AACD,OAAKF,cAAL,GAAsBE,SAAtB;AACD;;AAGD;;;;;AAKA,SAAS7B,aAAT,CAAuBtgC,eAAvB,EAAwC;AACtC,MAAI,CAAC,0BAAUA,eAAV,CAAL,EAAiC;AAC/B,WAAO,IAAP;AACD;;AAED,MAAMp8B,MAAMo8B,gBAAgBp8B,GAA5B;AACA,MAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACAn7B,OAAK4lC,OAAL,CAAa/I,mBAASE,WAAtB,EAAmC,CAAC,CAApC;AACA,MAAMqK,YAAY,KAAK+2B,eAAL,GAAuB,CAAzC;AACA,2BAAOn+D,IAAP,EAAaA,KAAKukC,WAAL,EAAb;AACA,yBAAKvkC,IAAL,EAAWA,KAAKkrB,aAAL,EAAX,EAAiCjpB,SAAjC,EAA4C,KAAK0vC,SAAjD,EAA4DvK,SAA5D;AACA,OAAK+2B,eAAL,GAAuB,CAAvB;AACA,SAAO,KAAP;AACD;;AAGD;;;;;AAKA,SAAS9B,eAAT,CAAyBpgC,eAAzB,EAA0C;AACxC,MAAI,CAAC,0BAAUA,eAAV,CAAL,EAAiC;AAC/B,WAAO,KAAP;AACD;;AAED,MAAI,KAAK4gC,UAAL,CAAgB5gC,eAAhB,CAAJ,EAAsC;AACpCA,oBAAgBp8B,GAAhB,CAAoBs7B,OAApB,GAA8ByK,OAA9B,CAAsC/I,mBAASE,WAA/C,EAA4D,CAA5D;AACA,SAAKghC,UAAL,GAAkB97D,SAAlB;AACA,SAAKi8D,cAAL,GAAsBj8D,SAAtB;AACA,WAAO,IAAP;AACD,GALD,MAKO;AACL,WAAO,KAAP;AACD;AACF;;kBAEcg8D,iB;;;;;;;;;;;;;;;;;;ACxJf;;AACA;;AACA;;AACA;;AACA;;;;;;AAGA;;;;;;;;;;;;AAaA;;;;;;;;;;;;;;AAcA,IAAMlE,WAAW,SAAXA,QAAW,CAASlzC,WAAT,EAAsB;AACrC,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA,MAAMi2C,YAAY10D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwCpiB,uBAA1D;;AAEA;;;;AAIA,OAAK/I,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;;AAEA;;;;AAIA,OAAKoxC,IAAL,GAAYl2D,QAAQhC,GAAR,KAAgBnE,SAAhB,GAA4BmG,QAAQhC,GAApC,GAA0C,KAAtD;;AAEA+1D,oBAAQv/C,IAAR,CAAa,IAAb,EAAmB;AACjBkgD,eAAWA,SADM;AAEjBrnC,eAAWrtB,QAAQqtB,SAAR,IAAqB;AAFf,GAAnB;AAKD,CAtBD,C,CArCA;;;;;AA6DA,qBAASskC,QAAT,EAAmBoC,iBAAnB;;AAGA;;;AAGApC,SAASx+C,SAAT,CAAmB8hD,QAAnB,GAA8B,YAAW;AACvC,MAAMx9D,MAAM,KAAKyxC,MAAL,EAAZ;;AAEA,MAAMtxC,OAAO,8BAAgCH,IAAIs7B,OAAJ,EAA7C;;AAEA,MAAM7V,OAAO,mCAAqCzlB,IAAIq7B,OAAJ,EAAlD;;AAEA,MAAIzQ,SAAS,KAAKb,WAAL,GAAmBmB,SAAnB,EAAb;;AAEA,MAAI,KAAKuzC,IAAT,EAAe;AACb,QAAMC,YAAYv+D,KAAKwnC,eAAL,CAAqBliB,IAArB,CAAlB;AACA,QAAMk5C,iBAAiB,2CAA8B,CACnD3+D,IAAIk7B,sBAAJ,CAA2B,2BAActQ,MAAd,CAA3B,CADmD,EAEnD5qB,IAAIk7B,sBAAJ,CAA2B,yBAAYtQ,MAAZ,CAA3B,CAFmD,CAA9B,CAAvB;AAGA,QAAMg0C,SAASz+D,KAAKooC,sBAAL,CAA4Bo2B,cAA5B,EAA4Cl5C,IAA5C,CAAf;;AAEA,iCAAgBi5C,SAAhB,EAA2B,IAAIE,MAA/B;AACAh0C,aAAS8zC,SAAT;AACD;;AAED,MAAM7zC,aAAa1qB,KAAKgkC,mBAAL,CACjBhkC,KAAKooC,sBAAL,CAA4B3d,MAA5B,EAAoCnF,IAApC,CADiB,CAAnB;;AAGA,MAAIplB,SAAS,uBAAUuqB,MAAV,CAAb;AACAvqB,WAASF,KAAKinC,eAAL,CAAqB/mC,MAArB,CAAT;;AAEAF,OAAK8+B,OAAL,CAAa;AACXpU,gBAAYA,UADD;AAEXxqB,YAAQA,MAFG;AAGXgtB,cAAU,KAAKykB,SAHJ;AAIXxM,YAAQ8M;AAJG,GAAb;AAOD,CAjCD;kBAkCe8nB,Q;;;;;;;;;;;;;;;;;QC4WC19B,W,GAAAA,W;QAkfAqiC,oB,GAAAA,oB;QAuBAC,S,GAAAA,S;;AAv9BhB;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;;;;;;;;;AAUA;;;;;AA9FA;;;AAmGA,IAAMC,OAAO;AACX1V,SAAO,OADI;AAEXC,eAAa,YAFF;AAGXE,WAAS,SAHE;AAIXngB,UAAQ;AAJG,CAAb;;AAQA;;;AAGA,IAAM21B,gBAAgB;AACpB;;;;;AAKAC,aAAW,WANS;AAOpB;;;;;AAKAC,WAAS;AAZW,CAAtB;;AAgBA;;;;;;;;;;AAUA,IAAMC,YAAY,SAAZA,SAAY,CAASr9D,IAAT,EAAemO,OAAf,EAAwB;;AAExC2W,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAKmO,OAAL,GAAeA,OAAf;AAED,CAXD;;AAaA,qBAASkvD,SAAT,EAAoBv4C,eAApB;;AAGA;;;;;;;;;;AAUA,IAAMw4C,OAAO,SAAPA,IAAO,CAAS72D,OAAT,EAAkB;;AAE7Bg0D,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BhgC,iBAAaA,WAFe;AAG5BkgC,mBAAeA;AAHa,GAA9B;;AAMA;;;;AAIA,OAAK2C,aAAL,GAAqB,KAArB;;AAEA;;;;AAIA,OAAKC,OAAL,GAAe,IAAf;;AAEA;;;;AAIA,OAAKC,YAAL;;AAEA;;;;AAIA,OAAKC,aAAL;;AAEA;;;;AAIA,OAAKC,SAAL,GAAiB,KAAjB;;AAEA;;;;;AAKA,OAAKzE,OAAL,GAAezyD,QAAQ5I,MAAR,GAAiB4I,QAAQ5I,MAAzB,GAAkC,IAAjD;;AAEA;;;;;AAKA,OAAK+/D,SAAL,GAAiBn3D,QAAQsxB,QAAR,GAAmBtxB,QAAQsxB,QAA3B,GAAsC,IAAvD;;AAEA;;;;;AAKA,OAAK8lC,cAAL,GAAsBp3D,QAAQq3D,aAAR,GAAwBr3D,QAAQq3D,aAAhC,GAAgD,EAAtE;;AAEA;;;;;AAKA,OAAKC,KAAL,GAAa,0CAA4Ct3D,QAAQzG,IAAjE;;AAEA;;;;;AAKA,OAAKg+D,KAAL,GAAaC,QAAQ,KAAKF,KAAb,CAAb;;AAEA;;;;;;AAMA,OAAKG,UAAL,GAAkB,CAAC,CAACz3D,QAAQ03D,SAA5B;;AAEA;;;;;;;AAOA,OAAKC,UAAL,GAAkB33D,QAAQ43D,SAAR,GAChB53D,QAAQ43D,SADQ,GAEf,KAAKL,KAAL,KAAef,KAAKvV,OAApB,GAA8B,CAA9B,GAAkC,CAFrC;;AAIA;;;;;;AAMA,OAAK4W,UAAL,GAAkB73D,QAAQ83D,SAAR,GAAoB93D,QAAQ83D,SAA5B,GAAwCzwD,QAA1D;;AAEA;;;;;AAKA,OAAK0wD,gBAAL,GAAwB/3D,QAAQg4D,eAAR,GAA0Bh4D,QAAQg4D,eAAlC,GAAoD7mC,eAA5E;;AAEA,MAAI8mC,mBAAmBj4D,QAAQi4D,gBAA/B;AACA,MAAI,CAACA,gBAAL,EAAuB;AACrB,QAAI,KAAKX,KAAL,KAAez2B,uBAAaC,MAAhC,EAAwC;AACtC;;;;;;AAMAm3B,yBAAmB,0BAASpjB,WAAT,EAAsBqjB,YAAtB,EAAoC;AACrD,YAAMrsB,SAASqsB,eAAe,oCAAsCA,YAArD,GACb,IAAIpb,gBAAJ,CAAW,CAAC8B,GAAD,EAAMA,GAAN,CAAX,CADF;AAEA,YAAMuZ,gBAAgB,iCACpBtjB,YAAY,CAAZ,CADoB,EACJA,YAAY,CAAZ,CADI,CAAtB;AAEAhJ,eAAOqR,kBAAP,CAA0BrI,YAAY,CAAZ,CAA1B,EAA0C73C,KAAKsG,IAAL,CAAU60D,aAAV,CAA1C;AACA,eAAOtsB,MAAP;AACD,OAPD;AAQD,KAfD,MAeO;AACL,UAAIusB,oBAAJ;AACA,UAAMC,OAAO,KAAKd,KAAlB;AACA,UAAIc,SAAS7B,KAAK1V,KAAlB,EAAyB;AACvBsX,sBAAchd,eAAd;AACD,OAFD,MAEO,IAAIid,SAAS7B,KAAKzV,WAAlB,EAA+B;AACpCqX,sBAAc/c,oBAAd;AACD,OAFM,MAEA,IAAIgd,SAAS7B,KAAKvV,OAAlB,EAA2B;AAChCmX,sBAAc3c,iBAAd;AACD;AACD;;;;;;AAMAwc,yBAAmB,0BAASpjB,WAAT,EAAsBqjB,YAAtB,EAAoC;AACrD,YAAIj3C,WAAWi3C,YAAf;AACA,YAAIj3C,QAAJ,EAAc;AACZ,cAAIo3C,SAAS7B,KAAKvV,OAAlB,EAA2B;AACzB,gBAAIpM,YAAY,CAAZ,EAAe37C,MAAnB,EAA2B;AACzB;AACA+nB,uBAAS+8B,cAAT,CAAwB,CAACnJ,YAAY,CAAZ,EAAe/6C,MAAf,CAAsB,CAAC+6C,YAAY,CAAZ,EAAe,CAAf,CAAD,CAAtB,CAAD,CAAxB;AACD,aAHD,MAGO;AACL5zB,uBAAS+8B,cAAT,CAAwB,EAAxB;AACD;AACF,WAPD,MAOO;AACL/8B,qBAAS+8B,cAAT,CAAwBnJ,WAAxB;AACD;AACF,SAXD,MAWO;AACL5zB,qBAAW,IAAIm3C,WAAJ,CAAgBvjB,WAAhB,CAAX;AACD;AACD,eAAO5zB,QAAP;AACD,OAjBD;AAkBD;AACF;;AAED;;;;AAIA,OAAKq3C,iBAAL,GAAyBL,gBAAzB;;AAEA;;;;AAIA,OAAKM,gBAAL,GAAwBv4D,QAAQw4D,eAAR,KAA4B3+D,SAA5B,GAAwCmG,QAAQw4D,eAAhD,GAAkE,GAA1F;;AAEA;;;;;;AAMA,OAAKC,iBAAL,GAAyB,IAAzB;;AAEA;;;;;AAKA,OAAKC,cAAL,GAAsB,IAAtB;;AAEA;;;;;AAKA,OAAKC,YAAL,GAAoB,IAApB;;AAEA;;;;;AAKA,OAAKC,aAAL,GAAqB,IAArB;;AAEA;;;;;AAKA,OAAKC,WAAL,GAAmB,IAAnB;;AAEA;;;;;AAKA,OAAKC,iBAAL,GAAyB,IAAzB;;AAEA;;;;;;;AAOA,OAAKC,sBAAL,GAA8B/4D,QAAQg5D,cAAR,GAC5Bh5D,QAAQg5D,cAAR,GAAyBh5D,QAAQg5D,cADL,GACsB,EADpD;;AAGA;;;;;AAKA,OAAKC,QAAL,GAAgB,IAAI/hE,gBAAJ,CAAgB;AAC9BE,YAAQ,IAAIC,gBAAJ,CAAiB;AACvB6hE,uBAAiB,KADM;AAEvBC,aAAOn5D,QAAQm5D,KAAR,GAAgBn5D,QAAQm5D,KAAxB,GAAgC;AAFhB,KAAjB,CADsB;AAK9B97C,WAAOrd,QAAQqd,KAAR,GAAgBrd,QAAQqd,KAAxB,GACL+7C,yBAN4B;AAO9BC,4BAAwB;AAPM,GAAhB,CAAhB;;AAUA;;;;;AAKA,OAAK14C,aAAL,GAAqB3gB,QAAQ65C,YAA7B;;AAEA;;;;AAIA,OAAK4a,UAAL,GAAkBz0D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwCtiB,yBAA1D;;AAEA;;;;AAIA,OAAKknB,kBAAL;AACA,MAAIt5D,QAAQu5D,QAAZ,EAAsB;AACpB,SAAKD,kBAAL,GAA0B5nB,iBAA1B;AACD,GAFD,MAEO;AACL,SAAK4nB,kBAAL,GAA0Bt5D,QAAQw5D,iBAAR,GACxBx5D,QAAQw5D,iBADgB,GACIlnB,uBAD9B;AAED;;AAED,sBAAO,IAAP,EACE,gCAAmBmnB,mBAAoBC,MAAvC,CADF,EAEE,KAAKC,YAFP,EAEqB,IAFrB;AAID,CA9QD;;AAgRA,qBAAS9C,IAAT,EAAe7C,iBAAf;;AAGA;;;AAGA,SAASoF,uBAAT,GAAmC;AACjC,MAAMl3C,SAAS,gCAAf;AACA,SAAO,UAASxa,OAAT,EAAkB4a,UAAlB,EAA8B;AACnC,WAAOJ,OAAOxa,QAAQ8Z,WAAR,GAAsBnP,OAAtB,EAAP,CAAP;AACD,GAFD;AAGD;;AAGD;;;AAGAwkD,KAAK1jD,SAAL,CAAe4c,MAAf,GAAwB,UAASt4B,GAAT,EAAc;AACpCu8D,oBAAmB7gD,SAAnB,CAA6B4c,MAA7B,CAAoCvb,IAApC,CAAyC,IAAzC,EAA+C/c,GAA/C;AACA,OAAKkiE,YAAL;AACD,CAHD;;AAMA;;;;;;;;AAQO,SAAS1lC,WAAT,CAAqBjL,KAArB,EAA4B;AACjC,MAAIA,MAAMzC,aAAN,CAAoBhtB,IAApB,KAA6BwoB,oBAAU4M,WAA3C,EAAwD;AACtD;AACA3F,UAAMnC,cAAN;AACD;AACD,OAAKqwC,SAAL,GAAiB,KAAKK,KAAL,KAAef,KAAK1V,KAApB,IAA6B,KAAKwY,kBAAL,CAAwBtwC,KAAxB,CAA9C;AACA,MAAI4wC,OAAO5wC,MAAMzvB,IAAN,KAAekvB,8BAAoBN,WAA9C;AACA,MAAI0xC,OAAO,IAAX;AACA,MAAI,KAAK5C,aAAL,IAAsBjuC,MAAMzvB,IAAN,KAAekvB,8BAAoBmB,WAA7D,EAA0E;AACxE,QAAMjF,MAAMD,KAAKC,GAAL,EAAZ;AACA,QAAIA,MAAM,KAAKsyC,aAAX,IAA4B,KAAKsB,gBAArC,EAAuD;AACrD,WAAKxB,OAAL,GAAe/tC,MAAMxC,KAArB;AACA,WAAKswC,aAAL,GAAqB,CAAC,KAAKI,SAA3B;AACA0C,aAAO,IAAP;AACD,KAJD,MAIO;AACL,WAAK3C,aAAL,GAAqBp9D,SAArB;AACD;AACD,QAAI,KAAKi9D,aAAL,IAAsB,KAAKE,YAA/B,EAA6C;AAC3CruC,mBAAa,KAAKquC,YAAlB;AACA,WAAKA,YAAL,GAAoBn9D,SAApB;AACD;AACF;AACD,MAAI,KAAKq9D,SAAL,IACAluC,MAAMzvB,IAAN,KAAekvB,8BAAoBmB,WADnC,IAEA,KAAK8uC,cAAL,KAAwB,IAF5B,EAEkC;AAChC,SAAKoB,aAAL,CAAmB9wC,KAAnB;AACA6wC,WAAO,KAAP;AACD,GALD,MAKO,IAAI,KAAK3C,SAAL,IACPluC,MAAMzvB,IAAN,KAAekvB,8BAAoBT,WADhC,EAC6C;AAClD6xC,WAAO,KAAP;AACD,GAHM,MAGA,IAAID,IAAJ,EAAU;AACfC,WAAO7wC,MAAMzvB,IAAN,KAAekvB,8BAAoBN,WAA1C;AACA,QAAI0xC,QAAQ,KAAK3C,SAAjB,EAA4B;AAC1B2C,aAAO,KAAKnwC,kBAAL,CAAwBV,KAAxB,CAAP;AACD,KAFD,MAEO,IAAIA,MAAMV,YAAN,CAAmBoqB,WAAnB,IAAkCqnB,yBAAlC,IACN/wC,MAAMzvB,IAAN,KAAekvB,8BAAoBmB,WAAnC,IAAkD,CAAC,KAAKotC,YADtD,EACqE;AAC1E,WAAKttC,kBAAL,CAAwBV,KAAxB;AACD;AACF,GARM,MAQA,IAAIA,MAAMzvB,IAAN,KAAekvB,8BAAoBG,QAAvC,EAAiD;AACtDixC,WAAO,KAAP;AACD;;AAED,SAAOG,qBAAmBxlD,IAAnB,CAAwB,IAAxB,EAA8BwU,KAA9B,KAAwC6wC,IAA/C;AACD;;AAGD;;;;;AAKA,SAAS5F,eAAT,CAAyBjrC,KAAzB,EAAgC;AAC9B,OAAK8tC,aAAL,GAAqB,CAAC,KAAKI,SAA3B;;AAEA,MAAI,KAAKA,SAAT,EAAoB;AAClB,SAAKH,OAAL,GAAe/tC,MAAMxC,KAArB;AACA,QAAI,CAAC,KAAKiyC,iBAAV,EAA6B;AAC3B,WAAKwB,aAAL,CAAmBjxC,KAAnB;AACD;AACD,WAAO,IAAP;AACD,GAND,MAMO,IAAI,KAAKyrC,UAAL,CAAgBzrC,KAAhB,CAAJ,EAA4B;AACjC,SAAKiuC,aAAL,GAAqBvyC,KAAKC,GAAL,EAArB;AACA,SAAKqyC,YAAL,GAAoBnuC,WAAW,YAAW;AACxC,WAAKa,kBAAL,CAAwB,IAAIlB,gCAAJ,CACtBC,8BAAoBN,WADE,EACWa,MAAMvxB,GADjB,EACsBuxB,MAAMV,YAD5B,EAC0CU,MAAMmB,UADhD,CAAxB;AAED,KAH8B,CAG7B5a,IAH6B,CAGxB,IAHwB,CAAX,EAGN,KAAKgpD,gBAHC,CAApB;AAIA,SAAKxB,OAAL,GAAe/tC,MAAMxC,KAArB;AACA,WAAO,IAAP;AACD,GARM,MAQA;AACL,WAAO,KAAP;AACD;AACF;;AAGD;;;;;AAKA,SAAS2tC,aAAT,CAAuBnrC,KAAvB,EAA8B;AAC5B,MAAI6wC,OAAO,IAAX;;AAEA,MAAI,KAAK7C,YAAT,EAAuB;AACrBruC,iBAAa,KAAKquC,YAAlB;AACA,SAAKA,YAAL,GAAoBn9D,SAApB;AACD;;AAED,OAAK6vB,kBAAL,CAAwBV,KAAxB;;AAEA,MAAMkxC,aAAa,KAAK3C,KAAL,KAAef,KAAK11B,MAAvC;;AAEA,MAAI,KAAKg2B,aAAT,EAAwB;AACtB,QAAI,CAAC,KAAK2B,iBAAV,EAA6B;AAC3B,WAAKwB,aAAL,CAAmBjxC,KAAnB;AACA,UAAI,KAAKuuC,KAAL,KAAef,KAAK1V,KAAxB,EAA+B;AAC7B,aAAKqZ,aAAL;AACD;AACF,KALD,MAKO,IAAI,KAAKjD,SAAL,IAAkBgD,UAAtB,EAAkC;AACvC,WAAKC,aAAL;AACD,KAFM,MAEA,IAAI,KAAKC,SAAL,CAAepxC,KAAf,CAAJ,EAA2B;AAChC,UAAI,KAAK+uC,gBAAL,CAAsB/uC,KAAtB,CAAJ,EAAkC;AAChC,aAAKmxC,aAAL;AACD;AACF,KAJM,MAIA;AACL,WAAKL,aAAL,CAAmB9wC,KAAnB;AACD;AACD6wC,WAAO,KAAP;AACD,GAhBD,MAgBO,IAAI,KAAK3C,SAAT,EAAoB;AACzB,SAAKuB,iBAAL,GAAyB,IAAzB;AACA,SAAK4B,aAAL;AACD;AACD,MAAI,CAACR,IAAD,IAAS,KAAKpC,UAAlB,EAA8B;AAC5BzuC,UAAMlC,eAAN;AACD;AACD,SAAO+yC,IAAP;AACD;;AAGD;;;;;;AAMAhD,KAAK1jD,SAAL,CAAeuW,kBAAf,GAAoC,UAASV,KAAT,EAAgB;AAClD,MAAI,KAAK+tC,OAAL,KACE,CAAC,KAAKG,SAAN,IAAmB,KAAKJ,aAAzB,IACA,KAAKI,SAAL,IAAkB,CAAC,KAAKJ,aAFzB,CAAJ,EAE8C;AAC5C,QAAMwD,SAAS,KAAKvD,OAApB;AACA,QAAMwD,UAAUvxC,MAAMxC,KAAtB;AACA,QAAMzB,KAAKu1C,OAAO,CAAP,IAAYC,QAAQ,CAAR,CAAvB;AACA,QAAMv1C,KAAKs1C,OAAO,CAAP,IAAYC,QAAQ,CAAR,CAAvB;AACA,QAAM/uB,kBAAkBzmB,KAAKA,EAAL,GAAUC,KAAKA,EAAvC;AACA,SAAK8xC,aAAL,GAAqB,KAAKI,SAAL,GACnB1rB,kBAAkB,KAAKutB,sBADJ,GAEnBvtB,mBAAmB,KAAKutB,sBAF1B;AAGA,QAAI,CAAC,KAAKjC,aAAV,EAAyB;AACvB,aAAO,IAAP;AACD;AACF;;AAED,MAAI,KAAK2B,iBAAT,EAA4B;AAC1B,SAAK+B,cAAL,CAAoBxxC,KAApB;AACD,GAFD,MAEO;AACL,SAAKyxC,0BAAL,CAAgCzxC,KAAhC;AACD;AACD,SAAO,IAAP;AACD,CAvBD;;AA0BA;;;;;;AAMA6tC,KAAK1jD,SAAL,CAAeinD,SAAf,GAA2B,UAASpxC,KAAT,EAAgB;AACzC,MAAI0xC,KAAK,KAAT;AACA,MAAI,KAAKhC,cAAT,EAAyB;AACvB,QAAIiC,kBAAkB,KAAtB;AACA,QAAIC,+BAA+B,CAAC,KAAKnC,iBAAN,CAAnC;AACA,QAAI,KAAKlB,KAAL,KAAef,KAAKzV,WAAxB,EAAqC;AACnC4Z,wBAAkB,KAAK/B,aAAL,CAAmB1/D,MAAnB,GAA4B,KAAKy+D,UAAnD;AACD,KAFD,MAEO,IAAI,KAAKJ,KAAL,KAAef,KAAKvV,OAAxB,EAAiC;AACtC0Z,wBAAkB,KAAK/B,aAAL,CAAmB,CAAnB,EAAsB1/D,MAAtB,GACd,KAAKy+D,UADT;AAEAiD,qCAA+B,CAAC,KAAKhC,aAAL,CAAmB,CAAnB,EAAsB,CAAtB,CAAD,EAC7B,KAAKA,aAAL,CAAmB,CAAnB,EAAsB,KAAKA,aAAL,CAAmB,CAAnB,EAAsB1/D,MAAtB,GAA+B,CAArD,CAD6B,CAA/B;AAED;AACD,QAAIyhE,eAAJ,EAAqB;AACnB,UAAMljE,MAAMuxB,MAAMvxB,GAAlB;AACA,WAAK,IAAIwB,IAAI,CAAR,EAAWwkB,KAAKm9C,6BAA6B1hE,MAAlD,EAA0DD,IAAIwkB,EAA9D,EAAkExkB,GAAlE,EAAuE;AACrE,YAAM4hE,mBAAmBD,6BAA6B3hE,CAA7B,CAAzB;AACA,YAAM6hE,cAAcrjE,IAAIk7B,sBAAJ,CAA2BkoC,gBAA3B,CAApB;AACA,YAAMr0C,QAAQwC,MAAMxC,KAApB;AACA,YAAMzB,KAAKyB,MAAM,CAAN,IAAWs0C,YAAY,CAAZ,CAAtB;AACA,YAAM91C,KAAKwB,MAAM,CAAN,IAAWs0C,YAAY,CAAZ,CAAtB;AACA,YAAMzD,gBAAgB,KAAKH,SAAL,GAAiB,CAAjB,GAAqB,KAAKE,cAAhD;AACAsD,aAAK19D,KAAKsG,IAAL,CAAUyhB,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,KAAgCqyC,aAArC;AACA,YAAIqD,EAAJ,EAAQ;AACN,eAAKjC,iBAAL,GAAyBoC,gBAAzB;AACA;AACD;AACF;AACF;AACF;AACD,SAAOH,EAAP;AACD,CA/BD;;AAkCA;;;;AAIA7D,KAAK1jD,SAAL,CAAesnD,0BAAf,GAA4C,UAASzxC,KAAT,EAAgB;AAC1D,MAAM6rB,cAAc7rB,MAAMtC,UAAN,CAAiB5tB,KAAjB,EAApB;AACA,MAAI,CAAC,KAAK6/D,YAAV,EAAwB;AACtB,SAAKA,YAAL,GAAoB,IAAIn4C,iBAAJ,CAAY,IAAI46B,eAAJ,CAAUvG,WAAV,CAAZ,CAApB;AACA,SAAKkmB,qBAAL;AACD,GAHD,MAGO;AACL,QAAMC,kBAAkB,mCAAqC,KAAKrC,YAAL,CAAkBn3C,WAAlB,EAA7D;AACAw5C,oBAAgBhd,cAAhB,CAA+BnJ,WAA/B;AACD;AACF,CATD;;AAYA;;;;;AAKAgiB,KAAK1jD,SAAL,CAAe8mD,aAAf,GAA+B,UAASjxC,KAAT,EAAgB;AAC7C,MAAM0T,QAAQ1T,MAAMtC,UAApB;AACA,OAAK+xC,iBAAL,GAAyB/7B,KAAzB;AACA,MAAI,KAAK66B,KAAL,KAAef,KAAK1V,KAAxB,EAA+B;AAC7B,SAAK8X,aAAL,GAAqBl8B,MAAM5jC,KAAN,EAArB;AACD,GAFD,MAEO,IAAI,KAAKy+D,KAAL,KAAef,KAAKvV,OAAxB,EAAiC;AACtC,SAAK2X,aAAL,GAAqB,CAAC,CAACl8B,MAAM5jC,KAAN,EAAD,EAAgB4jC,MAAM5jC,KAAN,EAAhB,CAAD,CAArB;AACA,SAAKggE,iBAAL,GAAyB,KAAKF,aAAL,CAAmB,CAAnB,CAAzB;AACD,GAHM,MAGA;AACL,SAAKA,aAAL,GAAqB,CAACl8B,MAAM5jC,KAAN,EAAD,EAAgB4jC,MAAM5jC,KAAN,EAAhB,CAArB;AACD;AACD,MAAI,KAAKggE,iBAAT,EAA4B;AAC1B,SAAKD,WAAL,GAAmB,IAAIr4C,iBAAJ,CACjB,IAAI66B,oBAAJ,CAAe,KAAKyd,iBAApB,CADiB,CAAnB;AAED;AACD,MAAM73C,WAAW,KAAKq3C,iBAAL,CAAuB,KAAKM,aAA5B,CAAjB;AACA,OAAKF,cAAL,GAAsB,IAAIl4C,iBAAJ,EAAtB;AACA,MAAI,KAAKG,aAAT,EAAwB;AACtB,SAAK+3C,cAAL,CAAoBp3C,eAApB,CAAoC,KAAKX,aAAzC;AACD;AACD,OAAK+3C,cAAL,CAAoBx3C,WAApB,CAAgCD,QAAhC;AACA,OAAK85C,qBAAL;AACA,OAAKv7C,aAAL,CAAmB,IAAIo3C,SAAJ,CAAcH,cAAcC,SAA5B,EAAuC,KAAKgC,cAA5C,CAAnB;AACD,CAvBD;;AA0BA;;;;;AAKA7B,KAAK1jD,SAAL,CAAeqnD,cAAf,GAAgC,UAASxxC,KAAT,EAAgB;AAC9C,MAAItC,aAAasC,MAAMtC,UAAvB;AACA,MAAMzF,WAAW,4CAA8C,KAAKy3C,cAAL,CAAoBl3C,WAApB,EAA/D;AACA,MAAIqzB,oBAAJ;AAAA,MAAiB4X,aAAjB;AACA,MAAI,KAAK8K,KAAL,KAAef,KAAK1V,KAAxB,EAA+B;AAC7B2L,WAAO,KAAKmM,aAAZ;AACD,GAFD,MAEO,IAAI,KAAKrB,KAAL,KAAef,KAAKvV,OAAxB,EAAiC;AACtCpM,kBAAc,KAAK+jB,aAAL,CAAmB,CAAnB,CAAd;AACAnM,WAAO5X,YAAYA,YAAY37C,MAAZ,GAAqB,CAAjC,CAAP;AACA,QAAI,KAAKkhE,SAAL,CAAepxC,KAAf,CAAJ,EAA2B;AACzB;AACAtC,mBAAa,KAAK+xC,iBAAL,CAAuB3/D,KAAvB,EAAb;AACD;AACF,GAPM,MAOA;AACL+7C,kBAAc,KAAK+jB,aAAnB;AACAnM,WAAO5X,YAAYA,YAAY37C,MAAZ,GAAqB,CAAjC,CAAP;AACD;AACDuzD,OAAK,CAAL,IAAU/lC,WAAW,CAAX,CAAV;AACA+lC,OAAK,CAAL,IAAU/lC,WAAW,CAAX,CAAV;AACA,OAAK4xC,iBAAL,EAAuB,uDAAyD,KAAKM,aAArF,EAAqG33C,QAArG;AACA,MAAI,KAAK03C,YAAT,EAAuB;AACrB,QAAMqC,kBAAkB,mCAAqC,KAAKrC,YAAL,CAAkBn3C,WAAlB,EAA7D;AACAw5C,oBAAgBhd,cAAhB,CAA+Bt3B,UAA/B;AACD;AACD,MAAIu0C,uBAAJ;AACA,MAAIh6C,oBAAoBw6B,iBAApB,IACA,KAAK8b,KAAL,KAAef,KAAKvV,OADxB,EACiC;AAC/B,QAAI,CAAC,KAAK4X,WAAV,EAAuB;AACrB,WAAKA,WAAL,GAAmB,IAAIr4C,iBAAJ,CAAY,IAAI66B,oBAAJ,CAAe,IAAf,CAAZ,CAAnB;AACD;AACD,QAAM6f,OAAOj6C,SAASglC,aAAT,CAAuB,CAAvB,CAAb;AACAgV,qBAAiB,wCAA0C,KAAKpC,WAAL,CAAiBr3C,WAAjB,EAA3D;AACAy5C,mBAAe9d,kBAAf,CACE+d,KAAK3X,SAAL,EADF,EACoB2X,KAAKh6B,kBAAL,EADpB;AAED,GATD,MASO,IAAI,KAAK43B,iBAAT,EAA4B;AACjCmC,qBAAiB,wCAA0C,KAAKpC,WAAL,CAAiBr3C,WAAjB,EAA3D;AACAy5C,mBAAejd,cAAf,CAA8B,KAAK8a,iBAAnC;AACD;AACD,OAAKiC,qBAAL;AACD,CAvCD;;AA0CA;;;;;AAKAlE,KAAK1jD,SAAL,CAAe2mD,aAAf,GAA+B,UAAS9wC,KAAT,EAAgB;AAC7C,MAAMtC,aAAasC,MAAMtC,UAAzB;AACA,MAAMzF,WAAW,4CAA8C,KAAKy3C,cAAL,CAAoBl3C,WAApB,EAA/D;AACA,MAAI25C,aAAJ;AACA,MAAItmB,oBAAJ;AACA,MAAI,KAAK0iB,KAAL,KAAef,KAAKzV,WAAxB,EAAqC;AACnC,SAAK0X,iBAAL,GAAyB/xC,WAAW5tB,KAAX,EAAzB;AACA+7C,kBAAc,KAAK+jB,aAAnB;AACA,QAAI/jB,YAAY37C,MAAZ,IAAsB,KAAK2+D,UAA/B,EAA2C;AACzC,UAAI,KAAKX,SAAT,EAAoB;AAClBriB,oBAAYv5B,GAAZ;AACD,OAFD,MAEO;AACL6/C,eAAO,IAAP;AACD;AACF;AACDtmB,gBAAY55C,IAAZ,CAAiByrB,WAAW5tB,KAAX,EAAjB;AACA,SAAKw/D,iBAAL,CAAuBzjB,WAAvB,EAAoC5zB,QAApC;AACD,GAZD,MAYO,IAAI,KAAKs2C,KAAL,KAAef,KAAKvV,OAAxB,EAAiC;AACtCpM,kBAAc,KAAK+jB,aAAL,CAAmB,CAAnB,CAAd;AACA,QAAI/jB,YAAY37C,MAAZ,IAAsB,KAAK2+D,UAA/B,EAA2C;AACzC,UAAI,KAAKX,SAAT,EAAoB;AAClBriB,oBAAYv5B,GAAZ;AACD,OAFD,MAEO;AACL6/C,eAAO,IAAP;AACD;AACF;AACDtmB,gBAAY55C,IAAZ,CAAiByrB,WAAW5tB,KAAX,EAAjB;AACA,QAAIqiE,IAAJ,EAAU;AACR,WAAK1C,iBAAL,GAAyB5jB,YAAY,CAAZ,CAAzB;AACD;AACD,SAAKyjB,iBAAL,CAAuB,KAAKM,aAA5B,EAA2C33C,QAA3C;AACD;AACD,OAAK85C,qBAAL;AACA,MAAII,IAAJ,EAAU;AACR,SAAKhB,aAAL;AACD;AACF,CApCD;;AAuCA;;;;AAIAtD,KAAK1jD,SAAL,CAAeioD,eAAf,GAAiC,YAAW;AAC1C,MAAI,CAAC,KAAK1C,cAAV,EAA0B;AACxB;AACD;AACD,MAAMz3C,WAAW,4CAA8C,KAAKy3C,cAAL,CAAoBl3C,WAApB,EAA/D;AACA,MAAIqzB,oBAAJ;AAAA,MAAiBomB,uBAAjB;AACA,MAAI,KAAK1D,KAAL,KAAef,KAAKzV,WAAxB,EAAqC;AACnClM,kBAAc,KAAK+jB,aAAnB;AACA/jB,gBAAYt1B,MAAZ,CAAmB,CAAC,CAApB,EAAuB,CAAvB;AACA,SAAK+4C,iBAAL,CAAuBzjB,WAAvB,EAAoC5zB,QAApC;AACA,QAAI4zB,YAAY37C,MAAZ,IAAsB,CAA1B,EAA6B;AAC3B,WAAKu/D,iBAAL,GAAyB5jB,YAAYA,YAAY37C,MAAZ,GAAqB,CAAjC,EAAoCJ,KAApC,EAAzB;AACD;AACF,GAPD,MAOO,IAAI,KAAKy+D,KAAL,KAAef,KAAKvV,OAAxB,EAAiC;AACtCpM,kBAAc,KAAK+jB,aAAL,CAAmB,CAAnB,CAAd;AACA/jB,gBAAYt1B,MAAZ,CAAmB,CAAC,CAApB,EAAuB,CAAvB;AACA07C,qBAAiB,wCAA0C,KAAKpC,WAAL,CAAiBr3C,WAAjB,EAA3D;AACAy5C,mBAAejd,cAAf,CAA8BnJ,WAA9B;AACA,SAAKyjB,iBAAL,CAAuB,KAAKM,aAA5B,EAA2C33C,QAA3C;AACD;;AAED,MAAI4zB,YAAY37C,MAAZ,KAAuB,CAA3B,EAA8B;AAC5B,SAAKu/D,iBAAL,GAAyB,IAAzB;AACD;;AAED,OAAKsC,qBAAL;AACD,CA1BD;;AA6BA;;;;;;AAMAlE,KAAK1jD,SAAL,CAAegnD,aAAf,GAA+B,YAAW;AACxC,MAAMkB,gBAAgB,KAAKhB,aAAL,EAAtB;AACA,MAAI,CAACgB,aAAL,EAAoB;AAClB;AACD;AACD,MAAIxmB,cAAc,KAAK+jB,aAAvB;AACA,MAAM33C,WAAW,4CAA8Co6C,cAAc75C,WAAd,EAA/D;AACA,MAAI,KAAK+1C,KAAL,KAAef,KAAKzV,WAAxB,EAAqC;AACnC;AACAlM,gBAAYv5B,GAAZ;AACA,SAAKg9C,iBAAL,CAAuBzjB,WAAvB,EAAoC5zB,QAApC;AACD,GAJD,MAIO,IAAI,KAAKs2C,KAAL,KAAef,KAAKvV,OAAxB,EAAiC;AACtC;AACApM,gBAAY,CAAZ,EAAev5B,GAAf;AACA,SAAKg9C,iBAAL,CAAuBzjB,WAAvB,EAAoC5zB,QAApC;AACA4zB,kBAAc5zB,SAAS26B,cAAT,EAAd;AACD;;AAED;AACA,MAAI,KAAK0b,KAAL,KAAez2B,uBAAaqgB,WAAhC,EAA6C;AAC3Cma,kBAAcn6C,WAAd,CAA0B,IAAIq6B,oBAAJ,CAAe,CAAC1G,WAAD,CAAf,CAA1B;AACD,GAFD,MAEO,IAAI,KAAKyiB,KAAL,KAAez2B,uBAAasgB,iBAAhC,EAAmD;AACxDka,kBAAcn6C,WAAd,CAA0B,IAAIo6B,yBAAJ,CAAoB,CAACzG,WAAD,CAApB,CAA1B;AACD,GAFM,MAEA,IAAI,KAAKyiB,KAAL,KAAez2B,uBAAaugB,aAAhC,EAA+C;AACpDia,kBAAcn6C,WAAd,CAA0B,IAAIs6B,sBAAJ,CAAiB,CAAC3G,WAAD,CAAjB,CAA1B;AACD;;AAED;AACA,OAAKr1B,aAAL,CAAmB,IAAIo3C,SAAJ,CAAcH,cAAcE,OAA5B,EAAqC0E,aAArC,CAAnB;;AAEA;AACA,MAAI,KAAKlE,SAAT,EAAoB;AAClB,SAAKA,SAAL,CAAel8D,IAAf,CAAoBogE,aAApB;AACD;AACD,MAAI,KAAK5I,OAAT,EAAkB;AAChB,SAAKA,OAAL,CAAa6I,UAAb,CAAwBD,aAAxB;AACD;AACF,CArCD;;AAwCA;;;;;AAKAxE,KAAK1jD,SAAL,CAAeknD,aAAf,GAA+B,YAAW;AACxC,OAAK5B,iBAAL,GAAyB,IAAzB;AACA,MAAM4C,gBAAgB,KAAK3C,cAA3B;AACA,MAAI2C,aAAJ,EAAmB;AACjB,SAAK3C,cAAL,GAAsB,IAAtB;AACA,SAAKC,YAAL,GAAoB,IAApB;AACA,SAAKE,WAAL,GAAmB,IAAnB;AACA,SAAKI,QAAL,CAAcjxB,SAAd,GAA0BhpB,KAA1B,CAAgC,IAAhC;AACD;AACD,SAAOq8C,aAAP;AACD,CAVD;;AAaA;;;;;;;AAOAxE,KAAK1jD,SAAL,CAAe+L,MAAf,GAAwB,UAASxX,OAAT,EAAkB;AACxC,MAAMuZ,WAAWvZ,QAAQ8Z,WAAR,EAAjB;AACA,MAAMkgC,aAAa,wCAA0CzgC,QAA7D;AACA,OAAKy3C,cAAL,GAAsBhxD,OAAtB;AACA,OAAKkxD,aAAL,GAAqBlX,WAAW9F,cAAX,EAArB;AACA,MAAM6Q,OAAO,KAAKmM,aAAL,CAAmB,KAAKA,aAAL,CAAmB1/D,MAAnB,GAA4B,CAA/C,CAAb;AACA,OAAKu/D,iBAAL,GAAyBhM,KAAK3zD,KAAL,EAAzB;AACA,OAAK8/D,aAAL,CAAmB39D,IAAnB,CAAwBwxD,KAAK3zD,KAAL,EAAxB;AACA,OAAKiiE,qBAAL;AACA,OAAKv7C,aAAL,CAAmB,IAAIo3C,SAAJ,CAAcH,cAAcC,SAA5B,EAAuC,KAAKgC,cAA5C,CAAnB;AACD,CAVD;;AAaA;;;AAGA7B,KAAK1jD,SAAL,CAAeuiD,eAAf,GAAiC1jB,gBAAjC;;AAGA;;;;AAIA6kB,KAAK1jD,SAAL,CAAe4nD,qBAAf,GAAuC,YAAW;AAChD,MAAMQ,iBAAiB,EAAvB;AACA,MAAI,KAAK7C,cAAT,EAAyB;AACvB6C,mBAAetgE,IAAf,CAAoB,KAAKy9D,cAAzB;AACD;AACD,MAAI,KAAKG,WAAT,EAAsB;AACpB0C,mBAAetgE,IAAf,CAAoB,KAAK49D,WAAzB;AACD;AACD,MAAI,KAAKF,YAAT,EAAuB;AACrB4C,mBAAetgE,IAAf,CAAoB,KAAK09D,YAAzB;AACD;AACD,MAAM6C,gBAAgB,KAAKvC,QAAL,CAAcjxB,SAAd,EAAtB;AACAwzB,gBAAcx8C,KAAd,CAAoB,IAApB;AACAw8C,gBAAc5iB,WAAd,CAA0B2iB,cAA1B;AACD,CAdD;;AAiBA;;;AAGA1E,KAAK1jD,SAAL,CAAewmD,YAAf,GAA8B,YAAW;AACvC,MAAMliE,MAAM,KAAKyxC,MAAL,EAAZ;AACA,MAAMsqB,SAAS,KAAKz/B,SAAL,EAAf;AACA,MAAI,CAACt8B,GAAD,IAAQ,CAAC+7D,MAAb,EAAqB;AACnB,SAAK6G,aAAL;AACD;AACD,OAAKpB,QAAL,CAAclpC,MAAd,CAAqByjC,SAAS/7D,GAAT,GAAe,IAApC;AACD,CAPD;;AAUA;;;;;;;;;;;;;AAaO,SAAS6+D,oBAAT,CAA8B/P,SAA9B,EAAyCC,SAAzC,EAAoD;AACzD,SAAO,UAAS3R,WAAT,EAAsBqjB,YAAtB,EAAoC;AACzC,QAAMpgE,SAAS+8C,YAAY,CAAZ,CAAf;AACA,QAAMjwB,MAAMiwB,YAAY,CAAZ,CAAZ;AACA,QAAMoI,SAASjgD,KAAKsG,IAAL,CACb,iCAA0BxL,MAA1B,EAAkC8sB,GAAlC,CADa,CAAf;AAEA,QAAM3D,WAAWi3C,eAAe,qCAAuCA,YAAtD,GACf,yBAAW,IAAIpb,gBAAJ,CAAWhlD,MAAX,CAAX,EAA+ByuD,SAA/B,CADF;AAEA,QAAMxZ,QAAQyZ,YAAYA,SAAZ,GACZxpD,KAAKgH,IAAL,CAAU,CAAC4gB,IAAI,CAAJ,IAAS9sB,OAAO,CAAP,CAAV,KAAwB8sB,IAAI,CAAJ,IAAS9sB,OAAO,CAAP,CAAjC,CAAV,CADF;AAEA,8BAAYmpB,QAAZ,EAAsBnpB,MAAtB,EAA8BmlD,MAA9B,EAAsClQ,KAAtC;AACA,WAAO9rB,QAAP;AACD,GAXD;AAYD;;AAGD;;;;;;;AAOO,SAASs1C,SAAT,GAAqB;AAC1B,SACE,UAAS1hB,WAAT,EAAsBqjB,YAAtB,EAAoC;AAClC,QAAM71C,SAAS,4BAAewyB,WAAf,CAAf;AACA,QAAM5zB,WAAWi3C,gBAAgB,IAAIzc,iBAAJ,CAAY,IAAZ,CAAjC;AACAx6B,aAAS+8B,cAAT,CAAwB,CAAC,CACvB,2BAAc37B,MAAd,CADuB,EAEvB,4BAAeA,MAAf,CAFuB,EAGvB,yBAAYA,MAAZ,CAHuB,EAIvB,wBAAWA,MAAX,CAJuB,EAKvB,2BAAcA,MAAd,CALuB,CAAD,CAAxB;AAOA,WAAOpB,QAAP;AACD,GAZH;AAcD;;AAGD;;;;;;AAMA,SAASu2C,OAAT,CAAiBj+D,IAAjB,EAAuB;AACrB,MAAI8+D,aAAJ;AACA,MAAI9+D,SAASsnC,uBAAaigB,KAAtB,IACAvnD,SAASsnC,uBAAaqgB,WAD1B,EACuC;AACrCmX,WAAO7B,KAAK1V,KAAZ;AACD,GAHD,MAGO,IAAIvnD,SAASsnC,uBAAakgB,WAAtB,IACPxnD,SAASsnC,uBAAasgB,iBADnB,EACsC;AAC3CkX,WAAO7B,KAAKzV,WAAZ;AACD,GAHM,MAGA,IAAIxnD,SAASsnC,uBAAaogB,OAAtB,IACP1nD,SAASsnC,uBAAaugB,aADnB,EACkC;AACvCiX,WAAO7B,KAAKvV,OAAZ;AACD,GAHM,MAGA,IAAI1nD,SAASsnC,uBAAaC,MAA1B,EAAkC;AACvCu3B,WAAO7B,KAAK11B,MAAZ;AACD;AACD;AACE,mDAAiDu3B;AADnD;AAGD;;kBAGcxB,I;;;;;;;;;;;;;;;;;;ACngCf;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAGA;;;;;;;;;;;;;;;;AAiBA;;;AApCA;;;AAuCA,IAAM4E,kBAAkB;AACtB;;;;;AAKAC,iBAAe;AANO,CAAxB;;AAUA;;;;;;;;;AASA,IAAMC,yBAAyB,SAAzBA,sBAAyB,CAASt5C,MAAT,EAAiB;AAC9ChE,kBAAM7J,IAAN,CAAW,IAAX,EAAiBinD,gBAAgBC,aAAjC;;AAEA;;;;;AAKA,OAAKr5C,MAAL,GAAcA,MAAd;AAED,CAVD;AAWA,qBAASs5C,sBAAT,EAAiCt9C,eAAjC;;AAGA;;;;;;;;;;;;AAYA,IAAMu9C,oBAAoB,SAApBA,iBAAoB,CAASn9C,WAAT,EAAsB;;AAE9C,MAAMze,UAAUye,eAAe,EAA/B;;AAEA;;;;;AAKA,OAAK0/B,OAAL,GAAe,IAAf;;AAEA;;;;;AAKA,OAAK0d,eAAL,GAAuB,IAAvB;;AAEA;;;;;AAKA,OAAKC,eAAL,GAAuB97D,QAAQ+7D,cAAR,KAA2BliE,SAA3B,GACrBmG,QAAQ+7D,cADa,GACI,EAD3B;;AAGA;;;;;AAKA,OAAKC,gBAAL,GAAwB,KAAxB;;AAEA;;;;;AAKA,OAAKC,cAAL,GAAsB,IAAtB;;AAEA;;;;;AAKA,OAAKC,cAAL,GAAsB,IAAtB;;AAEA,MAAI,CAACz9C,WAAL,EAAkB;AAChBA,kBAAc,EAAd;AACD;;AAEDu1C,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BC,qBAAiBA,eAFW;AAG5BjgC,iBAAaA,WAHe;AAI5BkgC,mBAAeA;AAJa,GAA9B;;AAOA;;;;;AAKA,OAAKgI,cAAL,GAAsB,IAAIjlE,gBAAJ,CAAgB;AACpCE,YAAQ,IAAIC,gBAAJ,CAAiB;AACvB6hE,uBAAiB,KADM;AAEvBC,aAAO,CAAC,CAAC16C,YAAY06C;AAFE,KAAjB,CAD4B;AAKpC97C,WAAOoB,YAAY29C,QAAZ,GAAuB39C,YAAY29C,QAAnC,GAA8CC,+BALjB;AAMpCC,0BAAsB,IANc;AAOpCjD,4BAAwB;AAPY,GAAhB,CAAtB;;AAUA;;;;;AAKA,OAAKkD,cAAL,GAAsB,IAAIrlE,gBAAJ,CAAgB;AACpCE,YAAQ,IAAIC,gBAAJ,CAAiB;AACvB6hE,uBAAiB,KADM;AAEvBC,aAAO,CAAC,CAAC16C,YAAY06C;AAFE,KAAjB,CAD4B;AAKpC97C,WAAOoB,YAAY+9C,YAAZ,GAA2B/9C,YAAY+9C,YAAvC,GAAsDC,gCALzB;AAMpCH,0BAAsB,IANc;AAOpCjD,4BAAwB;AAPY,GAAhB,CAAtB;;AAUA,MAAI56C,YAAY4D,MAAhB,EAAwB;AACtB,SAAKq6C,SAAL,CAAej+C,YAAY4D,MAA3B;AACD;AACF,CA3FD;;AA6FA,qBAASu5C,iBAAT,EAA4B5H,iBAA5B;;AAEA;;;;;AAKA,SAAS//B,WAAT,CAAqBJ,eAArB,EAAsC;AACpC,MAAI,EAAEA,2BAA2BrL,gCAA7B,CAAJ,EAA0D;AACxD,WAAO,IAAP;AACD;AACD;AACA,MAAIqL,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBN,WAA5C,IAA2D,CAAC,KAAKstC,sBAArE,EAA6F;AAC3F,SAAK/rC,kBAAL,CAAwBmK,eAAxB;AACD;AACD;AACAmmC,uBAAmBxlD,IAAnB,CAAwB,IAAxB,EAA8Bqf,eAA9B;AACA;AACA,SAAO,KAAP;AACD;;AAED;;;;;AAKA,SAASogC,eAAT,CAAyBpgC,eAAzB,EAA0C;AACxC,MAAMrN,QAAQqN,gBAAgBrN,KAA9B;AACA,MAAM/uB,MAAMo8B,gBAAgBp8B,GAA5B;;AAEA,MAAM4qB,SAAS,KAAKM,SAAL,EAAf;AACA,MAAIg6C,SAAS,KAAKC,aAAL,CAAmBp2C,KAAnB,EAA0B/uB,GAA1B,CAAb;;AAEA;AACA,MAAMolE,mBAAmB,SAAnBA,gBAAmB,CAASne,KAAT,EAAgB;AACvC,QAAIoe,KAAK,IAAT;AACA,QAAIC,KAAK,IAAT;AACA,QAAIre,MAAM,CAAN,KAAYr8B,OAAO,CAAP,CAAhB,EAA2B;AACzBy6C,WAAKz6C,OAAO,CAAP,CAAL;AACD,KAFD,MAEO,IAAIq8B,MAAM,CAAN,KAAYr8B,OAAO,CAAP,CAAhB,EAA2B;AAChCy6C,WAAKz6C,OAAO,CAAP,CAAL;AACD;AACD,QAAIq8B,MAAM,CAAN,KAAYr8B,OAAO,CAAP,CAAhB,EAA2B;AACzB06C,WAAK16C,OAAO,CAAP,CAAL;AACD,KAFD,MAEO,IAAIq8B,MAAM,CAAN,KAAYr8B,OAAO,CAAP,CAAhB,EAA2B;AAChC06C,WAAK16C,OAAO,CAAP,CAAL;AACD;AACD,QAAIy6C,OAAO,IAAP,IAAeC,OAAO,IAA1B,EAAgC;AAC9B,aAAO,CAACD,EAAD,EAAKC,EAAL,CAAP;AACD;AACD,WAAO,IAAP;AACD,GAjBD;AAkBA,MAAIJ,UAAUt6C,MAAd,EAAsB;AACpB,QAAMhf,IAAKs5D,OAAO,CAAP,KAAat6C,OAAO,CAAP,CAAb,IAA0Bs6C,OAAO,CAAP,KAAat6C,OAAO,CAAP,CAAxC,GAAqDs6C,OAAO,CAAP,CAArD,GAAiE,IAA3E;AACA,QAAMvrD,IAAKurD,OAAO,CAAP,KAAat6C,OAAO,CAAP,CAAb,IAA0Bs6C,OAAO,CAAP,KAAat6C,OAAO,CAAP,CAAxC,GAAqDs6C,OAAO,CAAP,CAArD,GAAiE,IAA3E;;AAEA;AACA,QAAIt5D,MAAM,IAAN,IAAc+N,MAAM,IAAxB,EAA8B;AAC5B,WAAKyqD,eAAL,GAAuBmB,gBAAgBH,iBAAiBF,MAAjB,CAAhB,CAAvB;AACF;AACC,KAHD,MAGO,IAAIt5D,MAAM,IAAV,EAAgB;AACrB,WAAKw4D,eAAL,GAAuBoB,eACrBJ,iBAAiB,CAACx5D,CAAD,EAAIgf,OAAO,CAAP,CAAJ,CAAjB,CADqB,EAErBw6C,iBAAiB,CAACx5D,CAAD,EAAIgf,OAAO,CAAP,CAAJ,CAAjB,CAFqB,CAAvB;AAID,KALM,MAKA,IAAIjR,MAAM,IAAV,EAAgB;AACrB,WAAKyqD,eAAL,GAAuBoB,eACrBJ,iBAAiB,CAACx6C,OAAO,CAAP,CAAD,EAAYjR,CAAZ,CAAjB,CADqB,EAErByrD,iBAAiB,CAACx6C,OAAO,CAAP,CAAD,EAAYjR,CAAZ,CAAjB,CAFqB,CAAvB;AAID;AACH;AACC,GApBD,MAoBO;AACLurD,aAASllE,IAAIkvB,sBAAJ,CAA2BH,KAA3B,CAAT;AACA,SAAKk2C,SAAL,CAAe,CAACC,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,EAAuBA,OAAO,CAAP,CAAvB,EAAkCA,OAAO,CAAP,CAAlC,CAAf;AACA,SAAKd,eAAL,GAAuBmB,gBAAgBL,MAAhB,CAAvB;AACD;AACD,SAAO,IAAP,CAnDwC,CAmD3B;AACd;;AAED;;;;;AAKA,SAASzI,eAAT,CAAyBrgC,eAAzB,EAA0C;AACxC,MAAI,KAAKgoC,eAAT,EAA0B;AACxB,QAAMqB,kBAAkBrpC,gBAAgBnN,UAAxC;AACA,SAAKg2C,SAAL,CAAe,KAAKb,eAAL,CAAqBqB,eAArB,CAAf;AACA,SAAKC,6BAAL,CAAmCD,eAAnC;AACD;AACD,SAAO,IAAP;AACD;;AAED;;;;;AAKA,SAAS/I,aAAT,CAAuBtgC,eAAvB,EAAwC;AACtC,OAAKgoC,eAAL,GAAuB,IAAvB;AACA;AACA,MAAMx5C,SAAS,KAAKM,SAAL,EAAf;AACA,MAAI,CAACN,MAAD,IAAW,qBAAQA,MAAR,MAAoB,CAAnC,EAAsC;AACpC,SAAKq6C,SAAL,CAAe,IAAf;AACD;AACD,SAAO,KAAP,CAPsC,CAOxB;AACf;;AAED;;;;;AAKA,SAASL,6BAAT,GAAyC;AACvC,MAAMh/C,QAAQ,gCAAd;AACA,SAAO,UAAS3V,OAAT,EAAkB4a,UAAlB,EAA8B;AACnC,WAAOjF,MAAMwjB,uBAAaogB,OAAnB,CAAP;AACD,GAFD;AAGD;;AAED;;;;;AAKA,SAASwb,8BAAT,GAA0C;AACxC,MAAMp/C,QAAQ,gCAAd;AACA,SAAO,UAAS3V,OAAT,EAAkB4a,UAAlB,EAA8B;AACnC,WAAOjF,MAAMwjB,uBAAaigB,KAAnB,CAAP;AACD,GAFD;AAGD;;AAED;;;;AAIA,SAASkc,eAAT,CAAyBI,UAAzB,EAAqC;AACnC,SAAO,UAAS1e,KAAT,EAAgB;AACrB,WAAO,4BAAe,CAAC0e,UAAD,EAAa1e,KAAb,CAAf,CAAP;AACD,GAFD;AAGD;;AAED;;;;;AAKA,SAASue,cAAT,CAAwBI,OAAxB,EAAiCC,OAAjC,EAA0C;AACxC,MAAID,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CAAlB,EAA8B;AAC5B,WAAO,UAAS5e,KAAT,EAAgB;AACrB,aAAO,4BAAe,CAAC2e,OAAD,EAAU,CAAC3e,MAAM,CAAN,CAAD,EAAW4e,QAAQ,CAAR,CAAX,CAAV,CAAf,CAAP;AACD,KAFD;AAGD,GAJD,MAIO,IAAID,QAAQ,CAAR,KAAcC,QAAQ,CAAR,CAAlB,EAA8B;AACnC,WAAO,UAAS5e,KAAT,EAAgB;AACrB,aAAO,4BAAe,CAAC2e,OAAD,EAAU,CAACC,QAAQ,CAAR,CAAD,EAAa5e,MAAM,CAAN,CAAb,CAAV,CAAf,CAAP;AACD,KAFD;AAGD,GAJM,MAIA;AACL,WAAO,IAAP;AACD;AACF;;AAED;;;;AAIA,SAAS6e,WAAT,CAAqBl7C,MAArB,EAA6B;AAC3B,SAAO,CACL,CAAC,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAD,EAAyB,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAzB,CADK,EAEL,CAAC,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAD,EAAyB,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAzB,CAFK,EAGL,CAAC,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAD,EAAyB,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAzB,CAHK,EAIL,CAAC,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAD,EAAyB,CAACA,OAAO,CAAP,CAAD,EAAYA,OAAO,CAAP,CAAZ,CAAzB,CAJK,CAAP;AAMD;;AAED;;;;;;AAMAu5C,kBAAkBzoD,SAAlB,CAA4BypD,aAA5B,GAA4C,UAASp2C,KAAT,EAAgB/uB,GAAhB,EAAqB;AAC/D,MAAMylE,kBAAkBzlE,IAAIkvB,sBAAJ,CAA2BH,KAA3B,CAAxB;AACA,MAAMg3C,iBAAiB,SAAjBA,cAAiB,CAASr8D,CAAT,EAAYD,CAAZ,EAAe;AACpC,WAAO,0CAAyBg8D,eAAzB,EAA0C/7D,CAA1C,IACH,0CAAyB+7D,eAAzB,EAA0Ch8D,CAA1C,CADJ;AAED,GAHD;AAIA,MAAMmhB,SAAS,KAAKM,SAAL,EAAf;AACA,MAAIN,MAAJ,EAAY;AACV;AACA,QAAMo7C,WAAWF,YAAYl7C,MAAZ,CAAjB;AACAo7C,aAAS52D,IAAT,CAAc22D,cAAd;AACA,QAAME,iBAAiBD,SAAS,CAAT,CAAvB;;AAEA,QAAId,SAAU,kCAAiBO,eAAjB,EACZQ,cADY,CAAd;AAEA,QAAMC,cAAclmE,IAAIk7B,sBAAJ,CAA2BgqC,MAA3B,CAApB;;AAEA;AACA,QAAI,0BAAmBn2C,KAAnB,EAA0Bm3C,WAA1B,KAA0C,KAAK7B,eAAnD,EAAoE;AAClE;AACA,UAAM8B,SAASnmE,IAAIk7B,sBAAJ,CAA2B+qC,eAAe,CAAf,CAA3B,CAAf;AACA,UAAMG,SAASpmE,IAAIk7B,sBAAJ,CAA2B+qC,eAAe,CAAf,CAA3B,CAAf;AACA,UAAMI,eAAe,iCAA0BH,WAA1B,EAAuCC,MAAvC,CAArB;AACA,UAAMG,eAAe,iCAA0BJ,WAA1B,EAAuCE,MAAvC,CAArB;AACA,UAAMG,OAAOhhE,KAAKsG,IAAL,CAAUtG,KAAKiH,GAAL,CAAS65D,YAAT,EAAuBC,YAAvB,CAAV,CAAb;AACA,WAAK/B,gBAAL,GAAwBgC,QAAQ,KAAKlC,eAArC;AACA,UAAI,KAAKE,gBAAT,EAA2B;AACzBW,iBAASmB,eAAeC,YAAf,GACPL,eAAe,CAAf,CADO,GACaA,eAAe,CAAf,CADtB;AAED;AACD,aAAOf,MAAP;AACD;AACF;AACD,SAAO,IAAP;AACD,CAlCD;;AAoCA;;;;AAIAf,kBAAkBzoD,SAAlB,CAA4BuW,kBAA5B,GAAiD,UAASmK,eAAT,EAA0B;AACzE,MAAMrN,QAAQqN,gBAAgBrN,KAA9B;AACA,MAAM/uB,MAAMo8B,gBAAgBp8B,GAA5B;;AAEA,MAAIklE,SAAS,KAAKC,aAAL,CAAmBp2C,KAAnB,EAA0B/uB,GAA1B,CAAb;AACA,MAAI,CAACklE,MAAL,EAAa;AACXA,aAASllE,IAAIkvB,sBAAJ,CAA2BH,KAA3B,CAAT;AACD;AACD,OAAK22C,6BAAL,CAAmCR,MAAnC;AACD,CATD;;AAWA;;;;;AAKAf,kBAAkBzoD,SAAlB,CAA4B8qD,4BAA5B,GAA2D,UAAS57C,MAAT,EAAiB;AAC1E,MAAI67C,gBAAgB,KAAKjC,cAAzB;;AAEA,MAAI,CAACiC,aAAL,EAAoB;AAClB,QAAI,CAAC77C,MAAL,EAAa;AACX67C,sBAAgB,IAAI19C,iBAAJ,CAAY,EAAZ,CAAhB;AACD,KAFD,MAEO;AACL09C,sBAAgB,IAAI19C,iBAAJ,CAAY,yBAAkB6B,MAAlB,CAAZ,CAAhB;AACD;AACD,SAAK45C,cAAL,GAAsBiC,aAAtB;AACA,SAAK/B,cAAL,CAAoBn0B,SAApB,GAAgCszB,UAAhC,CAA2C4C,aAA3C;AACD,GARD,MAQO;AACL,QAAI,CAAC77C,MAAL,EAAa;AACX67C,oBAAch9C,WAAd,CAA0BrnB,SAA1B;AACD,KAFD,MAEO;AACLqkE,oBAAch9C,WAAd,CAA0B,yBAAkBmB,MAAlB,CAA1B;AACD;AACF;AACD,SAAO67C,aAAP;AACD,CAnBD;;AAsBA;;;;;AAKAtC,kBAAkBzoD,SAAlB,CAA4BgqD,6BAA5B,GAA4D,UAASR,MAAT,EAAiB;AAC3E,MAAIwB,gBAAgB,KAAKjC,cAAzB;AACA,MAAI,CAACiC,aAAL,EAAoB;AAClBA,oBAAgB,IAAI39C,iBAAJ,CAAY,IAAI46B,eAAJ,CAAUuhB,MAAV,CAAZ,CAAhB;AACA,SAAKT,cAAL,GAAsBiC,aAAtB;AACA,SAAK5B,cAAL,CAAoBv0B,SAApB,GAAgCszB,UAAhC,CAA2C6C,aAA3C;AACD,GAJD,MAIO;AACL,QAAMl9C,WAAW,mCAAqCk9C,cAAc38C,WAAd,EAAtD;AACAP,aAAS+8B,cAAT,CAAwB2e,MAAxB;AACD;AACD,SAAOwB,aAAP;AACD,CAXD;;AAcA;;;AAGAvC,kBAAkBzoD,SAAlB,CAA4B4c,MAA5B,GAAqC,UAASt4B,GAAT,EAAc;AACjD,OAAK0kE,cAAL,CAAoBpsC,MAApB,CAA2Bt4B,GAA3B;AACA,OAAK8kE,cAAL,CAAoBxsC,MAApB,CAA2Bt4B,GAA3B;AACAu8D,oBAAmB7gD,SAAnB,CAA6B4c,MAA7B,CAAoCvb,IAApC,CAAyC,IAAzC,EAA+C/c,GAA/C;AACD,CAJD;;AAMA;;;;;;AAMAmkE,kBAAkBzoD,SAAlB,CAA4BwP,SAA5B,GAAwC,YAAW;AACjD,SAAO,KAAKw7B,OAAZ;AACD,CAFD;;AAIA;;;;;;AAMAyd,kBAAkBzoD,SAAlB,CAA4BupD,SAA5B,GAAwC,UAASr6C,MAAT,EAAiB;AACvD;AACA,OAAK87B,OAAL,GAAe97B,SAASA,MAAT,GAAkB,IAAjC;AACA,OAAK47C,4BAAL,CAAkC57C,MAAlC;AACA,OAAK7C,aAAL,CAAmB,IAAIm8C,sBAAJ,CAA2B,KAAKxd,OAAhC,CAAnB;AACD,CALD;;kBAQeyd,iB;;;;;;;;;;;;;;;;;QC5XCwC,G,GAAAA,G;QAwBAr9B,M,GAAAA,M;QAYAs9B,wB,GAAAA,wB;QAgCAtmE,I,GAAAA,I;QAYAumE,W,GAAAA,W;QAsCAC,sB,GAAAA,sB;;AA/NhB;;AACA;;;;AACA;;AACA;;;;AACA;;;;AAGA;;;;;;;;;;AAWA;;;;;;;;;;;;;;;;;AAiBA,IAAM1M,cAAc,SAAdA,WAAc,CAAS7xD,OAAT,EAAkB;;AAEpC0e,mBAAWlK,IAAX,CAAgB,IAAhB;;AAEA;;;;AAIA,OAAKyS,IAAL,GAAY,IAAZ;;AAEA,OAAKssC,SAAL,CAAe,IAAf;;AAEA;;;AAGA,OAAKt/B,WAAL,GAAmBj0B,QAAQi0B,WAA3B;AAED,CAjBD,C,CAtCA;;;;;AAyDA,qBAAS49B,WAAT,EAAsBnzC,gBAAtB;;AAGA;;;;;;AAMAmzC,YAAY1+C,SAAZ,CAAsB4gB,SAAtB,GAAkC,YAAW;AAC3C,SAAO,uBAAwB,KAAKvyB,GAAL,CAASi4D,mBAAoBC,MAA7B;AAA/B;AACD,CAFD;;AAKA;;;;;AAKA7H,YAAY1+C,SAAZ,CAAsB+1B,MAAtB,GAA+B,YAAW;AACxC,SAAO,KAAKjiB,IAAZ;AACD,CAFD;;AAKA;;;;;;AAMA4qC,YAAY1+C,SAAZ,CAAsBogD,SAAtB,GAAkC,UAASC,MAAT,EAAiB;AACjD,OAAKxzC,GAAL,CAASy5C,mBAAoBC,MAA7B,EAAqClG,MAArC;AACD,CAFD;;AAKA;;;;;;AAMA3B,YAAY1+C,SAAZ,CAAsB4c,MAAtB,GAA+B,UAASt4B,GAAT,EAAc;AAC3C,OAAKwvB,IAAL,GAAYxvB,GAAZ;AACD,CAFD;;AAKA;;;;;AAKO,SAAS2mE,GAAT,CAAaxmE,IAAb,EAAmB0lC,KAAnB,EAA0BkhC,YAA1B,EAAwC;AAC7C,MAAMjgC,gBAAgB3mC,KAAKskC,SAAL,EAAtB;AACA,MAAIqC,aAAJ,EAAmB;AACjB,QAAMzmC,SAASF,KAAKinC,eAAL,CACb,CAACN,cAAc,CAAd,IAAmBjB,MAAM,CAAN,CAApB,EAA8BiB,cAAc,CAAd,IAAmBjB,MAAM,CAAN,CAAjD,CADa,CAAf;AAEA,QAAIkhC,YAAJ,EAAkB;AAChB5mE,WAAK8+B,OAAL,CAAa;AACX5R,kBAAU05C,YADC;AAEXzhC,gBAAQ2R,cAFG;AAGX52C,gBAAQA;AAHG,OAAb;AAKD,KAND,MAMO;AACLF,WAAK2kC,SAAL,CAAezkC,MAAf;AACD;AACF;AACF;;AAGD;;;;;;AAMO,SAASipC,MAAT,CAAgBnpC,IAAhB,EAAsBi/B,QAAtB,EAAgCuL,UAAhC,EAA4Co8B,YAA5C,EAA0D;AAC/D3nC,aAAWj/B,KAAKqnC,iBAAL,CAAuBpI,QAAvB,EAAiC,CAAjC,CAAX;AACAwnC,2BAAyBzmE,IAAzB,EAA+Bi/B,QAA/B,EAAyCuL,UAAzC,EAAqDo8B,YAArD;AACD;;AAGD;;;;;;AAMO,SAASH,wBAAT,CAAkCzmE,IAAlC,EAAwCi/B,QAAxC,EAAkDuL,UAAlD,EAA8Do8B,YAA9D,EAA4E;AACjF,MAAI3nC,aAAah9B,SAAjB,EAA4B;AAC1B,QAAM4kE,kBAAkB7mE,KAAKukC,WAAL,EAAxB;AACA,QAAMoC,gBAAgB3mC,KAAKskC,SAAL,EAAtB;AACA,QAAIuiC,oBAAoB5kE,SAApB,IAAiC0kC,aAAjC,IAAkDigC,eAAe,CAArE,EAAwE;AACtE5mE,WAAK8+B,OAAL,CAAa;AACXG,kBAAUA,QADC;AAEXiG,gBAAQsF,UAFG;AAGXtd,kBAAU05C,YAHC;AAIXzhC,gBAAQ8M;AAJG,OAAb;AAMD,KAPD,MAOO;AACLjyC,WAAKmpC,MAAL,CAAYlK,QAAZ,EAAsBuL,UAAtB;AACD;AACF;AACF;;AAGD;;;;;;;;;;;;;;AAcO,SAASrqC,IAAT,CAAcH,IAAd,EAAoB0qB,UAApB,EAAgC8f,UAAhC,EAA4Co8B,YAA5C,EAA0Dz/B,aAA1D,EAAyE;AAC9Ezc,eAAa1qB,KAAKgkC,mBAAL,CAAyBtZ,UAAzB,EAAqC,CAArC,EAAwCyc,aAAxC,CAAb;AACAw/B,yBAAuB3mE,IAAvB,EAA6B0qB,UAA7B,EAAyC8f,UAAzC,EAAqDo8B,YAArD;AACD;;AAGD;;;;;;AAMO,SAASF,WAAT,CAAqB1mE,IAArB,EAA2B0lC,KAA3B,EAAkC8E,UAAlC,EAA8Co8B,YAA9C,EAA4D;AACjE,MAAMhgC,oBAAoB5mC,KAAKkrB,aAAL,EAA1B;AACA,MAAIR,aAAa1qB,KAAKgkC,mBAAL,CAAyB4C,iBAAzB,EAA4ClB,KAA5C,EAAmD,CAAnD,CAAjB;;AAEA,MAAIhb,eAAezoB,SAAnB,EAA8B;AAC5B,QAAMshC,cAAcvjC,KAAKmoC,cAAL,EAApB;AACAzd,iBAAa,iBACXA,UADW,EAEX1qB,KAAK2nC,gBAAL,MAA2BpE,YAAYA,YAAYjiC,MAAZ,GAAqB,CAAjC,CAFhB,EAGXtB,KAAK0nC,gBAAL,MAA2BnE,YAAY,CAAZ,CAHhB,CAAb;AAID;;AAED;AACA;AACA;AACA,MAAIiH,cAAc9f,eAAezoB,SAA7B,IAA0CyoB,eAAekc,iBAA7D,EAAgF;AAC9E,QAAMD,gBAAgB3mC,KAAKskC,SAAL,EAAtB;AACA,QAAIpkC,SAASF,KAAKymC,mBAAL,CAAyB/b,UAAzB,EAAqC8f,UAArC,CAAb;AACAtqC,aAASF,KAAKinC,eAAL,CAAqB/mC,MAArB,CAAT;;AAEAsqC,iBAAa,CACX,CAAC9f,aAAaic,cAAc,CAAd,CAAb,GAAgCC,oBAAoB1mC,OAAO,CAAP,CAArD,KACKwqB,aAAakc,iBADlB,CADW,EAGX,CAAClc,aAAaic,cAAc,CAAd,CAAb,GAAgCC,oBAAoB1mC,OAAO,CAAP,CAArD,KACKwqB,aAAakc,iBADlB,CAHW,CAAb;AAMD;;AAED+/B,yBAAuB3mE,IAAvB,EAA6B0qB,UAA7B,EAAyC8f,UAAzC,EAAqDo8B,YAArD;AACD;;AAGD;;;;;;AAMO,SAASD,sBAAT,CAAgC3mE,IAAhC,EAAsC0qB,UAAtC,EAAkD8f,UAAlD,EAA8Do8B,YAA9D,EAA4E;AACjF,MAAIl8C,UAAJ,EAAgB;AACd,QAAMkc,oBAAoB5mC,KAAKkrB,aAAL,EAA1B;AACA,QAAMyb,gBAAgB3mC,KAAKskC,SAAL,EAAtB;AACA,QAAIsC,sBAAsB3kC,SAAtB,IAAmC0kC,aAAnC,IACAjc,eAAekc,iBADf,IACoCggC,YADxC,EACsD;AACpD5mE,WAAK8+B,OAAL,CAAa;AACXpU,oBAAYA,UADD;AAEXwa,gBAAQsF,UAFG;AAGXtd,kBAAU05C,YAHC;AAIXzhC,gBAAQ8M;AAJG,OAAb;AAMD,KARD,MAQO;AACL,UAAIzH,UAAJ,EAAgB;AACd,YAAMtqC,SAASF,KAAKymC,mBAAL,CAAyB/b,UAAzB,EAAqC8f,UAArC,CAAf;AACAxqC,aAAK2kC,SAAL,CAAezkC,MAAf;AACD;AACDF,WAAKsqC,aAAL,CAAmB5f,UAAnB;AACD;AACF;AACF;;kBAEcuvC,W;;;;;;;;;;;;;;;;;;ACrPf;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;AAGA;;;;;;;;;;;;AAaA;;;;;;;;;;;;;;;;;AAxBA;;;AAyCA,IAAMP,cAAc,SAAdA,WAAc,CAAS7yC,WAAT,EAAsB;;AAExCozC,wBAAYr9C,IAAZ,CAAiB,IAAjB,EAAuB;AACrByf,iBAAaA;AADQ,GAAvB;;AAIA,MAAMj0B,UAAUye,eAAe,EAA/B;;AAEA;;;;;AAKA,OAAKigD,iBAAL,GAAyB,UAAS7qC,eAAT,EAA0B;AACjD,WAAO,+BAAeA,eAAf,KACL,kCAAkBA,eAAlB,CADF;AAED,GAHD;;AAKA;;;;AAIA,OAAK4gC,UAAL,GAAkBz0D,QAAQ00D,SAAR,KAAsB76D,SAAtB,GAChBmG,QAAQ00D,SADQ,GACI,KAAKgK,iBAD3B;;AAGA;;;;AAIA,OAAKn1B,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;;AAEA;;;;AAIA,OAAK65C,WAAL,GAAmB3+D,QAAQ4+D,UAAR,KAAuB/kE,SAAvB,GACjBmG,QAAQ4+D,UADS,GACI,GADvB;AAGD,CAtCD;;AAwCA,qBAAStN,WAAT,EAAsBO,qBAAtB;;AAEA;;;;;;;;AAQA,SAAS59B,WAAT,CAAqBJ,eAArB,EAAsC;AACpC,MAAIi+B,YAAY,KAAhB;AACA,MAAIj+B,gBAAgBt6B,IAAhB,IAAwBwoB,oBAAUoT,OAAtC,EAA+C;AAC7C,QAAM0pC,WAAWhrC,gBAAgBtN,aAAjC;AACA,QAAMu4C,UAAUD,SAASC,OAAzB;AACA,QAAI,KAAKrK,UAAL,CAAgB5gC,eAAhB,MACCirC,WAAWC,kBAAQ7tB,IAAnB,IACD4tB,WAAWC,kBAAQhuB,IADlB,IAED+tB,WAAWC,kBAAQ9tB,KAFlB,IAGD6tB,WAAWC,kBAAQ/tB,EAJnB,CAAJ,EAI4B;AAC1B,UAAMv5C,MAAMo8B,gBAAgBp8B,GAA5B;AACA,UAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,UAAMisC,gBAAgBpnE,KAAKkrB,aAAL,KAAuB,KAAK67C,WAAlD;AACA,UAAIlrC,SAAS,CAAb;AAAA,UAAgBE,SAAS,CAAzB;AACA,UAAImrC,WAAWC,kBAAQ7tB,IAAvB,EAA6B;AAC3Bvd,iBAAS,CAACqrC,aAAV;AACD,OAFD,MAEO,IAAIF,WAAWC,kBAAQhuB,IAAvB,EAA6B;AAClCtd,iBAAS,CAACurC,aAAV;AACD,OAFM,MAEA,IAAIF,WAAWC,kBAAQ9tB,KAAvB,EAA8B;AACnCxd,iBAASurC,aAAT;AACD,OAFM,MAEA;AACLrrC,iBAASqrC,aAAT;AACD;AACD,UAAM1hC,QAAQ,CAAC7J,MAAD,EAASE,MAAT,CAAd;AACA,8BAAiB2J,KAAjB,EAAwB1lC,KAAKukC,WAAL,EAAxB;AACA,4BAAIvkC,IAAJ,EAAU0lC,KAAV,EAAiB,KAAKiM,SAAtB;AACA1V,sBAAgBhN,cAAhB;AACAirC,kBAAY,IAAZ;AACD;AACF;AACD,SAAO,CAACA,SAAR;AACD;;kBAEcR,W;;;;;;;;;;;;;;;;;;ACzHf;;AACA;;;;AACA;;AACA;;;;;;AAGA;;;;;;;;;;AAWA;;;;;;;;;;;;;;;;;AApBA;;;AAqCA,IAAMC,eAAe,SAAfA,YAAe,CAAS9yC,WAAT,EAAsB;;AAEzCozC,wBAAYr9C,IAAZ,CAAiB,IAAjB,EAAuB;AACrByf,iBAAaA;AADQ,GAAvB;;AAIA,MAAMj0B,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA;;;;AAIA,OAAKg2C,UAAL,GAAkBz0D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwCniB,4BAA1D;;AAEA;;;;AAIA,OAAKqf,MAAL,GAAc5xD,QAAQs9B,KAAR,GAAgBt9B,QAAQs9B,KAAxB,GAAgC,CAA9C;;AAEA;;;;AAIA,OAAKiM,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;AAED,CA1BD;;AA4BA,qBAASysC,YAAT,EAAuBM,qBAAvB;;AAGA;;;;;;;;AAQA,SAAS59B,WAAT,CAAqBJ,eAArB,EAAsC;AACpC,MAAIi+B,YAAY,KAAhB;AACA,MAAIj+B,gBAAgBt6B,IAAhB,IAAwBwoB,oBAAUoT,OAAlC,IACAtB,gBAAgBt6B,IAAhB,IAAwBwoB,oBAAUqT,QADtC,EACgD;AAC9C,QAAMypC,WAAWhrC,gBAAgBtN,aAAjC;AACA,QAAM04C,WAAWJ,SAASI,QAA1B;AACA,QAAI,KAAKxK,UAAL,CAAgB5gC,eAAhB,MACCorC,YAAY,IAAIC,UAAJ,CAAe,CAAf,CAAZ,IAAiCD,YAAY,IAAIC,UAAJ,CAAe,CAAf,CAD9C,CAAJ,EACsE;AACpE,UAAMznE,MAAMo8B,gBAAgBp8B,GAA5B;AACA,UAAM6lC,QAAS2hC,YAAY,IAAIC,UAAJ,CAAe,CAAf,CAAb,GAAkC,KAAKtN,MAAvC,GAAgD,CAAC,KAAKA,MAApE;AACA,UAAMh6D,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,oCAAYn7B,IAAZ,EAAkB0lC,KAAlB,EAAyBzjC,SAAzB,EAAoC,KAAK0vC,SAAzC;AACA1V,sBAAgBhN,cAAhB;AACAirC,kBAAY,IAAZ;AACD;AACF;AACD,SAAO,CAACA,SAAR;AACD;;kBAEcP,Y;;;;;;;;;;;;;;;;;;;AC5Ff;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAGA;;;AAGA,IAAM4N,kBAAkB;AACtB;;;;;AAKAC,eAAa,aANS;AAOtB;;;;;AAKAC,aAAW;AAZW,CAAxB;;AAgBA;;;;;;;;;;AAWA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;;;;;;;;;;;;;AAxFA;;;AAqGO,IAAMC,oCAAc,SAAdA,WAAc,CAAS/lE,IAAT,EAAe+3B,QAAf,EAAyBiuC,sBAAzB,EAAiD;;AAE1ElhD,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAK+3B,QAAL,GAAgBA,QAAhB;;AAEA;;;;;AAKA,OAAKuC,eAAL,GAAuB0rC,sBAAvB;AACD,CAjBM;;AAmBP,qBAASD,WAAT,EAAsBjhD,eAAtB;;AAGA;;;;;;;;;;;;;;;;;;;AAmBA,IAAMmhD,SAAS,SAATA,MAAS,CAASx/D,OAAT,EAAkB;;AAE/Bg0D,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BC,qBAAiBA,eAFW;AAG5BjgC,iBAAaA,WAHe;AAI5BkgC,mBAAeA;AAJa,GAA9B;;AAOA;;;;AAIA,OAAKM,UAAL,GAAkBz0D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwC/hB,wBAA1D;;AAGA;;;;;AAKA,OAAK8sB,uBAAL,GAA+B,UAAS5rC,eAAT,EAA0B;AACvD,WAAO,2BAAWA,eAAX,KAA+B,4BAAYA,eAAZ,CAAtC;AACD,GAFD;;AAIA;;;;AAIA,OAAK6rC,gBAAL,GAAwB1/D,QAAQ2/D,eAAR,GACtB3/D,QAAQ2/D,eADc,GACI,KAAKF,uBADjC;;AAGA;;;;AAIA,OAAKG,sBAAL,GAA8B5/D,QAAQ6/D,qBAAR,GAC5B7/D,QAAQ6/D,qBADoB,GACInuB,iBADlC;;AAGA;;;;;AAKA,OAAKwqB,cAAL,GAAsB,IAAtB;;AAEA;;;;;AAKA,OAAK4D,eAAL,GAAuB,IAAvB;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkB,CAAC,CAAD,EAAI,CAAJ,CAAlB;;AAEA;;;;;;AAMA,OAAKC,sBAAL,GAA8B,KAA9B;;AAEA;;;;AAIA,OAAKC,SAAL,GAAiB,KAAjB;;AAEA;;;;;AAKA,OAAKC,MAAL,GAAc,IAAIC,eAAJ,EAAd;;AAEA;;;;AAIA,OAAKrE,eAAL,GAAuB97D,QAAQ+7D,cAAR,KAA2BliE,SAA3B,GACrBmG,QAAQ+7D,cADa,GACI,EAD3B;;AAGA;;;;AAIA,OAAKC,gBAAL,GAAwB,KAAxB;;AAEA;;;;;;AAMA,OAAKoE,gBAAL,GAAwB,KAAxB;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,EAArB;;AAEA;;;;;AAKA,OAAKpH,QAAL,GAAgB,IAAI/hE,gBAAJ,CAAgB;AAC9BE,YAAQ,IAAIC,gBAAJ,CAAiB;AACvB6hE,uBAAiB,KADM;AAEvBC,aAAO,CAAC,CAACn5D,QAAQm5D;AAFM,KAAjB,CADsB;AAK9B97C,WAAOrd,QAAQqd,KAAR,GAAgBrd,QAAQqd,KAAxB,GACL+7C,yBAN4B;AAO9BkD,0BAAsB,IAPQ;AAQ9BjD,4BAAwB;AARM,GAAhB,CAAhB;;AAWA;;;;;AAKA,OAAKiH,gBAAL,GAAwB;AACtB,aAAS,KAAKC,mBADQ;AAEtB,kBAAc,KAAKC,wBAFG;AAGtB,kBAAc,KAAKA,wBAHG;AAItB,eAAW,KAAKC,qBAJM;AAKtB,kBAAc,KAAKC,wBALG;AAMtB,uBAAmB,KAAKC,6BANF;AAOtB,oBAAgB,KAAKC,0BAPC;AAQtB,cAAU,KAAKC,oBARO;AAStB,0BAAsB,KAAKC;AATL,GAAxB;;AAaA;;;;AAIA,OAAKrO,OAAL,GAAe,IAAf;;AAEA,MAAInhC,iBAAJ;AACA,MAAItxB,QAAQ5I,MAAZ,EAAoB;AAClB,SAAKq7D,OAAL,GAAezyD,QAAQ5I,MAAvB;AACAk6B,eAAW,IAAI/S,oBAAJ,CAAe,KAAKk0C,OAAL,CAAasO,WAAb,EAAf,CAAX;AACA,wBAAO,KAAKtO,OAAZ,EAAqBuO,0BAAgBC,UAArC,EACE,KAAKC,gBADP,EACyB,IADzB;AAEA,wBAAO,KAAKzO,OAAZ,EAAqBuO,0BAAgBG,aAArC,EACE,KAAKC,mBADP,EAC4B,IAD5B;AAED,GAPD,MAOO;AACL9vC,eAAWtxB,QAAQsxB,QAAnB;AACD;AACD,MAAI,CAACA,QAAL,EAAe;AACb,UAAM,IAAItnB,KAAJ,CAAU,sDAAV,CAAN;AACD;;AAED;;;;AAIA,OAAKmtD,SAAL,GAAiB7lC,QAAjB;;AAEA,OAAK6lC,SAAL,CAAex+D,OAAf,CAAuB,KAAK0oE,WAAL,CAAiB9xD,IAAjB,CAAsB,IAAtB,CAAvB;AACA,sBAAO,KAAK4nD,SAAZ,EAAuB13C,8BAAoBC,GAA3C,EACE,KAAK4hD,iBADP,EAC0B,IAD1B;AAEA,sBAAO,KAAKnK,SAAZ,EAAuB13C,8BAAoBK,MAA3C,EACE,KAAKyhD,oBADP,EAC6B,IAD7B;;AAGA;;;;AAIA,OAAKC,iBAAL,GAAyB,IAAzB;AAED,CApLD;;AAsLA,qBAAShC,MAAT,EAAiBxL,iBAAjB;;AAGA;;;;;AAKA,IAAMyN,sBAAsB,CAA5B;;AAEA;;;;;AAKA,IAAMC,6BAA6B,CAAnC;;AAGA;;;;AAIAlC,OAAOrsD,SAAP,CAAiBkuD,WAAjB,GAA+B,UAAS35D,OAAT,EAAkB;AAC/C,MAAMuZ,WAAWvZ,QAAQ8Z,WAAR,EAAjB;AACA,MAAIP,YAAYA,SAAS5O,OAAT,MAAsB,KAAKiuD,gBAA3C,EAA6D;AAC3D,SAAKA,gBAAL,CAAsBr/C,SAAS5O,OAAT,EAAtB,EAA0CmC,IAA1C,CAA+C,IAA/C,EAAqD9M,OAArD,EAA8DuZ,QAA9D;AACD;AACD,MAAMxpB,MAAM,KAAKyxC,MAAL,EAAZ;AACA,MAAIzxC,OAAOA,IAAIi+B,UAAJ,EAAP,IAA2B,KAAK3B,SAAL,EAA/B,EAAiD;AAC/C,SAAK4tC,qBAAL,CAA2B,KAAK5B,UAAhC,EAA4CtoE,GAA5C;AACD;AACD,sBAAOiQ,OAAP,EAAgBqa,oBAAUC,MAA1B,EACE,KAAK4/C,oBADP,EAC6B,IAD7B;AAED,CAXD;;AAcA;;;;AAIApC,OAAOrsD,SAAP,CAAiB0uD,mBAAjB,GAAuC,UAASxyB,GAAT,EAAc;AACnD,MAAI,CAAC,KAAK4wB,SAAV,EAAqB;AACnB,SAAKA,SAAL,GAAiB,IAAjB;AACA,SAAKzgD,aAAL,CAAmB,IAAI8/C,WAAJ,CACjBH,gBAAgBC,WADC,EACY,KAAKjI,SADjB,EAC4B9nB,GAD5B,CAAnB;AAED;AACF,CAND;;AASA;;;;AAIAmwB,OAAOrsD,SAAP,CAAiB2uD,cAAjB,GAAkC,UAASp6D,OAAT,EAAkB;AAClD,OAAKq6D,yBAAL,CAA+Br6D,OAA/B;AACA;AACA;AACA,MAAI,KAAKw0D,cAAL,IAAuB,KAAK/E,SAAL,CAAel4C,SAAf,OAA+B,CAA1D,EAA6D;AAC3D,SAAKg6C,QAAL,CAAcjxB,SAAd,GAA0Bg6B,aAA1B,CAAwC,KAAK9F,cAA7C;AACA,SAAKA,cAAL,GAAsB,IAAtB;AACD;AACD,wBAASx0D,OAAT,EAAkBqa,oBAAUC,MAA5B,EACE,KAAK4/C,oBADP,EAC6B,IAD7B;AAED,CAVD;;AAaA;;;;AAIApC,OAAOrsD,SAAP,CAAiB4uD,yBAAjB,GAA6C,UAASr6D,OAAT,EAAkB;AAC7D,MAAMu6D,QAAQ,KAAK/B,MAAnB;AACA,MAAM,+DAAgEgC,gBAAgB,EAAtF;AACAD,QAAMtpE,OAAN;AACE;;;AAGA,YAAS41C,IAAT,EAAe;AACb,QAAI7mC,YAAY6mC,KAAK7mC,OAArB,EAA8B;AAC5Bw6D,oBAAcjnE,IAAd,CAAmBszC,IAAnB;AACD;AACF,GARH;AASA,OAAK,IAAIt1C,IAAIipE,cAAchpE,MAAd,GAAuB,CAApC,EAAuCD,KAAK,CAA5C,EAA+C,EAAEA,CAAjD,EAAoD;AAClDgpE,UAAMriD,MAAN,CAAasiD,cAAcjpE,CAAd,CAAb;AACD;AACF,CAfD;;AAkBA;;;AAGAumE,OAAOrsD,SAAP,CAAiBogD,SAAjB,GAA6B,UAASC,MAAT,EAAiB;AAC5C,MAAI,KAAK0I,cAAL,IAAuB,CAAC1I,MAA5B,EAAoC;AAClC,SAAKyF,QAAL,CAAcjxB,SAAd,GAA0Bg6B,aAA1B,CAAwC,KAAK9F,cAA7C;AACA,SAAKA,cAAL,GAAsB,IAAtB;AACD;AACDlI,oBAAmB7gD,SAAnB,CAA6BogD,SAA7B,CAAuC/+C,IAAvC,CAA4C,IAA5C,EAAkDg/C,MAAlD;AACD,CAND;;AASA;;;AAGAgM,OAAOrsD,SAAP,CAAiB4c,MAAjB,GAA0B,UAASt4B,GAAT,EAAc;AACtC,OAAKwhE,QAAL,CAAclpC,MAAd,CAAqBt4B,GAArB;AACAu8D,oBAAmB7gD,SAAnB,CAA6B4c,MAA7B,CAAoCvb,IAApC,CAAyC,IAAzC,EAA+C/c,GAA/C;AACD,CAHD;;AAMA;;;;AAIA+nE,OAAOrsD,SAAP,CAAiB+tD,gBAAjB,GAAoC,UAASl4C,KAAT,EAAgB;AAClD,MAAIA,MAAMthB,OAAV,EAAmB;AACjB,SAAKyvD,SAAL,CAAel8D,IAAf,CAAoB+tB,MAAMthB,OAA1B;AACD;AACF,CAJD;;AAOA;;;;AAIA83D,OAAOrsD,SAAP,CAAiBiuD,mBAAjB,GAAuC,UAASp4C,KAAT,EAAgB;AACrD,MAAIA,MAAMthB,OAAV,EAAmB;AACjB,SAAKyvD,SAAL,CAAev3C,MAAf,CAAsBoJ,MAAMthB,OAA5B;AACD;AACF,CAJD;;AAOA;;;;AAIA83D,OAAOrsD,SAAP,CAAiBmuD,iBAAjB,GAAqC,UAASjyB,GAAT,EAAc;AACjD,OAAKgyB,WAAL,EAAiB,gCAAkChyB,IAAI/wB,OAAvD;AACD,CAFD;;AAKA;;;;AAIAkhD,OAAOrsD,SAAP,CAAiByuD,oBAAjB,GAAwC,UAASvyB,GAAT,EAAc;AACpD,MAAI,CAAC,KAAK+wB,gBAAV,EAA4B;AAC1B,QAAM14D,UAAU,gCAAkC2nC,IAAI13C,MAAtD;AACA,SAAKmqE,cAAL,CAAoBp6D,OAApB;AACA,SAAK25D,WAAL,CAAiB35D,OAAjB;AACD;AACF,CAND;;AASA;;;;AAIA83D,OAAOrsD,SAAP,CAAiBouD,oBAAjB,GAAwC,UAASlyB,GAAT,EAAc;AACpD,MAAM3nC,UAAU,gCAAkC2nC,IAAI/wB,OAAtD;AACA,OAAKwjD,cAAL,CAAoBp6D,OAApB;AACD,CAHD;;AAMA;;;;;AAKA83D,OAAOrsD,SAAP,CAAiBotD,mBAAjB,GAAuC,UAAS74D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACjE,MAAM4zB,cAAc5zB,SAAS26B,cAAT,EAApB;AACA,MAAMumB,cAAc,uDAAyD;AAC3Ez6D,aAASA,OADkE;AAE3EuZ,cAAUA,QAFiE;AAG3E8qB,aAAS,CAAC8I,WAAD,EAAcA,WAAd;AAHkE,GAA7E;AAKA,OAAKqrB,MAAL,CAAYkC,MAAZ,CAAmBnhD,SAAS0B,SAAT,EAAnB,EAAyCw/C,WAAzC;AACD,CARD;;AAWA;;;;;AAKA3C,OAAOrsD,SAAP,CAAiButD,wBAAjB,GAA4C,UAASh5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACtE,MAAM2iC,SAAS3iC,SAAS26B,cAAT,EAAf;AACA,OAAK,IAAI3iD,IAAI,CAAR,EAAWwkB,KAAKmmC,OAAO1qD,MAA5B,EAAoCD,IAAIwkB,EAAxC,EAA4C,EAAExkB,CAA9C,EAAiD;AAC/C,QAAM47C,cAAc+O,OAAO3qD,CAAP,CAApB;AACA,QAAMkpE,cAAc,uDAAyD;AAC3Ez6D,eAASA,OADkE;AAE3EuZ,gBAAUA,QAFiE;AAG3EohD,aAAO,CAACppE,CAAD,CAHoE;AAI3EqE,aAAOrE,CAJoE;AAK3E8yC,eAAS,CAAC8I,WAAD,EAAcA,WAAd;AALkE,KAA7E;AAOA,SAAKqrB,MAAL,CAAYkC,MAAZ,CAAmBnhD,SAAS0B,SAAT,EAAnB,EAAyCw/C,WAAzC;AACD;AACF,CAbD;;AAgBA;;;;;AAKA3C,OAAOrsD,SAAP,CAAiBqtD,wBAAjB,GAA4C,UAAS94D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACtE,MAAM4zB,cAAc5zB,SAAS26B,cAAT,EAApB;AACA,OAAK,IAAI3iD,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAZ,GAAqB,CAA1C,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxD,QAAM8yC,UAAU8I,YAAY/7C,KAAZ,CAAkBG,CAAlB,EAAqBA,IAAI,CAAzB,CAAhB;AACA,QAAMkpE,cAAc,uDAAyD;AAC3Ez6D,eAASA,OADkE;AAE3EuZ,gBAAUA,QAFiE;AAG3E3jB,aAAOrE,CAHoE;AAI3E8yC,eAASA;AAJkE,KAA7E;AAMA,SAAKm0B,MAAL,CAAYkC,MAAZ,CAAmB,4BAAer2B,OAAf,CAAnB,EAA4Co2B,WAA5C;AACD;AACF,CAZD;;AAeA;;;;;AAKA3C,OAAOrsD,SAAP,CAAiBwtD,6BAAjB,GAAiD,UAASj5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AAC3E,MAAMqhD,QAAQrhD,SAAS26B,cAAT,EAAd;AACA,OAAK,IAAIz5C,IAAI,CAAR,EAAW27B,KAAKwkC,MAAMppE,MAA3B,EAAmCiJ,IAAI27B,EAAvC,EAA2C,EAAE37B,CAA7C,EAAgD;AAC9C,QAAM0yC,cAAcytB,MAAMngE,CAAN,CAApB;AACA,SAAK,IAAIlJ,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAZ,GAAqB,CAA1C,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxD,UAAM8yC,UAAU8I,YAAY/7C,KAAZ,CAAkBG,CAAlB,EAAqBA,IAAI,CAAzB,CAAhB;AACA,UAAMkpE,cAAc,uDAAyD;AAC3Ez6D,iBAASA,OADkE;AAE3EuZ,kBAAUA,QAFiE;AAG3EohD,eAAO,CAAClgE,CAAD,CAHoE;AAI3E7E,eAAOrE,CAJoE;AAK3E8yC,iBAASA;AALkE,OAA7E;AAOA,WAAKm0B,MAAL,CAAYkC,MAAZ,CAAmB,4BAAer2B,OAAf,CAAnB,EAA4Co2B,WAA5C;AACD;AACF;AACF,CAhBD;;AAmBA;;;;;AAKA3C,OAAOrsD,SAAP,CAAiBstD,qBAAjB,GAAyC,UAAS/4D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACnE,MAAM00B,QAAQ10B,SAAS26B,cAAT,EAAd;AACA,OAAK,IAAIz5C,IAAI,CAAR,EAAW27B,KAAK6X,MAAMz8C,MAA3B,EAAmCiJ,IAAI27B,EAAvC,EAA2C,EAAE37B,CAA7C,EAAgD;AAC9C,QAAM0yC,cAAcc,MAAMxzC,CAAN,CAApB;AACA,SAAK,IAAIlJ,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAZ,GAAqB,CAA1C,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxD,UAAM8yC,UAAU8I,YAAY/7C,KAAZ,CAAkBG,CAAlB,EAAqBA,IAAI,CAAzB,CAAhB;AACA,UAAMkpE,cAAc,uDAAyD;AAC3Ez6D,iBAASA,OADkE;AAE3EuZ,kBAAUA,QAFiE;AAG3EohD,eAAO,CAAClgE,CAAD,CAHoE;AAI3E7E,eAAOrE,CAJoE;AAK3E8yC,iBAASA;AALkE,OAA7E;AAOA,WAAKm0B,MAAL,CAAYkC,MAAZ,CAAmB,4BAAer2B,OAAf,CAAnB,EAA4Co2B,WAA5C;AACD;AACF;AACF,CAhBD;;AAmBA;;;;;AAKA3C,OAAOrsD,SAAP,CAAiBytD,0BAAjB,GAA8C,UAASl5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACxE,MAAMkkC,WAAWlkC,SAAS26B,cAAT,EAAjB;AACA,OAAK,IAAInjD,IAAI,CAAR,EAAW8pE,KAAKpd,SAASjsD,MAA9B,EAAsCT,IAAI8pE,EAA1C,EAA8C,EAAE9pE,CAAhD,EAAmD;AACjD,QAAMk9C,QAAQwP,SAAS1sD,CAAT,CAAd;AACA,SAAK,IAAI0J,IAAI,CAAR,EAAW27B,KAAK6X,MAAMz8C,MAA3B,EAAmCiJ,IAAI27B,EAAvC,EAA2C,EAAE37B,CAA7C,EAAgD;AAC9C,UAAM0yC,cAAcc,MAAMxzC,CAAN,CAApB;AACA,WAAK,IAAIlJ,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAZ,GAAqB,CAA1C,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxD,YAAM8yC,UAAU8I,YAAY/7C,KAAZ,CAAkBG,CAAlB,EAAqBA,IAAI,CAAzB,CAAhB;AACA,YAAMkpE,cAAc,uDAAyD;AAC3Ez6D,mBAASA,OADkE;AAE3EuZ,oBAAUA,QAFiE;AAG3EohD,iBAAO,CAAClgE,CAAD,EAAI1J,CAAJ,CAHoE;AAI3E6E,iBAAOrE,CAJoE;AAK3E8yC,mBAASA;AALkE,SAA7E;AAOA,aAAKm0B,MAAL,CAAYkC,MAAZ,CAAmB,4BAAer2B,OAAf,CAAnB,EAA4Co2B,WAA5C;AACD;AACF;AACF;AACF,CAnBD;;AAsBA;;;;;;;;;;;AAWA3C,OAAOrsD,SAAP,CAAiB0tD,oBAAjB,GAAwC,UAASn5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AAClE,MAAM4zB,cAAc5zB,SAASib,SAAT,EAApB;AACA,MAAMsmC,oBAAoB,uDAAyD;AACjF96D,aAASA,OADwE;AAEjFuZ,cAAUA,QAFuE;AAGjF3jB,WAAOmkE,mBAH0E;AAIjF11B,aAAS,CAAC8I,WAAD,EAAcA,WAAd;AAJwE,GAAnF;AAMA,MAAM4tB,2BAA2B,uDAAyD;AACxF/6D,aAASA,OAD+E;AAExFuZ,cAAUA,QAF8E;AAGxF3jB,WAAOokE,0BAHiF;AAIxF31B,aAAS,CAAC8I,WAAD,EAAcA,WAAd;AAJ+E,GAA1F;AAMA,MAAM6tB,kBAAkB,CAACF,iBAAD,EAAoBC,wBAApB,CAAxB;AACAD,oBAAkBE,eAAlB,GAAoCD,yBAAyBC,eAAzB,GAA2CA,eAA/E;AACA,OAAKxC,MAAL,CAAYkC,MAAZ,CAAmB,0CAA6BvtB,WAA7B,CAAnB,EAA8D2tB,iBAA9D;AACA,OAAKtC,MAAL,CAAYkC,MAAZ,CAAmBnhD,SAAS0B,SAAT,EAAnB,EAAyC8/C,wBAAzC;AACD,CAlBD;;AAqBA;;;;;AAKAjD,OAAOrsD,SAAP,CAAiB2tD,gCAAjB,GAAoD,UAASp5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AAC9E,MAAMi6B,aAAaj6B,SAAS06B,kBAAT,EAAnB;AACA,OAAK,IAAI1iD,IAAI,CAAb,EAAgBA,IAAIiiD,WAAWhiD,MAA/B,EAAuC,EAAED,CAAzC,EAA4C;AAC1C,SAAKqnE,gBAAL,CAAsBplB,WAAWjiD,CAAX,EAAcoZ,OAAd,EAAtB,EAA+CmC,IAA/C,CAAoD,IAApD,EAA0D9M,OAA1D,EAAmEwzC,WAAWjiD,CAAX,CAAnE;AACD;AACF,CALD;;AAQA;;;;;AAKAumE,OAAOrsD,SAAP,CAAiBwvD,4BAAjB,GAAgD,UAAS9tB,WAAT,EAAsB;AACpE,MAAIspB,gBAAgB,KAAKjC,cAAzB;AACA,MAAI,CAACiC,aAAL,EAAoB;AAClBA,oBAAgB,IAAI39C,iBAAJ,CAAY,IAAI46B,eAAJ,CAAUvG,WAAV,CAAZ,CAAhB;AACA,SAAKqnB,cAAL,GAAsBiC,aAAtB;AACA,SAAKlF,QAAL,CAAcjxB,SAAd,GAA0BszB,UAA1B,CAAqC6C,aAArC;AACD,GAJD,MAIO;AACL,QAAMl9C,WAAW,mCAAqCk9C,cAAc38C,WAAd,EAAtD;AACAP,aAAS+8B,cAAT,CAAwBnJ,WAAxB;AACD;AACD,SAAOspB,aAAP;AACD,CAXD;;AAcA;;;;;AAKA,SAASyE,cAAT,CAAwBzhE,CAAxB,EAA2BD,CAA3B,EAA8B;AAC5B,SAAOC,EAAE7D,KAAF,GAAU4D,EAAE5D,KAAnB;AACD;;AAGD;;;;;AAKA,SAAS22D,eAAT,CAAyB5kB,GAAzB,EAA8B;AAC5B,MAAI,CAAC,KAAKolB,UAAL,CAAgBplB,GAAhB,CAAL,EAA2B;AACzB,WAAO,KAAP;AACD;AACD,OAAKsyB,qBAAL,CAA2BtyB,IAAI7oB,KAA/B,EAAsC6oB,IAAI53C,GAA1C;AACA,MAAMylE,kBAAkB7tB,IAAI53C,GAAJ,CAAQkvB,sBAAR,CAA+B0oB,IAAI7oB,KAAnC,CAAxB;AACA,OAAK65C,aAAL,CAAmBnnE,MAAnB,GAA4B,CAA5B;AACA,OAAK+mE,SAAL,GAAiB,KAAjB;AACA,MAAM9B,gBAAgB,KAAKjC,cAA3B;AACA,MAAIiC,aAAJ,EAAmB;AACjB,QAAM0E,iBAAiB,EAAvB;AACA,QAAM5hD,WAAW,mCAAqCk9C,cAAc38C,WAAd,EAAtD;AACA,QAAMm7C,SAAS17C,SAAS26B,cAAT,EAAf;AACA,QAAMknB,eAAe,4BAAe,CAACnG,MAAD,CAAf,CAArB;AACA,QAAMoG,qBAAqB,KAAK7C,MAAL,CAAY8C,WAAZ,CAAwBF,YAAxB,CAA3B;AACA,QAAMG,oBAAoB,EAA1B;AACAF,uBAAmBl8D,IAAnB,CAAwB+7D,cAAxB;AACA,SAAK,IAAI3pE,IAAI,CAAR,EAAWwkB,KAAKslD,mBAAmB7pE,MAAxC,EAAgDD,IAAIwkB,EAApD,EAAwD,EAAExkB,CAA1D,EAA6D;AAC3D,UAAMiqE,mBAAmBH,mBAAmB9pE,CAAnB,CAAzB;AACA,UAAM8yC,UAAUm3B,iBAAiBn3B,OAAjC;AACA,UAAIo3B,MAAM,mBAAOD,iBAAiBx7D,OAAxB,CAAV;AACA,UAAM26D,QAAQa,iBAAiBb,KAA/B;AACA,UAAIA,KAAJ,EAAW;AACTc,eAAO,MAAMd,MAAMzmE,IAAN,CAAW,GAAX,CAAb,CADS,CACqB;AAC/B;AACD,UAAI,CAACqnE,kBAAkBE,GAAlB,CAAL,EAA6B;AAC3BF,0BAAkBE,GAAlB,IAAyB,IAAI7oE,KAAJ,CAAU,CAAV,CAAzB;AACD;AACD,UAAI4oE,iBAAiBjiD,QAAjB,CAA0B5O,OAA1B,OAAwCwuB,uBAAaC,MAArD,IACJoiC,iBAAiB5lE,KAAjB,KAA2BokE,0BAD3B,EACuD;;AAErD,YAAM0B,gBAAgBC,qBAAqBnG,eAArB,EAAsCgG,gBAAtC,CAAtB;AACA,YAAI,wBAAiBE,aAAjB,EAAgCzG,MAAhC,KAA2C,CAACsG,kBAAkBE,GAAlB,EAAuB,CAAvB,CAAhD,EAA2E;AACzE,eAAK9C,aAAL,CAAmBplE,IAAnB,CAAwB,CAACioE,gBAAD,EAAmB,CAAnB,CAAxB;AACAD,4BAAkBE,GAAlB,EAAuB,CAAvB,IAA4BD,gBAA5B;AACD;AACF,OARD,MAQO,IAAI,wBAAiBn3B,QAAQ,CAAR,CAAjB,EAA6B4wB,MAA7B,KACP,CAACsG,kBAAkBE,GAAlB,EAAuB,CAAvB,CADE,EACyB;AAC9B,aAAK9C,aAAL,CAAmBplE,IAAnB,CAAwB,CAACioE,gBAAD,EAAmB,CAAnB,CAAxB;AACAD,0BAAkBE,GAAlB,EAAuB,CAAvB,IAA4BD,gBAA5B;AACD,OAJM,MAIA,IAAI,wBAAiBn3B,QAAQ,CAAR,CAAjB,EAA6B4wB,MAA7B,KACP,CAACsG,kBAAkBE,GAAlB,EAAuB,CAAvB,CADE,EACyB;;AAE9B;AACA,YAAI,CAACD,iBAAiBjiD,QAAjB,CAA0B5O,OAA1B,OACDwuB,uBAAakgB,WADZ,IAEDmiB,iBAAiBjiD,QAAjB,CAA0B5O,OAA1B,OACAwuB,uBAAasgB,iBAHb,KAIA8hB,kBAAkBE,GAAlB,EAAuB,CAAvB,CAJA,IAKAF,kBAAkBE,GAAlB,EAAuB,CAAvB,EAA0B7lE,KAA1B,KAAoC,CALxC,EAK2C;AACzC;AACD;;AAED,aAAK+iE,aAAL,CAAmBplE,IAAnB,CAAwB,CAACioE,gBAAD,EAAmB,CAAnB,CAAxB;AACAD,0BAAkBE,GAAlB,EAAuB,CAAvB,IAA4BD,gBAA5B;AACD,OAfM,MAeA,IAAI,KAAKtD,sBAAL,CAA4BvwB,GAA5B,KAAoC,mBAAOtD,OAAP,KAAmB,KAAK+zB,eAA5D,IACN,CAACmD,kBAAkBE,GAAlB,EAAuB,CAAvB,CAAD,IAA8B,CAACF,kBAAkBE,GAAlB,EAAuB,CAAvB,CAD7B,EACyD;AAC9DN,uBAAe5nE,IAAf,CAAoB,CAACioE,gBAAD,EAAmBvG,MAAnB,CAApB;AACD;AACF;AACD,QAAIkG,eAAe3pE,MAAnB,EAA2B;AACzB,WAAK2oE,mBAAL,CAAyBxyB,GAAzB;AACD;AACD,SAAK,IAAIltC,IAAI0gE,eAAe3pE,MAAf,GAAwB,CAArC,EAAwCiJ,KAAK,CAA7C,EAAgD,EAAEA,CAAlD,EAAqD;AACnD,WAAKmhE,aAAL,CAAmB7nE,KAAnB,CAAyB,IAAzB,EAA+BonE,eAAe1gE,CAAf,CAA/B;AACD;AACF;AACD,SAAO,CAAC,CAAC,KAAK+5D,cAAd;AACD;;AAGD;;;;AAIA,SAAShI,eAAT,CAAyB7kB,GAAzB,EAA8B;AAC5B,OAAK2wB,sBAAL,GAA8B,KAA9B;AACA,OAAK6B,mBAAL,CAAyBxyB,GAAzB;;AAEA,MAAMstB,SAASttB,IAAI3oB,UAAnB;AACA,OAAK,IAAIztB,IAAI,CAAR,EAAWwkB,KAAK,KAAK4iD,aAAL,CAAmBnnE,MAAxC,EAAgDD,IAAIwkB,EAApD,EAAwD,EAAExkB,CAA1D,EAA6D;AAC3D,QAAMsqE,cAAc,KAAKlD,aAAL,CAAmBpnE,CAAnB,CAApB;AACA,QAAMkpE,cAAcoB,YAAY,CAAZ,CAApB;AACA,QAAMlB,QAAQF,YAAYE,KAA1B;AACA,QAAMphD,WAAWkhD,YAAYlhD,QAA7B;AACA,QAAI4zB,oBAAJ;AACA,QAAM9I,UAAUo2B,YAAYp2B,OAA5B;AACA,QAAMzuC,QAAQimE,YAAY,CAAZ,CAAd;;AAEA,WAAO5G,OAAOzjE,MAAP,GAAgB+nB,SAASygB,SAAT,EAAvB,EAA6C;AAC3Ci7B,aAAO1hE,IAAP,CAAY8wC,QAAQzuC,KAAR,EAAeq/D,OAAOzjE,MAAtB,CAAZ;AACD;;AAED,YAAQ+nB,SAAS5O,OAAT,EAAR;AACE,WAAKwuB,uBAAaigB,KAAlB;AACEjM,sBAAc8nB,MAAd;AACA5wB,gBAAQ,CAAR,IAAaA,QAAQ,CAAR,IAAa4wB,MAA1B;AACA;AACF,WAAK97B,uBAAaqgB,WAAlB;AACErM,sBAAc5zB,SAAS26B,cAAT,EAAd;AACA/G,oBAAYstB,YAAY7kE,KAAxB,IAAiCq/D,MAAjC;AACA5wB,gBAAQ,CAAR,IAAaA,QAAQ,CAAR,IAAa4wB,MAA1B;AACA;AACF,WAAK97B,uBAAakgB,WAAlB;AACElM,sBAAc5zB,SAAS26B,cAAT,EAAd;AACA/G,oBAAYstB,YAAY7kE,KAAZ,GAAoBA,KAAhC,IAAyCq/D,MAAzC;AACA5wB,gBAAQzuC,KAAR,IAAiBq/D,MAAjB;AACA;AACF,WAAK97B,uBAAasgB,iBAAlB;AACEtM,sBAAc5zB,SAAS26B,cAAT,EAAd;AACA/G,oBAAYwtB,MAAM,CAAN,CAAZ,EAAsBF,YAAY7kE,KAAZ,GAAoBA,KAA1C,IAAmDq/D,MAAnD;AACA5wB,gBAAQzuC,KAAR,IAAiBq/D,MAAjB;AACA;AACF,WAAK97B,uBAAaogB,OAAlB;AACEpM,sBAAc5zB,SAAS26B,cAAT,EAAd;AACA/G,oBAAYwtB,MAAM,CAAN,CAAZ,EAAsBF,YAAY7kE,KAAZ,GAAoBA,KAA1C,IAAmDq/D,MAAnD;AACA5wB,gBAAQzuC,KAAR,IAAiBq/D,MAAjB;AACA;AACF,WAAK97B,uBAAaugB,aAAlB;AACEvM,sBAAc5zB,SAAS26B,cAAT,EAAd;AACA/G,oBAAYwtB,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCF,YAAY7kE,KAAZ,GAAoBA,KAApD,IAA6Dq/D,MAA7D;AACA5wB,gBAAQzuC,KAAR,IAAiBq/D,MAAjB;AACA;AACF,WAAK97B,uBAAaC,MAAlB;AACEiL,gBAAQ,CAAR,IAAaA,QAAQ,CAAR,IAAa4wB,MAA1B;AACA,YAAIwF,YAAY7kE,KAAZ,KAAsBmkE,mBAA1B,EAA+C;AAC7C,eAAKrB,gBAAL,GAAwB,IAAxB;AACAn/C,mBAASsb,SAAT,CAAmBogC,MAAnB;AACA,eAAKyD,gBAAL,GAAwB,KAAxB;AACD,SAJD,MAIO;AAAE;AACP,eAAKA,gBAAL,GAAwB,IAAxB;AACAn/C,mBAASi9B,SAAT,CAAmB,0BAAmBj9B,SAASib,SAAT,EAAnB,EAAyCygC,MAAzC,CAAnB;AACA,eAAKyD,gBAAL,GAAwB,KAAxB;AACD;AACD;AACF;AACE;AA3CJ;;AA8CA,QAAIvrB,WAAJ,EAAiB;AACf,WAAK2uB,uBAAL,CAA6BviD,QAA7B,EAAuC4zB,WAAvC;AACD;AACF;AACD,OAAK8tB,4BAAL,CAAkChG,MAAlC;AACD;;AAGD;;;;;AAKA,SAASxI,aAAT,CAAuB9kB,GAAvB,EAA4B;AAC1B,OAAK,IAAIp2C,IAAI,KAAKonE,aAAL,CAAmBnnE,MAAnB,GAA4B,CAAzC,EAA4CD,KAAK,CAAjD,EAAoD,EAAEA,CAAtD,EAAyD;AACvD,QAAMkpE,cAAc,KAAK9B,aAAL,CAAmBpnE,CAAnB,EAAsB,CAAtB,CAApB;AACA,QAAMgoB,WAAWkhD,YAAYlhD,QAA7B;AACA,QAAIA,SAAS5O,OAAT,OAAuBwuB,uBAAaC,MAAxC,EAAgD;AAC9C;AACA,UAAM+T,cAAc5zB,SAASib,SAAT,EAApB;AACA,UAAMsmC,oBAAoBL,YAAYO,eAAZ,CAA4B,CAA5B,CAA1B;AACA,UAAMD,2BAA2BN,YAAYO,eAAZ,CAA4B,CAA5B,CAAjC;AACAF,wBAAkBz2B,OAAlB,CAA0B,CAA1B,IAA+By2B,kBAAkBz2B,OAAlB,CAA0B,CAA1B,IAA+B8I,WAA9D;AACA4tB,+BAAyB12B,OAAzB,CAAiC,CAAjC,IAAsC02B,yBAAyB12B,OAAzB,CAAiC,CAAjC,IAAsC8I,WAA5E;AACA,WAAKqrB,MAAL,CAAYz7C,MAAZ,CAAmB,0CAA6BowB,WAA7B,CAAnB,EAA8D2tB,iBAA9D;AACA,WAAKtC,MAAL,CAAYz7C,MAAZ,CAAmBxD,SAAS0B,SAAT,EAAnB,EAAyC8/C,wBAAzC;AACD,KATD,MASO;AACL,WAAKvC,MAAL,CAAYz7C,MAAZ,CAAmB,4BAAe09C,YAAYp2B,OAA3B,CAAnB,EAAwDo2B,WAAxD;AACD;AACF;AACD,MAAI,KAAKlC,SAAT,EAAoB;AAClB,SAAKzgD,aAAL,CAAmB,IAAI8/C,WAAJ,CAAgBH,gBAAgBE,SAAhC,EAA2C,KAAKlI,SAAhD,EAA2D9nB,GAA3D,CAAnB;AACA,SAAK4wB,SAAL,GAAiB,KAAjB;AACD;AACD,SAAO,KAAP;AACD;;AAGD;;;;;;;AAOA,SAAShsC,WAAT,CAAqBJ,eAArB,EAAsC;AACpC,MAAI,EAAEA,2BAA2BrL,gCAA7B,CAAJ,EAA0D;AACxD,WAAO,IAAP;AACD;AACD,OAAKg5C,iBAAL,GAAyB3tC,eAAzB;;AAEA,MAAI4vC,gBAAJ;AACA,MAAI,CAAC5vC,gBAAgBp8B,GAAhB,CAAoBs7B,OAApB,GAA8B2K,cAA9B,EAAD,IACA7J,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBN,WAD5C,IAEA,CAAC,KAAKstC,sBAFV,EAEkC;AAChC,SAAK/rC,kBAAL,CAAwBmK,eAAxB;AACD;AACD,MAAI,KAAKqoC,cAAL,IAAuB,KAAKwD,gBAAL,CAAsB7rC,eAAtB,CAA3B,EAAmE;AACjE,QAAIA,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBK,WAA5C,IAA2D,CAAC,KAAKk3C,sBAArE,EAA6F;AAC3FyD,gBAAU,KAAKC,WAAL,EAAV;AACD,KAFD,MAEO;AACLD,gBAAU,IAAV;AACD;AACF;;AAED,MAAI5vC,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBK,WAAhD,EAA6D;AAC3D,SAAKk3C,sBAAL,GAA8B,KAA9B;AACD;;AAED,SAAOhG,qBAAmBxlD,IAAnB,CAAwB,IAAxB,EAA8Bqf,eAA9B,KAAkD,CAAC4vC,OAA1D;AACD;;AAGD;;;;AAIAjE,OAAOrsD,SAAP,CAAiBuW,kBAAjB,GAAsC,UAAS2lB,GAAT,EAAc;AAClD,OAAK0wB,UAAL,GAAkB1wB,IAAI7oB,KAAtB;AACA,OAAKm7C,qBAAL,CAA2BtyB,IAAI7oB,KAA/B,EAAsC6oB,IAAI53C,GAA1C;AACD,CAHD;;AAMA;;;;;AAKA+nE,OAAOrsD,SAAP,CAAiBwuD,qBAAjB,GAAyC,UAASn7C,KAAT,EAAgB/uB,GAAhB,EAAqB;AAC5D,MAAMylE,kBAAkBzlE,IAAIkvB,sBAAJ,CAA2BH,KAA3B,CAAxB;AACA,MAAMg3C,iBAAiB,SAAjBA,cAAiB,CAASr8D,CAAT,EAAYD,CAAZ,EAAe;AACpC,WAAOyiE,kCAAkCzG,eAAlC,EAAmD/7D,CAAnD,IACHwiE,kCAAkCzG,eAAlC,EAAmDh8D,CAAnD,CADJ;AAED,GAHD;;AAKA,MAAM0iE,MAAM,oBAAO,0CAA6B1G,eAA7B,CAAP,EACVzlE,IAAIs7B,OAAJ,GAAcjQ,aAAd,KAAgC,KAAKg5C,eAD3B,CAAZ;;AAGA,MAAMmG,QAAQ,KAAK/B,MAAnB;AACA,MAAM2D,QAAQ5B,MAAMe,WAAN,CAAkBY,GAAlB,CAAd;AACA,MAAIC,MAAM3qE,MAAN,GAAe,CAAnB,EAAsB;AACpB2qE,UAAMh9D,IAAN,CAAW22D,cAAX;AACA,QAAMjvB,OAAOs1B,MAAM,CAAN,CAAb;AACA,QAAMnG,iBAAiBnvB,KAAKxC,OAA5B;AACA,QAAI4wB,SAAS0G,qBAAqBnG,eAArB,EAAsC3uB,IAAtC,CAAb;AACA,QAAMovB,cAAclmE,IAAIk7B,sBAAJ,CAA2BgqC,MAA3B,CAApB;AACA,QAAIqB,OAAO,0BAAmBx3C,KAAnB,EAA0Bm3C,WAA1B,CAAX;AACA,QAAIK,QAAQ,KAAKlC,eAAjB,EAAkC;AAChC,UAAMgI,iBAAiB,EAAvB;;AAEA,UAAIv1B,KAAKttB,QAAL,CAAc5O,OAAd,OAA4BwuB,uBAAaC,MAAzC,IACJyN,KAAKjxC,KAAL,KAAeokE,0BADf,EAC2C;;AAEzC,aAAK1F,gBAAL,GAAwB,IAAxB;AACA,aAAK2G,4BAAL,CAAkChG,MAAlC;AACD,OALD,MAKO;AACL,YAAMiB,SAASnmE,IAAIk7B,sBAAJ,CAA2B+qC,eAAe,CAAf,CAA3B,CAAf;AACA,YAAMG,SAASpmE,IAAIk7B,sBAAJ,CAA2B+qC,eAAe,CAAf,CAA3B,CAAf;AACA,YAAMI,eAAe,iCAA0BH,WAA1B,EAAuCC,MAAvC,CAArB;AACA,YAAMG,eAAe,iCAA0BJ,WAA1B,EAAuCE,MAAvC,CAArB;AACAG,eAAOhhE,KAAKsG,IAAL,CAAUtG,KAAKiH,GAAL,CAAS65D,YAAT,EAAuBC,YAAvB,CAAV,CAAP;AACA,aAAK/B,gBAAL,GAAwBgC,QAAQ,KAAKlC,eAArC;AACA,YAAI,KAAKE,gBAAT,EAA2B;AACzBW,mBAASmB,eAAeC,YAAf,GAA8BL,eAAe,CAAf,CAA9B,GAAkDA,eAAe,CAAf,CAA3D;AACD;AACD,aAAKiF,4BAAL,CAAkChG,MAAlC;AACA,aAAK,IAAI1jE,IAAI,CAAR,EAAWwkB,KAAKomD,MAAM3qE,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,cAAM8yC,UAAU83B,MAAM5qE,CAAN,EAAS8yC,OAAzB;AACA,cAAK,wBAAiB2xB,eAAe,CAAf,CAAjB,EAAoC3xB,QAAQ,CAAR,CAApC,KACD,wBAAiB2xB,eAAe,CAAf,CAAjB,EAAoC3xB,QAAQ,CAAR,CAApC,CADC,IAEA,wBAAiB2xB,eAAe,CAAf,CAAjB,EAAoC3xB,QAAQ,CAAR,CAApC,KACD,wBAAiB2xB,eAAe,CAAf,CAAjB,EAAoC3xB,QAAQ,CAAR,CAApC,CAHJ,EAGuD;AACrD+3B,2BAAe,mBAAO/3B,OAAP,CAAf,IAAkC,IAAlC;AACD,WALD,MAKO;AACL;AACD;AACF;AACF;;AAED+3B,qBAAe,mBAAOpG,cAAP,CAAf,IAAyC,IAAzC;AACA,WAAKoC,eAAL,GAAuBgE,cAAvB;AACA;AACD;AACF;AACD,MAAI,KAAK5H,cAAT,EAAyB;AACvB,SAAKjD,QAAL,CAAcjxB,SAAd,GAA0Bg6B,aAA1B,CAAwC,KAAK9F,cAA7C;AACA,SAAKA,cAAL,GAAsB,IAAtB;AACD;AACF,CA5DD;;AA+DA;;;;;;;;;AASA,SAASyH,iCAAT,CAA2CI,gBAA3C,EAA6D5B,WAA7D,EAA0E;AACxE,MAAMlhD,WAAWkhD,YAAYlhD,QAA7B;;AAEA,MAAIA,SAAS5O,OAAT,OAAuBwuB,uBAAaC,MAAxC,EAAgD;AAC9C,QAAMkjC,iBAAiB,oCAAsC/iD,QAA7D;;AAEA,QAAIkhD,YAAY7kE,KAAZ,KAAsBokE,0BAA1B,EAAsD;AACpD,UAAMuC,0BACA,iCAA0BD,eAAe9nC,SAAf,EAA1B,EAAsD6nC,gBAAtD,CADN;AAEA,UAAMG,0BACAlnE,KAAKsG,IAAL,CAAU2gE,uBAAV,IAAqCD,eAAel4B,SAAf,EAD3C;AAEA,aAAOo4B,0BAA0BA,uBAAjC;AACD;AACF;AACD,SAAO,0CAAyBH,gBAAzB,EAA2C5B,YAAYp2B,OAAvD,CAAP;AACD;;AAED;;;;;;;;;AASA,SAASs3B,oBAAT,CAA8BU,gBAA9B,EAAgD5B,WAAhD,EAA6D;AAC3D,MAAMlhD,WAAWkhD,YAAYlhD,QAA7B;;AAEA,MAAIA,SAAS5O,OAAT,OAAuBwuB,uBAAaC,MAApC,IACJqhC,YAAY7kE,KAAZ,KAAsBokE,0BADtB,EACkD;AAChD,WAAOzgD,SAASw9B,eAAT,CAAyBslB,gBAAzB,CAAP;AACD;AACD,SAAO,kCAAiBA,gBAAjB,EAAmC5B,YAAYp2B,OAA/C,CAAP;AACD;;AAGD;;;;;AAKAyzB,OAAOrsD,SAAP,CAAiBmwD,aAAjB,GAAiC,UAASnB,WAAT,EAAsBxF,MAAtB,EAA8B;AAC7D,MAAM5wB,UAAUo2B,YAAYp2B,OAA5B;AACA,MAAMrkC,UAAUy6D,YAAYz6D,OAA5B;AACA,MAAMuZ,WAAWkhD,YAAYlhD,QAA7B;AACA,MAAMohD,QAAQF,YAAYE,KAA1B;AACA,MAAM/kE,QAAQ,qBAAuB6kE,YAAY7kE,KAAjD;AACA,MAAIu3C,oBAAJ;;AAEA,SAAO8nB,OAAOzjE,MAAP,GAAgB+nB,SAASygB,SAAT,EAAvB,EAA6C;AAC3Ci7B,WAAO1hE,IAAP,CAAY,CAAZ;AACD;;AAED,UAAQgmB,SAAS5O,OAAT,EAAR;AACE,SAAKwuB,uBAAasgB,iBAAlB;AACEtM,oBAAc5zB,SAAS26B,cAAT,EAAd;AACA/G,kBAAYwtB,MAAM,CAAN,CAAZ,EAAsB9iD,MAAtB,CAA6BjiB,QAAQ,CAArC,EAAwC,CAAxC,EAA2Cq/D,MAA3C;AACA;AACF,SAAK97B,uBAAaogB,OAAlB;AACEpM,oBAAc5zB,SAAS26B,cAAT,EAAd;AACA/G,kBAAYwtB,MAAM,CAAN,CAAZ,EAAsB9iD,MAAtB,CAA6BjiB,QAAQ,CAArC,EAAwC,CAAxC,EAA2Cq/D,MAA3C;AACA;AACF,SAAK97B,uBAAaugB,aAAlB;AACEvM,oBAAc5zB,SAAS26B,cAAT,EAAd;AACA/G,kBAAYwtB,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgC9iD,MAAhC,CAAuCjiB,QAAQ,CAA/C,EAAkD,CAAlD,EAAqDq/D,MAArD;AACA;AACF,SAAK97B,uBAAakgB,WAAlB;AACElM,oBAAc5zB,SAAS26B,cAAT,EAAd;AACA/G,kBAAYt1B,MAAZ,CAAmBjiB,QAAQ,CAA3B,EAA8B,CAA9B,EAAiCq/D,MAAjC;AACA;AACF;AACE;AAlBJ;;AAqBA,OAAK6G,uBAAL,CAA6BviD,QAA7B,EAAuC4zB,WAAvC;AACA,MAAMsvB,QAAQ,KAAKjE,MAAnB;AACAiE,QAAMvkD,MAAN,CAAauiD,WAAb;AACA,OAAKiC,qBAAL,CAA2BnjD,QAA3B,EAAqC3jB,KAArC,EAA4C+kE,KAA5C,EAAmD,CAAnD;AACA,MAAMgC,iBAAiB,uDAAyD;AAC9Et4B,aAAS,CAACA,QAAQ,CAAR,CAAD,EAAa4wB,MAAb,CADqE;AAE9Ej1D,aAASA,OAFqE;AAG9EuZ,cAAUA,QAHoE;AAI9EohD,WAAOA,KAJuE;AAK9E/kE,WAAOA;AALuE,GAAhF;AAOA6mE,QAAM/B,MAAN,CAAa,4BAAeiC,eAAet4B,OAA9B,CAAb,EACEs4B,cADF;AAEA,OAAKhE,aAAL,CAAmBplE,IAAnB,CAAwB,CAACopE,cAAD,EAAiB,CAAjB,CAAxB;;AAEA,MAAMC,kBAAkB,uDAAyD;AAC/Ev4B,aAAS,CAAC4wB,MAAD,EAAS5wB,QAAQ,CAAR,CAAT,CADsE;AAE/ErkC,aAASA,OAFsE;AAG/EuZ,cAAUA,QAHqE;AAI/EohD,WAAOA,KAJwE;AAK/E/kE,WAAOA,QAAQ;AALgE,GAAjF;AAOA6mE,QAAM/B,MAAN,CAAa,4BAAekC,gBAAgBv4B,OAA/B,CAAb,EAAsDu4B,eAAtD;AACA,OAAKjE,aAAL,CAAmBplE,IAAnB,CAAwB,CAACqpE,eAAD,EAAkB,CAAlB,CAAxB;AACA,OAAKtE,sBAAL,GAA8B,IAA9B;AACD,CA1DD;;AA4DA;;;;;AAKAR,OAAOrsD,SAAP,CAAiBuwD,WAAjB,GAA+B,YAAW;AACxC,MAAI,KAAKlC,iBAAL,IAA0B,KAAKA,iBAAL,CAAuBjoE,IAAvB,IAA+BkvB,8BAAoBmB,WAAjF,EAA8F;AAC5F,QAAMylB,MAAM,KAAKmyB,iBAAjB;AACA,SAAKK,mBAAL,CAAyBxyB,GAAzB;AACA,SAAKk1B,aAAL;AACA,SAAK/kD,aAAL,CAAmB,IAAI8/C,WAAJ,CAAgBH,gBAAgBE,SAAhC,EAA2C,KAAKlI,SAAhD,EAA2D9nB,GAA3D,CAAnB;AACA,SAAK4wB,SAAL,GAAiB,KAAjB;AACA,WAAO,IAAP;AACD;AACD,SAAO,KAAP;AACD,CAVD;;AAYA;;;;;AAKAT,OAAOrsD,SAAP,CAAiBoxD,aAAjB,GAAiC,YAAW;AAC1C,MAAMC,eAAe,KAAKnE,aAA1B;AACA,MAAMoE,oBAAoB,EAA1B;AACA,MAAIC,UAAU,KAAd;AACA,MAAIC,kBAAJ;AAAA,MAAe9vB,oBAAf;AAAA,MAA4B0uB,oBAA5B;AAAA,MAAyCtiD,iBAAzC;AAAA,MAAmDhoB,UAAnD;AAAA,MAAsDqE,cAAtD;AAAA,MAA6D80B,aAA7D;AACA,MAAIwyC,iBAAJ;AAAA,MAAc/oB,cAAd;AAAA,MAAqBsmB,oBAArB;AAAA,MAAkCgB,YAAlC;AACA,OAAKlqE,IAAIurE,aAAatrE,MAAb,GAAsB,CAA/B,EAAkCD,KAAK,CAAvC,EAA0C,EAAEA,CAA5C,EAA+C;AAC7CsqE,kBAAciB,aAAavrE,CAAb,CAAd;AACAkpE,kBAAcoB,YAAY,CAAZ,CAAd;AACAJ,UAAM,mBAAOhB,YAAYz6D,OAAnB,CAAN;AACA,QAAIy6D,YAAYE,KAAhB,EAAuB;AACrB;AACAc,aAAO,MAAMhB,YAAYE,KAAZ,CAAkBzmE,IAAlB,CAAuB,GAAvB,CAAb;AACD;AACD,QAAI,EAAEunE,OAAOsB,iBAAT,CAAJ,EAAiC;AAC/BA,wBAAkBtB,GAAlB,IAAyB,EAAzB;AACD;AACD,QAAII,YAAY,CAAZ,MAAmB,CAAvB,EAA0B;AACxBkB,wBAAkBtB,GAAlB,EAAuBtnB,KAAvB,GAA+BsmB,WAA/B;AACAsC,wBAAkBtB,GAAlB,EAAuB7lE,KAAvB,GAA+B6kE,YAAY7kE,KAA3C;AACD,KAHD,MAGO,IAAIimE,YAAY,CAAZ,KAAkB,CAAtB,EAAyB;AAC9BkB,wBAAkBtB,GAAlB,EAAuB/wC,IAAvB,GAA8B+vC,WAA9B;AACAsC,wBAAkBtB,GAAlB,EAAuB7lE,KAAvB,GAA+B6kE,YAAY7kE,KAAZ,GAAoB,CAAnD;AACD;AAEF;AACD,OAAK6lE,GAAL,IAAYsB,iBAAZ,EAA+B;AAC7B5oB,YAAQ4oB,kBAAkBtB,GAAlB,EAAuBtnB,KAA/B;AACAzpB,WAAOqyC,kBAAkBtB,GAAlB,EAAuB/wC,IAA9B;AACA90B,YAAQmnE,kBAAkBtB,GAAlB,EAAuB7lE,KAA/B;AACAsnE,eAAWtnE,QAAQ,CAAnB;AACA,QAAI80B,SAASv4B,SAAb,EAAwB;AACtBsoE,oBAAc/vC,IAAd;AACD,KAFD,MAEO;AACL+vC,oBAActmB,KAAd;AACD;AACD,QAAI+oB,WAAW,CAAf,EAAkB;AAChBA,iBAAW,CAAX;AACD;AACD3jD,eAAWkhD,YAAYlhD,QAAvB;AACA4zB,kBAAc5zB,SAAS26B,cAAT,EAAd;AACA+oB,gBAAY9vB,WAAZ;AACA6vB,cAAU,KAAV;AACA,YAAQzjD,SAAS5O,OAAT,EAAR;AACE,WAAKwuB,uBAAasgB,iBAAlB;AACE,YAAItM,YAAYstB,YAAYE,KAAZ,CAAkB,CAAlB,CAAZ,EAAkCnpE,MAAlC,GAA2C,CAA/C,EAAkD;AAChD27C,sBAAYstB,YAAYE,KAAZ,CAAkB,CAAlB,CAAZ,EAAkC9iD,MAAlC,CAAyCjiB,KAAzC,EAAgD,CAAhD;AACAonE,oBAAU,IAAV;AACD;AACD;AACF,WAAK7jC,uBAAakgB,WAAlB;AACE,YAAIlM,YAAY37C,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B27C,sBAAYt1B,MAAZ,CAAmBjiB,KAAnB,EAA0B,CAA1B;AACAonE,oBAAU,IAAV;AACD;AACD;AACF,WAAK7jC,uBAAaugB,aAAlB;AACEujB,oBAAYA,UAAUxC,YAAYE,KAAZ,CAAkB,CAAlB,CAAV,CAAZ;AACA;AACF,WAAKxhC,uBAAaogB,OAAlB;AACE0jB,oBAAYA,UAAUxC,YAAYE,KAAZ,CAAkB,CAAlB,CAAV,CAAZ;AACA,YAAIsC,UAAUzrE,MAAV,GAAmB,CAAvB,EAA0B;AACxB,cAAIoE,SAASqnE,UAAUzrE,MAAV,GAAmB,CAAhC,EAAmC;AACjCoE,oBAAQ,CAAR;AACD;AACDqnE,oBAAUplD,MAAV,CAAiBjiB,KAAjB,EAAwB,CAAxB;AACAonE,oBAAU,IAAV;AACA,cAAIpnE,UAAU,CAAd,EAAiB;AACf;AACAqnE,sBAAUrpD,GAAV;AACAqpD,sBAAU1pE,IAAV,CAAe0pE,UAAU,CAAV,CAAf;AACAC,uBAAWD,UAAUzrE,MAAV,GAAmB,CAA9B;AACD;AACF;AACD;AACF;AACE;AAjCJ;;AAoCA,QAAIwrE,OAAJ,EAAa;AACX,WAAKlB,uBAAL,CAA6BviD,QAA7B,EAAuC4zB,WAAvC;AACA,UAAM4oB,WAAW,EAAjB;AACA,UAAIrrC,SAASv4B,SAAb,EAAwB;AACtB,aAAKqmE,MAAL,CAAYtgD,MAAZ,CAAmBwS,IAAnB;AACAqrC,iBAASxiE,IAAT,CAAcm3B,KAAK2Z,OAAL,CAAa,CAAb,CAAd;AACD;AACD,UAAI8P,UAAUhiD,SAAd,EAAyB;AACvB,aAAKqmE,MAAL,CAAYtgD,MAAZ,CAAmBi8B,KAAnB;AACA4hB,iBAASxiE,IAAT,CAAc4gD,MAAM9P,OAAN,CAAc,CAAd,CAAd;AACD;AACD,UAAI3Z,SAASv4B,SAAT,IAAsBgiD,UAAUhiD,SAApC,EAA+C;AAC7C,YAAMwqE,iBAAiB,uDAAyD;AAC9EhC,iBAAOF,YAAYE,KAD2D;AAE9E36D,mBAASy6D,YAAYz6D,OAFyD;AAG9EuZ,oBAAUkhD,YAAYlhD,QAHwD;AAI9E3jB,iBAAOsnE,QAJuE;AAK9E74B,mBAAS0xB;AALqE,SAAhF;AAOA,aAAKyC,MAAL,CAAYkC,MAAZ,CAAmB,4BAAeiC,eAAet4B,OAA9B,CAAnB,EACEs4B,cADF;AAED;AACD,WAAKD,qBAAL,CAA2BnjD,QAA3B,EAAqC3jB,KAArC,EAA4C6kE,YAAYE,KAAxD,EAA+D,CAAC,CAAhE;AACA,UAAI,KAAKnG,cAAT,EAAyB;AACvB,aAAKjD,QAAL,CAAcjxB,SAAd,GAA0Bg6B,aAA1B,CAAwC,KAAK9F,cAA7C;AACA,aAAKA,cAAL,GAAsB,IAAtB;AACD;AACDsI,mBAAatrE,MAAb,GAAsB,CAAtB;AACD;AAEF;AACD,SAAOwrE,OAAP;AACD,CA/GD;;AAkHA;;;;;AAKAlF,OAAOrsD,SAAP,CAAiBqwD,uBAAjB,GAA2C,UAASviD,QAAT,EAAmB4zB,WAAnB,EAAgC;AACzE,OAAKurB,gBAAL,GAAwB,IAAxB;AACAn/C,WAAS+8B,cAAT,CAAwBnJ,WAAxB;AACA,OAAKurB,gBAAL,GAAwB,KAAxB;AACD,CAJD;;AAOA;;;;;;;AAOAZ,OAAOrsD,SAAP,CAAiBixD,qBAAjB,GAAyC,UACvCnjD,QADuC,EAC7B3jB,KAD6B,EACtB+kE,KADsB,EACf/kC,KADe,EACR;AAC/B,OAAK4iC,MAAL,CAAY2E,eAAZ,CAA4B5jD,SAAS0B,SAAT,EAA5B,EAAkD,UAASugD,gBAAT,EAA2B;AAC3E,QAAIA,iBAAiBjiD,QAAjB,KAA8BA,QAA9B,KACCohD,UAAUxoE,SAAV,IAAuBqpE,iBAAiBb,KAAjB,KAA2BxoE,SAAlD,IACD,mBAAOqpE,iBAAiBb,KAAxB,EAA+BA,KAA/B,CAFA,KAGAa,iBAAiB5lE,KAAjB,GAAyBA,KAH7B,EAGoC;AAClC4lE,uBAAiB5lE,KAAjB,IAA0BggC,KAA1B;AACD;AACF,GAPD;AAQD,CAVD;;AAaA;;;AAGA,SAAS87B,uBAAT,GAAmC;AACjC,MAAM/7C,QAAQ,gCAAd;AACA,SAAO,UAAS3V,OAAT,EAAkB4a,UAAlB,EAA8B;AACnC,WAAOjF,MAAMwjB,uBAAaigB,KAAnB,CAAP;AACD,GAFD;AAGD;;kBAGc0e,M;;;;;;;;;;;;;;;;;;;AC3vCf;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AAGA;;;;AAbA;;;AAiBA,IAAMsF,YAAY,CAAlB;;AAGA;;;AAGO,IAAMtO,sBAAO;AAClBuO,YAAU,UADQ;AAElB12C,SAAO;AAFW,CAAb;;AAMP;;;;;;;;;;;;;;;;AAiBA;;;;;;;;;AASA,IAAMojC,iBAAiB,SAAjBA,cAAiB,CAAShzC,WAAT,EAAsB;;AAE3CozC,wBAAYr9C,IAAZ,CAAiB,IAAjB,EAAuB;AACrByf,iBAAaA;AADQ,GAAvB;;AAIA,MAAMj0B,UAAUye,eAAe,EAA/B;;AAEA;;;;AAIA,OAAKmzC,MAAL,GAAc,CAAd;;AAEA;;;;AAIA,OAAKroB,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;;AAEA;;;;AAIA,OAAKkgD,QAAL,GAAgBhlE,QAAQilE,OAAR,KAAoBprE,SAApB,GAAgCmG,QAAQilE,OAAxC,GAAkD,EAAlE;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkBllE,QAAQmlE,SAAR,KAAsBtrE,SAAtB,GAAkCmG,QAAQmlE,SAA1C,GAAsD,IAAxE;;AAEA;;;;AAIA,OAAKC,oBAAL,GAA4BplE,QAAQ47B,mBAAR,IAA+B,KAA3D;;AAEA;;;;AAIA,OAAK64B,UAAL,GAAkBz0D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwChjB,iBAA1D;;AAEA;;;;AAIA,OAAK2zB,WAAL,GAAmB,IAAnB;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkBzrE,SAAlB;;AAEA;;;;AAIA,OAAK0rE,UAAL,GAAkB1rE,SAAlB;;AAEA;;;;AAIA,OAAK09D,KAAL,GAAa19D,SAAb;;AAEA;;;;;AAKA,OAAK2rE,iBAAL,GAAyB,GAAzB;;AAEA;;;AAGA,OAAKC,kBAAL,GAA0B5rE,SAA1B;;AAEA;;;;;AAKA,OAAK6rE,qBAAL,GAA6B,GAA7B;;AAEA;;;;;AAKA,OAAKC,mBAAL,GAA2B,GAA3B;AAED,CA9FD;;AAgGA,qBAASlU,cAAT,EAAyBI,qBAAzB;;AAGA;;;;;;;AAOA,SAAS59B,WAAT,CAAqBJ,eAArB,EAAsC;AACpC,MAAI,CAAC,KAAK4gC,UAAL,CAAgB5gC,eAAhB,CAAL,EAAuC;AACrC,WAAO,IAAP;AACD;AACD,MAAMt6B,OAAOs6B,gBAAgBt6B,IAA7B;AACA,MAAIA,SAASwoB,oBAAUsM,KAAnB,IAA4B90B,SAASwoB,oBAAUqM,UAAnD,EAA+D;AAC7D,WAAO,IAAP;AACD;;AAEDyF,kBAAgBhN,cAAhB;;AAEA,MAAMpvB,MAAMo8B,gBAAgBp8B,GAA5B;AACA,MAAMmuE,aAAa,yBAA2B/xC,gBAAgBtN,aAA9D;;AAEA,MAAI,KAAK2+C,UAAT,EAAqB;AACnB,SAAKG,WAAL,GAAmBxxC,gBAAgBnN,UAAnC;AACD;;AAED;AACA;AACA,MAAI4W,cAAJ;AACA,MAAIzJ,gBAAgBt6B,IAAhB,IAAwBwoB,oBAAUsM,KAAtC,EAA6C;AAC3CiP,YAAQsoC,WAAWjyC,MAAnB;AACA,QAAIo7B,gBACA6W,WAAWC,SAAX,KAAyBC,WAAWC,eADxC,EACyD;AACvDzoC,eAAShW,uBAAT;AACD;AACD,QAAIs+C,WAAWC,SAAX,KAAyBC,WAAWE,cAAxC,EAAwD;AACtD1oC,eAAS,EAAT;AACD;AACF,GATD,MASO,IAAIzJ,gBAAgBt6B,IAAhB,IAAwBwoB,oBAAUqM,UAAtC,EAAkD;AACvDkP,YAAQ,CAACsoC,WAAWK,WAApB;AACA,QAAIjX,WAAJ,EAAY;AACV1xB,eAAS,CAAT;AACD;AACF;;AAED,MAAIA,UAAU,CAAd,EAAiB;AACf,WAAO,KAAP;AACD;;AAED,MAAM3Y,MAAMD,KAAKC,GAAL,EAAZ;;AAEA,MAAI,KAAK2gD,UAAL,KAAoBzrE,SAAxB,EAAmC;AACjC,SAAKyrE,UAAL,GAAkB3gD,GAAlB;AACD;;AAED,MAAI,CAAC,KAAK4yC,KAAN,IAAe5yC,MAAM,KAAK2gD,UAAX,GAAwB,KAAKE,iBAAhD,EAAmE;AACjE,SAAKjO,KAAL,GAAav6D,KAAKmH,GAAL,CAASm5B,KAAT,IAAkB,CAAlB,GACXk5B,KAAKuO,QADM,GAEXvO,KAAKnoC,KAFP;AAGD;;AAED,MAAI,KAAKkpC,KAAL,KAAef,KAAKuO,QAAxB,EAAkC;AAChC,QAAMntE,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,QAAI,KAAK0yC,kBAAT,EAA6B;AAC3B98C,mBAAa,KAAK88C,kBAAlB;AACD,KAFD,MAEO;AACL7tE,WAAK4lC,OAAL,CAAa/I,mBAASE,WAAtB,EAAmC,CAAnC;AACD;AACD,SAAK8wC,kBAAL,GAA0B58C,WAAW,KAAKq9C,yBAAL,CAA+B32D,IAA/B,CAAoC,IAApC,CAAX,EAAsD,KAAKi2D,iBAA3D,CAA1B;AACA,QAAIljD,aAAa1qB,KAAKkrB,aAAL,KAAuB9lB,KAAKoG,GAAL,CAAS,CAAT,EAAYk6B,QAAQ,KAAKooC,qBAAzB,CAAxC;AACA,QAAM3qC,gBAAgBnjC,KAAK2nC,gBAAL,EAAtB;AACA,QAAM1E,gBAAgBjjC,KAAK0nC,gBAAL,EAAtB;AACA,QAAI6mC,UAAU,CAAd;AACA,QAAI7jD,aAAayY,aAAjB,EAAgC;AAC9BzY,mBAAatlB,KAAKkH,GAAL,CAASoe,UAAT,EAAqByY,gBAAgB,KAAK4qC,mBAA1C,CAAb;AACAQ,gBAAU,CAAV;AACD,KAHD,MAGO,IAAI7jD,aAAauY,aAAjB,EAAgC;AACrCvY,mBAAatlB,KAAKiH,GAAL,CAASqe,UAAT,EAAqBuY,gBAAgB,KAAK8qC,mBAA1C,CAAb;AACAQ,gBAAU,CAAC,CAAX;AACD;AACD,QAAI,KAAKd,WAAT,EAAsB;AACpB,UAAMvtE,SAASF,KAAKymC,mBAAL,CAAyB/b,UAAzB,EAAqC,KAAK+iD,WAA1C,CAAf;AACAztE,WAAK2kC,SAAL,CAAe3kC,KAAKinC,eAAL,CAAqB/mC,MAArB,CAAf;AACD;AACDF,SAAKsqC,aAAL,CAAmB5f,UAAnB;;AAEA,QAAI6jD,YAAY,CAAZ,IAAiB,KAAKf,oBAA1B,EAAgD;AAC9CxtE,WAAK8+B,OAAL,CAAa;AACXpU,oBAAY1qB,KAAKgkC,mBAAL,CAAyBtZ,UAAzB,EAAqCgb,QAAQ,CAAR,GAAY,CAAC,CAAb,GAAiB,CAAtD,CADD;AAEXP,gBAAQ8M,eAFG;AAGX/M,gBAAQ,KAAKuoC,WAHF;AAIXvgD,kBAAU,KAAKykB;AAJJ,OAAb;AAMD;;AAED,QAAI48B,UAAU,CAAd,EAAiB;AACfvuE,WAAK8+B,OAAL,CAAa;AACXpU,oBAAYyY,aADD;AAEXgC,gBAAQ8M,eAFG;AAGX/M,gBAAQ,KAAKuoC,WAHF;AAIXvgD,kBAAU;AAJC,OAAb;AAMD,KAPD,MAOO,IAAIqhD,UAAU,CAAd,EAAiB;AACtBvuE,WAAK8+B,OAAL,CAAa;AACXpU,oBAAYuY,aADD;AAEXkC,gBAAQ8M,eAFG;AAGX/M,gBAAQ,KAAKuoC,WAHF;AAIXvgD,kBAAU;AAJC,OAAb;AAMD;AACD,SAAKwgD,UAAL,GAAkB3gD,GAAlB;AACA,WAAO,KAAP;AACD;;AAED,OAAKitC,MAAL,IAAet0B,KAAf;;AAEA,MAAM8oC,WAAWppE,KAAKkH,GAAL,CAAS,KAAK8gE,QAAL,IAAiBrgD,MAAM,KAAK2gD,UAA5B,CAAT,EAAkD,CAAlD,CAAjB;;AAEA38C,eAAa,KAAK48C,UAAlB;AACA,OAAKA,UAAL,GAAkB18C,WAAW,KAAKw9C,gBAAL,CAAsB92D,IAAtB,CAA2B,IAA3B,EAAiC9X,GAAjC,CAAX,EAAkD2uE,QAAlD,CAAlB;;AAEA,SAAO,KAAP;AACD;;AAGD;;;AAGA3U,eAAet+C,SAAf,CAAyB+yD,yBAAzB,GAAqD,YAAW;AAC9D,OAAKT,kBAAL,GAA0B5rE,SAA1B;AACA,MAAMjC,OAAO,KAAKsxC,MAAL,GAAcnW,OAAd,EAAb;AACAn7B,OAAK4lC,OAAL,CAAa/I,mBAASE,WAAtB,EAAmC,CAAC,CAApC;AACD,CAJD;;AAOA;;;;AAIA88B,eAAet+C,SAAf,CAAyBkzD,gBAAzB,GAA4C,UAAS5uE,GAAT,EAAc;AACxD,MAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,MAAIn7B,KAAK6lC,YAAL,EAAJ,EAAyB;AACvB7lC,SAAK+lC,gBAAL;AACD;AACD,MAAMqqB,WAAW8c,SAAjB;AACA,MAAMxnC,QAAQ,iBAAM,KAAKs0B,MAAX,EAAmB,CAAC5J,QAApB,EAA8BA,QAA9B,CAAd;AACA,gCAAYpwD,IAAZ,EAAkB,CAAC0lC,KAAnB,EAA0B,KAAK+nC,WAA/B,EAA4C,KAAK97B,SAAjD;AACA,OAAKguB,KAAL,GAAa19D,SAAb;AACA,OAAK+3D,MAAL,GAAc,CAAd;AACA,OAAKyT,WAAL,GAAmB,IAAnB;AACA,OAAKC,UAAL,GAAkBzrE,SAAlB;AACA,OAAK0rE,UAAL,GAAkB1rE,SAAlB;AACD,CAbD;;AAgBA;;;;;;AAMA43D,eAAet+C,SAAf,CAAyBmzD,cAAzB,GAA0C,UAASnB,SAAT,EAAoB;AAC5D,OAAKD,UAAL,GAAkBC,SAAlB;AACA,MAAI,CAACA,SAAL,EAAgB;AACd,SAAKE,WAAL,GAAmB,IAAnB;AACD;AACF,CALD;;kBAQe5T,c;;;;;;;;;;;;;;;;;;AC/Tf;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AAGA;;;;;;;AAQA;;;;;;;;;;AAnBA;;;AA6BA,IAAMP,cAAc,SAAdA,WAAc,CAASzyC,WAAT,EAAsB;;AAExCu1C,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BC,qBAAiBA,eAFW;AAG5BC,mBAAeA;AAHa,GAA9B;;AAMA,MAAMn0D,UAAUye,eAAe,EAA/B;;AAEA;;;;AAIA,OAAK8nD,OAAL,GAAe,IAAf;;AAEA;;;;AAIA,OAAK5Q,UAAL,GAAkB97D,SAAlB;;AAEA;;;;AAIA,OAAK2sE,SAAL,GAAiB,KAAjB;;AAEA;;;;AAIA,OAAKC,cAAL,GAAsB,GAAtB;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkB1mE,QAAQ2mE,SAAR,KAAsB9sE,SAAtB,GAAkCmG,QAAQ2mE,SAA1C,GAAsD,GAAxE;;AAEA;;;;AAIA,OAAKp9B,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;AAED,CA9CD;;AAgDA,qBAASosC,WAAT,EAAsB8C,iBAAtB;;AAGA;;;;AAIA,SAASE,eAAT,CAAyBrgC,eAAzB,EAA0C;AACxC,MAAI+yC,gBAAgB,GAApB;;AAEA,MAAMC,SAAS,KAAKvR,cAAL,CAAoB,CAApB,CAAf;AACA,MAAMwR,SAAS,KAAKxR,cAAL,CAAoB,CAApB,CAAf;;AAEA;AACA,MAAMvoB,QAAQ/vC,KAAK4U,KAAL,CACZk1D,OAAOh9C,OAAP,GAAiB+8C,OAAO/8C,OADZ,EAEZg9C,OAAOj9C,OAAP,GAAiBg9C,OAAOh9C,OAFZ,CAAd;;AAIA,MAAI,KAAK8rC,UAAL,KAAoB97D,SAAxB,EAAmC;AACjC,QAAMyjC,QAAQyP,QAAQ,KAAK4oB,UAA3B;AACA,SAAK8Q,cAAL,IAAuBnpC,KAAvB;AACA,QAAI,CAAC,KAAKkpC,SAAN,IACAxpE,KAAKmH,GAAL,CAAS,KAAKsiE,cAAd,IAAgC,KAAKC,UADzC,EACqD;AACnD,WAAKF,SAAL,GAAiB,IAAjB;AACD;AACDI,oBAAgBtpC,KAAhB;AACD;AACD,OAAKq4B,UAAL,GAAkB5oB,KAAlB;;AAEA,MAAMt1C,MAAMo8B,gBAAgBp8B,GAA5B;AACA,MAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,MAAIn7B,KAAKsnC,cAAL,GAAsBrI,QAAtB,KAAmCqM,2BAAvC,EAAgD;AAC9C;AACD;;AAED;AACA;AACA;AACA,MAAMlR,mBAAmBv6B,IAAI+vB,WAAJ,GAAkByK,qBAAlB,EAAzB;AACA,MAAMsjC,WAAW,uBAAqB,KAAKD,cAA1B,CAAjB;AACAC,WAAS,CAAT,KAAevjC,iBAAiBI,IAAhC;AACAmjC,WAAS,CAAT,KAAevjC,iBAAiBK,GAAhC;AACA,OAAKk0C,OAAL,GAAe9uE,IAAIkvB,sBAAJ,CAA2B4uC,QAA3B,CAAf;;AAEA;AACA,MAAI,KAAKiR,SAAT,EAAoB;AAClB,QAAM3vC,WAAWj/B,KAAKukC,WAAL,EAAjB;AACA1kC,QAAIu9B,MAAJ;AACA,+CAAyBp9B,IAAzB,EAA+Bi/B,WAAW+vC,aAA1C,EAAyD,KAAKL,OAA9D;AACD;AACF;;AAGD;;;;;AAKA,SAASpS,aAAT,CAAuBtgC,eAAvB,EAAwC;AACtC,MAAI,KAAKyhC,cAAL,CAAoBp8D,MAApB,GAA6B,CAAjC,EAAoC;AAClC,QAAMzB,MAAMo8B,gBAAgBp8B,GAA5B;AACA,QAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACAn7B,SAAK4lC,OAAL,CAAa/I,mBAASE,WAAtB,EAAmC,CAAC,CAApC;AACA,QAAI,KAAK6xC,SAAT,EAAoB;AAClB,UAAM3vC,WAAWj/B,KAAKukC,WAAL,EAAjB;AACA,+BAAOvkC,IAAP,EAAai/B,QAAb,EAAuB,KAAK0vC,OAA5B,EAAqC,KAAKh9B,SAA1C;AACD;AACD,WAAO,KAAP;AACD,GATD,MASO;AACL,WAAO,IAAP;AACD;AACF;;AAGD;;;;;AAKA,SAAS0qB,eAAT,CAAyBpgC,eAAzB,EAA0C;AACxC,MAAI,KAAKyhC,cAAL,CAAoBp8D,MAApB,IAA8B,CAAlC,EAAqC;AACnC,QAAMzB,MAAMo8B,gBAAgBp8B,GAA5B;AACA,SAAK8uE,OAAL,GAAe,IAAf;AACA,SAAK5Q,UAAL,GAAkB97D,SAAlB;AACA,SAAK2sE,SAAL,GAAiB,KAAjB;AACA,SAAKC,cAAL,GAAsB,GAAtB;AACA,QAAI,CAAC,KAAKhR,sBAAV,EAAkC;AAChCh+D,UAAIs7B,OAAJ,GAAcyK,OAAd,CAAsB/I,mBAASE,WAA/B,EAA4C,CAA5C;AACD;AACD,WAAO,IAAP;AACD,GAVD,MAUO;AACL,WAAO,KAAP;AACD;AACF;;AAGD;;;AAGAu8B,YAAY/9C,SAAZ,CAAsBuiD,eAAtB,GAAwC1jB,gBAAxC;;kBAEekf,W;;;;;;;;;;;;;;;;;;AC/Kf;;AACA;;;;AACA;;AACA;;AACA;;;;;;AAGA;;;;;;;AAQA;;;;;;;;;;AAUA,IAAME,YAAY,SAAZA,SAAY,CAAS3yC,WAAT,EAAsB;;AAEtCu1C,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BC,qBAAiBA,eAFW;AAG5BC,mBAAeA;AAHa,GAA9B;;AAMA,MAAMn0D,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA;;;;AAIA,OAAK2mD,oBAAL,GAA4BplE,QAAQ47B,mBAAR,IAA+B,KAA3D;;AAEA;;;;AAIA,OAAK2qC,OAAL,GAAe,IAAf;;AAEA;;;;AAIA,OAAKh9B,SAAL,GAAiBvpC,QAAQ8kB,QAAR,KAAqBjrB,SAArB,GAAiCmG,QAAQ8kB,QAAzC,GAAoD,GAArE;;AAEA;;;;AAIA,OAAKiiD,aAAL,GAAqBltE,SAArB;;AAEA;;;;AAIA,OAAKk8D,eAAL,GAAuB,CAAvB;AAED,CAxCD,C,CA5BA;;;;;AAsEA,qBAAS3E,SAAT,EAAoB4C,iBAApB;;AAGA;;;;AAIA,SAASE,eAAT,CAAyBrgC,eAAzB,EAA0C;AACxC,MAAImzC,aAAa,GAAjB;;AAEA,MAAMH,SAAS,KAAKvR,cAAL,CAAoB,CAApB,CAAf;AACA,MAAMwR,SAAS,KAAKxR,cAAL,CAAoB,CAApB,CAAf;AACA,MAAMvwC,KAAK8hD,OAAOh9C,OAAP,GAAiBi9C,OAAOj9C,OAAnC;AACA,MAAM7E,KAAK6hD,OAAO/8C,OAAP,GAAiBg9C,OAAOh9C,OAAnC;;AAEA;AACA,MAAM2hB,WAAWzuC,KAAKsG,IAAL,CAAUyhB,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,CAAjB;;AAEA,MAAI,KAAK+hD,aAAL,KAAuBltE,SAA3B,EAAsC;AACpCmtE,iBAAa,KAAKD,aAAL,GAAqBt7B,QAAlC;AACD;AACD,OAAKs7B,aAAL,GAAqBt7B,QAArB;;AAGA,MAAMh0C,MAAMo8B,gBAAgBp8B,GAA5B;AACA,MAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACA,MAAMzQ,aAAa1qB,KAAKkrB,aAAL,EAAnB;AACA,MAAM+X,gBAAgBjjC,KAAK0nC,gBAAL,EAAtB;AACA,MAAMvE,gBAAgBnjC,KAAK2nC,gBAAL,EAAtB;AACA,MAAImL,gBAAgBpoB,aAAa0kD,UAAjC;AACA,MAAIt8B,gBAAgB7P,aAApB,EAAmC;AACjCmsC,iBAAansC,gBAAgBvY,UAA7B;AACAooB,oBAAgB7P,aAAhB;AACD,GAHD,MAGO,IAAI6P,gBAAgB3P,aAApB,EAAmC;AACxCisC,iBAAajsC,gBAAgBzY,UAA7B;AACAooB,oBAAgB3P,aAAhB;AACD;;AAED,MAAIisC,cAAc,GAAlB,EAAuB;AACrB,SAAKjR,eAAL,GAAuBiR,UAAvB;AACD;;AAED;AACA,MAAMh1C,mBAAmBv6B,IAAI+vB,WAAJ,GAAkByK,qBAAlB,EAAzB;AACA,MAAMsjC,WAAW,uBAAqB,KAAKD,cAA1B,CAAjB;AACAC,WAAS,CAAT,KAAevjC,iBAAiBI,IAAhC;AACAmjC,WAAS,CAAT,KAAevjC,iBAAiBK,GAAhC;AACA,OAAKk0C,OAAL,GAAe9uE,IAAIkvB,sBAAJ,CAA2B4uC,QAA3B,CAAf;;AAEA;AACA99D,MAAIu9B,MAAJ;AACA,2CAAuBp9B,IAAvB,EAA6B8yC,aAA7B,EAA4C,KAAK67B,OAAjD;AACD;;AAGD;;;;;AAKA,SAASpS,aAAT,CAAuBtgC,eAAvB,EAAwC;AACtC,MAAI,KAAKyhC,cAAL,CAAoBp8D,MAApB,GAA6B,CAAjC,EAAoC;AAClC,QAAMzB,MAAMo8B,gBAAgBp8B,GAA5B;AACA,QAAMG,OAAOH,IAAIs7B,OAAJ,EAAb;AACAn7B,SAAK4lC,OAAL,CAAa/I,mBAASE,WAAtB,EAAmC,CAAC,CAApC;AACA,QAAMrS,aAAa1qB,KAAKkrB,aAAL,EAAnB;AACA,QAAI,KAAKsiD,oBAAL,IACA9iD,aAAa1qB,KAAK2nC,gBAAL,EADb,IAEAjd,aAAa1qB,KAAK0nC,gBAAL,EAFjB,EAE0C;AACxC;AACA;AACA;AACA,UAAMN,YAAY,KAAK+2B,eAAL,GAAuB,CAAzC;AACA,6BAAKn+D,IAAL,EAAW0qB,UAAX,EAAuB,KAAKikD,OAA5B,EAAqC,KAAKh9B,SAA1C,EAAqDvK,SAArD;AACD;AACD,WAAO,KAAP;AACD,GAfD,MAeO;AACL,WAAO,IAAP;AACD;AACF;;AAGD;;;;;AAKA,SAASi1B,eAAT,CAAyBpgC,eAAzB,EAA0C;AACxC,MAAI,KAAKyhC,cAAL,CAAoBp8D,MAApB,IAA8B,CAAlC,EAAqC;AACnC,QAAMzB,MAAMo8B,gBAAgBp8B,GAA5B;AACA,SAAK8uE,OAAL,GAAe,IAAf;AACA,SAAKQ,aAAL,GAAqBltE,SAArB;AACA,SAAKk8D,eAAL,GAAuB,CAAvB;AACA,QAAI,CAAC,KAAKN,sBAAV,EAAkC;AAChCh+D,UAAIs7B,OAAJ,GAAcyK,OAAd,CAAsB/I,mBAASE,WAA/B,EAA4C,CAA5C;AACD;AACD,WAAO,IAAP;AACD,GATD,MASO;AACL,WAAO,KAAP;AACD;AACF;;AAGD;;;AAGAy8B,UAAUj+C,SAAV,CAAoBuiD,eAApB,GAAsC1jB,gBAAtC;kBACeof,S;;;;;;;;;;;;;;;;;QCnCCmE,Q,GAAAA,Q;QAyDAthC,W,GAAAA,W;;AApMhB;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAGA;;;;AAXA;;;AAeA,IAAMigC,kBAAkB5zC,oBAAxB;;AAGA;;;;;AAKA,IAAM6zC,gBAAgBniB,gBAAtB;;AAGA;;;;;AAKA,IAAMiiB,kBAAkBjiB,gBAAxB;;AAGA;;;;AAIA,IAAMi1B,kBAAkB3mD,oBAAxB;;AAGA;;;;;;;;;;;;;;;;;;;;;;AAuBA;;;;;;;;;;;;;;;AAeA,IAAM0zC,qBAAqB,SAArBA,kBAAqB,CAASv1C,WAAT,EAAsB;;AAE/C,MAAMze,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEAozC,wBAAYr9C,IAAZ,CAAiB,IAAjB,EAAuB;AACrByf,iBAAaj0B,QAAQi0B,WAAR,IAAuBA;AADf,GAAvB;;AAIA;;;;AAIA,OAAKizC,gBAAL,GAAwBlnE,QAAQi0D,eAAR,GACtBj0D,QAAQi0D,eADc,GACIA,eAD5B;;AAGA;;;;AAIA,OAAKkT,gBAAL,GAAwBnnE,QAAQk0D,eAAR,GACtBl0D,QAAQk0D,eADc,GACIA,eAD5B;;AAGA;;;;AAIA,OAAKkT,gBAAL,GAAwBpnE,QAAQinE,eAAR,GACtBjnE,QAAQinE,eADc,GACIA,eAD5B;;AAGA;;;;AAIA,OAAKI,cAAL,GAAsBrnE,QAAQm0D,aAAR,GACpBn0D,QAAQm0D,aADY,GACIA,aAD1B;;AAGA;;;;AAIA,OAAKsB,sBAAL,GAA8B,KAA9B;;AAEA;;;;AAIA,OAAK6R,gBAAL,GAAwB,EAAxB;;AAEA;;;;AAIA,OAAKhS,cAAL,GAAsB,EAAtB;AAED,CAtDD;;AAwDA,qBAAStB,kBAAT,EAA6BnC,qBAA7B;;AAGA;;;;AAIO,SAAS0D,QAAT,CAAkBgS,aAAlB,EAAiC;AACtC,MAAMruE,SAASquE,cAAcruE,MAA7B;AACA,MAAI2wB,UAAU,CAAd;AACA,MAAIC,UAAU,CAAd;AACA,OAAK,IAAI7wB,IAAI,CAAb,EAAgBA,IAAIC,MAApB,EAA4BD,GAA5B,EAAiC;AAC/B4wB,eAAW09C,cAActuE,CAAd,EAAiB4wB,OAA5B;AACAC,eAAWy9C,cAActuE,CAAd,EAAiB6wB,OAA5B;AACD;AACD,SAAO,CAACD,UAAU3wB,MAAX,EAAmB4wB,UAAU5wB,MAA7B,CAAP;AACD;;AAGD;;;;;AAKA,SAASsuE,sBAAT,CAAgC3zC,eAAhC,EAAiD;AAC/C,MAAMt6B,OAAOs6B,gBAAgBt6B,IAA7B;AACA,SAAOA,SAASkvB,8BAAoBT,WAA7B,IACLzuB,SAASkvB,8BAAoBmB,WADxB,IAELrwB,SAASkvB,8BAAoBQ,SAF/B;AAGD;;AAGD;;;;AAIA+qC,mBAAmB7gD,SAAnB,CAA6Bs0D,sBAA7B,GAAsD,UAAS5zC,eAAT,EAA0B;AAC9E,MAAI2zC,uBAAuB3zC,eAAvB,CAAJ,EAA6C;AAC3C,QAAM7K,QAAQ6K,gBAAgBvL,YAA9B;;AAEA,QAAMnvB,KAAK6vB,MAAMG,SAAN,CAAgBrtB,QAAhB,EAAX;AACA,QAAI+3B,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBQ,SAAhD,EAA2D;AACzD,aAAO,KAAKq+C,gBAAL,CAAsBnuE,EAAtB,CAAP;AACD,KAFD,MAEO,IAAI06B,gBAAgBt6B,IAAhB,IACPkvB,8BAAoBT,WADjB,EAC8B;AACnC,WAAKs/C,gBAAL,CAAsBnuE,EAAtB,IAA4B6vB,KAA5B;AACD,KAHM,MAGA,IAAI7vB,MAAM,KAAKmuE,gBAAf,EAAiC;AACtC;AACA,WAAKA,gBAAL,CAAsBnuE,EAAtB,IAA4B6vB,KAA5B;AACD;AACD,SAAKssC,cAAL,GAAsB,oBAAU,KAAKgS,gBAAf,CAAtB;AACD;AACF,CAhBD;;AAmBA;;;;;;;;;AASO,SAASrzC,WAAT,CAAqBJ,eAArB,EAAsC;AAC3C,MAAI,EAAEA,2BAA2BrL,gCAA7B,CAAJ,EAA0D;AACxD,WAAO,IAAP;AACD;;AAED,MAAIspC,YAAY,KAAhB;AACA,OAAK2V,sBAAL,CAA4B5zC,eAA5B;AACA,MAAI,KAAK4hC,sBAAT,EAAiC;AAC/B,QAAI5hC,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBmB,WAAhD,EAA6D;AAC3D,WAAKu9C,gBAAL,CAAsBtzC,eAAtB;AACD,KAFD,MAEO,IAAIA,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBQ,SAAhD,EAA2D;AAChE,UAAMy+C,YAAY,KAAKL,cAAL,CAAoBxzC,eAApB,CAAlB;AACA,WAAK4hC,sBAAL,GAA8BiS,aAAa,KAAKpS,cAAL,CAAoBp8D,MAApB,GAA6B,CAAxE;AACD;AACF,GAPD,MAOO;AACL,QAAI26B,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBT,WAAhD,EAA6D;AAC3D,UAAMy7C,UAAU,KAAKyD,gBAAL,CAAsBrzC,eAAtB,CAAhB;AACA,WAAK4hC,sBAAL,GAA8BgO,OAA9B;AACA3R,kBAAY,KAAK4D,eAAL,CAAqB+N,OAArB,CAAZ;AACD,KAJD,MAIO,IAAI5vC,gBAAgBt6B,IAAhB,IAAwBkvB,8BAAoBN,WAAhD,EAA6D;AAClE,WAAKi/C,gBAAL,CAAsBvzC,eAAtB;AACD;AACF;AACD,SAAO,CAACi+B,SAAR;AACD;;AAGD;;;;;;;;;;;;;AAaAkC,mBAAmB7gD,SAAnB,CAA6BuiD,eAA7B,GAA+C,UAAS+N,OAAT,EAAkB;AAC/D,SAAOA,OAAP;AACD,CAFD;;kBAIezP,kB;;;;;;;;;;;;;;;;;ACnPf;;;;AAIA;;;kBAGe;AACb0F,UAAQ;AADK,C;;;;;;;;;;;;;;;;;;ACJf;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AAGA;;;AAGA,IAAMiO,kBAAkB;AACtB;;;;;AAKAC,UAAQ;AANc,CAAxB;;AAUA;;;;;;;;;AAUA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;;;;;;;;;;;;;AAnGA;;;AAgHA,IAAMC,cAAc,SAAdA,WAAc,CAAStuE,IAAT,EAAeuuE,QAAf,EAAyBC,UAAzB,EAAqCl0C,eAArC,EAAsD;AACxExV,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAKuuE,QAAL,GAAgBA,QAAhB;;AAEA;;;;;AAKA,OAAKC,UAAL,GAAkBA,UAAlB;;AAEA;;;;;AAKA,OAAKl0C,eAAL,GAAuBA,eAAvB;AACD,CAvBD;;AAyBA,qBAASg0C,WAAT,EAAsBxpD,eAAtB;;AAGA;;;;;;;;;;;;;;;;;;AAkBA,IAAM2pD,SAAS,SAATA,MAAS,CAASvpD,WAAT,EAAsB;;AAEnCozC,wBAAYr9C,IAAZ,CAAiB,IAAjB,EAAuB;AACrByf,iBAAaA;AADQ,GAAvB;;AAIA,MAAMj0B,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA;;;;AAIA,OAAKg2C,UAAL,GAAkBz0D,QAAQ00D,SAAR,GAAoB10D,QAAQ00D,SAA5B,GAAwCxiB,sBAA1D;;AAEA;;;;AAIA,OAAK+1B,aAAL,GAAqBjoE,QAAQkoE,YAAR,GAAuBloE,QAAQkoE,YAA/B,GAA8Cn2B,gBAAnE;;AAEA;;;;AAIA,OAAKo2B,gBAAL,GAAwBnoE,QAAQooE,eAAR,GAA0BpoE,QAAQooE,eAAlC,GAAoDr2B,gBAA5E;;AAEA;;;;AAIA,OAAKs2B,gBAAL,GAAwBroE,QAAQsoE,eAAR,GAA0BtoE,QAAQsoE,eAAlC,GAAoDh2B,uBAA5E;;AAEA;;;;AAIA,OAAKi2B,MAAL,GAAcvoE,QAAQwoE,KAAR,GAAgBxoE,QAAQwoE,KAAxB,GAAgC,KAA9C;;AAEA;;;;AAIA,OAAKC,OAAL,GAAezoE,QAAQtF,MAAR,GAAiBsF,QAAQtF,MAAzB,GAAkCy2B,eAAjD;;AAEA;;;;AAIA,OAAKu3C,aAAL,GAAqB1oE,QAAQixB,YAAR,GAAuBjxB,QAAQixB,YAA/B,GAA8C,CAAnE;;AAEA,MAAM03C,iBAAiB,IAAIzxE,gBAAJ,CAAgB;AACrCE,YAAQ,IAAIC,gBAAJ,CAAiB;AACvB6hE,uBAAiB,KADM;AAEvB5nC,gBAAUtxB,QAAQsxB,QAFK;AAGvB6nC,aAAOn5D,QAAQm5D;AAHQ,KAAjB,CAD6B;AAMrC97C,WAAOrd,QAAQqd,KAAR,GAAgBrd,QAAQqd,KAAxB,GACL+7C,yBAPmC;AAQrCkD,0BAAsB,IARe;AASrCjD,4BAAwB;AATa,GAAhB,CAAvB;;AAYA;;;;AAIA,OAAKuP,eAAL,GAAuBD,cAAvB;;AAEA;AACA,MAAIz3C,oBAAJ;AACA,MAAIlxB,QAAQnH,MAAZ,EAAoB;AAClB,QAAI,OAAOmH,QAAQnH,MAAf,KAA0B,UAA9B,EAA0C;AACxCq4B,oBAAclxB,QAAQnH,MAAtB;AACD,KAFD,MAEO;AACL,UAAMA,SAASmH,QAAQnH,MAAvB;AACAq4B,oBAAc,qBAASj6B,KAAT,EAAgB;AAC5B,eAAO,qBAAS4B,MAAT,EAAiB5B,KAAjB,CAAP;AACD,OAFD;AAGD;AACF,GATD,MASO;AACLi6B,kBAAcC,eAAd;AACD;;AAED;;;;AAIA,OAAK03C,YAAL,GAAoB33C,WAApB;;AAEA;;;;;;AAMA,OAAK43C,wBAAL,GAAgC,EAAhC;;AAEA,MAAMx3C,WAAW,KAAKs3C,eAAL,CAAqB5gC,SAArB,GAAiC+gC,qBAAjC,EAAjB;AACA,sBAAOz3C,QAAP,EAAiB7R,8BAAoBC,GAArC,EACE,KAAK2hD,WADP,EACoB,IADpB;AAEA,sBAAO/vC,QAAP,EAAiB7R,8BAAoBK,MAArC,EACE,KAAKgiD,cADP,EACuB,IADvB;AAGD,CAvGD;;AAyGA,qBAASkG,MAAT,EAAiBnW,qBAAjB;;AAGA;;;;;AAKAmW,OAAO70D,SAAP,CAAiB61D,2BAAjB,GAA+C,UAASthE,OAAT,EAAkBzQ,KAAlB,EAAyB;AACtE,MAAMqK,MAAM,mBAAOoG,OAAP,CAAZ;AACA,OAAKohE,wBAAL,CAA8BxnE,GAA9B,IAAqCrK,KAArC;AACD,CAHD;;AAMA;;;;;AAKA+wE,OAAO70D,SAAP,CAAiB4tD,WAAjB,GAA+B,YAAW;AACxC,SAAO,KAAK6H,eAAL,CAAqB5gC,SAArB,GAAiC+gC,qBAAjC,EAAP;AACD,CAFD;;AAKA;;;;;AAKAf,OAAO70D,SAAP,CAAiB81D,eAAjB,GAAmC,YAAW;AAC5C,SAAO,KAAKP,aAAZ;AACD,CAFD;;AAKA;;;;;;;;;AASAV,OAAO70D,SAAP,CAAiB+1D,QAAjB,GAA4B,UAASxhE,OAAT,EAAkB;AAC5C,MAAMpG,MAAM,mBAAOoG,OAAP,CAAZ;AACA;AACE,yCAAuC,KAAKohE,wBAAL,CAA8BxnE,GAA9B;AADzC;AAGD,CALD;;AAQA;;;;;;;AAOA,SAAS2yB,WAAT,CAAqBJ,eAArB,EAAsC;AACpC,MAAI,CAAC,KAAK4gC,UAAL,CAAgB5gC,eAAhB,CAAL,EAAuC;AACrC,WAAO,IAAP;AACD;AACD,MAAMuV,MAAM,KAAK6+B,aAAL,CAAmBp0C,eAAnB,CAAZ;AACA,MAAMjU,SAAS,KAAKuoD,gBAAL,CAAsBt0C,eAAtB,CAAf;AACA,MAAM8U,SAAS,KAAK0/B,gBAAL,CAAsBx0C,eAAtB,CAAf;AACA,MAAM7T,MAAM,CAACopB,GAAD,IAAQ,CAACxpB,MAAT,IAAmB,CAAC+oB,MAAhC;AACA,MAAMlxC,MAAMo8B,gBAAgBp8B,GAA5B;AACA,MAAM65B,WAAW,KAAKs3C,eAAL,CAAqB5gC,SAArB,GAAiC+gC,qBAAjC,EAAjB;AACA,MAAMhB,aAAa,EAAnB;AACA,MAAMD,WAAW,EAAjB;AACA,MAAI9nD,GAAJ,EAAS;AACP;AACA;AACA;AACA,oBAAM,KAAK8oD,wBAAX;AACArxE,QAAIs5B,qBAAJ,CAA0B8C,gBAAgBrN,KAA1C;AAEI;;;;;AAKA,cAAS9e,OAAT,EAAkBzQ,KAAlB,EAAyB;AACvB,UAAI,KAAKwxE,OAAL,CAAa/gE,OAAb,EAAsBzQ,KAAtB,CAAJ,EAAkC;AAChC6wE,iBAAS7sE,IAAT,CAAcyM,OAAd;AACA,aAAKshE,2BAAL,CAAiCthE,OAAjC,EAA0CzQ,KAA1C;AACA,eAAO,CAAC,KAAKsxE,MAAb;AACD;AACF,KAZH,CAYKh5D,IAZL,CAYU,IAZV,CADF,EAamB;AACf2hB,mBAAa,KAAK23C,YADH;AAEf53C,oBAAc,KAAKy3C;AAFJ,KAbnB;AAiBA,SAAK,IAAIzvE,IAAIq4B,SAASrS,SAAT,KAAuB,CAApC,EAAuChmB,KAAK,CAA5C,EAA+C,EAAEA,CAAjD,EAAoD;AAClD,UAAMyO,UAAU4pB,SAAS1lB,IAAT,CAAc3S,CAAd,CAAhB;AACA,UAAMqE,QAAQwqE,SAASxjE,OAAT,CAAiBoD,OAAjB,CAAd;AACA,UAAIpK,QAAQ,CAAC,CAAb,EAAgB;AACd;AACAwqE,iBAASvoD,MAAT,CAAgBjiB,KAAhB,EAAuB,CAAvB;AACD,OAHD,MAGO;AACLg0B,iBAAS1R,MAAT,CAAgBlY,OAAhB;AACAqgE,mBAAW9sE,IAAX,CAAgByM,OAAhB;AACD;AACF;AACD,QAAIogE,SAAS5uE,MAAT,KAAoB,CAAxB,EAA2B;AACzBo4B,eAASpS,MAAT,CAAgB4oD,QAAhB;AACD;AACF,GApCD,MAoCO;AACL;AACArwE,QAAIs5B,qBAAJ,CAA0B8C,gBAAgBrN,KAA1C;AAEI;;;;;AAKA,cAAS9e,OAAT,EAAkBzQ,KAAlB,EAAyB;AACvB,UAAI,KAAKwxE,OAAL,CAAa/gE,OAAb,EAAsBzQ,KAAtB,CAAJ,EAAkC;AAChC,YAAI,CAACmyC,OAAOT,MAAR,KAAmB,CAAC,qBAASrX,SAASlS,QAAT,EAAT,EAA8B1X,OAA9B,CAAxB,EAAgE;AAC9DogE,mBAAS7sE,IAAT,CAAcyM,OAAd;AACA,eAAKshE,2BAAL,CAAiCthE,OAAjC,EAA0CzQ,KAA1C;AACD,SAHD,MAGO,IAAI,CAAC2oB,UAAU+oB,MAAX,KAAsB,qBAASrX,SAASlS,QAAT,EAAT,EAA8B1X,OAA9B,CAA1B,EAAkE;AACvEqgE,qBAAW9sE,IAAX,CAAgByM,OAAhB;AACA,eAAKyhE,8BAAL,CAAoCzhE,OAApC;AACD;AACD,eAAO,CAAC,KAAK6gE,MAAb;AACD;AACF,KAjBH,CAiBKh5D,IAjBL,CAiBU,IAjBV,CADF,EAkBmB;AACf2hB,mBAAa,KAAK23C,YADH;AAEf53C,oBAAc,KAAKy3C;AAFJ,KAlBnB;AAsBA,SAAK,IAAIvmE,IAAI4lE,WAAW7uE,MAAX,GAAoB,CAAjC,EAAoCiJ,KAAK,CAAzC,EAA4C,EAAEA,CAA9C,EAAiD;AAC/CmvB,eAAS1R,MAAT,CAAgBmoD,WAAW5lE,CAAX,CAAhB;AACD;AACDmvB,aAASpS,MAAT,CAAgB4oD,QAAhB;AACD;AACD,MAAIA,SAAS5uE,MAAT,GAAkB,CAAlB,IAAuB6uE,WAAW7uE,MAAX,GAAoB,CAA/C,EAAkD;AAChD,SAAKsmB,aAAL,CACE,IAAIqoD,WAAJ,CAAgBF,gBAAgBC,MAAhC,EACEE,QADF,EACYC,UADZ,EACwBl0C,eADxB,CADF;AAGD;AACD,SAAO,4BAAYA,eAAZ,CAAP;AACD;;AAGD;;;;;;;AAOAm0C,OAAO70D,SAAP,CAAiBi2D,eAAjB,GAAmC,UAASn4C,YAAT,EAAuB;AACxD,OAAKy3C,aAAL,GAAqBz3C,YAArB;AACD,CAFD;;AAKA;;;;;;;AAOA+2C,OAAO70D,SAAP,CAAiB4c,MAAjB,GAA0B,UAASt4B,GAAT,EAAc;AACtC,MAAM4xE,aAAa,KAAKngC,MAAL,EAAnB;AACA,MAAMogC,mBACF,KAAKV,eAAL,CAAqB5gC,SAArB,GAAiC+gC,qBAAjC,EADJ;AAEA,MAAIM,UAAJ,EAAgB;AACdC,qBAAiB3wE,OAAjB,CAAyB0wE,WAAW1xC,aAAX,CAAyBpoB,IAAzB,CAA8B85D,UAA9B,CAAzB;AACD;AACDxX,wBAAY1+C,SAAZ,CAAsB4c,MAAtB,CAA6Bvb,IAA7B,CAAkC,IAAlC,EAAwC/c,GAAxC;AACA,OAAKmxE,eAAL,CAAqB74C,MAArB,CAA4Bt4B,GAA5B;AACA,MAAIA,GAAJ,EAAS;AACP6xE,qBAAiB3wE,OAAjB,CAAyBlB,IAAI4/B,WAAJ,CAAgB9nB,IAAhB,CAAqB9X,GAArB,CAAzB;AACD;AACF,CAZD;;AAeA;;;AAGA,SAAS2hE,uBAAT,GAAmC;AACjC,MAAMl3C,SAAS,gCAAf;AACA,qBAAOA,OAAO2e,uBAAaogB,OAApB,CAAP,EAAqC/+B,OAAO2e,uBAAakgB,WAApB,CAArC;AACA,qBAAO7+B,OAAO2e,uBAAa6f,mBAApB,CAAP,EAAiDx+B,OAAO2e,uBAAakgB,WAApB,CAAjD;;AAEA,SAAO,UAASr5C,OAAT,EAAkB4a,UAAlB,EAA8B;AACnC,QAAI,CAAC5a,QAAQ8Z,WAAR,EAAL,EAA4B;AAC1B,aAAO,IAAP;AACD;AACD,WAAOU,OAAOxa,QAAQ8Z,WAAR,GAAsBnP,OAAtB,EAAP,CAAP;AACD,GALD;AAMD;;AAGD;;;;AAIA21D,OAAO70D,SAAP,CAAiBkuD,WAAjB,GAA+B,UAAShyB,GAAT,EAAc;AAC3C,MAAM53C,MAAM,KAAKyxC,MAAL,EAAZ;AACA,MAAIzxC,GAAJ,EAAS;AACPA,QAAI4/B,WAAJ,EAAgB,gCAAkCgY,IAAI/wB,OAAtD;AACD;AACF,CALD;;AAQA;;;;AAIA0pD,OAAO70D,SAAP,CAAiB2uD,cAAjB,GAAkC,UAASzyB,GAAT,EAAc;AAC9C,MAAM53C,MAAM,KAAKyxC,MAAL,EAAZ;AACA,MAAIzxC,GAAJ,EAAS;AACPA,QAAIkgC,aAAJ,EAAkB,gCAAkC0X,IAAI/wB,OAAxD;AACD;AACF,CALD;;AAQA;;;;AAIA0pD,OAAO70D,SAAP,CAAiBg2D,8BAAjB,GAAkD,UAASzhE,OAAT,EAAkB;AAClE,MAAMpG,MAAM,mBAAOoG,OAAP,CAAZ;AACA,SAAO,KAAKohE,wBAAL,CAA8BxnE,GAA9B,CAAP;AACD,CAHD;;kBAMe0mE,M;;;;;;;;;;;;;;;;;QC+HC/zC,W,GAAAA,W;;AAxmBhB;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;;;AAGA;;;;;;;AAQA;;;;;;AAOA;;;;;;;;;;AAWA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,IAAMs1C,OAAO,SAAPA,IAAO,CAAS9qD,WAAT,EAAsB;;AAEjCu1C,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5Byf,iBAAaA,WADe;AAE5BggC,qBAAiB9iC,eAFW;AAG5BgjC,mBAAeA;AAHa,GAA9B;;AAMA,MAAMn0D,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA;;;;AAIA,OAAKg0C,OAAL,GAAezyD,QAAQ5I,MAAR,GAAiB4I,QAAQ5I,MAAzB,GAAkC,IAAjD;;AAEA;;;;AAIA,OAAKoyE,OAAL,GAAexpE,QAAQ28D,MAAR,KAAmB9iE,SAAnB,GAA+BmG,QAAQ28D,MAAvC,GAAgD,IAA/D;;AAEA;;;;AAIA,OAAK8M,KAAL,GAAazpE,QAAQyrD,IAAR,KAAiB5xD,SAAjB,GAA6BmG,QAAQyrD,IAArC,GAA4C,IAAzD;;AAEA;;;;AAIA,OAAK0L,SAAL,GAAiBn3D,QAAQsxB,QAAR,GAAmBtxB,QAAQsxB,QAA3B,GAAsC,IAAvD;;AAEA;;;;AAIA,OAAKo4C,qBAAL,GAA6B,EAA7B;;AAEA;;;;AAIA,OAAKC,0BAAL,GAAkC,EAAlC;;AAEA;;;;;;AAMA,OAAKC,uBAAL,GAA+B,EAA/B;;AAEA;;;;;;;AAOA,OAAKC,gBAAL,GAAwB,EAAxB;;AAEA;;;;;AAKA,OAAKC,gBAAL,GAAwB,IAAxB;;AAEA;;;;AAIA,OAAKhO,eAAL,GAAuB97D,QAAQ+7D,cAAR,KAA2BliE,SAA3B,GACrBmG,QAAQ+7D,cADa,GACI,EAD3B;;AAGA;;;;AAIA,OAAKgO,eAAL,GAAuBvM,eAAejuD,IAAf,CAAoB,IAApB,CAAvB;;AAGA;;;;;AAKA,OAAK2wD,MAAL,GAAc,IAAIC,eAAJ,EAAd;;AAGA;;;;;AAKA,OAAKG,gBAAL,GAAwB;AACtB,aAAS,KAAKC,mBADQ;AAEtB,kBAAc,KAAKC,wBAFG;AAGtB,kBAAc,KAAKA,wBAHG;AAItB,eAAW,KAAKC,qBAJM;AAKtB,kBAAc,KAAKC,wBALG;AAMtB,uBAAmB,KAAKC,6BANF;AAOtB,oBAAgB,KAAKC,0BAPC;AAQtB,0BAAsB,KAAKE,gCARL;AAStB,cAAU,KAAKD;AATO,GAAxB;AAWD,CA5GD,C,CAtEA;;;;;AAoLA,qBAAS0I,IAAT,EAAevV,iBAAf;;AAGA;;;;;;;AAOAuV,KAAKp2D,SAAL,CAAemoD,UAAf,GAA4B,UAAS5zD,OAAT,EAAkBsiE,UAAlB,EAA8B;AACxD,MAAM1nE,WAAW0nE,eAAenwE,SAAf,GAA2BmwE,UAA3B,GAAwC,IAAzD;AACA,MAAMC,cAAc,mBAAOviE,OAAP,CAApB;AACA,MAAMuZ,WAAWvZ,QAAQ8Z,WAAR,EAAjB;AACA,MAAIP,QAAJ,EAAc;AACZ,QAAMipD,gBAAgB,KAAK5J,gBAAL,CAAsBr/C,SAAS5O,OAAT,EAAtB,CAAtB;AACA,QAAI63D,aAAJ,EAAmB;AACjB,WAAKN,uBAAL,CAA6BK,WAA7B,IAA4ChpD,SAAS0B,SAAT,CAAmB,0BAAnB,CAA5C;AACAunD,oBAAc11D,IAAd,CAAmB,IAAnB,EAAyB9M,OAAzB,EAAkCuZ,QAAlC;AACD;AACF;;AAED,MAAI3e,QAAJ,EAAc;AACZ,SAAKqnE,0BAAL,CAAgCM,WAAhC,IAA+C,oBAC7CviE,OAD6C,EAE7Cqa,oBAAUC,MAFmC,EAG7C,KAAK4/C,oBAHwC,EAGlB,IAHkB,CAA/C;AAID;AACF,CAlBD;;AAqBA;;;;AAIA2H,KAAKp2D,SAAL,CAAeg3D,kBAAf,GAAoC,UAASziE,OAAT,EAAkB;AACpD,OAAK4zD,UAAL,CAAgB5zD,OAAhB;AACD,CAFD;;AAKA;;;;AAIA6hE,KAAKp2D,SAAL,CAAei3D,qBAAf,GAAuC,UAAS1iE,OAAT,EAAkB;AACvD,OAAKs6D,aAAL,CAAmBt6D,OAAnB;AACD,CAFD;;AAKA;;;;AAIA6hE,KAAKp2D,SAAL,CAAek3D,YAAf,GAA8B,YAAW;AACvC,MAAI/4C,iBAAJ;AACA,MAAI,KAAK6lC,SAAT,EAAoB;AAClB7lC,eAAW,KAAK6lC,SAAhB;AACD,GAFD,MAEO,IAAI,KAAK1E,OAAT,EAAkB;AACvBnhC,eAAW,KAAKmhC,OAAL,CAAasO,WAAb,EAAX;AACD;AACD;AACE,uFAAqFzvC;AADvF;AAGD,CAVD;;AAaA;;;;AAIAi4C,KAAKp2D,SAAL,CAAemuD,iBAAf,GAAmC,UAASjyB,GAAT,EAAc;AAC/C,MAAI3nC,gBAAJ;AACA,MAAI2nC,eAAei7B,yBAAnB,EAAsC;AACpC5iE,cAAU2nC,IAAI3nC,OAAd;AACD,GAFD,MAEO,IAAI2nC,eAAelxB,2BAAnB,EAAoC;AACzCzW,cAAU2nC,IAAI/wB,OAAd;AACD;AACD,OAAKg9C,UAAL,EAAgB,gCAAkC5zD,OAAlD;AACD,CARD;;AAWA;;;;AAIA6hE,KAAKp2D,SAAL,CAAeouD,oBAAf,GAAsC,UAASlyB,GAAT,EAAc;AAClD,MAAI3nC,gBAAJ;AACA,MAAI2nC,eAAei7B,yBAAnB,EAAsC;AACpC5iE,cAAU2nC,IAAI3nC,OAAd;AACD,GAFD,MAEO,IAAI2nC,eAAelxB,2BAAnB,EAAoC;AACzCzW,cAAU2nC,IAAI/wB,OAAd;AACD;AACD,OAAK0jD,aAAL,EAAmB,gCAAkCt6D,OAArD;AACD,CARD;;AAWA;;;;AAIA6hE,KAAKp2D,SAAL,CAAeyuD,oBAAf,GAAsC,UAASvyB,GAAT,EAAc;AAClD,MAAM3nC,UAAU,gCAAkC2nC,IAAI13C,MAAtD;AACA,MAAI,KAAK89D,sBAAT,EAAiC;AAC/B,QAAM0N,MAAM,mBAAOz7D,OAAP,CAAZ;AACA,QAAI,EAAEy7D,OAAO,KAAK0G,gBAAd,CAAJ,EAAqC;AACnC,WAAKA,gBAAL,CAAsB1G,GAAtB,IAA6Bz7D,OAA7B;AACD;AACF,GALD,MAKO;AACL,SAAK6iE,cAAL,CAAoB7iE,OAApB;AACD;AACF,CAVD;;AAaA;;;;;;;AAOA6hE,KAAKp2D,SAAL,CAAe6uD,aAAf,GAA+B,UAASt6D,OAAT,EAAkB8iE,YAAlB,EAAgC;AAC7D,MAAMC,aAAaD,iBAAiB3wE,SAAjB,GAA6B2wE,YAA7B,GAA4C,IAA/D;AACA,MAAMP,cAAc,mBAAOviE,OAAP,CAApB;AACA,MAAM2a,SAAS,KAAKunD,uBAAL,CAA6BK,WAA7B,CAAf;AACA,MAAI5nD,MAAJ,EAAY;AACV,QAAM4/C,QAAQ,KAAK/B,MAAnB;AACA,QAAMgC,gBAAgB,EAAtB;AACAD,UAAM4C,eAAN,CAAsBxiD,MAAtB,EAA8B,UAASksB,IAAT,EAAe;AAC3C,UAAI7mC,YAAY6mC,KAAK7mC,OAArB,EAA8B;AAC5Bw6D,sBAAcjnE,IAAd,CAAmBszC,IAAnB;AACD;AACF,KAJD;AAKA,SAAK,IAAIt1C,IAAIipE,cAAchpE,MAAd,GAAuB,CAApC,EAAuCD,KAAK,CAA5C,EAA+C,EAAEA,CAAjD,EAAoD;AAClDgpE,YAAMriD,MAAN,CAAasiD,cAAcjpE,CAAd,CAAb;AACD;AACF;;AAED,MAAIwxE,UAAJ,EAAgB;AACd,+BAAc,KAAKd,0BAAL,CAAgCM,WAAhC,CAAd;AACA,WAAO,KAAKN,0BAAL,CAAgCM,WAAhC,CAAP;AACD;AACF,CArBD;;AAwBA;;;AAGAV,KAAKp2D,SAAL,CAAe4c,MAAf,GAAwB,UAASt4B,GAAT,EAAc;AACpC,MAAM4xE,aAAa,KAAKngC,MAAL,EAAnB;AACA,MAAMtiC,OAAO,KAAK8iE,qBAAlB;AACA,MAAMp4C,WAAW,KAAK+4C,YAAL,EAAjB;;AAEA,MAAIhB,UAAJ,EAAgB;AACdziE,SAAKjO,OAAL,CAAa4wB,qBAAb;AACA3iB,SAAK1N,MAAL,GAAc,CAAd;AACAo4B,aAAS34B,OAAT,CAAiB,KAAKyxE,qBAAL,CAA2B76D,IAA3B,CAAgC,IAAhC,CAAjB;AACD;AACDykD,oBAAmB7gD,SAAnB,CAA6B4c,MAA7B,CAAoCvb,IAApC,CAAyC,IAAzC,EAA+C/c,GAA/C;;AAEA,MAAIA,GAAJ,EAAS;AACP,QAAI,KAAK0/D,SAAT,EAAoB;AAClBvwD,WAAK3L,IAAL,CACE,oBAAO,KAAKk8D,SAAZ,EAAuB13C,8BAAoBC,GAA3C,EACE,KAAK4hD,iBADP,EAC0B,IAD1B,CADF,EAGE,oBAAO,KAAKnK,SAAZ,EAAuB13C,8BAAoBK,MAA3C,EACE,KAAKyhD,oBADP,EAC6B,IAD7B,CAHF;AAMD,KAPD,MAOO,IAAI,KAAK9O,OAAT,EAAkB;AACvB7rD,WAAK3L,IAAL,CACE,oBAAO,KAAKw3D,OAAZ,EAAqBuO,0BAAgBC,UAArC,EACE,KAAKK,iBADP,EAC0B,IAD1B,CADF,EAGE,oBAAO,KAAK7O,OAAZ,EAAqBuO,0BAAgBG,aAArC,EACE,KAAKI,oBADP,EAC6B,IAD7B,CAHF;AAMD;AACDjwC,aAAS34B,OAAT,CAAiB,KAAKwxE,kBAAL,CAAwB56D,IAAxB,CAA6B,IAA7B,CAAjB;AACD;AACF,CA9BD;;AAiCA;;;AAGAg6D,KAAKp2D,SAAL,CAAeuiD,eAAf,GAAiC1jB,gBAAjC;;AAGA;;;;;;AAMAu3B,KAAKp2D,SAAL,CAAeu3D,MAAf,GAAwB,UAASlkD,KAAT,EAAgB02C,eAAhB,EAAiCzlE,GAAjC,EAAsC;;AAE5D,MAAMkzE,YAAYlzE,IAAIkvB,sBAAJ,CAChB,CAACH,MAAM,CAAN,IAAW,KAAKs1C,eAAjB,EAAkCt1C,MAAM,CAAN,IAAW,KAAKs1C,eAAlD,CADgB,CAAlB;AAEA,MAAM8O,aAAanzE,IAAIkvB,sBAAJ,CACjB,CAACH,MAAM,CAAN,IAAW,KAAKs1C,eAAjB,EAAkCt1C,MAAM,CAAN,IAAW,KAAKs1C,eAAlD,CADiB,CAAnB;AAEA,MAAM8H,MAAM,4BAAe,CAAC+G,SAAD,EAAYC,UAAZ,CAAf,CAAZ;;AAEA,MAAInN,WAAW,KAAKyC,MAAL,CAAY8C,WAAZ,CAAwBY,GAAxB,CAAf;;AAEA;AACA,MAAI,KAAK4F,OAAL,IAAgB,CAAC,KAAKC,KAA1B,EAAiC;AAC/BhM,eAAWA,SAAS/iE,MAAT,CAAgB,UAASqxC,OAAT,EAAkB;AAC3C,aAAOA,QAAQrkC,OAAR,CAAgB8Z,WAAhB,GAA8BnP,OAA9B,OACHwuB,uBAAaC,MADjB;AAED,KAHU,CAAX;AAID;;AAED,MAAI+pC,kBAAkB,KAAtB;AACA,MAAIC,UAAU,KAAd;AACA,MAAInO,SAAS,IAAb;AACA,MAAIgB,cAAc,IAAlB;AACA,MAAIK,aAAJ;AAAA,MAAUJ,eAAV;AAAA,MAAkBC,eAAlB;AAAA,MAA0BC,qBAA1B;AAAA,MAAwCC,qBAAxC;AACA,MAAIN,SAASvkE,MAAT,GAAkB,CAAtB,EAAyB;AACvB,SAAK4wE,gBAAL,GAAwB5M,eAAxB;AACAO,aAAS52D,IAAT,CAAc,KAAKkjE,eAAnB;AACA,QAAMrM,iBAAiBD,SAAS,CAAT,EAAY1xB,OAAnC;AACA,QAAMg/B,WAAWtN,SAAS,CAAT,EAAY/1D,OAAZ,CAAoB8Z,WAApB,GAAkCnP,OAAlC,OACbwuB,uBAAaC,MADjB;AAEA,QAAI,KAAK0oC,OAAL,IAAgB,CAAC,KAAKC,KAA1B,EAAiC;AAC/B7L,eAASnmE,IAAIk7B,sBAAJ,CAA2B+qC,eAAe,CAAf,CAA3B,CAAT;AACAG,eAASpmE,IAAIk7B,sBAAJ,CAA2B+qC,eAAe,CAAf,CAA3B,CAAT;AACAI,qBAAe,iCAA0Bt3C,KAA1B,EAAiCo3C,MAAjC,CAAf;AACAG,qBAAe,iCAA0Bv3C,KAA1B,EAAiCq3C,MAAjC,CAAf;AACAG,aAAOhhE,KAAKsG,IAAL,CAAUtG,KAAKiH,GAAL,CAAS65D,YAAT,EAAuBC,YAAvB,CAAV,CAAP;AACA8M,wBAAkB7M,QAAQ,KAAKlC,eAA/B;AACA,UAAI+O,eAAJ,EAAqB;AACnBC,kBAAU,IAAV;AACAnO,iBAASmB,eAAeC,YAAf,GAA8BL,eAAe,CAAf,CAA9B,GAAkDA,eAAe,CAAf,CAA3D;AACAC,sBAAclmE,IAAIk7B,sBAAJ,CAA2BgqC,MAA3B,CAAd;AACD;AACF,KAZD,MAYO,IAAI,KAAK8M,KAAT,EAAgB;AACrB,UAAIsB,QAAJ,EAAc;AACZpO,iBAAS,iCAAgBO,eAAhB;AACP,4CAAsCO,SAAS,CAAT,EAAY/1D,OAAZ,CAAoB8Z,WAApB,EAD/B,CAAT;AAED,OAHD,MAGO;AACLm7C,iBAAS,kCAAiBO,eAAjB,EAAkCQ,cAAlC,CAAT;AACD;AACDC,oBAAclmE,IAAIk7B,sBAAJ,CAA2BgqC,MAA3B,CAAd;AACA,UAAI,0BAAmBn2C,KAAnB,EAA0Bm3C,WAA1B,KAA0C,KAAK7B,eAAnD,EAAoE;AAClEgP,kBAAU,IAAV;AACA,YAAI,KAAKtB,OAAL,IAAgB,CAACuB,QAArB,EAA+B;AAC7BnN,mBAASnmE,IAAIk7B,sBAAJ,CAA2B+qC,eAAe,CAAf,CAA3B,CAAT;AACAG,mBAASpmE,IAAIk7B,sBAAJ,CAA2B+qC,eAAe,CAAf,CAA3B,CAAT;AACAI,yBAAe,iCAA0BH,WAA1B,EAAuCC,MAAvC,CAAf;AACAG,yBAAe,iCAA0BJ,WAA1B,EAAuCE,MAAvC,CAAf;AACAG,iBAAOhhE,KAAKsG,IAAL,CAAUtG,KAAKiH,GAAL,CAAS65D,YAAT,EAAuBC,YAAvB,CAAV,CAAP;AACA8M,4BAAkB7M,QAAQ,KAAKlC,eAA/B;AACA,cAAI+O,eAAJ,EAAqB;AACnBlO,qBAASmB,eAAeC,YAAf,GAA8BL,eAAe,CAAf,CAA9B,GAAkDA,eAAe,CAAf,CAA3D;AACAC,0BAAclmE,IAAIk7B,sBAAJ,CAA2BgqC,MAA3B,CAAd;AACD;AACF;AACF;AACF;AACD,QAAImO,OAAJ,EAAa;AACXnN,oBAAc,CAAC3gE,KAAKoH,KAAL,CAAWu5D,YAAY,CAAZ,CAAX,CAAD,EAA6B3gE,KAAKoH,KAAL,CAAWu5D,YAAY,CAAZ,CAAX,CAA7B,CAAd;AACD;AACF;AACD;AACE,oDAAkD;AAChDmN,eAASA,OADuC;AAEhDnO,cAAQA,MAFwC;AAGhDgB,mBAAaA;AAHmC;AADpD;AAOD,CA5ED;;AA+EA;;;;AAIA4L,KAAKp2D,SAAL,CAAeo3D,cAAf,GAAgC,UAAS7iE,OAAT,EAAkB;AAChD,OAAKs6D,aAAL,CAAmBt6D,OAAnB,EAA4B,KAA5B;AACA,OAAK4zD,UAAL,CAAgB5zD,OAAhB,EAAyB,KAAzB;AACD,CAHD;;AAMA;;;;;AAKA6hE,KAAKp2D,SAAL,CAAe0tD,oBAAf,GAAsC,UAASn5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AAChE,MAAMkjC,UAAU,yBAAWljC,QAAX,CAAhB;AACA,MAAM4zB,cAAcsP,QAAQvI,cAAR,GAAyB,CAAzB,CAApB;AACA,OAAK,IAAI3iD,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAZ,GAAqB,CAA1C,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxD,QAAM8yC,UAAU8I,YAAY/7C,KAAZ,CAAkBG,CAAlB,EAAqBA,IAAI,CAAzB,CAAhB;AACA,QAAMkpE,cAAc,qDAAuD;AACzEz6D,eAASA,OADgE;AAEzEqkC,eAASA;AAFgE,KAA3E;AAIA,SAAKm0B,MAAL,CAAYkC,MAAZ,CAAmB,4BAAer2B,OAAf,CAAnB,EAA4Co2B,WAA5C;AACD;AACF,CAXD;;AAcA;;;;;AAKAoH,KAAKp2D,SAAL,CAAe2tD,gCAAf,GAAkD,UAASp5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AAC5E,MAAMi6B,aAAaj6B,SAAS06B,kBAAT,EAAnB;AACA,OAAK,IAAI1iD,IAAI,CAAb,EAAgBA,IAAIiiD,WAAWhiD,MAA/B,EAAuC,EAAED,CAAzC,EAA4C;AAC1C,QAAMixE,gBAAgB,KAAK5J,gBAAL,CAAsBplB,WAAWjiD,CAAX,EAAcoZ,OAAd,EAAtB,CAAtB;AACA,QAAI63D,aAAJ,EAAmB;AACjBA,oBAAc11D,IAAd,CAAmB,IAAnB,EAAyB9M,OAAzB,EAAkCwzC,WAAWjiD,CAAX,CAAlC;AACD;AACF;AACF,CARD;;AAWA;;;;;AAKAswE,KAAKp2D,SAAL,CAAeqtD,wBAAf,GAA0C,UAAS94D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACpE,MAAM4zB,cAAc5zB,SAAS26B,cAAT,EAApB;AACA,OAAK,IAAI3iD,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAZ,GAAqB,CAA1C,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxD,QAAM8yC,UAAU8I,YAAY/7C,KAAZ,CAAkBG,CAAlB,EAAqBA,IAAI,CAAzB,CAAhB;AACA,QAAMkpE,cAAc,qDAAuD;AACzEz6D,eAASA,OADgE;AAEzEqkC,eAASA;AAFgE,KAA3E;AAIA,SAAKm0B,MAAL,CAAYkC,MAAZ,CAAmB,4BAAer2B,OAAf,CAAnB,EAA4Co2B,WAA5C;AACD;AACF,CAVD;;AAaA;;;;;AAKAoH,KAAKp2D,SAAL,CAAewtD,6BAAf,GAA+C,UAASj5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACzE,MAAMqhD,QAAQrhD,SAAS26B,cAAT,EAAd;AACA,OAAK,IAAIz5C,IAAI,CAAR,EAAW27B,KAAKwkC,MAAMppE,MAA3B,EAAmCiJ,IAAI27B,EAAvC,EAA2C,EAAE37B,CAA7C,EAAgD;AAC9C,QAAM0yC,cAAcytB,MAAMngE,CAAN,CAApB;AACA,SAAK,IAAIlJ,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAZ,GAAqB,CAA1C,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxD,UAAM8yC,UAAU8I,YAAY/7C,KAAZ,CAAkBG,CAAlB,EAAqBA,IAAI,CAAzB,CAAhB;AACA,UAAMkpE,cAAc,qDAAuD;AACzEz6D,iBAASA,OADgE;AAEzEqkC,iBAASA;AAFgE,OAA3E;AAIA,WAAKm0B,MAAL,CAAYkC,MAAZ,CAAmB,4BAAer2B,OAAf,CAAnB,EAA4Co2B,WAA5C;AACD;AACF;AACF,CAbD;;AAgBA;;;;;AAKAoH,KAAKp2D,SAAL,CAAeutD,wBAAf,GAA0C,UAASh5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACpE,MAAM2iC,SAAS3iC,SAAS26B,cAAT,EAAf;AACA,OAAK,IAAI3iD,IAAI,CAAR,EAAWwkB,KAAKmmC,OAAO1qD,MAA5B,EAAoCD,IAAIwkB,EAAxC,EAA4C,EAAExkB,CAA9C,EAAiD;AAC/C,QAAM47C,cAAc+O,OAAO3qD,CAAP,CAApB;AACA,QAAMkpE,cAAc,qDAAuD;AACzEz6D,eAASA,OADgE;AAEzEqkC,eAAS,CAAC8I,WAAD,EAAcA,WAAd;AAFgE,KAA3E;AAIA,SAAKqrB,MAAL,CAAYkC,MAAZ,CAAmBnhD,SAAS0B,SAAT,EAAnB,EAAyCw/C,WAAzC;AACD;AACF,CAVD;;AAaA;;;;;AAKAoH,KAAKp2D,SAAL,CAAeytD,0BAAf,GAA4C,UAASl5D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACtE,MAAMkkC,WAAWlkC,SAAS26B,cAAT,EAAjB;AACA,OAAK,IAAInjD,IAAI,CAAR,EAAW8pE,KAAKpd,SAASjsD,MAA9B,EAAsCT,IAAI8pE,EAA1C,EAA8C,EAAE9pE,CAAhD,EAAmD;AACjD,QAAMk9C,QAAQwP,SAAS1sD,CAAT,CAAd;AACA,SAAK,IAAI0J,IAAI,CAAR,EAAW27B,KAAK6X,MAAMz8C,MAA3B,EAAmCiJ,IAAI27B,EAAvC,EAA2C,EAAE37B,CAA7C,EAAgD;AAC9C,UAAM0yC,cAAcc,MAAMxzC,CAAN,CAApB;AACA,WAAK,IAAIlJ,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAZ,GAAqB,CAA1C,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxD,YAAM8yC,UAAU8I,YAAY/7C,KAAZ,CAAkBG,CAAlB,EAAqBA,IAAI,CAAzB,CAAhB;AACA,YAAMkpE,cAAc,qDAAuD;AACzEz6D,mBAASA,OADgE;AAEzEqkC,mBAASA;AAFgE,SAA3E;AAIA,aAAKm0B,MAAL,CAAYkC,MAAZ,CAAmB,4BAAer2B,OAAf,CAAnB,EAA4Co2B,WAA5C;AACD;AACF;AACF;AACF,CAhBD;;AAmBA;;;;;AAKAoH,KAAKp2D,SAAL,CAAeotD,mBAAf,GAAqC,UAAS74D,OAAT,EAAkBuZ,QAAlB,EAA4B;AAC/D,MAAM4zB,cAAc5zB,SAAS26B,cAAT,EAApB;AACA,MAAMumB,cAAc,qDAAuD;AACzEz6D,aAASA,OADgE;AAEzEqkC,aAAS,CAAC8I,WAAD,EAAcA,WAAd;AAFgE,GAA3E;AAIA,OAAKqrB,MAAL,CAAYkC,MAAZ,CAAmBnhD,SAAS0B,SAAT,EAAnB,EAAyCw/C,WAAzC;AACD,CAPD;;AAUA;;;;;AAKAoH,KAAKp2D,SAAL,CAAestD,qBAAf,GAAuC,UAAS/4D,OAAT,EAAkBuZ,QAAlB,EAA4B;AACjE,MAAM00B,QAAQ10B,SAAS26B,cAAT,EAAd;AACA,OAAK,IAAIz5C,IAAI,CAAR,EAAW27B,KAAK6X,MAAMz8C,MAA3B,EAAmCiJ,IAAI27B,EAAvC,EAA2C,EAAE37B,CAA7C,EAAgD;AAC9C,QAAM0yC,cAAcc,MAAMxzC,CAAN,CAApB;AACA,SAAK,IAAIlJ,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAZ,GAAqB,CAA1C,EAA6CD,IAAIwkB,EAAjD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxD,UAAM8yC,UAAU8I,YAAY/7C,KAAZ,CAAkBG,CAAlB,EAAqBA,IAAI,CAAzB,CAAhB;AACA,UAAMkpE,cAAc,qDAAuD;AACzEz6D,iBAASA,OADgE;AAEzEqkC,iBAASA;AAFgE,OAA3E;AAIA,WAAKm0B,MAAL,CAAYkC,MAAZ,CAAmB,4BAAer2B,OAAf,CAAnB,EAA4Co2B,WAA5C;AACD;AACF;AACF,CAbD;;AAgBA;;;;;;AAMO,SAASluC,WAAT,CAAqBob,GAArB,EAA0B;AAC/B,MAAM72C,SAAS,KAAKkyE,MAAL,CAAYr7B,IAAI7oB,KAAhB,EAAuB6oB,IAAI3oB,UAA3B,EAAuC2oB,IAAI53C,GAA3C,CAAf;AACA,MAAIe,OAAOsyE,OAAX,EAAoB;AAClBz7B,QAAI3oB,UAAJ,GAAiBluB,OAAOmkE,MAAP,CAAc7jE,KAAd,CAAoB,CAApB,EAAuB,CAAvB,CAAjB;AACAu2C,QAAI7oB,KAAJ,GAAYhuB,OAAOmlE,WAAnB;AACD;AACD,SAAO3D,qBAAmBxlD,IAAnB,CAAwB,IAAxB,EAA8B66B,GAA9B,CAAP;AACD;;AAGD;;;;;AAKA,SAAS8kB,aAAT,CAAuB9kB,GAAvB,EAA4B;AAC1B,MAAM27B,mBAAmB,oBAAU,KAAKnB,gBAAf,CAAzB;AACA,MAAImB,iBAAiB9xE,MAArB,EAA6B;AAC3B8xE,qBAAiBryE,OAAjB,CAAyB,KAAK4xE,cAAL,CAAoBh7D,IAApB,CAAyB,IAAzB,CAAzB;AACA,SAAKs6D,gBAAL,GAAwB,EAAxB;AACD;AACD,SAAO,KAAP;AACD;;AAGD;;;;;;;AAOA,SAASrM,cAAT,CAAwBr8D,CAAxB,EAA2BD,CAA3B,EAA8B;AAC5B,MAAM+pE,SAAS,0CAAyB,KAAKnB,gBAA9B,EAAgD3oE,EAAE4qC,OAAlD,CAAf;AACA,MAAMm/B,SAAS,0CAAyB,KAAKpB,gBAA9B,EAAgD5oE,EAAE6qC,OAAlD,CAAf;AACA,SAAOk/B,SAASC,MAAhB;AACD;;kBAEc3B,I;;;;;;;;;;;;;;;;;;;AC9oBf;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;;;AAGA;;;AAGA,IAAM4B,qBAAqB;AACzB;;;;;AAKAC,kBAAgB,gBANS;AAOzB;;;;;AAKAC,eAAa,aAZY;AAazB;;;;;AAKAC,gBAAc;AAlBW,CAA3B;;AAsBA;;;;;;;;;;;;;;AAeA;;;;;;;;;;;AAtDA;;;AAiEO,IAAMC,0CAAiB,SAAjBA,cAAiB,CAAShyE,IAAT,EAAe+3B,QAAf,EAAyB5K,UAAzB,EAAqC;;AAEjErI,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAK+3B,QAAL,GAAgBA,QAAhB;;AAEA;;;;;;AAMA,OAAK5K,UAAL,GAAkBA,UAAlB;AACD,CAlBM;;AAoBP,qBAAS6kD,cAAT,EAAyBltD,eAAzB;;AAGA;;;;;;;;;;AAUA,IAAMmtD,YAAY,SAAZA,SAAY,CAAS/sD,WAAT,EAAsB;AACtCu1C,oBAAmBx/C,IAAnB,CAAwB,IAAxB,EAA8B;AAC5By/C,qBAAiBA,eADW;AAE5BC,qBAAiBA,eAFW;AAG5B+S,qBAAiBA,eAHW;AAI5B9S,mBAAeA;AAJa,GAA9B;;AAOA,MAAMn0D,UAAUye,cAAcA,WAAd,GAA4B,EAA5C;;AAEA;;;;;AAKA,OAAKgtD,eAAL,GAAuB,IAAvB;;AAGA;;;;AAIA,OAAKtU,SAAL,GAAiBn3D,QAAQsxB,QAAR,KAAqBz3B,SAArB,GAAiCmG,QAAQsxB,QAAzC,GAAoD,IAArE;;AAEA;AACA,MAAIJ,oBAAJ;AACA,MAAIlxB,QAAQnH,MAAZ,EAAoB;AAClB,QAAI,OAAOmH,QAAQnH,MAAf,KAA0B,UAA9B,EAA0C;AACxCq4B,oBAAclxB,QAAQnH,MAAtB;AACD,KAFD,MAEO;AACL,UAAMA,SAASmH,QAAQnH,MAAvB;AACAq4B,oBAAc,qBAASj6B,KAAT,EAAgB;AAC5B,eAAO,qBAAS4B,MAAT,EAAiB5B,KAAjB,CAAP;AACD,OAFD;AAGD;AACF,GATD,MASO;AACLi6B,kBAAcC,eAAd;AACD;;AAED;;;;AAIA,OAAK03C,YAAL,GAAoB33C,WAApB;;AAEA;;;;AAIA,OAAKw3C,aAAL,GAAqB1oE,QAAQixB,YAAR,GAAuBjxB,QAAQixB,YAA/B,GAA8C,CAAnE;;AAEA;;;;AAIA,OAAKy6C,YAAL,GAAoB,IAApB;;AAEA,sBAAO,IAAP,EACE,gCAAmBjS,mBAAoBC,MAAvC,CADF,EAEE,KAAKiS,oBAFP,EAE6B,IAF7B;AAID,CA7DD;;AA+DA,qBAASH,SAAT,EAAoBxX,iBAApB;;AAGA;;;;;AAKA,SAASC,eAAT,CAAyBjrC,KAAzB,EAAgC;AAC9B,OAAK0iD,YAAL,GAAoB,KAAKE,gBAAL,CAAsB5iD,MAAMxC,KAA5B,EAAmCwC,MAAMvxB,GAAzC,CAApB;AACA,MAAI,CAAC,KAAKg0E,eAAN,IAAyB,KAAKC,YAAlC,EAAgD;AAC9C,SAAKD,eAAL,GAAuBziD,MAAMtC,UAA7B;AACAugD,oBAAgBzyD,IAAhB,CAAqB,IAArB,EAA2BwU,KAA3B;;AAEA,QAAMsI,WAAW,KAAK6lC,SAAL,IAAkB,IAAI54C,oBAAJ,CAAe,CAAC,KAAKmtD,YAAN,CAAf,CAAnC;;AAEA,SAAKlsD,aAAL,CACE,IAAI+rD,cAAJ,CACEJ,mBAAmBC,cADrB,EACqC95C,QADrC,EAEEtI,MAAMtC,UAFR,CADF;AAIA,WAAO,IAAP;AACD;AACD,SAAO,KAAP;AACD;;AAGD;;;;;AAKA,SAASytC,aAAT,CAAuBnrC,KAAvB,EAA8B;AAC5B,MAAI,KAAKyiD,eAAT,EAA0B;AACxB,SAAKA,eAAL,GAAuB,IAAvB;AACAxE,oBAAgBzyD,IAAhB,CAAqB,IAArB,EAA2BwU,KAA3B;;AAEA,QAAMsI,WAAW,KAAK6lC,SAAL,IAAkB,IAAI54C,oBAAJ,CAAe,CAAC,KAAKmtD,YAAN,CAAf,CAAnC;;AAEA,SAAKlsD,aAAL,CACE,IAAI+rD,cAAJ,CACEJ,mBAAmBG,YADrB,EACmCh6C,QADnC,EAEEtI,MAAMtC,UAFR,CADF;AAIA,WAAO,IAAP;AACD;AACD,SAAO,KAAP;AACD;;AAGD;;;;AAIA,SAASwtC,eAAT,CAAyBlrC,KAAzB,EAAgC;AAC9B,MAAI,KAAKyiD,eAAT,EAA0B;AACxB,QAAMI,gBAAgB7iD,MAAMtC,UAA5B;AACA,QAAM+M,SAASo4C,cAAc,CAAd,IAAmB,KAAKJ,eAAL,CAAqB,CAArB,CAAlC;AACA,QAAM93C,SAASk4C,cAAc,CAAd,IAAmB,KAAKJ,eAAL,CAAqB,CAArB,CAAlC;;AAEA,QAAMn6C,WAAW,KAAK6lC,SAAL,IAAkB,IAAI54C,oBAAJ,CAAe,CAAC,KAAKmtD,YAAN,CAAf,CAAnC;;AAEAp6C,aAAS34B,OAAT,CAAiB,UAAS+O,OAAT,EAAkB;AACjC,UAAMokE,OAAOpkE,QAAQ8Z,WAAR,EAAb;AACAsqD,WAAK3sB,SAAL,CAAe1rB,MAAf,EAAuBE,MAAvB;AACAjsB,cAAQwZ,WAAR,CAAoB4qD,IAApB;AACD,KAJD;;AAMA,SAAKL,eAAL,GAAuBI,aAAvB;AACA,SAAKrsD,aAAL,CACE,IAAI+rD,cAAJ,CACEJ,mBAAmBE,WADrB,EACkC/5C,QADlC,EAEEu6C,aAFF,CADF;AAID;AACF;;AAGD;;;;AAIA,SAAS5E,eAAT,CAAyBj+C,KAAzB,EAAgC;AAC9B,MAAM1J,OAAO0J,MAAMvxB,GAAN,CAAU+vB,WAAV,EAAb;;AAEA;AACA;AACA,MAAI,KAAKokD,gBAAL,CAAsB5iD,MAAMxC,KAA5B,EAAmCwC,MAAMvxB,GAAzC,CAAJ,EAAmD;AACjD6nB,SAAKopB,SAAL,CAAe9oB,MAAf,CAAsB,KAAK6rD,eAAL,GAAuB,SAAvB,GAAmC,aAAzD;AACAnsD,SAAKopB,SAAL,CAAeU,GAAf,CAAmB,KAAKqiC,eAAL,GAAuB,aAAvB,GAAuC,SAA1D;AACD,GAHD,MAGO;AACLnsD,SAAKopB,SAAL,CAAe9oB,MAAf,CAAsB,SAAtB,EAAiC,aAAjC;AACD;AACF;;AAGD;;;;;;;;;AASA4rD,UAAUr4D,SAAV,CAAoBy4D,gBAApB,GAAuC,UAASplD,KAAT,EAAgB/uB,GAAhB,EAAqB;AAC1D,SAAOA,IAAIs5B,qBAAJ,CAA0BvK,KAA1B,EACL,UAAS9e,OAAT,EAAkB;AAChB,QAAI,CAAC,KAAKyvD,SAAN,IAAmB,qBAAS,KAAKA,SAAL,CAAe/3C,QAAf,EAAT,EAAoC1X,OAApC,CAAvB,EAAqE;AACnE,aAAOA,OAAP;AACD;AACF,GAJD,CAIE6H,IAJF,CAIO,IAJP,CADK,EAKS;AACZ2hB,iBAAa,KAAK23C,YADN;AAEZ53C,kBAAc,KAAKy3C;AAFP,GALT,CAAP;AASD,CAVD;;AAaA;;;;;AAKA8C,UAAUr4D,SAAV,CAAoB81D,eAApB,GAAsC,YAAW;AAC/C,SAAO,KAAKP,aAAZ;AACD,CAFD;;AAKA;;;;;;;AAOA8C,UAAUr4D,SAAV,CAAoBi2D,eAApB,GAAsC,UAASn4C,YAAT,EAAuB;AAC3D,OAAKy3C,aAAL,GAAqBz3C,YAArB;AACD,CAFD;;AAKA;;;AAGAu6C,UAAUr4D,SAAV,CAAoB4c,MAApB,GAA6B,UAASt4B,GAAT,EAAc;AACzC,MAAMs0E,SAAS,KAAK7iC,MAAL,EAAf;AACA8qB,oBAAmB7gD,SAAnB,CAA6B4c,MAA7B,CAAoCvb,IAApC,CAAyC,IAAzC,EAA+C/c,GAA/C;AACA,OAAKkiE,YAAL,CAAkBoS,MAAlB;AACD,CAJD;;AAOA;;;AAGAP,UAAUr4D,SAAV,CAAoBw4D,oBAApB,GAA2C,YAAW;AACpD,OAAKhS,YAAL,CAAkB,IAAlB;AACD,CAFD;;AAKA;;;;AAIA6R,UAAUr4D,SAAV,CAAoBwmD,YAApB,GAAmC,UAASoS,MAAT,EAAiB;AAClD,MAAIt0E,MAAM,KAAKyxC,MAAL,EAAV;AACA,MAAMsqB,SAAS,KAAKz/B,SAAL,EAAf;AACA,MAAI,CAACt8B,GAAD,IAAQ,CAAC+7D,MAAb,EAAqB;AACnB/7D,UAAMA,OAAOs0E,MAAb;AACA,QAAIt0E,GAAJ,EAAS;AACP,UAAM6nB,OAAO7nB,IAAI+vB,WAAJ,EAAb;AACAlI,WAAKopB,SAAL,CAAe9oB,MAAf,CAAsB,SAAtB,EAAiC,aAAjC;AACD;AACF;AACF,CAVD;;kBAae4rD,S;;;;;;;;;;;;;;;;;;AC1Uf;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAGA;;;;;;;;;;;;;;AAeA;;;;;;;;;;;;;;AAcA,IAAMQ,YAAY,SAAZA,SAAY,CAAShsE,OAAT,EAAkB;;AAElC0e,mBAAWlK,IAAX,CAAgB,IAAhB;;AAEA;;;AAGA,MAAM7R,aAAa,iBAAO,EAAP,EAAW3C,OAAX,CAAnB;AACA2C,aAAWspE,mBAAcC,OAAzB,IACIlsE,QAAQmsE,OAAR,KAAoBtyE,SAApB,GAAgCmG,QAAQmsE,OAAxC,GAAkD,CADtD;AAEAxpE,aAAWspE,mBAAcG,OAAzB,IACIpsE,QAAQuoC,OAAR,KAAoB1uC,SAApB,GAAgCmG,QAAQuoC,OAAxC,GAAkD,IADtD;AAEA5lC,aAAWspE,mBAAcI,OAAzB,IACIrsE,QAAQssE,MAAR,KAAmBzyE,SAAnB,GAA+BmG,QAAQssE,MAAvC,GAAgD,CADpD;AAEA3pE,aAAWspE,mBAAcM,cAAzB,IACIvsE,QAAQ66B,aAAR,KAA0BhhC,SAA1B,GAAsCmG,QAAQ66B,aAA9C,GAA8DxzB,QADlE;AAEA1E,aAAWspE,mBAAcO,cAAzB,IACIxsE,QAAQ+6B,aAAR,KAA0BlhC,SAA1B,GAAsCmG,QAAQ+6B,aAA9C,GAA8D,CADlE;;AAGA,OAAK5Z,aAAL,CAAmBxe,UAAnB;;AAEA;;;;AAIA,OAAK8pE,MAAL,GAAc,0CAA4C;AACxDx1E,WAAO,oCAAsC,IADW;AAExDy1E,aAAS;AAF+C,GAA1D;;AAKA;;;;;AAKA,OAAKnzE,IAAL;AAED,CArCD,C,CAvCA;;;;;AA8EA,qBAASyyE,SAAT,EAAoBttD,gBAApB;;AAGA;;;;AAIAstD,UAAU74D,SAAV,CAAoBd,OAApB,GAA8B,YAAW;AACvC,SAAO,KAAK9Y,IAAZ;AACD,CAFD;;AAKA;;;AAGAyyE,UAAU74D,SAAV,CAAoBw5D,aAApB,GAAoC,YAAW;AAC7C,OAAKF,MAAL,CAAYN,OAAZ,GAAsB,iBAAM,KAAKS,UAAL,EAAN,EAAyB,CAAzB,EAA4B,CAA5B,CAAtB;AACA,OAAKH,MAAL,CAAYI,WAAZ,GAA0B,KAAKC,cAAL,EAA1B;AACA,OAAKL,MAAL,CAAYlkC,OAAZ,GAAsB,KAAKwkC,UAAL,EAAtB;AACA,OAAKN,MAAL,CAAYpqD,MAAZ,GAAqB,KAAKM,SAAL,EAArB;AACA,OAAK8pD,MAAL,CAAYH,MAAZ,GAAqB,KAAKU,SAAL,EAArB;AACA,OAAKP,MAAL,CAAY5xC,aAAZ,GAA4B,KAAKyE,gBAAL,EAA5B;AACA,OAAKmtC,MAAL,CAAY1xC,aAAZ,GAA4B/9B,KAAKkH,GAAL,CAAS,KAAKq7B,gBAAL,EAAT,EAAkC,CAAlC,CAA5B;;AAEA,SAAO,KAAKktC,MAAZ;AACD,CAVD;;AAaA;;;;;;AAMAT,UAAU74D,SAAV,CAAoB85D,cAApB,GAAqC,UAASzuD,SAAT,EAAoB,CAAE,CAA3D;;AAGA;;;;;;AAMAwtD,UAAU74D,SAAV,CAAoBojB,mBAApB,GAA0C,UAAS22C,UAAT,EAAqB,CAAE,CAAjE;;AAGA;;;;;;;AAOAlB,UAAU74D,SAAV,CAAoBwP,SAApB,GAAgC,YAAW;AACzC;AACE,oDAAkD,KAAKnhB,GAAL,CAASyqE,mBAAckB,MAAvB;AADpD;AAGD,CAJD;;AAOA;;;;;;AAMAnB,UAAU74D,SAAV,CAAoBmsB,gBAApB,GAAuC,YAAW;AAChD,SAAO,sBAAuB,KAAK99B,GAAL,CAASyqE,mBAAcM,cAAvB;AAA9B;AACD,CAFD;;AAKA;;;;;;AAMAP,UAAU74D,SAAV,CAAoBosB,gBAApB,GAAuC,YAAW;AAChD,SAAO,sBAAuB,KAAK/9B,GAAL,CAASyqE,mBAAcO,cAAvB;AAA9B;AACD,CAFD;;AAKA;;;;;;AAMAR,UAAU74D,SAAV,CAAoBy5D,UAApB,GAAiC,YAAW;AAC1C,SAAO,sBAAuB,KAAKprE,GAAL,CAASyqE,mBAAcC,OAAvB;AAA9B;AACD,CAFD;;AAKA;;;;AAIAF,UAAU74D,SAAV,CAAoB25D,cAApB,GAAqC,YAAW,CAAE,CAAlD;;AAGA;;;;;;AAMAd,UAAU74D,SAAV,CAAoB45D,UAApB,GAAiC,YAAW;AAC1C,SAAO,uBAAwB,KAAKvrE,GAAL,CAASyqE,mBAAcG,OAAvB;AAA/B;AACD,CAFD;;AAKA;;;;;;;AAOAJ,UAAU74D,SAAV,CAAoB65D,SAApB,GAAgC,YAAW;AACzC,SAAO,sBAAuB,KAAKxrE,GAAL,CAASyqE,mBAAcI,OAAvB;AAA9B;AACD,CAFD;;AAKA;;;;;;;AAOAL,UAAU74D,SAAV,CAAoBupD,SAApB,GAAgC,UAASr6C,MAAT,EAAiB;AAC/C,OAAKrC,GAAL,CAASisD,mBAAckB,MAAvB,EAA+B9qD,MAA/B;AACD,CAFD;;AAKA;;;;;;AAMA2pD,UAAU74D,SAAV,CAAoBi6D,gBAApB,GAAuC,UAASvyC,aAAT,EAAwB;AAC7D,OAAK7a,GAAL,CAASisD,mBAAcM,cAAvB,EAAuC1xC,aAAvC;AACD,CAFD;;AAKA;;;;;;AAMAmxC,UAAU74D,SAAV,CAAoBk6D,gBAApB,GAAuC,UAAStyC,aAAT,EAAwB;AAC7D,OAAK/a,GAAL,CAASisD,mBAAcO,cAAvB,EAAuCzxC,aAAvC;AACD,CAFD;;AAKA;;;;;;AAMAixC,UAAU74D,SAAV,CAAoBm6D,UAApB,GAAiC,UAASnB,OAAT,EAAkB;AACjD,OAAKnsD,GAAL,CAASisD,mBAAcC,OAAvB,EAAgCC,OAAhC;AACD,CAFD;;AAKA;;;;;;AAMAH,UAAU74D,SAAV,CAAoBo6D,UAApB,GAAiC,UAAShlC,OAAT,EAAkB;AACjD,OAAKvoB,GAAL,CAASisD,mBAAcG,OAAvB,EAAgC7jC,OAAhC;AACD,CAFD;;AAKA;;;;;;;AAOAyjC,UAAU74D,SAAV,CAAoBq6D,SAApB,GAAgC,UAASC,MAAT,EAAiB;AAC/C,OAAKztD,GAAL,CAASisD,mBAAcI,OAAvB,EAAgCoB,MAAhC;AACD,CAFD;kBAGezB,S;;;;;;;;;;;;;;;;;;ACxQf;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;;;AAGA;;;;;;;;;;;;;;;AAgBA;;;;AAjCA;;;AAqCA,IAAM/tD,WAAW;AACfyvD,UAAQ;AADO,CAAjB;;AAKA;;;;;;;;;;;AAWA,IAAM91C,aAAa,SAAbA,UAAa,CAASnZ,WAAT,EAAsB;;AAEvC,MAAMze,UAAUye,eAAe,EAA/B;AACA,MAAMkvD,cAAc,4CAA8C,iBAAO,EAAP,EAAW3tE,OAAX,CAAlE;AACA,SAAO2tE,YAAY90E,MAAnB;;AAEA,MAAIA,SAASmH,QAAQnH,MAArB;;AAEAmzE,iBAAUx3D,IAAV,CAAe,IAAf,EAAqBm5D,WAArB;;AAEA;;;;AAIA,OAAKC,mBAAL,GAA2B,EAA3B;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,EAArB;;AAEA,sBAAO,IAAP,EACE,gCAAmB5vD,SAASyvD,MAA5B,CADF,EAEE,KAAKI,oBAFP,EAE6B,IAF7B;;AAIA,MAAIj1E,MAAJ,EAAY;AACV,QAAIyB,MAAMC,OAAN,CAAc1B,MAAd,CAAJ,EAA2B;AACzBA,eAAS,IAAI0lB,oBAAJ,CAAe1lB,OAAOC,KAAP,EAAf,EAA+B,EAAC8lB,QAAQ,IAAT,EAA/B,CAAT;AACD,KAFD,MAEO;AACL,2BAAO/lB,kBAAkB0lB,oBAAzB,EACE,EADF,EADK,CAEE;AACP1lB,eAASA,MAAT;AACD;AACF,GARD,MAQO;AACLA,aAAS,IAAI0lB,oBAAJ,CAAe1kB,SAAf,EAA0B,EAAC+kB,QAAQ,IAAT,EAA1B,CAAT;AACD;;AAED,OAAKmvD,SAAL,CAAel1E,MAAf;AAED,CAxCD;;AA0CA,qBAAS++B,UAAT,EAAqBo0C,cAArB;;AAGA;;;AAGAp0C,WAAWzkB,SAAX,CAAqB66D,kBAArB,GAA0C,YAAW;AACnD,OAAKlsD,OAAL;AACD,CAFD;;AAKA;;;;AAIA8V,WAAWzkB,SAAX,CAAqB26D,oBAArB,GAA4C,UAAS9kD,KAAT,EAAgB;AAC1D,OAAK4kD,mBAAL,CAAyBj1E,OAAzB,CAAiC4wB,qBAAjC;AACA,OAAKqkD,mBAAL,CAAyB10E,MAAzB,GAAkC,CAAlC;;AAEA,MAAML,SAAS,KAAK23B,SAAL,EAAf;AACA,OAAKo9C,mBAAL,CAAyB3yE,IAAzB,CACE,oBAAOpC,MAAP,EAAe4mB,8BAAoBC,GAAnC,EAAwC,KAAKuuD,gBAA7C,EAA+D,IAA/D,CADF,EAEE,oBAAOp1E,MAAP,EAAe4mB,8BAAoBK,MAAnC,EAA2C,KAAKouD,mBAAhD,EAAqE,IAArE,CAFF;;AAKA,OAAK,IAAM/0E,EAAX,IAAiB,KAAK00E,aAAtB,EAAqC;AACnC,SAAKA,aAAL,CAAmB10E,EAAnB,EAAuBR,OAAvB,CAA+B4wB,qBAA/B;AACD;AACD,kBAAM,KAAKskD,aAAX;;AAEA,MAAMM,cAAct1E,OAAOumB,QAAP,EAApB;AACA,OAAK,IAAInmB,IAAI,CAAR,EAAWwkB,KAAK0wD,YAAYj1E,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiDxkB,GAAjD,EAAsD;AACpD,QAAMhC,QAAQk3E,YAAYl1E,CAAZ,CAAd;AACA,SAAK40E,aAAL,CAAmB,mBAAO52E,KAAP,EAAc6E,QAAd,EAAnB,IAA+C,CAC7C,oBAAO7E,KAAP,EAAco0B,0BAAgBC,cAA9B,EAA8C,KAAK0iD,kBAAnD,EAAuE,IAAvE,CAD6C,EAE7C,oBAAO/2E,KAAP,EAAc8qB,oBAAUC,MAAxB,EAAgC,KAAKgsD,kBAArC,EAAyD,IAAzD,CAF6C,CAA/C;AAID;;AAED,OAAKlsD,OAAL;AACD,CAzBD;;AA4BA;;;;AAIA8V,WAAWzkB,SAAX,CAAqB86D,gBAArB,GAAwC,UAASG,eAAT,EAA0B;AAChE,MAAMn3E,QAAQ,mCAAqCm3E,gBAAgB9vD,OAAnE;AACA,MAAMhd,MAAM,mBAAOrK,KAAP,EAAc6E,QAAd,EAAZ;AACA,OAAK+xE,aAAL,CAAmBvsE,GAAnB,IAA0B,CACxB,oBAAOrK,KAAP,EAAco0B,0BAAgBC,cAA9B,EAA8C,KAAK0iD,kBAAnD,EAAuE,IAAvE,CADwB,EAExB,oBAAO/2E,KAAP,EAAc8qB,oBAAUC,MAAxB,EAAgC,KAAKgsD,kBAArC,EAAyD,IAAzD,CAFwB,CAA1B;AAIA,OAAKlsD,OAAL;AACD,CARD;;AAWA;;;;AAIA8V,WAAWzkB,SAAX,CAAqB+6D,mBAArB,GAA2C,UAASE,eAAT,EAA0B;AACnE,MAAMn3E,QAAQ,mCAAqCm3E,gBAAgB9vD,OAAnE;AACA,MAAMhd,MAAM,mBAAOrK,KAAP,EAAc6E,QAAd,EAAZ;AACA,OAAK+xE,aAAL,CAAmBvsE,GAAnB,EAAwB3I,OAAxB,CAAgC4wB,qBAAhC;AACA,SAAO,KAAKskD,aAAL,CAAmBvsE,GAAnB,CAAP;AACA,OAAKwgB,OAAL;AACD,CAND;;AASA;;;;;;;;AAQA8V,WAAWzkB,SAAX,CAAqBqd,SAArB,GAAiC,YAAW;AAC1C;AACE,+DAA6D,KAAKhvB,GAAL,CAASyc,SAASyvD,MAAlB;AAD/D;AAGD,CAJD;;AAOA;;;;;;;;AAQA91C,WAAWzkB,SAAX,CAAqB46D,SAArB,GAAiC,UAASl1E,MAAT,EAAiB;AAChD,OAAKmnB,GAAL,CAAS/B,SAASyvD,MAAlB,EAA0B70E,MAA1B;AACD,CAFD;;AAKA;;;AAGA++B,WAAWzkB,SAAX,CAAqB85D,cAArB,GAAsC,UAASzuD,SAAT,EAAoB;AACxD,MAAMjhB,QAAQihB,cAAc3kB,SAAd,GAA0B2kB,SAA1B,GAAsC,EAApD;AACA,OAAKgS,SAAL,GAAiB73B,OAAjB,CAAyB,UAAS1B,KAAT,EAAgB;AACvCA,UAAMg2E,cAAN,CAAqB1vE,KAArB;AACD,GAFD;AAGA,SAAOA,KAAP;AACD,CAND;;AASA;;;AAGAq6B,WAAWzkB,SAAX,CAAqBojB,mBAArB,GAA2C,UAAS22C,UAAT,EAAqB;AAC9D,MAAMmB,SAASnB,eAAerzE,SAAf,GAA2BqzE,UAA3B,GAAwC,EAAvD;;AAEA,MAAM7+D,MAAMggE,OAAOn1E,MAAnB;;AAEA,OAAKs3B,SAAL,GAAiB73B,OAAjB,CAAyB,UAAS1B,KAAT,EAAgB;AACvCA,UAAMs/B,mBAAN,CAA0B83C,MAA1B;AACD,GAFD;;AAIA,MAAMC,gBAAgB,KAAK3B,aAAL,EAAtB;AACA,OAAK,IAAI1zE,IAAIoV,GAAR,EAAaoP,KAAK4wD,OAAOn1E,MAA9B,EAAsCD,IAAIwkB,EAA1C,EAA8CxkB,GAA9C,EAAmD;AACjD,QAAM8uC,aAAasmC,OAAOp1E,CAAP,CAAnB;AACA8uC,eAAWokC,OAAX,IAAsBmC,cAAcnC,OAApC;AACApkC,eAAWQ,OAAX,GAAqBR,WAAWQ,OAAX,IAAsB+lC,cAAc/lC,OAAzD;AACAR,eAAWlN,aAAX,GAA2B79B,KAAKiH,GAAL,CACzB8jC,WAAWlN,aADc,EACCyzC,cAAczzC,aADf,CAA3B;AAEAkN,eAAWhN,aAAX,GAA2B/9B,KAAKkH,GAAL,CACzB6jC,WAAWhN,aADc,EACCuzC,cAAcvzC,aADf,CAA3B;AAEA,QAAIuzC,cAAcjsD,MAAd,KAAyBxoB,SAA7B,EAAwC;AACtC,UAAIkuC,WAAW1lB,MAAX,KAAsBxoB,SAA1B,EAAqC;AACnCkuC,mBAAW1lB,MAAX,GAAoB,6BAAgB0lB,WAAW1lB,MAA3B,EAAmCisD,cAAcjsD,MAAjD,CAApB;AACD,OAFD,MAEO;AACL0lB,mBAAW1lB,MAAX,GAAoBisD,cAAcjsD,MAAlC;AACD;AACF;AACF;;AAED,SAAOgsD,MAAP;AACD,CA5BD;;AA+BA;;;AAGAz2C,WAAWzkB,SAAX,CAAqB25D,cAArB,GAAsC,YAAW;AAC/C,SAAOyB,gBAAYC,KAAnB;AACD,CAFD;;kBAIe52C,U;;;;;;;;;;;;;;;;;QCnIC62C,mB,GAAAA,mB;;AAjHhB;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;;;AAGA;;;;;;;;;;;;;;;;;AAkBA;;;;;;;;;;;;;AAcA;;;;;;;;;;;;;;;;;;;;;;AAsBA,IAAMC,QAAQ,SAARA,KAAQ,CAAS1uE,OAAT,EAAkB;;AAE9B,MAAM2tE,cAAc,iBAAO,EAAP,EAAW3tE,OAAX,CAApB;AACA,SAAO2tE,YAAYv2E,MAAnB;;AAEA40E,iBAAUx3D,IAAV,CAAe,IAAf,EAAqB,2CAA6Cm5D,WAAlE;;AAEA;;;;AAIA,OAAKgB,iBAAL,GAAyB,IAAzB;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,IAArB;;AAEA;;;;AAIA,OAAKC,gBAAL,GAAwB,IAAxB;;AAEA,MAAI7uE,QAAQvI,GAAZ,EAAiB;AACf,SAAKs4B,MAAL,CAAY/vB,QAAQvI,GAApB;AACD;;AAED,sBAAO,IAAP,EACE,gCAAmBw0E,mBAAc6C,MAAjC,CADF,EAEE,KAAKC,2BAFP,EAEoC,IAFpC;;AAIA,MAAM33E,SAAS4I,QAAQ5I,MAAR,GAAiB4I,QAAQ5I,MAAzB,GAAkC,IAAjD;AACA,OAAK43E,SAAL,CAAe53E,MAAf;AACD,CAnCD,C,CApEA;;;;;AAyGA,qBAASs3E,KAAT,EAAgB1C,cAAhB;;AAGA;;;;;;;;AAQO,SAASyC,mBAAT,CAA6B1mC,UAA7B,EAAyCzlB,UAAzC,EAAqD;AAC1D,SAAOylB,WAAWQ,OAAX,IAAsBjmB,cAAcylB,WAAWhN,aAA/C,IACHzY,aAAaylB,WAAWlN,aAD5B;AAED;;AAGD;;;AAGA6zC,MAAMv7D,SAAN,CAAgB85D,cAAhB,GAAiC,UAASzuD,SAAT,EAAoB;AACnD,MAAMjhB,QAAQihB,YAAYA,SAAZ,GAAwB,EAAtC;AACAjhB,QAAMtC,IAAN,CAAW,IAAX;AACA,SAAOsC,KAAP;AACD,CAJD;;AAOA;;;AAGAmxE,MAAMv7D,SAAN,CAAgBojB,mBAAhB,GAAsC,UAAS22C,UAAT,EAAqB;AACzD,MAAMmB,SAASnB,aAAaA,UAAb,GAA0B,EAAzC;AACAmB,SAAOpzE,IAAP,CAAY,KAAK0xE,aAAL,EAAZ;AACA,SAAO0B,MAAP;AACD,CAJD;;AAOA;;;;;;AAMAK,MAAMv7D,SAAN,CAAgB60B,SAAhB,GAA4B,YAAW;AACrC,MAAM5wC,SAAS,KAAKoK,GAAL,CAASyqE,mBAAc6C,MAAvB,CAAf;AACA;AACE,0CAAwC13E,MAAD,IAAY;AADrD;AAGD,CALD;;AAQA;;;AAGAs3E,MAAMv7D,SAAN,CAAgB25D,cAAhB,GAAiC,YAAW;AAC1C,MAAM11E,SAAS,KAAK4wC,SAAL,EAAf;AACA,SAAO,CAAC5wC,MAAD,GAAUm3E,gBAAYjuD,SAAtB,GAAkClpB,OAAO2rB,QAAP,EAAzC;AACD,CAHD;;AAMA;;;AAGA2rD,MAAMv7D,SAAN,CAAgB87D,mBAAhB,GAAsC,YAAW;AAC/C,OAAKntD,OAAL;AACD,CAFD;;AAKA;;;AAGA4sD,MAAMv7D,SAAN,CAAgB47D,2BAAhB,GAA8C,YAAW;AACvD,MAAI,KAAKF,gBAAT,EAA2B;AACzB,+BAAc,KAAKA,gBAAnB;AACA,SAAKA,gBAAL,GAAwB,IAAxB;AACD;AACD,MAAMz3E,SAAS,KAAK4wC,SAAL,EAAf;AACA,MAAI5wC,MAAJ,EAAY;AACV,SAAKy3E,gBAAL,GAAwB,oBAAOz3E,MAAP,EACtB2qB,oBAAUC,MADY,EACJ,KAAKitD,mBADD,EACsB,IADtB,CAAxB;AAED;AACD,OAAKntD,OAAL;AACD,CAXD;;AAcA;;;;;;;;;;;;AAYA4sD,MAAMv7D,SAAN,CAAgB4c,MAAhB,GAAyB,UAASt4B,GAAT,EAAc;AACrC,MAAI,KAAKk3E,iBAAT,EAA4B;AAC1B,+BAAc,KAAKA,iBAAnB;AACA,SAAKA,iBAAL,GAAyB,IAAzB;AACD;AACD,MAAI,CAACl3E,GAAL,EAAU;AACR,SAAKqqB,OAAL;AACD;AACD,MAAI,KAAK8sD,aAAT,EAAwB;AACtB,+BAAc,KAAKA,aAAnB;AACA,SAAKA,aAAL,GAAqB,IAArB;AACD;AACD,MAAIn3E,GAAJ,EAAS;AACP,SAAKk3E,iBAAL,GAAyB,oBAAOl3E,GAAP,EAAYy3E,oBAAgBC,UAA5B,EAAwC,UAAS9/B,GAAT,EAAc;AAC7E,UAAMtH,aAAa,KAAK4kC,aAAL,EAAnB;AACA5kC,iBAAW2kC,OAAX,GAAqB,KAArB;AACA3kC,iBAAWukC,MAAX,GAAoBjlE,QAApB;AACAgoC,UAAIllB,UAAJ,CAAemM,gBAAf,CAAgCr7B,IAAhC,CAAqC8sC,UAArC;AACAsH,UAAIllB,UAAJ,CAAeqM,WAAf,CAA2B,mBAAO,IAAP,CAA3B,IAA2CuR,UAA3C;AACD,KANwB,EAMtB,IANsB,CAAzB;AAOA,SAAK6mC,aAAL,GAAqB,oBAAO,IAAP,EAAa7sD,oBAAUC,MAAvB,EAA+BvqB,IAAIu9B,MAAnC,EAA2Cv9B,GAA3C,CAArB;AACA,SAAKqqB,OAAL;AACD;AACF,CAvBD;;AA0BA;;;;;;AAMA4sD,MAAMv7D,SAAN,CAAgB67D,SAAhB,GAA4B,UAAS53E,MAAT,EAAiB;AAC3C,OAAK4oB,GAAL,CAASisD,mBAAc6C,MAAvB,EAA+B13E,MAA/B;AACD,CAFD;kBAGes3E,K;;;;;;;;;;;;;;;;;AC7Of;;;;AAIA;;;kBAGe;AACbxC,WAAS,SADI;AAEbE,WAAS,SAFI;AAGbe,UAAQ,QAHK;AAIbd,WAAS,QAJI;AAKbE,kBAAgB,eALH;AAMbC,kBAAgB,eANH;AAObsC,UAAQ;AAPK,C;;;;;;;;;;;;;;;;;;;ACJf;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;;;;;;;;;;AAxDA;;;AAkEO,IAAMM,kCAAa;AACxBjqD,SAAO,OADiB;AAExBG,UAAQ;AAFgB,CAAnB;;AAMP;;;;AAIA,IAAMrH,WAAW;AACfoxD,gBAAc;AADC,CAAjB;;AAKA;;;;;;;;;;;;;AAaA,IAAMn4E,cAAc,SAAdA,WAAc,CAASunB,WAAT,EAAsB;AACxC,MAAMze,UAAUye,cACdA,WADc,GACA,6CAA+C,EAD/D;;AAGA,MAAMkvD,cAAc,iBAAO,EAAP,EAAW3tE,OAAX,CAApB;;AAEA,SAAO2tE,YAAYtwD,KAAnB;AACA,SAAOswD,YAAY2B,YAAnB;AACA,SAAO3B,YAAYrR,oBAAnB;AACA,SAAOqR,YAAYtU,sBAAnB;AACAqV,kBAAMl6D,IAAN,CAAW,IAAX,EAAiB,4CAA8Cm5D,WAA/D;;AAEA;;;;AAIA,OAAK4B,UAAL,GAAkBvvE,QAAQ7I,SAAR,KAAsB0C,SAAtB,GAAkCmG,QAAQ7I,SAA1C,GAAsD,KAAxE;;AAEA;;;;AAIA,OAAKq4E,aAAL,GAAqBxvE,QAAQsvE,YAAR,KAAyBz1E,SAAzB,GACnBmG,QAAQsvE,YADW,GACI,GADzB;;AAGA;;;;;AAKA,OAAK1uD,MAAL,GAAc,IAAd;;AAEA;;;;;AAKA,OAAKC,cAAL,GAAsBhnB,SAAtB;;AAEA,OAAK6nB,QAAL,CAAc1hB,QAAQqd,KAAtB;;AAEA;;;;AAIA,OAAKoyD,qBAAL,GAA6BzvE,QAAQs8D,oBAAR,KAAiCziE,SAAjC,GAC3BmG,QAAQs8D,oBADmB,GACI,KADjC;;AAGA;;;;AAIA,OAAKoT,uBAAL,GAA+B1vE,QAAQq5D,sBAAR,KAAmCx/D,SAAnC,GAC7BmG,QAAQq5D,sBADqB,GACI,KADnC;;AAGA;;;;AAIA,OAAKsW,WAAL,GAAmB3vE,QAAQ4vE,UAAR,IAAsBC,2BAAiBvqD,MAA1D;;AAEA;;;;;AAKA,OAAK/rB,IAAL,GAAYu2E,oBAAUxqD,MAAtB;AAED,CApED;;AAsEA,qBAASpuB,WAAT,EAAsBw3E,eAAtB;;AAGA;;;AAGAx3E,YAAYic,SAAZ,CAAsB48D,YAAtB,GAAqC,YAAW;AAC9C,SAAO,KAAKR,UAAZ;AACD,CAFD;;AAKA;;;AAGAr4E,YAAYic,SAAZ,CAAsB68D,YAAtB,GAAqC,UAAS74E,SAAT,EAAoB;AACvD,OAAKo4E,UAAL,GAAkBp4E,SAAlB;AACD,CAFD;;AAKA;;;AAGAD,YAAYic,SAAZ,CAAsB88D,eAAtB,GAAwC,YAAW;AACjD,SAAO,KAAKT,aAAZ;AACD,CAFD;;AAKA;;;;AAIAt4E,YAAYic,SAAZ,CAAsB+8D,cAAtB,GAAuC,YAAW;AAChD;AACE,gEAA8D,KAAK1uE,GAAL,CAASyc,SAASoxD,YAAlB;AADhE;AAGD,CAJD;;AAOA;;;;;;AAMAn4E,YAAYic,SAAZ,CAAsB60B,SAAtB;;AAGA;;;;;;;AAOA9wC,YAAYic,SAAZ,CAAsBsO,QAAtB,GAAiC,YAAW;AAC1C,SAAO,KAAKb,MAAZ;AACD,CAFD;;AAKA;;;;;AAKA1pB,YAAYic,SAAZ,CAAsByO,gBAAtB,GAAyC,YAAW;AAClD,SAAO,KAAKf,cAAZ;AACD,CAFD;;AAKA;;;;AAIA3pB,YAAYic,SAAZ,CAAsBg9D,uBAAtB,GAAgD,YAAW;AACzD,SAAO,KAAKV,qBAAZ;AACD,CAFD;;AAKA;;;;AAIAv4E,YAAYic,SAAZ,CAAsBi9D,yBAAtB,GAAkD,YAAW;AAC3D,SAAO,KAAKV,uBAAZ;AACD,CAFD;;AAKA;;;;AAIAx4E,YAAYic,SAAZ,CAAsBk9D,cAAtB,GAAuC,UAASC,WAAT,EAAsB;AAC3D,OAAKtwD,GAAL,CAAS/B,SAASoxD,YAAlB,EAAgCiB,WAAhC;AACD,CAFD;;AAKA;;;;;;;;;;;AAWAp5E,YAAYic,SAAZ,CAAsBuO,QAAtB,GAAiC,UAASrE,KAAT,EAAgB;AAC/C,OAAKuD,MAAL,GAAcvD,UAAUxjB,SAAV,GAAsBwjB,KAAtB,GAA8BkzD,yBAA5C;AACA,OAAK1vD,cAAL,GAAsBxD,UAAU,IAAV,GACpBxjB,SADoB,GACR,uBAAgB,KAAK+mB,MAArB,CADd;AAEA,OAAKkB,OAAL;AACD,CALD;;AAQA;;;AAGA5qB,YAAYic,SAAZ,CAAsBq9D,aAAtB,GAAsC,YAAW;AAC/C,SAAO,KAAKb,WAAZ;AACD,CAFD;;kBAKez4E,W;;;;;;;;;;;;;;;;;AC/Rf;;;;AAIA;;;;;;;;;;kBAUe;AACbiuB,SAAO,OADM;AAEbG,UAAQ;AAFK,C;;;;;;;;;;;;;;;;;ACdf;;;;AAIA;;;;;;;;;;;;;kBAae;AACbH,SAAO,OADM;AAEbsrD,UAAQ,QAFK;AAGbnrD,UAAQ;AAHK,C;;;;;;;;;;;;;;;;;QCLCorD,G,GAAAA,G;QAaAC,I,GAAAA,I;QAWAz9C,I,GAAAA,I;AApChB;;;;AAKA;;;;;;;AAOO,SAASw9C,GAAT,CAAaruD,MAAb,EAAqBC,UAArB,EAAiC;AACtC,SAAO,CAAC,CAAC,CAACjb,QAAF,EAAY,CAACA,QAAb,EAAuBA,QAAvB,EAAiCA,QAAjC,CAAD,CAAP;AACD;;AAGD;;;;;;;;AAQO,SAASspE,IAAT,CAActuD,MAAd,EAAsBC,UAAtB,EAAkC;AACvC,SAAO,CAACD,MAAD,CAAP;AACD;;AAGD;;;;;;AAMO,SAAS6Q,IAAT,CAAc09C,QAAd,EAAwB;AAC7B;AACE;;;;;AAKA,cAASvuD,MAAT,EAAiBC,UAAjB,EAA6B;AAC3B,UAAMxU,IAAI8iE,SAASC,iBAAT,CAA2BvuD,UAA3B,CAAV;AACA,UAAM8W,YAAYw3C,SAASE,yBAAT,CAAmCzuD,MAAnC,EAA2CvU,CAA3C,CAAlB;AACA;AACA,UAAMijE,UAAU,EAAhB;AACA;AACA,UAAMz3C,YAAY,CAACxrB,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAlB;AACA,WAAKwrB,UAAU,CAAV,IAAeF,UAAUJ,IAA9B,EAAoCM,UAAU,CAAV,KAAgBF,UAAUH,IAA9D,EAAoE,EAAEK,UAAU,CAAV,CAAtE,EAAoF;AAClF,aAAKA,UAAU,CAAV,IAAeF,UAAUF,IAA9B,EAAoCI,UAAU,CAAV,KAAgBF,UAAUD,IAA9D,EAAoE,EAAEG,UAAU,CAAV,CAAtE,EAAoF;AAClFy3C,kBAAQ91E,IAAR,CAAa21E,SAASI,kBAAT,CAA4B13C,SAA5B,CAAb;AACD;AACF;AACD,aAAOy3C,OAAP;AACD;AAnBH;AAqBD,C;;;;;;;;;;;;;;;;;;QC7CeE,K,GAAAA,K;QAoCAC,mB,GAAAA,mB;QAiBAC,sB,GAAAA,sB;QAyBA3lC,e,GAAAA,e;QAcA4lC,iB,GAAAA,iB;QAuDAC,S,GAAAA,S;QAWAC,S,GAAAA,S;QAWAC,M,GAAAA,M;QAaAC,I,GAAAA,I;;AAhMhB;;AAEA;;;;;;;;AAQO,SAASP,KAAT,CAAez0E,KAAf,EAAsByH,GAAtB,EAA2BC,GAA3B,EAAgC;AACrC,SAAOlH,KAAKiH,GAAL,CAASjH,KAAKkH,GAAL,CAAS1H,KAAT,EAAgByH,GAAhB,CAAT,EAA+BC,GAA/B,CAAP;AACD;;AAGD;;;;;;;;;AAlBA;;;AA2BO,IAAMutE,sBAAS,YAAW;AAC/B;AACA;AACA,MAAIA,aAAJ;AACA,MAAI,UAAUz0E,IAAd,EAAoB;AAClB;AACAy0E,WAAOz0E,KAAKy0E,IAAZ;AACD,GAHD,MAGO;AACL;AACAA,WAAO,cAASpuE,CAAT,EAAY;AACjB,UAAM+N,IAAIpU,KAAK00E,GAAL,CAASruE,CAAT,CAAV;AACA,aAAO,CAAC+N,IAAI,IAAIA,CAAT,IAAc,CAArB;AACD,KAHD;AAID;AACD,SAAOqgE,IAAP;AACD,CAfqB,EAAf;;AAkBP;;;;AAIO,SAASP,mBAAT,CAA6B7tE,CAA7B,EAAgC;AACrC,uBAAO,IAAIA,CAAX,EAAc,EAAd,EADqC,CAClB;AACnB,SAAOrG,KAAKoG,GAAL,CAAS,CAAT,EAAYpG,KAAKqH,IAAL,CAAUrH,KAAKyG,GAAL,CAASJ,CAAT,IAAcrG,KAAKgG,GAA7B,CAAZ,CAAP;AACD;;AAGD;;;;;;;;;;;AAWO,SAASmuE,sBAAT,CAAgC9tE,CAAhC,EAAmC+N,CAAnC,EAAsC+sB,EAAtC,EAA0CC,EAA1C,EAA8C3qB,EAA9C,EAAkDu4B,EAAlD,EAAsD;AAC3D,MAAMjnB,KAAKtR,KAAK0qB,EAAhB;AACA,MAAMnZ,KAAKgnB,KAAK5N,EAAhB;AACA,MAAIrZ,OAAO,CAAP,IAAYC,OAAO,CAAvB,EAA0B;AACxB,QAAMvnB,IAAI,CAAC,CAAC4F,IAAI86B,EAAL,IAAWpZ,EAAX,GAAgB,CAAC3T,IAAIgtB,EAAL,IAAWpZ,EAA5B,KAAmCD,KAAKA,EAAL,GAAUC,KAAKA,EAAlD,CAAV;AACA,QAAIvnB,IAAI,CAAR,EAAW;AACT0gC,WAAK1qB,EAAL;AACA2qB,WAAK4N,EAAL;AACD,KAHD,MAGO,IAAIvuC,IAAI,CAAR,EAAW;AAChB0gC,YAAMpZ,KAAKtnB,CAAX;AACA2gC,YAAMpZ,KAAKvnB,CAAX;AACD;AACF;AACD,SAAO+tC,gBAAgBnoC,CAAhB,EAAmB+N,CAAnB,EAAsB+sB,EAAtB,EAA0BC,EAA1B,CAAP;AACD;;AAGD;;;;;;;;AAQO,SAASoN,eAAT,CAAyBrN,EAAzB,EAA6BC,EAA7B,EAAiC3qB,EAAjC,EAAqCu4B,EAArC,EAAyC;AAC9C,MAAMjnB,KAAKtR,KAAK0qB,EAAhB;AACA,MAAMnZ,KAAKgnB,KAAK5N,EAAhB;AACA,SAAOrZ,KAAKA,EAAL,GAAUC,KAAKA,EAAtB;AACD;;AAGD;;;;;;;AAOO,SAASosD,iBAAT,CAA2BO,GAA3B,EAAgC;AACrC,MAAMpuE,IAAIouE,IAAIz4E,MAAd;;AAEA,OAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIsK,CAApB,EAAuBtK,GAAvB,EAA4B;AAC1B;AACA,QAAI24E,SAAS34E,CAAb;AACA,QAAI44E,QAAQ70E,KAAKmH,GAAL,CAASwtE,IAAI14E,CAAJ,EAAOA,CAAP,CAAT,CAAZ;AACA,SAAK,IAAIf,IAAIe,IAAI,CAAjB,EAAoBf,IAAIqL,CAAxB,EAA2BrL,GAA3B,EAAgC;AAC9B,UAAM45E,WAAW90E,KAAKmH,GAAL,CAASwtE,IAAIz5E,CAAJ,EAAOe,CAAP,CAAT,CAAjB;AACA,UAAI64E,WAAWD,KAAf,EAAsB;AACpBA,gBAAQC,QAAR;AACAF,iBAAS15E,CAAT;AACD;AACF;;AAED,QAAI25E,UAAU,CAAd,EAAiB;AACf,aAAO,IAAP,CADe,CACF;AACd;;AAED;AACA,QAAMztC,MAAMutC,IAAIC,MAAJ,CAAZ;AACAD,QAAIC,MAAJ,IAAcD,IAAI14E,CAAJ,CAAd;AACA04E,QAAI14E,CAAJ,IAASmrC,GAAT;;AAEA;AACA,SAAK,IAAIjiC,IAAIlJ,IAAI,CAAjB,EAAoBkJ,IAAIoB,CAAxB,EAA2BpB,GAA3B,EAAgC;AAC9B,UAAM4vE,OAAO,CAACJ,IAAIxvE,CAAJ,EAAOlJ,CAAP,CAAD,GAAa04E,IAAI14E,CAAJ,EAAOA,CAAP,CAA1B;AACA,WAAK,IAAIR,IAAIQ,CAAb,EAAgBR,IAAI8K,IAAI,CAAxB,EAA2B9K,GAA3B,EAAgC;AAC9B,YAAIQ,KAAKR,CAAT,EAAY;AACVk5E,cAAIxvE,CAAJ,EAAO1J,CAAP,IAAY,CAAZ;AACD,SAFD,MAEO;AACLk5E,cAAIxvE,CAAJ,EAAO1J,CAAP,KAAas5E,OAAOJ,IAAI14E,CAAJ,EAAOR,CAAP,CAApB;AACD;AACF;AACF;AACF;;AAED;AACA,MAAM4K,IAAI,IAAI/I,KAAJ,CAAUiJ,CAAV,CAAV;AACA,OAAK,IAAI4N,IAAI5N,IAAI,CAAjB,EAAoB4N,KAAK,CAAzB,EAA4BA,GAA5B,EAAiC;AAC/B9N,MAAE8N,CAAF,IAAOwgE,IAAIxgE,CAAJ,EAAO5N,CAAP,IAAYouE,IAAIxgE,CAAJ,EAAOA,CAAP,CAAnB;AACA,SAAK,IAAI/O,IAAI+O,IAAI,CAAjB,EAAoB/O,KAAK,CAAzB,EAA4BA,GAA5B,EAAiC;AAC/BuvE,UAAIvvE,CAAJ,EAAOmB,CAAP,KAAaouE,IAAIvvE,CAAJ,EAAO+O,CAAP,IAAY9N,EAAE8N,CAAF,CAAzB;AACD;AACF;AACD,SAAO9N,CAAP;AACD;;AAGD;;;;;;AAMO,SAASguE,SAAT,CAAmBW,cAAnB,EAAmC;AACxC,SAAOA,iBAAiB,GAAjB,GAAuBh1E,KAAKiG,EAAnC;AACD;;AAGD;;;;;;AAMO,SAASquE,SAAT,CAAmBW,cAAnB,EAAmC;AACxC,SAAOA,iBAAiBj1E,KAAKiG,EAAtB,GAA2B,GAAlC;AACD;;AAED;;;;;;;AAOO,SAASsuE,MAAT,CAAgBpwE,CAAhB,EAAmBD,CAAnB,EAAsB;AAC3B,MAAMhJ,IAAIiJ,IAAID,CAAd;AACA,SAAOhJ,IAAIgJ,CAAJ,GAAQ,CAAR,GAAYhJ,IAAIgJ,CAAhB,GAAoBhJ,CAA3B;AACD;;AAED;;;;;;;;AAQO,SAASs5E,IAAT,CAAcrwE,CAAd,EAAiBD,CAAjB,EAAoBmC,CAApB,EAAuB;AAC5B,SAAOlC,IAAIkC,KAAKnC,IAAIC,CAAT,CAAX;AACD,C;;;;;;;;;;;;;;;;;QC/Je6d,K,GAAAA,K;QAaAkzD,S,GAAAA,S;QAcA99C,O,GAAAA,O;AAjEhB;;;;AAKA;;;;;;;;;AASO,IAAM+9C,0BAAU,OAAOp5E,OAAOo5E,MAAd,KAAyB,UAA1B,GAAwCp5E,OAAOo5E,MAA/C,GAAwD,UAASx6E,MAAT,EAAiBy6E,WAAjB,EAA8B;AAC1G,MAAIz6E,WAAWkC,SAAX,IAAwBlC,WAAW,IAAvC,EAA6C;AAC3C,UAAM,IAAI8gB,SAAJ,CAAc,4CAAd,CAAN;AACD;;AAED,MAAMjT,SAASzM,OAAOpB,MAAP,CAAf;AACA,OAAK,IAAIsB,IAAI,CAAR,EAAWwkB,KAAK6e,UAAUpjC,MAA/B,EAAuCD,IAAIwkB,EAA3C,EAA+C,EAAExkB,CAAjD,EAAoD;AAClD,QAAM7B,SAASklC,UAAUrjC,CAAV,CAAf;AACA,QAAI7B,WAAWyC,SAAX,IAAwBzC,WAAW,IAAvC,EAA6C;AAC3C,WAAK,IAAMkK,GAAX,IAAkBlK,MAAlB,EAA0B;AACxB,YAAIA,OAAO+c,cAAP,CAAsB7S,GAAtB,CAAJ,EAAgC;AAC9BkE,iBAAOlE,GAAP,IAAclK,OAAOkK,GAAP,CAAd;AACD;AACF;AACF;AACF;AACD,SAAOkE,MAAP;AACD,CAjBM;;AAoBP;;;;AAIO,SAASwZ,KAAT,CAAe9hB,MAAf,EAAuB;AAC5B,OAAK,IAAMwP,QAAX,IAAuBxP,MAAvB,EAA+B;AAC7B,WAAOA,OAAOwP,QAAP,CAAP;AACD;AACF;;AAGD;;;;;;AAMO,SAASwlE,SAAT,CAAmBh1E,MAAnB,EAA2B;AAChC,MAAMqL,SAAS,EAAf;AACA,OAAK,IAAMmE,QAAX,IAAuBxP,MAAvB,EAA+B;AAC7BqL,WAAOtN,IAAP,CAAYiC,OAAOwP,QAAP,CAAZ;AACD;AACD,SAAOnE,MAAP;AACD;;AAGD;;;;;AAKO,SAAS6rB,OAAT,CAAiBl3B,MAAjB,EAAyB;AAC9B,MAAIwP,iBAAJ;AACA,OAAKA,QAAL,IAAiBxP,MAAjB,EAAyB;AACvB,WAAO,KAAP;AACD;AACD,SAAO,CAACwP,QAAR;AACD,C;;;;;;;;;;;;ACtED;;AAEA;;AAEA;AACA;;;;AAIA,eAAe;;AAEf;AACA;;AAEA;;AAEA;;AAEA,Y;;;;;;;;;;;;;;;;;ACnBA;;;AAGA;;;;;AAKA,IAAM2lE,cAAc,SAAdA,WAAc,CAASC,UAAT,EAAqBC,OAArB,EAA8B;AAChD;;;AAGA,OAAKD,UAAL,GAAkBA,UAAlB;;AAEA;;;;;AAKA,OAAKE,QAAL,GAAgBD,OAAhB;AACD,CAZD;;AAeA;;;;AAIAF,YAAYl/D,SAAZ,CAAsBs/D,SAAtB,GAAkC,YAAW;AAC3C,SAAO15E,OAAO6N,IAAP,CAAY,KAAK4rE,QAAjB,CAAP;AACD,CAFD;;AAKA;;;;;AAKAH,YAAYl/D,SAAZ,CAAsBu/D,kBAAtB,GAA2C,UAAStnD,SAAT,EAAoB;AAC7D,SAAO,KAAKonD,QAAL,CAAcpnD,SAAd,CAAP;AACD,CAFD;kBAGeinD,W;;;;;;;;;;;;;;;;;ACxCf;;;;AAIA;;;;kBAIe;AACblqD,eAAa,aADA;AAEbH,eAAa,aAFA;AAGbiB,aAAW,WAHE;AAIbc,eAAa,aAJA;AAKbC,cAAY,YALC;AAMbC,gBAAc,cAND;AAObC,gBAAc,cAPD;AAQbhB,iBAAe;AARF,C;;;;;;;;;;;;;;;;;;;ACyBf;;AACA;;;;;;AAEA;;;;;AApCA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAUA,IAAMypD,cAAc,SAAdA,WAAc,CAASL,UAAT,EAAqB;AACvC,MAAMC,UAAU;AACd,iBAAa,KAAKK,SADJ;AAEd,iBAAa,KAAKC,SAFJ;AAGd,eAAW,KAAKC,OAHF;AAId,iBAAa,KAAKC,SAJJ;AAKd,gBAAY,KAAKC;AALH,GAAhB;AAOAX,wBAAY79D,IAAZ,CAAiB,IAAjB,EAAuB89D,UAAvB,EAAmCC,OAAnC;;AAEA;;;;AAIA,OAAKU,UAAL,GAAkBX,WAAWW,UAA7B;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmB,EAAnB;AACD,CArBD;;AAuBA,qBAASP,WAAT,EAAsBN,qBAAtB;;AAGA;;;AAGO,IAAMc,kCAAa,CAAnB;;AAGP;;;AAGO,IAAMpZ,sCAAe,OAArB;;AAGP;;;;;AAKA,IAAMqZ,aAAa,EAAnB;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;AAwBAT,YAAYx/D,SAAZ,CAAsBkgE,0BAAtB,GAAmD,UAASC,OAAT,EAAkB;AACnE,MAAMC,MAAM,KAAKL,WAAjB;AACA,MAAM7vE,IAAIiwE,QAAQzpD,OAAlB;AACA,MAAMzY,IAAIkiE,QAAQxpD,OAAlB;AACA,OAAK,IAAI7wB,IAAI,CAAR,EAAWkY,IAAIoiE,IAAIr6E,MAAnB,EAA2BuE,CAAhC,EAAmCxE,IAAIkY,CAAJ,KAAU1T,IAAI81E,IAAIt6E,CAAJ,CAAd,CAAnC,EAA0DA,GAA1D,EAA+D;AAC7D;AACA,QAAM8rB,KAAK/nB,KAAKmH,GAAL,CAASd,IAAI5F,EAAE,CAAF,CAAb,CAAX;AACA,QAAMunB,KAAKhoB,KAAKmH,GAAL,CAASiN,IAAI3T,EAAE,CAAF,CAAb,CAAX;AACA,QAAIsnB,MAAMquD,UAAN,IAAoBpuD,MAAMouD,UAA9B,EAA0C;AACxC,aAAO,IAAP;AACD;AACF;AACD,SAAO,KAAP;AACD,CAbD;;AAgBA;;;;;;;;AAQA,SAASI,YAAT,CAAsBF,OAAtB,EAA+BhB,UAA/B,EAA2C;AACzC,MAAMnvE,IAAImvE,WAAWmB,UAAX,CAAsBH,OAAtB,EAA+BA,OAA/B,CAAV;;AAEA;AACA,MAAMI,KAAKvwE,EAAE0jB,cAAb;AACA1jB,IAAE0jB,cAAF,GAAmB,YAAW;AAC5BysD,YAAQzsD,cAAR;AACA6sD;AACD,GAHD;;AAKAvwE,IAAEgmB,SAAF,GAAcgqD,UAAd;AACAhwE,IAAEyvC,SAAF,GAAc,IAAd;AACAzvC,IAAEuvC,WAAF,GAAgBqnB,YAAhB;;AAEA,SAAO52D,CAAP;AACD;;AAGD;;;;;AAKAwvE,YAAYx/D,SAAZ,CAAsBy/D,SAAtB,GAAkC,UAASU,OAAT,EAAkB;AAClD,MAAI,CAAC,KAAKD,0BAAL,CAAgCC,OAAhC,CAAL,EAA+C;AAC7C;AACA;AACA,QAAIH,WAAWr3E,QAAX,MAAyB,KAAKm3E,UAAlC,EAA8C;AAC5C,WAAKU,MAAL,CAAYL,OAAZ;AACD;AACD,QAAMnwE,IAAIqwE,aAAaF,OAAb,EAAsB,KAAKhB,UAA3B,CAAV;AACA,SAAKW,UAAL,CAAgBE,WAAWr3E,QAAX,EAAhB,IAAyCw3E,OAAzC;AACA,SAAKhB,UAAL,CAAgBsB,IAAhB,CAAqBzwE,CAArB,EAAwBmwE,OAAxB;AACD;AACF,CAXD;;AAcA;;;;;AAKAX,YAAYx/D,SAAZ,CAAsB0/D,SAAtB,GAAkC,UAASS,OAAT,EAAkB;AAClD,MAAI,CAAC,KAAKD,0BAAL,CAAgCC,OAAhC,CAAL,EAA+C;AAC7C,QAAMnwE,IAAIqwE,aAAaF,OAAb,EAAsB,KAAKhB,UAA3B,CAAV;AACA,SAAKA,UAAL,CAAgB1Y,IAAhB,CAAqBz2D,CAArB,EAAwBmwE,OAAxB;AACD;AACF,CALD;;AAQA;;;;;AAKAX,YAAYx/D,SAAZ,CAAsB2/D,OAAtB,GAAgC,UAASQ,OAAT,EAAkB;AAChD,MAAI,CAAC,KAAKD,0BAAL,CAAgCC,OAAhC,CAAL,EAA+C;AAC7C,QAAMO,IAAI,KAAKZ,UAAL,CAAgBE,WAAWr3E,QAAX,EAAhB,CAAV;;AAEA,QAAI+3E,KAAKA,EAAErqD,MAAF,KAAa8pD,QAAQ9pD,MAA9B,EAAsC;AACpC,UAAMrmB,IAAIqwE,aAAaF,OAAb,EAAsB,KAAKhB,UAA3B,CAAV;AACA,WAAKA,UAAL,CAAgBwB,EAAhB,CAAmB3wE,CAAnB,EAAsBmwE,OAAtB;AACA,WAAKS,YAAL;AACD;AACF;AACF,CAVD;;AAaA;;;;;AAKApB,YAAYx/D,SAAZ,CAAsB4/D,SAAtB,GAAkC,UAASO,OAAT,EAAkB;AAClD,MAAI,CAAC,KAAKD,0BAAL,CAAgCC,OAAhC,CAAL,EAA+C;AAC7C,QAAMnwE,IAAIqwE,aAAaF,OAAb,EAAsB,KAAKhB,UAA3B,CAAV;AACA,SAAKA,UAAL,CAAgB0B,SAAhB,CAA0B7wE,CAA1B,EAA6BmwE,OAA7B;AACD;AACF,CALD;;AAQA;;;;;AAKAX,YAAYx/D,SAAZ,CAAsB6/D,QAAtB,GAAiC,UAASM,OAAT,EAAkB;AACjD,MAAI,CAAC,KAAKD,0BAAL,CAAgCC,OAAhC,CAAL,EAA+C;AAC7C,QAAMnwE,IAAIqwE,aAAaF,OAAb,EAAsB,KAAKhB,UAA3B,CAAV;AACA,SAAKA,UAAL,CAAgB2B,QAAhB,CAAyB9wE,CAAzB,EAA4BmwE,OAA5B;AACD;AACF,CALD;;AAQA;;;;;AAKAX,YAAYx/D,SAAZ,CAAsBwgE,MAAtB,GAA+B,UAASL,OAAT,EAAkB;AAC/C,MAAMnwE,IAAIqwE,aAAaF,OAAb,EAAsB,KAAKhB,UAA3B,CAAV;AACA,OAAKA,UAAL,CAAgBqB,MAAhB,CAAuBxwE,CAAvB,EAA0BmwE,OAA1B;AACA,OAAKS,YAAL;AACD,CAJD;;AAOA;;;AAGApB,YAAYx/D,SAAZ,CAAsB4gE,YAAtB,GAAqC,YAAW;AAC9C,SAAO,KAAKd,UAAL,CAAgBE,WAAWr3E,QAAX,EAAhB,CAAP;AACD,CAFD;kBAGe62E,W;;;;;;;;;;;;;;;;;;ACtNf;;AACA;;;;;;AAEA;;;;;AApCA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAUA,IAAMuB,WAAW,SAAXA,QAAW,CAAS5B,UAAT,EAAqB;AACpC,MAAMC,UAAU;AACd,qBAAiB,KAAK4B,aADR;AAEd,qBAAiB,KAAKC,aAFR;AAGd,mBAAe,KAAKC,WAHN;AAId,oBAAgB,KAAKC,YAJP;AAKd,qBAAiB,KAAKC,aALR;AAMd,uBAAmB,KAAKC,eANV;AAOd,2BAAuB,KAAKC,mBAPd;AAQd,4BAAwB,KAAKC;AARf,GAAhB;AAUArC,wBAAY79D,IAAZ,CAAiB,IAAjB,EAAuB89D,UAAvB,EAAmCC,OAAnC;;AAEA;;;;AAIA,OAAKU,UAAL,GAAkBX,WAAWW,UAA7B;AACD,CAlBD;;AAoBA,qBAASiB,QAAT,EAAmB7B,qBAAnB;;AAEA;;;;AAIA,IAAMsC,gBAAgB,CACpB,EADoB,EAEpB,aAFoB,EAGpB,OAHoB,EAIpB,KAJoB,EAKpB,OALoB,CAAtB;;AASA;;;;;;;;AAQAT,SAAS/gE,SAAT,CAAmByhE,aAAnB,GAAmC,UAAStB,OAAT,EAAkB;AACnD,MAAInwE,IAAImwE,OAAR;AACA,MAAI,OAAOA,QAAQ5gC,WAAf,KAA+B,QAAnC,EAA6C;AAC3CvvC,QAAI,KAAKmvE,UAAL,CAAgBmB,UAAhB,CAA2BH,OAA3B,EAAoCA,OAApC,CAAJ;AACAnwE,MAAEuvC,WAAF,GAAgBiiC,cAAcrB,QAAQ5gC,WAAtB,CAAhB;AACD;;AAED,SAAOvvC,CAAP;AACD,CARD;;AAWA;;;;AAIA+wE,SAAS/gE,SAAT,CAAmB0hE,OAAnB,GAA6B,UAAS1rD,SAAT,EAAoB;AAC/C,SAAO,KAAK8pD,UAAL,CAAgB9pD,UAAUrtB,QAAV,EAAhB,CAAP;AACD,CAFD;;AAKA;;;;;AAKAo4E,SAAS/gE,SAAT,CAAmBghE,aAAnB,GAAmC,UAASb,OAAT,EAAkB;AACnD,OAAKL,UAAL,CAAgBK,QAAQnqD,SAAR,CAAkBrtB,QAAlB,EAAhB,IAAgDw3E,OAAhD;AACA,MAAMnwE,IAAI,KAAKyxE,aAAL,CAAmBtB,OAAnB,CAAV;AACA,OAAKhB,UAAL,CAAgBsB,IAAhB,CAAqBzwE,CAArB,EAAwBmwE,OAAxB;AACD,CAJD;;AAOA;;;;;AAKAY,SAAS/gE,SAAT,CAAmBihE,aAAnB,GAAmC,UAASd,OAAT,EAAkB;AACnD,MAAMnwE,IAAI,KAAKyxE,aAAL,CAAmBtB,OAAnB,CAAV;AACA,OAAKhB,UAAL,CAAgB1Y,IAAhB,CAAqBz2D,CAArB,EAAwBmwE,OAAxB;AACD,CAHD;;AAMA;;;;;AAKAY,SAAS/gE,SAAT,CAAmBkhE,WAAnB,GAAiC,UAASf,OAAT,EAAkB;AACjD,MAAMnwE,IAAI,KAAKyxE,aAAL,CAAmBtB,OAAnB,CAAV;AACA,OAAKhB,UAAL,CAAgBwB,EAAhB,CAAmB3wE,CAAnB,EAAsBmwE,OAAtB;AACA,OAAKuB,OAAL,CAAavB,QAAQnqD,SAArB;AACD,CAJD;;AAOA;;;;;AAKA+qD,SAAS/gE,SAAT,CAAmBmhE,YAAnB,GAAkC,UAAShB,OAAT,EAAkB;AAClD,MAAMnwE,IAAI,KAAKyxE,aAAL,CAAmBtB,OAAnB,CAAV;AACA,OAAKhB,UAAL,CAAgB2B,QAAhB,CAAyB9wE,CAAzB,EAA4BmwE,OAA5B;AACD,CAHD;;AAMA;;;;;AAKAY,SAAS/gE,SAAT,CAAmBohE,aAAnB,GAAmC,UAASjB,OAAT,EAAkB;AACnD,MAAMnwE,IAAI,KAAKyxE,aAAL,CAAmBtB,OAAnB,CAAV;AACA,OAAKhB,UAAL,CAAgB0B,SAAhB,CAA0B7wE,CAA1B,EAA6BmwE,OAA7B;AACD,CAHD;;AAMA;;;;;AAKAY,SAAS/gE,SAAT,CAAmBqhE,eAAnB,GAAqC,UAASlB,OAAT,EAAkB;AACrD,MAAMnwE,IAAI,KAAKyxE,aAAL,CAAmBtB,OAAnB,CAAV;AACA,OAAKhB,UAAL,CAAgBqB,MAAhB,CAAuBxwE,CAAvB,EAA0BmwE,OAA1B;AACA,OAAKuB,OAAL,CAAavB,QAAQnqD,SAArB;AACD,CAJD;;AAOA;;;;;AAKA+qD,SAAS/gE,SAAT,CAAmBuhE,oBAAnB,GAA0C,UAASpB,OAAT,EAAkB;AAC1D,MAAMnwE,IAAI,KAAKmvE,UAAL,CAAgBwC,SAAhB,CAA0B,oBAA1B,EAAgDxB,OAAhD,EAAyDA,OAAzD,CAAV;AACA,OAAKhB,UAAL,CAAgB9yD,aAAhB,CAA8Brc,CAA9B;AACD,CAHD;;AAMA;;;;;AAKA+wE,SAAS/gE,SAAT,CAAmBshE,mBAAnB,GAAyC,UAASnB,OAAT,EAAkB;AACzD,MAAMnwE,IAAI,KAAKmvE,UAAL,CAAgBwC,SAAhB,CAA0B,mBAA1B,EAA+CxB,OAA/C,EAAwDA,OAAxD,CAAV;AACA,OAAKhB,UAAL,CAAgB9yD,aAAhB,CAA8Brc,CAA9B;AACD,CAHD;kBAIe+wE,Q;;;;;;;;;;;;;;;;;;AChKf;;AACA;;;;;;AAEA;;;;;AApCA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAUA,IAAMa,eAAe,SAAfA,YAAe,CAASzC,UAAT,EAAqB;AACxC,MAAMC,UAAU;AACd,mBAAe,KAAKyC,WADN;AAEd,mBAAe,KAAK/iC,WAFN;AAGd,iBAAa,KAAKgjC,SAHJ;AAId,kBAAc,KAAKC,UAJL;AAKd,mBAAe,KAAKC,WALN;AAMd,qBAAiB,KAAKC,aANR;AAOd,yBAAqB,KAAKC,iBAPZ;AAQd,0BAAsB,KAAKC;AARb,GAAhB;AAUAjD,wBAAY79D,IAAZ,CAAiB,IAAjB,EAAuB89D,UAAvB,EAAmCC,OAAnC;AACD,CAZD;;AAcA,qBAASwC,YAAT,EAAuB1C,qBAAvB;;AAGA;;;;;AAKA0C,aAAa5hE,SAAb,CAAuB6hE,WAAvB,GAAqC,UAAS1B,OAAT,EAAkB;AACrD,OAAKhB,UAAL,CAAgBiD,eAAhB,CAAgCjC,OAAhC;AACD,CAFD;;AAKA;;;;;AAKAyB,aAAa5hE,SAAb,CAAuB8+B,WAAvB,GAAqC,UAASqhC,OAAT,EAAkB;AACrD,OAAKhB,UAAL,CAAgBiD,eAAhB,CAAgCjC,OAAhC;AACD,CAFD;;AAKA;;;;;AAKAyB,aAAa5hE,SAAb,CAAuB8hE,SAAvB,GAAmC,UAAS3B,OAAT,EAAkB;AACnD,OAAKhB,UAAL,CAAgBiD,eAAhB,CAAgCjC,OAAhC;AACD,CAFD;;AAKA;;;;;AAKAyB,aAAa5hE,SAAb,CAAuB+hE,UAAvB,GAAoC,UAAS5B,OAAT,EAAkB;AACpD,OAAKhB,UAAL,CAAgBiD,eAAhB,CAAgCjC,OAAhC;AACD,CAFD;;AAKA;;;;;AAKAyB,aAAa5hE,SAAb,CAAuBgiE,WAAvB,GAAqC,UAAS7B,OAAT,EAAkB;AACrD,OAAKhB,UAAL,CAAgBiD,eAAhB,CAAgCjC,OAAhC;AACD,CAFD;;AAKA;;;;;AAKAyB,aAAa5hE,SAAb,CAAuBiiE,aAAvB,GAAuC,UAAS9B,OAAT,EAAkB;AACvD,OAAKhB,UAAL,CAAgBiD,eAAhB,CAAgCjC,OAAhC;AACD,CAFD;;AAKA;;;;;AAKAyB,aAAa5hE,SAAb,CAAuBmiE,kBAAvB,GAA4C,UAAShC,OAAT,EAAkB;AAC5D,OAAKhB,UAAL,CAAgBiD,eAAhB,CAAgCjC,OAAhC;AACD,CAFD;;AAKA;;;;;AAKAyB,aAAa5hE,SAAb,CAAuBkiE,iBAAvB,GAA2C,UAAS/B,OAAT,EAAkB;AAC3D,OAAKhB,UAAL,CAAgBiD,eAAhB,CAAgCjC,OAAhC;AACD,CAFD;kBAGeyB,Y;;;;;;;;;;;;;;;;;;ACvGf;;AACA;;;;;;AAEA;;;;;;;;;;;;;AApCA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAkBA,IAAMS,eAAe,SAAfA,YAAe,CAASj8E,IAAT,EAAegtB,aAAf,EAA8BkvD,aAA9B,EAA6C;AAChEp3D,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;AAIA,OAAKgtB,aAAL,GAAqBA,aAArB;;AAEA,MAAMmvD,YAAYD,gBAAgBA,aAAhB,GAAgC,EAAlD;;AAEA;;;AAGA,OAAKE,OAAL,GAAe,KAAKC,WAAL,CAAiBF,SAAjB,CAAf;;AAEA;;;AAGA,OAAKG,QAAL,GAAgB,KAAKC,YAAL,CAAkBJ,SAAlB,EAA6B,KAAKC,OAAlC,CAAhB;;AAEA;;AAEA;;;AAGA,OAAKI,OAAL,GAAe,aAAaL,SAAb,GAAyBA,UAAU,SAAV,CAAzB,GAAgD,KAA/D;;AAEA;;;AAGA,OAAKM,UAAL,GAAkB,gBAAgBN,SAAhB,GAA4BA,UAAU,YAAV,CAA5B,GAAsD,KAAxE;;AAEA;;;AAGA,OAAK99E,IAAL,GAAY,UAAU89E,SAAV,GAAsBA,UAAU,MAAV,CAAtB,GAA0C,IAAtD;;AAEA;;;AAGA,OAAKO,MAAL,GAAc,YAAYP,SAAZ,GAAwBA,UAAU,QAAV,CAAxB,GAA8C,IAA5D;;AAEA;;;AAGA,OAAKQ,OAAL,GAAe,aAAaR,SAAb,GAAyBA,UAAU,SAAV,CAAzB,GAAgD,CAA/D;;AAEA;;;AAGA,OAAKS,OAAL,GAAe,aAAaT,SAAb,GAAyBA,UAAU,SAAV,CAAzB,GAAgD,CAA/D;;AAEA;;;AAGA,OAAK7rD,OAAL,GAAe,aAAa6rD,SAAb,GAAyBA,UAAU,SAAV,CAAzB,GAAgD,CAA/D;;AAEA;;;AAGA,OAAK5rD,OAAL,GAAe,aAAa4rD,SAAb,GAAyBA,UAAU,SAAV,CAAzB,GAAgD,CAA/D;;AAEA;;;AAGA,OAAKpkC,OAAL,GAAe,aAAaokC,SAAb,GAAyBA,UAAU,SAAV,CAAzB,GAAgD,KAA/D;;AAEA;;;AAGA,OAAKtkC,MAAL,GAAc,YAAYskC,SAAZ,GAAwBA,UAAU,QAAV,CAAxB,GAA8C,KAA5D;;AAEA;;;AAGA,OAAKnkC,QAAL,GAAgB,cAAcmkC,SAAd,GAA0BA,UAAU,UAAV,CAA1B,GAAkD,KAAlE;;AAEA;;;AAGA,OAAKrkC,OAAL,GAAe,aAAaqkC,SAAb,GAAyBA,UAAU,SAAV,CAAzB,GAAgD,KAA/D;;AAEA;;;AAGA,OAAKlsD,MAAL,GAAc,YAAYksD,SAAZ,GAAwBA,UAAU,QAAV,CAAxB,GAA8C,CAA5D;;AAEA;;;AAGA,OAAKU,aAAL,GAAqB,mBAAmBV,SAAnB,GACnBA,UAAU,eAAV,CADmB,GACU,IAD/B;;AAGA;;AAEA;;;;AAIA,OAAKvsD,SAAL,GAAiB,eAAeusD,SAAf,GAA2BA,UAAU,WAAV,CAA3B,GAAoD,CAArE;;AAEA;;;AAGA,OAAKjoD,KAAL,GAAa,WAAWioD,SAAX,GAAuBA,UAAU,OAAV,CAAvB,GAA4C,CAAzD;;AAEA;;;AAGA,OAAKhoD,MAAL,GAAc,YAAYgoD,SAAZ,GAAwBA,UAAU,QAAV,CAAxB,GAA8C,CAA5D;;AAEA;;;AAGA,OAAKW,KAAL,GAAa,WAAWX,SAAX,GAAuBA,UAAU,OAAV,CAAvB,GAA4C,CAAzD;;AAEA;;;AAGA,OAAKY,KAAL,GAAa,WAAWZ,SAAX,GAAuBA,UAAU,OAAV,CAAvB,GAA4C,CAAzD;;AAEA;;;AAGA,OAAKhjC,WAAL,GAAmB,iBAAiBgjC,SAAjB,GAA6BA,UAAU,aAAV,CAA7B,GAAwD,EAA3E;;AAEA;;;AAGA,OAAKa,WAAL,GAAmB,iBAAiBb,SAAjB,GAA6BA,UAAU,aAAV,CAA7B,GAAwD,CAA3E;;AAEA;;;AAGA,OAAK9iC,SAAL,GAAiB,eAAe8iC,SAAf,GAA2BA,UAAU,WAAV,CAA3B,GAAoD,KAArE;;AAEA;AACA,MAAInvD,cAAcM,cAAlB,EAAkC;AAChC,SAAKA,cAAL,GAAsB,YAAW;AAC/BN,oBAAcM,cAAd;AACD,KAFD;AAGD;AACF,CA/ID;;AAiJA,qBAAS2uD,YAAT,EAAuBn3D,eAAvB;;AAGA;;;;AAIA,IAAIm4D,cAAc,KAAlB;;AAGA;;;;;AAKAhB,aAAariE,SAAb,CAAuByiE,WAAvB,GAAqC,UAASF,SAAT,EAAoB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAIC,gBAAJ;AACA,MAAID,UAAUC,OAAV,IAAqBa,WAAzB,EAAsC;AACpCb,cAAUD,UAAUC,OAApB;AACD,GAFD,MAEO;AACL,YAAQD,UAAUe,KAAlB;AACE,WAAK,CAAL;AAAQd,kBAAU,CAAV,CAAa;AACrB,WAAK,CAAL;AAAQA,kBAAU,CAAV,CAAa;AACrB,WAAK,CAAL;AAAQA,kBAAU,CAAV,CAAa;AACrB;AAASA,kBAAU,CAAV;AAJX;AAMD;AACD,SAAOA,OAAP;AACD,CAlCD;;AAqCA;;;;;;AAMAH,aAAariE,SAAb,CAAuB2iE,YAAvB,GAAsC,UAASJ,SAAT,EAAoBC,OAApB,EAA6B;AACjE;AACA;AACA,MAAIE,WAAW,CAAf;AACA,MAAIH,UAAUG,QAAd,EAAwB;AACtBA,eAAWH,UAAUG,QAArB;AACD,GAFD,MAEO;AACLA,eAAWF,UAAU,GAAV,GAAgB,CAA3B;AACD;AACD,SAAOE,QAAP;AACD,CAVD;;AAaA;;;AAGA,CAAC,YAAW;AACV,MAAI;AACF,QAAMa,KAAK,IAAIC,UAAJ,CAAe,OAAf,EAAwB,EAAChB,SAAS,CAAV,EAAxB,CAAX;AACAa,kBAAcE,GAAGf,OAAH,KAAe,CAA7B;AACD,GAHD,CAGE,OAAOxyE,CAAP,EAAU;AACV;AACD;AACF,CAPD;kBAQeqyE,Y;;;;;;;;;;;;;;;;;;ACnPf;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;;;;;AA5CA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAkBA,IAAM5tD,sBAAsB,SAAtBA,mBAAsB,CAAStJ,OAAT,EAAkB;AAC5CmE,wBAAYjO,IAAZ,CAAiB,IAAjB;;AAEA;;;;;AAKA,OAAKoiE,QAAL,GAAgBt4D,OAAhB;;AAEA;;;;AAIA,OAAK20D,UAAL,GAAkB,EAAlB;;AAEA;;;;AAIA,OAAK4D,SAAL,GAAiB,EAAjB;;AAEA;;;;AAIA,OAAKC,gBAAL,GAAwB,EAAxB;;AAEA,OAAKC,eAAL;AACD,CA7BD;;AA+BA,qBAASnvD,mBAAT,EAA8BnF,qBAA9B;;AAEA;;;;AAIA,IAAMu0D,cAAc;AAClB;AACA,CAAC,SAAD,EAAY,KAAZ,CAFkB,EAGlB,CAAC,YAAD,EAAe,KAAf,CAHkB,EAIlB,CAAC,MAAD,EAAS,IAAT,CAJkB,EAKlB,CAAC,QAAD,EAAW,IAAX,CALkB,EAMlB,CAAC,SAAD,EAAY,CAAZ,CANkB,EAOlB,CAAC,SAAD,EAAY,CAAZ,CAPkB,EAQlB,CAAC,SAAD,EAAY,CAAZ,CARkB,EASlB,CAAC,SAAD,EAAY,CAAZ,CATkB,EAUlB,CAAC,SAAD,EAAY,KAAZ,CAVkB,EAWlB,CAAC,QAAD,EAAW,KAAX,CAXkB,EAYlB,CAAC,UAAD,EAAa,KAAb,CAZkB,EAalB,CAAC,SAAD,EAAY,KAAZ,CAbkB,EAclB,CAAC,QAAD,EAAW,CAAX,CAdkB,EAelB,CAAC,eAAD,EAAkB,IAAlB,CAfkB;AAgBlB;AACA,CAAC,SAAD,EAAY,CAAZ,CAjBkB;AAkBlB;AACA,CAAC,WAAD,EAAc,CAAd,CAnBkB,EAoBlB,CAAC,OAAD,EAAU,CAAV,CApBkB,EAqBlB,CAAC,QAAD,EAAW,CAAX,CArBkB,EAsBlB,CAAC,UAAD,EAAa,CAAb,CAtBkB,EAuBlB,CAAC,OAAD,EAAU,CAAV,CAvBkB,EAwBlB,CAAC,OAAD,EAAU,CAAV,CAxBkB,EAyBlB,CAAC,aAAD,EAAgB,EAAhB,CAzBkB,EA0BlB,CAAC,aAAD,EAAgB,CAAhB,CA1BkB,EA2BlB,CAAC,WAAD,EAAc,KAAd,CA3BkB;AA4BlB;AACA,CAAC,MAAD,EAAS,EAAT,CA7BkB,EA8BlB,CAAC,QAAD,EAAW,IAAX,CA9BkB,EA+BlB,CAAC,eAAD,EAAkB,IAAlB,CA/BkB,EAgClB,CAAC,OAAD,EAAU,CAAV,CAhCkB,CAApB;;AAoCA;;;;AAIApvD,oBAAoBzU,SAApB,CAA8B4jE,eAA9B,GAAgD,YAAW;AACzD,MAAIznB,YAAJ,EAAa;AACX,SAAK2nB,cAAL,CAAoB,QAApB,EAA8B,IAAIlC,sBAAJ,CAAiB,IAAjB,CAA9B;AACD,GAFD,MAEO,IAAIxlB,cAAJ,EAAe;AACpB,SAAK0nB,cAAL,CAAoB,IAApB,EAA0B,IAAI/C,kBAAJ,CAAa,IAAb,CAA1B;AACD,GAFM,MAEA;AACL,QAAMgD,cAAc,IAAIvE,qBAAJ,CAAgB,IAAhB,CAApB;AACA,SAAKsE,cAAL,CAAoB,OAApB,EAA6BC,WAA7B;;AAEA,QAAI5pD,UAAJ,EAAW;AACT,WAAK2pD,cAAL,CAAoB,OAApB,EAA6B,IAAIE,qBAAJ,CAAgB,IAAhB,EAAsBD,WAAtB,CAA7B;AACD;AACF;;AAED;AACA,OAAKE,SAAL;AACD,CAhBD;;AAmBA;;;;;;AAMAxvD,oBAAoBzU,SAApB,CAA8B8jE,cAA9B,GAA+C,UAAS39E,IAAT,EAAelC,MAAf,EAAuB;AACpE,MAAMmN,IAAInN,MAAV;AACA,MAAMigF,YAAY9yE,EAAEkuE,SAAF,EAAlB;;AAEA,MAAI4E,SAAJ,EAAe;AACbA,cAAU1+E,OAAV,CAAkB,UAASwK,CAAT,EAAY;AAC5B,UAAMm0E,UAAU/yE,EAAEmuE,kBAAF,CAAqBvvE,CAArB,CAAhB;;AAEA,UAAIm0E,OAAJ,EAAa;AACX,aAAKT,SAAL,CAAe1zE,CAAf,IAAoBm0E,QAAQ/nE,IAAR,CAAahL,CAAb,CAApB;AACD;AACF,KANiB,CAMhBgL,IANgB,CAMX,IANW,CAAlB;AAOA,SAAKunE,gBAAL,CAAsB77E,IAAtB,CAA2BsJ,CAA3B;AACD;AACF,CAdD;;AAiBA;;;;AAIAqjB,oBAAoBzU,SAApB,CAA8BikE,SAA9B,GAA0C,YAAW;AACnD,MAAMjmE,IAAI,KAAK2lE,gBAAL,CAAsB59E,MAAhC;AACA,OAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIkY,CAApB,EAAuBlY,GAAvB,EAA4B;AAC1B,QAAMs+E,cAAc,KAAKT,gBAAL,CAAsB79E,CAAtB,CAApB;AACA,SAAKu+E,UAAL,CAAgBD,YAAY9E,SAAZ,EAAhB;AACD;AACF,CAND;;AASA;;;;AAIA7qD,oBAAoBzU,SAApB,CAA8BskE,WAA9B,GAA4C,YAAW;AACrD,MAAMtmE,IAAI,KAAK2lE,gBAAL,CAAsB59E,MAAhC;AACA,OAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIkY,CAApB,EAAuBlY,GAAvB,EAA4B;AAC1B,QAAMs+E,cAAc,KAAKT,gBAAL,CAAsB79E,CAAtB,CAApB;AACA,SAAKy+E,aAAL,CAAmBH,YAAY9E,SAAZ,EAAnB;AACD;AACF,CAND;;AASA;;;;;AAKA7qD,oBAAoBzU,SAApB,CAA8BwkE,aAA9B,GAA8C,UAASrE,OAAT,EAAkB;AAC9D,MAAM/5E,OAAO+5E,QAAQ/5E,IAArB;AACA,MAAM+9E,UAAU,KAAKT,SAAL,CAAet9E,IAAf,CAAhB;AACA,MAAI+9E,OAAJ,EAAa;AACXA,YAAQhE,OAAR;AACD;AACF,CAND;;AASA;;;;;AAKA1rD,oBAAoBzU,SAApB,CAA8BqkE,UAA9B,GAA2C,UAASI,MAAT,EAAiB;AAC1DA,SAAOj/E,OAAP,CAAe,UAASk/E,SAAT,EAAoB;AACjC,wBAAO,KAAKjB,QAAZ,EAAsBiB,SAAtB,EAAiC,KAAKF,aAAtC,EAAqD,IAArD;AACD,GAFc,CAEbpoE,IAFa,CAER,IAFQ,CAAf;AAGD,CAJD;;AAOA;;;;;AAKAqY,oBAAoBzU,SAApB,CAA8BukE,aAA9B,GAA8C,UAASE,MAAT,EAAiB;AAC7DA,SAAOj/E,OAAP,CAAe,UAASwK,CAAT,EAAY;AACzB,0BAAS,KAAKyzE,QAAd,EAAwBzzE,CAAxB,EAA2B,KAAKw0E,aAAhC,EAA+C,IAA/C;AACD,GAFc,CAEbpoE,IAFa,CAER,IAFQ,CAAf;AAGD,CAJD;;AAOA;;;;;;;;;AASAqY,oBAAoBzU,SAApB,CAA8BsgE,UAA9B,GAA2C,UAASzqD,KAAT,EAAgBsqD,OAAhB,EAAyB;AAClE,MAAMwE,YAAY,EAAlB;AACA,OAAK,IAAI7+E,IAAI,CAAR,EAAWwkB,KAAKu5D,YAAY99E,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiDxkB,GAAjD,EAAsD;AACpD,QAAM46E,IAAImD,YAAY/9E,CAAZ,EAAe,CAAf,CAAV;AACA6+E,cAAUjE,CAAV,IAAe7qD,MAAM6qD,CAAN,KAAYP,QAAQO,CAAR,CAAZ,IAA0BmD,YAAY/9E,CAAZ,EAAe,CAAf,CAAzC;AACD;;AAED,SAAO6+E,SAAP;AACD,CARD;;AAWA;;;AAGA;;;;;AAKAlwD,oBAAoBzU,SAApB,CAA8BygE,IAA9B,GAAqC,UAASz5D,IAAT,EAAe6O,KAAf,EAAsB;AACzD,OAAK+uD,SAAL,CAAehwD,oBAAiBC,WAAhC,EAA6C7N,IAA7C,EAAmD6O,KAAnD;AACD,CAFD;;AAKA;;;;;AAKApB,oBAAoBzU,SAApB,CAA8BymD,IAA9B,GAAqC,UAASz/C,IAAT,EAAe6O,KAAf,EAAsB;AACzD,OAAK+uD,SAAL,CAAehwD,oBAAiBI,WAAhC,EAA6ChO,IAA7C,EAAmD6O,KAAnD;AACD,CAFD;;AAKA;;;;;AAKApB,oBAAoBzU,SAApB,CAA8B2gE,EAA9B,GAAmC,UAAS35D,IAAT,EAAe6O,KAAf,EAAsB;AACvD,OAAK+uD,SAAL,CAAehwD,oBAAiBkB,SAAhC,EAA2C9O,IAA3C,EAAiD6O,KAAjD;AACD,CAFD;;AAKA;;;;;AAKApB,oBAAoBzU,SAApB,CAA8B6kE,KAA9B,GAAsC,UAAS79D,IAAT,EAAe6O,KAAf,EAAsB;AAC1D7O,OAAK47D,OAAL,GAAe,KAAf;AACA,OAAKgC,SAAL,CAAehwD,oBAAiBkC,YAAhC,EAA8C9P,IAA9C,EAAoD6O,KAApD;AACD,CAHD;;AAMA;;;;;AAKApB,oBAAoBzU,SAApB,CAA8B8kE,KAA9B,GAAsC,UAAS99D,IAAT,EAAe6O,KAAf,EAAsB;AAC1D7O,OAAK47D,OAAL,GAAe,KAAf;AACA,OAAKgC,SAAL,CAAehwD,oBAAiBmC,YAAhC,EAA8C/P,IAA9C,EAAoD6O,KAApD;AACD,CAHD;;AAMA;;;;;AAKApB,oBAAoBzU,SAApB,CAA8B+kE,IAA9B,GAAqC,UAAS/9D,IAAT,EAAe6O,KAAf,EAAsB;AACzD7O,OAAK47D,OAAL,GAAe,IAAf;AACA,OAAKgC,SAAL,CAAehwD,oBAAiBgC,WAAhC,EAA6C5P,IAA7C,EAAmD6O,KAAnD;AACD,CAHD;;AAMA;;;;;AAKApB,oBAAoBzU,SAApB,CAA8BnV,GAA9B,GAAoC,UAASmc,IAAT,EAAe6O,KAAf,EAAsB;AACxD7O,OAAK47D,OAAL,GAAe,IAAf;AACA,OAAKgC,SAAL,CAAehwD,oBAAiBiC,UAAhC,EAA4C7P,IAA5C,EAAkD6O,KAAlD;AACD,CAHD;;AAMA;;;;;AAKApB,oBAAoBzU,SAApB,CAA8BwgE,MAA9B,GAAuC,UAASx5D,IAAT,EAAe6O,KAAf,EAAsB;AAC3D,OAAK+uD,SAAL,CAAehwD,oBAAiBmB,aAAhC,EAA+C/O,IAA/C,EAAqD6O,KAArD;AACD,CAFD;;AAKA;;;;;AAKApB,oBAAoBzU,SAApB,CAA8B8gE,QAA9B,GAAyC,UAAS95D,IAAT,EAAe6O,KAAf,EAAsB;AAC7D,OAAKhrB,GAAL,CAASmc,IAAT,EAAe6O,KAAf;AACA,MAAI,CAAC,KAAKmvD,SAAL,CAAeh+D,KAAKxiB,MAApB,EAA4BwiB,KAAKi8D,aAAjC,CAAL,EAAsD;AACpD,SAAK6B,KAAL,CAAW99D,IAAX,EAAiB6O,KAAjB;AACD;AACF,CALD;;AAQA;;;;;AAKApB,oBAAoBzU,SAApB,CAA8B6gE,SAA9B,GAA0C,UAAS75D,IAAT,EAAe6O,KAAf,EAAsB;AAC9D,OAAKkvD,IAAL,CAAU/9D,IAAV,EAAgB6O,KAAhB;AACA,MAAI,CAAC,KAAKmvD,SAAL,CAAeh+D,KAAKxiB,MAApB,EAA4BwiB,KAAKi8D,aAAjC,CAAL,EAAsD;AACpD,SAAK4B,KAAL,CAAW79D,IAAX,EAAiB6O,KAAjB;AACD;AACF,CALD;;AAQA;;;;;;;AAOApB,oBAAoBzU,SAApB,CAA8BglE,SAA9B,GAA0C,UAASC,SAAT,EAAoBC,SAApB,EAA+B;AACvE,MAAI,CAACD,SAAD,IAAc,CAACC,SAAnB,EAA8B;AAC5B,WAAO,KAAP;AACD;AACD,SAAOD,UAAU/+C,QAAV,CAAmBg/C,SAAnB,CAAP;AACD,CALD;;AAQA;AACA;;;;;;;;;AASAzwD,oBAAoBzU,SAApB,CAA8B2hE,SAA9B,GAA0C,UAASwD,MAAT,EAAiBn+D,IAAjB,EAAuB6O,KAAvB,EAA8B;AACtE,SAAO,IAAIwsD,sBAAJ,CAAiB8C,MAAjB,EAAyBtvD,KAAzB,EAAgC7O,IAAhC,CAAP;AACD,CAFD;;AAKA;;;;;;AAMAyN,oBAAoBzU,SAApB,CAA8B4kE,SAA9B,GAA0C,UAASO,MAAT,EAAiBn+D,IAAjB,EAAuB6O,KAAvB,EAA8B;AACtE,MAAM7lB,IAAI,KAAK2xE,SAAL,CAAewD,MAAf,EAAuBn+D,IAAvB,EAA6B6O,KAA7B,CAAV;AACA,OAAKxJ,aAAL,CAAmBrc,CAAnB;AACD,CAHD;;AAMA;;;;;AAKAykB,oBAAoBzU,SAApB,CAA8BoiE,eAA9B,GAAgD,UAASvsD,KAAT,EAAgB;AAC9D,MAAM7lB,IAAI,KAAK2xE,SAAL,CAAe9rD,MAAMzvB,IAArB,EAA2ByvB,KAA3B,EAAkCA,KAAlC,CAAV;AACA,OAAKxJ,aAAL,CAAmBrc,CAAnB;AACD,CAHD;;AAMA;;;;;;;AAOAykB,oBAAoBzU,SAApB,CAA8BolE,cAA9B,GAA+C,UAASntD,SAAT,EAAoBpC,KAApB,EAA2B;AACxE,MAAMV,eAAe,KAAKwsD,SAAL,CACnB1pD,SADmB,EACRunD,sBAAYa,YAAZ,CAAyBxqD,KAAzB,EAAgC,IAAhC,CADQ,EAC+BA,KAD/B,CAArB;AAEA,SAAOV,YAAP;AACD,CAJD;;AAOA;;;AAGAV,oBAAoBzU,SAApB,CAA8BkN,eAA9B,GAAgD,YAAW;AACzD,OAAKo3D,WAAL;AACAh1D,wBAAYtP,SAAZ,CAAsBkN,eAAtB,CAAsC7L,IAAtC,CAA2C,IAA3C;AACD,CAHD;;kBAMeoT,mB;;;;;;;;;;;;;;;;;;ACxZf;;AACA;;AACA;;;;AACA;;;;AAGA;;;;;;AAvCA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAcA,IAAMuvD,cAAc,SAAdA,WAAc,CAAS7E,UAAT,EAAqB4E,WAArB,EAAkC;AACpD,MAAM3E,UAAU;AACd,kBAAc,KAAKiG,UADL;AAEd,iBAAa,KAAKC,SAFJ;AAGd,gBAAY,KAAKC,QAHH;AAId,mBAAe,KAAKC;AAJN,GAAhB;AAMAtG,wBAAY79D,IAAZ,CAAiB,IAAjB,EAAuB89D,UAAvB,EAAmCC,OAAnC;;AAEA;;;;AAIA,OAAKU,UAAL,GAAkBX,WAAWW,UAA7B;;AAEA;;;;AAIA,OAAKiE,WAAL,GAAmBA,WAAnB;;AAEA;;;;AAIA,OAAK0B,aAAL,GAAqB/+E,SAArB;;AAEA;;;;AAIA,OAAKg/E,WAAL,GAAmB,CAAnB;;AAEA;;;;AAIA,OAAKC,QAAL,GAAgBj/E,SAAhB;;AAEA;;;;;;AAMA,OAAKk/E,aAAL,GAAqB,IAArB;AACD,CA9CD;;AAgDA,qBAAS5B,WAAT,EAAsB9E,qBAAtB;;AAGA;;;AAGA,IAAM2G,sBAAsB,GAA5B;;AAGA;;;AAGA,IAAMjf,eAAe,OAArB;;AAEA;;;;;AAKAod,YAAYhkE,SAAZ,CAAsB8lE,eAAtB,GAAwC,UAASC,OAAT,EAAkB;AACxD,SAAO,KAAKN,aAAL,KAAuBM,QAAQC,UAAtC;AACD,CAFD;;AAKA;;;;;AAKAhC,YAAYhkE,SAAZ,CAAsBimE,gBAAtB,GAAyC,UAASF,OAAT,EAAkB;AACzD,MAAMG,QAAQtgF,OAAO6N,IAAP,CAAY,KAAKqsE,UAAjB,EAA6B/5E,MAA3C;AACA,MAAImgF,UAAU,CAAV,IAAgBA,UAAU,CAAV,IAAelG,wBAAWr3E,QAAX,MAAyB,KAAKm3E,UAAjE,EAA8E;AAC5E,SAAK2F,aAAL,GAAqBM,QAAQC,UAA7B;AACA,SAAKG,sBAAL;AACD;AACF,CAND;;AASA;;;;AAIAnC,YAAYhkE,SAAZ,CAAsBomE,qBAAtB,GAA8C,UAASC,SAAT,EAAoB;AAChE,MAAIA,UAAU5mC,SAAd,EAAyB;AACvB,SAAKgmC,aAAL,GAAqB/+E,SAArB;AACA,SAAK4/E,gBAAL;AACD;AACF,CALD;;AAQA;;;AAGAtC,YAAYhkE,SAAZ,CAAsBsmE,gBAAtB,GAAyC,YAAW;AAClD,OAAKX,QAAL,GAAgBjwD,WACd,KAAK6wD,uBAAL,CAA6BnqE,IAA7B,CAAkC,IAAlC,CADc,EAEdypE,mBAFc,CAAhB;AAGD,CAJD;;AAOA;;;AAGA7B,YAAYhkE,SAAZ,CAAsBumE,uBAAtB,GAAgD,YAAW;AACzD,OAAKb,WAAL,GAAmB,CAAnB;AACA,OAAKC,QAAL,GAAgBj/E,SAAhB;AACD,CAHD;;AAMA;;;AAGAs9E,YAAYhkE,SAAZ,CAAsBmmE,sBAAtB,GAA+C,YAAW;AACxD,MAAI,KAAKR,QAAL,KAAkBj/E,SAAtB,EAAiC;AAC/B8uB,iBAAa,KAAKmwD,QAAlB;AACD;AACF,CAJD;;AAOA;;;;;;AAMA3B,YAAYhkE,SAAZ,CAAsBwmE,eAAtB,GAAwC,UAASxzD,YAAT,EAAuB+yD,OAAvB,EAAgC;AACtE,MAAM/1E,IAAI,KAAKmvE,UAAL,CAAgBmB,UAAhB,CAA2BttD,YAA3B,EAAyC+yD,OAAzC,CAAV;AACA;AACA;AACA;AACA/1E,IAAEgmB,SAAF,GAAc+vD,QAAQC,UAAR,GAAqB,CAAnC;AACA;AACA;AACAh2E,IAAE4yE,OAAF,GAAY,IAAZ;AACA5yE,IAAE6yE,UAAF,GAAe,IAAf;AACA7yE,IAAE8yE,MAAF,GAAW,KAAK4C,WAAhB;AACA11E,IAAEqmB,MAAF,GAAW,CAAX;AACArmB,IAAEwyE,OAAF,GAAY,CAAZ;AACAxyE,IAAEsqB,KAAF,GAAUyrD,QAAQU,aAAR,IAAyBV,QAAQW,OAAjC,IAA4C,CAAtD;AACA12E,IAAEuqB,MAAF,GAAWwrD,QAAQY,aAAR,IAAyBZ,QAAQa,OAAjC,IAA4C,CAAvD;AACA52E,IAAE0yE,QAAF,GAAaqD,QAAQc,WAAR,IAAuBd,QAAQe,KAA/B,IAAwC,GAArD;AACA92E,IAAEyvC,SAAF,GAAc,KAAKqmC,eAAL,CAAqBC,OAArB,CAAd;AACA/1E,IAAEuvC,WAAF,GAAgBqnB,YAAhB;;AAEA;AACA;AACA52D,IAAE0mB,OAAF,GAAYqvD,QAAQrvD,OAApB;AACA1mB,IAAE2mB,OAAF,GAAYovD,QAAQpvD,OAApB;AACA3mB,IAAE+yE,OAAF,GAAYgD,QAAQhD,OAApB;AACA/yE,IAAEgzE,OAAF,GAAY+C,QAAQ/C,OAApB;;AAEA,SAAOhzE,CAAP;AACD,CA3BD;;AA8BA;;;;;AAKAg0E,YAAYhkE,SAAZ,CAAsB+mE,eAAtB,GAAwC,UAAS5G,OAAT,EAAkB6G,UAAlB,EAA8B;AACpE,MAAMC,UAAU9/E,MAAM6Y,SAAN,CAAgBra,KAAhB,CAAsB0b,IAAtB,CAA2B8+D,QAAQnhD,cAAnC,CAAhB;AACA,MAAMknD,QAAQe,QAAQlhF,MAAtB;AACA,WAAS2tB,cAAT,GAA0B;AACxBysD,YAAQzsD,cAAR;AACD;AACD,OAAK,IAAI5tB,IAAI,CAAb,EAAgBA,IAAIogF,KAApB,EAA2B,EAAEpgF,CAA7B,EAAgC;AAC9B,QAAMohF,UAAU,KAAKV,eAAL,CAAqBrG,OAArB,EAA8B8G,QAAQnhF,CAAR,CAA9B,CAAhB;AACA;AACAohF,YAAQxzD,cAAR,GAAyBA,cAAzB;AACAszD,eAAW3lE,IAAX,CAAgB,IAAhB,EAAsB8+D,OAAtB,EAA+B+G,OAA/B;AACD;AACF,CAZD;;AAeA;;;;;;AAMAlD,YAAYhkE,SAAZ,CAAsBmnE,UAAtB,GAAmC,UAASC,SAAT,EAAoBC,QAApB,EAA8B;AAC/D,MAAMrpE,IAAIopE,UAAUrhF,MAApB;AACA,OAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIkY,CAApB,EAAuBlY,GAAvB,EAA4B;AAC1B,QAAMwhF,QAAQF,UAAUthF,CAAV,CAAd;AACA,QAAIwhF,MAAMtB,UAAN,KAAqBqB,QAAzB,EAAmC;AACjC,aAAO,IAAP;AACD;AACF;AACD,SAAO,KAAP;AACD,CATD;;AAYA;;;;;;;;;;;AAWArD,YAAYhkE,SAAZ,CAAsBunE,cAAtB,GAAuC,UAASpH,OAAT,EAAkB;AACvD,MAAMiH,YAAYjH,QAAQ8G,OAA1B;AACA;AACA;AACA,MAAMxzE,OAAO7N,OAAO6N,IAAP,CAAY,KAAKqsE,UAAjB,CAAb;AACA,MAAMoG,QAAQzyE,KAAK1N,MAAnB;AACA,MAAImgF,SAASkB,UAAUrhF,MAAvB,EAA+B;AAC7B,QAAM8Y,IAAI,EAAV;AACA,SAAK,IAAI/Y,IAAI,CAAb,EAAgBA,IAAIogF,KAApB,EAA2B,EAAEpgF,CAA7B,EAAgC;AAC9B,UAAMqI,MAAMsF,KAAK3N,CAAL,CAAZ;AACA,UAAMuD,QAAQ,KAAKy2E,UAAL,CAAgB3xE,GAAhB,CAAd;AACA;AACA;AACA;AACA,UAAIA,OAAO6xE,uBAAP,IAAqB,CAAC,KAAKmH,UAAL,CAAgBC,SAAhB,EAA2Bj5E,MAAM,CAAjC,CAA1B,EAA+D;AAC7D0Q,UAAE/W,IAAF,CAAOuB,MAAMwB,GAAb;AACD;AACF;AACD,SAAK,IAAI/E,KAAI,CAAb,EAAgBA,KAAI+Y,EAAE9Y,MAAtB,EAA8B,EAAED,EAAhC,EAAmC;AACjC,WAAK0hF,UAAL,CAAgBrH,OAAhB,EAAyBthE,EAAE/Y,EAAF,CAAzB;AACD;AACF;AACF,CAtBD;;AAyBA;;;;;;AAMAk+E,YAAYhkE,SAAZ,CAAsBqlE,UAAtB,GAAmC,UAASlF,OAAT,EAAkB;AACnD,OAAKoH,cAAL,CAAoBpH,OAApB;AACA,OAAK8F,gBAAL,CAAsB9F,QAAQnhD,cAAR,CAAuB,CAAvB,CAAtB;AACA,OAAKyoD,gBAAL,CAAsBtH,OAAtB;AACA,OAAKuF,WAAL;AACA,OAAKqB,eAAL,CAAqB5G,OAArB,EAA8B,KAAKuH,SAAnC;AACD,CAND;;AASA;;;;;AAKA1D,YAAYhkE,SAAZ,CAAsB0nE,SAAtB,GAAkC,UAAS10D,YAAT,EAAuBqzD,SAAvB,EAAkC;AAClE,OAAKvG,UAAL,CAAgBuG,UAAUrwD,SAA1B,IAAuC;AACrCxxB,YAAQ6hF,UAAU7hF,MADmB;AAErCqG,SAAKw7E,SAFgC;AAGrCsB,eAAWtB,UAAU7hF;AAHgB,GAAvC;AAKA,OAAK26E,UAAL,CAAgB4F,IAAhB,CAAqBsB,SAArB,EAAgCrzD,YAAhC;AACA,OAAKmsD,UAAL,CAAgB0F,KAAhB,CAAsBwB,SAAtB,EAAiCrzD,YAAjC;AACA,OAAKmsD,UAAL,CAAgBsB,IAAhB,CAAqB4F,SAArB,EAAgCrzD,YAAhC;AACD,CATD;;AAYA;;;;;AAKAgxD,YAAYhkE,SAAZ,CAAsBslE,SAAtB,GAAkC,UAASnF,OAAT,EAAkB;AAClDA,UAAQzsD,cAAR;AACA,OAAKqzD,eAAL,CAAqB5G,OAArB,EAA8B,KAAKyH,YAAnC;AACD,CAHD;;AAMA;;;;;AAKA5D,YAAYhkE,SAAZ,CAAsB4nE,YAAtB,GAAqC,UAAS50D,YAAT,EAAuBqzD,SAAvB,EAAkC;AACrE,MAAMxwD,QAAQwwD,SAAd;AACA,MAAMa,UAAU,KAAKpH,UAAL,CAAgBjqD,MAAMG,SAAtB,CAAhB;AACA;AACA,MAAI,CAACkxD,OAAL,EAAc;AACZ;AACD;AACD,MAAMW,WAAWX,QAAQr8E,GAAzB;AACA,MAAM88E,YAAYT,QAAQS,SAA1B;AACA,OAAKxI,UAAL,CAAgB1Y,IAAhB,CAAqB5wC,KAArB,EAA4B7C,YAA5B;AACA,MAAI60D,YAAYF,cAAc9xD,MAAMrxB,MAApC,EAA4C;AAC1CqjF,aAAS5E,aAAT,GAAyBptD,MAAMrxB,MAA/B;AACAqxB,UAAMotD,aAAN,GAAsB0E,SAAtB;AACA;AACAE,aAASrjF,MAAT,GAAkBmjF,SAAlB;AACA,QAAI9xD,MAAMrxB,MAAV,EAAkB;AAChB,WAAK26E,UAAL,CAAgB2B,QAAhB,CAAyB+G,QAAzB,EAAmC70D,YAAnC;AACA,WAAKmsD,UAAL,CAAgB0B,SAAhB,CAA0BhrD,KAA1B,EAAiC7C,YAAjC;AACD,KAHD,MAGO;AACL;AACA6C,YAAMrxB,MAAN,GAAemjF,SAAf;AACA9xD,YAAMotD,aAAN,GAAsB,IAAtB;AACA,WAAKuE,UAAL,CAAgBx0D,YAAhB,EAA8B6C,KAA9B;AACD;AACF;AACDqxD,UAAQr8E,GAAR,GAAcgrB,KAAd;AACAqxD,UAAQS,SAAR,GAAoB9xD,MAAMrxB,MAA1B;AACD,CA3BD;;AA8BA;;;;;;AAMAw/E,YAAYhkE,SAAZ,CAAsBulE,QAAtB,GAAiC,UAASpF,OAAT,EAAkB;AACjD,OAAKsH,gBAAL,CAAsBtH,OAAtB;AACA,OAAK4G,eAAL,CAAqB5G,OAArB,EAA8B,KAAK2H,MAAnC;AACD,CAHD;;AAMA;;;;;AAKA9D,YAAYhkE,SAAZ,CAAsB8nE,MAAtB,GAA+B,UAAS90D,YAAT,EAAuBqzD,SAAvB,EAAkC;AAC/D,OAAKlH,UAAL,CAAgBwB,EAAhB,CAAmB0F,SAAnB,EAA8BrzD,YAA9B;AACA,OAAKmsD,UAAL,CAAgBt0E,GAAhB,CAAoBw7E,SAApB,EAA+BrzD,YAA/B;AACA,OAAKmsD,UAAL,CAAgB2F,KAAhB,CAAsBuB,SAAtB,EAAiCrzD,YAAjC;AACA,OAAK+0D,eAAL,CAAqB1B,SAArB;AACD,CALD;;AAQA;;;;;;AAMArC,YAAYhkE,SAAZ,CAAsBwlE,WAAtB,GAAoC,UAASrF,OAAT,EAAkB;AACpD,OAAK4G,eAAL,CAAqB5G,OAArB,EAA8B,KAAKqH,UAAnC;AACD,CAFD;;AAKA;;;;;AAKAxD,YAAYhkE,SAAZ,CAAsBwnE,UAAtB,GAAmC,UAASx0D,YAAT,EAAuBqzD,SAAvB,EAAkC;AACnE,OAAKlH,UAAL,CAAgBqB,MAAhB,CAAuB6F,SAAvB,EAAkCrzD,YAAlC;AACA,OAAKmsD,UAAL,CAAgBt0E,GAAhB,CAAoBw7E,SAApB,EAA+BrzD,YAA/B;AACA,OAAKmsD,UAAL,CAAgB2F,KAAhB,CAAsBuB,SAAtB,EAAiCrzD,YAAjC;AACA,OAAK+0D,eAAL,CAAqB1B,SAArB;AACD,CALD;;AAQA;;;;AAIArC,YAAYhkE,SAAZ,CAAsB+nE,eAAtB,GAAwC,UAAS1B,SAAT,EAAoB;AAC1D,SAAO,KAAKvG,UAAL,CAAgBuG,UAAUrwD,SAA1B,CAAP;AACA,OAAKowD,qBAAL,CAA2BC,SAA3B;AACD,CAHD;;AAMA;;;;;;AAMArC,YAAYhkE,SAAZ,CAAsBynE,gBAAtB,GAAyC,UAAStH,OAAT,EAAkB;AACzD,MAAMC,MAAM,KAAK2D,WAAL,CAAiBhE,WAA7B;AACA,MAAMz1E,IAAI61E,QAAQnhD,cAAR,CAAuB,CAAvB,CAAV;AACA;AACA,MAAI,KAAK8mD,eAAL,CAAqBx7E,CAArB,CAAJ,EAA6B;AAC3B;AACA,QAAMiE,KAAK,CAACjE,EAAEosB,OAAH,EAAYpsB,EAAEqsB,OAAd,CAAX;AACAypD,QAAIt4E,IAAJ,CAASyG,EAAT;;AAEAmnB,eAAW,YAAW;AACpB;AACA,yBAAO0qD,GAAP,EAAY7xE,EAAZ;AACD,KAHD,EAGG,KAAKq3E,aAHR;AAID;AACF,CAdD;kBAee5B,W;;;;;;;;;;;;;;;;;;QCzVCgE,c,GAAAA,c;QAoBAC,iB,GAAAA,iB;QAkBAC,a,GAAAA,a;QASAC,c,GAAAA,c;QAcA95E,G,GAAAA,G;QAgCA+5E,kB,GAAAA,kB;QA4CAC,wB,GAAAA,wB;QAyBAC,uB,GAAAA,uB;QAaAC,mB,GAAAA,mB;QAWAC,gB,GAAAA,gB;QAoBAC,sC,GAAAA,sC;QA4CAC,uB,GAAAA,uB;QAiBAC,U,GAAAA,U;QAeAC,Q,GAAAA,Q;QAqBAC,U,GAAAA,U;QAuBAC,2B,GAAAA,2B;QAqBAC,Y,GAAAA,Y;QAqBApyC,S,GAAAA,S;QAgBAqyC,e,GAAAA,e;QAcAC,wB,GAAAA,wB;QAUAC,S,GAAAA,S;;AAhchB;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;IAAYC,W;;AACZ;;;;;;AAGA;;;;;;;AAQA;;;;;;;;;;QAWQ75C,e,GAAAA,sB;;AAGR;;;;;;;AAxFA;;;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2FO,SAAS04C,cAAT,CAAwB5+E,KAAxB,EAA+BggF,UAA/B,EAA2CC,aAA3C,EAA0D;AAC/D,MAAIh3E,eAAJ;AACA,MAAI+2E,eAAe1iF,SAAnB,EAA8B;AAC5B,SAAK,IAAIZ,IAAI,CAAR,EAAWwkB,KAAKlhB,MAAMrD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9CsjF,iBAAWtjF,CAAX,IAAgBsD,MAAMtD,CAAN,CAAhB;AACD;AACDuM,aAAS+2E,UAAT;AACD,GALD,MAKO;AACL/2E,aAASjJ,MAAMzD,KAAN,EAAT;AACD;AACD,SAAO0M,MAAP;AACD;;AAGD;;;;;;AAMO,SAAS41E,iBAAT,CAA2B7+E,KAA3B,EAAkCggF,UAAlC,EAA8CC,aAA9C,EAA6D;AAClE,MAAID,eAAe1iF,SAAf,IAA4B0C,UAAUggF,UAA1C,EAAsD;AACpD,SAAK,IAAItjF,IAAI,CAAR,EAAWwkB,KAAKlhB,MAAMrD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9CsjF,iBAAWtjF,CAAX,IAAgBsD,MAAMtD,CAAN,CAAhB;AACD;AACDsD,YAAQggF,UAAR;AACD;AACD,SAAOhgF,KAAP;AACD;;AAGD;;;;;;;AAOO,SAAS8+E,aAAT,CAAuB9gD,UAAvB,EAAmC;AACxC+hD,cAAYlzC,GAAZ,CAAgB7O,WAAWkiD,OAAX,EAAhB,EAAsCliD,UAAtC;AACA,uBAAiBA,UAAjB,EAA6BA,UAA7B,EAAyC4gD,cAAzC;AACD;;AAGD;;;AAGO,SAASG,cAAT,CAAwBgB,WAAxB,EAAqC;AAC1CA,cAAY3jF,OAAZ,CAAoB0iF,aAApB;AACD;;AAGD;;;;;;;;;AASO,SAAS75E,GAAT,CAAak7E,cAAb,EAA6B;AAClC,MAAIniD,aAAa,IAAjB;AACA,MAAImiD,0BAA0BC,oBAA9B,EAA0C;AACxCpiD,iBAAamiD,cAAb;AACD,GAFD,MAEO,IAAI,OAAOA,cAAP,KAA0B,QAA9B,EAAwC;AAC7C,QAAM3+D,OAAO2+D,cAAb;AACAniD,iBAAa+hD,YAAY96E,GAAZ,CAAgBuc,IAAhB,CAAb;AACD;AACD,SAAOwc,UAAP;AACD;;AAGD;;;;;;;;;;;;;;;;;;;;AAoBO,SAASghD,kBAAT,CAA4BhhD,UAA5B,EAAwCjY,UAAxC,EAAoDo8B,KAApD,EAA2Dk+B,SAA3D,EAAsE;AAC3EriD,eAAa/4B,IAAI+4B,UAAJ,CAAb;AACA,MAAIsiD,wBAAJ;AACA,MAAMC,SAASviD,WAAWwiD,sBAAX,EAAf;AACA,MAAID,MAAJ,EAAY;AACVD,sBAAkBC,OAAOx6D,UAAP,EAAmBo8B,KAAnB,CAAlB;AACD,GAFD,MAEO;AACL,QAAMs+B,QAAQziD,WAAW8kB,QAAX,EAAd;AACA,QAAI29B,SAASt6C,gBAAMC,OAAf,IAA0B,CAACi6C,SAA3B,IAAwCA,aAAal6C,gBAAMC,OAA/D,EAAwE;AACtEk6C,wBAAkBv6D,UAAlB;AACD,KAFD,MAEO;AACL;AACA;AACA;AACA,UAAM26D,UAAahB,4BAA4B1hD,UAA5B,EAAwC/4B,IAAI,WAAJ,CAAxC,CAAnB;AACA,UAAI07E,WAAW,CACbx+B,MAAM,CAAN,IAAWp8B,aAAa,CADX,EACco8B,MAAM,CAAN,CADd,EAEbA,MAAM,CAAN,IAAWp8B,aAAa,CAFX,EAEco8B,MAAM,CAAN,CAFd,EAGbA,MAAM,CAAN,CAHa,EAGHA,MAAM,CAAN,IAAWp8B,aAAa,CAHrB,EAIbo8B,MAAM,CAAN,CAJa,EAIHA,MAAM,CAAN,IAAWp8B,aAAa,CAJrB,CAAf;AAMA46D,iBAAWD,QAAWC,QAAX,EAAqBA,QAArB,EAA+B,CAA/B,CAAX;AACA,UAAMzvD,QAAQ,yBAAYyvD,SAASpkF,KAAT,CAAe,CAAf,EAAkB,CAAlB,CAAZ,EAAkCokF,SAASpkF,KAAT,CAAe,CAAf,EAAkB,CAAlB,CAAlC,CAAd;AACA,UAAM40B,SAAS,yBAAYwvD,SAASpkF,KAAT,CAAe,CAAf,EAAkB,CAAlB,CAAZ,EAAkCokF,SAASpkF,KAAT,CAAe,CAAf,EAAkB,CAAlB,CAAlC,CAAf;AACA+jF,wBAAkB,CAACpvD,QAAQC,MAAT,IAAmB,CAArC;AACA,UAAMyvD,gBAAgBP,YACpBn6C,uBAAgBm6C,SAAhB,CADoB,GAEpBriD,WAAWqI,gBAAX,EAFF;AAGA,UAAIu6C,kBAAkBtjF,SAAtB,EAAiC;AAC/BgjF,2BAAmBM,aAAnB;AACD;AACF;AACF;AACD,SAAON,eAAP;AACD;;AAGD;;;;;;;AAOO,SAASrB,wBAAT,CAAkCc,WAAlC,EAA+C;AACpDhB,iBAAegB,WAAf;AACAA,cAAY3jF,OAAZ,CAAoB,UAASvB,MAAT,EAAiB;AACnCklF,gBAAY3jF,OAAZ,CAAoB,UAASymD,WAAT,EAAsB;AACxC,UAAIhoD,WAAWgoD,WAAf,EAA4B;AAC1B,6BAAiBhoD,MAAjB,EAAyBgoD,WAAzB,EAAsC+7B,cAAtC;AACD;AACF,KAJD;AAKD,GAND;AAOD;;AAGD;;;;;;;;;;;;;AAaO,SAASM,uBAAT,CAAiC2B,YAAjC,EAA+CC,YAA/C,EAA6DC,gBAA7D,EAA+EC,gBAA/E,EAAiG;AACtGH,eAAazkF,OAAb,CAAqB,UAAS6kF,WAAT,EAAsB;AACzCH,iBAAa1kF,OAAb,CAAqB,UAAS8kF,WAAT,EAAsB;AACzC,2BAAiBD,WAAjB,EAA8BC,WAA9B,EAA2CH,gBAA3C;AACA,2BAAiBG,WAAjB,EAA8BD,WAA9B,EAA2CD,gBAA3C;AACD,KAHD;AAID,GALD;AAMD;;AAGD;;;AAGO,SAAS7B,mBAAT,GAA+B;AACpCY,cAAYt9D,KAAZ;AACA;AACD;;AAGD;;;;;AAKO,SAAS28D,gBAAT,CAA0BphD,UAA1B,EAAsCmjD,WAAtC,EAAmD;AACxD,MAAI,CAACnjD,UAAL,EAAiB;AACf,WAAO/4B,IAAIk8E,WAAJ,CAAP;AACD,GAFD,MAEO,IAAI,OAAOnjD,UAAP,KAAsB,QAA1B,EAAoC;AACzC,WAAO/4B,IAAI+4B,UAAJ,CAAP;AACD,GAFM,MAEA;AACL;AACE,8CAA0CA;AAD5C;AAGD;AACF;;AAGD;;;;;;;AAOO,SAASqhD,sCAAT,CAAgD+B,cAAhD,EAAgE;AACrE;AACE;;;;;;AAMA,cAASphF,KAAT,EAAgBggF,UAAhB,EAA4BC,aAA5B,EAA2C;AACzC,UAAMtjF,SAASqD,MAAMrD,MAArB;AACA,UAAM0kF,YAAYpB,kBAAkB3iF,SAAlB,GAA8B2iF,aAA9B,GAA8C,CAAhE;AACA,UAAMh3E,SAAS+2E,eAAe1iF,SAAf,GAA2B0iF,UAA3B,GAAwC,IAAIjiF,KAAJ,CAAUpB,MAAV,CAAvD;AACA,WAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIC,MAApB,EAA4BD,KAAK2kF,SAAjC,EAA4C;AAC1C,YAAMl/B,QAAQi/B,eAAe,CAACphF,MAAMtD,CAAN,CAAD,EAAWsD,MAAMtD,IAAI,CAAV,CAAX,CAAf,CAAd;AACAuM,eAAOvM,CAAP,IAAYylD,MAAM,CAAN,CAAZ;AACAl5C,eAAOvM,IAAI,CAAX,IAAgBylD,MAAM,CAAN,CAAhB;AACA,aAAK,IAAIv8C,IAAIy7E,YAAY,CAAzB,EAA4Bz7E,KAAK,CAAjC,EAAoC,EAAEA,CAAtC,EAAyC;AACvCqD,iBAAOvM,IAAIkJ,CAAX,IAAgB5F,MAAMtD,IAAIkJ,CAAV,CAAhB;AACD;AACF;AACD,aAAOqD,MAAP;AACD;AApBH;AAqBD;;AAGD;;;;;;;;;;;;;;;;;;;AAmBO,SAASq2E,uBAAT,CAAiCzkF,MAAjC,EAAyCgoD,WAAzC,EAAsDtvC,OAAtD,EAA+D+tE,OAA/D,EAAwE;AAC7E,MAAMC,aAAat8E,IAAIpK,MAAJ,CAAnB;AACA,MAAM2mF,WAAWv8E,IAAI49C,WAAJ,CAAjB;AACA,uBAAiB0+B,UAAjB,EAA6BC,QAA7B,EAAuCnC,uCAAuC9rE,OAAvC,CAAvC;AACA,uBAAiBiuE,QAAjB,EAA2BD,UAA3B,EAAuClC,uCAAuCiC,OAAvC,CAAvC;AACD;;AAGD;;;;;;;;;AASO,SAAS/B,UAAT,CAAoBp1D,UAApB,EAAgC0rC,cAAhC,EAAgD;AACrD,SAAOtoB,UAAUpjB,UAAV,EAAsB,WAAtB,EACL0rC,mBAAmBv4D,SAAnB,GAA+Bu4D,cAA/B,GAAgD,WAD3C,CAAP;AAED;;AAGD;;;;;;;;;AASO,SAAS2pB,QAAT,CAAkBr1D,UAAlB,EAA8B0rC,cAA9B,EAA8C;AACnD,MAAM4rB,SAASl0C,UAAUpjB,UAAV,EACb0rC,mBAAmBv4D,SAAnB,GAA+Bu4D,cAA/B,GAAgD,WADnC,EACgD,WADhD,CAAf;AAEA,MAAM6rB,MAAMD,OAAO,CAAP,CAAZ;AACA,MAAIC,MAAM,CAAC,GAAP,IAAcA,MAAM,GAAxB,EAA6B;AAC3BD,WAAO,CAAP,IAAY,kBAAOC,MAAM,GAAb,EAAkB,GAAlB,IAAyB,GAArC;AACD;AACD,SAAOD,MAAP;AACD;;AAGD;;;;;;;;;;AAUO,SAAShC,UAAT,CAAoBwB,WAApB,EAAiCC,WAAjC,EAA8C;AACnD,MAAID,gBAAgBC,WAApB,EAAiC;AAC/B,WAAO,IAAP;AACD;AACD,MAAMS,aAAaV,YAAYn+B,QAAZ,OAA2Bo+B,YAAYp+B,QAAZ,EAA9C;AACA,MAAIm+B,YAAYf,OAAZ,OAA0BgB,YAAYhB,OAAZ,EAA9B,EAAqD;AACnD,WAAOyB,UAAP;AACD,GAFD,MAEO;AACL,QAAMC,gBAAgBlC,4BAA4BuB,WAA5B,EAAyCC,WAAzC,CAAtB;AACA,WAAOU,kBAAkBhD,cAAlB,IAAoC+C,UAA3C;AACD;AACF;;AAGD;;;;;;;;;AASO,SAASjC,2BAAT,CAAqCmC,gBAArC,EAAuDC,qBAAvD,EAA8E;AACnF,MAAMC,aAAaF,iBAAiB3B,OAAjB,EAAnB;AACA,MAAM8B,kBAAkBF,sBAAsB5B,OAAtB,EAAxB;AACA,MAAI0B,gBAAgB,qBAAiBG,UAAjB,EAA6BC,eAA7B,CAApB;AACA,MAAI,CAACJ,aAAL,EAAoB;AAClBA,oBAAgB/C,iBAAhB;AACD;AACD,SAAO+C,aAAP;AACD;;AAGD;;;;;;;;;;AAUO,SAASjC,YAAT,CAAsB9kF,MAAtB,EAA8BgoD,WAA9B,EAA2C;AAChD,MAAMg/B,mBAAmB58E,IAAIpK,MAAJ,CAAzB;AACA,MAAMinF,wBAAwB78E,IAAI49C,WAAJ,CAA9B;AACA,SAAO68B,4BAA4BmC,gBAA5B,EAA8CC,qBAA9C,CAAP;AACD;;AAGD;;;;;;;;;;;;;;AAcO,SAASv0C,SAAT,CAAmBpjB,UAAnB,EAA+BtvB,MAA/B,EAAuCgoD,WAAvC,EAAoD;AACzD,MAAM++B,gBAAgBjC,aAAa9kF,MAAb,EAAqBgoD,WAArB,CAAtB;AACA,SAAO++B,cAAcz3D,UAAd,EAA0B7sB,SAA1B,EAAqC6sB,WAAWxtB,MAAhD,CAAP;AACD;;AAGD;;;;;;;;;;AAUO,SAASijF,eAAT,CAAyB95D,MAAzB,EAAiCjrB,MAAjC,EAAyCgoD,WAAzC,EAAsD;AAC3D,MAAM++B,gBAAgBjC,aAAa9kF,MAAb,EAAqBgoD,WAArB,CAAtB;AACA,SAAO,4BAAe/8B,MAAf,EAAuB87D,aAAvB,CAAP;AACD;;AAGD;;;;;;;;AAQO,SAAS/B,wBAAT,CAAkC19B,KAAlC,EAAyC0/B,gBAAzC,EAA2DC,qBAA3D,EAAkF;AACvF,MAAMF,gBAAgBlC,4BAA4BmC,gBAA5B,EAA8CC,qBAA9C,CAAtB;AACA,SAAOF,cAAcz/B,KAAd,CAAP;AACD;;AAED;;;;;AAKO,SAAS29B,SAAT,GAAqB;AAC1B;AACA;AACAb,2BAAyBgD,iBAAzB;AACAhD,2BAAyBiD,kBAAzB;AACA;AACA;AACAhD,0BAAwBgD,kBAAxB,EAA8CD,iBAA9C,EAAoEE,kBAApE,EAAkFzB,gBAAlF;AACD;;AAEDZ,Y;;;;;;;;;;;;;;;;;;AC9fA;;AAGA;;;;;;;;;;;;;;;;;;;AAoBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA,IAAMM,aAAa,SAAbA,UAAa,CAAS38E,OAAT,EAAkB;AACnC;;;;AAIA,OAAK2+E,KAAL,GAAa3+E,QAAQ+d,IAArB;;AAEA;;;;;;;AAOA,OAAK6gE,MAAL,GAAc,mCAAqC5+E,QAAQg9E,KAA3D;;AAEA;;;;;;;AAOA,OAAK7+B,OAAL,GAAen+C,QAAQqiB,MAAR,KAAmBxoB,SAAnB,GAA+BmG,QAAQqiB,MAAvC,GAAgD,IAA/D;;AAEA;;;;;;;AAOA,OAAKw8D,YAAL,GAAoB7+E,QAAQ8+E,WAAR,KAAwBjlF,SAAxB,GAClBmG,QAAQ8+E,WADU,GACI,IADxB;;AAGA;;;;AAIA,OAAKC,gBAAL,GAAwB/+E,QAAQg/E,eAAR,KAA4BnlF,SAA5B,GACtBmG,QAAQg/E,eADc,GACI,KAD5B;;AAGA;;;;AAIA,OAAKC,OAAL,GAAej/E,QAAQ6T,MAAR,KAAmBha,SAAnB,GAA+BmG,QAAQ6T,MAAvC,GAAgD,KAA/D;;AAEA;;;;AAIA,OAAKqrE,SAAL,GAAiB,CAAC,EAAE,KAAKD,OAAL,IAAgB,KAAK9gC,OAAvB,CAAlB;;AAEA;;;;AAIA,OAAKghC,uBAAL,GAA+Bn/E,QAAQu7E,kBAAvC;;AAEA;;;;AAIA,OAAK6D,gBAAL,GAAwB,IAAxB;;AAEA;;;;AAIA,OAAKC,cAAL,GAAsBr/E,QAAQm9E,aAA9B;AACD,CAvED;;AA0EA;;;AAlIA;;;AAqIAR,WAAWxpE,SAAX,CAAqBmsE,QAArB,GAAgC,YAAW;AACzC,SAAO,KAAKJ,SAAZ;AACD,CAFD;;AAKA;;;;;AAKAvC,WAAWxpE,SAAX,CAAqBspE,OAArB,GAA+B,YAAW;AACxC,SAAO,KAAKkC,KAAZ;AACD,CAFD;;AAKA;;;;;AAKAhC,WAAWxpE,SAAX,CAAqBwP,SAArB,GAAiC,YAAW;AAC1C,SAAO,KAAKw7B,OAAZ;AACD,CAFD;;AAKA;;;;;AAKAw+B,WAAWxpE,SAAX,CAAqBksC,QAArB,GAAgC,YAAW;AACzC,SAAO,KAAKu/B,MAAZ;AACD,CAFD;;AAKA;;;;;;;AAOAjC,WAAWxpE,SAAX,CAAqByvB,gBAArB,GAAwC,YAAW;AACjD,SAAO,KAAKy8C,cAAL,IAAuB58C,uBAAgB,KAAKm8C,MAArB,CAA9B;AACD,CAFD;;AAKA;;;;;AAKAjC,WAAWxpE,SAAX,CAAqBwsC,cAArB,GAAsC,YAAW;AAC/C,SAAO,KAAKk/B,YAAZ;AACD,CAFD;;AAKA;;;;;;;;;;;AAWAlC,WAAWxpE,SAAX,CAAqBosE,kBAArB,GAA0C,YAAW;AACnD,SAAO,KAAKR,gBAAZ;AACD,CAFD;;AAKA;;;;;AAKApC,WAAWxpE,SAAX,CAAqBqsE,QAArB,GAAgC,YAAW;AACzC,SAAO,KAAKP,OAAZ;AACD,CAFD;;AAKA;;;;;AAKAtC,WAAWxpE,SAAX,CAAqBssE,SAArB,GAAiC,UAAS5rE,MAAT,EAAiB;AAChD,OAAKorE,OAAL,GAAeprE,MAAf;AACA,OAAKqrE,SAAL,GAAiB,CAAC,EAAErrE,UAAU,KAAKsqC,OAAjB,CAAlB;AACD,CAHD;;AAMA;;;AAGAw+B,WAAWxpE,SAAX,CAAqBusE,kBAArB,GAA0C,YAAW;AACnD,SAAO,KAAKN,gBAAZ;AACD,CAFD;;AAKA;;;AAGAzC,WAAWxpE,SAAX,CAAqBwsE,kBAArB,GAA0C,UAAS/O,QAAT,EAAmB;AAC3D,OAAKwO,gBAAL,GAAwBxO,QAAxB;AACD,CAFD;;AAKA;;;;;AAKA+L,WAAWxpE,SAAX,CAAqBupD,SAArB,GAAiC,UAASr6C,MAAT,EAAiB;AAChD,OAAK87B,OAAL,GAAe97B,MAAf;AACA,OAAK68D,SAAL,GAAiB,CAAC,EAAE,KAAKD,OAAL,IAAgB58D,MAAlB,CAAlB;AACD,CAHD;;AAMA;;;;;;AAMAs6D,WAAWxpE,SAAX,CAAqBysE,cAArB,GAAsC,UAASd,WAAT,EAAsB;AAC1D,OAAKD,YAAL,GAAoBC,WAApB;AACD,CAFD;;AAKA;;;;;;AAMAnC,WAAWxpE,SAAX,CAAqB0sE,qBAArB,GAA6C,UAAS3qE,IAAT,EAAe;AAC1D,OAAKiqE,uBAAL,GAA+BjqE,IAA/B;AACD,CAFD;;AAKA;;;;;AAKAynE,WAAWxpE,SAAX,CAAqB4pE,sBAArB,GAA8C,YAAW;AACvD,SAAO,KAAKoC,uBAAZ;AACD,CAFD;kBAGexC,U;;;;;;;;;;;;;;;;;AC5Rf;;;;AAIA;;;;;AAKA,IAAMj6C,QAAQ;AACZC,WAAS,SADG;AAEZm9C,QAAM,IAFM;AAGZC,UAAQ,GAHI;AAIZC,UAAQ,QAJI;AAKZ1gC,eAAa,aALD;AAMZ2gC,UAAQ;AANI,CAAd;;AAUA;;;;;;AAMO,IAAMx9C,4CAAkB,EAAxB;AACP;AACAA,gBAAgBC,MAAMC,OAAtB,IAAiC,IAAI3lC,KAAKiG,EAAT,GAAc,OAAd,GAAwB,GAAzD;AACAw/B,gBAAgBC,MAAMo9C,IAAtB,IAA8B,MAA9B;AACAr9C,gBAAgBC,MAAMq9C,MAAtB,IAAgC,CAAhC;AACAt9C,gBAAgBC,MAAMu9C,MAAtB,IAAgC,OAAO,IAAvC;;kBAEev9C,K;;;;;;;;;;;;;;;;;;QC0DCg8C,Y,GAAAA,Y;QAoCAzB,U,GAAAA,U;;AA3HhB;;AACA;;AACA;;;;AACA;;;;;;AAGA;;;;;;AATA;;;AAeO,IAAMiD,0BAAS,OAAf;;AAGP;;;;AAIO,IAAMC,gCAAYnjF,KAAKiG,EAAL,GAAUi9E,MAA5B;;AAGP;;;;AAIO,IAAM/S,0BAAS,CACpB,CAACgT,SADmB,EACR,CAACA,SADO,EAEpBA,SAFoB,EAETA,SAFS,CAAf;;AAMP;;;;AAIO,IAAMC,sCAAe,CAAC,CAAC,GAAF,EAAO,CAAC,EAAR,EAAY,GAAZ,EAAiB,EAAjB,CAArB;;AAGP;;;;;;;;AAQA,SAASC,kBAAT,CAA4BtiE,IAA5B,EAAkC;AAChC4+D,uBAAWnoE,IAAX,CAAgB,IAAhB,EAAsB;AACpBuJ,UAAMA,IADc;AAEpBi/D,WAAOt6C,gBAAMq9C,MAFO;AAGpB19D,YAAQ8qD,MAHY;AAIpBt5D,YAAQ,IAJY;AAKpBirE,iBAAasB,YALO;AAMpB7E,wBAAoB,4BAASj5D,UAAT,EAAqBo8B,KAArB,EAA4B;AAC9C,aAAOp8B,aAAa,gBAAKo8B,MAAM,CAAN,IAAWwhC,MAAhB,CAApB;AACD;AARmB,GAAtB;AAUD;AACD,qBAASG,kBAAT,EAA6B1D,oBAA7B;;AAGA;;;;;;AAMO,IAAM2D,oCAAc,CACzB,IAAID,kBAAJ,CAAuB,WAAvB,CADyB,EAEzB,IAAIA,kBAAJ,CAAuB,aAAvB,CAFyB,EAGzB,IAAIA,kBAAJ,CAAuB,aAAvB,CAHyB,EAIzB,IAAIA,kBAAJ,CAAuB,aAAvB,CAJyB,EAKzB,IAAIA,kBAAJ,CAAuB,kCAAvB,CALyB,EAMzB,IAAIA,kBAAJ,CAAuB,4BAAvB,CANyB,EAOzB,IAAIA,kBAAJ,CAAuB,8CAAvB,CAPyB,CAApB;;AAWP;;;;;;;;AAQO,SAAS3B,YAAT,CAAsBniF,KAAtB,EAA6BggF,UAA7B,EAAyCC,aAAzC,EAAwD;AAC7D,MAAMtjF,SAASqD,MAAMrD,MAArB;AACA,MAAM0kF,YAAYpB,gBAAgB,CAAhB,GAAoBA,aAApB,GAAoC,CAAtD;AACA,MAAIh3E,SAAS+2E,UAAb;AACA,MAAI/2E,WAAW3L,SAAf,EAA0B;AACxB,QAAI+jF,YAAY,CAAhB,EAAmB;AACjB;AACAp4E,eAASjJ,MAAMzD,KAAN,EAAT;AACD,KAHD,MAGO;AACL0M,eAAS,IAAIlL,KAAJ,CAAUpB,MAAV,CAAT;AACD;AACF;AACD,MAAMqnF,WAAWJ,SAAjB;AACA,OAAK,IAAIlnF,IAAI,CAAb,EAAgBA,IAAIC,MAApB,EAA4BD,KAAK2kF,SAAjC,EAA4C;AAC1Cp4E,WAAOvM,CAAP,IAAYsnF,WAAWhkF,MAAMtD,CAAN,CAAX,GAAsB,GAAlC;AACA,QAAImY,IAAI8uE,SACJljF,KAAKyG,GAAL,CAASzG,KAAK6G,GAAL,CAAS7G,KAAKiG,EAAL,IAAW1G,MAAMtD,IAAI,CAAV,IAAe,EAA1B,IAAgC,GAAzC,CAAT,CADJ;AAEA,QAAImY,IAAImvE,QAAR,EAAkB;AAChBnvE,UAAImvE,QAAJ;AACD,KAFD,MAEO,IAAInvE,IAAI,CAACmvE,QAAT,EAAmB;AACxBnvE,UAAI,CAACmvE,QAAL;AACD;AACD/6E,WAAOvM,IAAI,CAAX,IAAgBmY,CAAhB;AACD;AACD,SAAO5L,MAAP;AACD;;AAGD;;;;;;;;AAQO,SAASy3E,UAAT,CAAoB1gF,KAApB,EAA2BggF,UAA3B,EAAuCC,aAAvC,EAAsD;AAC3D,MAAMtjF,SAASqD,MAAMrD,MAArB;AACA,MAAM0kF,YAAYpB,gBAAgB,CAAhB,GAAoBA,aAApB,GAAoC,CAAtD;AACA,MAAIh3E,SAAS+2E,UAAb;AACA,MAAI/2E,WAAW3L,SAAf,EAA0B;AACxB,QAAI+jF,YAAY,CAAhB,EAAmB;AACjB;AACAp4E,eAASjJ,MAAMzD,KAAN,EAAT;AACD,KAHD,MAGO;AACL0M,eAAS,IAAIlL,KAAJ,CAAUpB,MAAV,CAAT;AACD;AACF;AACD,OAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIC,MAApB,EAA4BD,KAAK2kF,SAAjC,EAA4C;AAC1Cp4E,WAAOvM,CAAP,IAAY,MAAMsD,MAAMtD,CAAN,CAAN,GAAiBknF,SAA7B;AACA36E,WAAOvM,IAAI,CAAX,IAAgB,MAAM+D,KAAKgH,IAAL,CACpBhH,KAAK00E,GAAL,CAASn1E,MAAMtD,IAAI,CAAV,IAAeinF,MAAxB,CADoB,CAAN,GACqBljF,KAAKiG,EAD1B,GAC+B,EAD/C;AAED;AACD,SAAOuC,MAAP;AACD,C;;;;;;;;;;;;;;;;;;;AC7ID;;AACA;;;;AACA;;;;;;AAGA;;;;;;AAMO,IAAM06E,0BAAS,OAAf;;AAGP;;;;;;AAjBA;;;AAuBO,IAAM/S,0BAAS,CAAC,CAAC,GAAF,EAAO,CAAC,EAAR,EAAY,GAAZ,EAAiB,EAAjB,CAAf;;AAGP;;;;AAIO,IAAM1qC,4CAAkBzlC,KAAKiG,EAAL,GAAUi9E,MAAV,GAAmB,GAA3C;;AAGP;;;;;;;;;;;;;AAaA,SAASM,kBAAT,CAA4BziE,IAA5B,EAAkC0iE,mBAAlC,EAAuD;AACrD9D,uBAAWnoE,IAAX,CAAgB,IAAhB,EAAsB;AACpBuJ,UAAMA,IADc;AAEpBi/D,WAAOt6C,gBAAMC,OAFO;AAGpBtgB,YAAQ8qD,MAHY;AAIpB6R,qBAAiByB,mBAJG;AAKpB5sE,YAAQ,IALY;AAMpBspE,mBAAe16C,eANK;AAOpBq8C,iBAAa3R;AAPO,GAAtB;AASD;AACD,qBAASqT,kBAAT,EAA6B7D,oBAA7B;;AAGA;;;;;;AAMO,IAAM2D,oCAAc,CACzB,IAAIE,kBAAJ,CAAuB,QAAvB,CADyB,EAEzB,IAAIA,kBAAJ,CAAuB,WAAvB,EAAoC,KAApC,CAFyB,EAGzB,IAAIA,kBAAJ,CAAuB,4BAAvB,EAAqD,KAArD,CAHyB,EAIzB,IAAIA,kBAAJ,CAAuB,+BAAvB,EAAwD,KAAxD,CAJyB,EAKzB,IAAIA,kBAAJ,CAAuB,+BAAvB,CALyB,EAMzB,IAAIA,kBAAJ,CAAuB,0BAAvB,CANyB,EAOzB,IAAIA,kBAAJ,CAAuB,8CAAvB,EAAuE,KAAvE,CAPyB,EAQzB,IAAIA,kBAAJ,CAAuB,6BAAvB,EAAsD,KAAtD,CARyB,CAApB,C;;;;;;;;;;;;;;;;;QCpDSxhE,K,GAAAA,K;QAUAxd,G,GAAAA,G;QAUA4nC,G,GAAAA,G;AAlChB;;;;AAKA;;;AAGA,IAAIrD,QAAQ,EAAZ;;AAGA;;;AAGO,SAAS/mB,KAAT,GAAiB;AACtB+mB,UAAQ,EAAR;AACD;;AAGD;;;;;AAKO,SAASvkC,GAAT,CAAauc,IAAb,EAAmB;AACxB,SAAOgoB,MAAMhoB,IAAN,KAAe,IAAtB;AACD;;AAGD;;;;;AAKO,SAASqrB,GAAT,CAAarrB,IAAb,EAAmBwc,UAAnB,EAA+B;AACpCwL,QAAMhoB,IAAN,IAAcwc,UAAd;AACD,C;;;;;;;;;;;;;;;;;QCpBevb,K,GAAAA,K;QAaAoqB,G,GAAAA,G;QAmBAxpB,M,GAAAA,M;QAkBApe,G,GAAAA,G;;AA/DhB;;AAGA;;;;AAIA,IAAIk/E,aAAa,EAAjB;;AAGA;;;AAbA;;;AAgBO,SAAS1hE,KAAT,GAAiB;AACtB0hE,eAAa,EAAb;AACD;;AAGD;;;;;;;;AAQO,SAASt3C,GAAT,CAAahyC,MAAb,EAAqBgoD,WAArB,EAAkCjI,WAAlC,EAA+C;AACpD,MAAMmnC,aAAalnF,OAAOqlF,OAAP,EAAnB;AACA,MAAM8B,kBAAkBn/B,YAAYq9B,OAAZ,EAAxB;AACA,MAAI,EAAE6B,cAAcoC,UAAhB,CAAJ,EAAiC;AAC/BA,eAAWpC,UAAX,IAAyB,EAAzB;AACD;AACDoC,aAAWpC,UAAX,EAAuBC,eAAvB,IAA0CpnC,WAA1C;AACD;;AAGD;;;;;;;;;AASO,SAASv3B,MAAT,CAAgBxoB,MAAhB,EAAwBgoD,WAAxB,EAAqC;AAC1C,MAAMk/B,aAAalnF,OAAOqlF,OAAP,EAAnB;AACA,MAAM8B,kBAAkBn/B,YAAYq9B,OAAZ,EAAxB;AACA,MAAM3yC,YAAY42C,WAAWpC,UAAX,EAAuBC,eAAvB,CAAlB;AACA,SAAOmC,WAAWpC,UAAX,EAAuBC,eAAvB,CAAP;AACA,MAAI,kBAAQmC,WAAWpC,UAAX,CAAR,CAAJ,EAAqC;AACnC,WAAOoC,WAAWpC,UAAX,CAAP;AACD;AACD,SAAOx0C,SAAP;AACD;;AAGD;;;;;;AAMO,SAAStoC,GAAT,CAAa88E,UAAb,EAAyBC,eAAzB,EAA0C;AAC/C,MAAIz0C,kBAAJ;AACA,MAAIw0C,cAAcoC,UAAd,IAA4BnC,mBAAmBmC,WAAWpC,UAAX,CAAnD,EAA2E;AACzEx0C,gBAAY42C,WAAWpC,UAAX,EAAuBC,eAAvB,CAAZ;AACD;AACD,SAAOz0C,SAAP;AACD,C;;;;;;;;;;;;;;;;;;ACnED;;AACA;;;;AACA;;;;;;AAEA;;;;;AAKA,IAAMuqB,YAAY,SAAZA,SAAY,CAAShnC,SAAT,EAAoB;;AAEpC;;;;AAIA,OAAKszD,SAAL,GAAiB,IAAjB;;AAEA;;;;AAIA,OAAK/J,QAAL,GAAgB,6BAA+BntD,SAAS2D,aAAT,CAAuB,KAAvB,CAA/C;AACA,OAAKwpD,QAAL,CAAcv5D,KAAd,CAAoBkQ,QAApB,GAA+B,UAA/B;AACA,OAAKqpD,QAAL,CAAcvpD,SAAd,GAA0B,YAAYA,SAAtC;;AAEA;;;;AAIA,OAAKpG,IAAL,GAAY,IAAZ;;AAEA;;;;AAIA,OAAKutC,WAAL,GAAmB,IAAnB;;AAEA;;;;AAIA,OAAKosB,SAAL,GAAiB,IAAjB;AAED,CAlCD,C,CAdA;;;AAGA;;AA+CA,qBAASvsB,SAAT,EAAoBn0C,oBAApB;;AAGA;;;AAGAm0C,UAAUlhD,SAAV,CAAoBkN,eAApB,GAAsC,YAAW;AAC/C,OAAK0P,MAAL,CAAY,IAAZ;AACD,CAFD;;AAKA;;;AAGAskC,UAAUlhD,SAAV,CAAoB0tE,OAApB,GAA8B,YAAW;AACvC,MAAM/rB,aAAa,KAAKN,WAAxB;AACA,MAAMO,WAAW,KAAK6rB,SAAtB;AACA,MAAME,KAAK,IAAX;AACA,MAAMzjE,QAAQ,KAAKu5D,QAAL,CAAcv5D,KAA5B;AACAA,QAAM+U,IAAN,GAAap1B,KAAKiH,GAAL,CAAS6wD,WAAW,CAAX,CAAT,EAAwBC,SAAS,CAAT,CAAxB,IAAuC+rB,EAApD;AACAzjE,QAAMgV,GAAN,GAAYr1B,KAAKiH,GAAL,CAAS6wD,WAAW,CAAX,CAAT,EAAwBC,SAAS,CAAT,CAAxB,IAAuC+rB,EAAnD;AACAzjE,QAAMoQ,KAAN,GAAczwB,KAAKmH,GAAL,CAAS4wD,SAAS,CAAT,IAAcD,WAAW,CAAX,CAAvB,IAAwCgsB,EAAtD;AACAzjE,QAAMqQ,MAAN,GAAe1wB,KAAKmH,GAAL,CAAS4wD,SAAS,CAAT,IAAcD,WAAW,CAAX,CAAvB,IAAwCgsB,EAAvD;AACD,CATD;;AAYA;;;AAGAzsB,UAAUlhD,SAAV,CAAoB4c,MAApB,GAA6B,UAASt4B,GAAT,EAAc;AACzC,MAAI,KAAKwvB,IAAT,EAAe;AACb,SAAKA,IAAL,CAAU+L,mBAAV,GAAgC4S,WAAhC,CAA4C,KAAKgxC,QAAjD;AACA,QAAMv5D,QAAQ,KAAKu5D,QAAL,CAAcv5D,KAA5B;AACAA,UAAM+U,IAAN,GAAa/U,MAAMgV,GAAN,GAAYhV,MAAMoQ,KAAN,GAAcpQ,MAAMqQ,MAAN,GAAe,SAAtD;AACD;AACD,OAAKzG,IAAL,GAAYxvB,GAAZ;AACA,MAAI,KAAKwvB,IAAT,EAAe;AACb,SAAKA,IAAL,CAAU+L,mBAAV,GAAgClF,WAAhC,CAA4C,KAAK8oD,QAAjD;AACD;AACF,CAVD;;AAaA;;;;AAIAviB,UAAUlhD,SAAV,CAAoB6hD,SAApB,GAAgC,UAASF,UAAT,EAAqBC,QAArB,EAA+B;AAC7D,OAAKP,WAAL,GAAmBM,UAAnB;AACA,OAAK8rB,SAAL,GAAiB7rB,QAAjB;AACA,OAAKgsB,sBAAL;AACA,OAAKF,OAAL;AACD,CALD;;AAQA;;;AAGAxsB,UAAUlhD,SAAV,CAAoB4tE,sBAApB,GAA6C,YAAW;AACtD,MAAMjsB,aAAa,KAAKN,WAAxB;AACA,MAAMO,WAAW,KAAK6rB,SAAtB;AACA,MAAMI,SAAS,CACblsB,UADa,EAEb,CAACA,WAAW,CAAX,CAAD,EAAgBC,SAAS,CAAT,CAAhB,CAFa,EAGbA,QAHa,EAIb,CAACA,SAAS,CAAT,CAAD,EAAcD,WAAW,CAAX,CAAd,CAJa,CAAf;AAMA,MAAMjgB,cAAcmsC,OAAOvpF,GAAP,CAAW,KAAKwvB,IAAL,CAAUN,sBAArB,EAA6C,KAAKM,IAAlD,CAApB;AACA;AACA4tB,cAAY,CAAZ,IAAiBA,YAAY,CAAZ,EAAe/7C,KAAf,EAAjB;AACA,MAAI,CAAC,KAAK6nF,SAAV,EAAqB;AACnB,SAAKA,SAAL,GAAiB,IAAIllC,iBAAJ,CAAY,CAAC5G,WAAD,CAAZ,CAAjB;AACD,GAFD,MAEO;AACL,SAAK8rC,SAAL,CAAe3iC,cAAf,CAA8B,CAACnJ,WAAD,CAA9B;AACD;AACF,CAjBD;;AAoBA;;;AAGAwf,UAAUlhD,SAAV,CAAoBqO,WAApB,GAAkC,YAAW;AAC3C,SAAO,KAAKm/D,SAAZ;AACD,CAFD;kBAGetsB,S;;;;;;;;;;;;;;;;;;AClIf;;AACA;;;;;;AAEA;;;;;;;;;AANA;;;AAeA,IAAM4sB,cAAc,SAAdA,WAAc,CAClB1nF,IADkB,EACZ2nF,iBADY,EACO76D,cADP,EACuB86D,WADvB,EAElBC,aAFkB,EAEH;;AAEf/iE,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAK8nF,aAAL,GAAqBH,iBAArB;;AAEA;;;;;AAKA,OAAK/2D,UAAL,GAAkB9D,cAAlB;;AAEA;;;;;;AAMA,OAAKpsB,OAAL,GAAeknF,WAAf;;AAEA;;;;;;AAMA,OAAKG,SAAL,GAAiBF,aAAjB;AAED,CApCD;;AAsCA,qBAASH,WAAT,EAAsB5iE,eAAtB;kBACe4iE,W;;;;;;;;;;;;;;;;;ACtDf;;;;AAIA;;;kBAGe;AACb;;;;AAIAM,eAAa,aALA;AAMb;;;;AAIApS,cAAY,YAVC;AAWb;;;;AAIAqS,UAAQ;AAfK,C;;;;;;;;;;;;;;;;;ACPf;;;AAGA;;;;;AAKA,IAAMC,cAAc,SAAdA,WAAc,GAAW,CAAE,CAAjC;;AAGA;;;;;;AAMAA,YAAYtuE,SAAZ,CAAsBuuE,SAAtB,GAAkC,UAASpV,MAAT,EAAiBqV,UAAjB,EAA6B,CAAE,CAAjE;;AAGA;;;;AAIAF,YAAYtuE,SAAZ,CAAsBihB,OAAtB,GAAgC,YAAW,CAAE,CAA7C;kBACeqtD,W;;;;;;;;;;;;;;;;;ACzBf;;;;AAIA;;;kBAGe;AACb3gD,UAAQ,QADK;AAEb8gD,WAAS,SAFI;AAGbz8D,SAAO,OAHM;AAIb47B,eAAa,YAJA;AAKbE,WAAS,SALI;AAMbnJ,QAAM;AANO,C;;;;;;;;;;;;;;;;;ACPf;;;AAGA;;;;;;;;AAQA,IAAM+pC,gBAAgB,SAAhBA,aAAgB,GAAW,CAChC,CADD;;AAIA;;;;;;;AAOAA,cAAc1uE,SAAd,CAAwB2uE,UAAxB,GAAqC,UAAS7gE,QAAT,EAAmBvZ,OAAnB,EAA4Bie,QAA5B,EAAsC,CAAE,CAA7E;;AAGA;;;;;AAKAk8D,cAAc1uE,SAAd,CAAwB4uE,YAAxB,GAAuC,UAAS9gE,QAAT,EAAmB,CAAE,CAA5D;;AAGA;;;;;AAKA4gE,cAAc1uE,SAAd,CAAwBuO,QAAxB,GAAmC,UAASrE,KAAT,EAAgB,CAAE,CAArD;;AAGA;;;;AAIAwkE,cAAc1uE,SAAd,CAAwB6uE,UAAxB,GAAqC,UAAShe,cAAT,EAAyBt8D,OAAzB,EAAkC,CAAE,CAAzE;;AAGA;;;;AAIAm6E,cAAc1uE,SAAd,CAAwB8uE,WAAxB,GAAsC,UAASv6E,OAAT,EAAkB2V,KAAlB,EAAyB,CAAE,CAAjE;;AAGA;;;;;AAKAwkE,cAAc1uE,SAAd,CAAwB+uE,sBAAxB,GAAiD,UAASC,0BAAT,EAAqCz6E,OAArC,EAA8C,CAAE,CAAjG;;AAGA;;;;AAIAm6E,cAAc1uE,SAAd,CAAwBivE,cAAxB,GAAyC,UAASC,kBAAT,EAA6B36E,OAA7B,EAAsC,CAAE,CAAjF;;AAGA;;;;AAIAm6E,cAAc1uE,SAAd,CAAwBmvE,mBAAxB,GAA8C,UAASC,uBAAT,EAAkC76E,OAAlC,EAA2C,CAAE,CAA3F;;AAGA;;;;AAIAm6E,cAAc1uE,SAAd,CAAwBqvE,cAAxB,GAAyC,UAASC,kBAAT,EAA6B/6E,OAA7B,EAAsC,CAAE,CAAjF;;AAGA;;;;AAIAm6E,cAAc1uE,SAAd,CAAwBuvE,gBAAxB,GAA2C,UAASC,oBAAT,EAA+Bj7E,OAA/B,EAAwC,CAAE,CAArF;;AAGA;;;;AAIAm6E,cAAc1uE,SAAd,CAAwByvE,SAAxB,GAAoC,UAASC,aAAT,EAAwBn7E,OAAxB,EAAiC,CAAE,CAAvE;;AAGA;;;;AAIAm6E,cAAc1uE,SAAd,CAAwB2vE,WAAxB,GAAsC,UAASC,eAAT,EAA0Br7E,OAA1B,EAAmC,CAAE,CAA3E;;AAGA;;;;AAIAm6E,cAAc1uE,SAAd,CAAwB6vE,QAAxB,GAAmC,UAAS/hE,QAAT,EAAmBvZ,OAAnB,EAA4B,CAAE,CAAjE;;AAGA;;;;AAIAm6E,cAAc1uE,SAAd,CAAwB8vE,kBAAxB,GAA6C,UAASC,SAAT,EAAoBC,WAApB,EAAiC,CAAE,CAAhF;;AAGA;;;;AAIAtB,cAAc1uE,SAAd,CAAwBiwE,aAAxB,GAAwC,UAASC,UAAT,EAAqBC,kBAArB,EAAyC,CAAE,CAAnF;;AAGA;;;;AAIAzB,cAAc1uE,SAAd,CAAwBowE,YAAxB,GAAuC,UAASC,SAAT,EAAoBF,kBAApB,EAAwC,CAAE,CAAjF;kBACezB,a;;;;;;;;;;;;;;;;;;QCwKC4B,gB,GAAAA,gB;QAeAC,c,GAAAA,c;QAyBAC,S,GAAAA,S;;AAhVhB;;AACA;;AACA;;AACA;;;;AACA;;;;AAGA;;;;;AAMA;;;;;;;;;;;;;;;;;;;;;AAsBA;;;;;;;;;;;AAYA;;;;;;;AAQA;;;;;;;;;;;;AAaA;;;;AAIO,IAAMC,oCAAc,iBAApB;;AAGP;;;;AA9EA;;;AAkFO,IAAMC,8CAAmB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAzB;;AAGP;;;;AAIO,IAAMC,0CAAiB,OAAvB;;AAGP;;;;AAIO,IAAMC,4CAAkB,EAAxB;;AAGP;;;;AAIO,IAAMC,wDAAwB,CAA9B;;AAGP;;;;AAIO,IAAMC,4CAAkB,OAAxB;;AAGP;;;;AAIO,IAAMC,gDAAoB,EAA1B;;AAGP;;;;AAIO,IAAMC,kDAAqB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAA3B;;AAGP;;;;AAIO,IAAMC,8CAAmB,QAAzB;;AAGP;;;;AAIO,IAAMC,oDAAsB,QAA5B;;AAGP;;;;AAIO,IAAMC,0CAAiB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAvB;;AAGP;;;;AAIO,IAAMC,8CAAmB,CAAzB;;AAGP;;;;;;AAMO,IAAMC,kCAAa,IAAIC,kBAAJ,EAAnB;;AAGP;;;AAGO,IAAMC,sCAAe,EAArB;;AAGP;;;AAGA,IAAIC,iBAAiB,IAArB;;AAGA;;;AAGO,IAAMC,oCAAc,EAApB;;AAGP;;;;AAIO,IAAMC,gCAAa,YAAW;AACnC,MAAMC,UAAU,EAAhB;AACA,MAAMC,UAAUL,YAAhB;AACA,MAAMxnE,OAAO,OAAb;AACA,MAAM8nE,iBAAiB,CAAC,WAAD,EAAc,OAAd,CAAvB;AACA,MAAMrxE,MAAMqxE,eAAe9rF,MAA3B;AACA,MAAM00D,OAAO,+BAAb;AACA,MAAIq3B,iBAAJ;AAAA,MAAcC,uBAAd;;AAEA,WAASC,WAAT,CAAqBznE,IAArB,EAA2B;AACzB,QAAMzjB,UAAUmrF,mBAAhB;AACA,QAAIC,YAAY,IAAhB;AACA,SAAK,IAAIpsF,IAAI,CAAb,EAAgBA,IAAI0a,GAApB,EAAyB,EAAE1a,CAA3B,EAA8B;AAC5B,UAAMqsF,gBAAgBN,eAAe/rF,CAAf,CAAtB;AACAgB,cAAQyjB,IAAR,GAAeR,OAAOooE,aAAtB;AACAJ,uBAAiBjrF,QAAQsrF,WAAR,CAAoB33B,IAApB,EAA0BngC,KAA3C;AACA,UAAI/P,QAAQ4nE,aAAZ,EAA2B;AACzBrrF,gBAAQyjB,IAAR,GAAeR,OAAOQ,IAAP,GAAc,GAAd,GAAoB4nE,aAAnC;AACA,YAAM73D,QAAQxzB,QAAQsrF,WAAR,CAAoB33B,IAApB,EAA0BngC,KAAxC;AACA;AACA;AACA43D,oBAAYA,aAAa53D,SAASy3D,cAAlC;AACD;AACF;AACD,WAAOG,SAAP;AACD;;AAED,WAASG,KAAT,GAAiB;AACf,QAAIrqB,OAAO,IAAX;AACA,SAAK,IAAMz9C,IAAX,IAAmBqnE,OAAnB,EAA4B;AAC1B,UAAIA,QAAQrnE,IAAR,IAAgBonE,OAApB,EAA6B;AAC3B,YAAIK,YAAYznE,IAAZ,CAAJ,EAAuB;AACrBqnE,kBAAQrnE,IAAR,IAAgBonE,OAAhB;AACA,0BAAMF,WAAN;AACA;AACAD,2BAAiB,IAAjB;AACAH,qBAAWxlE,KAAX;AACD,SAND,MAMO;AACL,YAAE+lE,QAAQrnE,IAAR,CAAF;AACAy9C,iBAAO,KAAP;AACD;AACF;AACF;AACD,QAAIA,IAAJ,EAAU;AACRsqB,oBAAcR,QAAd;AACAA,iBAAWprF,SAAX;AACD;AACF;;AAED,SAAO,UAAS6rF,QAAT,EAAmB;AACxB,QAAMpoE,eAAe,0BAAgBooE,QAAhB,CAArB;AACA,QAAI,CAACpoE,YAAL,EAAmB;AACjB;AACD;AACD,SAAK,IAAIrkB,IAAI,CAAR,EAAWwkB,KAAKH,aAAapkB,MAAlC,EAA0CD,IAAIwkB,EAA9C,EAAkD,EAAExkB,CAApD,EAAuD;AACrD,UAAM6kB,aAAaR,aAAarkB,CAAb,CAAnB;AACA,UAAI,EAAE6kB,cAAcinE,OAAhB,CAAJ,EAA8B;AAC5BA,gBAAQjnE,UAAR,IAAsBgnE,OAAtB;AACA,YAAI,CAACK,YAAYrnE,UAAZ,CAAL,EAA8B;AAC5BinE,kBAAQjnE,UAAR,IAAsB,CAAtB;AACA,cAAImnE,aAAaprF,SAAjB,EAA4B;AAC1BorF,uBAAWU,YAAYH,KAAZ,EAAmB,EAAnB,CAAX;AACD;AACF;AACF;AACF;AACF,GAjBD;AAkBD,CAnEwB,EAAlB;;AAsEP;;;AAGA,SAASJ,iBAAT,GAA6B;AAC3B,MAAI,CAACT,cAAL,EAAqB;AACnBA,qBAAiB,gCAAsB,CAAtB,EAAyB,CAAzB,CAAjB;AACD;AACD,SAAOA,cAAP;AACD;;AAGD;;;;AAIO,IAAMiB,gDAAqB,YAAW;AAC3C,MAAIC,aAAJ;AACA,MAAMC,UAAUlB,WAAhB;AACA,SAAO,UAASlnE,IAAT,EAAe;AACpB,QAAIgQ,SAASo4D,QAAQpoE,IAAR,CAAb;AACA,QAAIgQ,UAAU7zB,SAAd,EAAyB;AACvB,UAAI,CAACgsF,IAAL,EAAW;AACTA,eAAOp8D,SAAS2D,aAAT,CAAuB,MAAvB,CAAP;AACAy4D,aAAK7+C,WAAL,GAAmB,GAAnB;AACA6+C,aAAKxoE,KAAL,CAAW0oE,MAAX,GAAoBF,KAAKxoE,KAAL,CAAW2jB,OAAX,GAAqB,cAAzC;AACA6kD,aAAKxoE,KAAL,CAAWkQ,QAAX,GAAsB,qBAAtB;AACAs4D,aAAKxoE,KAAL,CAAW+U,IAAX,GAAkB,qBAAlB;AACD;AACDyzD,WAAKxoE,KAAL,CAAWK,IAAX,GAAkBA,IAAlB;AACA+L,eAASic,IAAT,CAAc5X,WAAd,CAA0B+3D,IAA1B;AACAn4D,eAASo4D,QAAQpoE,IAAR,IAAgBmoE,KAAKnuD,YAA9B;AACAjO,eAASic,IAAT,CAAcE,WAAd,CAA0BigD,IAA1B;AACD;AACD,WAAOn4D,MAAP;AACD,GAhBD;AAiBD,CApBgC,EAA1B;;AAuBP;;;;;AAKO,SAAS+1D,gBAAT,CAA0B/lE,IAA1B,EAAgCkwC,IAAhC,EAAsC;AAC3C,MAAM+2B,iBAAiBS,mBAAvB;AACA,MAAI1nE,QAAQinE,eAAejnE,IAA3B,EAAiC;AAC/BinE,mBAAejnE,IAAf,GAAsBA,IAAtB;AACD;AACD,SAAOinE,eAAeY,WAAf,CAA2B33B,IAA3B,EAAiCngC,KAAxC;AACD;;AAGD;;;;;;AAMO,SAASi2D,cAAT,CAAwBzpF,OAAxB,EAAiC48B,QAAjC,EAA2CmvD,OAA3C,EAAoDC,OAApD,EAA6D;AAClE,MAAIpvD,aAAa,CAAjB,EAAoB;AAClB58B,YAAQklD,SAAR,CAAkB6mC,OAAlB,EAA2BC,OAA3B;AACAhsF,YAAQ8mC,MAAR,CAAelK,QAAf;AACA58B,YAAQklD,SAAR,CAAkB,CAAC6mC,OAAnB,EAA4B,CAACC,OAA7B;AACD;AACF;;AAGM,IAAMC,0CAAiB,wBAAvB;;AAGP;;;;;;;;;;;;;AAaO,SAASvC,SAAT,CAAmB1pF,OAAnB,EACL6vC,SADK,EACMqiC,OADN,EACega,KADf,EACsBC,OADtB,EAC+BC,OAD/B,EACwCxoE,CADxC,EAC2ClM,CAD3C,EAC8CtO,CAD9C,EACiD+N,CADjD,EACoDm6B,KADpD,EAC2D;AAChE,MAAInqC,cAAJ;AACA,MAAI+qE,WAAW,CAAf,EAAkB;AAChB/qE,YAAQnH,QAAQqsF,WAAhB;AACArsF,YAAQqsF,WAAR,GAAsBllF,QAAQ+qE,OAA9B;AACD;AACD,MAAIriC,SAAJ,EAAe;AACb7vC,YAAQssF,YAAR,CAAqB9qF,KAArB,CAA2BxB,OAA3B,EAAoC6vC,SAApC;AACD;;AAED7vC,UAAQ0pF,SAAR,CAAkBwC,KAAlB,EAAyBC,OAAzB,EAAkCC,OAAlC,EAA2CxoE,CAA3C,EAA8ClM,CAA9C,EAAiDtO,CAAjD,EAAoD+N,CAApD,EAAuDyM,IAAI0tB,KAA3D,EAAkE55B,IAAI45B,KAAtE;;AAEA,MAAInqC,KAAJ,EAAW;AACTnH,YAAQqsF,WAAR,GAAsBllF,KAAtB;AACD;AACD,MAAI0oC,SAAJ,EAAe;AACb7vC,YAAQssF,YAAR,CAAqB9qF,KAArB,CAA2BxB,OAA3B,EAAoCisF,cAApC;AACD;AACF,C;;;;;;;;;;;;;;;;;;ACnWD;;AACA;;;;AACA;;;;;;AAEA;;;;;;;;;;;AAWA,IAAMM,oBAAoB,SAApBA,iBAAoB,CACxBxnC,SADwB,EACbynC,SADa,EACFnkE,UADE,EACUC,UADV,EACsBmkE,QADtB,EACgCC,aADhC,EAC+C;AACvEC,mBAAapyE,IAAb,CAAkB,IAAlB,EACEwqC,SADF,EACaynC,SADb,EACwBnkE,UADxB,EACoCC,UADpC,EACgDmkE,QADhD,EAC0DC,aAD1D;;AAGA;;;;AAIA,OAAKE,eAAL,GAAuB,IAAvB;;AAEA;;;;AAIA,OAAKC,kBAAL,GAA0B,IAA1B;;AAEA;;;;AAIA,OAAKC,MAAL,GAAc,IAAd;;AAEA;;;;AAIA,OAAKC,QAAL,GAAgBntF,SAAhB;;AAEA;;;;AAIA,OAAKotF,QAAL,GAAgBptF,SAAhB;;AAEA;;;;AAIA,OAAKqtF,OAAL,GAAertF,SAAf;;AAEA;;;;AAIA,OAAKstF,QAAL,GAAgBttF,SAAhB;;AAEA;;;;AAIA,OAAKutF,QAAL,GAAgBvtF,SAAhB;;AAEA;;;;AAIA,OAAKwtF,QAAL,GAAgBxtF,SAAhB;;AAEA;;;;AAIA,OAAKytF,eAAL,GAAuBztF,SAAvB;;AAEA;;;;AAIA,OAAK6vC,SAAL,GAAiB7vC,SAAjB;;AAEA;;;;AAIA,OAAK0tF,MAAL,GAAc1tF,SAAd;;AAEA;;;;AAIA,OAAK2tF,YAAL,GAAoB3tF,SAApB;;AAEA;;;;AAIA,OAAK4tF,MAAL,GAAc5tF,SAAd;AAED,CAzFD,C,CAlBA;;;;;AA6GA,qBAAS2sF,iBAAT,EAA4BI,gBAA5B;;AAGA;;;;;;;;AAQAJ,kBAAkBrzE,SAAlB,CAA4Bu0E,gBAA5B,GAA+C,UAAShyC,eAAT,EAA0BnV,MAA1B,EAAkC3b,GAAlC,EAAuC6c,MAAvC,EAA+C;AAC5F,SAAO,KAAKkmD,qBAAL,CAA2BjyC,eAA3B,EAA4CnV,MAA5C,EAAoD3b,GAApD,EAAyD6c,MAAzD,EAAiE,KAAjE,EAAwE,KAAxE,CAAP;AACD,CAFD;;AAKA;;;AAGA+kD,kBAAkBrzE,SAAlB,CAA4ByvE,SAA5B,GAAwC,UAASC,aAAT,EAAwBn7E,OAAxB,EAAiC;AACvE,MAAI,CAAC,KAAKq/E,MAAV,EAAkB;AAChB;AACD;AACD,OAAKa,aAAL,CAAmB/E,aAAnB,EAAkCn7E,OAAlC;AACA,MAAMguC,kBAAkBmtC,cAAc3hD,kBAAd,EAAxB;AACA,MAAMO,SAASohD,cAAcnhD,SAAd,EAAf;AACA,MAAMmmD,UAAU,KAAKhzC,WAAL,CAAiB37C,MAAjC;AACA,MAAM4uF,QAAQ,KAAKJ,gBAAL,CAAsBhyC,eAAtB,EAAuC,CAAvC,EAA0CA,gBAAgBx8C,MAA1D,EAAkEuoC,MAAlE,CAAd;AACA,OAAKsmD,YAAL,CAAkB9sF,IAAlB,CAAuB,CACrB+sF,sBAAkBC,UADG,EACSJ,OADT,EACkBC,KADlB,EACyB,KAAKf,MAD9B;AAErB;AACA,OAAKC,QAHgB,EAGN,KAAKC,QAHC,EAGS,KAAKJ,eAHd,EAG+B,KAAKK,OAHpC,EAG6C,KAAKC,QAHlD,EAIrB,KAAKC,QAJgB,EAIN,KAAKC,QAJC,EAIS,KAAKC,eAJd,EAI+B,KAAK59C,SAJpC,EAKrB,KAAK69C,MAAL,GAAc,KAAKhlE,UALE,EAKU,KAAKilE,YALf,EAK6B,KAAKC,MALlC,CAAvB;AAOA,OAAKS,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkBC,UADe,EACHJ,OADG,EACMC,KADN,EACa,KAAKhB,kBADlB;AAEjC;AACA,OAAKE,QAH4B,EAGlB,KAAKC,QAHa,EAGH,KAAKJ,eAHF,EAGmB,KAAKK,OAHxB,EAGiC,KAAKC,QAHtC,EAIjC,KAAKC,QAJ4B,EAIlB,KAAKC,QAJa,EAIH,KAAKC,eAJF,EAImB,KAAK59C,SAJxB,EAKjC,KAAK69C,MAL4B,EAKpB,KAAKC,YALe,EAKD,KAAKC,MALJ,CAAnC;AAOA,OAAKU,WAAL,CAAiBtF,aAAjB,EAAgCn7E,OAAhC;AACD,CAxBD;;AA2BA;;;AAGA8+E,kBAAkBrzE,SAAlB,CAA4BqvE,cAA5B,GAA6C,UAASC,kBAAT,EAA6B/6E,OAA7B,EAAsC;AACjF,MAAI,CAAC,KAAKq/E,MAAV,EAAkB;AAChB;AACD;AACD,OAAKa,aAAL,CAAmBnF,kBAAnB,EAAuC/6E,OAAvC;AACA,MAAMguC,kBAAkB+sC,mBAAmBvhD,kBAAnB,EAAxB;AACA,MAAMO,SAASghD,mBAAmB/gD,SAAnB,EAAf;AACA,MAAMmmD,UAAU,KAAKhzC,WAAL,CAAiB37C,MAAjC;AACA,MAAM4uF,QAAQ,KAAKJ,gBAAL,CACZhyC,eADY,EACK,CADL,EACQA,gBAAgBx8C,MADxB,EACgCuoC,MADhC,CAAd;AAEA,OAAKsmD,YAAL,CAAkB9sF,IAAlB,CAAuB,CACrB+sF,sBAAkBC,UADG,EACSJ,OADT,EACkBC,KADlB,EACyB,KAAKf,MAD9B;AAErB;AACA,OAAKC,QAHgB,EAGN,KAAKC,QAHC,EAGS,KAAKJ,eAHd,EAG+B,KAAKK,OAHpC,EAG6C,KAAKC,QAHlD,EAIrB,KAAKC,QAJgB,EAIN,KAAKC,QAJC,EAIS,KAAKC,eAJd,EAI+B,KAAK59C,SAJpC,EAKrB,KAAK69C,MAAL,GAAc,KAAKhlE,UALE,EAKU,KAAKilE,YALf,EAK6B,KAAKC,MALlC,CAAvB;AAOA,OAAKS,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkBC,UADe,EACHJ,OADG,EACMC,KADN,EACa,KAAKhB,kBADlB;AAEjC;AACA,OAAKE,QAH4B,EAGlB,KAAKC,QAHa,EAGH,KAAKJ,eAHF,EAGmB,KAAKK,OAHxB,EAGiC,KAAKC,QAHtC,EAIjC,KAAKC,QAJ4B,EAIlB,KAAKC,QAJa,EAIH,KAAKC,eAJF,EAImB,KAAK59C,SAJxB,EAKjC,KAAK69C,MAL4B,EAKpB,KAAKC,YALe,EAKD,KAAKC,MALJ,CAAnC;AAOA,OAAKU,WAAL,CAAiB1F,kBAAjB,EAAqC/6E,OAArC;AACD,CAzBD;;AA4BA;;;AAGA8+E,kBAAkBrzE,SAAlB,CAA4Bi1E,MAA5B,GAAqC,YAAW;AAC9C,OAAKC,+BAAL;AACA;AACA,OAAKrB,QAAL,GAAgBntF,SAAhB;AACA,OAAKotF,QAAL,GAAgBptF,SAAhB;AACA,OAAKitF,kBAAL,GAA0B,IAA1B;AACA,OAAKC,MAAL,GAAc,IAAd;AACA,OAAKG,OAAL,GAAertF,SAAf;AACA,OAAK0tF,MAAL,GAAc1tF,SAAd;AACA,OAAKstF,QAAL,GAAgBttF,SAAhB;AACA,OAAKutF,QAAL,GAAgBvtF,SAAhB;AACA,OAAKwtF,QAAL,GAAgBxtF,SAAhB;AACA,OAAKytF,eAAL,GAAuBztF,SAAvB;AACA,OAAK6vC,SAAL,GAAiB7vC,SAAjB;AACA,OAAK2tF,YAAL,GAAoB3tF,SAApB;AACA,OAAK4tF,MAAL,GAAc5tF,SAAd;AACD,CAhBD;;AAmBA;;;AAGA2sF,kBAAkBrzE,SAAlB,CAA4BiwE,aAA5B,GAA4C,UAASC,UAAT,EAAqBiF,cAArB,EAAqC;AAC/E,MAAMxrD,SAASumD,WAAWkF,SAAX,EAAf;AACA,MAAMrrE,OAAOmmE,WAAWvwD,OAAX,EAAb;AACA,MAAM01D,oBAAoBnF,WAAWoF,oBAAX,CAAgC,CAAhC,CAA1B;AACA,MAAMtC,QAAQ9C,WAAWzgE,QAAX,CAAoB,CAApB,CAAd;AACA,MAAM8lE,SAASrF,WAAWsF,SAAX,EAAf;AACA,OAAK3B,QAAL,GAAgBlqD,OAAO,CAAP,CAAhB;AACA,OAAKmqD,QAAL,GAAgBnqD,OAAO,CAAP,CAAhB;AACA,OAAK+pD,eAAL,GAAuB,qDAAuDyB,cAA9E;AACA,OAAKxB,kBAAL,GAA0B0B,iBAA1B;AACA,OAAKzB,MAAL,GAAcZ,KAAd;AACA,OAAKe,OAAL,GAAehqE,KAAK,CAAL,CAAf;AACA,OAAKiqE,QAAL,GAAgB9D,WAAWzW,UAAX,EAAhB;AACA,OAAKwa,QAAL,GAAgBsB,OAAO,CAAP,CAAhB;AACA,OAAKrB,QAAL,GAAgBqB,OAAO,CAAP,CAAhB;AACA,OAAKpB,eAAL,GAAuBjE,WAAWuF,iBAAX,EAAvB;AACA,OAAKl/C,SAAL,GAAiB25C,WAAWlnD,WAAX,EAAjB;AACA,OAAKorD,MAAL,GAAclE,WAAWwF,QAAX,EAAd;AACA,OAAKrB,YAAL,GAAoBnE,WAAWyF,cAAX,EAApB;AACA,OAAKrB,MAAL,GAAcvqE,KAAK,CAAL,CAAd;AACD,CApBD;kBAqBespE,iB;;;;;;;;;;;;;;;;;;ACjOf;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;;;AAEA;;;;;;;;;;;;;;;;;;AAkBA,IAAMuC,0BAA0B,SAA1BA,uBAA0B,CAAS9uF,OAAT,EAAkBsoB,UAAlB,EAA8BF,MAA9B,EAAsCynB,SAAtC,EAAiDk/C,YAAjD,EAA+D;AAC7FnH,0BAAcrtE,IAAd,CAAmB,IAAnB;;AAEA;;;;AAIA,OAAKy0E,QAAL,GAAgBhvF,OAAhB;;AAEA;;;;AAIA,OAAKyoB,WAAL,GAAmBH,UAAnB;;AAEA;;;;AAIA,OAAK47B,OAAL,GAAe97B,MAAf;;AAEA;;;;AAIA,OAAK6mE,UAAL,GAAkBp/C,SAAlB;;AAEA;;;;AAIA,OAAKq/C,aAAL,GAAqBH,YAArB;;AAEA;;;;AAIA,OAAKI,iBAAL,GAAyB,IAAzB;;AAEA;;;;AAIA,OAAKC,mBAAL,GAA2B,IAA3B;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,IAAzB;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkB,IAAlB;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoB,IAApB;;AAEA;;;;AAIA,OAAKzC,MAAL,GAAc,IAAd;;AAEA;;;;AAIA,OAAK0C,aAAL,GAAqB,CAArB;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,CAArB;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoB,CAApB;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,CAArB;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,CAArB;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,CAArB;;AAEA;;;;AAIA,OAAKC,oBAAL,GAA4B,KAA5B;;AAEA;;;;AAIA,OAAKC,cAAL,GAAsB,CAAtB;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmB,CAAnB;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,KAAzB;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmB,CAAnB;;AAEA;;;;AAIA,OAAKC,KAAL,GAAa,EAAb;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoB,CAApB;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoB,CAApB;;AAEA;;;;AAIA,OAAKC,mBAAL,GAA2B,KAA3B;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,CAArB;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkB,CAAlB;;AAEA;;;;AAIA,OAAKC,cAAL,GAAsB,IAAtB;;AAEA;;;;AAIA,OAAKC,gBAAL,GAAwB,IAAxB;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkB,IAAlB;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,EAAzB;;AAEA;;;;AAIA,OAAKC,kBAAL,GAA0B,yBAA1B;AAED,CAzMD,C,CArCA;;;AAGA;AACA;AACA;;AA2OA,qBAAS/B,uBAAT,EAAkClH,uBAAlC;;AAGA;;;;;;;AAOAkH,wBAAwB51E,SAAxB,CAAkC43E,WAAlC,GAAgD,UAASr1C,eAAT,EAA0BnV,MAA1B,EAAkC3b,GAAlC,EAAuC6c,MAAvC,EAA+C;AAC7F,MAAI,CAAC,KAAKslD,MAAV,EAAkB;AAChB;AACD;AACD,MAAMiE,mBAAmB,4BACvBt1C,eADuB,EACNnV,MADM,EACE3b,GADF,EACO,CADP,EACU,KAAKskE,UADf,EAEvB,KAAK2B,iBAFkB,CAAzB;AAGA,MAAM5wF,UAAU,KAAKgvF,QAArB;AACA,MAAMgC,iBAAiB,KAAKH,kBAA5B;AACA,MAAM1pF,QAAQnH,QAAQqsF,WAAtB;AACA,MAAI,KAAKsD,aAAL,IAAsB,CAA1B,EAA6B;AAC3B3vF,YAAQqsF,WAAR,GAAsBllF,QAAQ,KAAKwoF,aAAnC;AACD;AACD,MAAI/yD,WAAW,KAAKmzD,cAApB;AACA,MAAI,KAAKD,oBAAT,EAA+B;AAC7BlzD,gBAAY,KAAKsyD,aAAjB;AACD;AACD,OAAK,IAAIlwF,IAAI,CAAR,EAAWwkB,KAAKutE,iBAAiB9xF,MAAtC,EAA8CD,IAAIwkB,EAAlD,EAAsDxkB,KAAK,CAA3D,EAA8D;AAC5D,QAAIoK,IAAI2nF,iBAAiB/xF,CAAjB,IAAsB,KAAKwwF,aAAnC;AACA,QAAIr4E,IAAI45E,iBAAiB/xF,IAAI,CAArB,IAA0B,KAAKywF,aAAvC;AACA,QAAI,KAAKQ,iBAAT,EAA4B;AAC1B7mF,UAAIrG,KAAKoH,KAAL,CAAWf,CAAX,CAAJ;AACA+N,UAAIpU,KAAKoH,KAAL,CAAWgN,CAAX,CAAJ;AACD;AACD,QAAIylB,aAAa,CAAb,IAAkB,KAAKozD,WAAL,IAAoB,CAA1C,EAA6C;AAC3C,UAAMjoD,UAAU3+B,IAAI,KAAKomF,aAAzB;AACA,UAAMxnD,UAAU7wB,IAAI,KAAKs4E,aAAzB;AACA,+BAAiBuB,cAAjB,EACEjpD,OADF,EACWC,OADX,EAEE,KAAKgoD,WAFP,EAEoB,KAAKA,WAFzB,EAGEpzD,QAHF,EAIE,CAACmL,OAJH,EAIY,CAACC,OAJb;AAKAhoC,cAAQssF,YAAR,CAAqB9qF,KAArB,CAA2BxB,OAA3B,EAAoCgxF,cAApC;AACD;AACDhxF,YAAQ0pF,SAAR,CAAkB,KAAKoD,MAAvB,EAA+B,KAAK8C,aAApC,EAAmD,KAAKC,aAAxD,EACE,KAAKK,WADP,EACoB,KAAKR,YADzB,EACuCtmF,CADvC,EAC0C+N,CAD1C,EAEE,KAAK+4E,WAFP,EAEoB,KAAKR,YAFzB;AAGD;AACD,MAAI9yD,aAAa,CAAb,IAAkB,KAAKozD,WAAL,IAAoB,CAA1C,EAA6C;AAC3ChwF,YAAQssF,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC;AACD;AACD,MAAI,KAAKqD,aAAL,IAAsB,CAA1B,EAA6B;AAC3B3vF,YAAQqsF,WAAR,GAAsBllF,KAAtB;AACD;AACF,CA5CD;;AA+CA;;;;;;;AAOA2nF,wBAAwB51E,SAAxB,CAAkC+3E,SAAlC,GAA8C,UAASx1C,eAAT,EAA0BnV,MAA1B,EAAkC3b,GAAlC,EAAuC6c,MAAvC,EAA+C;AAC3F,MAAI,CAAC,KAAKmpD,UAAN,IAAoB,KAAKR,KAAL,KAAe,EAAvC,EAA2C;AACzC;AACD;AACD,MAAI,KAAKM,cAAT,EAAyB;AACvB,SAAKS,oBAAL,CAA0B,KAAKT,cAA/B;AACD;AACD,MAAI,KAAKC,gBAAT,EAA2B;AACzB,SAAKS,sBAAL,CAA4B,KAAKT,gBAAjC;AACD;AACD,OAAKU,oBAAL,CAA0B,KAAKT,UAA/B;AACA,MAAMI,mBAAmB,4BACvBt1C,eADuB,EACNnV,MADM,EACE3b,GADF,EACO6c,MADP,EACe,KAAKynD,UADpB,EAEvB,KAAK2B,iBAFkB,CAAzB;AAGA,MAAM5wF,UAAU,KAAKgvF,QAArB;AACA,MAAIpyD,WAAW,KAAK2zD,aAApB;AACA,MAAI,KAAKD,mBAAT,EAA8B;AAC5B1zD,gBAAY,KAAKsyD,aAAjB;AACD;AACD,SAAO5oD,SAAS3b,GAAhB,EAAqB2b,UAAUkB,MAA/B,EAAuC;AACrC,QAAMp+B,IAAI2nF,iBAAiBzqD,MAAjB,IAA2B,KAAK8pD,YAA1C;AACA,QAAMj5E,IAAI45E,iBAAiBzqD,SAAS,CAA1B,IAA+B,KAAK+pD,YAA9C;AACA,QAAIzzD,aAAa,CAAb,IAAkB,KAAK4zD,UAAL,IAAmB,CAAzC,EAA4C;AAC1C,UAAMQ,iBAAiB,yBAAiB,KAAKH,kBAAtB,EACrBznF,CADqB,EAClB+N,CADkB,EAErB,KAAKq5E,UAFgB,EAEJ,KAAKA,UAFD,EAGrB5zD,QAHqB,EAIrB,CAACxzB,CAJoB,EAIjB,CAAC+N,CAJgB,CAAvB;AAKAnX,cAAQssF,YAAR,CAAqB9qF,KAArB,CAA2BxB,OAA3B,EAAoCgxF,cAApC;AACD;AACD,QAAI,KAAKN,gBAAT,EAA2B;AACzB1wF,cAAQqxF,UAAR,CAAmB,KAAKlB,KAAxB,EAA+B/mF,CAA/B,EAAkC+N,CAAlC;AACD;AACD,QAAI,KAAKs5E,cAAT,EAAyB;AACvBzwF,cAAQsxF,QAAR,CAAiB,KAAKnB,KAAtB,EAA6B/mF,CAA7B,EAAgC+N,CAAhC;AACD;AACF;AACD,MAAIylB,aAAa,CAAb,IAAkB,KAAK4zD,UAAL,IAAmB,CAAzC,EAA4C;AAC1CxwF,YAAQssF,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC;AACD;AACF,CAxCD;;AA2CA;;;;;;;;;AASAwC,wBAAwB51E,SAAxB,CAAkCq4E,aAAlC,GAAkD,UAAS91C,eAAT,EAA0BnV,MAA1B,EAAkC3b,GAAlC,EAAuC6c,MAAvC,EAA+CgqD,KAA/C,EAAsD;AACtG,MAAMxxF,UAAU,KAAKgvF,QAArB;AACA,MAAM+B,mBAAmB,4BACvBt1C,eADuB,EACNnV,MADM,EACE3b,GADF,EACO6c,MADP,EACe,KAAKynD,UADpB,EAEvB,KAAK2B,iBAFkB,CAAzB;AAGA5wF,UAAQyxF,MAAR,CAAeV,iBAAiB,CAAjB,CAAf,EAAoCA,iBAAiB,CAAjB,CAApC;AACA,MAAI9xF,SAAS8xF,iBAAiB9xF,MAA9B;AACA,MAAIuyF,KAAJ,EAAW;AACTvyF,cAAU,CAAV;AACD;AACD,OAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIC,MAApB,EAA4BD,KAAK,CAAjC,EAAoC;AAClCgB,YAAQ0xF,MAAR,CAAeX,iBAAiB/xF,CAAjB,CAAf,EAAoC+xF,iBAAiB/xF,IAAI,CAArB,CAApC;AACD;AACD,MAAIwyF,KAAJ,EAAW;AACTxxF,YAAQ2xF,SAAR;AACD;AACD,SAAOhnE,GAAP;AACD,CAjBD;;AAoBA;;;;;;;;AAQAmkE,wBAAwB51E,SAAxB,CAAkC04E,UAAlC,GAA+C,UAASn2C,eAAT,EAA0BnV,MAA1B,EAAkCwiB,IAAlC,EAAwCthB,MAAxC,EAAgD;AAC7F,OAAK,IAAIxoC,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7CsnC,aAAS,KAAKirD,aAAL,CAAmB91C,eAAnB,EAAoCnV,MAApC,EAA4CwiB,KAAK9pD,CAAL,CAA5C,EAAqDwoC,MAArD,EAA6D,IAA7D,CAAT;AACD;AACD,SAAOlB,MAAP;AACD,CALD;;AAQA;;;;;;;;AAQAwoD,wBAAwB51E,SAAxB,CAAkC6uE,UAAlC,GAA+C,UAAS/gE,QAAT,EAAmB;AAChE,MAAI,CAAC,wBAAW,KAAKk9B,OAAhB,EAAyBl9B,SAAS0B,SAAT,EAAzB,CAAL,EAAqD;AACnD;AACD;AACD,MAAI,KAAK4mE,UAAL,IAAmB,KAAKC,YAA5B,EAA0C;AACxC,QAAI,KAAKD,UAAT,EAAqB;AACnB,WAAK4B,oBAAL,CAA0B,KAAK5B,UAA/B;AACD;AACD,QAAI,KAAKC,YAAT,EAAuB;AACrB,WAAK4B,sBAAL,CAA4B,KAAK5B,YAAjC;AACD;AACD,QAAMwB,mBAAmB,qCACvB/pE,QADuB,EACb,KAAKioE,UADQ,EACI,KAAK2B,iBADT,CAAzB;AAEA,QAAM9lE,KAAKimE,iBAAiB,CAAjB,IAAsBA,iBAAiB,CAAjB,CAAjC;AACA,QAAMhmE,KAAKgmE,iBAAiB,CAAjB,IAAsBA,iBAAiB,CAAjB,CAAjC;AACA,QAAM/tC,SAASjgD,KAAKsG,IAAL,CAAUyhB,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,CAAf;AACA,QAAM/qB,UAAU,KAAKgvF,QAArB;AACAhvF,YAAQ6xF,SAAR;AACA7xF,YAAQ8xF,GAAR,CACEf,iBAAiB,CAAjB,CADF,EACuBA,iBAAiB,CAAjB,CADvB,EAC4C/tC,MAD5C,EACoD,CADpD,EACuD,IAAIjgD,KAAKiG,EADhE;AAEA,QAAI,KAAKsmF,UAAT,EAAqB;AACnBtvF,cAAQ+xF,IAAR;AACD;AACD,QAAI,KAAKxC,YAAT,EAAuB;AACrBvvF,cAAQgyF,MAAR;AACD;AACF;AACD,MAAI,KAAK7B,KAAL,KAAe,EAAnB,EAAuB;AACrB,SAAKc,SAAL,CAAejqE,SAASib,SAAT,EAAf,EAAqC,CAArC,EAAwC,CAAxC,EAA2C,CAA3C;AACD;AACF,CA9BD;;AAiCA;;;;;;;;AAQA6sD,wBAAwB51E,SAAxB,CAAkCuO,QAAlC,GAA6C,UAASrE,KAAT,EAAgB;AAC3D,OAAK4lE,kBAAL,CAAwB5lE,MAAM6uE,OAAN,EAAxB,EAAyC7uE,MAAM8uE,SAAN,EAAzC;AACA,OAAK/I,aAAL,CAAmB/lE,MAAMuF,QAAN,EAAnB;AACA,OAAK2gE,YAAL,CAAkBlmE,MAAM+uE,OAAN,EAAlB;AACD,CAJD;;AAOA;;;;;;;;AAQArD,wBAAwB51E,SAAxB,CAAkC4uE,YAAlC,GAAiD,UAAS9gE,QAAT,EAAmB;AAClE,MAAM1nB,OAAO0nB,SAAS5O,OAAT,EAAb;AACA,UAAQ9Y,IAAR;AACE,SAAKsnC,uBAAaigB,KAAlB;AACE,WAAK8hC,SAAL,EAAe,mCAAqC3hE,QAApD;AACA;AACF,SAAK4f,uBAAakgB,WAAlB;AACE,WAAKqhC,cAAL,EAAoB,wCAA0CnhE,QAA9D;AACA;AACF,SAAK4f,uBAAaogB,OAAlB;AACE,WAAK6hC,WAAL,EAAiB,qCAAuC7hE,QAAxD;AACA;AACF,SAAK4f,uBAAaqgB,WAAlB;AACE,WAAKshC,cAAL,EAAoB,wCAA0CvhE,QAA9D;AACA;AACF,SAAK4f,uBAAasgB,iBAAlB;AACE,WAAKmhC,mBAAL,EAAyB,6CAA+CrhE,QAAxE;AACA;AACF,SAAK4f,uBAAaugB,aAAlB;AACE,WAAKshC,gBAAL,EAAsB,0CAA4CzhE,QAAlE;AACA;AACF,SAAK4f,uBAAa6f,mBAAlB;AACE,WAAKwhC,sBAAL,EAA4B,gDAAkDjhE,QAA9E;AACA;AACF,SAAK4f,uBAAaC,MAAlB;AACE,WAAKkhD,UAAL,EAAgB,oCAAsC/gE,QAAtD;AACA;AACF;AAzBF;AA2BD,CA7BD;;AAgCA;;;;;;;;;;;AAWA8nE,wBAAwB51E,SAAxB,CAAkC8uE,WAAlC,GAAgD,UAASv6E,OAAT,EAAkB2V,KAAlB,EAAyB;AACvE,MAAM4D,WAAW5D,MAAMgvE,mBAAN,GAA4B3kF,OAA5B,CAAjB;AACA,MAAI,CAACuZ,QAAD,IAAa,CAAC,wBAAW,KAAKk9B,OAAhB,EAAyBl9B,SAAS0B,SAAT,EAAzB,CAAlB,EAAkE;AAChE;AACD;AACD,OAAKjB,QAAL,CAAcrE,KAAd;AACA,OAAK0kE,YAAL,CAAkB9gE,QAAlB;AACD,CAPD;;AAUA;;;;;;;AAOA8nE,wBAAwB51E,SAAxB,CAAkC+uE,sBAAlC,GAA2D,UAASjhE,QAAT,EAAmB;AAC5E,MAAMi6B,aAAaj6B,SAAS06B,kBAAT,EAAnB;AACA,OAAK,IAAI1iD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnD,SAAK8oF,YAAL,CAAkB7mC,WAAWjiD,CAAX,CAAlB;AACD;AACF,CALD;;AAQA;;;;;;;AAOA8vF,wBAAwB51E,SAAxB,CAAkCyvE,SAAlC,GAA8C,UAAS3hE,QAAT,EAAmB;AAC/D,MAAMy0B,kBAAkBz0B,SAASigB,kBAAT,EAAxB;AACA,MAAMO,SAASxgB,SAASygB,SAAT,EAAf;AACA,MAAI,KAAKqlD,MAAT,EAAiB;AACf,SAAKgE,WAAL,CAAiBr1C,eAAjB,EAAkC,CAAlC,EAAqCA,gBAAgBx8C,MAArD,EAA6DuoC,MAA7D;AACD;AACD,MAAI,KAAK2oD,KAAL,KAAe,EAAnB,EAAuB;AACrB,SAAKc,SAAL,CAAex1C,eAAf,EAAgC,CAAhC,EAAmCA,gBAAgBx8C,MAAnD,EAA2DuoC,MAA3D;AACD;AACF,CATD;;AAYA;;;;;;;AAOAsnD,wBAAwB51E,SAAxB,CAAkCqvE,cAAlC,GAAmD,UAASvhE,QAAT,EAAmB;AACpE,MAAMy0B,kBAAkBz0B,SAASigB,kBAAT,EAAxB;AACA,MAAMO,SAASxgB,SAASygB,SAAT,EAAf;AACA,MAAI,KAAKqlD,MAAT,EAAiB;AACf,SAAKgE,WAAL,CAAiBr1C,eAAjB,EAAkC,CAAlC,EAAqCA,gBAAgBx8C,MAArD,EAA6DuoC,MAA7D;AACD;AACD,MAAI,KAAK2oD,KAAL,KAAe,EAAnB,EAAuB;AACrB,SAAKc,SAAL,CAAex1C,eAAf,EAAgC,CAAhC,EAAmCA,gBAAgBx8C,MAAnD,EAA2DuoC,MAA3D;AACD;AACF,CATD;;AAYA;;;;;;;AAOAsnD,wBAAwB51E,SAAxB,CAAkCivE,cAAlC,GAAmD,UAASnhE,QAAT,EAAmB;AACpE,MAAI,CAAC,wBAAW,KAAKk9B,OAAhB,EAAyBl9B,SAAS0B,SAAT,EAAzB,CAAL,EAAqD;AACnD;AACD;AACD,MAAI,KAAK6mE,YAAT,EAAuB;AACrB,SAAK4B,sBAAL,CAA4B,KAAK5B,YAAjC;AACA,QAAMvvF,UAAU,KAAKgvF,QAArB;AACA,QAAMvzC,kBAAkBz0B,SAASigB,kBAAT,EAAxB;AACAjnC,YAAQ6xF,SAAR;AACA,SAAKN,aAAL,CAAmB91C,eAAnB,EAAoC,CAApC,EAAuCA,gBAAgBx8C,MAAvD,EACE+nB,SAASygB,SAAT,EADF,EACwB,KADxB;AAEAznC,YAAQgyF,MAAR;AACD;AACD,MAAI,KAAK7B,KAAL,KAAe,EAAnB,EAAuB;AACrB,QAAMkC,eAAerrE,SAASghC,eAAT,EAArB;AACA,SAAKipC,SAAL,CAAeoB,YAAf,EAA6B,CAA7B,EAAgC,CAAhC,EAAmC,CAAnC;AACD;AACF,CAjBD;;AAoBA;;;;;;;AAOAvD,wBAAwB51E,SAAxB,CAAkCmvE,mBAAlC,GAAwD,UAASrhE,QAAT,EAAmB;AACzE,MAAMsrE,iBAAiBtrE,SAAS0B,SAAT,EAAvB;AACA,MAAI,CAAC,wBAAW,KAAKw7B,OAAhB,EAAyBouC,cAAzB,CAAL,EAA+C;AAC7C;AACD;AACD,MAAI,KAAK/C,YAAT,EAAuB;AACrB,SAAK4B,sBAAL,CAA4B,KAAK5B,YAAjC;AACA,QAAMvvF,UAAU,KAAKgvF,QAArB;AACA,QAAMvzC,kBAAkBz0B,SAASigB,kBAAT,EAAxB;AACA,QAAIX,SAAS,CAAb;AACA,QAAMwiB,OAAO9hC,SAAS2hC,OAAT,EAAb;AACA,QAAMnhB,SAASxgB,SAASygB,SAAT,EAAf;AACAznC,YAAQ6xF,SAAR;AACA,SAAK,IAAI7yF,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7CsnC,eAAS,KAAKirD,aAAL,CAAmB91C,eAAnB,EAAoCnV,MAApC,EAA4CwiB,KAAK9pD,CAAL,CAA5C,EAAqDwoC,MAArD,EAA6D,KAA7D,CAAT;AACD;AACDxnC,YAAQgyF,MAAR;AACD;AACD,MAAI,KAAK7B,KAAL,KAAe,EAAnB,EAAuB;AACrB,QAAMoC,gBAAgBvrE,SAASgiC,gBAAT,EAAtB;AACA,SAAKioC,SAAL,CAAesB,aAAf,EAA8B,CAA9B,EAAiCA,cAActzF,MAA/C,EAAuD,CAAvD;AACD;AACF,CAtBD;;AAyBA;;;;;;;AAOA6vF,wBAAwB51E,SAAxB,CAAkC2vE,WAAlC,GAAgD,UAAS7hE,QAAT,EAAmB;AACjE,MAAI,CAAC,wBAAW,KAAKk9B,OAAhB,EAAyBl9B,SAAS0B,SAAT,EAAzB,CAAL,EAAqD;AACnD;AACD;AACD,MAAI,KAAK6mE,YAAL,IAAqB,KAAKD,UAA9B,EAA0C;AACxC,QAAI,KAAKA,UAAT,EAAqB;AACnB,WAAK4B,oBAAL,CAA0B,KAAK5B,UAA/B;AACD;AACD,QAAI,KAAKC,YAAT,EAAuB;AACrB,WAAK4B,sBAAL,CAA4B,KAAK5B,YAAjC;AACD;AACD,QAAMvvF,UAAU,KAAKgvF,QAArB;AACAhvF,YAAQ6xF,SAAR;AACA,SAAKD,UAAL,CAAgB5qE,SAASqjC,0BAAT,EAAhB,EACE,CADF,EACKrjC,SAAS2hC,OAAT,EADL,EACyB3hC,SAASygB,SAAT,EADzB;AAEA,QAAI,KAAK6nD,UAAT,EAAqB;AACnBtvF,cAAQ+xF,IAAR;AACD;AACD,QAAI,KAAKxC,YAAT,EAAuB;AACrBvvF,cAAQgyF,MAAR;AACD;AACF;AACD,MAAI,KAAK7B,KAAL,KAAe,EAAnB,EAAuB;AACrB,QAAMqC,oBAAoBxrE,SAAS4kC,oBAAT,EAA1B;AACA,SAAKqlC,SAAL,CAAeuB,iBAAf,EAAkC,CAAlC,EAAqC,CAArC,EAAwC,CAAxC;AACD;AACF,CA1BD;;AA6BA;;;;;;AAMA1D,wBAAwB51E,SAAxB,CAAkCuvE,gBAAlC,GAAqD,UAASzhE,QAAT,EAAmB;AACtE,MAAI,CAAC,wBAAW,KAAKk9B,OAAhB,EAAyBl9B,SAAS0B,SAAT,EAAzB,CAAL,EAAqD;AACnD;AACD;AACD,MAAI,KAAK6mE,YAAL,IAAqB,KAAKD,UAA9B,EAA0C;AACxC,QAAI,KAAKA,UAAT,EAAqB;AACnB,WAAK4B,oBAAL,CAA0B,KAAK5B,UAA/B;AACD;AACD,QAAI,KAAKC,YAAT,EAAuB;AACrB,WAAK4B,sBAAL,CAA4B,KAAK5B,YAAjC;AACD;AACD,QAAMvvF,UAAU,KAAKgvF,QAArB;AACA,QAAMvzC,kBAAkBz0B,SAASqjC,0BAAT,EAAxB;AACA,QAAI/jB,SAAS,CAAb;AACA,QAAM2kB,QAAQjkC,SAASujC,QAAT,EAAd;AACA,QAAM/iB,SAASxgB,SAASygB,SAAT,EAAf;AACAznC,YAAQ6xF,SAAR;AACA,SAAK,IAAI7yF,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,UAAM8pD,OAAOmC,MAAMjsD,CAAN,CAAb;AACAsnC,eAAS,KAAKsrD,UAAL,CAAgBn2C,eAAhB,EAAiCnV,MAAjC,EAAyCwiB,IAAzC,EAA+CthB,MAA/C,CAAT;AACD;AACD,QAAI,KAAK8nD,UAAT,EAAqB;AACnBtvF,cAAQ+xF,IAAR;AACD;AACD,QAAI,KAAKxC,YAAT,EAAuB;AACrBvvF,cAAQgyF,MAAR;AACD;AACF;AACD,MAAI,KAAK7B,KAAL,KAAe,EAAnB,EAAuB;AACrB,QAAMsC,qBAAqBzrE,SAASwjC,qBAAT,EAA3B;AACA,SAAKymC,SAAL,CAAewB,kBAAf,EAAmC,CAAnC,EAAsCA,mBAAmBxzF,MAAzD,EAAiE,CAAjE;AACD;AACF,CAhCD;;AAmCA;;;;AAIA6vF,wBAAwB51E,SAAxB,CAAkCg4E,oBAAlC,GAAyD,UAASwB,SAAT,EAAoB;AAC3E,MAAM1yF,UAAU,KAAKgvF,QAArB;AACA,MAAM2D,mBAAmB,KAAKxD,iBAA9B;AACA,MAAI,CAACwD,gBAAL,EAAuB;AACrB3yF,YAAQipF,SAAR,GAAoByJ,UAAUzJ,SAA9B;AACA,SAAKkG,iBAAL,GAAyB;AACvBlG,iBAAWyJ,UAAUzJ;AADE,KAAzB;AAGD,GALD,MAKO;AACL,QAAI0J,iBAAiB1J,SAAjB,IAA8ByJ,UAAUzJ,SAA5C,EAAuD;AACrD0J,uBAAiB1J,SAAjB,GAA6BjpF,QAAQipF,SAAR,GAAoByJ,UAAUzJ,SAA3D;AACD;AACF;AACF,CAbD;;AAgBA;;;;AAIA6F,wBAAwB51E,SAAxB,CAAkCi4E,sBAAlC,GAA2D,UAASyB,WAAT,EAAsB;AAC/E,MAAM5yF,UAAU,KAAKgvF,QAArB;AACA,MAAM6D,qBAAqB,KAAKzD,mBAAhC;AACA,MAAI,CAACyD,kBAAL,EAAyB;AACvB7yF,YAAQ8yF,OAAR,GAAkBF,YAAYE,OAA9B;AACA,QAAI59B,qBAAJ,EAAsB;AACpBl1D,cAAQm1D,WAAR,CAAoBy9B,YAAYG,QAAhC;AACA/yF,cAAQgzF,cAAR,GAAyBJ,YAAYI,cAArC;AACD;AACDhzF,YAAQizF,QAAR,GAAmBL,YAAYK,QAA/B;AACAjzF,YAAQkzF,SAAR,GAAoBN,YAAYM,SAAhC;AACAlzF,YAAQmzF,UAAR,GAAqBP,YAAYO,UAAjC;AACAnzF,YAAQkpF,WAAR,GAAsB0J,YAAY1J,WAAlC;AACA,SAAKkG,mBAAL,GAA2B;AACzB0D,eAASF,YAAYE,OADI;AAEzBC,gBAAUH,YAAYG,QAFG;AAGzBC,sBAAgBJ,YAAYI,cAHH;AAIzBC,gBAAUL,YAAYK,QAJG;AAKzBC,iBAAWN,YAAYM,SALE;AAMzBC,kBAAYP,YAAYO,UANC;AAOzBjK,mBAAa0J,YAAY1J;AAPA,KAA3B;AASD,GAnBD,MAmBO;AACL,QAAI2J,mBAAmBC,OAAnB,IAA8BF,YAAYE,OAA9C,EAAuD;AACrDD,yBAAmBC,OAAnB,GAA6B9yF,QAAQ8yF,OAAR,GAAkBF,YAAYE,OAA3D;AACD;AACD,QAAI59B,qBAAJ,EAAsB;AACpB,UAAI,CAAC,mBAAO29B,mBAAmBE,QAA1B,EAAoCH,YAAYG,QAAhD,CAAL,EAAgE;AAC9D/yF,gBAAQm1D,WAAR,CAAoB09B,mBAAmBE,QAAnB,GAA8BH,YAAYG,QAA9D;AACD;AACD,UAAIF,mBAAmBG,cAAnB,IAAqCJ,YAAYI,cAArD,EAAqE;AACnEH,2BAAmBG,cAAnB,GAAoChzF,QAAQgzF,cAAR,GAChCJ,YAAYI,cADhB;AAED;AACF;AACD,QAAIH,mBAAmBI,QAAnB,IAA+BL,YAAYK,QAA/C,EAAyD;AACvDJ,yBAAmBI,QAAnB,GAA8BjzF,QAAQizF,QAAR,GAAmBL,YAAYK,QAA7D;AACD;AACD,QAAIJ,mBAAmBK,SAAnB,IAAgCN,YAAYM,SAAhD,EAA2D;AACzDL,yBAAmBK,SAAnB,GAA+BlzF,QAAQkzF,SAAR,GAAoBN,YAAYM,SAA/D;AACD;AACD,QAAIL,mBAAmBM,UAAnB,IAAiCP,YAAYO,UAAjD,EAA6D;AAC3DN,yBAAmBM,UAAnB,GAAgCnzF,QAAQmzF,UAAR,GAC5BP,YAAYO,UADhB;AAED;AACD,QAAIN,mBAAmB3J,WAAnB,IAAkC0J,YAAY1J,WAAlD,EAA+D;AAC7D2J,yBAAmB3J,WAAnB,GAAiClpF,QAAQkpF,WAAR,GAC7B0J,YAAY1J,WADhB;AAED;AACF;AACF,CAlDD;;AAqDA;;;;AAIA4F,wBAAwB51E,SAAxB,CAAkCk4E,oBAAlC,GAAyD,UAASgC,SAAT,EAAoB;AAC3E,MAAMpzF,UAAU,KAAKgvF,QAArB;AACA,MAAMqE,mBAAmB,KAAKhE,iBAA9B;AACA,MAAMiE,YAAYF,UAAUE,SAAV,GAChBF,UAAUE,SADM,GACMnJ,wBADxB;AAEA,MAAI,CAACkJ,gBAAL,EAAuB;AACrBrzF,YAAQyjB,IAAR,GAAe2vE,UAAU3vE,IAAzB;AACAzjB,YAAQszF,SAAR,GAAoBA,SAApB;AACAtzF,YAAQuzF,YAAR,GAAuBH,UAAUG,YAAjC;AACA,SAAKlE,iBAAL,GAAyB;AACvB5rE,YAAM2vE,UAAU3vE,IADO;AAEvB6vE,iBAAWA,SAFY;AAGvBC,oBAAcH,UAAUG;AAHD,KAAzB;AAKD,GATD,MASO;AACL,QAAIF,iBAAiB5vE,IAAjB,IAAyB2vE,UAAU3vE,IAAvC,EAA6C;AAC3C4vE,uBAAiB5vE,IAAjB,GAAwBzjB,QAAQyjB,IAAR,GAAe2vE,UAAU3vE,IAAjD;AACD;AACD,QAAI4vE,iBAAiBC,SAAjB,IAA8BA,SAAlC,EAA6C;AAC3CD,uBAAiBC,SAAjB,GAA6BtzF,QAAQszF,SAAR,GAAoBA,SAAjD;AACD;AACD,QAAID,iBAAiBE,YAAjB,IAAiCH,UAAUG,YAA/C,EAA6D;AAC3DF,uBAAiBE,YAAjB,GAAgCvzF,QAAQuzF,YAAR,GAC5BH,UAAUG,YADd;AAED;AACF;AACF,CA1BD;;AA6BA;;;;;;;;AAQAzE,wBAAwB51E,SAAxB,CAAkC8vE,kBAAlC,GAAuD,UAASC,SAAT,EAAoBC,WAApB,EAAiC;AACtF,MAAI,CAACD,SAAL,EAAgB;AACd,SAAKqG,UAAL,GAAkB,IAAlB;AACD,GAFD,MAEO;AACL,QAAMkE,iBAAiBvK,UAAUwK,QAAV,EAAvB;AACA,SAAKnE,UAAL,GAAkB;AAChBrG,iBAAW,4BAAYuK,iBACrBA,cADqB,GACJ5J,wBADR;AADK,KAAlB;AAID;AACD,MAAI,CAACV,WAAL,EAAkB;AAChB,SAAKqG,YAAL,GAAoB,IAApB;AACD,GAFD,MAEO;AACL,QAAMmE,mBAAmBxK,YAAYuK,QAAZ,EAAzB;AACA,QAAME,qBAAqBzK,YAAY0K,UAAZ,EAA3B;AACA,QAAMC,sBAAsB3K,YAAY4K,WAAZ,EAA5B;AACA,QAAMC,4BAA4B7K,YAAY8K,iBAAZ,EAAlC;AACA,QAAMC,sBAAsB/K,YAAYgL,WAAZ,EAA5B;AACA,QAAMC,mBAAmBjL,YAAYxpD,QAAZ,EAAzB;AACA,QAAM00D,wBAAwBlL,YAAYmL,aAAZ,EAA9B;AACA,SAAK9E,YAAL,GAAoB;AAClBuD,eAASa,uBAAuB/zF,SAAvB,GACP+zF,kBADO,GACc9J,sBAFL;AAGlBkJ,gBAAUc,sBACRA,mBADQ,GACc/J,uBAJN;AAKlBkJ,sBAAgBe,4BACdA,yBADc,GACchK,6BANZ;AAOlBkJ,gBAAUgB,wBAAwBr0F,SAAxB,GACRq0F,mBADQ,GACcjK,uBARN;AASlBkJ,iBAAW,KAAKzqE,WAAL,IAAoB0rE,qBAAqBv0F,SAArB,GAC7Bu0F,gBAD6B,GACV7J,wBADV,CATO;AAWlB6I,kBAAYiB,0BAA0Bx0F,SAA1B,GACVw0F,qBADU,GACcnK,yBAZR;AAalBf,mBAAa,4BAAYwK,mBACvBA,gBADuB,GACJxJ,0BADR;AAbK,KAApB;AAgBD;AACF,CArCD;;AAwCA;;;;;;;AAOA4E,wBAAwB51E,SAAxB,CAAkCiwE,aAAlC,GAAkD,UAASC,UAAT,EAAqB;AACrE,MAAI,CAACA,UAAL,EAAiB;AACf,SAAK0D,MAAL,GAAc,IAAd;AACD,GAFD,MAEO;AACL,QAAMwH,cAAclL,WAAWkF,SAAX,EAApB;AACA;AACA,QAAMiG,aAAanL,WAAWzgE,QAAX,CAAoB,CAApB,CAAnB;AACA,QAAM6rE,cAAcpL,WAAWsF,SAAX,EAApB;AACA,QAAM+F,YAAYrL,WAAWvwD,OAAX,EAAlB;AACA,SAAK22D,aAAL,GAAqB8E,YAAY,CAAZ,CAArB;AACA,SAAK7E,aAAL,GAAqB6E,YAAY,CAAZ,CAArB;AACA,SAAK5E,YAAL,GAAoB+E,UAAU,CAAV,CAApB;AACA,SAAK3H,MAAL,GAAcyH,UAAd;AACA,SAAK5E,aAAL,GAAqBvG,WAAWzW,UAAX,EAArB;AACA,SAAKid,aAAL,GAAqB4E,YAAY,CAAZ,CAArB;AACA,SAAK3E,aAAL,GAAqB2E,YAAY,CAAZ,CAArB;AACA,SAAK1E,oBAAL,GAA4B1G,WAAWuF,iBAAX,EAA5B;AACA,SAAKoB,cAAL,GAAsB3G,WAAWlnD,WAAX,EAAtB;AACA,SAAK8tD,WAAL,GAAmB5G,WAAWwF,QAAX,KAAwB,KAAKnmE,WAAhD;AACA,SAAKwnE,iBAAL,GAAyB7G,WAAWyF,cAAX,EAAzB;AACA,SAAKqB,WAAL,GAAmBuE,UAAU,CAAV,CAAnB;AACD;AACF,CAtBD;;AAyBA;;;;;;;AAOA3F,wBAAwB51E,SAAxB,CAAkCowE,YAAlC,GAAiD,UAASC,SAAT,EAAoB;AACnE,MAAI,CAACA,SAAL,EAAgB;AACd,SAAK4G,KAAL,GAAa,EAAb;AACD,GAFD,MAEO;AACL,QAAMuE,gBAAgBnL,UAAU0I,OAAV,EAAtB;AACA,QAAI,CAACyC,aAAL,EAAoB;AAClB,WAAKjE,cAAL,GAAsB,IAAtB;AACD,KAFD,MAEO;AACL,UAAMkE,qBAAqBD,cAAcjB,QAAd,EAA3B;AACA,WAAKhD,cAAL,GAAsB;AACpBxH,mBAAW,4BAAY0L,qBACrBA,kBADqB,GACA/K,wBADZ;AADS,OAAtB;AAID;AACD,QAAMgL,kBAAkBrL,UAAU2I,SAAV,EAAxB;AACA,QAAI,CAAC0C,eAAL,EAAsB;AACpB,WAAKlE,gBAAL,GAAwB,IAAxB;AACD,KAFD,MAEO;AACL,UAAMmE,uBAAuBD,gBAAgBnB,QAAhB,EAA7B;AACA,UAAMqB,yBAAyBF,gBAAgBhB,UAAhB,EAA/B;AACA,UAAMmB,0BAA0BH,gBAAgBd,WAAhB,EAAhC;AACA,UAAMkB,gCAAgCJ,gBAAgBZ,iBAAhB,EAAtC;AACA,UAAMiB,0BAA0BL,gBAAgBV,WAAhB,EAAhC;AACA,UAAMgB,uBAAuBN,gBAAgBl1D,QAAhB,EAA7B;AACA,UAAMy1D,4BAA4BP,gBAAgBP,aAAhB,EAAlC;AACA,WAAK3D,gBAAL,GAAwB;AACtBoC,iBAASgC,2BAA2Bl1F,SAA3B,GACPk1F,sBADO,GACkBjL,sBAFL;AAGtBkJ,kBAAUgC,0BACRA,uBADQ,GACkBjL,uBAJN;AAKtBkJ,wBAAgBgC,gCACdA,6BADc,GACkBjL,6BANZ;AAOtBkJ,kBAAUgC,4BAA4Br1F,SAA5B,GACRq1F,uBADQ,GACkBjL,uBARN;AAStBkJ,mBAAWgC,yBAAyBt1F,SAAzB,GACTs1F,oBADS,GACc5K,wBAVH;AAWtB6I,oBAAYgC,8BAA8Bv1F,SAA9B,GACVu1F,yBADU,GACkBlL,yBAZR;AAatBf,qBAAa,4BAAY2L,uBACvBA,oBADuB,GACA3K,0BADZ;AAbS,OAAxB;AAgBD;AACD,QAAMkL,WAAW7L,UAAU8L,OAAV,EAAjB;AACA,QAAMC,cAAc/L,UAAUgM,UAAV,EAApB;AACA,QAAMC,cAAcjM,UAAUkM,UAAV,EAApB;AACA,QAAMC,qBAAqBnM,UAAUoF,iBAAV,EAA3B;AACA,QAAMgH,eAAepM,UAAUrnD,WAAV,EAArB;AACA,QAAM0zD,YAAYrM,UAAUqF,QAAV,EAAlB;AACA,QAAMiH,WAAWtM,UAAU4I,OAAV,EAAjB;AACA,QAAM2D,gBAAgBvM,UAAUwM,YAAV,EAAtB;AACA,QAAMC,mBAAmBzM,UAAU0M,eAAV,EAAzB;AACA,SAAKtF,UAAL,GAAkB;AAChBltE,YAAM2xE,aAAax1F,SAAb,GACJw1F,QADI,GACOzL,mBAFG;AAGhB2J,iBAAWwC,kBAAkBl2F,SAAlB,GACTk2F,aADS,GACO3L,wBAJF;AAKhBoJ,oBAAcyC,qBAAqBp2F,SAArB,GACZo2F,gBADY,GACO5L;AANL,KAAlB;AAQA,SAAK+F,KAAL,GAAa0F,aAAaj2F,SAAb,GAAyBi2F,QAAzB,GAAoC,EAAjD;AACA,SAAKzF,YAAL,GACIkF,gBAAgB11F,SAAhB,GAA6B,KAAK6oB,WAAL,GAAmB6sE,WAAhD,GAA+D,CADnE;AAEA,SAAKjF,YAAL,GACImF,gBAAgB51F,SAAhB,GAA6B,KAAK6oB,WAAL,GAAmB+sE,WAAhD,GAA+D,CADnE;AAEA,SAAKlF,mBAAL,GAA2BoF,uBAAuB91F,SAAvB,GAAmC81F,kBAAnC,GAAwD,KAAnF;AACA,SAAKnF,aAAL,GAAqBoF,iBAAiB/1F,SAAjB,GAA6B+1F,YAA7B,GAA4C,CAAjE;AACA,SAAKnF,UAAL,GAAkB,KAAK/nE,WAAL,IAAoBmtE,cAAch2F,SAAd,GACpCg2F,SADoC,GACxB,CADI,CAAlB;AAED;AACF,CArED;kBAsEe9G,uB;;;;;;;;;;;;;;;;;ACr8Bf;;;;AAIA;;;AAGA,IAAMoH,cAAc;AAClBC,kBAAgB,CADE;AAElBC,cAAY,CAFM;AAGlBvvD,UAAQ,CAHU;AAIlBwvD,cAAY,CAJM;AAKlBC,UAAQ,CALU;AAMlBC,cAAY,CANM;AAOlBvI,cAAY,CAPM;AAQlBwI,gBAAc,CARI;AASlBC,QAAM,CATY;AAUlBC,mBAAiB,CAVC;AAWlBC,kBAAgB,EAXE;AAYlBC,oBAAkB,EAZA;AAalBC,UAAQ;AAbU,CAApB;;AAiBA;;;AAGO,IAAMC,4CAAkB,CAACZ,YAAYO,IAAb,CAAxB;;AAGP;;;AAGO,IAAMM,gDAAoB,CAACb,YAAYW,MAAb,CAA1B;;AAGP;;;AAGO,IAAMG,sDAAuB,CAACd,YAAYE,UAAb,CAA7B;;AAGP;;;AAGO,IAAMa,sDAAuB,CAACf,YAAYG,UAAb,CAA7B;;kBAGQH,W;;;;;;;;;;;;;;;;;;AC7Cf;;AACA;;;;AACA;;;;;;AAEA;;;;;;;;;;;AAWA,IAAMgB,yBAAyB,SAAzBA,sBAAyB,CAC7BnyC,SAD6B,EAClBynC,SADkB,EACPnkE,UADO,EACKC,UADL,EACiBmkE,QADjB,EAC2BC,aAD3B,EAC0C;AACvEC,mBAAapyE,IAAb,CAAkB,IAAlB,EACEwqC,SADF,EACaynC,SADb,EACwBnkE,UADxB,EACoCC,UADpC,EACgDmkE,QADhD,EAC0DC,aAD1D;AAED,CAJD,C,CAlBA;;;;;AAwBA,qBAASwK,sBAAT,EAAiCvK,gBAAjC;;AAGA;;;;;;;;AAQAuK,uBAAuBh+E,SAAvB,CAAiCi+E,oBAAjC,GAAwD,UAAS17C,eAAT,EAA0BnV,MAA1B,EAAkC3b,GAAlC,EAAuC6c,MAAvC,EAA+C;AACrG,MAAMomD,UAAU,KAAKhzC,WAAL,CAAiB37C,MAAjC;AACA,MAAM4uF,QAAQ,KAAKH,qBAAL,CACZjyC,eADY,EACKnV,MADL,EACa3b,GADb,EACkB6c,MADlB,EAC0B,KAD1B,EACiC,KADjC,CAAd;AAEA,MAAM4vD,0BAA0B,CAACrJ,sBAAkB2I,eAAnB,EAAoC9I,OAApC,EAA6CC,KAA7C,CAAhC;AACA,OAAKC,YAAL,CAAkB9sF,IAAlB,CAAuBo2F,uBAAvB;AACA,OAAKnJ,wBAAL,CAA8BjtF,IAA9B,CAAmCo2F,uBAAnC;AACA,SAAOzsE,GAAP;AACD,CARD;;AAWA;;;AAGAusE,uBAAuBh+E,SAAvB,CAAiCivE,cAAjC,GAAkD,UAASC,kBAAT,EAA6B36E,OAA7B,EAAsC;AACtF,MAAM8a,QAAQ,KAAKA,KAAnB;AACA,MAAM2gE,cAAc3gE,MAAM2gE,WAA1B;AACA,MAAMgK,YAAY3qE,MAAM2qE,SAAxB;AACA,MAAIhK,gBAAgBtpF,SAAhB,IAA6BszF,cAActzF,SAA/C,EAA0D;AACxD;AACD;AACD,OAAKy3F,iBAAL,CAAuB9uE,KAAvB,EAA8B,KAAK+uE,WAAnC;AACA,OAAK3J,aAAL,CAAmBvF,kBAAnB,EAAuC36E,OAAvC;AACA,OAAKwgF,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkB6I,gBADe,EAEjCruE,MAAM2gE,WAF2B,EAEd3gE,MAAM2qE,SAFQ,EAEG3qE,MAAMuqE,OAFT,EAEkBvqE,MAAM0qE,QAFxB,EAGjC1qE,MAAM4qE,UAH2B,EAGf5qE,MAAMwqE,QAHS,EAGCxqE,MAAMyqE,cAHP,CAAnC,EAIGgE,iCAJH;AAKA,MAAMv7C,kBAAkB2sC,mBAAmBnhD,kBAAnB,EAAxB;AACA,MAAMO,SAAS4gD,mBAAmB3gD,SAAnB,EAAf;AACA,OAAK0vD,oBAAL,CAA0B17C,eAA1B,EAA2C,CAA3C,EAA8CA,gBAAgBx8C,MAA9D,EAAsEuoC,MAAtE;AACA,OAAKymD,wBAAL,CAA8BjtF,IAA9B,CAAmC+1F,8BAAnC;AACA,OAAK7I,WAAL,CAAiB9F,kBAAjB,EAAqC36E,OAArC;AACD,CAnBD;;AAsBA;;;AAGAypF,uBAAuBh+E,SAAvB,CAAiCmvE,mBAAjC,GAAuD,UAASC,uBAAT,EAAkC76E,OAAlC,EAA2C;AAChG,MAAM8a,QAAQ,KAAKA,KAAnB;AACA,MAAM2gE,cAAc3gE,MAAM2gE,WAA1B;AACA,MAAMgK,YAAY3qE,MAAM2qE,SAAxB;AACA,MAAIhK,gBAAgBtpF,SAAhB,IAA6BszF,cAActzF,SAA/C,EAA0D;AACxD;AACD;AACD,OAAKy3F,iBAAL,CAAuB9uE,KAAvB,EAA8B,KAAK+uE,WAAnC;AACA,OAAK3J,aAAL,CAAmBrF,uBAAnB,EAA4C76E,OAA5C;AACA,OAAKwgF,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkB6I,gBADe,EAEjCruE,MAAM2gE,WAF2B,EAEd3gE,MAAM2qE,SAFQ,EAEG3qE,MAAMuqE,OAFT,EAEkBvqE,MAAM0qE,QAFxB,EAGjC1qE,MAAM4qE,UAH2B,EAGf5qE,MAAMwqE,QAHS,EAGCxqE,MAAMyqE,cAHP,CAAnC,EAIGgE,iCAJH;AAKA,MAAMluC,OAAOw/B,wBAAwB3/B,OAAxB,EAAb;AACA,MAAMlN,kBAAkB6sC,wBAAwBrhD,kBAAxB,EAAxB;AACA,MAAMO,SAAS8gD,wBAAwB7gD,SAAxB,EAAf;AACA,MAAInB,SAAS,CAAb;AACA,OAAK,IAAItnC,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7CsnC,aAAS,KAAK6wD,oBAAL,CAA0B17C,eAA1B,EAA2CnV,MAA3C,EAAmDwiB,KAAK9pD,CAAL,CAAnD,EAA4DwoC,MAA5D,CAAT;AACD;AACD,OAAKymD,wBAAL,CAA8BjtF,IAA9B,CAAmC+1F,8BAAnC;AACA,OAAK7I,WAAL,CAAiB5F,uBAAjB,EAA0C76E,OAA1C;AACD,CAvBD;;AA0BA;;;AAGAypF,uBAAuBh+E,SAAvB,CAAiCi1E,MAAjC,GAA0C,YAAW;AACnD,MAAM5lE,QAAQ,KAAKA,KAAnB;AACA,MAAIA,MAAMgvE,UAAN,IAAoB33F,SAApB,IAAiC2oB,MAAMgvE,UAAN,IAAoB,KAAK38C,WAAL,CAAiB37C,MAA1E,EAAkF;AAChF,SAAK6uF,YAAL,CAAkB9sF,IAAlB,CAAuB+1F,8BAAvB;AACD;AACD,OAAK3I,+BAAL;AACA,OAAK7lE,KAAL,GAAa,IAAb;AACD,CAPD;;AAUA;;;AAGA2uE,uBAAuBh+E,SAAvB,CAAiCo+E,WAAjC,GAA+C,UAAS/uE,KAAT,EAAgB;AAC7D,MAAIA,MAAMgvE,UAAN,IAAoB33F,SAApB,IAAiC2oB,MAAMgvE,UAAN,IAAoB,KAAK38C,WAAL,CAAiB37C,MAA1E,EAAkF;AAChF,SAAK6uF,YAAL,CAAkB9sF,IAAlB,CAAuB+1F,8BAAvB;AACAxuE,UAAMgvE,UAAN,GAAmB,KAAK38C,WAAL,CAAiB37C,MAApC;AACD;AACDspB,QAAMgvE,UAAN,GAAmB,CAAnB;AACA5K,mBAAazzE,SAAb,CAAuBo+E,WAAvB,CAAmC/8E,IAAnC,CAAwC,IAAxC,EAA8CgO,KAA9C;AACA,OAAKulE,YAAL,CAAkB9sF,IAAlB,CAAuBg2F,iCAAvB;AACD,CARD;kBASeE,sB;;;;;;;;;;;;;;;;;;AC1Hf;;AACA;;AACA;;AACA;;AACA;;;;AAGA;;;;;;AAGA;;;;;;;;;;;AAbA;;;AAwBA,IAAMM,sBAAsB,SAAtBA,mBAAsB,CAC1BzyC,SAD0B,EACfynC,SADe,EACJnkE,UADI,EACQC,UADR,EACoBmkE,QADpB,EAC8BC,aAD9B,EAC6C;AACvEC,mBAAapyE,IAAb,CAAkB,IAAlB,EACEwqC,SADF,EACaynC,SADb,EACwBnkE,UADxB,EACoCC,UADpC,EACgDmkE,QADhD,EAC0DC,aAD1D;AAED,CAJD;;AAMA,qBAAS8K,mBAAT,EAA8B7K,gBAA9B;;AAGA;;;;;;;;AAQA6K,oBAAoBt+E,SAApB,CAA8Bu+E,qBAA9B,GAAsD,UAASh8C,eAAT,EAA0BnV,MAA1B,EAAkCwiB,IAAlC,EAAwCthB,MAAxC,EAAgD;AACpG,MAAMjf,QAAQ,KAAKA,KAAnB;AACA,MAAMwpE,OAAOxpE,MAAM0gE,SAAN,KAAoBrpF,SAAjC;AACA,MAAMoyF,SAASzpE,MAAM2gE,WAAN,IAAqBtpF,SAApC;AACA,MAAM83F,UAAU5uC,KAAK7pD,MAArB;AACA,OAAK6uF,YAAL,CAAkB9sF,IAAlB,CAAuBg2F,iCAAvB;AACA,OAAK/I,wBAAL,CAA8BjtF,IAA9B,CAAmCg2F,iCAAnC;AACA,OAAK,IAAIh4F,IAAI,CAAb,EAAgBA,IAAI04F,OAApB,EAA6B,EAAE14F,CAA/B,EAAkC;AAChC,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACA,QAAM4uF,UAAU,KAAKhzC,WAAL,CAAiB37C,MAAjC;AACA,QAAM4uF,QAAQ,KAAKH,qBAAL,CAA2BjyC,eAA3B,EAA4CnV,MAA5C,EAAoD3b,GAApD,EAAyD6c,MAAzD,EAAiE,IAAjE,EAAuE,CAACwqD,MAAxE,CAAd;AACA,QAAMoF,0BAA0B,CAACrJ,sBAAkB2I,eAAnB,EAAoC9I,OAApC,EAA6CC,KAA7C,CAAhC;AACA,SAAKC,YAAL,CAAkB9sF,IAAlB,CAAuBo2F,uBAAvB;AACA,SAAKnJ,wBAAL,CAA8BjtF,IAA9B,CAAmCo2F,uBAAnC;AACA,QAAIpF,MAAJ,EAAY;AACV;AACA;AACA,WAAKlE,YAAL,CAAkB9sF,IAAlB,CAAuBi2F,iCAAvB;AACA,WAAKhJ,wBAAL,CAA8BjtF,IAA9B,CAAmCi2F,iCAAnC;AACD;AACD3wD,aAAS3b,GAAT;AACD;AACD,OAAKsjE,wBAAL,CAA8BjtF,IAA9B,CAAmC81F,4BAAnC;AACA,MAAI/E,IAAJ,EAAU;AACR,SAAKjE,YAAL,CAAkB9sF,IAAlB,CAAuB81F,4BAAvB;AACD;AACD,MAAI9E,MAAJ,EAAY;AACV,SAAKlE,YAAL,CAAkB9sF,IAAlB,CAAuB+1F,8BAAvB;AACA,SAAK9I,wBAAL,CAA8BjtF,IAA9B,CAAmC+1F,8BAAnC;AACD;AACD,SAAOzwD,MAAP;AACD,CA/BD;;AAkCA;;;AAGAkxD,oBAAoBt+E,SAApB,CAA8B6uE,UAA9B,GAA2C,UAAShe,cAAT,EAAyBt8D,OAAzB,EAAkC;AAC3E,MAAM8a,QAAQ,KAAKA,KAAnB;AACA,MAAM0gE,YAAY1gE,MAAM0gE,SAAxB;AACA,MAAMC,cAAc3gE,MAAM2gE,WAA1B;AACA,MAAID,cAAcrpF,SAAd,IAA2BspF,gBAAgBtpF,SAA/C,EAA0D;AACxD;AACD;AACD,OAAK+3F,oBAAL,CAA0B5tB,cAA1B;AACA,OAAK4jB,aAAL,CAAmB5jB,cAAnB,EAAmCt8D,OAAnC;AACA;AACA,OAAKwgF,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkB4I,cADe,EAEjC,qBAAS/M,wBAAT,CAFiC,CAAnC;AAIA,MAAIrhE,MAAM2gE,WAAN,KAAsBtpF,SAA1B,EAAqC;AACnC,SAAKquF,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkB6I,gBADe,EAEjCruE,MAAM2gE,WAF2B,EAEd3gE,MAAM2qE,SAFQ,EAEG3qE,MAAMuqE,OAFT,EAEkBvqE,MAAM0qE,QAFxB,EAGjC1qE,MAAM4qE,UAH2B,EAGf5qE,MAAMwqE,QAHS,EAGCxqE,MAAMyqE,cAHP,CAAnC;AAKD;AACD,MAAMv3C,kBAAkBsuB,eAAe9iC,kBAAf,EAAxB;AACA,MAAMO,SAASuiC,eAAetiC,SAAf,EAAf;AACA,MAAMmmD,UAAU,KAAKhzC,WAAL,CAAiB37C,MAAjC;AACA,OAAKyuF,qBAAL,CACEjyC,eADF,EACmB,CADnB,EACsBA,gBAAgBx8C,MADtC,EAC8CuoC,MAD9C,EACsD,KADtD,EAC6D,KAD7D;AAEA,MAAMowD,oBAAoB,CAAC7J,sBAAkBlnD,MAAnB,EAA2B+mD,OAA3B,CAA1B;AACA,OAAKE,YAAL,CAAkB9sF,IAAlB,CAAuBg2F,iCAAvB,EAA6CY,iBAA7C;AACA,OAAK3J,wBAAL,CAA8BjtF,IAA9B,CAAmCg2F,iCAAnC,EAAyDY,iBAAzD;AACA,OAAK3J,wBAAL,CAA8BjtF,IAA9B,CAAmC81F,4BAAnC;AACA,MAAIvuE,MAAM0gE,SAAN,KAAoBrpF,SAAxB,EAAmC;AACjC,SAAKkuF,YAAL,CAAkB9sF,IAAlB,CAAuB81F,4BAAvB;AACD;AACD,MAAIvuE,MAAM2gE,WAAN,KAAsBtpF,SAA1B,EAAqC;AACnC,SAAKkuF,YAAL,CAAkB9sF,IAAlB,CAAuB+1F,8BAAvB;AACA,SAAK9I,wBAAL,CAA8BjtF,IAA9B,CAAmC+1F,8BAAnC;AACD;AACD,OAAK7I,WAAL,CAAiBnkB,cAAjB,EAAiCt8D,OAAjC;AACD,CAtCD;;AAyCA;;;AAGA+pF,oBAAoBt+E,SAApB,CAA8B2vE,WAA9B,GAA4C,UAASC,eAAT,EAA0Br7E,OAA1B,EAAmC;AAC7E,MAAM8a,QAAQ,KAAKA,KAAnB;AACA,OAAKovE,oBAAL,CAA0B7O,eAA1B;AACA,OAAK6E,aAAL,CAAmB7E,eAAnB,EAAoCr7E,OAApC;AACA;AACA,OAAKwgF,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkB4I,cADe,EAEjC,qBAAS/M,wBAAT,CAFiC,CAAnC;AAIA,MAAIrhE,MAAM2gE,WAAN,KAAsBtpF,SAA1B,EAAqC;AACnC,SAAKquF,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkB6I,gBADe,EAEjCruE,MAAM2gE,WAF2B,EAEd3gE,MAAM2qE,SAFQ,EAEG3qE,MAAMuqE,OAFT,EAEkBvqE,MAAM0qE,QAFxB,EAGjC1qE,MAAM4qE,UAH2B,EAGf5qE,MAAMwqE,QAHS,EAGCxqE,MAAMyqE,cAHP,CAAnC;AAKD;AACD,MAAMlqC,OAAOggC,gBAAgBngC,OAAhB,EAAb;AACA,MAAMlN,kBAAkBqtC,gBAAgBz+B,0BAAhB,EAAxB;AACA,MAAM7iB,SAASshD,gBAAgBrhD,SAAhB,EAAf;AACA,OAAKgwD,qBAAL,CAA2Bh8C,eAA3B,EAA4C,CAA5C,EAA+CqN,IAA/C,EAAqDthB,MAArD;AACA,OAAK0mD,WAAL,CAAiBpF,eAAjB,EAAkCr7E,OAAlC;AACD,CArBD;;AAwBA;;;AAGA+pF,oBAAoBt+E,SAApB,CAA8BuvE,gBAA9B,GAAiD,UAASC,oBAAT,EAA+Bj7E,OAA/B,EAAwC;AACvF,MAAM8a,QAAQ,KAAKA,KAAnB;AACA,MAAM0gE,YAAY1gE,MAAM0gE,SAAxB;AACA,MAAMC,cAAc3gE,MAAM2gE,WAA1B;AACA,MAAID,cAAcrpF,SAAd,IAA2BspF,gBAAgBtpF,SAA/C,EAA0D;AACxD;AACD;AACD,OAAK+3F,oBAAL,CAA0BjP,oBAA1B;AACA,OAAKiF,aAAL,CAAmBjF,oBAAnB,EAAyCj7E,OAAzC;AACA;AACA,OAAKwgF,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkB4I,cADe,EAEjC,qBAAS/M,wBAAT,CAFiC,CAAnC;AAIA,MAAIrhE,MAAM2gE,WAAN,KAAsBtpF,SAA1B,EAAqC;AACnC,SAAKquF,wBAAL,CAA8BjtF,IAA9B,CAAmC,CACjC+sF,sBAAkB6I,gBADe,EAEjCruE,MAAM2gE,WAF2B,EAEd3gE,MAAM2qE,SAFQ,EAEG3qE,MAAMuqE,OAFT,EAEkBvqE,MAAM0qE,QAFxB,EAGjC1qE,MAAM4qE,UAH2B,EAGf5qE,MAAMwqE,QAHS,EAGCxqE,MAAMyqE,cAHP,CAAnC;AAKD;AACD,MAAM/nC,QAAQy9B,qBAAqBn+B,QAArB,EAAd;AACA,MAAM9O,kBAAkBitC,qBAAqBr+B,0BAArB,EAAxB;AACA,MAAM7iB,SAASkhD,qBAAqBjhD,SAArB,EAAf;AACA,MAAInB,SAAS,CAAb;AACA,OAAK,IAAItnC,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9CsnC,aAAS,KAAKmxD,qBAAL,CAA2Bh8C,eAA3B,EAA4CnV,MAA5C,EAAoD2kB,MAAMjsD,CAAN,CAApD,EAA8DwoC,MAA9D,CAAT;AACD;AACD,OAAK0mD,WAAL,CAAiBxF,oBAAjB,EAAuCj7E,OAAvC;AACD,CA7BD;;AAgCA;;;AAGA+pF,oBAAoBt+E,SAApB,CAA8Bi1E,MAA9B,GAAuC,YAAW;AAChD,OAAKC,+BAAL;AACA,OAAK7lE,KAAL,GAAa,IAAb;AACA;AACA;AACA;AACA;AACA,MAAMw8B,YAAY,KAAKA,SAAvB;AACA,MAAIA,cAAc,CAAlB,EAAqB;AACnB,QAAMnK,cAAc,KAAKA,WAAzB;AACA,SAAK,IAAI57C,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAjC,EAAyCD,IAAIwkB,EAA7C,EAAiD,EAAExkB,CAAnD,EAAsD;AACpD47C,kBAAY57C,CAAZ,IAAiB,oBAAK47C,YAAY57C,CAAZ,CAAL,EAAqB+lD,SAArB,CAAjB;AACD;AACF;AACF,CAdD;;AAiBA;;;;AAIAyyC,oBAAoBt+E,SAApB,CAA8By+E,oBAA9B,GAAqD,UAAS3wE,QAAT,EAAmB;AACtE,MAAMuB,QAAQ,KAAKA,KAAnB;AACA,MAAM0gE,YAAY1gE,MAAM0gE,SAAxB;AACA,MAAIA,cAAcrpF,SAAlB,EAA6B;AAC3B,SAAKi4F,eAAL,CAAqBtvE,KAArB,EAA4B,KAAKuvE,UAAjC,EAA6C9wE,QAA7C;AACD;AACD,MAAIuB,MAAM2gE,WAAN,KAAsBtpF,SAA1B,EAAqC;AACnC,SAAKy3F,iBAAL,CAAuB9uE,KAAvB,EAA8B,KAAK+uE,WAAnC;AACD;AACF,CATD;kBAUeE,mB;;;;;;;;;;;;;;;;;;ACpNf;;AACA;;AACA;;AACA;;AACA;;AAEA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AAGA;;;;AACA;;AACA;;;;AAOA;;;;;;;;;;;AA9BA;;;AAyCA,IAAM7K,eAAe,SAAfA,YAAe,CAAS5nC,SAAT,EAAoBynC,SAApB,EAA+BnkE,UAA/B,EAA2CC,UAA3C,EAAuDmkE,QAAvD,EAAiEC,aAAjE,EAAgF;AACnG9E,0BAAcrtE,IAAd,CAAmB,IAAnB;;AAEA;;;AAGA,OAAKmyE,aAAL,GAAqBA,aAArB;;AAEA;;;;AAIA,OAAK3nC,SAAL,GAAiBA,SAAjB;;AAEA;;;;;AAKA,OAAKynC,SAAL,GAAiBA,SAAjB;;AAEA;;;;AAIA,OAAKC,QAAL,GAAgBA,QAAhB;;AAEA;;;;AAIA,OAAKnkE,UAAL,GAAkBA,UAAlB;;AAEA;;;;AAIA,OAAKyvE,YAAL,GAAoB,CAApB;;AAEA;;;;;AAKA,OAAK1vE,UAAL,GAAkBA,UAAlB;;AAEA;;;;AAIA,OAAK2vE,UAAL;;AAEA;;;;AAIA,OAAKC,0BAAL,GAAkC,IAAlC;;AAEA;;;;AAIA,OAAKC,0BAAL,GAAkC,IAAlC;;AAEA;;;;AAIA,OAAKC,kBAAL,GAA0B,IAA1B;;AAEA;;;;AAIA,OAAKrK,YAAL,GAAoB,EAApB;;AAEA;;;;AAIA,OAAKlzC,WAAL,GAAmB,EAAnB;;AAEA;;;;AAIA,OAAKw9C,gBAAL,GAAwB,EAAxB;;AAEA;;;;AAIA,OAAKC,kBAAL,GAA0B,yBAA1B;;AAEA;;;;AAIA,OAAKpK,wBAAL,GAAgC,EAAhC;;AAEA;;;;AAIA,OAAK2C,iBAAL,GAAyB,IAAzB;;AAEA;;;;AAIA,OAAKroE,KAAL,GAAa,sDAAwD,EAArE;;AAEA;;;;AAIA,OAAK2mE,aAAL,GAAqB,CAArB;AAED,CAtHD;;AAwHA,qBAASvC,YAAT,EAAuB/E,uBAAvB;;AAGA;;;AAGA,IAAM0Q,YAAY,0BAAlB;;AAGA;;;AAGA,IAAM/zC,eAAe,yBAArB;;AAEA;;;;;;;;;AASAooC,aAAazzE,SAAb,CAAuBq/E,qBAAvB,GAA+C,UAASv4F,OAAT,EAAkBw4F,EAAlB,EAAsBC,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAC7C7B,eAD6C,EAC5BC,iBAD4B,EACT;AACpC/2F,UAAQ6xF,SAAR;AACA7xF,UAAQyxF,MAAR,CAAejwF,KAAf,CAAqBxB,OAArB,EAA8Bw4F,EAA9B;AACAx4F,UAAQ0xF,MAAR,CAAelwF,KAAf,CAAqBxB,OAArB,EAA8By4F,EAA9B;AACAz4F,UAAQ0xF,MAAR,CAAelwF,KAAf,CAAqBxB,OAArB,EAA8B04F,EAA9B;AACA14F,UAAQ0xF,MAAR,CAAelwF,KAAf,CAAqBxB,OAArB,EAA8B24F,EAA9B;AACA34F,UAAQ0xF,MAAR,CAAelwF,KAAf,CAAqBxB,OAArB,EAA8Bw4F,EAA9B;AACA,MAAI1B,eAAJ,EAAqB;AACnB,SAAKkB,UAAL,GAAkB,sBAAwBlB,gBAAgB,CAAhB,CAA1C;AACA,SAAK8B,KAAL,CAAW54F,OAAX;AACD;AACD,MAAI+2F,iBAAJ,EAAuB;AACrB,SAAK8B,eAAL,CAAqB74F,OAArB,EAA8B,wBAA0B+2F,iBAAxD;AACA/2F,YAAQgyF,MAAR;AACD;AACF,CAhBD;;AAmBA;;;;;;;;;;;;;;;;;;;;AAoBArF,aAAazzE,SAAb,CAAuB4/E,YAAvB,GAAsC,UAAS94F,OAAT,EAAkBoJ,CAAlB,EAAqB+N,CAArB,EAAwB+0E,KAAxB,EACpCz3B,OADoC,EAC3BC,OAD2B,EAClB25B,cADkB,EACF56D,MADE,EACMy+C,OADN,EACeia,OADf,EACwBC,OADxB,EAEpCxvD,QAFoC,EAE1B0U,KAF0B,EAEnBynD,WAFmB,EAENvlE,KAFM,EAECuT,OAFD,EAEU+vD,eAFV,EAE2BC,iBAF3B,EAE8C;AAClF,MAAMiC,aAAalC,mBAAmBC,iBAAtC;AACAtiC,aAAWnjB,KAAX;AACAojB,aAAWpjB,KAAX;AACAloC,OAAKqrD,OAAL;AACAt9C,OAAKu9C,OAAL;;AAEA,MAAM9wC,IAAK4P,QAAQ24D,OAAR,GAAkBD,MAAM14D,KAAzB,GAAkC04D,MAAM14D,KAAN,GAAc24D,OAAhD,GAA0D34D,KAApE;AACA,MAAM9b,IAAK+b,SAAS24D,OAAT,GAAmBF,MAAMz4D,MAA1B,GAAoCy4D,MAAMz4D,MAAN,GAAe24D,OAAnD,GAA6D34D,MAAvE;AACA,MAAMwlE,OAAOlyD,QAAQ,CAAR,IAAanjB,IAAI0tB,KAAjB,GAAyBvK,QAAQ,CAAR,CAAtC;AACA,MAAMmyD,OAAOnyD,QAAQ,CAAR,IAAarvB,IAAI45B,KAAjB,GAAyBvK,QAAQ,CAAR,CAAtC;AACA,MAAMoyD,OAAO/vF,IAAI29B,QAAQ,CAAR,CAAjB;AACA,MAAMqyD,OAAOjiF,IAAI4vB,QAAQ,CAAR,CAAjB;;AAEA;AACA,MAAIyxD,WAAJ;AACA;AACA,MAAIC,WAAJ;AACA;AACA,MAAIC,WAAJ;AACA;AACA,MAAIC,WAAJ;AACA,MAAIK,cAAcp8D,aAAa,CAA/B,EAAkC;AAChC47D,SAAK,CAACW,IAAD,EAAOC,IAAP,CAAL;AACAX,SAAK,CAACU,OAAOF,IAAR,EAAcG,IAAd,CAAL;AACAV,SAAK,CAACS,OAAOF,IAAR,EAAcG,OAAOF,IAArB,CAAL;AACAP,SAAK,CAACQ,IAAD,EAAOC,OAAOF,IAAd,CAAL;AACD;;AAED,MAAIrpD,YAAY,IAAhB;AACA,MAAIjT,aAAa,CAAjB,EAAoB;AAClB,QAAMmL,UAAU3+B,IAAIqrD,OAApB;AACA,QAAMzsB,UAAU7wB,IAAIu9C,OAApB;AACA7kB,gBAAY,yBAAiB0U,YAAjB,EAA+Bxc,OAA/B,EAAwCC,OAAxC,EAAiD,CAAjD,EAAoD,CAApD,EAAuDpL,QAAvD,EAAiE,CAACmL,OAAlE,EAA2E,CAACC,OAA5E,CAAZ;;AAEA,qCAAoBswD,SAApB;AACA,kCAAiBA,SAAjB,EAA4B,uBAAe/zC,YAAf,EAA6Bi0C,EAA7B,CAA5B;AACA,kCAAiBF,SAAjB,EAA4B,uBAAe/zC,YAAf,EAA6Bk0C,EAA7B,CAA5B;AACA,kCAAiBH,SAAjB,EAA4B,uBAAe/zC,YAAf,EAA6Bm0C,EAA7B,CAA5B;AACA,kCAAiBJ,SAAjB,EAA4B,uBAAe/zC,YAAf,EAA6Bo0C,EAA7B,CAA5B;AACD,GAVD,MAUO;AACL,gCAAeQ,IAAf,EAAqBC,IAArB,EAA2BD,OAAOF,IAAlC,EAAwCG,OAAOF,IAA/C,EAAqDZ,SAArD;AACD;AACD,MAAMrvE,SAASjpB,QAAQipB,MAAvB;AACA,MAAMowE,gBAAgBtC,oBAAqBA,kBAAkB,CAAlB,IAAuBzlD,KAAvB,GAA+B,CAApD,GAAyD,CAA/E;AACA,MAAM3R,aACF24D,UAAU,CAAV,IAAee,aAAf,IAAgCpwE,OAAOuK,KAAvC,IAAgD8kE,UAAU,CAAV,IAAee,aAAf,IAAgC,CAAhF,IACAf,UAAU,CAAV,IAAee,aAAf,IAAgCpwE,OAAOwK,MADvC,IACiD6kE,UAAU,CAAV,IAAee,aAAf,IAAgC,CAFrF;;AAIA,MAAIN,WAAJ,EAAiB;AACf3vF,QAAIrG,KAAKoH,KAAL,CAAWf,CAAX,CAAJ;AACA+N,QAAIpU,KAAKoH,KAAL,CAAWgN,CAAX,CAAJ;AACD;;AAED,MAAIk3E,cAAJ,EAAoB;AAClB,QAAI,CAAC1uD,UAAD,IAAe0uD,eAAe,CAAf,KAAqB,CAAxC,EAA2C;AACzC;AACD;AACD,wBAAOA,cAAP,EAAuBiK,SAAvB;AACA,QAAMgB,gBAAgB35D,aACpB,CAAC3/B,OAAD,EAAU6vC,YAAYA,UAAUhxC,KAAV,CAAgB,CAAhB,CAAZ,GAAiC,IAA3C,EAAiDqzE,OAAjD,EAA0Dga,KAA1D,EAAiEC,OAAjE,EAA0EC,OAA1E,EAAmFxoE,CAAnF,EAAsFlM,CAAtF,EAAyFtO,CAAzF,EAA4F+N,CAA5F,EAA+Fm6B,KAA/F,CADoB,GAEpB,IAFF;AAGA,QAAIgoD,iBAAiBN,UAArB,EAAiC;AAC/BM,oBAAct4F,IAAd,CAAmB81F,eAAnB,EAAoCC,iBAApC,EAAuDyB,EAAvD,EAA2DC,EAA3D,EAA+DC,EAA/D,EAAmEC,EAAnE;AACD;AACDtK,mBAAertF,IAAf,CAAoBs4F,aAApB;AACD,GAZD,MAYO,IAAI35D,UAAJ,EAAgB;AACrB,QAAIq5D,UAAJ,EAAgB;AACd,WAAKT,qBAAL,CAA2Bv4F,OAA3B,EAAoCw4F,EAApC,EAAwCC,EAAxC,EAA4CC,EAA5C,EAAgDC,EAAhD;AACE,8BAA0B7B,eAD5B;AAEE,8BAA0BC,iBAF5B;AAGD;AACD,2BAAU/2F,OAAV,EAAmB6vC,SAAnB,EAA8BqiC,OAA9B,EAAuCga,KAAvC,EAA8CC,OAA9C,EAAuDC,OAAvD,EAAgExoE,CAAhE,EAAmElM,CAAnE,EAAsEtO,CAAtE,EAAyE+N,CAAzE,EAA4Em6B,KAA5E;AACD;AACF,CA5ED;;AA+EA;;;;;AAKAq7C,aAAazzE,SAAb,CAAuBqgF,eAAvB,GAAyC,UAASC,SAAT,EAAoB;AAC3D,MAAMlxE,aAAa,KAAKA,UAAxB;AACA,SAAOA,cAAc,CAAd,GAAkBkxE,SAAlB,GAA8BA,UAAUh8F,GAAV,CAAc,UAASi8F,IAAT,EAAe;AAChE,WAAOA,OAAOnxE,UAAd;AACD,GAFoC,CAArC;AAGD,CALD;;AAQA;;;;;;;;;;AAUAqkE,aAAazzE,SAAb,CAAuBw0E,qBAAvB,GAA+C,UAASjyC,eAAT,EAA0BnV,MAA1B,EAAkC3b,GAAlC,EAAuC6c,MAAvC,EAA+CkyD,MAA/C,EAAuDC,SAAvD,EAAkE;;AAE/G,MAAI9L,QAAQ,KAAKjzC,WAAL,CAAiB37C,MAA7B;AACA,MAAMmpB,SAAS,KAAKwxE,oBAAL,EAAf;AACA,MAAID,SAAJ,EAAe;AACbrzD,cAAUkB,MAAV;AACD;AACD,MAAMqyD,YAAY,CAACp+C,gBAAgBnV,MAAhB,CAAD,EAA0BmV,gBAAgBnV,SAAS,CAAzB,CAA1B,CAAlB;AACA,MAAMwzD,YAAY,CAACn1C,GAAD,EAAMA,GAAN,CAAlB;AACA,MAAIo1C,UAAU,IAAd;;AAEA,MAAI/6F,UAAJ;AAAA,MAAOg7F,gBAAP;AAAA,MAAgBC,gBAAhB;AACA,OAAKj7F,IAAIsnC,SAASkB,MAAlB,EAA0BxoC,IAAI2rB,GAA9B,EAAmC3rB,KAAKwoC,MAAxC,EAAgD;AAC9CsyD,cAAU,CAAV,IAAer+C,gBAAgBz8C,CAAhB,CAAf;AACA86F,cAAU,CAAV,IAAer+C,gBAAgBz8C,IAAI,CAApB,CAAf;AACAi7F,cAAU,oCAAuB7xE,MAAvB,EAA+B0xE,SAA/B,CAAV;AACA,QAAIG,YAAYD,OAAhB,EAAyB;AACvB,UAAID,OAAJ,EAAa;AACX,aAAKn/C,WAAL,CAAiBizC,OAAjB,IAA4BgM,UAAU,CAAV,CAA5B;AACA,aAAKj/C,WAAL,CAAiBizC,OAAjB,IAA4BgM,UAAU,CAAV,CAA5B;AACD;AACD,WAAKj/C,WAAL,CAAiBizC,OAAjB,IAA4BiM,UAAU,CAAV,CAA5B;AACA,WAAKl/C,WAAL,CAAiBizC,OAAjB,IAA4BiM,UAAU,CAAV,CAA5B;AACAC,gBAAU,KAAV;AACD,KARD,MAQO,IAAIE,YAAY7+C,uBAAaI,YAA7B,EAA2C;AAChD,WAAKZ,WAAL,CAAiBizC,OAAjB,IAA4BiM,UAAU,CAAV,CAA5B;AACA,WAAKl/C,WAAL,CAAiBizC,OAAjB,IAA4BiM,UAAU,CAAV,CAA5B;AACAC,gBAAU,KAAV;AACD,KAJM,MAIA;AACLA,gBAAU,IAAV;AACD;AACDF,cAAU,CAAV,IAAeC,UAAU,CAAV,CAAf;AACAD,cAAU,CAAV,IAAeC,UAAU,CAAV,CAAf;AACAE,cAAUC,OAAV;AACD;;AAED;AACA,MAAKP,UAAUK,OAAX,IAAuB/6F,MAAMsnC,SAASkB,MAA1C,EAAkD;AAChD,SAAKoT,WAAL,CAAiBizC,OAAjB,IAA4BgM,UAAU,CAAV,CAA5B;AACA,SAAKj/C,WAAL,CAAiBizC,OAAjB,IAA4BgM,UAAU,CAAV,CAA5B;AACD;AACD,SAAOhM,KAAP;AACD,CA1CD;;AA6CA;;;;;;;;AAQAlB,aAAazzE,SAAb,CAAuBghF,sBAAvB,GAAgD,UAASz+C,eAAT,EAA0BnV,MAA1B,EAAkCwiB,IAAlC,EAAwCthB,MAAxC,EAAgD2yD,UAAhD,EAA4D;AAC1G,OAAK,IAAIn7F,IAAI,CAAR,EAAWwkB,KAAKslC,KAAK7pD,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0C,EAAExkB,CAA5C,EAA+C;AAC7C,QAAM2rB,MAAMm+B,KAAK9pD,CAAL,CAAZ;AACA,QAAMo7F,YAAY,KAAK1M,qBAAL,CAA2BjyC,eAA3B,EAA4CnV,MAA5C,EAAoD3b,GAApD,EAAyD6c,MAAzD,EAAiE,KAAjE,EAAwE,KAAxE,CAAlB;AACA2yD,eAAWn5F,IAAX,CAAgBo5F,SAAhB;AACA9zD,aAAS3b,GAAT;AACD;AACD,SAAO2b,MAAP;AACD,CARD;;AAWA;;;AAGAqmD,aAAazzE,SAAb,CAAuB2uE,UAAvB,GAAoC,UAAS7gE,QAAT,EAAmBvZ,OAAnB,EAA4Bie,QAA5B,EAAsC;AACxE,OAAKiiE,aAAL,CAAmB3mE,QAAnB,EAA6BvZ,OAA7B;AACA,MAAMnO,OAAO0nB,SAAS5O,OAAT,EAAb;AACA,MAAMovB,SAASxgB,SAASygB,SAAT,EAAf;AACA,MAAM4yD,cAAc,KAAKz/C,WAAL,CAAiB37C,MAArC;AACA,MAAIw8C,wBAAJ;AAAA,MAAqB2+C,kBAArB;AAAA,MAAgCD,mBAAhC;AAAA,MAA4CG,oBAA5C;AACA,MAAIh0D,eAAJ;AACA,MAAIhnC,QAAQsnC,uBAAaugB,aAAzB,EAAwC;AACtCngC,eAAW,0CAA4CA,QAAvD;AACAy0B,sBAAkBz0B,SAASqjC,0BAAT,EAAlB;AACAiwC,kBAAc,EAAd;AACA,QAAMrvC,QAAQjkC,SAASujC,QAAT,EAAd;AACAjkB,aAAS,CAAT;AACA,SAAK,IAAItnC,IAAI,CAAR,EAAWwkB,KAAKynC,MAAMhsD,MAA3B,EAAmCD,IAAIwkB,EAAvC,EAA2C,EAAExkB,CAA7C,EAAgD;AAC9C,UAAMu7F,SAAS,EAAf;AACAj0D,eAAS,KAAK4zD,sBAAL,CAA4Bz+C,eAA5B,EAA6CnV,MAA7C,EAAqD2kB,MAAMjsD,CAAN,CAArD,EAA+DwoC,MAA/D,EAAuE+yD,MAAvE,CAAT;AACAD,kBAAYt5F,IAAZ,CAAiBu5F,MAAjB;AACD;AACD,SAAKzM,YAAL,CAAkB9sF,IAAlB,CAAuB,CAAC+sF,sBAAkBuI,MAAnB,EACrB+D,WADqB,EACRC,WADQ,EACKtzE,QADL,EACe0E,QADf,EACyByjC,qCADzB,CAAvB;AAED,GAbD,MAaO,IAAI7vD,QAAQsnC,uBAAaogB,OAArB,IAAgC1nD,QAAQsnC,uBAAasgB,iBAAzD,EAA4E;AACjFizC,iBAAa,EAAb;AACA1+C,sBAAmBn8C,QAAQsnC,uBAAaogB,OAAtB;AAChB,yCAAuChgC,QAAD,CAAWqjC,0BAAX,EADtB,GAEhBrjC,SAASigB,kBAAT,EAFF;AAGAX,aAAS,KAAK4zD,sBAAL,CAA4Bz+C,eAA5B,EAA6C,CAA7C;AACP,wEAAsEz0B,QAAD,CAAW2hC,OAAX,EAD9D,EAEPnhB,MAFO,EAEC2yD,UAFD,CAAT;AAGA,SAAKrM,YAAL,CAAkB9sF,IAAlB,CAAuB,CAAC+sF,sBAAkBuI,MAAnB,EACrB+D,WADqB,EACRF,UADQ,EACInzE,QADJ,EACc0E,QADd,EACwBwjC,gCADxB,CAAvB;AAED,GAVM,MAUA,IAAI5vD,QAAQsnC,uBAAakgB,WAArB,IAAoCxnD,QAAQsnC,uBAAaqgB,WAA7D,EAA0E;AAC/ExL,sBAAkBz0B,SAASigB,kBAAT,EAAlB;AACAmzD,gBAAY,KAAK1M,qBAAL,CACVjyC,eADU,EACO,CADP,EACUA,gBAAgBx8C,MAD1B,EACkCuoC,MADlC,EAC0C,KAD1C,EACiD,KADjD,CAAZ;AAEA,SAAKsmD,YAAL,CAAkB9sF,IAAlB,CAAuB,CAAC+sF,sBAAkBuI,MAAnB,EACrB+D,WADqB,EACRD,SADQ,EACGpzE,QADH,EACa0E,QADb,EACuBujC,2BADvB,CAAvB;AAED,GANM,MAMA,IAAI3vD,QAAQsnC,uBAAaigB,KAAzB,EAAgC;AACrCpL,sBAAkBz0B,SAASigB,kBAAT,EAAlB;AACA,SAAK2T,WAAL,CAAiB55C,IAAjB,CAAsBy6C,gBAAgB,CAAhB,CAAtB,EAA0CA,gBAAgB,CAAhB,CAA1C;AACA2+C,gBAAY,KAAKx/C,WAAL,CAAiB37C,MAA7B;AACA,SAAK6uF,YAAL,CAAkB9sF,IAAlB,CAAuB,CAAC+sF,sBAAkBuI,MAAnB,EACrB+D,WADqB,EACRD,SADQ,EACGpzE,QADH,EACa0E,QADb,CAAvB;AAED;AACD,OAAKwiE,WAAL,CAAiBlnE,QAAjB,EAA2BvZ,OAA3B;AACD,CA5CD;;AA+CA;;;;;AAKAk/E,aAAazzE,SAAb,CAAuBy0E,aAAvB,GAAuC,UAAS3mE,QAAT,EAAmBvZ,OAAnB,EAA4B;AACjE,OAAKwqF,0BAAL,GAAkC,CAAClK,sBAAkBoI,cAAnB,EAAmC1oF,OAAnC,EAA4C,CAA5C,CAAlC;AACA,OAAKqgF,YAAL,CAAkB9sF,IAAlB,CAAuB,KAAKi3F,0BAA5B;AACA,OAAKC,0BAAL,GAAkC,CAACnK,sBAAkBoI,cAAnB,EAAmC1oF,OAAnC,EAA4C,CAA5C,CAAlC;AACA,OAAKwgF,wBAAL,CAA8BjtF,IAA9B,CAAmC,KAAKk3F,0BAAxC;AACD,CALD;;AAQA;;;;AAIAvL,aAAazzE,SAAb,CAAuB0/E,KAAvB,GAA+B,UAAS54F,OAAT,EAAkB;AAC/C,MAAI,KAAKg4F,UAAT,EAAqB;AACnB,QAAMvJ,SAAS,uBAAe,KAAK4J,kBAApB,EAAwC,CAAC,CAAD,EAAI,CAAJ,CAAxC,CAAf;AACA,QAAMmC,aAAa,MAAM,KAAKlyE,UAA9B;AACAtoB,YAAQklD,SAAR,CAAkBupC,OAAO,CAAP,IAAY+L,UAA9B,EAA0C/L,OAAO,CAAP,IAAY+L,UAAtD;AACAx6F,YAAQ8mC,MAAR,CAAe,KAAKooD,aAApB;AACD;AACDlvF,UAAQ+xF,IAAR;AACA,MAAI,KAAKiG,UAAT,EAAqB;AACnBh4F,YAAQssF,YAAR,CAAqB9qF,KAArB,CAA2BxB,OAA3B,EAAoCisF,sBAApC;AACD;AACF,CAXD;;AAcA;;;;;AAKAU,aAAazzE,SAAb,CAAuB2/E,eAAvB,GAAyC,UAAS74F,OAAT,EAAkBy6F,WAAlB,EAA+B;AACtEz6F,UAAQkpF,WAAR,GAAsB,4CAA8CuR,YAAY,CAAZ,CAApE;AACAz6F,UAAQkzF,SAAR,GAAoB,qBAAuBuH,YAAY,CAAZ,CAA3C;AACAz6F,UAAQ8yF,OAAR,GAAkB,qBAAuB2H,YAAY,CAAZ,CAAzC;AACAz6F,UAAQizF,QAAR,GAAmB,qBAAuBwH,YAAY,CAAZ,CAA1C;AACAz6F,UAAQmzF,UAAR,GAAqB,qBAAuBsH,YAAY,CAAZ,CAA5C;AACA,MAAIvlC,qBAAJ,EAAsB;AACpBl1D,YAAQgzF,cAAR,GAAyB,qBAAuByH,YAAY,CAAZ,CAAhD;AACAz6F,YAAQm1D,WAAR,EAAoB,6BAA+BslC,YAAY,CAAZ,CAAnD;AACD;AACF,CAVD;;AAaA;;;;AAIA9N,aAAazzE,SAAb,CAAuBwhF,gBAAvB,GAA0C,UAASrM,cAAT,EAAyB5gF,OAAzB,EAAkC;AAC1E,MAAI4gF,kBAAkBA,eAAepvF,MAAf,GAAwB,CAA9C,EAAiD;AAC/C,QAAM07F,aAAatM,eAAe,CAAf,CAAnB;AACA,QAAIsM,cAAc,CAAd,IAAmBA,cAActM,eAAepvF,MAAf,GAAwB,CAA7D,EAAgE;AAC9D;AACA,UAAM0qE,MAAM;AACV5qC,cAAM,qBAAuBsvD,eAAe,CAAf,CADnB;AAEVpvD,cAAM,qBAAuBovD,eAAe,CAAf,CAFnB;AAGVrvD,cAAM,qBAAuBqvD,eAAe,CAAf,CAHnB;AAIVnvD,cAAM,qBAAuBmvD,eAAe,CAAf,CAJnB;AAKV9rF,eAAOkL;AALG,OAAZ;AAOA,UAAI,CAAC,KAAKi/E,aAAL,CAAmBkO,QAAnB,CAA4BjxB,GAA5B,CAAL,EAAuC;AACrC,aAAK+iB,aAAL,CAAmBvkB,MAAnB,CAA0BwB,GAA1B;AACA,aAAK,IAAIzhE,IAAI,CAAR,EAAW27B,KAAKwqD,eAAepvF,MAApC,EAA4CiJ,IAAI27B,EAAhD,EAAoD,EAAE37B,CAAtD,EAAyD;AACvD,cAAM2yF,gBAAgB,oBAAsBxM,eAAenmF,CAAf,CAA5C;AACA,cAAI2yF,aAAJ,EAAmB;AACjB,gBAAIA,cAAc57F,MAAd,GAAuB,EAA3B,EAA+B;AAC7B,mBAAKs5F,qBAAL,CAA2BsC,cAAc,CAAd,CAA3B,EACEA,cAAc,EAAd,CADF,EACqBA,cAAc,EAAd,CADrB,EACwCA,cAAc,EAAd,CADxC,EAC2DA,cAAc,EAAd,CAD3D,EAEEA,cAAc,EAAd,CAFF,EAEqBA,cAAc,EAAd,CAFrB;AAGD;AACDnR,8BAAUloF,KAAV,CAAgB5B,SAAhB,EAA2Bi7F,aAA3B;AACD;AACF;AACF;AACDxM,qBAAepvF,MAAf,GAAwB,CAAxB;AACA,uCAAoBovF,cAApB;AACD;AACF;AACF,CA9BD;;AAiCA;;;;;;;;;;;;;;AAcA1B,aAAazzE,SAAb,CAAuB4hF,OAAvB,GAAiC,UAC/B96F,OAD+B,EACtB6vC,SADsB,EACXkrD,mBADW,EAE/BjN,YAF+B,EAEjBkN,eAFiB,EAEAC,aAFA,EAEe;AAC9C;AACA,MAAIlK,yBAAJ;AACA,MAAI,KAAKH,iBAAL,IAA0B,mBAAO/gD,SAAP,EAAkB,KAAKwoD,kBAAvB,CAA9B,EAA0E;AACxEtH,uBAAmB,KAAKH,iBAAxB;AACD,GAFD,MAEO;AACL,QAAI,CAAC,KAAKA,iBAAV,EAA6B;AAC3B,WAAKA,iBAAL,GAAyB,EAAzB;AACD;AACDG,uBAAmB,4BACjB,KAAKn2C,WADY,EACC,CADD,EACI,KAAKA,WAAL,CAAiB37C,MADrB,EAC6B,CAD7B,EAEjB4wC,SAFiB,EAEN,KAAK+gD,iBAFC,CAAnB;AAGA,kCAAsB,KAAKyH,kBAA3B,EAA+CxoD,SAA/C;AACD;AACD,MAAMqrD,eAAe,CAAC,kBAAQH,mBAAR,CAAtB;AACA,MAAI/7F,IAAI,CAAR,CAf8C,CAenC;AACX,MAAMwkB,KAAKsqE,aAAa7uF,MAAxB,CAhB8C,CAgBd;AAChC,MAAI8Y,IAAI,CAAR,CAjB8C,CAiBnC;AACX,MAAIojF,WAAJ,CAlB8C,CAkBtC;AACR,MAAI1mC,gBAAJ;AAAA,MAAaC,gBAAb;AAAA,MAAsB0mC,cAAtB;AAAA,MAA6BC,cAA7B;AAAA,MAAoCC,eAApC;AAAA,MAA4CC,eAA5C;AAAA,MAAoDlN,uBAApD;AAAA,MAAoEnC,cAApE;AACA,MAAIsP,cAAc,CAAlB;AACA,MAAIC,gBAAgB,CAApB;AACA,MAAIC,sBAAsB,IAA1B;AACA,MAAIC,wBAAwB,IAA5B;AACA,MAAMC,kBAAkB,KAAKxD,gBAA7B;AACA,MAAMrJ,eAAe,KAAKG,aAA1B;;AAEA,MAAM3mE,QAAQ,qCAAuC;AACnDvoB,aAASA,OAD0C;AAEnDsoB,gBAAY,KAAKA,UAFkC;AAGnDD,gBAAY,KAAKA,UAHkC;AAInDuU,cAAUmyD;AAJyC,GAArD;;AAOA;AACA;AACA,MAAM8M,YAAY,KAAK/N,YAAL,IAAqBA,YAArB,IAAqC,KAAKrB,QAA1C,GAAqD,CAArD,GAAyD,GAA3E;AACA,MAAI,yDAA0Dh/E,gBAA9D;AACA,MAAIrE,UAAJ;AAAA,MAAO+N,UAAP;AACA,SAAOnY,IAAIwkB,EAAX,EAAe;AACb,QAAMi3E,cAAc3M,aAAa9uF,CAAb,CAApB;AACA,QAAMM,OAAO,kDAAoDm7F,YAAY,CAAZ,CAAjE;AACA,YAAQn7F,IAAR;AACE,WAAKyuF,sBAAkBoI,cAAvB;AACE1oF,kBAAU,yDAA2DgtF,YAAY,CAAZ,CAArE;AACA,YAAKS,gBACDH,oBAAoB,mBAAOttF,OAAP,EAAgB5L,QAAhB,EAApB,CADA,IAEA,CAAC4L,QAAQ8Z,WAAR,EAFL,EAE4B;AAC1BvoB,cAAI,qBAAuBy7F,YAAY,CAAZ,CAA3B;AACD,SAJD,MAIO,IAAIQ,kBAAkBr7F,SAAlB,IAA+B,CAAC,wBACzCq7F,aADyC,EAC1BxtF,QAAQ8Z,WAAR,GAAsBmB,SAAtB,EAD0B,CAApC,EAC8C;AACnD1pB,cAAI,qBAAuBy7F,YAAY,CAAZ,CAAD,GAAmB,CAA7C;AACD,SAHM,MAGA;AACL,YAAEz7F,CAAF;AACD;AACD;AACF,WAAK+uF,sBAAkBqI,UAAvB;AACE,YAAIoF,cAAcK,SAAlB,EAA6B;AAC3B,eAAKjD,KAAL,CAAW54F,OAAX;AACAw7F,wBAAc,CAAd;AACD;AACD,YAAIC,gBAAgBI,SAApB,EAA+B;AAC7B77F,kBAAQgyF,MAAR;AACAyJ,0BAAgB,CAAhB;AACD;AACD,YAAI,CAACD,WAAD,IAAgB,CAACC,aAArB,EAAoC;AAClCz7F,kBAAQ6xF,SAAR;AACAuJ,kBAAQC,QAAQ12C,GAAhB;AACD;AACD,UAAE3lD,CAAF;AACA;AACF,WAAK+uF,sBAAkBlnD,MAAvB;AACE9uB,YAAI,qBAAuB0iF,YAAY,CAAZ,CAA3B;AACA,YAAMv2D,KAAK6sD,iBAAiBh5E,CAAjB,CAAX;AACA,YAAMosB,KAAK4sD,iBAAiBh5E,IAAI,CAArB,CAAX;AACA,YAAMyB,KAAKu3E,iBAAiBh5E,IAAI,CAArB,CAAX;AACA,YAAMg6B,KAAKg/C,iBAAiBh5E,IAAI,CAArB,CAAX;AACA,YAAM+S,KAAKtR,KAAK0qB,EAAhB;AACA,YAAMnZ,KAAKgnB,KAAK5N,EAAhB;AACA,YAAMlmC,IAAI8E,KAAKsG,IAAL,CAAUyhB,KAAKA,EAAL,GAAUC,KAAKA,EAAzB,CAAV;AACA/qB,gBAAQyxF,MAAR,CAAevtD,KAAKjmC,CAApB,EAAuBkmC,EAAvB;AACAnkC,gBAAQ8xF,GAAR,CAAY5tD,EAAZ,EAAgBC,EAAhB,EAAoBlmC,CAApB,EAAuB,CAAvB,EAA0B,IAAI8E,KAAKiG,EAAnC,EAAuC,IAAvC;AACA,UAAEhK,CAAF;AACA;AACF,WAAK+uF,sBAAkBsI,UAAvB;AACEr2F,gBAAQ2xF,SAAR;AACA,UAAE3yF,CAAF;AACA;AACF,WAAK+uF,sBAAkBuI,MAAvB;AACEv+E,YAAI,qBAAuB0iF,YAAY,CAAZ,CAA3B;AACAU,aAAKV,YAAY,CAAZ,CAAL;AACA,YAAMzzE,WAAW,4CAA8CyzE,YAAY,CAAZ,CAA/D;AACA,YAAM/uE,WAAW+uE,YAAY,CAAZ,CAAjB;AACA,YAAM96F,KAAK86F,YAAYx7F,MAAZ,IAAsB,CAAtB,GAA0Bw7F,YAAY,CAAZ,CAA1B,GAA2C76F,SAAtD;AACA2oB,cAAMvB,QAAN,GAAiBA,QAAjB;AACAuB,cAAM9a,OAAN,GAAgBA,OAAhB;AACA,YAAI,EAAEzO,KAAK48F,eAAP,CAAJ,EAA6B;AAC3BA,0BAAgB58F,CAAhB,IAAqB,EAArB;AACD;AACD,YAAMgoC,SAAS40D,gBAAgB58F,CAAhB,CAAf;AACA,YAAIW,EAAJ,EAAQ;AACNA,aAAGoxF,gBAAH,EAAqBh5E,CAArB,EAAwBojF,EAAxB,EAA4B,CAA5B,EAA+Bn0D,MAA/B;AACD,SAFD,MAEO;AACLA,iBAAO,CAAP,IAAY+pD,iBAAiBh5E,CAAjB,CAAZ;AACAivB,iBAAO,CAAP,IAAY+pD,iBAAiBh5E,IAAI,CAArB,CAAZ;AACAivB,iBAAO/nC,MAAP,GAAgB,CAAhB;AACD;AACDysB,iBAASsb,MAAT,EAAiBze,KAAjB;AACA,UAAEvpB,CAAF;AACA;AACF,WAAK+uF,sBAAkBC,UAAvB;AACEj2E,YAAI,qBAAuB0iF,YAAY,CAAZ,CAA3B;AACAU,aAAK,qBAAuBV,YAAY,CAAZ,CAA5B;AACAvO,gBAAS;AACJuO,oBAAY,CAAZ,CADL;AAEA;AACAhmC,kBAAU,qBAAuBgmC,YAAY,CAAZ,CAAjC;AACA/lC,kBAAU,qBAAuB+lC,YAAY,CAAZ,CAAjC;AACApM,yBAAiB2M,kBAAkB,IAAlB,GAAyB,qDAAuDP,YAAY,CAAZ,CAAjG;AACA,YAAMhnE,SAAS,qBAAuBgnE,YAAY,CAAZ,CAAtC;AACA,YAAMvoB,UAAU,qBAAuBuoB,YAAY,CAAZ,CAAvC;AACA,YAAMtO,UAAU,qBAAuBsO,YAAY,CAAZ,CAAvC;AACA,YAAMrO,UAAU,qBAAuBqO,YAAY,EAAZ,CAAvC;AACA,YAAMqB,iBAAiB,sBAAwBrB,YAAY,EAAZ,CAA/C;AACA,YAAI79D,WAAW,qBAAuB69D,YAAY,EAAZ,CAAtC;AACA,YAAMnpD,QAAQ,qBAAuBmpD,YAAY,EAAZ,CAArC;AACA,YAAM1B,cAAc,sBAAwB0B,YAAY,EAAZ,CAA5C;AACA,YAAMjnE,QAAQ,qBAAuBinE,YAAY,EAAZ,CAArC;;AAEA,YAAI1zD,gBAAJ;AAAA,YAAag1D,uBAAb;AAAA,YAA6BC,yBAA7B;AACA,YAAIvB,YAAYx7F,MAAZ,GAAqB,EAAzB,EAA6B;AAC3B8nC,oBAAU,6BAA+B0zD,YAAY,EAAZ,CAAzC;AACAsB,2BAAiB,sBAAwBtB,YAAY,EAAZ,CAAzC;AACAuB,6BAAmB,sBAAwBvB,YAAY,EAAZ,CAA3C;AACD,SAJD,MAIO;AACL1zD,oBAAUsjD,sBAAV;AACA0R,2BAAiBC,mBAAmB,KAApC;AACD;;AAED,YAAIF,cAAJ,EAAoB;AAClBl/D,sBAAYmyD,YAAZ;AACD;AACD,eAAOh3E,IAAIojF,EAAX,EAAepjF,KAAK,CAApB,EAAuB;AACrB,eAAK+gF,YAAL,CAAkB94F,OAAlB,EACE+wF,iBAAiBh5E,CAAjB,CADF,EACuBg5E,iBAAiBh5E,IAAI,CAArB,CADvB,EACgDm0E,KADhD,EACuDz3B,OADvD,EACgEC,OADhE,EAEE25B,cAFF,EAEkB56D,MAFlB,EAE0By+C,OAF1B,EAEmCia,OAFnC,EAE4CC,OAF5C,EAEqDxvD,QAFrD,EAE+D0U,KAF/D,EAGEynD,WAHF,EAGevlE,KAHf,EAGsBuT,OAHtB,EAIEg1D,iBAAiB,wBAA0BL,mBAA3C,GAAkE,IAJpE,EAKEM,mBAAmB,wBAA0BL,qBAA7C,GAAsE,IALxE;AAMD;AACD,aAAKjB,gBAAL,CAAsBrM,cAAtB,EAAsC5gF,OAAtC;AACA,UAAEzO,CAAF;AACA;AACF,WAAK+uF,sBAAkBwI,UAAvB;AACE,YAAMhsE,QAAQ,qBAAuBkwE,YAAY,CAAZ,CAArC;AACA,YAAM9vE,MAAM,qBAAuB8vE,YAAY,CAAZ,CAAnC;AACA,YAAMwB,WAAW,qBAAuBxB,YAAY,CAAZ,CAAxC;AACApM,yBAAiB2M,kBAAkB,IAAlB,GAAyB,qDAAuDP,YAAY,CAAZ,CAAjG;AACA,YAAMlnE,WAAW,qBAAuBknE,YAAY,CAAZ,CAAxC;AACA,YAAMyB,UAAU,qBAAuBzB,YAAY,CAAZ,CAAvC;AACA,YAAMznC,WAAW,qBAAuBynC,YAAY,CAAZ,CAAxC;AACA,YAAM7mC,UAAU,sCAAwC6mC,YAAY,CAAZ,CAAxD;AACA,YAAMzO,UAAU,qBAAuByO,YAAY,CAAZ,CAAvC;AACA,YAAM0B,YAAY,qBAAuB1B,YAAY,EAAZ,CAAzC;AACA,YAAM2B,cAAe,qBAAuB3B,YAAY,EAAZ,CAA5C;AACA,YAAM9mC,OAAO,qBAAuB8mC,YAAY,EAAZ,CAApC;AACA,YAAM4B,UAAU,qBAAuB5B,YAAY,EAAZ,CAAvC;AACA,YAAM7E,YAAY,qBAAuB6E,YAAY,EAAZ,CAAzC;;AAEA,YAAM6B,aAAa,8BAAiBvL,gBAAjB,EAAmCxmE,KAAnC,EAA0CI,GAA1C,EAA+C,CAA/C,CAAnB;AACA,YAAM4xE,aAAa3oC,QAAQD,IAAR,CAAnB;AACA,YAAIpgC,YAAYgpE,cAAcD,UAA9B,EAA0C;AACxC,cAAMhJ,YAAY,+BAAiC,IAAD,CAAOkJ,UAAP,CAAkBH,OAAlB,EAA2B/I,SAA7E;AACA,cAAMz/B,SAAS,CAACyoC,aAAaC,UAAd,IAA4BE,mBAAWnJ,SAAX,CAA3C;AACA,cAAM5vE,QAAQ,8BACZqtE,gBADY,EACMxmE,KADN,EACaI,GADb,EACkB,CADlB,EACqBgpC,IADrB,EAC2BC,OAD3B,EACoCC,MADpC,EAC4Cb,QAD5C,CAAd;AAEA,cAAItvC,KAAJ,EAAW;AACT,gBAAIjf,UAAJ;AAAA,gBAAOi4F,WAAP;AAAA,gBAAWC,cAAX;AAAA,gBAAkB3xF,cAAlB;AAAA,gBAAyBwF,aAAzB;AACA,gBAAI2rF,SAAJ,EAAe;AACb,mBAAK13F,IAAI,CAAJ,EAAOi4F,KAAKh5E,MAAMzkB,MAAvB,EAA+BwF,IAAIi4F,EAAnC,EAAuC,EAAEj4F,CAAzC,EAA4C;AAC1C+L,uBAAOkT,MAAMjf,CAAN,CAAP,CAD0C,CACzB;AACjBk4F,wBAAQ,qBAAuBnsF,KAAK,CAAL,CAA/B;AACAxF,wBAAQ,+BAAiC,IAAD,CAAO2d,QAAP,CAAgBg0E,KAAhB,EAAuBN,OAAvB,EAAgC,EAAhC,EAAoCF,SAApC,CAAxC;AACA1nC,0BAAU,qBAAuBjkD,KAAK,CAAL,CAAD,GAAY4rF,WAA5C;AACA1nC,0BAAUunC,WAAWjxF,MAAMyoB,MAAjB,GAA0B,CAAC,MAAMwoE,QAAP,IAAmB,CAAnB,GAAuBG,WAAjD,GAA+DpQ,OAAzE;AACA,qBAAK8M,YAAL,CAAkB94F,OAAlB;AACE,qCAAuBwQ,KAAK,CAAL,CADzB,EACmC,qBAAuBA,KAAK,CAAL,CAD1D,EACoExF,KADpE,EAEEypD,OAFF,EAEWC,OAFX,EAEoB25B,cAFpB,EAEoCrjF,MAAMyoB,MAF1C,EAEkD,CAFlD,EAEqD,CAFrD,EAEwD,CAFxD;AAGE,qCAAuBjjB,KAAK,CAAL,CAHzB,EAGmColF,SAHnC,EAG8C,KAH9C,EAGqD5qF,MAAMwoB,KAH3D,EAIE62D,sBAJF,EAIkB,IAJlB,EAIwB,IAJxB;AAKD;AACF;AACD,gBAAI6R,OAAJ,EAAa;AACX,mBAAKz3F,IAAI,CAAJ,EAAOi4F,KAAKh5E,MAAMzkB,MAAvB,EAA+BwF,IAAIi4F,EAAnC,EAAuC,EAAEj4F,CAAzC,EAA4C;AAC1C+L,uBAAOkT,MAAMjf,CAAN,CAAP,CAD0C,CACzB;AACjBk4F,wBAAQ,qBAAuBnsF,KAAK,CAAL,CAA/B;AACAxF,wBAAQ,+BAAiC,IAAD,CAAO2d,QAAP,CAAgBg0E,KAAhB,EAAuBN,OAAvB,EAAgCH,OAAhC,EAAyC,EAAzC,CAAxC;AACAznC,0BAAU,qBAAuBjkD,KAAK,CAAL,CAAjC;AACAkkD,0BAAUunC,WAAWjxF,MAAMyoB,MAAjB,GAA0Bu4D,OAApC;AACA,qBAAK8M,YAAL,CAAkB94F,OAAlB;AACE,qCAAuBwQ,KAAK,CAAL,CADzB,EACmC,qBAAuBA,KAAK,CAAL,CAD1D,EACoExF,KADpE,EAEEypD,OAFF,EAEWC,OAFX,EAEoB25B,cAFpB,EAEoCrjF,MAAMyoB,MAF1C,EAEkD,CAFlD,EAEqD,CAFrD,EAEwD,CAFxD;AAGE,qCAAuBjjB,KAAK,CAAL,CAHzB,EAGmColF,SAHnC,EAG8C,KAH9C,EAGqD5qF,MAAMwoB,KAH3D,EAIE62D,sBAJF,EAIkB,IAJlB,EAIwB,IAJxB;AAKD;AACF;AACF;AACF;AACD,aAAKqQ,gBAAL,CAAsBrM,cAAtB,EAAsC5gF,OAAtC;AACA,UAAEzO,CAAF;AACA;AACF,WAAK+uF,sBAAkByI,YAAvB;AACE,YAAIwE,oBAAoBp7F,SAAxB,EAAmC;AACjC6N,oBAAU,yDAA2DgtF,YAAY,CAAZ,CAArE;AACA,cAAMl8F,SAASy8F,gBAAgBvtF,OAAhB,CAAf;AACA,cAAIlP,MAAJ,EAAY;AACV,mBAAOA,MAAP;AACD;AACF;AACD,UAAES,CAAF;AACA;AACF,WAAK+uF,sBAAkB0I,IAAvB;AACE,YAAIoF,SAAJ,EAAe;AACbL;AACD,SAFD,MAEO;AACL,eAAK5C,KAAL,CAAW54F,OAAX;AACD;AACD,UAAEhB,CAAF;AACA;AACF,WAAK+uF,sBAAkB2I,eAAvB;AACE3+E,YAAI,qBAAuB0iF,YAAY,CAAZ,CAA3B;AACAU,aAAK,qBAAuBV,YAAY,CAAZ,CAA5B;AACArxF,YAAI2nF,iBAAiBh5E,CAAjB,CAAJ;AACAZ,YAAI45E,iBAAiBh5E,IAAI,CAArB,CAAJ;AACAujF,iBAAUlyF,IAAI,GAAL,GAAY,CAArB;AACAmyF,iBAAUpkF,IAAI,GAAL,GAAY,CAArB;AACA,YAAImkF,WAAWF,KAAX,IAAoBG,WAAWF,KAAnC,EAA0C;AACxCr7F,kBAAQyxF,MAAR,CAAeroF,CAAf,EAAkB+N,CAAlB;AACAikF,kBAAQE,MAAR;AACAD,kBAAQE,MAAR;AACD;AACD,aAAKxjF,KAAK,CAAV,EAAaA,IAAIojF,EAAjB,EAAqBpjF,KAAK,CAA1B,EAA6B;AAC3B3O,cAAI2nF,iBAAiBh5E,CAAjB,CAAJ;AACAZ,cAAI45E,iBAAiBh5E,IAAI,CAArB,CAAJ;AACAujF,mBAAUlyF,IAAI,GAAL,GAAY,CAArB;AACAmyF,mBAAUpkF,IAAI,GAAL,GAAY,CAArB;AACA,cAAIY,KAAKojF,KAAK,CAAV,IAAeG,WAAWF,KAA1B,IAAmCG,WAAWF,KAAlD,EAAyD;AACvDr7F,oBAAQ0xF,MAAR,CAAetoF,CAAf,EAAkB+N,CAAlB;AACAikF,oBAAQE,MAAR;AACAD,oBAAQE,MAAR;AACD;AACF;AACD,UAAEv8F,CAAF;AACA;AACF,WAAK+uF,sBAAkB4I,cAAvB;AACE+E,8BAAsBjB,WAAtB;AACA,aAAKzC,UAAL,GAAkByC,YAAY,CAAZ,CAAlB;;AAEA,YAAIe,WAAJ,EAAiB;AACf,eAAK5C,KAAL,CAAW54F,OAAX;AACAw7F,wBAAc,CAAd;AACA,cAAIC,aAAJ,EAAmB;AACjBz7F,oBAAQgyF,MAAR;AACAyJ,4BAAgB,CAAhB;AACD;AACF;;AAEDz7F,gBAAQipF,SAAR,GAAoB,4CAA8CwR,YAAY,CAAZ,CAAlE;AACA,UAAEz7F,CAAF;AACA;AACF,WAAK+uF,sBAAkB6I,gBAAvB;AACE+E,gCAAwBlB,WAAxB;AACA,YAAIgB,aAAJ,EAAmB;AACjBz7F,kBAAQgyF,MAAR;AACAyJ,0BAAgB,CAAhB;AACD;AACD,aAAK5C,eAAL,CAAqB74F,OAArB,EAA8B,wBAA0By6F,WAAxD;AACA,UAAEz7F,CAAF;AACA;AACF,WAAK+uF,sBAAkB8I,MAAvB;AACE,YAAIgF,SAAJ,EAAe;AACbJ;AACD,SAFD,MAEO;AACLz7F,kBAAQgyF,MAAR;AACD;AACD,UAAEhzF,CAAF;AACA;AACF;AACE,UAAEA,CAAF,CADF,CACO;AACL;AAvPJ;AAyPD;AACD,MAAIw8F,WAAJ,EAAiB;AACf,SAAK5C,KAAL,CAAW54F,OAAX;AACD;AACD,MAAIy7F,aAAJ,EAAmB;AACjBz7F,YAAQgyF,MAAR;AACD;AACD,SAAOpyF,SAAP;AACD,CA7SD;;AAgTA;;;;;;;AAOA+sF,aAAazzE,SAAb,CAAuB0jF,MAAvB,GAAgC,UAC9B58F,OAD8B,EACrB6vC,SADqB,EACVk/C,YADU,EACIgM,mBADJ,EACyB;AACvD,OAAK7L,aAAL,GAAqBH,YAArB;AACA,OAAK+L,OAAL,CAAa96F,OAAb,EAAsB6vC,SAAtB,EACEkrD,mBADF,EACuB,KAAKjN,YAD5B,EAC0CluF,SAD1C,EACqDA,SADrD;AAED,CALD;;AAQA;;;;;;;;;;;;;AAaA+sF,aAAazzE,SAAb,CAAuB2jF,kBAAvB,GAA4C,UAC1C78F,OAD0C,EACjC6vC,SADiC,EACtBk/C,YADsB,EACRgM,mBADQ,EAE1C+B,mBAF0C,EAErB7B,aAFqB,EAEN;AACpC,OAAK/L,aAAL,GAAqBH,YAArB;AACA,SAAO,KAAK+L,OAAL,CAAa96F,OAAb,EAAsB6vC,SAAtB,EAAiCkrD,mBAAjC,EACL,KAAK9M,wBADA,EAC0B6O,mBAD1B,EAC+C7B,aAD/C,CAAP;AAED,CAND;;AASA;;;AAGAtO,aAAazzE,SAAb,CAAuBk1E,+BAAvB,GAAyD,YAAW;AAClE,MAAMH,2BAA2B,KAAKA,wBAAtC;AACA;AACAA,2BAAyBr4E,OAAzB;AACA;AACA,MAAI5W,UAAJ;AACA,MAAMsK,IAAI2kF,yBAAyBhvF,MAAnC;AACA,MAAIw7F,oBAAJ;AACA,MAAIn7F,aAAJ;AACA,MAAIirB,QAAQ,CAAC,CAAb;AACA,OAAKvrB,IAAI,CAAT,EAAYA,IAAIsK,CAAhB,EAAmB,EAAEtK,CAArB,EAAwB;AACtBy7F,kBAAcxM,yBAAyBjvF,CAAzB,CAAd;AACAM,WAAO,kDAAoDm7F,YAAY,CAAZ,CAA3D;AACA,QAAIn7F,QAAQyuF,sBAAkByI,YAA9B,EAA4C;AAC1CjsE,cAAQvrB,CAAR;AACD,KAFD,MAEO,IAAIM,QAAQyuF,sBAAkBoI,cAA9B,EAA8C;AACnDsE,kBAAY,CAAZ,IAAiBz7F,CAAjB;AACA,kCAAgB,KAAKivF,wBAArB,EAA+C1jE,KAA/C,EAAsDvrB,CAAtD;AACAurB,cAAQ,CAAC,CAAT;AACD;AACF;AACF,CArBD;;AAwBA;;;AAGAoiE,aAAazzE,SAAb,CAAuB8vE,kBAAvB,GAA4C,UAASC,SAAT,EAAoBC,WAApB,EAAiC;AAC3E,MAAM3gE,QAAQ,KAAKA,KAAnB;AACA,MAAI0gE,SAAJ,EAAe;AACb,QAAMuK,iBAAiBvK,UAAUwK,QAAV,EAAvB;AACAlrE,UAAM0gE,SAAN,GAAkB,4BAAYuK,iBAC5BA,cAD4B,GACX5J,wBADD,CAAlB;AAED,GAJD,MAIO;AACLrhE,UAAM0gE,SAAN,GAAkBrpF,SAAlB;AACD;AACD,MAAIspF,WAAJ,EAAiB;AACf,QAAMwK,mBAAmBxK,YAAYuK,QAAZ,EAAzB;AACAlrE,UAAM2gE,WAAN,GAAoB,4BAAYwK,mBAC9BA,gBAD8B,GACXxJ,0BADD,CAApB;AAEA,QAAMyJ,qBAAqBzK,YAAY0K,UAAZ,EAA3B;AACArrE,UAAMuqE,OAAN,GAAgBa,uBAAuB/zF,SAAvB,GACd+zF,kBADc,GACO9J,sBADvB;AAEA,QAAMgK,sBAAsB3K,YAAY4K,WAAZ,EAA5B;AACAvrE,UAAMwqE,QAAN,GAAiBc,sBACfA,oBAAoBh1F,KAApB,EADe,GACeirF,uBADhC;AAEA,QAAMiK,4BAA4B7K,YAAY8K,iBAAZ,EAAlC;AACAzrE,UAAMyqE,cAAN,GAAuBe,4BACrBA,yBADqB,GACOhK,6BAD9B;AAEA,QAAMkK,sBAAsB/K,YAAYgL,WAAZ,EAA5B;AACA3rE,UAAM0qE,QAAN,GAAiBgB,wBAAwBr0F,SAAxB,GACfq0F,mBADe,GACOjK,uBADxB;AAEA,QAAMmK,mBAAmBjL,YAAYxpD,QAAZ,EAAzB;AACAnX,UAAM2qE,SAAN,GAAkBiB,qBAAqBv0F,SAArB,GAChBu0F,gBADgB,GACG7J,wBADrB;AAEA,QAAM8J,wBAAwBlL,YAAYmL,aAAZ,EAA9B;AACA9rE,UAAM4qE,UAAN,GAAmBiB,0BAA0Bx0F,SAA1B,GACjBw0F,qBADiB,GACOnK,yBAD1B;;AAGA,QAAI1hE,MAAM2qE,SAAN,GAAkB,KAAK6E,YAA3B,EAAyC;AACvC,WAAKA,YAAL,GAAoBxvE,MAAM2qE,SAA1B;AACA;AACA,WAAKiF,kBAAL,GAA0B,IAA1B;AACD;AACF,GA5BD,MA4BO;AACL5vE,UAAM2gE,WAAN,GAAoBtpF,SAApB;AACA2oB,UAAMuqE,OAAN,GAAgBlzF,SAAhB;AACA2oB,UAAMwqE,QAAN,GAAiB,IAAjB;AACAxqE,UAAMyqE,cAAN,GAAuBpzF,SAAvB;AACA2oB,UAAM0qE,QAAN,GAAiBrzF,SAAjB;AACA2oB,UAAM2qE,SAAN,GAAkBtzF,SAAlB;AACA2oB,UAAM4qE,UAAN,GAAmBvzF,SAAnB;AACD;AACF,CA9CD;;AAiDA;;;;;AAKA+sF,aAAazzE,SAAb,CAAuB4+E,UAAvB,GAAoC,UAASvvE,KAAT,EAAgBvB,QAAhB,EAA0B;AAC5D,MAAMiiE,YAAY1gE,MAAM0gE,SAAxB;AACA,MAAM6N,kBAAkB,CAAC/I,sBAAkB4I,cAAnB,EAAmC1N,SAAnC,CAAxB;AACA,MAAI,OAAOA,SAAP,KAAqB,QAAzB,EAAmC;AACjC;AACA6N,oBAAgB91F,IAAhB,CAAqB,IAArB;AACD;AACD,SAAO81F,eAAP;AACD,CARD;;AAWA;;;AAGAnK,aAAazzE,SAAb,CAAuBo+E,WAAvB,GAAqC,UAAS/uE,KAAT,EAAgB;AACnD,OAAKulE,YAAL,CAAkB9sF,IAAlB,CAAuB,KAAK+7F,YAAL,CAAkBx0E,KAAlB,CAAvB;AACD,CAFD;;AAKA;;;;AAIAokE,aAAazzE,SAAb,CAAuB6jF,YAAvB,GAAsC,UAASx0E,KAAT,EAAgB;AACpD,SAAO,CACLwlE,sBAAkB6I,gBADb,EAELruE,MAAM2gE,WAFD,EAEc3gE,MAAM2qE,SAAN,GAAkB,KAAK5qE,UAFrC,EAEiDC,MAAMuqE,OAFvD,EAGLvqE,MAAM0qE,QAHD,EAGW1qE,MAAM4qE,UAHjB,EAIL,KAAKoG,eAAL,CAAqBhxE,MAAMwqE,QAA3B,CAJK,EAIiCxqE,MAAMyqE,cAAN,GAAuB,KAAK1qE,UAJ7D,CAAP;AAMD,CAPD;;AAUA;;;;;AAKAqkE,aAAazzE,SAAb,CAAuB2+E,eAAvB,GAAyC,UAAStvE,KAAT,EAAgBuvE,UAAhB,EAA4B9wE,QAA5B,EAAsC;AAC7E,MAAMiiE,YAAY1gE,MAAM0gE,SAAxB;AACA,MAAI,OAAOA,SAAP,KAAqB,QAArB,IAAiC1gE,MAAMy0E,gBAAN,IAA0B/T,SAA/D,EAA0E;AACxE,QAAIA,cAAcrpF,SAAlB,EAA6B;AAC3B,WAAKkuF,YAAL,CAAkB9sF,IAAlB,CAAuB82F,WAAWv9E,IAAX,CAAgB,IAAhB,EAAsBgO,KAAtB,EAA6BvB,QAA7B,CAAvB;AACD;AACDuB,UAAMy0E,gBAAN,GAAyB/T,SAAzB;AACD;AACF,CARD;;AAWA;;;;AAIA0D,aAAazzE,SAAb,CAAuBm+E,iBAAvB,GAA2C,UAAS9uE,KAAT,EAAgB+uE,WAAhB,EAA6B;AACtE,MAAMpO,cAAc3gE,MAAM2gE,WAA1B;AACA,MAAM4J,UAAUvqE,MAAMuqE,OAAtB;AACA,MAAMC,WAAWxqE,MAAMwqE,QAAvB;AACA,MAAMC,iBAAiBzqE,MAAMyqE,cAA7B;AACA,MAAMC,WAAW1qE,MAAM0qE,QAAvB;AACA,MAAMC,YAAY3qE,MAAM2qE,SAAxB;AACA,MAAMC,aAAa5qE,MAAM4qE,UAAzB;AACA,MAAI5qE,MAAM00E,kBAAN,IAA4B/T,WAA5B,IACA3gE,MAAM20E,cAAN,IAAwBpK,OADxB,IAECC,YAAYxqE,MAAM40E,eAAlB,IAAqC,CAAC,mBAAO50E,MAAM40E,eAAb,EAA8BpK,QAA9B,CAFvC,IAGAxqE,MAAM60E,qBAAN,IAA+BpK,cAH/B,IAIAzqE,MAAM80E,eAAN,IAAyBpK,QAJzB,IAKA1qE,MAAM+0E,gBAAN,IAA0BpK,SAL1B,IAMA3qE,MAAMg1E,iBAAN,IAA2BpK,UAN/B,EAM2C;AACzC,QAAIjK,gBAAgBtpF,SAApB,EAA+B;AAC7B03F,kBAAY/8E,IAAZ,CAAiB,IAAjB,EAAuBgO,KAAvB;AACD;AACDA,UAAM00E,kBAAN,GAA2B/T,WAA3B;AACA3gE,UAAM20E,cAAN,GAAuBpK,OAAvB;AACAvqE,UAAM40E,eAAN,GAAwBpK,QAAxB;AACAxqE,UAAM60E,qBAAN,GAA8BpK,cAA9B;AACAzqE,UAAM80E,eAAN,GAAwBpK,QAAxB;AACA1qE,UAAM+0E,gBAAN,GAAyBpK,SAAzB;AACA3qE,UAAMg1E,iBAAN,GAA0BpK,UAA1B;AACD;AACF,CA1BD;;AA6BA;;;;AAIAxG,aAAazzE,SAAb,CAAuBg1E,WAAvB,GAAqC,UAASlnE,QAAT,EAAmBvZ,OAAnB,EAA4B;AAC/D,OAAKwqF,0BAAL,CAAgC,CAAhC,IAAqC,KAAKnK,YAAL,CAAkB7uF,MAAvD;AACA,OAAKg5F,0BAAL,GAAkC,IAAlC;AACA,OAAKC,0BAAL,CAAgC,CAAhC,IAAqC,KAAKjK,wBAAL,CAA8BhvF,MAAnE;AACA,OAAKi5F,0BAAL,GAAkC,IAAlC;AACA,MAAMsF,yBAAyB,CAACzP,sBAAkByI,YAAnB,EAAiC/oF,OAAjC,CAA/B;AACA,OAAKqgF,YAAL,CAAkB9sF,IAAlB,CAAuBw8F,sBAAvB;AACA,OAAKvP,wBAAL,CAA8BjtF,IAA9B,CAAmCw8F,sBAAnC;AACD,CARD;;AAWA;;;AAGA7Q,aAAazzE,SAAb,CAAuBi1E,MAAvB,GAAgC9nE,oBAAhC;;AAGA;;;;;;;AAOAsmE,aAAazzE,SAAb,CAAuB0gF,oBAAvB,GAA8C,YAAW;AACvD,MAAI,CAAC,KAAKzB,kBAAV,EAA8B;AAC5B,SAAKA,kBAAL,GAA0B,mBAAM,KAAK3L,SAAX,CAA1B;AACA,QAAI,KAAKuL,YAAL,GAAoB,CAAxB,EAA2B;AACzB,UAAMvkE,QAAQ,KAAKnL,UAAL,IAAmB,KAAK0vE,YAAL,GAAoB,CAAvC,IAA4C,CAA1D;AACA,0BAAO,KAAKI,kBAAZ,EAAgC3kE,KAAhC,EAAuC,KAAK2kE,kBAA5C;AACD;AACF;AACD,SAAO,KAAKA,kBAAZ;AACD,CATD;kBAUexL,Y;;;;;;;;;;;;;;;;;QC15BC8Q,c,GAAAA,c;QA2CAC,e,GAAAA,e;;AA1MhB;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAGA;;;;;AAKA,IAAMC,qBAAqB;AACzB,YAAUnG,uBADe;AAEzB,aAAW7K,gBAFc;AAGzB,WAASJ,qBAHgB;AAIzB,gBAAc2K,0BAJW;AAKzB,aAAWM,uBALc;AAMzB,UAAQoG;AANiB,CAA3B;;AAUA;;;;;;;;;;;;;AAnCA;;;AAgDA,IAAMC,oBAAoB,SAApBA,iBAAoB,CACxB94C,SADwB,EACbynC,SADa,EACFnkE,UADE,EACUC,UADV,EACsBmkE,QADtB,EACgCC,aADhC,EAC+CoR,gBAD/C,EACiE;AACzFtW,wBAAYjtE,IAAZ,CAAiB,IAAjB;;AAEA;;;;AAIA,OAAKwjF,cAAL,GAAsBrR,aAAtB;;AAEA;;;;AAIA,OAAKE,eAAL,GAAuB,IAAvB;;AAEA;;;;AAIA,OAAKoR,UAAL,GAAkBj5C,SAAlB;;AAEA;;;;AAIA,OAAKk5C,UAAL,GAAkBzR,SAAlB;;AAEA;;;;AAIA,OAAK0R,SAAL,GAAiBzR,QAAjB;;AAEA;;;;AAIA,OAAKhkE,WAAL,GAAmBH,UAAnB;;AAEA;;;;AAIA,OAAK61E,WAAL,GAAmB91E,UAAnB;;AAEA;;;;AAIA,OAAKktD,aAAL,GAAqBuoB,gBAArB;;AAEA;;;;AAIA,OAAKM,gBAAL,GAAwB,EAAxB;;AAEA;;;;AAIA,OAAKC,oBAAL,GAA4B,gCAAsB,CAAtB,EAAyB,CAAzB,CAA5B;;AAEA;;;;AAIA,OAAKC,sBAAL,GAA8B,yBAA9B;AACD,CArED;;AAuEA,qBAAST,iBAAT,EAA4BrW,qBAA5B;;AAGA;;;;;AAKA,IAAM+W,mBAAmB;AACvB,KAAG,CAAC,CAAC,IAAD,CAAD;AADoB,CAAzB;;AAKA;;;;;;;AAOA,SAASC,0BAAT,CAAoCl7F,KAApC,EAA2C8F,CAA3C,EAA8C+N,CAA9C,EAAiD;AAC/C,MAAInY,UAAJ;AACA,MAAMgkD,SAASjgD,KAAKC,KAAL,CAAWM,MAAMrE,MAAN,GAAe,CAA1B,CAAf;AACA,MAAImK,KAAK45C,MAAT,EAAiB;AACf,SAAKhkD,IAAIgkD,MAAT,EAAiBhkD,IAAIoK,CAArB,EAAwBpK,GAAxB,EAA6B;AAC3BsE,YAAMtE,CAAN,EAASmY,CAAT,IAAc,IAAd;AACD;AACF,GAJD,MAIO,IAAI/N,IAAI45C,MAAR,EAAgB;AACrB,SAAKhkD,IAAIoK,IAAI,CAAb,EAAgBpK,IAAIgkD,MAApB,EAA4BhkD,GAA5B,EAAiC;AAC/BsE,YAAMtE,CAAN,EAASmY,CAAT,IAAc,IAAd;AACD;AACF;AACF;;AAGD;;;;;;;;AAQO,SAASsmF,cAAT,CAAwBz6C,MAAxB,EAAgC;AACrC,MAAIu7C,iBAAiBv7C,MAAjB,MAA6BpjD,SAAjC,EAA4C;AAC1C,WAAO2+F,iBAAiBv7C,MAAjB,CAAP;AACD;;AAED,MAAMy7C,YAAYz7C,SAAS,CAAT,GAAa,CAA/B;AACA,MAAM99B,MAAM,IAAI7kB,KAAJ,CAAUo+F,SAAV,CAAZ;AACA,OAAK,IAAIz/F,IAAI,CAAb,EAAgBA,IAAIy/F,SAApB,EAA+Bz/F,GAA/B,EAAoC;AAClCkmB,QAAIlmB,CAAJ,IAAS,IAAIqB,KAAJ,CAAUo+F,SAAV,CAAT;AACD;;AAED,MAAIr1F,IAAI45C,MAAR;AACA,MAAI7rC,IAAI,CAAR;AACA,MAAI/W,QAAQ,CAAZ;;AAEA,SAAOgJ,KAAK+N,CAAZ,EAAe;AACbqnF,+BAA2Bt5E,GAA3B,EAAgC89B,SAAS55C,CAAzC,EAA4C45C,SAAS7rC,CAArD;AACAqnF,+BAA2Bt5E,GAA3B,EAAgC89B,SAAS7rC,CAAzC,EAA4C6rC,SAAS55C,CAArD;AACAo1F,+BAA2Bt5E,GAA3B,EAAgC89B,SAAS7rC,CAAzC,EAA4C6rC,SAAS55C,CAArD;AACAo1F,+BAA2Bt5E,GAA3B,EAAgC89B,SAAS55C,CAAzC,EAA4C45C,SAAS7rC,CAArD;AACAqnF,+BAA2Bt5E,GAA3B,EAAgC89B,SAAS55C,CAAzC,EAA4C45C,SAAS7rC,CAArD;AACAqnF,+BAA2Bt5E,GAA3B,EAAgC89B,SAAS7rC,CAAzC,EAA4C6rC,SAAS55C,CAArD;AACAo1F,+BAA2Bt5E,GAA3B,EAAgC89B,SAAS7rC,CAAzC,EAA4C6rC,SAAS55C,CAArD;AACAo1F,+BAA2Bt5E,GAA3B,EAAgC89B,SAAS55C,CAAzC,EAA4C45C,SAAS7rC,CAArD;;AAEAA;AACA/W,aAAS,IAAI,IAAI+W,CAAjB;AACA,QAAI,KAAK/W,QAAQgJ,CAAb,IAAkB,CAAlB,GAAsB,CAA1B,EAA6B;AAC3BA,WAAK,CAAL;AACAhJ,eAAS,IAAI,IAAIgJ,CAAjB;AACD;AACF;;AAEDm1F,mBAAiBv7C,MAAjB,IAA2B99B,GAA3B;AACA,SAAOA,GAAP;AACD;;AAGD;;;;;AAKO,SAASw4E,eAAT,CAAyBgB,gBAAzB,EAA2C1+F,OAA3C,EAAoD48B,QAApD,EAA8D;AACnE,MAAM+hE,KAAK7/F,OAAO6N,IAAP,CAAY+xF,gBAAZ,EAA8BlhG,GAA9B,CAAkCuH,MAAlC,EAA0C6H,IAA1C,CAA+Cs8B,gCAA/C,CAAX;AACA,MAAMxM,qBAAqB,EAA3B;AACA,OAAK,IAAI7oB,IAAI,CAAR,EAAW+qF,KAAKD,GAAG1/F,MAAxB,EAAgC4U,IAAI+qF,EAApC,EAAwC,EAAE/qF,CAA1C,EAA6C;AAC3C,QAAMgrF,aAAaH,iBAAiBC,GAAG9qF,CAAH,EAAMhS,QAAN,EAAjB,CAAnB;AACA,SAAK,IAAI7C,IAAI,CAAR,EAAWwkB,KAAKq7E,WAAW5/F,MAAhC,EAAwCD,IAAIwkB,EAA5C,GAAiD;AAC/C,UAAMo5E,SAASiC,WAAW7/F,GAAX,CAAf;AACA,UAAM6wC,YAAYgvD,WAAW7/F,GAAX,CAAlB;AACA49F,aAAOA,MAAP,CAAc58F,OAAd,EAAuB6vC,SAAvB,EAAkCjT,QAAlC,EAA4CF,kBAA5C;AACD;AACF;AACF;;AAGD;;;;AAIAmhE,kBAAkB3kF,SAAlB,CAA4B4lF,YAA5B,GAA2C,UAASC,KAAT,EAAgB;AACzD,MAAI7hG,YAAY,IAAhB;AACA,MAAI,KAAK6gG,cAAT,EAAyB;AACvB,QAAIgB,KAAJ,EAAW;AACT7hG,kBAAY,KAAK0vF,eAAjB;AACA,2BAAuB1vF,UAAU,CAAV,CAAD;AACvB,KAHD,MAGO;AACLA,kBAAY,KAAK0vF,eAAL,GAAuB,0BAAnC;AACA1vF,gBAAU8D,IAAV,CAAe,CAAf;AACD;AACF;AACD,SAAO9D,SAAP;AACD,CAZD;;AAeA;;;;AAIA2gG,kBAAkB3kF,SAAlB,CAA4B8lF,IAA5B,GAAmC,UAASh/F,OAAT,EAAkB6vC,SAAlB,EAA6B;AAC9D,MAAMovD,iBAAiB,KAAKC,aAAL,CAAmBrvD,SAAnB,CAAvB;AACA7vC,UAAQ6xF,SAAR;AACA7xF,UAAQyxF,MAAR,CAAewN,eAAe,CAAf,CAAf,EAAkCA,eAAe,CAAf,CAAlC;AACAj/F,UAAQ0xF,MAAR,CAAeuN,eAAe,CAAf,CAAf,EAAkCA,eAAe,CAAf,CAAlC;AACAj/F,UAAQ0xF,MAAR,CAAeuN,eAAe,CAAf,CAAf,EAAkCA,eAAe,CAAf,CAAlC;AACAj/F,UAAQ0xF,MAAR,CAAeuN,eAAe,CAAf,CAAf,EAAkCA,eAAe,CAAf,CAAlC;AACAj/F,UAAQg/F,IAAR;AACD,CARD;;AAWA;;;;AAIAnB,kBAAkB3kF,SAAlB,CAA4BimF,UAA5B,GAAyC,UAASC,OAAT,EAAkB;AACzD,OAAK,IAAM/sB,MAAX,IAAqB,KAAK+rB,gBAA1B,EAA4C;AAC1C,QAAMiB,aAAa,KAAKjB,gBAAL,CAAsB/rB,MAAtB,CAAnB;AACA,SAAK,IAAIrzE,IAAI,CAAR,EAAWwkB,KAAK47E,QAAQngG,MAA7B,EAAqCD,IAAIwkB,EAAzC,EAA6C,EAAExkB,CAA/C,EAAkD;AAChD,UAAIogG,QAAQpgG,CAAR,KAAcqgG,UAAlB,EAA8B;AAC5B,eAAO,IAAP;AACD;AACF;AACF;AACD,SAAO,KAAP;AACD,CAVD;;AAaA;;;AAGAxB,kBAAkB3kF,SAAlB,CAA4Bi1E,MAA5B,GAAqC,YAAW;AAC9C,OAAK,IAAMmR,IAAX,IAAmB,KAAKlB,gBAAxB,EAA0C;AACxC,QAAMgB,UAAU,KAAKhB,gBAAL,CAAsBkB,IAAtB,CAAhB;AACA,SAAK,IAAMC,SAAX,IAAwBH,OAAxB,EAAiC;AAC/BA,cAAQG,SAAR,EAAmBpR,MAAnB;AACD;AACF;AACF,CAPD;;AAUA;;;;;;;;;;;AAWA0P,kBAAkB3kF,SAAlB,CAA4Bie,0BAA5B,GAAyD,UACvD1K,UADuD,EAC3CpE,UAD2C,EAC/BuU,QAD+B,EACrB5F,YADqB,EACP+jE,mBADO,EACchkE,QADd,EACwB2nE,gBADxB,EAC0C;;AAEjG1nE,iBAAej0B,KAAKoH,KAAL,CAAW6sB,YAAX,CAAf;AACA,MAAMwoE,cAAcxoE,eAAe,CAAf,GAAmB,CAAvC;AACA,MAAM6Y,YAAY,yBAAiB,KAAKyuD,sBAAtB,EAChBtnE,eAAe,GADC,EACIA,eAAe,GADnB,EAEhB,IAAI3O,UAFY,EAEA,CAAC,CAAD,GAAKA,UAFL,EAGhB,CAACuU,QAHe,EAIhB,CAACnQ,WAAW,CAAX,CAJe,EAIA,CAACA,WAAW,CAAX,CAJD,CAAlB;AAKA,MAAMzsB,UAAU,KAAKq+F,oBAArB;;AAEA,MAAIr+F,QAAQipB,MAAR,CAAeuK,KAAf,KAAyBgsE,WAAzB,IAAwCx/F,QAAQipB,MAAR,CAAewK,MAAf,KAA0B+rE,WAAtE,EAAmF;AACjFx/F,YAAQipB,MAAR,CAAeuK,KAAf,GAAuBgsE,WAAvB;AACAx/F,YAAQipB,MAAR,CAAewK,MAAf,GAAwB+rE,WAAxB;AACD,GAHD,MAGO;AACLx/F,YAAQy/F,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwBD,WAAxB,EAAqCA,WAArC;AACD;;AAED;;;AAGA,MAAIE,kBAAJ;AACA,MAAI,KAAKnqB,aAAL,KAAuB31E,SAA3B,EAAsC;AACpC8/F,gBAAY,0BAAZ;AACA,kCAAiBA,SAAjB,EAA4BjzE,UAA5B;AACA,wBAAOizE,SAAP,EAAkBr3E,cAAc,KAAKktD,aAAL,GAAqBv+C,YAAnC,CAAlB,EAAoE0oE,SAApE;AACD;;AAED,MAAMC,OAAOlC,eAAezmE,YAAf,CAAb;AACA,MAAI4oE,4BAAJ;AACA,MAAI,KAAK7B,cAAT,EAAyB;AACvB6B,0BAAsB,KAAK7B,cAAL,CAAoBtnB,GAApB,GAA0Bj5E,GAA1B,CAA8B,UAASqiG,KAAT,EAAgB;AAClE,aAAOA,MAAMt9F,KAAb;AACD,KAFqB,CAAtB;AAGD;;AAED,MAAImlF,mBAAJ;;AAEA;;;;AAIA,WAASsT,eAAT,CAAyBvtF,OAAzB,EAAkC;AAChC,QAAMqyF,YAAY9/F,QAAQ+/F,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2BP,WAA3B,EAAwCA,WAAxC,EAAqDt/E,IAAvE;AACA,SAAK,IAAIlhB,KAAI,CAAb,EAAgBA,KAAIwgG,WAApB,EAAiCxgG,IAAjC,EAAsC;AACpC,WAAK,IAAIkJ,KAAI,CAAb,EAAgBA,KAAIs3F,WAApB,EAAiCt3F,IAAjC,EAAsC;AACpC,YAAIy3F,KAAK3gG,EAAL,EAAQkJ,EAAR,CAAJ,EAAgB;AACd,cAAI43F,UAAU,CAAC53F,KAAIs3F,WAAJ,GAAkBxgG,EAAnB,IAAwB,CAAxB,GAA4B,CAAtC,IAA2C,CAA/C,EAAkD;AAChD,gBAAIT,gBAAJ;AACA,gBAAI,EAAEqhG,wBAAwBlY,cAAcsY,qBAAW90E,KAAzB,IAAkCw8D,cAAcsY,qBAAWniD,IAAnF,CAAF,KACA+hD,oBAAoBv1F,OAApB,CAA4BoD,OAA5B,MAAyC,CAAC,CAD9C,EACiD;AAC/ClP,wBAASw4B,SAAStpB,OAAT,CAAT;AACD;AACD,gBAAIlP,OAAJ,EAAY;AACV,qBAAOA,OAAP;AACD,aAFD,MAEO;AACLyB,sBAAQy/F,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwBD,WAAxB,EAAqCA,WAArC;AACA,qBAAO5/F,SAAP;AACD;AACF;AACF;AACF;AACF;AACF;;AAED;AACA,MAAM++F,KAAK7/F,OAAO6N,IAAP,CAAY,KAAKyxF,gBAAjB,EAAmC5gG,GAAnC,CAAuCuH,MAAvC,CAAX;AACA45F,KAAG/xF,IAAH,CAAQs8B,gCAAR;;AAEA,MAAIlqC,UAAJ;AAAA,MAAOkJ,UAAP;AAAA,MAAUk3F,gBAAV;AAAA,MAAmBxC,eAAnB;AAAA,MAA2Br+F,eAA3B;AACA,OAAKS,IAAI2/F,GAAG1/F,MAAH,GAAY,CAArB,EAAwBD,KAAK,CAA7B,EAAgC,EAAEA,CAAlC,EAAqC;AACnC,QAAMihG,YAAYtB,GAAG3/F,CAAH,EAAM6C,QAAN,EAAlB;AACAu9F,cAAU,KAAKhB,gBAAL,CAAsB6B,SAAtB,CAAV;AACA,SAAK/3F,IAAIg4F,cAAMjhG,MAAN,GAAe,CAAxB,EAA2BiJ,KAAK,CAAhC,EAAmC,EAAEA,CAArC,EAAwC;AACtCw/E,mBAAawY,cAAMh4F,CAAN,CAAb;AACA00F,eAASwC,QAAQ1X,UAAR,CAAT;AACA,UAAIkV,WAAWh9F,SAAf,EAA0B;AACxB,YAAI8+F,qBACChX,cAAcsY,qBAAW90E,KAAzB,IAAkCw8D,cAAcsY,qBAAWniD,IAD5D,CAAJ,EACuE;AACrE,cAAM3gD,YAAYwhG,iBAAiBuB,SAAjB,CAAlB;AACA,cAAI,CAAC/iG,SAAL,EAAgB;AACdwhG,6BAAiBuB,SAAjB,IAA8B,CAACrD,MAAD,EAAS/sD,UAAUhxC,KAAV,CAAgB,CAAhB,CAAT,CAA9B;AACD,WAFD,MAEO;AACL3B,sBAAU8D,IAAV,CAAe47F,MAAf,EAAuB/sD,UAAUhxC,KAAV,CAAgB,CAAhB,CAAvB;AACD;AACF,SARD,MAQO;AACLN,mBAASq+F,OAAOC,kBAAP,CAA0B78F,OAA1B,EAAmC6vC,SAAnC,EAA8CjT,QAA9C,EACPm+D,mBADO,EACcC,eADd,EAC+B0E,SAD/B,CAAT;AAEA,cAAInhG,MAAJ,EAAY;AACV,mBAAOA,MAAP;AACD;AACF;AACF;AACF;AACF;AACD,SAAOqB,SAAP;AACD,CAjGD;;AAoGA;;;;AAIAi+F,kBAAkB3kF,SAAlB,CAA4BgmF,aAA5B,GAA4C,UAASrvD,SAAT,EAAoB;AAC9D,MAAM28C,YAAY,KAAKyR,UAAvB;AACA,MAAMl/D,OAAOytD,UAAU,CAAV,CAAb;AACA,MAAMvtD,OAAOutD,UAAU,CAAV,CAAb;AACA,MAAMxtD,OAAOwtD,UAAU,CAAV,CAAb;AACA,MAAMttD,OAAOstD,UAAU,CAAV,CAAb;AACA,MAAMyS,iBAAiB,CAAClgE,IAAD,EAAOE,IAAP,EAAaF,IAAb,EAAmBG,IAAnB,EAAyBF,IAAzB,EAA+BE,IAA/B,EAAqCF,IAArC,EAA2CC,IAA3C,CAAvB;AACA,8BACEggE,cADF,EACkB,CADlB,EACqB,CADrB,EACwB,CADxB,EAC2BpvD,SAD3B,EACsCovD,cADtC;AAEA,SAAOA,cAAP;AACD,CAVD;;AAaA;;;AAGApB,kBAAkB3kF,SAAlB,CAA4BuuE,SAA5B,GAAwC,UAASpV,MAAT,EAAiBqV,UAAjB,EAA6B;AACnE,MAAMuY,YAAY5tB,WAAWzyE,SAAX,GAAuByyE,OAAOxwE,QAAP,EAAvB,GAA2C,GAA7D;AACA,MAAIu9F,UAAU,KAAKhB,gBAAL,CAAsB6B,SAAtB,CAAd;AACA,MAAIb,YAAYx/F,SAAhB,EAA2B;AACzBw/F,cAAU,EAAV;AACA,SAAKhB,gBAAL,CAAsB6B,SAAtB,IAAmCb,OAAnC;AACD;AACD,MAAIxC,SAASwC,QAAQ1X,UAAR,CAAb;AACA,MAAIkV,WAAWh9F,SAAf,EAA0B;AACxB,QAAMu+D,cAAcw/B,mBAAmBjW,UAAnB,CAApB;AACAkV,aAAS,IAAIz+B,WAAJ,CAAgB,KAAK6/B,UAArB,EAAiC,KAAKC,UAAtC,EACP,KAAKE,WADE,EACW,KAAK11E,WADhB,EAC6B,KAAKy1E,SADlC,EAC6C,KAAKH,cADlD,CAAT;AAEAqB,YAAQ1X,UAAR,IAAsBkV,MAAtB;AACD;AACD,SAAOA,MAAP;AACD,CAfD;;AAkBA;;;AAGAiB,kBAAkB3kF,SAAlB,CAA4BinF,UAA5B,GAAyC,YAAW;AAClD,SAAO,KAAK/B,gBAAZ;AACD,CAFD;;AAKA;;;AAGAP,kBAAkB3kF,SAAlB,CAA4BihB,OAA5B,GAAsC,YAAW;AAC/C,SAAO,kBAAQ,KAAKikE,gBAAb,CAAP;AACD,CAFD;;AAKA;;;;;;;;;AASAP,kBAAkB3kF,SAAlB,CAA4B0jF,MAA5B,GAAqC,UAAS58F,OAAT,EACnC6vC,SADmC,EACxBk/C,YADwB,EACVgM,mBADU,EACWqF,eADX,EAC4BC,oBAD5B,EACkD;;AAErF;AACA,MAAM1B,KAAK7/F,OAAO6N,IAAP,CAAY,KAAKyxF,gBAAjB,EAAmC5gG,GAAnC,CAAuCuH,MAAvC,CAAX;AACA45F,KAAG/xF,IAAH,CAAQs8B,gCAAR;;AAEA;AACA;AACAlpC,UAAQsgG,IAAR;AACA,OAAKtB,IAAL,CAAUh/F,OAAV,EAAmB6vC,SAAnB;;AAEA,MAAM0wD,cAAcH,kBAAkBA,eAAlB,GAAoCF,aAAxD;AACA,MAAIlhG,UAAJ;AAAA,MAAOwkB,WAAP;AAAA,MAAWtb,UAAX;AAAA,MAAc27B,WAAd;AAAA,MAAkBu7D,gBAAlB;AAAA,MAA2BxC,eAA3B;AACA,OAAK59F,IAAI,CAAJ,EAAOwkB,KAAKm7E,GAAG1/F,MAApB,EAA4BD,IAAIwkB,EAAhC,EAAoC,EAAExkB,CAAtC,EAAyC;AACvC,QAAMihG,YAAYtB,GAAG3/F,CAAH,EAAM6C,QAAN,EAAlB;AACAu9F,cAAU,KAAKhB,gBAAL,CAAsB6B,SAAtB,CAAV;AACA,SAAK/3F,IAAI,CAAJ,EAAO27B,KAAK08D,YAAYthG,MAA7B,EAAqCiJ,IAAI27B,EAAzC,EAA6C,EAAE37B,CAA/C,EAAkD;AAChD,UAAMw/E,aAAa6Y,YAAYr4F,CAAZ,CAAnB;AACA00F,eAASwC,QAAQ1X,UAAR,CAAT;AACA,UAAIkV,WAAWh9F,SAAf,EAA0B;AACxB,YAAIygG,yBACC3Y,cAAcsY,qBAAW90E,KAAzB,IAAkCw8D,cAAcsY,qBAAWniD,IAD5D,CAAJ,EACuE;AACrE,cAAM3gD,YAAYmjG,qBAAqBJ,SAArB,CAAlB;AACA,cAAI,CAAC/iG,SAAL,EAAgB;AACdmjG,iCAAqBJ,SAArB,IAAkC,CAACrD,MAAD,EAAS/sD,UAAUhxC,KAAV,CAAgB,CAAhB,CAAT,CAAlC;AACD,WAFD,MAEO;AACL3B,sBAAU8D,IAAV,CAAe47F,MAAf,EAAuB/sD,UAAUhxC,KAAV,CAAgB,CAAhB,CAAvB;AACD;AACF,SARD,MAQO;AACL+9F,iBAAOA,MAAP,CAAc58F,OAAd,EAAuB6vC,SAAvB,EAAkCk/C,YAAlC,EAAgDgM,mBAAhD;AACD;AACF;AACF;AACF;;AAED/6F,UAAQwgG,OAAR;AACD,CArCD;;kBAuCe3C,iB;;;;;;;;;;;;;;;;;QC/VC4C,iB,GAAAA,iB;;AA9IhB;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;AAEA;;;;;;;;;;;AAhBA;;;AA2BA,IAAM7C,mBAAmB,SAAnBA,gBAAmB,CACvB74C,SADuB,EACZynC,SADY,EACDnkE,UADC,EACWC,UADX,EACuBmkE,QADvB,EACiCC,aADjC,EACgD;AACvEC,mBAAapyE,IAAb,CAAkB,IAAlB,EACEwqC,SADF,EACaynC,SADb,EACwBnkE,UADxB,EACoCC,UADpC,EACgDmkE,QADhD,EAC0DC,aAD1D;;AAGA;;;;AAIA,OAAKE,eAAL;;AAEA;;;;AAIA,OAAK8T,OAAL,GAAe,IAAf;;AAEA;;;;AAIA,OAAKvQ,KAAL,GAAa,EAAb;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoB,CAApB;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoB,CAApB;;AAEA;;;;AAIA,OAAKC,mBAAL,GAA2B1wF,SAA3B;;AAEA;;;;AAIA,OAAK2wF,aAAL,GAAqB,CAArB;;AAEA;;;;AAIA,OAAKE,cAAL,GAAsB,IAAtB;;AAEA;;;AAGA,OAAKkQ,UAAL,GAAkB,EAAlB;;AAEA;;;;AAIA,OAAKjQ,gBAAL,GAAwB,IAAxB;;AAEA;;;AAGA,OAAKkQ,YAAL,GAAoB,EAApB;;AAEA;;;;AAIA,OAAKjQ,UAAL,GAAkB,gDAAkD,EAApE;;AAEA;;;AAGA,OAAK6L,UAAL,GAAkB,EAAlB;;AAEA;;;;AAIA,OAAKqE,QAAL,GAAgB,EAAhB;;AAEA;;;;AAIA,OAAKC,QAAL,GAAgB,EAAhB;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkB,EAAlB;;AAEA;;;;AAIA,OAAKC,OAAL,GAAe,EAAf;;AAEAzW,qBAAW0W,KAAX;AAED,CA1GD;;AA4GA,qBAASrD,gBAAT,EAA2BjR,gBAA3B;;AAGA;;;;;;;AAOO,SAAS8T,iBAAT,CAA2Bh9E,IAA3B,EAAiC4kD,KAAjC,EAAwC64B,MAAxC,EAAgD;AACrD,MAAMC,WAAW94B,MAAMppE,MAAvB;AACA,MAAIu0B,QAAQ,CAAZ;AACA,OAAK,IAAIx0B,IAAI,CAAb,EAAgBA,IAAImiG,QAApB,EAA8B,EAAEniG,CAAhC,EAAmC;AACjC,QAAMoiG,eAAe,8BAAiB39E,IAAjB,EAAuB4kD,MAAMrpE,CAAN,CAAvB,CAArB;AACAw0B,YAAQzwB,KAAKkH,GAAL,CAASupB,KAAT,EAAgB4tE,YAAhB,CAAR;AACAF,WAAOlgG,IAAP,CAAYogG,YAAZ;AACD;AACD,SAAO5tE,KAAP;AACD;;AAGD;;;AAGAoqE,iBAAiB1kF,SAAjB,CAA2B6vE,QAA3B,GAAsC,UAAS/hE,QAAT,EAAmBvZ,OAAnB,EAA4B;AAChE,MAAMilF,YAAY,KAAKjC,cAAvB;AACA,MAAMmC,cAAc,KAAKlC,gBAAzB;AACA,MAAM0C,YAAY,KAAKzC,UAAvB;AACA,MAAI,KAAKR,KAAL,KAAe,EAAf,IAAqB,CAACiD,SAAtB,IAAoC,CAACV,SAAD,IAAc,CAACE,WAAvD,EAAqE;AACnE;AACD;;AAED,MAAIroE,QAAQ,KAAKqwB,WAAL,CAAiB37C,MAA7B;;AAEA,MAAM0J,eAAeqe,SAAS5O,OAAT,EAArB;AACA,MAAIqjC,kBAAkB,IAAtB;AACA,MAAI9wB,MAAM,CAAV;AACA,MAAI6c,SAAS,CAAb;AACA,MAAIxoC,UAAJ;AAAA,MAAOwkB,WAAP;;AAEA,MAAI4vE,UAAUiO,SAAV,KAAwBC,wBAAcC,IAA1C,EAAgD;AAC9C,QAAI,CAAC,wBAAW,KAAK3H,oBAAL,EAAX,EAAwC5yE,SAAS0B,SAAT,EAAxC,CAAL,EAAoE;AAClE;AACD;AACD,QAAIogC,aAAJ;AACArN,sBAAkBz0B,SAASigB,kBAAT,EAAlB;AACAO,aAASxgB,SAASygB,SAAT,EAAT;AACA,QAAI9+B,gBAAgBi+B,uBAAakgB,WAAjC,EAA8C;AAC5CgC,aAAO,CAACrN,gBAAgBx8C,MAAjB,CAAP;AACD,KAFD,MAEO,IAAI0J,gBAAgBi+B,uBAAasgB,iBAAjC,EAAoD;AACzD4B,aAAO9hC,SAAS2hC,OAAT,EAAP;AACD,KAFM,MAEA,IAAIhgD,gBAAgBi+B,uBAAaogB,OAAjC,EAA0C;AAC/C8B,aAAO9hC,SAAS2hC,OAAT,GAAmB9pD,KAAnB,CAAyB,CAAzB,EAA4B,CAA5B,CAAP;AACD,KAFM,MAEA,IAAI8J,gBAAgBi+B,uBAAaugB,aAAjC,EAAgD;AACrD,UAAM8D,QAAQjkC,SAASujC,QAAT,EAAd;AACAzB,aAAO,EAAP;AACA,WAAK9pD,IAAI,CAAJ,EAAOwkB,KAAKynC,MAAMhsD,MAAvB,EAA+BD,IAAIwkB,EAAnC,EAAuC,EAAExkB,CAAzC,EAA4C;AAC1C8pD,aAAK9nD,IAAL,CAAUiqD,MAAMjsD,CAAN,EAAS,CAAT,CAAV;AACD;AACF;AACD,SAAK2uF,aAAL,CAAmB3mE,QAAnB,EAA6BvZ,OAA7B;AACA,QAAM6lF,YAAYF,UAAUE,SAA5B;AACA,QAAIkO,aAAa,CAAjB;AACA,QAAIC,gBAAJ;AACA,SAAK,IAAIrxC,IAAI,CAAR,EAAWsxC,KAAK54C,KAAK7pD,MAA1B,EAAkCmxD,IAAIsxC,EAAtC,EAA0C,EAAEtxC,CAA5C,EAA+C;AAC7C,UAAIkjC,aAAa1zF,SAAjB,EAA4B;AAC1B,YAAM+hG,QAAQ,kCAAcvO,UAAUpgC,QAAxB,EAAkCvX,eAAlC,EAAmD+lD,UAAnD,EAA+D14C,KAAKsH,CAAL,CAA/D,EAAwE5oB,MAAxE,CAAd;AACAg6D,qBAAaG,MAAM,CAAN,CAAb;AACAF,kBAAUE,MAAM,CAAN,CAAV;AACD,OAJD,MAIO;AACLF,kBAAU34C,KAAKsH,CAAL,CAAV;AACD;AACD,WAAKpxD,IAAIwiG,UAAT,EAAqBxiG,IAAIyiG,OAAzB,EAAkCziG,KAAKwoC,MAAvC,EAA+C;AAC7C,aAAKoT,WAAL,CAAiB55C,IAAjB,CAAsBy6C,gBAAgBz8C,CAAhB,CAAtB,EAA0Cy8C,gBAAgBz8C,IAAI,CAApB,CAA1C;AACD;AACD2rB,YAAM,KAAKiwB,WAAL,CAAiB37C,MAAvB;AACAuiG,mBAAa14C,KAAKsH,CAAL,CAAb;AACA,WAAKwxC,UAAL,CAAgBr3E,KAAhB,EAAuBI,GAAvB,EAA4B,KAAKiiE,eAAjC;AACAriE,cAAQI,GAAR;AACD;AACD,SAAKujE,WAAL,CAAiBlnE,QAAjB,EAA2BvZ,OAA3B;AAED,GA1CD,MA0CO;AACL,QAAMzC,QAAQ,KAAK2d,QAAL,CAAc,KAAKwnE,KAAnB,EAA0B,KAAK0Q,QAA/B,EAAyC,KAAKC,QAA9C,EAAwD,KAAKC,UAA7D,CAAd;AACA,QAAMvtE,QAAQxoB,MAAMwoB,KAAN,GAAc,KAAKlL,UAAjC;AACA,YAAQ3f,YAAR;AACE,WAAKi+B,uBAAaigB,KAAlB;AACA,WAAKjgB,uBAAaqgB,WAAlB;AACExL,0BAAkBz0B,SAASigB,kBAAT,EAAlB;AACAtc,cAAM8wB,gBAAgBx8C,MAAtB;AACA;AACF,WAAK2nC,uBAAakgB,WAAlB;AACErL,0BAAkB,wCAA0Cz0B,QAAD,CAAWghC,eAAX,EAA3D;AACA;AACF,WAAKphB,uBAAaC,MAAlB;AACE4U,0BAAkB,oCAAsCz0B,QAAD,CAAWib,SAAX,EAAvD;AACA;AACF,WAAK2E,uBAAasgB,iBAAlB;AACEzL,0BAAkB,6CAA+Cz0B,QAAD,CAAWgiC,gBAAX,EAAhE;AACAr+B,cAAM8wB,gBAAgBx8C,MAAtB;AACA;AACF,WAAK2nC,uBAAaogB,OAAlB;AACEvL,0BAAkB,qCAAuCz0B,QAAD,CAAW4kC,oBAAX,EAAxD;AACA,YAAI,CAACwnC,UAAU7/D,QAAX,IAAuBkoB,gBAAgB,CAAhB,IAAqB,KAAKpzB,UAA1B,GAAuCmL,KAAlE,EAAyE;AACvE;AACD;AACDgU,iBAAS,CAAT;AACA;AACF,WAAKZ,uBAAaugB,aAAlB;AACE,YAAMwD,iBAAiB,0CAA4C3jC,QAAD,CAAWwjC,qBAAX,EAAlE;AACA/O,0BAAkB,EAAlB;AACA,aAAKz8C,IAAI,CAAJ,EAAOwkB,KAAKmnC,eAAe1rD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgDxkB,KAAK,CAArD,EAAwD;AACtD,cAAIo0F,UAAU7/D,QAAV,IAAsBo3B,eAAe3rD,IAAI,CAAnB,IAAwB,KAAKqpB,UAA7B,IAA2CmL,KAArE,EAA4E;AAC1EioB,4BAAgBz6C,IAAhB,CAAqB2pD,eAAe3rD,CAAf,CAArB,EAAwC2rD,eAAe3rD,IAAI,CAAnB,CAAxC;AACD;AACF;AACD2rB,cAAM8wB,gBAAgBx8C,MAAtB;AACA,YAAI0rB,OAAO,CAAX,EAAc;AACZ;AACD;AACD;AACF;AApCF;AAsCAA,UAAM,KAAK+iE,qBAAL,CAA2BjyC,eAA3B,EAA4C,CAA5C,EAA+C9wB,GAA/C,EAAoD6c,MAApD,EAA4D,KAA5D,EAAmE,KAAnE,CAAN;AACA,QAAI4rD,UAAU2I,cAAV,IAA4B3I,UAAU4I,gBAA1C,EAA4D;AAC1D,WAAKhT,kBAAL,CAAwBoK,UAAU2I,cAAlC,EAAkD3I,UAAU4I,gBAA5D;AACA,UAAI5I,UAAU2I,cAAd,EAA8B;AAC5B,aAAKlE,eAAL,CAAqB,KAAKtvE,KAA1B,EAAiC,KAAKuvE,UAAtC,EAAkD9wE,QAAlD;AACA,aAAKinE,wBAAL,CAA8BjtF,IAA9B,CAAmC,KAAK82F,UAAL,CAAgB,KAAKvvE,KAArB,EAA4BvB,QAA5B,CAAnC;AACD;AACD,UAAIosE,UAAU4I,gBAAd,EAAgC;AAC9B,aAAK3E,iBAAL,CAAuB,KAAK9uE,KAA5B,EAAmC,KAAK+uE,WAAxC;AACA,aAAKrJ,wBAAL,CAA8BjtF,IAA9B,CAAmC,KAAK+7F,YAAL,CAAkB,KAAKx0E,KAAvB,CAAnC;AACD;AACF;AACD,SAAKolE,aAAL,CAAmB3mE,QAAnB,EAA6BvZ,OAA7B;AACA,SAAKo0F,cAAL,CAAoB72F,KAApB,EAA2Buf,KAA3B,EAAkCI,GAAlC;AACA,SAAKujE,WAAL,CAAiBlnE,QAAjB,EAA2BvZ,OAA3B;AACD;AACF,CAnHD;;AAsHA;;;;;;;AAOAmwF,iBAAiB1kF,SAAjB,CAA2ByP,QAA3B,GAAsC,UAASgrC,IAAT,EAAe0oC,OAAf,EAAwBH,OAAxB,EAAiCC,SAAjC,EAA4C;AAChF,MAAInxF,cAAJ;AACA,MAAM3D,MAAM80F,YAAYE,OAAZ,GAAsB1oC,IAAtB,GAA6BuoC,OAA7B,GAAuC,KAAK5zE,UAAxD;;AAEA,MAAI,CAACiiE,mBAAWuX,WAAX,CAAuBz6F,GAAvB,CAAL,EAAkC;AAChC,QAAMurF,cAAcuJ,YAAY,KAAKyE,YAAL,CAAkBzE,SAAlB,KAAgC,KAAKzL,gBAAjD,GAAoE,IAAxF;AACA,QAAMgC,YAAYwJ,UAAU,KAAKyE,UAAL,CAAgBzE,OAAhB,KAA4B,KAAKzL,cAA3C,GAA4D,IAA9E;AACA,QAAM2C,YAAY,KAAKoJ,UAAL,CAAgBH,OAAhB,KAA4B,KAAK1L,UAAnD;AACA,QAAMroE,aAAa,KAAKA,UAAxB;AACA,QAAMgpB,QAAQ8hD,UAAU9hD,KAAV,GAAkBhpB,UAAhC;AACA,QAAMy5E,QAAStF,mBAAWrJ,UAAUE,SAAV,IAAuBnJ,wBAAlC,CAAf;AACA,QAAMiS,cAAcD,aAAavJ,YAAYM,SAAzB,GAAqCN,YAAYM,SAAjD,GAA6D,CAAjF;;AAEA,QAAM7qB,QAAQ1U,KAAKvyC,KAAL,CAAW,IAAX,CAAd;AACA,QAAM+/E,WAAW94B,MAAMppE,MAAvB;AACA,QAAMiiG,SAAS,EAAf;AACA,QAAM1tE,QAAQitE,kBAAkBrN,UAAU3vE,IAA5B,EAAkC4kD,KAAlC,EAAyC64B,MAAzC,CAAd;AACA,QAAMc,aAAa,+BAAkB5O,UAAU3vE,IAA5B,CAAnB;AACA,QAAMgQ,SAASuuE,aAAab,QAA5B;AACA,QAAMc,cAAezuE,QAAQ4oE,WAA7B;AACA,QAAMp8F,UAAU,gCACd+C,KAAKqH,IAAL,CAAU63F,cAAc3wD,KAAxB,CADc,EAEdvuC,KAAKqH,IAAL,CAAU,CAACqpB,SAAS2oE,WAAV,IAAyB9qD,KAAnC,CAFc,CAAhB;AAGAtmC,YAAQhL,QAAQipB,MAAhB;AACAshE,uBAAWxkE,GAAX,CAAe1e,GAAf,EAAoB2D,KAApB;AACA,QAAIsmC,SAAS,CAAb,EAAgB;AACdtxC,cAAQsxC,KAAR,CAAcA,KAAd,EAAqBA,KAArB;AACD;AACDtxC,YAAQyjB,IAAR,GAAe2vE,UAAU3vE,IAAzB;AACA,QAAI04E,SAAJ,EAAe;AACbn8F,cAAQkpF,WAAR,GAAsB0J,YAAY1J,WAAlC;AACAlpF,cAAQkzF,SAAR,GAAoBkJ,WAApB;AACAp8F,cAAQ8yF,OAAR,GAAkBF,YAAYE,OAA9B;AACA9yF,cAAQizF,QAAR,GAAmBL,YAAYK,QAA/B;AACAjzF,cAAQmzF,UAAR,GAAqBP,YAAYO,UAAjC;AACA,UAAIj+B,yBAAoB09B,YAAYG,QAAZ,CAAqB9zF,MAA7C,EAAqD;AACnDe,gBAAQm1D,WAAR,CAAoBy9B,YAAYG,QAAhC;AACA/yF,gBAAQgzF,cAAR,GAAyBJ,YAAYI,cAArC;AACD;AACF;AACD,QAAIkJ,OAAJ,EAAa;AACXl8F,cAAQipF,SAAR,GAAoByJ,UAAUzJ,SAA9B;AACD;AACDjpF,YAAQuzF,YAAR,GAAuB,QAAvB;AACAvzF,YAAQszF,SAAR,GAAoB,QAApB;AACA,QAAM4O,YAAa,MAAMH,KAAzB;AACA,QAAM34F,IAAI24F,QAAQ/2F,MAAMwoB,KAAd,GAAsB8d,KAAtB,GAA8B4wD,YAAY9F,WAApD;AACA,QAAIp9F,UAAJ;AACA,QAAIm9F,SAAJ,EAAe;AACb,WAAKn9F,IAAI,CAAT,EAAYA,IAAImiG,QAAhB,EAA0B,EAAEniG,CAA5B,EAA+B;AAC7BgB,gBAAQqxF,UAAR,CAAmBhpB,MAAMrpE,CAAN,CAAnB,EAA6BoK,IAAI84F,YAAYhB,OAAOliG,CAAP,CAA7C,EAAwD,OAAOo9F,cAAc4F,UAArB,IAAmChjG,IAAIgjG,UAA/F;AACD;AACF;AACD,QAAI9F,OAAJ,EAAa;AACX,WAAKl9F,IAAI,CAAT,EAAYA,IAAImiG,QAAhB,EAA0B,EAAEniG,CAA5B,EAA+B;AAC7BgB,gBAAQsxF,QAAR,CAAiBjpB,MAAMrpE,CAAN,CAAjB,EAA2BoK,IAAI84F,YAAYhB,OAAOliG,CAAP,CAA3C,EAAsD,OAAOo9F,cAAc4F,UAArB,IAAmChjG,IAAIgjG,UAA7F;AACD;AACF;AACF;AACD,SAAOzX,mBAAWhjF,GAAX,CAAeF,GAAf,CAAP;AACD,CA5DD;;AA+DA;;;;;;AAMAu2F,iBAAiB1kF,SAAjB,CAA2B2oF,cAA3B,GAA4C,UAAS72F,KAAT,EAAgBuf,KAAhB,EAAuBI,GAAvB,EAA4B;AACtE,MAAMyoE,YAAY,KAAKzC,UAAvB;AACA,MAAMiC,cAAc,KAAKlC,gBAAzB;AACA,MAAMpoE,aAAa,KAAKA,UAAxB;AACA,MAAMy5E,QAAQtF,mBAAWrJ,UAAUE,SAAV,IAAuBnJ,wBAAlC,CAAd;AACA,MAAM8R,WAAWQ,mBAAWrJ,UAAUG,YAArB,CAAjB;AACA,MAAM6I,cAAcxJ,eAAeA,YAAYM,SAA3B,GAAuCN,YAAYM,SAAnD,GAA+D,CAAnF;;AAEA,MAAMz+B,UAAUstC,QAAQ/2F,MAAMwoB,KAAd,GAAsBlL,UAAtB,GAAmC,KAAK,MAAMy5E,KAAX,IAAoB3F,WAAvE;AACA,MAAM1nC,UAAUunC,WAAWjxF,MAAMyoB,MAAjB,GAA0BnL,UAA1B,GAAuC,KAAK,MAAM2zE,QAAX,IAAuBG,WAA9E;AACA,OAAKtO,YAAL,CAAkB9sF,IAAlB,CAAuB,CAAC+sF,sBAAkBC,UAAnB,EAA+BzjE,KAA/B,EAAsCI,GAAtC,EACrB3f,KADqB,EACd,CAACypD,UAAU,KAAK27B,YAAhB,IAAgC9nE,UADlB,EAC8B,CAACosC,UAAU,KAAK27B,YAAhB,IAAgC/nE,UAD9D,EAErB,KAAKskE,eAFgB,EAEC5hF,MAAMyoB,MAFP,EAEe,CAFf,EAEkB,CAFlB,EAEqB,CAFrB,EAEwB,KAAK68D,mBAF7B,EAEkD,KAAKC,aAFvD,EAGrB,CAHqB,EAGlB,IAHkB,EAGZvlF,MAAMwoB,KAHM,EAIrB4/D,UAAUrsD,OAAV,IAAqBsjD,sBAArB,GACEA,sBADF,GACmB+I,UAAUrsD,OAAV,CAAkBvpC,GAAlB,CAAsB,UAASo8E,CAAT,EAAY;AACjD,WAAOA,IAAItxD,UAAX;AACD,GAFgB,CALE,EAQrB,CAAC,CAAC8qE,UAAU2I,cARS,EAQO,CAAC,CAAC3I,UAAU4I,gBARnB,CAAvB;AAUA,OAAK/N,wBAAL,CAA8BjtF,IAA9B,CAAmC,CAAC+sF,sBAAkBC,UAAnB,EAA+BzjE,KAA/B,EAAsCI,GAAtC,EACjC3f,KADiC,EAC1B,CAACypD,UAAU,KAAK27B,YAAhB,IAAgC9nE,UADN,EACkB,CAACosC,UAAU,KAAK27B,YAAhB,IAAgC/nE,UADlD,EAEjC,KAAKskE,eAF4B,EAEX5hF,MAAMyoB,MAFK,EAEG,CAFH,EAEM,CAFN,EAES,CAFT,EAEY,KAAK68D,mBAFjB,EAEsC,KAAKC,aAF3C,EAGjC,IAAIjoE,UAH6B,EAGjB,IAHiB,EAGXtd,MAAMwoB,KAHK,EAGE4/D,UAAUrsD,OAHZ,EAIjC,CAAC,CAACqsD,UAAU2I,cAJqB,EAIL,CAAC,CAAC3I,UAAU4I,gBAJP,CAAnC;AAMD,CA1BD;;AA6BA;;;;;;AAMA4B,iBAAiB1kF,SAAjB,CAA2B0oF,UAA3B,GAAwC,UAASr3E,KAAT,EAAgBI,GAAhB,EAAqB0jE,cAArB,EAAqC;AAC3E,MAAMuE,cAAc,KAAKlC,gBAAzB;AACA,MAAM0C,YAAY,KAAKzC,UAAvB;AACA,MAAM+B,YAAY,KAAKjC,cAAvB;;AAEA,MAAM0L,YAAY,KAAK4E,UAAvB;AACA,MAAInO,WAAJ,EAAiB;AACf,QAAI,EAAEuJ,aAAa,KAAKyE,YAApB,CAAJ,EAAuC;AACrC,WAAKA,YAAL,CAAkBzE,SAAlB,IAA+B,kDAAoD;AACjFjT,qBAAa0J,YAAY1J,WADwD;AAEjF4J,iBAASF,YAAYE,OAF4D;AAGjFE,wBAAgBJ,YAAYI,cAHqD;AAIjFE,mBAAWN,YAAYM,SAJ0D;AAKjFD,kBAAUL,YAAYK,QAL2D;AAMjFE,oBAAYP,YAAYO,UANyD;AAOjFJ,kBAAUH,YAAYG;AAP2D,OAAnF;AASD;AACF;AACD,MAAMsJ,UAAU,KAAKwE,QAArB;AACA,MAAI,EAAE,KAAKA,QAAL,IAAiB,KAAKrE,UAAxB,CAAJ,EAAyC;AACvC,SAAKA,UAAL,CAAgB,KAAKqE,QAArB,IAAiC,gDAAkD;AACjFp9E,YAAM2vE,UAAU3vE,IADiE;AAEjF6vE,iBAAWF,UAAUE,SAAV,IAAuBnJ,wBAF+C;AAGjF74C,aAAO8hD,UAAU9hD;AAHgE,KAAnF;AAKD;AACD,MAAM4qD,UAAU,KAAK4E,QAArB;AACA,MAAIpO,SAAJ,EAAe;AACb,QAAI,EAAEwJ,WAAW,KAAKyE,UAAlB,CAAJ,EAAmC;AACjC,WAAKA,UAAL,CAAgBzE,OAAhB,IAA2B,gDAAkD;AAC3EjT,mBAAWyJ,UAAUzJ;AADsD,OAA7E;AAGD;AACF;;AAED,MAAM3gE,aAAa,KAAKA,UAAxB;AACA,MAAM2zE,WAAWQ,mBAAWrJ,UAAUG,YAArB,CAAjB;;AAEA,MAAMvH,UAAU,KAAKqE,YAAL,GAAoB/nE,UAApC;AACA,MAAMqrC,OAAO,KAAKw8B,KAAlB;AACA,MAAM1sE,OAAO2vE,UAAU3vE,IAAvB;AACA,MAAMmyE,YAAYxC,UAAU9hD,KAA5B;AACA,MAAM8qD,cAAcxJ,cAAcA,YAAYM,SAAZ,GAAwB0C,SAAxB,GAAoC,CAAlD,GAAsD,CAA1E;AACA,MAAIsL,SAAS,KAAKF,OAAL,CAAav9E,IAAb,CAAb;AACA,MAAI,CAACy9E,MAAL,EAAa;AACX,SAAKF,OAAL,CAAav9E,IAAb,IAAqBy9E,SAAS,EAA9B;AACD;AACD,OAAKpT,YAAL,CAAkB9sF,IAAlB,CAAuB,CAAC+sF,sBAAkBwI,UAAnB,EACrBhsE,KADqB,EACdI,GADc,EACTsxE,QADS,EACC5N,cADD,EAErB+E,UAAU7/D,QAFW,EAED2oE,OAFC,EAEQ9I,UAAUpgC,QAFlB,EAGrB,UAASW,IAAT,EAAe;AACb,QAAIngC,QAAQ0tE,OAAOvtC,IAAP,CAAZ;AACA,QAAI,CAACngC,KAAL,EAAY;AACVA,cAAQ0tE,OAAOvtC,IAAP,IAAe,8BAAiBlwC,IAAjB,EAAuBkwC,IAAvB,CAAvB;AACD;AACD,WAAOngC,QAAQoiE,SAAR,GAAoBttE,UAA3B;AACD,GAToB,EAUrB0jE,OAVqB,EAUZmQ,SAVY,EAUDC,cAAc9zE,UAVb,EAUyBqrC,IAVzB,EAU+B0oC,OAV/B,EAUwC,CAVxC,CAAvB;AAYA,OAAKpO,wBAAL,CAA8BjtF,IAA9B,CAAmC,CAAC+sF,sBAAkBwI,UAAnB,EACjChsE,KADiC,EAC1BI,GAD0B,EACrBsxE,QADqB,EACX5N,cADW,EAEjC+E,UAAU7/D,QAFuB,EAEb2oE,OAFa,EAEJ9I,UAAUpgC,QAFN,EAGjC,UAASW,IAAT,EAAe;AACb,QAAIngC,QAAQ0tE,OAAOvtC,IAAP,CAAZ;AACA,QAAI,CAACngC,KAAL,EAAY;AACVA,cAAQ0tE,OAAOvtC,IAAP,IAAe,8BAAiBlwC,IAAjB,EAAuBkwC,IAAvB,CAAvB;AACD;AACD,WAAOngC,QAAQoiE,SAAf;AACD,GATgC,EAUjC5J,OAViC,EAUxBmQ,SAVwB,EAUbC,WAVa,EAUAzoC,IAVA,EAUM0oC,OAVN,EAUe,IAAI/zE,UAVnB,CAAnC;AAYD,CAxED;;AA2EA;;;AAGAs1E,iBAAiB1kF,SAAjB,CAA2BowE,YAA3B,GAA0C,UAASC,SAAT,EAAoB8E,cAApB,EAAoC;AAC5E,MAAI+E,kBAAJ;AAAA,MAAeV,kBAAf;AAAA,MAA0BE,oBAA1B;AACA,MAAI,CAACrJ,SAAL,EAAgB;AACd,SAAK4G,KAAL,GAAa,EAAb;AACD,GAFD,MAEO;AACL,SAAKvD,eAAL,GAAuB,qDAAuDyB,cAA9E;;AAEA,QAAMqG,gBAAgBnL,UAAU0I,OAAV,EAAtB;AACA,QAAI,CAACyC,aAAL,EAAoB;AAClBhC,kBAAY,KAAKjC,cAAL,GAAsB,IAAlC;AACD,KAFD,MAEO;AACLiC,kBAAY,KAAKjC,cAAjB;AACA,UAAI,CAACiC,SAAL,EAAgB;AACdA,oBAAY,KAAKjC,cAAL,GAAsB,gDAAkD,EAApF;AACD;AACDiC,gBAAUzJ,SAAV,GAAsB,4BACpByL,cAAcjB,QAAd,MAA4B7J,wBADR,CAAtB;AAED;;AAED,QAAMgL,kBAAkBrL,UAAU2I,SAAV,EAAxB;AACA,QAAI,CAAC0C,eAAL,EAAsB;AACpBhC,oBAAc,KAAKlC,gBAAL,GAAwB,IAAtC;AACD,KAFD,MAEO;AACLkC,oBAAc,KAAKlC,gBAAnB;AACA,UAAI,CAACkC,WAAL,EAAkB;AAChBA,sBAAc,KAAKlC,gBAAL,GAAwB,kDAAoD,EAA1F;AACD;AACD,UAAMqC,WAAW6B,gBAAgBd,WAAhB,EAAjB;AACA,UAAMd,iBAAiB4B,gBAAgBZ,iBAAhB,EAAvB;AACA,UAAMd,YAAY0B,gBAAgBl1D,QAAhB,EAAlB;AACA,UAAMyzD,aAAayB,gBAAgBP,aAAhB,EAAnB;AACAzB,kBAAYE,OAAZ,GAAsB8B,gBAAgBhB,UAAhB,MAAgC/J,sBAAtD;AACA+I,kBAAYG,QAAZ,GAAuBA,WAAWA,SAASl0F,KAAT,EAAX,GAA8BirF,uBAArD;AACA8I,kBAAYI,cAAZ,GACIA,mBAAmBpzF,SAAnB,GAA+BmqF,6BAA/B,GAAuDiJ,cAD3D;AAEAJ,kBAAYK,QAAZ,GAAuB2B,gBAAgBV,WAAhB,MAAiClK,uBAAxD;AACA4I,kBAAYM,SAAZ,GACIA,cAActzF,SAAd,GAA0B0qF,wBAA1B,GAA6C4I,SADjD;AAEAN,kBAAYO,UAAZ,GACIA,eAAevzF,SAAf,GAA2BqqF,yBAA3B,GAA+CkJ,UADnD;AAEAP,kBAAY1J,WAAZ,GAA0B,4BACxB0L,gBAAgBnB,QAAhB,MAA8BvJ,0BADN,CAA1B;AAED;;AAEDkJ,gBAAY,KAAKzC,UAAjB;AACA,QAAMltE,OAAO8lE,UAAU8L,OAAV,MAAuB1L,mBAApC;AACA,2BAAUlmE,IAAV;AACA,QAAMmyE,YAAYrM,UAAUqF,QAAV,EAAlB;AACAwE,cAAU7/D,QAAV,GAAqBg2D,UAAU4Y,WAAV,EAArB;AACA/O,cAAU3vE,IAAV,GAAiBA,IAAjB;AACA2vE,cAAUpgC,QAAV,GAAqBu2B,UAAU6Y,WAAV,EAArB;AACAhP,cAAUiO,SAAV,GAAsB9X,UAAU8Y,YAAV,EAAtB;AACAjP,cAAUE,SAAV,GAAsB/J,UAAUwM,YAAV,EAAtB;AACA3C,cAAUG,YAAV,GAAyBhK,UAAU0M,eAAV,MAA+B7L,2BAAxD;AACAgJ,cAAU2I,cAAV,GAA2BxS,UAAU+Y,iBAAV,EAA3B;AACAlP,cAAU4I,gBAAV,GAA6BzS,UAAUgZ,mBAAV,EAA7B;AACAnP,cAAUrsD,OAAV,GAAoBwiD,UAAUiZ,UAAV,MAA0BnY,sBAA9C;AACA+I,cAAU9hD,KAAV,GAAkBskD,cAAch2F,SAAd,GAA0B,CAA1B,GAA8Bg2F,SAAhD;;AAEA,QAAMN,cAAc/L,UAAUgM,UAAV,EAApB;AACA,QAAMC,cAAcjM,UAAUkM,UAAV,EAApB;AACA,QAAMC,qBAAqBnM,UAAUoF,iBAAV,EAA3B;AACA,QAAMgH,eAAepM,UAAUrnD,WAAV,EAArB;AACA,SAAKiuD,KAAL,GAAa5G,UAAU4I,OAAV,MAAuB,EAApC;AACA,SAAK/B,YAAL,GAAoBkF,gBAAgB11F,SAAhB,GAA4B,CAA5B,GAAgC01F,WAApD;AACA,SAAKjF,YAAL,GAAoBmF,gBAAgB51F,SAAhB,GAA4B,CAA5B,GAAgC41F,WAApD;AACA,SAAKlF,mBAAL,GAA2BoF,uBAAuB91F,SAAvB,GAAmC,KAAnC,GAA2C81F,kBAAtE;AACA,SAAKnF,aAAL,GAAqBoF,iBAAiB/1F,SAAjB,GAA6B,CAA7B,GAAiC+1F,YAAtD;;AAEA,SAAKoL,UAAL,GAAkBnO,cAChB,CAAC,OAAOA,YAAY1J,WAAnB,IAAkC,QAAlC,GAA6C0J,YAAY1J,WAAzD,GAAuE,mBAAO0J,YAAY1J,WAAnB,CAAxE,IACA0J,YAAYE,OADZ,GACsBF,YAAYI,cADlC,GACmD,GADnD,GACyDJ,YAAYM,SADrE,GAEAN,YAAYK,QAFZ,GAEuBL,YAAYO,UAFnC,GAEgD,GAFhD,GAEsDP,YAAYG,QAAZ,CAAqBpxF,IAArB,EAFtD,GAEoF,GAHpE,GAIhB,EAJF;AAKA,SAAKk/F,QAAL,GAAgBzN,UAAU3vE,IAAV,GAAiB2vE,UAAU9hD,KAA3B,IAAoC8hD,UAAUE,SAAV,IAAuB,GAA3D,CAAhB;AACA,SAAKwN,QAAL,GAAgBpO,YACb,OAAOA,UAAUzJ,SAAjB,IAA8B,QAA9B,GAAyCyJ,UAAUzJ,SAAnD,GAAgE,MAAM,mBAAOyJ,UAAUzJ,SAAjB,CADzD,GAEd,EAFF;AAGD;AACF,CA/ED;kBAgFe2U,gB;;;;;;;;;;;;;;;;;;;AChiBf;;;;;;AAGA;;;;AAIO,IAAMsC,wBAAQ,CACnBF,qBAAWh5C,OADQ,EAEnBg5C,qBAAWn5D,MAFQ,EAGnBm5D,qBAAWl5C,WAHQ,EAInBk5C,qBAAW90E,KAJQ,EAKnB80E,qBAAWniD,IALQ,EAMnBmiD,qBAAWrY,OANQ,CAAd;;AASP;;;;AAnBA;;;AAuBO,IAAM8U,kCAAa,EAAnB;AACPA,WAAW,MAAX,IAAqB,CAArB;AACAA,WAAW,KAAX,IAAoB,CAApB;AACAA,WAAW,QAAX,IAAuB,GAAvB;AACAA,WAAW,OAAX,IAAsB,CAAtB;AACAA,WAAW,OAAX,IAAsB,CAAtB;AACAA,WAAW,KAAX,IAAoB,CAApB;AACAA,WAAW,QAAX,IAAuB,GAAvB;AACAA,WAAW,SAAX,IAAwB,GAAxB;AACAA,WAAW,YAAX,IAA2B,GAA3B;AACAA,WAAW,aAAX,IAA4B,GAA5B;AACAA,WAAW,QAAX,IAAuB,CAAvB,C;;;;;;;;;;;;;;;;;;AC/BA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;;;AAEA;;;;;;AAZA;;;AAkBA,IAAMgG,gBAAgB,SAAhBA,aAAgB,CAASzlG,KAAT,EAAgB;;AAEpC8zB,uBAAWvW,IAAX,CAAgB,IAAhB;;AAEA;;;;AAIA,OAAKmoF,MAAL,GAAc1lG,KAAd;AAGD,CAXD;;AAaA,qBAASylG,aAAT,EAAwB3xE,oBAAxB;;AAGA;;;;;;;;;;AAUA2xE,cAAcvpF,SAAd,CAAwBie,0BAAxB,GAAqD9Q,oBAArD;;AAGA;;;;;AAKAo8E,cAAcvpF,SAAd,CAAwB2e,sBAAxB,GAAiDkgB,gBAAjD;;AAGA;;;;;;;;;AASA0qD,cAAcvpF,SAAd,CAAwBypF,sBAAxB,GAAiD,UAASxlG,MAAT,EAAiBmjC,UAAjB,EAA6BsiE,KAA7B,EAAoC;AACnF;AACE;;;;;AAKA,cAAS9kG,IAAT,EAAeqhC,SAAf,EAA0B;AACxB,eAASpI,QAAT,CAAkBkC,IAAlB,EAAwB;AACtB,YAAI,CAAC2pE,MAAM9kG,IAAN,CAAL,EAAkB;AAChB8kG,gBAAM9kG,IAAN,IAAc,EAAd;AACD;AACD8kG,cAAM9kG,IAAN,EAAYm7B,KAAKoG,SAAL,CAAex9B,QAAf,EAAZ,IAAyCo3B,IAAzC;AACD;AACD,aAAO97B,OAAO0lG,iBAAP,CAAyBviE,UAAzB,EAAqCxiC,IAArC,EAA2CqhC,SAA3C,EAAsDpI,QAAtD,CAAP;AACD;AAdH;AAgBD,CAjBD;;AAoBA;;;AAGA0rE,cAAcvpF,SAAd,CAAwB+1D,QAAxB,GAAmC,YAAW;AAC5C,SAAO,KAAKyzB,MAAZ;AACD,CAFD;;AAKA;;;;;AAKAD,cAAcvpF,SAAd,CAAwB4pF,kBAAxB,GAA6C,UAAS/zE,KAAT,EAAgB;AAC3D,MAAMm9D,QAAQ,8BAAgCn9D,MAAMrxB,MAApD;AACA,MAAIwuF,MAAMpjE,QAAN,OAAqBM,qBAAWE,MAApC,EAA4C;AAC1C,SAAKy5E,uBAAL;AACD;AACF,CALD;;AAQA;;;;;;;AAOAN,cAAcvpF,SAAd,CAAwB8pF,SAAxB,GAAoC,UAAS9W,KAAT,EAAgB;AAClD,MAAI+W,aAAa/W,MAAMpjE,QAAN,EAAjB;AACA,MAAIm6E,cAAc75E,qBAAWE,MAAzB,IAAmC25E,cAAc75E,qBAAWO,KAAhE,EAAuE;AACrE,wBAAOuiE,KAAP,EAAcpkE,oBAAUC,MAAxB,EAAgC,KAAK+6E,kBAArC,EAAyD,IAAzD;AACD;AACD,MAAIG,cAAc75E,qBAAWC,IAA7B,EAAmC;AACjC6iE,UAAMnjE,IAAN;AACAk6E,iBAAa/W,MAAMpjE,QAAN,EAAb;AACD;AACD,SAAOm6E,cAAc75E,qBAAWE,MAAhC;AACD,CAVD;;AAaA;;;AAGAm5E,cAAcvpF,SAAd,CAAwB6pF,uBAAxB,GAAkD,YAAW;AAC3D,MAAM/lG,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAIjyE,MAAM81E,UAAN,MAAsB91E,MAAM61E,cAAN,MAA0ByB,gBAAYC,KAAhE,EAAuE;AACrE,SAAK1sD,OAAL;AACD;AACF,CALD;;AAQA;;;;;AAKA46E,cAAcvpF,SAAd,CAAwBgqF,mBAAxB,GAA8C,UAAShzE,UAAT,EAAqBizE,UAArB,EAAiC;AAC7E,MAAIA,WAAWC,cAAX,EAAJ,EAAiC;AAC/B;;;;;AAKA,QAAMC,qBAAqB,UAASF,UAAT,EAAqB3lG,GAArB,EAA0B0yB,UAA1B,EAAsC;AAC/D,UAAMgJ,gBAAgB,mBAAOiqE,UAAP,EAAmBthG,QAAnB,EAAtB;AACA,UAAIq3B,iBAAiBhJ,WAAWyM,SAAhC,EAA2C;AACzCwmE,mBAAWG,WAAX,CAAuBpzE,WAAW+L,SAAX,CAAqBqE,UAA5C,EACEpQ,WAAWyM,SAAX,CAAqBzD,aAArB,CADF;AAED;AACF,KAN0B,CAMzB5jB,IANyB,CAMpB,IANoB,EAMd6tF,UANc,CAA3B;;AAQAjzE,eAAW4K,mBAAX,CAA+B95B,IAA/B;AACE,4DAA0DqiG,kBAD5D;AAGD;AACF,CAnBD;;AAsBA;;;;;;;AAOAZ,cAAcvpF,SAAd,CAAwBqqF,eAAxB,GAA0C,UAAS5mE,SAAT,EAAoBwmE,UAApB,EAAgCtvF,CAAhC,EAAmCsrB,SAAnC,EAA8C;AACtF;AACA,MAAMjG,gBAAgB,mBAAOiqE,UAAP,EAAmBthG,QAAnB,EAAtB;AACA,MAAMy9F,OAAOzrF,EAAEhS,QAAF,EAAb;AACA,MAAIq3B,iBAAiByD,SAArB,EAAgC;AAC9B,QAAI2iE,QAAQ3iE,UAAUzD,aAAV,CAAZ,EAAsC;AACpCyD,gBAAUzD,aAAV,EAAyBomE,IAAzB,EAA+Br6E,MAA/B,CAAsCka,SAAtC;AACD,KAFD,MAEO;AACLxC,gBAAUzD,aAAV,EAAyBomE,IAAzB,IAAiCngE,SAAjC;AACD;AACF,GAND,MAMO;AACLxC,cAAUzD,aAAV,IAA2B,EAA3B;AACAyD,cAAUzD,aAAV,EAAyBomE,IAAzB,IAAiCngE,SAAjC;AACD;AACF,CAdD;;AAiBA;;;;;;;;;;;;;;;;;;;;AAoBAsjE,cAAcvpF,SAAd,CAAwBsqF,iBAAxB,GAA4C,UAC1CtzE,UAD0C,EAC9BizE,UAD8B,EAClBxsB,QADkB,EACRruD,UADQ,EACIgY,UADJ,EACgBlY,MADhB,EAE1Cq7E,QAF0C,EAEhCC,OAFgC,EAEvBC,gBAFuB,EAELpsE,QAFK,EAEK;AAC/C,MAAM2B,gBAAgB,mBAAOiqE,UAAP,EAAmBthG,QAAnB,EAAtB;AACA,MAAI,EAAEq3B,iBAAiBhJ,WAAWmJ,WAA9B,CAAJ,EAAgD;AAC9CnJ,eAAWmJ,WAAX,CAAuBH,aAAvB,IAAwC,EAAxC;AACD;AACD,MAAMG,cAAcnJ,WAAWmJ,WAAX,CAAuBH,aAAvB,CAApB;AACA,MAAMgB,YAAYhK,WAAWgK,SAA7B;AACA,MAAMkH,UAAUu1C,SAAShxC,UAAT,EAAhB;AACA,MAAI1M,aAAJ;AAAA,MAAUkG,kBAAV;AAAA,MAAqB/F,uBAArB;AAAA,MAAqChwB,UAArC;AAAA,MAAwC+N,UAAxC;AAAA,MAA2CtD,UAA3C;AACA,OAAKA,IAAIutB,OAAT,EAAkBvtB,KAAK4vF,QAAvB,EAAiC,EAAE5vF,CAAnC,EAAsC;AACpCsrB,gBAAYw3C,SAASE,yBAAT,CAAmCzuD,MAAnC,EAA2CvU,CAA3C,EAA8CsrB,SAA9C,CAAZ;AACA/F,qBAAiBu9C,SAAS9tD,aAAT,CAAuBhV,CAAvB,CAAjB;AACA,SAAKzK,IAAI+1B,UAAUJ,IAAnB,EAAyB31B,KAAK+1B,UAAUH,IAAxC,EAA8C,EAAE51B,CAAhD,EAAmD;AACjD,WAAK+N,IAAIgoB,UAAUF,IAAnB,EAAyB9nB,KAAKgoB,UAAUD,IAAxC,EAA8C,EAAE/nB,CAAhD,EAAmD;AACjD,YAAIssF,WAAW5vF,CAAX,IAAgB6vF,OAApB,EAA6B;AAC3BzqE,iBAAOkqE,WAAWS,OAAX,CAAmB/vF,CAAnB,EAAsBzK,CAAtB,EAAyB+N,CAAzB,EAA4BmR,UAA5B,EAAwCgY,UAAxC,CAAP;AACA,cAAIrH,KAAKnQ,QAAL,MAAmBuV,oBAAUhV,IAAjC,EAAuC;AACrCgQ,wBAAYJ,KAAKM,MAAL,EAAZ,IAA6B,IAA7B;AACA,gBAAI,CAACW,UAAU2pE,WAAV,CAAsB5qE,KAAKM,MAAL,EAAtB,CAAL,EAA2C;AACzCW,wBAAUgE,OAAV,CAAkB,CAACjF,IAAD,EAAOC,aAAP,EAChBy9C,SAASmtB,kBAAT,CAA4B7qE,KAAKoG,SAAjC,CADgB,EAC6BjG,cAD7B,CAAlB;AAED;AACF;AACD,cAAIuqE,qBAAqB/jG,SAAzB,EAAoC;AAClC+jG,6BAAiBppF,IAAjB,CAAsBgd,QAAtB,EAAgC0B,IAAhC;AACD;AACF,SAZD,MAYO;AACLkqE,qBAAWY,OAAX,CAAmBlwF,CAAnB,EAAsBzK,CAAtB,EAAyB+N,CAAzB,EAA4BmpB,UAA5B;AACD;AACF;AACF;AACF;AACF,CAlCD;kBAmCemiE,a;;;;;;;;;;;;;;;;;QC6GCuB,Y,GAAAA,Y;;AA5VhB;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAGA;;;;;;;AAOA,IAAMC,cAAc,SAAdA,WAAc,CAASzmG,GAAT,EAAc;AAChCyoB,uBAAW1L,IAAX,CAAgB,IAAhB;;AAEA;;;;AAIA,OAAKyS,IAAL,GAAYxvB,GAAZ;;AAEA;;;;AAIA,OAAK0mG,eAAL,GAAuB,EAAvB;;AAEA;;;;AAIA,OAAKC,uBAAL,GAA+B,EAA/B;;AAEA;;;;AAIA,OAAKC,0BAAL,GAAkC,EAAlC;AAED,CA3BD,C,CArBA;;;;;AAkDA,qBAASH,WAAT,EAAsBh+E,oBAAtB;;AAGA;;;;AAIAg+E,YAAY/qF,SAAZ,CAAsB0S,sBAAtB,GAA+C,UAASy4E,YAAT,EAAuB;AACpE,OAAKD,0BAAL,CAAgCpjG,IAAhC,CAAqCQ,KAArC,CAA2C,KAAK4iG,0BAAhD,EAA4EC,YAA5E;AACD,CAFD;;AAKA;;;;AAIAJ,YAAY/qF,SAAZ,CAAsBorF,4BAAtB,GAAqD,YAAW;AAC9D,SAAO,KAAKF,0BAAZ;AACD,CAFD;;AAKA;;;;AAIAH,YAAY/qF,SAAZ,CAAsBqrF,mBAAtB,GAA4C,UAASr0E,UAAT,EAAqB;AAC/D,MAAM+L,YAAY/L,WAAW+L,SAA7B;AACA,MAAMtD,6BAA6BzI,WAAWyI,0BAA9C;AACA,MAAMH,6BAA6BtI,WAAWsI,0BAA9C;;AAEA,0BAAiBG,0BAAjB,EACEzI,WAAWjN,IAAX,CAAgB,CAAhB,IAAqB,CADvB,EAC0BiN,WAAWjN,IAAX,CAAgB,CAAhB,IAAqB,CAD/C,EAEE,IAAIgZ,UAAU5T,UAFhB,EAE4B,CAAC,CAAD,GAAK4T,UAAU5T,UAF3C,EAGE,CAAC4T,UAAUW,QAHb,EAIE,CAACX,UAAUp+B,MAAV,CAAiB,CAAjB,CAJH,EAIwB,CAACo+B,UAAUp+B,MAAV,CAAiB,CAAjB,CAJzB;;AAMA,yBACE,6BAAsB26B,0BAAtB,EAAkDG,0BAAlD,CADF;AAED,CAbD;;AAgBA;;;AAGAsrE,YAAY/qF,SAAZ,CAAsB+hB,oBAAtB,GAA6C,YAAW;AACtD,OAAK,IAAM5zB,GAAX,IAAkB,KAAK68F,eAAvB,EAAwC;AACtC,SAAKM,yBAAL,CAA+Bn9F,GAA/B,EAAoC8e,OAApC;AACD;AACF,CAJD;;AAOA;;;;AAIA,SAASs+E,eAAT,CAAyBjnG,GAAzB,EAA8B0yB,UAA9B,EAA0C;AACxCw0E,yBAAeC,MAAf;AACD;;AAGD;;;;;;;;;;;;;;;AAeAV,YAAY/qF,SAAZ,CAAsBie,0BAAtB,GAAmD,UAAS1K,UAAT,EAAqByD,UAArB,EAAiC8G,YAAjC,EAA+CD,QAA/C,EAAyDW,OAAzD,EACjDT,WADiD,EACpCU,QADoC,EAC1B;AACvB,MAAIp5B,eAAJ;AACA,MAAM09B,YAAY/L,WAAW+L,SAA7B;AACA,MAAM2oE,iBAAiB3oE,UAAU5T,UAAjC;;AAEA;;;;;AAKA,WAAS8O,0BAAT,CAAoC1pB,OAApC,EAA6CzQ,KAA7C,EAAoD;AAClD,QAAMqK,MAAM,mBAAOoG,OAAP,EAAgB5L,QAAhB,EAAZ;AACA,QAAM4wE,UAAUviD,WAAWqM,WAAX,CAAuB,mBAAOv/B,KAAP,CAAvB,EAAsCy1E,OAAtD;AACA,QAAI,EAAEprE,OAAO6oB,WAAWwM,kBAAlB,IAAwC,CAAC+1C,OAA3C,CAAJ,EAAyD;AACvD,aAAO17C,SAASxc,IAAT,CAAcmd,OAAd,EAAuBjqB,OAAvB,EAAgCglE,UAAUz1E,KAAV,GAAkB,IAAlD,CAAP;AACD;AACF;;AAED,MAAMsjC,aAAarE,UAAUqE,UAA7B;;AAEA,MAAIukE,uBAAuBp4E,UAA3B;AACA,MAAI6T,WAAW+kD,QAAX,EAAJ,EAA2B;AACzB,QAAMyf,mBAAmBxkE,WAAW5X,SAAX,EAAzB;AACA,QAAMq8E,aAAa,sBAASD,gBAAT,CAAnB;AACA,QAAM17F,IAAIqjB,WAAW,CAAX,CAAV;AACA,QAAIrjB,IAAI07F,iBAAiB,CAAjB,CAAJ,IAA2B17F,IAAI07F,iBAAiB,CAAjB,CAAnC,EAAwD;AACtD,UAAME,aAAajiG,KAAKqH,IAAL,CAAU,CAAC06F,iBAAiB,CAAjB,IAAsB17F,CAAvB,IAA4B27F,UAAtC,CAAnB;AACAF,6BAAuB,CAACz7F,IAAI27F,aAAaC,UAAlB,EAA8Bv4E,WAAW,CAAX,CAA9B,CAAvB;AACD;AACF;;AAED,MAAM8P,cAAcrM,WAAWmM,gBAA/B;AACA,MAAM4oE,YAAY1oE,YAAYt9B,MAA9B;AACA,MAAID,UAAJ;AACA,OAAKA,IAAIimG,YAAY,CAArB,EAAwBjmG,KAAK,CAA7B,EAAgC,EAAEA,CAAlC,EAAqC;AACnC,QAAM8uC,aAAavR,YAAYv9B,CAAZ,CAAnB;AACA,QAAMhC,QAAQ8wC,WAAW9wC,KAAzB;AACA,QAAI,gCAAoB8wC,UAApB,EAAgC82D,cAAhC,KAAmD3tE,YAAY1c,IAAZ,CAAiBod,QAAjB,EAA2B36B,KAA3B,CAAvD,EAA0F;AACxF,UAAMkoG,gBAAgB,KAAKC,gBAAL,CAAsBnoG,KAAtB,CAAtB;AACA,UAAIA,MAAM+wC,SAAN,EAAJ,EAAuB;AACrBxvC,iBAAS2mG,cAAc/tE,0BAAd,CACPn6B,MAAM+wC,SAAN,GAAkBq3D,QAAlB,KAA+BP,oBAA/B,GAAsDp4E,UAD/C,EAEPyD,UAFO,EAEK8G,YAFL,EAEmBG,0BAFnB,EAE+CO,OAF/C,CAAT;AAGD;AACD,UAAIn5B,MAAJ,EAAY;AACV,eAAOA,MAAP;AACD;AACF;AACF;AACD,SAAOqB,SAAP;AACD,CAnDD;;AAsDA;;;;;;;;;;;;;;;AAeAqkG,YAAY/qF,SAAZ,CAAsBoe,mBAAtB,GAA4C,UAAS/K,KAAT,EAAgB2D,UAAhB,EAA4B6G,QAA5B,EAAsCW,OAAtC,EAC1CT,WAD0C,EAC7BU,QAD6B,EACnB,CAAE,CAD3B;;AAIA;;;;;;;;;;;;AAYAssE,YAAY/qF,SAAZ,CAAsB2e,sBAAtB,GAA+C,UAASpL,UAAT,EAAqByD,UAArB,EAAiC8G,YAAjC,EAA+CC,WAA/C,EAA4DS,OAA5D,EAAqE;AAClH,MAAM2tE,aAAa,KAAKluE,0BAAL,CACjB1K,UADiB,EACLyD,UADK,EACO8G,YADP,EACqBE,eADrB,EAC2B,IAD3B,EACiCD,WADjC,EAC8CS,OAD9C,CAAnB;;AAGA,SAAO2tE,eAAezlG,SAAtB;AACD,CALD;;AAQA;;;;;AAKAqkG,YAAY/qF,SAAZ,CAAsBisF,gBAAtB,GAAyC,UAASnoG,KAAT,EAAgB;AACvD,MAAMsoG,WAAW,mBAAOtoG,KAAP,EAAc6E,QAAd,EAAjB;AACA,MAAIyjG,YAAY,KAAKpB,eAArB,EAAsC;AACpC,WAAO,KAAKA,eAAL,CAAqBoB,QAArB,CAAP;AACD,GAFD,MAEO;AACL,QAAI55E,iBAAJ;AACA,SAAK,IAAI1sB,IAAI,CAAR,EAAWwkB,KAAK,KAAK4gF,0BAAL,CAAgCnlG,MAArD,EAA6DD,IAAIwkB,EAAjE,EAAqE,EAAExkB,CAAvE,EAA0E;AACxE,UAAMumG,YAAY,KAAKnB,0BAAL,CAAgCplG,CAAhC,CAAlB;AACA,UAAIumG,UAAU,SAAV,EAAqBvoG,KAArB,CAAJ,EAAiC;AAC/B0uB,mBAAW65E,UAAU,QAAV,EAAoB,IAApB,EAA0BvoG,KAA1B,CAAX;AACA;AACD;AACF;AACD,QAAI0uB,QAAJ,EAAc;AACZ,WAAKw4E,eAAL,CAAqBoB,QAArB,IAAiC55E,QAAjC;AACA,WAAKy4E,uBAAL,CAA6BmB,QAA7B,IAAyC,oBAAO55E,QAAP,EACvC5D,oBAAUC,MAD6B,EACrB,KAAKy9E,0BADgB,EACY,IADZ,CAAzC;AAED,KAJD,MAIO;AACL,YAAM,IAAIz1F,KAAJ,CAAU,0CAA0C/S,MAAMob,OAAN,EAApD,CAAN;AACD;AACD,WAAOsT,QAAP;AACD;AACF,CAtBD;;AAyBA;;;;;AAKAu4E,YAAY/qF,SAAZ,CAAsBusF,qBAAtB,GAA8C,UAASH,QAAT,EAAmB;AAC/D,SAAO,KAAKpB,eAAL,CAAqBoB,QAArB,CAAP;AACD,CAFD;;AAKA;;;;AAIArB,YAAY/qF,SAAZ,CAAsBwsF,iBAAtB,GAA0C,YAAW;AACnD,SAAO,KAAKxB,eAAZ;AACD,CAFD;;AAKA;;;AAGAD,YAAY/qF,SAAZ,CAAsB+1B,MAAtB,GAA+B,YAAW;AACxC,SAAO,KAAKjiB,IAAZ;AACD,CAFD;;AAKA;;;;AAIAi3E,YAAY/qF,SAAZ,CAAsBssF,0BAAtB,GAAmD,YAAW;AAC5D,OAAKx4E,IAAL,CAAU+N,MAAV;AACD,CAFD;;AAKA;;;;;AAKAkpE,YAAY/qF,SAAZ,CAAsBsrF,yBAAtB,GAAkD,UAASc,QAAT,EAAmB;AACnE,MAAMJ,gBAAgB,KAAKhB,eAAL,CAAqBoB,QAArB,CAAtB;AACA,SAAO,KAAKpB,eAAL,CAAqBoB,QAArB,CAAP;;AAEA,6BAAc,KAAKnB,uBAAL,CAA6BmB,QAA7B,CAAd;AACA,SAAO,KAAKnB,uBAAL,CAA6BmB,QAA7B,CAAP;;AAEA,SAAOJ,aAAP;AACD,CARD;;AAWA;;;;AAIAjB,YAAY/qF,SAAZ,CAAsB2jB,WAAtB,GAAoCxW,oBAApC;;AAGA;;;;;AAKA49E,YAAY/qF,SAAZ,CAAsBysF,2BAAtB,GAAoD,UAASnoG,GAAT,EAAc0yB,UAAd,EAA0B;AAC5E,OAAK,IAAMo1E,QAAX,IAAuB,KAAKpB,eAA5B,EAA6C;AAC3C,QAAI,CAACh0E,UAAD,IAAe,EAAEo1E,YAAYp1E,WAAWqM,WAAzB,CAAnB,EAA0D;AACxD,WAAKioE,yBAAL,CAA+Bc,QAA/B,EAAyCn/E,OAAzC;AACD;AACF;AACF,CAND;;AASA;;;;AAIA89E,YAAY/qF,SAAZ,CAAsB0sF,uBAAtB,GAAgD,UAAS11E,UAAT,EAAqB;AACnEA,aAAW4K,mBAAX,CAA+B95B,IAA/B,EAAoC,wDAA0DyjG,eAA9F;AACD,CAFD;;AAKA;;;;AAIAR,YAAY/qF,SAAZ,CAAsB2sF,kCAAtB,GAA2D,UAAS31E,UAAT,EAAqB;AAC9E,OAAK,IAAMo1E,QAAX,IAAuB,KAAKpB,eAA5B,EAA6C;AAC3C,QAAI,EAAEoB,YAAYp1E,WAAWqM,WAAzB,CAAJ,EAA2C;AACzCrM,iBAAW4K,mBAAX,CAA+B95B,IAA/B;AACE,8DAA0D,KAAK2kG,2BAAL,CAAiCrwF,IAAjC,CAAsC,IAAtC,CAD5D;AAGA;AACD;AACF;AACF,CATD;;AAYA;;;;;AAKO,SAAS0uF,YAAT,CAAsB8B,MAAtB,EAA8BC,MAA9B,EAAsC;AAC3C,SAAOD,OAAOzzB,MAAP,GAAgB0zB,OAAO1zB,MAA9B;AACD;kBACc4xB,W;;;;;;;;;;;;;;;;;;AC/Vf;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AAEA;;;;;;AAhBA;;;AAsBA,IAAMp4E,2BAA2B,SAA3BA,wBAA2B,CAASm6E,UAAT,EAAqB;;AAEpDC,+BAA2B1rF,IAA3B,CAAgC,IAAhC,EAAsCyrF,UAAtC;;AAEA;;;;AAIA,OAAKlZ,MAAL,GAAc,IAAd;;AAEA;;;;AAIA,OAAKoZ,eAAL,GAAuB,wBAAvB;;AAEA;;;AAGA,OAAKC,gBAAL,GAAwB,EAAxB;;AAEA;;;;AAIA,OAAKC,eAAL,GAAuB,IAAvB;;AAEA,MAAIJ,WAAW5tF,OAAX,OAAyBy9D,oBAAUxqD,MAAvC,EAA+C;AAC7C,SAAK,IAAIrsB,IAAI,CAAR,EAAWwkB,KAAK6iF,+BAA0BpnG,MAA/C,EAAuDD,IAAIwkB,EAA3D,EAA+D,EAAExkB,CAAjE,EAAoE;AAClE,UAAMsiB,OAAO+kF,+BAA0BrnG,CAA1B,CAAb;AACA,UAAIsiB,SAASuK,wBAAT,IAAqCvK,KAAK,SAAL,EAAgB0kF,UAAhB,CAAzC,EAAsE;AACpE,aAAKI,eAAL,GAAuB,IAAI9kF,IAAJ,CAAS0kF,UAAT,CAAvB;AACA;AACD;AACF;AACF;AAEF,CArCD;;AAuCA,qBAASn6E,wBAAT,EAAmCo6E,4BAAnC;;AAGA;;;;;AAKAp6E,yBAAyB,SAAzB,IAAsC,UAAS7uB,KAAT,EAAgB;AACpD,SAAOA,MAAMob,OAAN,OAAoBy9D,oBAAU3qD,KAA9B,IACLluB,MAAMob,OAAN,OAAoBy9D,oBAAUxqD,MAA9B;AACA,uCAAuCruB,KAAD,CAAQu5E,aAAR,OAA4BX,2BAAiB1qD,KAFrF;AAGD,CAJD;;AAOA;;;;;;AAMAW,yBAAyB,QAAzB,IAAqC,UAASy6E,WAAT,EAAsBtpG,KAAtB,EAA6B;AAChE,SAAO,IAAI6uB,wBAAJ,EAA6B,oCAAsC7uB,KAAnE,CAAP;AACD,CAFD;;AAKA;;;AAGA6uB,yBAAyB3S,SAAzB,CAAmCkN,eAAnC,GAAqD,YAAW;AAC9D,MAAI,KAAKggF,eAAT,EAA0B;AACxB,SAAKA,eAAL,CAAqBjgF,OAArB;AACD;AACD8/E,+BAA2B/sF,SAA3B,CAAqCkN,eAArC,CAAqD7L,IAArD,CAA0D,IAA1D;AACD,CALD;;AAQA;;;AAGAsR,yBAAyB3S,SAAzB,CAAmCyP,QAAnC,GAA8C,YAAW;AACvD,SAAO,CAAC,KAAKmkE,MAAN,GAAe,IAAf,GAAsB,KAAKA,MAAL,CAAYnkE,QAAZ,EAA7B;AACD,CAFD;;AAKA;;;AAGAkD,yBAAyB3S,SAAzB,CAAmCqtF,iBAAnC,GAAuD,YAAW;AAChE,SAAO,KAAKL,eAAZ;AACD,CAFD;;AAKA;;;AAGAr6E,yBAAyB3S,SAAzB,CAAmCstF,YAAnC,GAAkD,UAASt2E,UAAT,EAAqB4d,UAArB,EAAiC;;AAEjF,MAAMxlB,aAAa4H,WAAW5H,UAA9B;AACA,MAAMrF,OAAOiN,WAAWjN,IAAxB;AACA,MAAMgZ,YAAY/L,WAAW+L,SAA7B;AACA,MAAMwqE,aAAaxqE,UAAUp+B,MAA7B;AACA,MAAM+mG,iBAAiB3oE,UAAU5T,UAAjC;;AAEA,MAAI6jE,cAAJ;AACA,MAAM8Z,aAAa,oCAAsC,KAAK/2B,QAAL,EAAzD;AACA,MAAMy3B,cAAcV,WAAWj4D,SAAX,EAApB;;AAEA,MAAMzT,QAAQpK,WAAWqK,SAAzB;;AAEA,MAAMosE,iBAAiB,KAAKP,eAA5B;AACA,MAAIQ,iBAAiB12E,WAAW9H,MAAhC;AACA,MAAI,CAACu+E,cAAD,IAAmB74D,WAAW1lB,MAAX,KAAsBxoB,SAA7C,EAAwD;AACtDgnG,qBAAiB,6BAAgBA,cAAhB,EAAgC94D,WAAW1lB,MAA3C,CAAjB;AACD;;AAED,MAAI,CAACkS,MAAME,mBAASC,SAAf,CAAD,IAA8B,CAACH,MAAME,mBAASE,WAAf,CAA/B,IACA,CAAC,qBAAQksE,cAAR,CADL,EAC8B;AAC5B,QAAItmE,aAAarE,UAAUqE,UAA3B;AACA,QAAI,CAACumE,kCAAL,EAAiC;AAC/B,UAAM1iB,mBAAmBuiB,YAAY7gE,aAAZ,EAAzB;AACA,UAAIs+C,gBAAJ,EAAsB;AACpB7jD,qBAAa6jD,gBAAb;AACD;AACF;AACD,QAAI2iB,kBAAkB,KAAKX,gBAA3B;AACA,QAAIQ,cAAJ,EAAoB;AAClB,UAAM3mG,UAAU2mG,eAAe3mG,OAA/B;AACA,UAAM+mG,kBAAkB,gDAAkD,iBAAO,EAAP,EAAW72E,UAAX,EAAuB;AAC/FjN,cAAM,CACJ,sBAAS2jF,cAAT,IAA2BhC,cADvB,EAEJ,uBAAUgC,cAAV,IAA4BhC,cAFxB,CADyF;AAK/F3oE,mBAAW,mCAAqC,iBAAO,EAAP,EAAW/L,WAAW+L,SAAtB,EAAiC;AAC/EW,oBAAU;AADqE,SAAjC;AAL+C,OAAvB,CAA1E;AASA,UAAMoqE,qBAAqBloG,OAAO6N,IAAP,CAAYo6F,gBAAgBrqE,kBAA5B,EAAgD9vB,IAAhD,EAA3B;AACAs/E,cAAQ,IAAIljE,qBAAJ,CAAgB49E,cAAhB,EAAgChC,cAAhC,EAAgDt8E,UAAhD,EAA4DtoB,QAAQipB,MAApE,EAA4E,UAAS8N,QAAT,EAAmB;AACrG,YAAI4vE,eAAeH,YAAf,CAA4BO,eAA5B,EAA6Cj5D,UAA7C,MACC64D,eAAeM,kBAAf,IACD,CAAC,mBAAOH,eAAP,EAAwBE,kBAAxB,CAFD,CAAJ,EAEmD;AACjDhnG,kBAAQipB,MAAR,CAAeuK,KAAf,GAAuBuzE,gBAAgB9jF,IAAhB,CAAqB,CAArB,IAA0BqF,UAAjD;AACAtoB,kBAAQipB,MAAR,CAAewK,MAAf,GAAwBszE,gBAAgB9jF,IAAhB,CAAqB,CAArB,IAA0BqF,UAAlD;AACAq+E,yBAAeO,OAAf,CAAuBlnG,OAAvB,EAAgC+mG,eAAhC,EAAiDj5D,UAAjD;AACAg5D,4BAAkBE,kBAAlB;AACAjwE;AACD;AACF,OAVO,CAAR;AAWD,KAvBD,MAuBO;AACLm1D,cAAQwa,YAAY/9E,QAAZ,CACNi+E,cADM,EACUhC,cADV,EAC0Bt8E,UAD1B,EACsCgY,UADtC,CAAR;AAED;AACD,QAAI4rD,SAAS,KAAK8W,SAAL,CAAe9W,KAAf,CAAb,EAAoC;AAClC,WAAKY,MAAL,GAAcZ,KAAd;AACA,WAAKia,gBAAL,GAAwBW,eAAxB;AACD;AACF;;AAED,MAAI,KAAKha,MAAT,EAAiB;AACfZ,YAAQ,KAAKY,MAAb;AACA,QAAMqa,cAAcjb,MAAMxjE,SAAN,EAApB;AACA,QAAM0+E,kBAAkBlb,MAAMrjE,aAAN,EAAxB;AACA,QAAMw+E,kBAAkBnb,MAAMtjE,aAAN,EAAxB;AACA,QAAM0oB,QAAQhpB,aAAa8+E,eAAb,IACTxC,iBAAiByC,eADR,CAAd;AAEA,QAAMx3D,YAAY,wBAAiB,KAAKq2D,eAAtB,EAChB59E,aAAarF,KAAK,CAAL,CAAb,GAAuB,CADP,EACUqF,aAAarF,KAAK,CAAL,CAAb,GAAuB,CADjC,EAEhBquB,KAFgB,EAETA,KAFS,EAGhB,CAHgB,EAIhB+1D,mBAAmBF,YAAY,CAAZ,IAAiBV,WAAW,CAAX,CAApC,IAAqDW,eAJrC,EAKhBC,mBAAmBZ,WAAW,CAAX,IAAgBU,YAAY,CAAZ,CAAnC,IAAqDC,eALrC,CAAlB;AAMA,4BAAiB,KAAKE,gCAAtB,EACEh/E,aAAarF,KAAK,CAAL,CAAb,GAAuB,CAAvB,GAA2B4sB,UAAU,CAAV,CAD7B,EAC2CvnB,aAAarF,KAAK,CAAL,CAAb,GAAuB,CAAvB,GAA2B4sB,UAAU,CAAV,CADtE,EAEEvnB,aAAas8E,cAFf,EAE+B,CAACt8E,UAAD,GAAcs8E,cAF7C,EAGE,CAHF,EAIE,CAAC6B,WAAW,CAAX,CAJH,EAIkB,CAACA,WAAW,CAAX,CAJnB;;AAMA,SAAKc,kBAAL,GAA0BH,kBAAkB9+E,UAAlB,GAA+B++E,eAAzD;AACD;;AAED,SAAO,CAAC,CAAC,KAAKva,MAAd;AACD,CAtFD;;AAyFA;;;AAGAjhE,yBAAyB3S,SAAzB,CAAmCie,0BAAnC,GAAgE,UAAS1K,UAAT,EAAqByD,UAArB,EAAiC8G,YAAjC,EAA+CD,QAA/C,EAAyDW,OAAzD,EAAkE;AAChI,MAAI,KAAK0uE,eAAT,EAA0B;AACxB,WAAO,KAAKA,eAAL,CAAqBjvE,0BAArB,CAAgD1K,UAAhD,EAA4DyD,UAA5D,EAAwE8G,YAAxE,EAAsFD,QAAtF,EAAgGW,OAAhG,CAAP;AACD,GAFD,MAEO;AACL,WAAOuuE,6BAA2B/sF,SAA3B,CAAqCie,0BAArC,CAAgE5c,IAAhE,CAAqE,IAArE,EAA2EkS,UAA3E,EAAuFyD,UAAvF,EAAmG8G,YAAnG,EAAiHD,QAAjH,EAA2HW,OAA3H,CAAP;AACD;AACF,CAND;;kBASe7L,wB;;;;;;;;;;;;;;;;;;ACvNf;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AAEA;;;;;;AAMA,IAAMo6E,6BAA6B,SAA7BA,0BAA6B,CAASjpG,KAAT,EAAgB;;AAEjDwqG,kBAAoBjtF,IAApB,CAAyB,IAAzB,EAA+Bvd,KAA/B;;AAEA;;;;AAIA,OAAKsqG,gCAAL,GAAwC,wBAAxC;;AAEA;;;;AAIA,OAAKG,iBAAL,GAAyB,IAAzB;AAED,CAhBD,C,CAjBA;;;;;AAmCA,qBAASxB,0BAAT,EAAqCuB,eAArC;;AAGA;;;AAGAvB,2BAA2B/sF,SAA3B,CAAqCwuF,YAArC,GAAoD,UAASx3E,UAAT,EAAqB4d,UAArB,EAAiC9tC,OAAjC,EAA0C;;AAE5F,OAAK2nG,UAAL,CAAgB3nG,OAAhB,EAAyBkwB,UAAzB;;AAEA,MAAMg8D,QAAQ,KAAKvjE,QAAL,EAAd;AACA,MAAIujE,KAAJ,EAAW;;AAET;AACA,QAAM9jE,SAAS0lB,WAAW1lB,MAA1B;AACA,QAAMw/E,UAAUx/E,WAAWxoB,SAAX,IACZ,CAAC,4BAAewoB,MAAf,EAAuB8H,WAAW9H,MAAlC,CADW,IAEZ,wBAAWA,MAAX,EAAmB8H,WAAW9H,MAA9B,CAFJ;AAGA,QAAIw/E,OAAJ,EAAa;AACX,WAAK5I,IAAL,CAAUh/F,OAAV,EAAmBkwB,UAAnB,EAA+B,sCAAwC9H,MAAvE;AACD;;AAED,QAAMy/E,iBAAiB,KAAKtB,iBAAL,EAAvB;AACA;AACA;AACA;AACA,QAAMp/F,QAAQnH,QAAQqsF,WAAtB;AACArsF,YAAQqsF,WAAR,GAAsBv+C,WAAWokC,OAAjC;;AAEA;AACA;AACA,QAAMpnD,KAAK+8E,eAAe,CAAf,CAAX;AACA,QAAM98E,KAAK88E,eAAe,CAAf,CAAX;AACA,QAAMC,KAAK5b,MAAM14D,KAAN,GAAcq0E,eAAe,CAAf,CAAzB;AACA,QAAME,KAAK7b,MAAMz4D,MAAN,GAAeo0E,eAAe,CAAf,CAA1B;AACA7nG,YAAQ0pF,SAAR,CAAkBwC,KAAlB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAACA,MAAM14D,KAAtC,EAA6C,CAAC04D,MAAMz4D,MAApD,EACE1wB,KAAKoH,KAAL,CAAW2gB,EAAX,CADF,EACkB/nB,KAAKoH,KAAL,CAAW4gB,EAAX,CADlB,EACkChoB,KAAKoH,KAAL,CAAW29F,EAAX,CADlC,EACkD/kG,KAAKoH,KAAL,CAAW49F,EAAX,CADlD;AAEA/nG,YAAQqsF,WAAR,GAAsBllF,KAAtB;;AAEA,QAAIygG,OAAJ,EAAa;AACX5nG,cAAQwgG,OAAR;AACD;AACF;;AAED,OAAKwH,WAAL,CAAiBhoG,OAAjB,EAA0BkwB,UAA1B,EAAsC4d,UAAtC;AACD,CAvCD;;AA0CA;;;;AAIAm4D,2BAA2B/sF,SAA3B,CAAqCyP,QAArC,GAAgD,YAAW,CAAE,CAA7D;;AAGA;;;;AAIAs9E,2BAA2B/sF,SAA3B,CAAqCqtF,iBAArC,GAAyD,YAAW,CAAE,CAAtE;;AAGA;;;AAGAN,2BAA2B/sF,SAA3B,CAAqCie,0BAArC,GAAkE,UAAS1K,UAAT,EAAqByD,UAArB,EAAiC8G,YAAjC,EAA+CD,QAA/C,EAAyDW,OAAzD,EAAkE;AAClI,MAAM16B,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAM9xE,SAASH,MAAM+wC,SAAN,EAAf;AACA,MAAM1lB,aAAa6H,WAAW+L,SAAX,CAAqB5T,UAAxC;AACA,MAAMuU,WAAW1M,WAAW+L,SAAX,CAAqBW,QAAtC;AACA,MAAMF,qBAAqBxM,WAAWwM,kBAAtC;AACA,SAAOv/B,OAAOg6B,0BAAP,CACL1K,UADK,EACOpE,UADP,EACmBuU,QADnB,EAC6B5F,YAD7B,EAC2C0F,kBAD3C;AAEL;;;;AAIA,YAASjvB,OAAT,EAAkB;AAChB,WAAOspB,SAASxc,IAAT,CAAcmd,OAAd,EAAuBjqB,OAAvB,EAAgCzQ,KAAhC,CAAP;AACD,GARI,CAAP;AASD,CAfD;;AAkBA;;;AAGAipG,2BAA2B/sF,SAA3B,CAAqC+uF,wBAArC,GAAgE,UAASx7E,UAAT,EAAqByD,UAArB,EAAiC6G,QAAjC,EAA2CW,OAA3C,EAAoD;AAClH,MAAI,CAAC,KAAK/O,QAAL,EAAL,EAAsB;AACpB,WAAO/oB,SAAP;AACD;;AAED,MAAI,KAAKqvE,QAAL,GAAgBlhC,SAAhB,GAA4B5W,0BAA5B,KAA2D9Q,oBAA/D,EAA0E;AACxE;AACA;AACA,WAAOmhF,gBAAoBtuF,SAApB,CAA8B+uF,wBAA9B,CAAuDzmG,KAAvD,CAA6D,IAA7D,EAAmE6gC,SAAnE,CAAP;AACD,GAJD,MAIO;AACL,QAAM9V,QAAQ,sBAAe,KAAK+6E,gCAApB,EAAsD76E,WAAW5tB,KAAX,EAAtD,CAAd;AACA,2BAAgB0tB,KAAhB,EAAuB2D,WAAW+L,SAAX,CAAqB5T,UAArB,GAAkC,KAAKk/E,kBAA9D;;AAEA,QAAI,CAAC,KAAKE,iBAAV,EAA6B;AAC3B,WAAKA,iBAAL,GAAyB,gCAAsB,CAAtB,EAAyB,CAAzB,CAAzB;AACD;;AAED,SAAKA,iBAAL,CAAuBhI,SAAvB,CAAiC,CAAjC,EAAoC,CAApC,EAAuC,CAAvC,EAA0C,CAA1C;AACA,SAAKgI,iBAAL,CAAuB/d,SAAvB,CAAiC,KAAK/gE,QAAL,EAAjC,EAAkD4D,MAAM,CAAN,CAAlD,EAA4DA,MAAM,CAAN,CAA5D,EAAsE,CAAtE,EAAyE,CAAzE,EAA4E,CAA5E,EAA+E,CAA/E,EAAkF,CAAlF,EAAqF,CAArF;;AAEA,QAAMuzE,YAAY,KAAK2H,iBAAL,CAAuB1H,YAAvB,CAAoC,CAApC,EAAuC,CAAvC,EAA0C,CAA1C,EAA6C,CAA7C,EAAgD7/E,IAAlE;AACA,QAAI4/E,UAAU,CAAV,IAAe,CAAnB,EAAsB;AACpB,aAAO/oE,SAASxc,IAAT,CAAcmd,OAAd,EAAuB,KAAKu3C,QAAL,EAAvB,EAAyC6wB,SAAzC,CAAP;AACD,KAFD,MAEO;AACL,aAAOlgG,SAAP;AACD;AACF;AACF,CA3BD;kBA4BeqmG,0B;;;;;;;;;;;;;;;;;;AClJf;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;AAMA,IAAMuB,sBAAsB,SAAtBA,mBAAsB,CAASxqG,KAAT,EAAgB;;AAE1CylG,kBAAcloF,IAAd,CAAmB,IAAnB,EAAyBvd,KAAzB;;AAEA;;;;AAIA,OAAKuqG,kBAAL;;AAEA;;;;AAIA,OAAKtY,UAAL,GAAkB,wBAAlB;AAED,CAhBD,C,CAnBA;;;;;AAqCA,qBAASuY,mBAAT,EAA8B/E,eAA9B;;AAGA;;;;;;AAMA+E,oBAAoBtuF,SAApB,CAA8B8lF,IAA9B,GAAqC,UAASh/F,OAAT,EAAkBkwB,UAAlB,EAA8B9H,MAA9B,EAAsC;AACzE,MAAME,aAAa4H,WAAW5H,UAA9B;AACA,MAAMkL,QAAQtD,WAAWjN,IAAX,CAAgB,CAAhB,IAAqBqF,UAAnC;AACA,MAAMmL,SAASvD,WAAWjN,IAAX,CAAgB,CAAhB,IAAqBqF,UAApC;AACA,MAAMsU,WAAW1M,WAAW+L,SAAX,CAAqBW,QAAtC;AACA,MAAMsrE,UAAU,yBAAW,sCAAwC9/E,MAAnD,CAAhB;AACA,MAAM+/E,WAAW,0BAAY,sCAAwC//E,MAApD,CAAjB;AACA,MAAMggF,cAAc,6BAAe,sCAAwChgF,MAAvD,CAApB;AACA,MAAMigF,aAAa,4BAAc,sCAAwCjgF,MAAtD,CAAnB;;AAEA,wBAAe8H,WAAWyI,0BAA1B,EAAsDuvE,OAAtD;AACA,wBAAeh4E,WAAWyI,0BAA1B,EAAsDwvE,QAAtD;AACA,wBAAej4E,WAAWyI,0BAA1B,EAAsDyvE,WAAtD;AACA,wBAAel4E,WAAWyI,0BAA1B,EAAsD0vE,UAAtD;;AAEAroG,UAAQsgG,IAAR;AACA,8BAAetgG,OAAf,EAAwB,CAAC48B,QAAzB,EAAmCpJ,QAAQ,CAA3C,EAA8CC,SAAS,CAAvD;AACAzzB,UAAQ6xF,SAAR;AACA7xF,UAAQyxF,MAAR,CAAeyW,QAAQ,CAAR,IAAa5/E,UAA5B,EAAwC4/E,QAAQ,CAAR,IAAa5/E,UAArD;AACAtoB,UAAQ0xF,MAAR,CAAeyW,SAAS,CAAT,IAAc7/E,UAA7B,EAAyC6/E,SAAS,CAAT,IAAc7/E,UAAvD;AACAtoB,UAAQ0xF,MAAR,CAAe0W,YAAY,CAAZ,IAAiB9/E,UAAhC,EAA4C8/E,YAAY,CAAZ,IAAiB9/E,UAA7D;AACAtoB,UAAQ0xF,MAAR,CAAe2W,WAAW,CAAX,IAAgB//E,UAA/B,EAA2C+/E,WAAW,CAAX,IAAgB//E,UAA3D;AACAtoB,UAAQg/F,IAAR;AACA,8BAAeh/F,OAAf,EAAwB48B,QAAxB,EAAkCpJ,QAAQ,CAA1C,EAA6CC,SAAS,CAAtD;AACD,CAxBD;;AA2BA;;;;;;;AAOA+zE,oBAAoBtuF,SAApB,CAA8BovF,qBAA9B,GAAsD,UAAShpG,IAAT,EAAeU,OAAf,EAAwBkwB,UAAxB,EAAoCq4E,aAApC,EAAmD;AACvG,MAAMvrG,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAIjyE,MAAMo5C,WAAN,CAAkB92C,IAAlB,CAAJ,EAA6B;AAC3B,QAAMk0B,QAAQtD,WAAWjN,IAAX,CAAgB,CAAhB,IAAqBiN,WAAW5H,UAA9C;AACA,QAAMmL,SAASvD,WAAWjN,IAAX,CAAgB,CAAhB,IAAqBiN,WAAW5H,UAA/C;AACA,QAAMsU,WAAW1M,WAAW+L,SAAX,CAAqBW,QAAtC;AACA,gCAAe58B,OAAf,EAAwB,CAAC48B,QAAzB,EAAmCpJ,QAAQ,CAA3C,EAA8CC,SAAS,CAAvD;AACA,QAAMoc,YAAY04D,kBAAkB3oG,SAAlB,GAChB2oG,aADgB,GACA,KAAKtmB,YAAL,CAAkB/xD,UAAlB,EAA8B,CAA9B,CADlB;AAEA,QAAM6K,SAAS,IAAI+zD,mBAAJ,CACb9uF,OADa,EACJkwB,WAAW5H,UADP,EACmB4H,WAAW9H,MAD9B,EACsCynB,SADtC,EAEb3f,WAAW+L,SAAX,CAAqBW,QAFR,CAAf;AAGA,QAAM4rE,eAAe,IAAIxhB,eAAJ,CAAgB1nF,IAAhB,EAAsBy7B,MAAtB,EAA8B7K,UAA9B,EACnBlwB,OADmB,EACV,IADU,CAArB;AAEAhD,UAAMuoB,aAAN,CAAoBijF,YAApB;AACA,gCAAexoG,OAAf,EAAwB48B,QAAxB,EAAkCpJ,QAAQ,CAA1C,EAA6CC,SAAS,CAAtD;AACD;AACF,CAjBD;;AAoBA;;;;;;;;;AASA+zE,oBAAoBtuF,SAApB,CAA8B+uF,wBAA9B,GAAyD,UAASx7E,UAAT,EAAqByD,UAArB,EAAiC6G,QAAjC,EAA2CW,OAA3C,EAAoD;AAC3G,MAAM2tE,aAAa,KAAKluE,0BAAL,CAAgC1K,UAAhC,EAA4CyD,UAA5C,EAAwD,CAAxD,EAA2DgH,eAA3D,EAAiE,IAAjE,CAAnB;;AAEA,MAAImuE,UAAJ,EAAgB;AACd,WAAOtuE,SAASxc,IAAT,CAAcmd,OAAd,EAAuB,KAAKu3C,QAAL,EAAvB,EAAwC,IAAxC,CAAP;AACD,GAFD,MAEO;AACL,WAAOrvE,SAAP;AACD;AACF,CARD;;AAWA;;;;;;;AAOA4nG,oBAAoBtuF,SAApB,CAA8B8uF,WAA9B,GAA4C,UAAShoG,OAAT,EAAkBkwB,UAAlB,EAA8B4d,UAA9B,EAA0Cy6D,aAA1C,EAAyD;AACnG,OAAKD,qBAAL,CAA2BrzB,oBAAgBqS,WAA3C,EAAwDtnF,OAAxD,EAAiEkwB,UAAjE,EAA6Eq4E,aAA7E;AACD,CAFD;;AAKA;;;;;;AAMAf,oBAAoBtuF,SAApB,CAA8ByuF,UAA9B,GAA2C,UAAS3nG,OAAT,EAAkBkwB,UAAlB,EAA8Bq4E,aAA9B,EAA6C;AACtF,OAAKD,qBAAL,CAA2BrzB,oBAAgBC,UAA3C,EAAuDl1E,OAAvD,EAAgEkwB,UAAhE,EAA4Eq4E,aAA5E;AACD,CAFD;;AAKA;;;;;;AAMAf,oBAAoBtuF,SAApB,CAA8BuvF,mBAA9B,GAAoD,UAASzoG,OAAT,EAAkBkwB,UAAlB,EAA8Bq4E,aAA9B,EAA6C;AAC/F,OAAKD,qBAAL,CAA2BrzB,oBAAgBsS,MAA3C,EAAmDvnF,OAAnD,EAA4DkwB,UAA5D,EAAwEq4E,aAAxE;AACD,CAFD;;AAKA;;;;;;AAMAf,oBAAoBtuF,SAApB,CAA8B+oE,YAA9B,GAA6C,UAAS/xD,UAAT,EAAqB67D,OAArB,EAA8B;AACzE,MAAM9vD,YAAY/L,WAAW+L,SAA7B;AACA,MAAM3T,aAAa4H,WAAW5H,UAA9B;AACA,MAAMqqC,MAAMrqC,aAAa4H,WAAWjN,IAAX,CAAgB,CAAhB,CAAb,GAAkC,CAA9C;AACA,MAAM2vC,MAAMtqC,aAAa4H,WAAWjN,IAAX,CAAgB,CAAhB,CAAb,GAAkC,CAA9C;AACA,MAAM2hC,KAAKt8B,aAAa2T,UAAU5T,UAAlC;AACA,MAAM4kC,KAAK,CAACrI,EAAZ;AACA,MAAM9R,QAAQ,CAAC7W,UAAUW,QAAzB;AACA,MAAMi2B,MAAM,CAAC52B,UAAUp+B,MAAV,CAAiB,CAAjB,CAAD,GAAuBkuF,OAAnC;AACA,MAAMj5B,MAAM,CAAC72B,UAAUp+B,MAAV,CAAiB,CAAjB,CAAb;AACA,SAAO,wBAAiB,KAAKoxF,UAAtB,EAAkCt8B,GAAlC,EAAuCC,GAAvC,EAA4ChO,EAA5C,EAAgDqI,EAAhD,EAAoDna,KAApD,EAA2D+f,GAA3D,EAAgEC,GAAhE,CAAP;AACD,CAXD;;AAcA;;;;;;AAMA00C,oBAAoBtuF,SAApB,CAA8BwuF,YAA9B,GAA6C,UAASx3E,UAAT,EAAqB4d,UAArB,EAAiC9tC,OAAjC,EAA0C,CAAE,CAAzF;;AAEA;;;;;;AAMAwnG,oBAAoBtuF,SAApB,CAA8BstF,YAA9B,GAA6C,UAASt2E,UAAT,EAAqB4d,UAArB,EAAiC,CAAE,CAAhF;kBACe05D,mB;;;;;;;;;;;;;;;;;;;AC1Lf;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;;;AAGA;;;AAjBA;;;AAoBO,IAAMnB,gEAA4B,EAAlC;;AAGP;;;;;;AAMA,IAAM16E,oBAAoB,SAApBA,iBAAoB,CAASnuB,GAAT,EAAc;AACtCymG,gBAAY1pF,IAAZ,CAAiB,IAAjB,EAAuB/c,GAAvB;;AAEA,MAAM2gF,YAAY3gF,IAAI+vB,WAAJ,EAAlB;;AAEA;;;;AAIA,OAAKyhE,QAAL,GAAgB,iCAAhB;;AAEA;;;;AAIA,OAAKzlE,OAAL,GAAe,KAAKylE,QAAL,CAAc/lE,MAA7B;;AAEA,OAAKM,OAAL,CAAanG,KAAb,CAAmBoQ,KAAnB,GAA2B,MAA3B;AACA,OAAKjK,OAAL,CAAanG,KAAb,CAAmBqQ,MAAnB,GAA4B,MAA5B;AACA,OAAKlK,OAAL,CAAanG,KAAb,CAAmBirB,OAAnB,GAA6B,OAA7B;AACA,OAAK9kB,OAAL,CAAa6J,SAAb,GAAyBia,uBAAzB;AACA8wC,YAAUuqB,YAAV,CAAuB,KAAKn/E,OAA5B,EAAqC40D,UAAUwqB,UAAV,CAAqB,CAArB,KAA2B,IAAhE;;AAEA;;;;AAIA,OAAKj7D,gBAAL,GAAwB,IAAxB;;AAEA;;;;AAIA,OAAKuhD,UAAL,GAAkB,wBAAlB;AAED,CAnCD;;AAqCA,qBAAStjE,iBAAT,EAA4Bs4E,aAA5B;;AAGA;;;;;AAKAt4E,kBAAkBzS,SAAlB,CAA4BovF,qBAA5B,GAAoD,UAAShpG,IAAT,EAAe4wB,UAAf,EAA2B;AAC7E,MAAM1yB,MAAM,KAAKyxC,MAAL,EAAZ;AACA,MAAMjvC,UAAU,KAAKgvF,QAArB;AACA,MAAIxxF,IAAI44C,WAAJ,CAAgB92C,IAAhB,CAAJ,EAA2B;AACzB,QAAM8oB,SAAS8H,WAAW9H,MAA1B;AACA,QAAME,aAAa4H,WAAW5H,UAA9B;AACA,QAAM2T,YAAY/L,WAAW+L,SAA7B;AACA,QAAMW,WAAWX,UAAUW,QAA3B;;AAEA,QAAMiT,YAAY,KAAKoyC,YAAL,CAAkB/xD,UAAlB,CAAlB;;AAEA,QAAMk3D,gBAAgB,IAAI0H,mBAAJ,CAA4B9uF,OAA5B,EAAqCsoB,UAArC,EACpBF,MADoB,EACZynB,SADY,EACDjT,QADC,CAAtB;AAEA,QAAM4rE,eAAe,IAAIxhB,eAAJ,CAAgB1nF,IAAhB,EAAsB8nF,aAAtB,EACnBl3D,UADmB,EACPlwB,OADO,EACE,IADF,CAArB;AAEAxC,QAAI+nB,aAAJ,CAAkBijF,YAAlB;AACD;AACF,CAjBD;;AAoBA;;;;;AAKA78E,kBAAkBzS,SAAlB,CAA4B+oE,YAA5B,GAA2C,UAAS/xD,UAAT,EAAqB;AAC9D,MAAM+L,YAAY/L,WAAW+L,SAA7B;AACA,MAAM02B,MAAM,KAAKppC,OAAL,CAAaiK,KAAb,GAAqB,CAAjC;AACA,MAAMo/B,MAAM,KAAKrpC,OAAL,CAAakK,MAAb,GAAsB,CAAlC;AACA,MAAMmxB,KAAK10B,WAAW5H,UAAX,GAAwB2T,UAAU5T,UAA7C;AACA,MAAM4kC,KAAK,CAACrI,EAAZ;AACA,MAAM9R,QAAQ,CAAC7W,UAAUW,QAAzB;AACA,MAAMi2B,MAAM,CAAC52B,UAAUp+B,MAAV,CAAiB,CAAjB,CAAb;AACA,MAAMi1D,MAAM,CAAC72B,UAAUp+B,MAAV,CAAiB,CAAjB,CAAb;AACA,SAAO,wBAAiB,KAAKoxF,UAAtB,EAAkCt8B,GAAlC,EAAuCC,GAAvC,EAA4ChO,EAA5C,EAAgDqI,EAAhD,EAAoDna,KAApD,EAA2D+f,GAA3D,EAAgEC,GAAhE,CAAP;AACD,CAVD;;AAaA;;;AAGAnnC,kBAAkBzS,SAAlB,CAA4B2jB,WAA5B,GAA0C,UAAS3M,UAAT,EAAqB;;AAE7D,MAAI,CAACA,UAAL,EAAiB;AACf,QAAI,KAAKwd,gBAAT,EAA2B;AACzB,WAAKnkB,OAAL,CAAanG,KAAb,CAAmBirB,OAAnB,GAA6B,MAA7B;AACA,WAAKX,gBAAL,GAAwB,KAAxB;AACD;AACD;AACD;;AAED,MAAM1tC,UAAU,KAAKgvF,QAArB;AACA,MAAM1mE,aAAa4H,WAAW5H,UAA9B;AACA,MAAMkL,QAAQzwB,KAAKoH,KAAL,CAAW+lB,WAAWjN,IAAX,CAAgB,CAAhB,IAAqBqF,UAAhC,CAAd;AACA,MAAMmL,SAAS1wB,KAAKoH,KAAL,CAAW+lB,WAAWjN,IAAX,CAAgB,CAAhB,IAAqBqF,UAAhC,CAAf;AACA,MAAI,KAAKiB,OAAL,CAAaiK,KAAb,IAAsBA,KAAtB,IAA+B,KAAKjK,OAAL,CAAakK,MAAb,IAAuBA,MAA1D,EAAkE;AAChE,SAAKlK,OAAL,CAAaiK,KAAb,GAAqBA,KAArB;AACA,SAAKjK,OAAL,CAAakK,MAAb,GAAsBA,MAAtB;AACD,GAHD,MAGO;AACLzzB,YAAQy/F,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwBjsE,KAAxB,EAA+BC,MAA/B;AACD;;AAED,MAAMmJ,WAAW1M,WAAW+L,SAAX,CAAqBW,QAAtC;;AAEA,OAAK2nE,mBAAL,CAAyBr0E,UAAzB;;AAEA,OAAKo4E,qBAAL,CAA2BrzB,oBAAgBC,UAA3C,EAAuDhlD,UAAvD;;AAEA,MAAMmM,mBAAmBnM,WAAWmM,gBAApC;AACA,yBAAWA,gBAAX,EAA6B2nE,iBAA7B;;AAEA,MAAIpnE,QAAJ,EAAc;AACZ58B,YAAQsgG,IAAR;AACA,gCAAetgG,OAAf,EAAwB48B,QAAxB,EAAkCpJ,QAAQ,CAA1C,EAA6CC,SAAS,CAAtD;AACD;;AAED,MAAMmxE,iBAAiB10E,WAAW+L,SAAX,CAAqB5T,UAA5C;AACA,MAAIrpB,UAAJ;AAAA,MAAOwkB,WAAP;AAAA,MAAWxmB,cAAX;AAAA,MAAkBkoG,sBAAlB;AAAA,MAAiCp3D,mBAAjC;AACA,OAAK9uC,IAAI,CAAJ,EAAOwkB,KAAK6Y,iBAAiBp9B,MAAlC,EAA0CD,IAAIwkB,EAA9C,EAAkD,EAAExkB,CAApD,EAAuD;AACrD8uC,iBAAazR,iBAAiBr9B,CAAjB,CAAb;AACAhC,YAAQ8wC,WAAW9wC,KAAnB;AACAkoG,oBAAgB,8CAAgD,KAAKC,gBAAL,CAAsBnoG,KAAtB,CAAhE;AACA,QAAI,CAAC,gCAAoB8wC,UAApB,EAAgC82D,cAAhC,CAAD,IACA92D,WAAW8kC,WAAX,IAA0B0B,gBAAYC,KAD1C,EACiD;AAC/C;AACD;AACD,QAAI2wB,cAAcsB,YAAd,CAA2Bt2E,UAA3B,EAAuC4d,UAAvC,CAAJ,EAAwD;AACtDo3D,oBAAcwC,YAAd,CAA2Bx3E,UAA3B,EAAuC4d,UAAvC,EAAmD9tC,OAAnD;AACD;AACF;;AAED,MAAI48B,QAAJ,EAAc;AACZ58B,YAAQwgG,OAAR;AACD;;AAED,OAAK8H,qBAAL,CAA2BrzB,oBAAgBqS,WAA3C,EAAwDp3D,UAAxD;;AAEA,MAAI,CAAC,KAAKwd,gBAAV,EAA4B;AAC1B,SAAKnkB,OAAL,CAAanG,KAAb,CAAmBirB,OAAnB,GAA6B,EAA7B;AACA,SAAKX,gBAAL,GAAwB,IAAxB;AACD;;AAED,OAAKm4D,kCAAL,CAAwC31E,UAAxC;AACA,OAAK01E,uBAAL,CAA6B11E,UAA7B;AACD,CA/DD;;AAkEA;;;AAGAvE,kBAAkBzS,SAAlB,CAA4Boe,mBAA5B,GAAkD,UAAS/K,KAAT,EAAgB2D,UAAhB,EAA4B6G,QAA5B,EAAsCW,OAAtC,EAChDT,WADgD,EACnCU,QADmC,EACzB;AACvB,MAAIp5B,eAAJ;AACA,MAAM09B,YAAY/L,WAAW+L,SAA7B;AACA,MAAM2oE,iBAAiB3oE,UAAU5T,UAAjC;;AAEA,MAAMkU,cAAcrM,WAAWmM,gBAA/B;AACA,MAAM4oE,YAAY1oE,YAAYt9B,MAA9B;;AAEA,MAAMwtB,aAAa,sBACjByD,WAAWsI,0BADM,EACsBjM,MAAM1tB,KAAN,EADtB,CAAnB;;AAGA,MAAIG,UAAJ;AACA,OAAKA,IAAIimG,YAAY,CAArB,EAAwBjmG,KAAK,CAA7B,EAAgC,EAAEA,CAAlC,EAAqC;AACnC,QAAM8uC,aAAavR,YAAYv9B,CAAZ,CAAnB;AACA,QAAMhC,QAAQ8wC,WAAW9wC,KAAzB;AACA,QAAI,gCAAoB8wC,UAApB,EAAgC82D,cAAhC,KAAmD3tE,YAAY1c,IAAZ,CAAiBod,QAAjB,EAA2B36B,KAA3B,CAAvD,EAA0F;AACxF,UAAMkoG,gBAAgB,8CAAgD,KAAKC,gBAAL,CAAsBnoG,KAAtB,CAAtE;AACAuB,eAAS2mG,cAAc+C,wBAAd,CACPx7E,UADO,EACKyD,UADL,EACiB6G,QADjB,EAC2BW,OAD3B,CAAT;AAEA,UAAIn5B,MAAJ,EAAY;AACV,eAAOA,MAAP;AACD;AACF;AACF;AACD,SAAOqB,SAAP;AACD,CA1BD;;AA6BA;;;AAGA+rB,kBAAkBzS,SAAlB,CAA4B0S,sBAA5B,GAAqD,UAASy4E,YAAT,EAAuB;AAC1EJ,gBAAY/qF,SAAZ,CAAsB0S,sBAAtB,CAA6CrR,IAA7C,CAAkD,IAAlD,EAAwD8pF,YAAxD;AACA,OAAK,IAAIrlG,IAAI,CAAR,EAAWwkB,KAAK6gF,aAAaplG,MAAlC,EAA0CD,IAAIwkB,EAA9C,EAAkD,EAAExkB,CAApD,EAAuD;AACrD,QAAMsiB,OAAO+iF,aAAarlG,CAAb,CAAb;AACA,QAAI,CAAC,qBAASqnG,yBAAT,EAAoC/kF,IAApC,CAAL,EAAgD;AAC9C+kF,gCAA0BrlG,IAA1B,CAA+BsgB,IAA/B;AACD;AACF;AACF,CARD;;kBAUeqK,iB;;;;;;;;;;;;;;;;;;AC/Nf;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AAEA;;;;;;AAMA,IAAMG,0BAA0B,SAA1BA,uBAA0B,CAAS88E,SAAT,EAAoB;;AAElD3C,+BAA2B1rF,IAA3B,CAAgC,IAAhC,EAAsCquF,SAAtC;;AAEA;;;;AAIA,OAAK5oG,OAAL,GAAe,KAAKA,OAAL,KAAiB,IAAjB,GAAwB,IAAxB,GAA+B,iCAA9C;;AAEA;;;;AAIA,OAAK6oG,aAAL;;AAEA;;;;AAIA,OAAKC,eAAL,GAAuB,IAAvB;;AAEA;;;;AAIA,OAAKC,gBAAL;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,EAArB;;AAEA;;;;AAIA,OAAKC,SAAL,GAAiB,KAAjB;;AAEA;;;;AAIA,OAAK3Q,SAAL,GAAiB,0BAAjB;;AAEA;;;;AAIA,OAAK4Q,aAAL,GAAqB,IAAIpqE,mBAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,CAArB;;AAEA;;;;AAIA,OAAKonE,eAAL,GAAuB,wBAAvB;;AAEA;;;;AAIA,OAAKiD,UAAL,GAAkB,CAAlB;AAED,CAhED,C,CAnBA;;;;;AAqFA,qBAASr9E,uBAAT,EAAkCm6E,4BAAlC;;AAGA;;;;;AAKAn6E,wBAAwB,SAAxB,IAAqC,UAAS9uB,KAAT,EAAgB;AACnD,SAAOA,MAAMob,OAAN,OAAoBy9D,oBAAU1qD,IAArC;AACD,CAFD;;AAKA;;;;;;AAMAW,wBAAwB,QAAxB,IAAoC,UAASw6E,WAAT,EAAsBtpG,KAAtB,EAA6B;AAC/D,SAAO,IAAI8uB,uBAAJ,EAA4B,mCAAqC9uB,KAAjE,CAAP;AACD,CAFD;;AAKA;;;;;AAKA8uB,wBAAwB5S,SAAxB,CAAkCkwF,eAAlC,GAAoD,UAASnwE,IAAT,EAAe;AACjE,MAAMowE,YAAYpwE,KAAKnQ,QAAL,EAAlB;AACA,MAAMwgF,yBAAyB,KAAKr6B,QAAL,GAAgBs6B,yBAAhB,EAA/B;AACA,SAAOF,aAAahrE,oBAAU/U,MAAvB,IACH+/E,aAAahrE,oBAAUC,KADpB,IAEH+qE,aAAahrE,oBAAU1U,KAAvB,IAAgC,CAAC2/E,sBAFrC;AAGD,CAND;;AASA;;;;;;;;AAQAx9E,wBAAwB5S,SAAxB,CAAkC0qF,OAAlC,GAA4C,UAAS/vF,CAAT,EAAYzK,CAAZ,EAAe+N,CAAf,EAAkBmR,UAAlB,EAA8BgY,UAA9B,EAA0C;AACpF,MAAMtjC,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAM9xE,SAAS,oCAAsCH,MAAM+wC,SAAN,EAArD;AACA,MAAI9U,OAAO97B,OAAOymG,OAAP,CAAe/vF,CAAf,EAAkBzK,CAAlB,EAAqB+N,CAArB,EAAwBmR,UAAxB,EAAoCgY,UAApC,CAAX;AACA,MAAIrH,KAAKnQ,QAAL,MAAmBuV,oBAAU1U,KAAjC,EAAwC;AACtC,QAAI,CAAC3sB,MAAMusG,yBAAN,EAAL,EAAwC;AACtC;AACAtwE,WAAKuwE,QAAL,CAAcnrE,oBAAU/U,MAAxB;AACD,KAHD,MAGO,IAAItsB,MAAMysG,UAAN,KAAqB,CAAzB,EAA4B;AACjC;AACA,WAAKR,SAAL,GAAiB,IAAjB;AACD;AACF;AACD,MAAI,CAAC,KAAKG,eAAL,CAAqBnwE,IAArB,CAAL,EAAiC;AAC/BA,WAAOA,KAAKywE,cAAL,EAAP;AACD;AACD,SAAOzwE,IAAP;AACD,CAjBD;;AAmBA;;;AAGAnN,wBAAwB5S,SAAxB,CAAkCstF,YAAlC,GAAiD,UAASt2E,UAAT,EAAqB4d,UAArB,EAAiC;;AAEhF,MAAMxlB,aAAa4H,WAAW5H,UAA9B;AACA,MAAMrF,OAAOiN,WAAWjN,IAAxB;AACA,MAAMgZ,YAAY/L,WAAW+L,SAA7B;AACA,MAAMqE,aAAarE,UAAUqE,UAA7B;AACA,MAAMskE,iBAAiB3oE,UAAU5T,UAAjC;AACA,MAAMo+E,aAAaxqE,UAAUp+B,MAA7B;;AAEA,MAAM+qG,YAAY,KAAK35B,QAAL,EAAlB;AACA,MAAMk0B,aAAa,oCAAsCyF,UAAU76D,SAAV,EAAzD;AACA,MAAM47D,iBAAiBxG,WAAWzxE,WAAX,EAAvB;AACA,MAAMilD,WAAWwsB,WAAWyG,wBAAX,CAAoCtpE,UAApC,CAAjB;AACA,MAAMzsB,IAAI8iE,SAASC,iBAAT,CAA2BguB,cAA3B,EAA2C,KAAKuE,UAAhD,CAAV;AACA,MAAM/vE,iBAAiBu9C,SAAS9tD,aAAT,CAAuBhV,CAAvB,CAAvB;AACA,MAAIg2F,eAAe9mG,KAAKoH,KAAL,CAAWy6F,iBAAiBxrE,cAA5B,KAA+C,CAAlE;AACA,MAAIhR,SAAS8H,WAAW9H,MAAxB;;AAEA,MAAI0lB,WAAW1lB,MAAX,KAAsBxoB,SAA1B,EAAqC;AACnCwoB,aAAS,6BAAgBA,MAAhB,EAAwB0lB,WAAW1lB,MAAnC,CAAT;AACD;AACD,MAAI,qBAAQA,MAAR,CAAJ,EAAqB;AACnB;AACA,WAAO,KAAP;AACD;;AAED,MAAM+W,YAAYw3C,SAASE,yBAAT,CAAmCzuD,MAAnC,EAA2CvU,CAA3C,CAAlB;AACA,MAAMszF,cAAcxwB,SAASmzB,kBAAT,CAA4Bj2F,CAA5B,EAA+BsrB,SAA/B,CAApB;;AAEA,MAAM4qE,iBAAiB5G,WAAW6G,iBAAX,CAA6B1hF,UAA7B,CAAvB;;AAEA;;;AAGA,MAAM2hF,iBAAiB,EAAvB;AACAA,iBAAep2F,CAAf,IAAoB,EAApB;;AAEA,MAAMq2F,kBAAkB,KAAKvH,sBAAL,CACtBQ,UADsB,EACV7iE,UADU,EACE2pE,cADF,CAAxB;;AAGA,MAAM3vE,QAAQpK,WAAWqK,SAAzB;AACA,MAAM4vE,yBAAyB7vE,MAAME,mBAASC,SAAf,KAA6BH,MAAME,mBAASE,WAAf,CAA5D;;AAEA,MAAM49D,YAAY,KAAKA,SAAvB;AACA,MAAM8R,eAAe,KAAKlB,aAA1B;AACA,OAAKD,SAAL,GAAiB,KAAjB;AACA,MAAIhwE,aAAJ;AAAA,MAAU7vB,UAAV;AAAA,MAAa+N,UAAb;AACA,OAAK/N,IAAI+1B,UAAUJ,IAAnB,EAAyB31B,KAAK+1B,UAAUH,IAAxC,EAA8C,EAAE51B,CAAhD,EAAmD;AACjD,SAAK+N,IAAIgoB,UAAUF,IAAnB,EAAyB9nB,KAAKgoB,UAAUD,IAAxC,EAA8C,EAAE/nB,CAAhD,EAAmD;AACjD,UAAIsT,KAAKC,GAAL,KAAawF,WAAW8L,IAAxB,GAA+B,EAA/B,IAAqCmuE,sBAAzC,EAAiE;AAC/D;AACD;AACDlxE,aAAO,KAAK2qE,OAAL,CAAa/vF,CAAb,EAAgBzK,CAAhB,EAAmB+N,CAAnB,EAAsBmR,UAAtB,EAAkCgY,UAAlC,CAAP;AACA,UAAI,KAAK8oE,eAAL,CAAqBnwE,IAArB,CAAJ,EAAgC;AAC9B,YAAMiwC,MAAM,mBAAO,IAAP,CAAZ;AACA,YAAIjwC,KAAKnQ,QAAL,MAAmBuV,oBAAU/U,MAAjC,EAAyC;AACvC2gF,yBAAep2F,CAAf,EAAkBolB,KAAKoG,SAAL,CAAex9B,QAAf,EAAlB,IAA+Co3B,IAA/C;AACA,cAAMoxE,eAAepxE,KAAKoxE,YAAL,CAAkBnhC,GAAlB,CAArB;AACA,cAAI,CAAC,KAAK+/B,SAAN,KAAoBoB,gBAAgB,KAAKrB,aAAL,CAAmB3+F,OAAnB,CAA2B4uB,IAA3B,MAAqC,CAAC,CAA1E,CAAJ,EAAkF;AAChF,iBAAKgwE,SAAL,GAAiB,IAAjB;AACD;AACF;AACD,YAAIhwE,KAAKqxE,QAAL,CAAcphC,GAAd,EAAmBh5C,WAAW8L,IAA9B,MAAwC,CAA5C,EAA+C;AAC7C;AACA;AACD;AACF;;AAED,UAAMuuE,iBAAiB5zB,SAAS6zB,0BAAT,CACrBvxE,KAAKoG,SADgB,EACL+qE,YADK,EACS9R,SADT,CAAvB;AAEA,UAAImS,UAAU,KAAd;AACA,UAAIF,cAAJ,EAAoB;AAClBE,kBAAUP,gBAAgBr2F,IAAI,CAApB,EAAuB02F,cAAvB,CAAV;AACD;AACD,UAAI,CAACE,OAAL,EAAc;AACZ9zB,iBAAS+zB,+BAAT,CACEzxE,KAAKoG,SADP,EACkB6qE,eADlB,EACmC,IADnC,EACyCE,YADzC,EACuD9R,SADvD;AAED;AAEF;AACF;;AAED,MAAMiP,qBAAqBnuE,iBAAiB9Q,UAAjB,GAA8ByhF,cAA9B,GAA+CF,YAA1E;AACA,MAAI,EAAE,KAAKtC,kBAAL,IAA2B98E,KAAKC,GAAL,KAAawF,WAAW8L,IAAxB,GAA+B,EAA1D,IAAgEmuE,sBAAlE,MACF,KAAKlB,SAAL,IACI,EAAE,KAAKH,eAAL,IAAwB,4BAAe,KAAKA,eAApB,EAAqC1gF,MAArC,CAA1B,CADJ,IAEI,KAAK2gF,gBAAL,IAAyBY,cAF7B,IAGIE,gBAAgB,KAAKhB,aAHzB,IAII,CAACsB,sBAAD,IAA2B5C,sBAAsB,KAAKA,kBALxD,CAAJ,EAMG;;AAED,QAAMvnG,UAAU,KAAKA,OAArB;AACA,QAAIA,OAAJ,EAAa;AACX,UAAM2qG,gBAAgBxH,WAAWyH,gBAAX,CAA4B/2F,CAA5B,EAA+ByU,UAA/B,EAA2CgY,UAA3C,CAAtB;AACA,UAAM9M,QAAQzwB,KAAKoH,KAAL,CAAWg1B,UAAUO,QAAV,KAAuBirE,cAAc,CAAd,CAAvB,GAA0Cd,YAArD,CAAd;AACA,UAAMp2E,SAAS1wB,KAAKoH,KAAL,CAAWg1B,UAAUM,SAAV,KAAwBkrE,cAAc,CAAd,CAAxB,GAA2Cd,YAAtD,CAAf;AACA,UAAM5gF,SAASjpB,QAAQipB,MAAvB;AACA,UAAIA,OAAOuK,KAAP,IAAgBA,KAAhB,IAAyBvK,OAAOwK,MAAP,IAAiBA,MAA9C,EAAsD;AACpD,aAAKo1E,aAAL,GAAqBgB,YAArB;AACA5gF,eAAOuK,KAAP,GAAeA,KAAf;AACAvK,eAAOwK,MAAP,GAAgBA,MAAhB;AACD,OAJD,MAIO;AACL,YAAI,KAAKq1E,eAAL,IAAwB,CAAC,oBAAO3B,WAAP,EAAoB,KAAK2B,eAAzB,CAA7B,EAAwE;AACtE9oG,kBAAQy/F,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwBjsE,KAAxB,EAA+BC,MAA/B;AACD;AACDo2E,uBAAe,KAAKhB,aAApB;AACD;AACF;;AAED,SAAKG,aAAL,CAAmB/pG,MAAnB,GAA4B,CAA5B;AACA;AACA,QAAM0/F,KAAK7/F,OAAO6N,IAAP,CAAYs9F,cAAZ,EAA4BzsG,GAA5B,CAAgCuH,MAAhC,CAAX;AACA45F,OAAG/xF,IAAH,CAAQ,UAAS1F,CAAT,EAAYD,CAAZ,EAAe;AACrB,UAAIC,MAAM2M,CAAV,EAAa;AACX,eAAO,CAAP;AACD,OAFD,MAEO,IAAI5M,MAAM4M,CAAV,EAAa;AAClB,eAAO,CAAC,CAAR;AACD,OAFM,MAEA;AACL,eAAO3M,IAAID,CAAJ,GAAQ,CAAR,GAAYC,IAAID,CAAJ,GAAQ,CAAC,CAAT,GAAa,CAAhC;AACD;AACF,KARD;AASA,QAAIs9B,0BAAJ;AAAA,QAAuBsmE,qBAAvB;AAAA,QAAqCC,6BAArC;AAAA,QAA2DrH,iBAA3D;AAAA,QAAqEzkG,UAArE;AAAA,QAAwEwkB,WAAxE;AACA,QAAIunF,mBAAJ;AAAA,QAAgBC,mBAAhB;AAAA,QAA4BC,oBAA5B;AAAA,QAAyCrnF,UAAzC;AAAA,QAA4ClM,UAA5C;AACA,SAAK1Y,IAAI,CAAJ,EAAOwkB,KAAKm7E,GAAG1/F,MAApB,EAA4BD,IAAIwkB,EAAhC,EAAoC,EAAExkB,CAAtC,EAAyC;AACvCykG,iBAAW9E,GAAG3/F,CAAH,CAAX;AACA8rG,6BAAuB3H,WAAWyH,gBAAX,CAA4BnH,QAA5B,EAAsCn7E,UAAtC,EAAkDgY,UAAlD,CAAvB;AACAiE,0BAAoBoyC,SAAS9tD,aAAT,CAAuB46E,QAAvB,CAApB;AACAoH,qBAAetmE,oBAAoBnL,cAAnC;AACA4xE,mBAAajB,iBAAiB5G,WAAW+H,SAAX,CAAqB5qE,UAArB,CAA9B;AACA2qE,oBAAchB,eAAexG,QAAf,CAAd;AACA,WAAK,IAAM0H,YAAX,IAA2BF,WAA3B,EAAwC;AACtChyE,eAAOgyE,YAAYE,YAAZ,CAAP;AACAJ,qBAAap0B,SAASI,kBAAT,CAA4B99C,KAAKmyE,YAAL,EAA5B,EAAiD9S,SAAjD,CAAb;AACAlvF,YAAI,CAAC2hG,WAAW,CAAX,IAAgB5D,YAAY,CAAZ,CAAjB,IAAmC/tE,cAAnC,GAAoD2wE,cAApD,GAAqEF,YAAzE;AACA1yF,YAAI,CAACgwF,YAAY,CAAZ,IAAiB4D,WAAW,CAAX,CAAlB,IAAmC3xE,cAAnC,GAAoD2wE,cAApD,GAAqEF,YAAzE;AACAjmF,YAAIknF,qBAAqB,CAArB,IAA0BD,YAA1B,GAAyChB,YAA7C;AACAnyF,YAAIozF,qBAAqB,CAArB,IAA0BD,YAA1B,GAAyChB,YAA7C;AACA,aAAKwB,aAAL,CAAmBpyE,IAAnB,EAAyB/I,UAAzB,EAAqC4d,UAArC,EAAiD1kC,CAAjD,EAAoD+N,CAApD,EAAuDyM,CAAvD,EAA0DlM,CAA1D,EAA6DszF,UAA7D,EAAyEn3F,MAAM4vF,QAA/E;AACA,aAAKuF,aAAL,CAAmBhoG,IAAnB,CAAwBi4B,IAAxB;AACD;AACF;;AAED,SAAK8vE,gBAAL,GAAwBY,cAAxB;AACA,SAAKpC,kBAAL,GAA0BnuE,iBAAiB9Q,UAAjB,GAA8ByhF,cAA9B,GAA+CF,YAAzE;AACA,SAAKf,eAAL,GAAuB3B,WAAvB;AACD;;AAED,MAAM71D,QAAQ,KAAKi2D,kBAAL,GAA0B3C,cAAxC;AACA,MAAM/0D,YAAY,wBAAiB,KAAKq2D,eAAtB,EAChB59E,aAAarF,KAAK,CAAL,CAAb,GAAuB,CADP,EACUqF,aAAarF,KAAK,CAAL,CAAb,GAAuB,CADjC,EAEhBquB,KAFgB,EAETA,KAFS,EAGhB,CAHgB,EAIhB,CAAC,KAAKw3D,eAAL,CAAqB,CAArB,IAA0BrC,WAAW,CAAX,CAA3B,IAA4C,KAAKc,kBAAjD,GAAsEj/E,UAJtD,EAKhB,CAACm+E,WAAW,CAAX,IAAgB,KAAKqC,eAAL,CAAqB,CAArB,CAAjB,IAA4C,KAAKvB,kBAAjD,GAAsEj/E,UALtD,CAAlB;AAMA,0BAAiB,KAAKg/E,gCAAtB,EACEh/E,aAAarF,KAAK,CAAL,CAAb,GAAuB,CAAvB,GAA2B4sB,UAAU,CAAV,CAD7B,EAC2CvnB,aAAarF,KAAK,CAAL,CAAb,GAAuB,CAAvB,GAA2B4sB,UAAU,CAAV,CADtE,EAEEvnB,aAAas8E,cAFf,EAE+B,CAACt8E,UAAD,GAAcs8E,cAF7C,EAGE,CAHF,EAIE,CAAC6B,WAAW,CAAX,CAJH,EAIkB,CAACA,WAAW,CAAX,CAJnB;;AAOA,OAAKlD,eAAL,CAAqBrzE,WAAWyM,SAAhC,EAA2CwmE,UAA3C,EAAuDtvF,CAAvD,EAA0DsrB,SAA1D;AACA,OAAKqkE,iBAAL,CAAuBtzE,UAAvB,EAAmCizE,UAAnC,EAA+CxsB,QAA/C,EAAyDruD,UAAzD,EACEgY,UADF,EACclY,MADd,EACsBvU,CADtB,EACyB+0F,UAAUa,UAAV,EADzB;AAEA,OAAKvG,mBAAL,CAAyBhzE,UAAzB,EAAqCizE,UAArC;;AAEA,SAAO,KAAK6F,aAAL,CAAmB/pG,MAAnB,GAA4B,CAAnC;AACD,CAvKD;;AA0KA;;;;;;;;;;;AAWA6sB,wBAAwB5S,SAAxB,CAAkCmyF,aAAlC,GAAkD,UAASpyE,IAAT,EAAe/I,UAAf,EAA2B4d,UAA3B,EAAuC1kC,CAAvC,EAA0C+N,CAA1C,EAA6CyM,CAA7C,EAAgDlM,CAAhD,EAAmD4zF,MAAnD,EAA2DC,UAA3D,EAAuE;AACvH,MAAMrf,QAAQjzD,KAAKtQ,QAAL,CAAc,KAAKsmD,QAAL,EAAd,CAAd;AACA,MAAI,CAACid,KAAL,EAAY;AACV;AACD;AACD,MAAMhjB,MAAM,mBAAO,IAAP,CAAZ;AACA,MAAM/hE,QAAQokG,aAAatyE,KAAKqxE,QAAL,CAAcphC,GAAd,EAAmBh5C,WAAW8L,IAA9B,CAAb,GAAmD,CAAjE;AACA,MAAI70B,UAAU,CAAV,IAAe,CAAC,KAAK8nE,QAAL,GAAgBlhC,SAAhB,GAA4By9D,SAA5B,CAAsCt7E,WAAW+L,SAAX,CAAqBqE,UAA3D,CAApB,EAA4F;AAC1F,SAAKtgC,OAAL,CAAay/F,SAAb,CAAuBr2F,CAAvB,EAA0B+N,CAA1B,EAA6ByM,CAA7B,EAAgClM,CAAhC;AACD;AACD,MAAM+zF,eAAetkG,UAAU,KAAKnH,OAAL,CAAaqsF,WAA5C;AACA,MAAIof,YAAJ,EAAkB;AAChB,SAAKzrG,OAAL,CAAasgG,IAAb;AACA,SAAKtgG,OAAL,CAAaqsF,WAAb,GAA2BllF,KAA3B;AACD;AACD,OAAKnH,OAAL,CAAa0pF,SAAb,CAAuBwC,KAAvB,EAA8Bof,MAA9B,EAAsCA,MAAtC,EACEpf,MAAM14D,KAAN,GAAc,IAAI83E,MADpB,EAC4Bpf,MAAMz4D,MAAN,GAAe,IAAI63E,MAD/C,EACuDliG,CADvD,EAC0D+N,CAD1D,EAC6DyM,CAD7D,EACgElM,CADhE;;AAGA,MAAI+zF,YAAJ,EAAkB;AAChB,SAAKzrG,OAAL,CAAawgG,OAAb;AACD;AACD,MAAIr5F,UAAU,CAAd,EAAiB;AACf+oB,eAAWuM,OAAX,GAAqB,IAArB;AACD,GAFD,MAEO,IAAI8uE,UAAJ,EAAgB;AACrBtyE,SAAKyyE,aAAL,CAAmBxiC,GAAnB;AACD;AACF,CA1BD;;AA6BA;;;AAGAp9C,wBAAwB5S,SAAxB,CAAkCyP,QAAlC,GAA6C,YAAW;AACtD,MAAM3oB,UAAU,KAAKA,OAArB;AACA,SAAOA,UAAUA,QAAQipB,MAAlB,GAA2B,IAAlC;AACD,CAHD;;AAMA;;;;AAIA6C,wBAAwB5S,SAAxB,CAAkC+1D,QAAlC;;AAGA;;;AAGAnjD,wBAAwB5S,SAAxB,CAAkCqtF,iBAAlC,GAAsD,YAAW;AAC/D,SAAO,KAAKL,eAAZ;AACD,CAFD;kBAGep6E,uB;;;;;;;;;;;;;;;;;;AC9Xf;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;AAMA,IAAMC,4BAA4B,SAA5BA,yBAA4B,CAAS4/E,WAAT,EAAsB;;AAEtDnE,kBAAoBjtF,IAApB,CAAyB,IAAzB,EAA+BoxF,WAA/B;;AAEA;;;;AAIA,OAAK5N,cAAL,GAAsB4N,YAAY71B,YAAZ,KAA6B,qBAAM,CAAN,EAASl2E,SAAT,CAA7B,GAAmD,IAAzE;;AAEA;;;;AAIA,OAAKgsG,MAAL,GAAc,KAAd;;AAEA;;;;AAIA,OAAKC,iBAAL,GAAyB,CAAC,CAA1B;;AAEA;;;;AAIA,OAAKC,mBAAL,GAA2BnnD,GAA3B;;AAEA;;;;AAIA,OAAKmkD,eAAL,GAAuB,0BAAvB;;AAEA;;;;AAIA,OAAKiD,oBAAL,GAA4B,IAA5B;;AAEA;;;;AAIA,OAAKC,YAAL,GAAoB,IAApB;;AAEA;;;;AAIA,OAAK/E,kBAAL,GAA0B,IAA1B;;AAEA;;;AAGA,OAAKjnG,OAAL,GAAe,iCAAf;;AAEA,sBAAOuqF,kBAAP,EAAmBziE,oBAAUuuB,KAA7B,EAAoC,KAAK41D,mBAAzC,EAA8D,IAA9D;AAED,CA3DD,C,CAvBA;;;;;AAoFA,qBAASlgF,yBAAT,EAAoCy7E,eAApC;;AAGA;;;;;AAKAz7E,0BAA0B,SAA1B,IAAuC,UAAS/uB,KAAT,EAAgB;AACrD,SAAOA,MAAMob,OAAN,OAAoBy9D,oBAAUxqD,MAArC;AACD,CAFD;;AAKA;;;;;;AAMAU,0BAA0B,QAA1B,IAAsC,UAASu6E,WAAT,EAAsBtpG,KAAtB,EAA6B;AACjE,SAAO,IAAI+uB,yBAAJ,EAA8B,qCAAuC/uB,KAArE,CAAP;AACD,CAFD;;AAKA;;;AAGA+uB,0BAA0B7S,SAA1B,CAAoCkN,eAApC,GAAsD,YAAW;AAC/D,wBAASmkE,kBAAT,EAAqBziE,oBAAUuuB,KAA/B,EAAsC,KAAK41D,mBAA3C,EAAgE,IAAhE;AACAzE,kBAAoBtuF,SAApB,CAA8BkN,eAA9B,CAA8C7L,IAA9C,CAAmD,IAAnD;AACD,CAHD;;AAMA;;;;;AAKAwR,0BAA0B7S,SAA1B,CAAoCguF,OAApC,GAA8C,UAASlnG,OAAT,EAAkBkwB,UAAlB,EAA8B4d,UAA9B,EAA0C;AACtF,MAAM1lB,SAAS8H,WAAW9H,MAA1B;AACA,MAAME,aAAa4H,WAAW5H,UAA9B;AACA,MAAMoU,qBAAqBoR,WAAW2kC,OAAX,GACzBviD,WAAWwM,kBADc,GACO,EADlC;AAEA,MAAMT,YAAY/L,WAAW+L,SAA7B;AACA,MAAMqE,aAAarE,UAAUqE,UAA7B;AACA,MAAM1D,WAAWX,UAAUW,QAA3B;AACA,MAAMkoE,mBAAmBxkE,WAAW5X,SAAX,EAAzB;AACA,MAAMwjF,eAAe,sCAAwC,KAAKj9B,QAAL,GAAgBlhC,SAAhB,EAA7D;;AAEA,MAAI8B,YAAY,KAAKoyC,YAAL,CAAkB/xD,UAAlB,EAA8B,CAA9B,CAAhB;;AAEA;AACA,MAAMi8E,aAAar+D,WAAW1lB,MAA9B;AACA,MAAMw/E,UAAUuE,eAAevsG,SAA/B;AACA,MAAIgoG,OAAJ,EAAa;AACX,SAAK5I,IAAL,CAAUh/F,OAAV,EAAmBkwB,UAAnB,EAAgC,sCAAwCi8E,UAAxE;AACD;AACD,MAAMC,cAAc,KAAKJ,YAAzB;AACA,MAAII,eAAe,CAACA,YAAYjyE,OAAZ,EAApB,EAA2C;AACzC,QAAI,KAAK4jE,cAAT,EAAyB;AACvB,WAAKA,cAAL,CAAoBh5E,KAApB;AACD;AACD,QAAM/nB,QAAQ,qCAAuC,KAAKiyE,QAAL,EAArD;AACA,QAAIo9B,cAAc,CAAlB;AACA,QAAIC,cAAc,CAAlB;AACA,QAAIC,sBAAJ;AACA,QAAMC,mBAAmB1+D,WAAWokC,OAAX,KAAuB,CAAhD;AACA,QAAMu6B,qBAAqBzvG,MAAMo5C,WAAN,CAAkB6+B,oBAAgBsS,MAAlC,CAA3B;AACA,QAAIilB,oBAAoBC,kBAAxB,EAA4C;AAC1C,UAAIC,YAAY1sG,QAAQipB,MAAR,CAAeuK,KAA/B;AACA,UAAIm5E,aAAa3sG,QAAQipB,MAAR,CAAewK,MAAhC;AACA,UAAImJ,QAAJ,EAAc;AACZ,YAAMgwE,WAAW7pG,KAAKoH,KAAL,CAAWpH,KAAKsG,IAAL,CAAUqjG,YAAYA,SAAZ,GAAwBC,aAAaA,UAA/C,CAAX,CAAjB;AACAN,sBAAc,CAACO,WAAWF,SAAZ,IAAyB,CAAvC;AACAJ,sBAAc,CAACM,WAAWD,UAAZ,IAA0B,CAAxC;AACAD,oBAAYC,aAAaC,QAAzB;AACD;AACD;AACA,WAAK5sG,OAAL,CAAaipB,MAAb,CAAoBuK,KAApB,GAA4Bk5E,SAA5B;AACA,WAAK1sG,OAAL,CAAaipB,MAAb,CAAoBwK,MAApB,GAA6Bk5E,UAA7B;AACAJ,sBAAgB,KAAKvsG,OAArB;AACD,KAbD,MAaO;AACLusG,sBAAgBvsG,OAAhB;AACD;;AAED,QAAMmH,QAAQolG,cAAclgB,WAA5B;AACA,QAAI,CAACmgB,gBAAL,EAAuB;AACrB;AACA;AACA;AACAD,oBAAclgB,WAAd,GAA4Bv+C,WAAWokC,OAAvC;AACD;;AAED,QAAIq6B,iBAAiBvsG,OAArB,EAA8B;AAC5BusG,oBAAcrnD,SAAd,CAAwBmnD,WAAxB,EAAqCC,WAArC;AACD;;AAED,QAAM94E,QAAQtD,WAAWjN,IAAX,CAAgB,CAAhB,IAAqBqF,UAAnC;AACA,QAAMmL,SAASvD,WAAWjN,IAAX,CAAgB,CAAhB,IAAqBqF,UAApC;AACA,gCAAeikF,aAAf,EAA8B,CAAC3vE,QAA/B,EACEpJ,QAAQ,CADV,EACaC,SAAS,CADtB;AAEA24E,gBAAYxP,MAAZ,CAAmB2P,aAAnB,EAAkC18D,SAAlC,EAA6CjT,QAA7C,EAAuDF,kBAAvD;AACA,QAAIwvE,aAAa9G,QAAb,MAA2B9kE,WAAW+kD,QAAX,EAA3B,IACA,CAAC,4BAAeyf,gBAAf,EAAiC18E,MAAjC,CADL,EAC+C;AAC7C,UAAIy0B,SAASz0B,OAAO,CAAP,CAAb;AACA,UAAM28E,aAAa,sBAASD,gBAAT,CAAnB;AACA,UAAI+H,QAAQ,CAAZ;AACA,UAAI9gB,gBAAJ;AACA,aAAOlvC,SAASioD,iBAAiB,CAAjB,CAAhB,EAAqC;AACnC,UAAE+H,KAAF;AACA9gB,kBAAUgZ,aAAa8H,KAAvB;AACAh9D,oBAAY,KAAKoyC,YAAL,CAAkB/xD,UAAlB,EAA8B67D,OAA9B,CAAZ;AACAqgB,oBAAYxP,MAAZ,CAAmB2P,aAAnB,EAAkC18D,SAAlC,EAA6CjT,QAA7C,EAAuDF,kBAAvD;AACAmgB,kBAAUkoD,UAAV;AACD;AACD8H,cAAQ,CAAR;AACAhwD,eAASz0B,OAAO,CAAP,CAAT;AACA,aAAOy0B,SAASioD,iBAAiB,CAAjB,CAAhB,EAAqC;AACnC,UAAE+H,KAAF;AACA9gB,kBAAUgZ,aAAa8H,KAAvB;AACAh9D,oBAAY,KAAKoyC,YAAL,CAAkB/xD,UAAlB,EAA8B67D,OAA9B,CAAZ;AACAqgB,oBAAYxP,MAAZ,CAAmB2P,aAAnB,EAAkC18D,SAAlC,EAA6CjT,QAA7C,EAAuDF,kBAAvD;AACAmgB,kBAAUkoD,UAAV;AACD;AACF;AACD,gCAAewH,aAAf,EAA8B3vE,QAA9B,EACEpJ,QAAQ,CADV,EACaC,SAAS,CADtB;;AAGA,QAAI84E,iBAAiBvsG,OAArB,EAA8B;AAC5B,UAAIysG,kBAAJ,EAAwB;AACtB,aAAKhE,mBAAL,CAAyB8D,aAAzB,EAAwCr8E,UAAxC,EAAoD2f,SAApD;AACD;AACD,UAAI28D,gBAAJ,EAAsB;AACpB,YAAMM,mBAAmB9sG,QAAQqsF,WAAjC;AACArsF,gBAAQqsF,WAAR,GAAsBv+C,WAAWokC,OAAjC;AACAlyE,gBAAQ0pF,SAAR,CAAkB6iB,cAActjF,MAAhC,EAAwC,CAACojF,WAAzC,EAAsD,CAACC,WAAvD;AACAtsG,gBAAQqsF,WAAR,GAAsBygB,gBAAtB;AACD,OALD,MAKO;AACL9sG,gBAAQ0pF,SAAR,CAAkB6iB,cAActjF,MAAhC,EAAwC,CAACojF,WAAzC,EAAsD,CAACC,WAAvD;AACD;AACDC,oBAAcrnD,SAAd,CAAwB,CAACmnD,WAAzB,EAAsC,CAACC,WAAvC;AACD;;AAED,QAAI,CAACE,gBAAL,EAAuB;AACrBD,oBAAclgB,WAAd,GAA4BllF,KAA5B;AACD;AACF;;AAED,MAAIygG,OAAJ,EAAa;AACX5nG,YAAQwgG,OAAR;AACD;AACF,CAjHD;;AAoHA;;;AAGAz0E,0BAA0B7S,SAA1B,CAAoCwuF,YAApC,GAAmD,UAASx3E,UAAT,EAAqB4d,UAArB,EAAiC9tC,OAAjC,EAA0C;AAC3F,MAAM6vC,YAAY,KAAKoyC,YAAL,CAAkB/xD,UAAlB,EAA8B,CAA9B,CAAlB;AACA,OAAKy3E,UAAL,CAAgB3nG,OAAhB,EAAyBkwB,UAAzB,EAAqC2f,SAArC;AACA,OAAKq3D,OAAL,CAAalnG,OAAb,EAAsBkwB,UAAtB,EAAkC4d,UAAlC;AACA,OAAKk6D,WAAL,CAAiBhoG,OAAjB,EAA0BkwB,UAA1B,EAAsC4d,UAAtC,EAAkD+B,SAAlD;AACD,CALD;;AAQA;;;AAGA9jB,0BAA0B7S,SAA1B,CAAoCie,0BAApC,GAAiE,UAAS1K,UAAT,EAAqByD,UAArB,EAAiC8G,YAAjC,EAA+CD,QAA/C,EAAyDW,OAAzD,EAAkE;AACjI,MAAI,CAAC,KAAKs0E,YAAV,EAAwB;AACtB,WAAOpsG,SAAP;AACD,GAFD,MAEO;AACL,QAAMyoB,aAAa6H,WAAW+L,SAAX,CAAqB5T,UAAxC;AACA,QAAMuU,WAAW1M,WAAW+L,SAAX,CAAqBW,QAAtC;AACA,QAAM5/B,QAAQ,qCAAuC,KAAKiyE,QAAL,EAArD;AACA;AACA,QAAM53C,WAAW,EAAjB;AACA,QAAM94B,SAAS,KAAKytG,YAAL,CAAkB70E,0BAAlB,CAA6C1K,UAA7C,EAAyDpE,UAAzD,EAAqEuU,QAArE,EAA+E5F,YAA/E,EAA6F,EAA7F;AACb;;;;AAIA,cAASvpB,OAAT,EAAkB;AAChB,UAAMpG,MAAM,mBAAOoG,OAAP,EAAgB5L,QAAhB,EAAZ;AACA,UAAI,EAAEwF,OAAOgwB,QAAT,CAAJ,EAAwB;AACtBA,iBAAShwB,GAAT,IAAgB,IAAhB;AACA,eAAO0vB,SAASxc,IAAT,CAAcmd,OAAd,EAAuBjqB,OAAvB,EAAgCzQ,KAAhC,CAAP;AACD;AACF,KAXY,EAWV,IAXU,CAAf;AAYA,WAAOuB,MAAP;AACD;AACF,CAvBD;;AA0BA;;;AAGAwtB,0BAA0B7S,SAA1B,CAAoC+yF,mBAApC,GAA0D,UAASl9E,KAAT,EAAgB;AACxE,MAAM/xB,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAIjyE,MAAM81E,UAAN,MAAsB,KAAKk5B,YAA/B,EAA6C;AAC3ChvG,UAAM6qB,OAAN;AACD;AACF,CALD;;AAQA;;;;;AAKAkE,0BAA0B7S,SAA1B,CAAoC6zF,uBAApC,GAA8D,UAASh+E,KAAT,EAAgB;AAC5E,OAAKg0E,uBAAL;AACD,CAFD;;AAKA;;;AAGAh3E,0BAA0B7S,SAA1B,CAAoCstF,YAApC,GAAmD,UAASt2E,UAAT,EAAqB4d,UAArB,EAAiC;AAClF,MAAM69D,cAAc,qCAAuC,KAAK18B,QAAL,EAA3D;AACA,MAAMi9B,eAAeP,YAAY59D,SAAZ,EAArB;;AAEA,MAAMi/D,YAAY98E,WAAWqK,SAAX,CAAqBC,mBAASC,SAA9B,CAAlB;AACA,MAAMwyE,cAAc/8E,WAAWqK,SAAX,CAAqBC,mBAASE,WAA9B,CAApB;AACA,MAAM2nC,uBAAuBspC,YAAYz1B,uBAAZ,EAA7B;AACA,MAAM9W,yBAAyBusC,YAAYx1B,yBAAZ,EAA/B;;AAEA,MAAI,CAAC,KAAKy1B,MAAN,IAAiB,CAACvpC,oBAAD,IAAyB2qC,SAA1C,IACC,CAAC5tC,sBAAD,IAA2B6tC,WADhC,EAC8C;AAC5C,WAAO,IAAP;AACD;;AAED,MAAMC,mBAAmBh9E,WAAW9H,MAApC;AACA,MAAM6T,YAAY/L,WAAW+L,SAA7B;AACA,MAAMqE,aAAarE,UAAUqE,UAA7B;AACA,MAAMjY,aAAa4T,UAAU5T,UAA7B;AACA,MAAMC,aAAa4H,WAAW5H,UAA9B;AACA,MAAM6kF,sBAAsBxB,YAAYj6E,WAAZ,EAA5B;AACA,MAAM07E,0BAA0BzB,YAAY31B,eAAZ,EAAhC;AACA,MAAIq3B,yBAAyB1B,YAAY11B,cAAZ,EAA7B;;AAEA,MAAIo3B,2BAA2BztG,SAA/B,EAA0C;AACxCytG,6BAAyBC,oBAAzB;AACD;;AAED,MAAMllF,SAAS,oBAAO8kF,gBAAP,EACbE,0BAA0B/kF,UADb,CAAf;AAEA,MAAMy8E,mBAAmB7oE,UAAUqE,UAAV,CAAqB5X,SAArB,EAAzB;;AAEA,MAAIwjF,aAAa9G,QAAb,MAA2BnpE,UAAUqE,UAAV,CAAqB+kD,QAArB,EAA3B,IACA,CAAC,4BAAeyf,gBAAf,EAAiC50E,WAAW9H,MAA5C,CADL,EAC0D;AACxD;AACA;AACA;AACA;AACA;AACA,QAAM28E,aAAa,sBAASD,gBAAT,CAAnB;AACA,QAAMwG,SAASvoG,KAAKkH,GAAL,CAAS,sBAASme,MAAT,IAAmB,CAA5B,EAA+B28E,UAA/B,CAAf;AACA38E,WAAO,CAAP,IAAY08E,iBAAiB,CAAjB,IAAsBwG,MAAlC;AACAljF,WAAO,CAAP,IAAY08E,iBAAiB,CAAjB,IAAsBwG,MAAlC;AACD;;AAED,MAAI,CAAC,KAAKM,MAAN,IACA,KAAKE,mBAAL,IAA4BzjF,UAD5B,IAEA,KAAKwjF,iBAAL,IAA0BsB,mBAF1B,IAGA,KAAKpB,oBAAL,IAA6BsB,sBAH7B,IAIA,4BAAe,KAAKvE,eAApB,EAAqC1gF,MAArC,CAJJ,EAIkD;AAChD,SAAK6+E,kBAAL,GAA0B,KAA1B;AACA,WAAO,IAAP;AACD;;AAED,OAAK+E,YAAL,GAAoB,IAApB;;AAEA,OAAKJ,MAAL,GAAc,KAAd;;AAEA,MAAMQ,cAAc,IAAIvO,qBAAJ,CAClB,0BAAmBx1E,UAAnB,EAA+BC,UAA/B,CADkB,EAC0BF,MAD1B,EACkCC,UADlC,EAElBC,UAFkB,EAEN4jF,aAAaqB,WAAb,EAFM,EAEsB,KAAKxP,cAF3B,EAE2C4N,YAAY31B,eAAZ,EAF3C,CAApB;AAGAk2B,eAAasB,YAAb,CAA0BplF,MAA1B,EAAkCC,UAAlC,EAA8CiY,UAA9C;AACA;;;;AAIA,MAAMvF,SAAS,UAASttB,OAAT,EAAkB;AAC/B,QAAIwa,eAAJ;AACA,QAAMwlF,gBAAgBhgG,QAAQka,gBAAR,MAA8BgkF,YAAYhkF,gBAAZ,EAApD;AACA,QAAI8lF,aAAJ,EAAmB;AACjBxlF,eAASwlF,cAAchgG,OAAd,EAAuB4a,UAAvB,CAAT;AACD;AACD,QAAIJ,MAAJ,EAAY;AACV,UAAMylF,QAAQ,KAAKC,aAAL,CACZlgG,OADY,EACH4a,UADG,EACSC,UADT,EACqBL,MADrB,EAC6BmkF,WAD7B,CAAd;AAEA,WAAKR,MAAL,GAAc,KAAKA,MAAL,IAAe8B,KAA7B;AACD;AACF,GAXc,CAWbp4F,IAXa,CAWR,IAXQ,CAAf;AAYA,MAAI+3F,sBAAJ,EAA4B;AAC1B;AACA,QAAMh2E,WAAW,EAAjB;AACA60E,iBAAa0B,sBAAb,CAAoCxlF,MAApC;AACE;;;AAGA,cAAS3a,OAAT,EAAkB;AAChB4pB,eAASr2B,IAAT,CAAcyM,OAAd;AACD,KANH,EAMK,IANL;AAOA4pB,aAASzqB,IAAT,CAAcygG,sBAAd;AACA,SAAK,IAAIruG,IAAI,CAAR,EAAWwkB,KAAK6T,SAASp4B,MAA9B,EAAsCD,IAAIwkB,EAA1C,EAA8C,EAAExkB,CAAhD,EAAmD;AACjD+7B,aAAO1D,SAASr4B,CAAT,CAAP;AACD;AACF,GAdD,MAcO;AACLktG,iBAAa0B,sBAAb,CAAoCxlF,MAApC,EAA4C2S,MAA5C,EAAoD,IAApD;AACD;AACDqxE,cAAYje,MAAZ;;AAEA,OAAK2d,mBAAL,GAA2BzjF,UAA3B;AACA,OAAKwjF,iBAAL,GAAyBsB,mBAAzB;AACA,OAAKpB,oBAAL,GAA4BsB,sBAA5B;AACA,OAAKvE,eAAL,GAAuB1gF,MAAvB;AACA,OAAK4jF,YAAL,GAAoBI,WAApB;;AAEA,OAAKnF,kBAAL,GAA0B,IAA1B;AACA,SAAO,IAAP;AACD,CAxGD;;AA2GA;;;;;;;;AAQAl7E,0BAA0B7S,SAA1B,CAAoCy0F,aAApC,GAAoD,UAASlgG,OAAT,EAAkB4a,UAAlB,EAA8BC,UAA9B,EAA0CL,MAA1C,EAAkDmkF,WAAlD,EAA+D;AACjH,MAAI,CAACnkF,MAAL,EAAa;AACX,WAAO,KAAP;AACD;AACD,MAAI4lF,UAAU,KAAd;AACA,MAAIxtG,MAAMC,OAAN,CAAc2nB,MAAd,CAAJ,EAA2B;AACzB,SAAK,IAAIjpB,IAAI,CAAR,EAAWwkB,KAAKyE,OAAOhpB,MAA5B,EAAoCD,IAAIwkB,EAAxC,EAA4C,EAAExkB,CAA9C,EAAiD;AAC/C6uG,gBAAU,2BACRzB,WADQ,EACK3+F,OADL,EACcwa,OAAOjpB,CAAP,CADd,EAER,iCAA0BqpB,UAA1B,EAAsCC,UAAtC,CAFQ,EAGR,KAAKykF,uBAHG,EAGsB,IAHtB,KAG+Bc,OAHzC;AAID;AACF,GAPD,MAOO;AACLA,cAAU,2BACRzB,WADQ,EACK3+F,OADL,EACcwa,MADd,EAER,iCAA0BI,UAA1B,EAAsCC,UAAtC,CAFQ,EAGR,KAAKykF,uBAHG,EAGsB,IAHtB,CAAV;AAID;AACD,SAAOc,OAAP;AACD,CAnBD;kBAoBe9hF,yB;;;;;;;;;;;;;;;;;;AClbf;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;AASA;;;AA7BA;;;AAgCA,IAAM+hF,gBAAgB;AACpB,WAAS,CAAC9N,qBAAWh5C,OAAZ,EAAqBg5C,qBAAWn5D,MAAhC,EACPm5D,qBAAWl5C,WADJ,EACiBk5C,qBAAW90E,KAD5B,EACmC80E,qBAAWniD,IAD9C,CADW;AAGpB,YAAU,CAACmiD,qBAAWh5C,OAAZ,EAAqBg5C,qBAAWl5C,WAAhC;AAHU,CAAtB;;AAOA;;;AAGA,IAAMinD,iBAAiB;AACrB,WAAS,CAAC/N,qBAAWrY,OAAZ,CADY;AAErB,YAAU,CAACqY,qBAAW90E,KAAZ,EAAmB80E,qBAAWniD,IAA9B,EAAoCmiD,qBAAWrY,OAA/C,CAFW;AAGrB,YAAUuY;AAHW,CAAvB;;AAOA;;;;;;AAMA,IAAMl0E,gCAAgC,SAAhCA,6BAAgC,CAAShvB,KAAT,EAAgB;;AAEpD;;;AAGA,OAAKgD,OAAL,GAAe,IAAf;;AAEA8rB,sBAAwBvR,IAAxB,CAA6B,IAA7B,EAAmCvd,KAAnC;;AAEA;;;;AAIA,OAAK+gG,cAAL,GAAsB/gG,MAAM84E,YAAN,KAAuB,qBAAM,CAAN,EAASl2E,SAAT,CAAvB,GAA6C,IAAnE;;AAEA;;;;AAIA,OAAKgsG,MAAL,GAAc,KAAd;;AAEA;;;;AAIA,OAAKoC,sBAAL;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,wBAArB;;AAEA;AACA,OAAK9E,UAAL,GAAkBnsG,MAAMu5E,aAAN,MAAyB23B,+BAAqB7iF,MAA9C,GAAuD,CAAvD,GAA2D,CAA7E;;AAEA,sBAAOk/D,kBAAP,EAAmBziE,oBAAUuuB,KAA7B,EAAoC,KAAK41D,mBAAzC,EAA8D,IAA9D;AAED,CAtCD;;AAwCA,qBAASjgF,6BAAT,EAAwCF,mBAAxC;;AAGA;;;;;AAKAE,8BAA8B,SAA9B,IAA2C,UAAShvB,KAAT,EAAgB;AACzD,SAAOA,MAAMob,OAAN,OAAoBy9D,oBAAUzqD,WAArC;AACD,CAFD;;AAKA;;;;;;AAMAY,8BAA8B,QAA9B,IAA0C,UAASs6E,WAAT,EAAsBtpG,KAAtB,EAA6B;AACrE,SAAO,IAAIgvB,6BAAJ,EAAkC,yCAA2ChvB,KAA7E,CAAP;AACD,CAFD;;AAKA;;;AAGAgvB,8BAA8B9S,SAA9B,CAAwCkN,eAAxC,GAA0D,YAAW;AACnE,wBAASmkE,kBAAT,EAAqBziE,oBAAUuuB,KAA/B,EAAsC,KAAK41D,mBAA3C,EAAgE,IAAhE;AACAngF,sBAAwB5S,SAAxB,CAAkCkN,eAAlC,CAAkD7L,IAAlD,CAAuD,IAAvD;AACD,CAHD;;AAMA;;;AAGAyR,8BAA8B9S,SAA9B,CAAwC0qF,OAAxC,GAAkD,UAAS/vF,CAAT,EAAYzK,CAAZ,EAAe+N,CAAf,EAAkBmR,UAAlB,EAA8BgY,UAA9B,EAA0C;AAC1F,MAAMrH,OAAOnN,oBAAwB5S,SAAxB,CAAkC0qF,OAAlC,CAA0CrpF,IAA1C,CAA+C,IAA/C,EAAqD1G,CAArD,EAAwDzK,CAAxD,EAA2D+N,CAA3D,EAA8DmR,UAA9D,EAA0EgY,UAA1E,CAAb;AACA,MAAIrH,KAAKnQ,QAAL,OAAoBuV,oBAAU/U,MAAlC,EAA0C;AACxC,SAAK6kF,kBAAL,CAAwBl1E,IAAxB,EAA8B3Q,UAA9B,EAA0CgY,UAA1C;AACA,QAAI,KAAKtgC,OAAT,EAAkB;AAChB,WAAKouG,gBAAL,CAAsBn1E,IAAtB,EAA4B3Q,UAA5B,EAAwCgY,UAAxC;AACD;AACF;AACD,SAAOrH,IAAP;AACD,CATD;;AAYA;;;AAGAjN,8BAA8B9S,SAA9B,CAAwCstF,YAAxC,GAAuD,UAASt2E,UAAT,EAAqB4d,UAArB,EAAiC;AACtF,MAAM9wC,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAMo/B,gBAAgBrxG,MAAM00B,WAAN,EAAtB;AACA,MAAI,KAAKs8E,sBAAL,IAA+BK,aAAnC,EAAkD;AAChD,SAAKrF,aAAL,CAAmB/pG,MAAnB,GAA4B,CAA5B;AACA,QAAM02E,aAAa34E,MAAMu5E,aAAN,EAAnB;AACA,QAAI,CAAC,KAAKv2E,OAAN,IAAiB21E,cAAcu4B,+BAAqB7iF,MAAxD,EAAgE;AAC9D,WAAKrrB,OAAL,GAAe,iCAAf;AACD;AACD,QAAI,KAAKA,OAAL,IAAgB21E,cAAcu4B,+BAAqB7iF,MAAvD,EAA+D;AAC7D,WAAKrrB,OAAL,GAAe,IAAf;AACD;AACF;AACD,OAAKguG,sBAAL,GAA8BK,aAA9B;AACA,SAAOviF,oBAAwB5S,SAAxB,CAAkCstF,YAAlC,CAA+ChlG,KAA/C,CAAqD,IAArD,EAA2D6gC,SAA3D,CAAP;AACD,CAfD;;AAkBA;;;;;;AAMArW,8BAA8B9S,SAA9B,CAAwCi1F,kBAAxC,GAA6D,UAASl1E,IAAT,EAAe3Q,UAAf,EAA2BgY,UAA3B,EAAuC;AAAA;;AAClG,MAAMtjC,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAMq/B,WAAWtxG,MAAM00B,WAAN,EAAjB;AACA,MAAM2kD,cAAc,6CAA+Cr5E,MAAMi5E,cAAN,EAAD,IAA4B,IAA9F;;AAEA,MAAMs4B,cAAct1E,KAAKu1E,cAAL,CAAoBxxG,KAApB,CAApB;AACA,MAAI,CAACuxG,YAAYb,KAAb,IAAsBa,YAAYxF,gBAAZ,IAAgCuF,QAAtD,IACAC,YAAYE,mBAAZ,IAAmCp4B,WADvC,EACoD;AAClD;AACD;;AAED,MAAMl5E,SAAS,0CAA4CH,MAAM+wC,SAAN,EAA3D;AACA,MAAM2gE,iBAAiBvxG,OAAOwxG,WAAP,EAAvB;AACA,MAAMh4B,WAAWx5E,OAAOysG,wBAAP,CAAgCtpE,UAAhC,CAAjB;AACA,MAAMjY,aAAasuD,SAAS9tD,aAAT,CAAuBoQ,KAAKoG,SAAL,CAAe,CAAf,CAAvB,CAAnB;AACA,MAAM0rE,aAAa9xE,KAAK7Q,MAAxB;;AAEA,MAAMwmF,aAAa,EAAnB;;AAjBkG,6BAkBzFprG,CAlByF,EAkBlFqrG,EAlBkF;AAmBhG,QAAMC,aAAa71E,KAAK2qE,OAAL,CAAa3qE,KAAK81E,QAAL,CAAcvrG,CAAd,CAAb,CAAnB;AACA,QAAIsrG,WAAWhmF,QAAX,MAAyBuV,oBAAU/U,MAAvC,EAA+C;AAC7C;AACD;;AAED,QAAM0lF,kBAAkBF,WAAWzvE,SAAnC;AACA,QAAM4vE,mBAAmBP,eAAe33B,kBAAf,CAAkCi4B,eAAlC,CAAzB;AACA,QAAME,eAAe,6BAAgBnE,UAAhB,EAA4BkE,gBAA5B,CAArB;AACA,QAAME,iBAAiB,oBAAOF,gBAAP,EAAyBC,YAAzB,IAAyC,IAAzC,GACrB,oBAAOA,YAAP,EAAqBlyG,MAAMg5E,eAAN,KAA0B3tD,UAA/C,EAA2D,MAAKiwE,SAAhE,CADF;AAEA,QAAM8W,iBAAiBN,WAAWjpE,aAAX,EAAvB;AACA,QAAIwpE,YAAY,KAAhB;AACA,QAAI,CAAC,sBAAqB/uE,UAArB,EAAiC8uE,cAAjC,CAAL,EAAuD;AACrDC,kBAAY,IAAZ;AACAP,iBAAWQ,aAAX,CAAyBhvE,UAAzB;AACD;AACDiuE,gBAAYb,KAAZ,GAAoB,KAApB;AACA,QAAMtB,cAAc,IAAIvO,qBAAJ,CAAsB,CAAtB,EAAyBqR,YAAzB,EAAuC7mF,UAAvC,EAClBC,UADkB,EACNnrB,OAAOowG,WAAP,EADM,EACgB,MAAKxP,cADrB,EACqC/gG,MAAMg5E,eAAN,EADrC,CAApB;AAEA,QAAM/wB,mBAAmB,iCAA0B58B,UAA1B,EAAsCC,UAAtC,CAAzB;;AAEA;;;;AAIA,QAAMyS,SAAS,SAATA,MAAS,CAASttB,OAAT,EAAkB;AAC/B,UAAIwa,eAAJ;AACA,UAAMwlF,gBAAgBhgG,QAAQka,gBAAR,MAA8B3qB,MAAM2qB,gBAAN,EAApD;AACA,UAAI8lF,aAAJ,EAAmB;AACjBxlF,iBAASwlF,cAAchgG,OAAd,EAAuB4a,UAAvB,CAAT;AACD;AACD,UAAIJ,MAAJ,EAAY;AACV,YAAMylF,QAAQ,KAAKC,aAAL,CAAmBlgG,OAAnB,EAA4Bw3C,gBAA5B,EAA8Ch9B,MAA9C,EAAsDmkF,WAAtD,CAAd;AACA,aAAKR,MAAL,GAAc,KAAKA,MAAL,IAAe8B,KAA7B;AACAa,oBAAYb,KAAZ,GAAoBa,YAAYb,KAAZ,IAAqBA,KAAzC;AACD;AACF,KAXD;;AAaA,QAAMr2E,WAAWy3E,WAAWhoC,WAAX,EAAjB;AACA,QAAIuP,eAAeA,gBAAgBk4B,YAAYE,mBAA/C,EAAoE;AAClEp3E,eAASzqB,IAAT,CAAcypE,WAAd;AACD;AACD,SAAK,IAAIr3E,IAAI,CAAR,EAAWwkB,KAAK6T,SAASp4B,MAA9B,EAAsCD,IAAIwkB,EAA1C,EAA8C,EAAExkB,CAAhD,EAAmD;AACjD,UAAMyO,UAAU4pB,SAASr4B,CAAT,CAAhB;AACA,UAAIqwG,SAAJ,EAAe;AACb,YAAID,eAAehqD,QAAf,MAA6B3c,gBAAM4c,WAAvC,EAAoD;AAClD;AACA+pD,yBAAezpB,cAAf,CAA8BspB,gBAA9B;AACA;AACAG,yBAAe3sC,SAAf,CAAyBqsC,WAAWpmF,SAAX,EAAzB;AACD;AACDjb,gBAAQ8Z,WAAR,GAAsBsoB,SAAtB,CAAgCu/D,cAAhC,EAAgD9uE,UAAhD;AACD;AACD,UAAI,CAAC6uE,cAAD,IAAmB,wBAAWA,cAAX,EAA2B1hG,QAAQ8Z,WAAR,GAAsBmB,SAAtB,EAA3B,CAAvB,EAAsF;AACpFqS,eAAOxgB,IAAP,CAAY,KAAZ,EAAkB9M,OAAlB;AACD;AACF;AACD2+F,gBAAYje,MAAZ;AACA,SAAK,IAAMlwF,CAAX,IAAgBmuG,YAAYjM,UAAZ,EAAhB,EAA0C;AACxCyO,iBAAW3wG,CAAX,IAAgB,IAAhB;AACD;AACD6wG,eAAWS,cAAX,CAA0BvyG,KAA1B,EAAiCi8B,KAAKoG,SAAL,CAAex9B,QAAf,EAAjC,EAA4DuqG,WAA5D;AAhFgG;;AAkBlG,OAAK,IAAI5oG,IAAI,CAAR,EAAWqrG,KAAK51E,KAAK81E,QAAL,CAAc9vG,MAAnC,EAA2CuE,IAAIqrG,EAA/C,EAAmD,EAAErrG,CAArD,EAAwD;AAAA,qBAA/CA,CAA+C,EAAxCqrG,EAAwC;;AAAA,6BAGpD;AA4DH;AACDN,cAAYxF,gBAAZ,GAA+BuF,QAA/B;AACAC,cAAYE,mBAAZ,GAAkCp4B,WAAlC;AACD,CApFD;;AAuFA;;;AAGArqD,8BAA8B9S,SAA9B,CAAwCie,0BAAxC,GAAqE,UAAS1K,UAAT,EAAqByD,UAArB,EAAiC8G,YAAjC,EAA+CD,QAA/C,EAAyDW,OAAzD,EAAkE;AACrI,MAAMrP,aAAa6H,WAAW+L,SAAX,CAAqB5T,UAAxC;AACA,MAAMuU,WAAW1M,WAAW+L,SAAX,CAAqBW,QAAtC;AACA5F,iBAAeA,gBAAgBp3B,SAAhB,GAA4B,CAA5B,GAAgCo3B,YAA/C;AACA,MAAMh6B,QAAQ,KAAKiyE,QAAL,EAAd;AACA;AACA,MAAM53C,WAAW,EAAjB;;AAEA;AACA,MAAM2xE,gBAAgB,KAAKA,aAA3B;;AAEA,MAAImG,uBAAJ;AAAA,MAAoBjlE,cAApB;AACA,MAAIlrC,UAAJ;AAAA,MAAOwkB,WAAP;AAAA,MAAW4oF,oBAAX;AACA,OAAKptG,IAAI,CAAJ,EAAOwkB,KAAKwlF,cAAc/pG,MAA/B,EAAuCD,IAAIwkB,EAA3C,EAA+C,EAAExkB,CAAjD,EAAoD;AAClD,QAAMi6B,OAAO+vE,cAAchqG,CAAd,CAAb;AACAmwG,qBAAiB,oBAAOl2E,KAAK7Q,MAAZ,EAAoB4O,eAAe3O,UAAnC,EAA+C8mF,cAA/C,CAAjB;AACA,QAAI,CAAC,gCAAmBA,cAAnB,EAAmC1iF,UAAnC,CAAL,EAAqD;AACnD;AACD;AACD,SAAK,IAAIjpB,IAAI,CAAR,EAAWqrG,KAAK51E,KAAK81E,QAAL,CAAc9vG,MAAnC,EAA2CuE,IAAIqrG,EAA/C,EAAmD,EAAErrG,CAArD,EAAwD;AACtD,UAAMsrG,cAAa71E,KAAK2qE,OAAL,CAAa3qE,KAAK81E,QAAL,CAAcvrG,CAAd,CAAb,CAAnB;AACA,UAAIsrG,YAAWhmF,QAAX,MAAyBuV,oBAAU/U,MAAvC,EAA+C;AAC7C;AACD;AACD8iF,oBAAc0C,YAAWU,cAAX,CAA0BxyG,KAA1B,EAAiCi8B,KAAKoG,SAAL,CAAex9B,QAAf,EAAjC,CAAd;AACAqoC,cAAQA,SAASkiE,YAAYj1E,0BAAZ,CAAuC1K,UAAvC,EAAmDpE,UAAnD,EAA+DuU,QAA/D,EAAyE5F,YAAzE,EAAuF,EAAvF;AACf;;;;AAIA,gBAASvpB,OAAT,EAAkB;AAChB,YAAMpG,MAAM,mBAAOoG,OAAP,EAAgB5L,QAAhB,EAAZ;AACA,YAAI,EAAEwF,OAAOgwB,QAAT,CAAJ,EAAwB;AACtBA,mBAAShwB,GAAT,IAAgB,IAAhB;AACA,iBAAO0vB,SAASxc,IAAT,CAAcmd,OAAd,EAAuBjqB,OAAvB,EAAgCzQ,KAAhC,CAAP;AACD;AACF,OAXc,EAWZ,IAXY,CAAjB;AAYD;AACF;AACD,SAAOktC,KAAP;AACD,CAxCD;;AA2CA;;;;;;AAMAle,8BAA8B9S,SAA9B,CAAwCu2F,mBAAxC,GAA8D,UAASx2E,IAAT,EAAe/I,UAAf,EAA2B;AACvF,MAAMlzB,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAM9xE,SAAS,0CAA4CH,MAAM+wC,SAAN,EAA3D;AACA,MAAM4oC,WAAWx5E,OAAOwxG,WAAP,EAAjB;AACA,MAAMtvE,YAAYpG,KAAKoG,SAAvB;AACA,MAAMjG,iBAAiBu9C,SAAS9tD,aAAT,CAAuBwW,UAAU,CAAV,CAAvB,CAAvB;AACA,MAAMpD,YAAY/L,WAAW+L,SAA7B;AACA,MAAM3T,aAAa4H,WAAW5H,UAA9B;AACA,MAAMonF,mBAAmBzzE,UAAU5T,UAAV,GAAuBC,UAAhD;AACA,MAAMyiF,aAAap0B,SAASI,kBAAT,CAA4B13C,SAA5B,EAAuC,KAAKi5D,SAA5C,CAAnB;AACA,MAAMz6F,SAASo+B,UAAUp+B,MAAzB;AACA,MAAM4wF,SAAS,wBAAWsc,UAAX,CAAf;AACA,MAAM9nF,OAAOiN,WAAWjN,IAAxB;AACA,MAAM8oE,UAAUhpF,KAAKoH,KAAL,CAAWme,aAAarF,KAAK,CAAL,CAAb,GAAuB,CAAlC,CAAhB;AACA,MAAM+oE,UAAUjpF,KAAKoH,KAAL,CAAWme,aAAarF,KAAK,CAAL,CAAb,GAAuB,CAAlC,CAAhB;AACA,SAAO,wBAAiB,KAAKgrF,aAAtB,EACLliB,OADK,EACIC,OADJ,EAEL5yD,iBAAiBs2E,gBAFZ,EAE8Bt2E,iBAAiBs2E,gBAF/C,EAGLzzE,UAAUW,QAHL,EAIL,CAAC6xD,OAAO,CAAP,IAAY5wF,OAAO,CAAP,CAAb,IAA0Bu7B,cAJrB,EAKL,CAACv7B,OAAO,CAAP,IAAY4wF,OAAO,CAAP,CAAb,IAA0Br1D,cALrB,CAAP;AAMD,CArBD;;AAwBA;;;AAGApN,8BAA8B9S,SAA9B,CAAwC+yF,mBAAxC,GAA8D,UAASl9E,KAAT,EAAgB;AAC5E,MAAM/xB,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAIjyE,MAAM81E,UAAN,MAAsB,KAAKk7B,sBAAL,KAAgCpuG,SAA1D,EAAqE;AACnE5C,UAAM6qB,OAAN;AACD;AACF,CALD;;AAQA;;;;;AAKAmE,8BAA8B9S,SAA9B,CAAwC6zF,uBAAxC,GAAkE,UAASh+E,KAAT,EAAgB;AAChF,OAAKg0E,uBAAL;AACD,CAFD;;AAKA;;;AAGA/2E,8BAA8B9S,SAA9B,CAAwC8uF,WAAxC,GAAsD,UAAShoG,OAAT,EAAkBkwB,UAAlB,EAA8B4d,UAA9B,EAA0C;AAC9F,MAAM9wC,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAMyvB,mBAAmB1hG,MAAM84E,YAAN,KAAuB,EAAvB,GAA4B,IAArD;AACA,MAAM34E,SAAS,0CAA4CH,MAAM+wC,SAAN,EAA3D;AACA,MAAM4nC,aAAa34E,MAAMu5E,aAAN,EAAnB;AACA,MAAMgqB,cAAcwN,eAAep4B,UAAf,CAApB;AACA,MAAMrtD,aAAa4H,WAAW5H,UAA9B;AACA,MAAMsU,WAAW1M,WAAW+L,SAAX,CAAqBW,QAAtC;AACA,MAAM3Z,OAAOiN,WAAWjN,IAAxB;AACA,MAAI8oE,gBAAJ;AAAA,MAAaC,gBAAb;AACA,MAAIpvD,QAAJ,EAAc;AACZmvD,cAAUhpF,KAAKoH,KAAL,CAAWme,aAAarF,KAAK,CAAL,CAAb,GAAuB,CAAlC,CAAV;AACA+oE,cAAUjpF,KAAKoH,KAAL,CAAWme,aAAarF,KAAK,CAAL,CAAb,GAAuB,CAAlC,CAAV;AACA,gCAAejjB,OAAf,EAAwB,CAAC48B,QAAzB,EAAmCmvD,OAAnC,EAA4CC,OAA5C;AACD;AACD,MAAI0S,gBAAJ,EAAsB;AACpB,SAAKX,cAAL,CAAoBh5E,KAApB;AACD;AACD,MAAM69E,QAAQ,KAAKoG,aAAnB;AACA,MAAMryB,WAAWx5E,OAAOysG,wBAAP,CAAgC15E,WAAW+L,SAAX,CAAqBqE,UAArD,CAAjB;AACA,MAAMqvE,QAAQ,EAAd;AACA,MAAMhR,KAAK,EAAX;AACA,OAAK,IAAI3/F,IAAI4jG,MAAM3jG,MAAN,GAAe,CAA5B,EAA+BD,KAAK,CAApC,EAAuC,EAAEA,CAAzC,EAA4C;AAC1C,QAAMi6B,OAAO,wCAA0C2pE,MAAM5jG,CAAN,CAAvD;AACA,QAAIi6B,KAAKnQ,QAAL,MAAmBuV,oBAAUE,KAAjC,EAAwC;AACtC;AACD;AACD,QAAMc,YAAYpG,KAAKoG,SAAvB;AACA,QAAMuwE,cAAcj5B,SAASI,kBAAT,CAA4B13C,SAA5B,EAAuC,KAAKi5D,SAA5C,EAAuD,CAAvD,IAA4Dr/D,KAAK7Q,MAAL,CAAY,CAAZ,CAAhF;AACA,QAAIynB,YAAYjwC,SAAhB;AACA,SAAK,IAAI4D,IAAI,CAAR,EAAWqrG,KAAK51E,KAAK81E,QAAL,CAAc9vG,MAAnC,EAA2CuE,IAAIqrG,EAA/C,EAAmD,EAAErrG,CAArD,EAAwD;AACtD,UAAMsrG,eAAa71E,KAAK2qE,OAAL,CAAa3qE,KAAK81E,QAAL,CAAcvrG,CAAd,CAAb,CAAnB;AACA,UAAIsrG,aAAWhmF,QAAX,MAAyBuV,oBAAU/U,MAAvC,EAA+C;AAC7C;AACD;AACD,UAAM8iF,eAAc0C,aAAWU,cAAX,CAA0BxyG,KAA1B,EAAiCqiC,UAAUx9B,QAAV,EAAjC,CAApB;AACA,UAAI8zE,cAAcu4B,+BAAqB7iF,MAAnC,IAA6C,CAAC+gF,aAAYjN,UAAZ,CAAuBoB,WAAvB,CAAlD,EAAuF;AACrF;AACD;AACD,UAAI,CAAC1wD,SAAL,EAAgB;AACdA,oBAAY,KAAKoyC,YAAL,CAAkB/xD,UAAlB,EAA8B0/E,WAA9B,CAAZ;AACD;AACD,UAAMnM,WAAWqL,aAAWzvE,SAAX,CAAqB,CAArB,CAAjB;AACA,UAAMwwE,cAAczD,aAAYlN,aAAZ,CAA0BrvD,SAA1B,CAApB;AACA7vC,cAAQsgG,IAAR;AACAtgG,cAAQqsF,WAAR,GAAsBv+C,WAAWokC,OAAjC;AACA;AACA;AACA,WAAK,IAAIhqE,IAAI,CAAR,EAAW27B,KAAK8rE,MAAM1wG,MAA3B,EAAmCiJ,IAAI27B,EAAvC,EAA2C,EAAE37B,CAA7C,EAAgD;AAC9C,YAAM82F,OAAO2Q,MAAMznG,CAAN,CAAb;AACA,YAAIu7F,WAAW9E,GAAGz2F,CAAH,CAAf,EAAsB;AACpBlI,kBAAQ6xF,SAAR;AACA;AACA7xF,kBAAQyxF,MAAR,CAAeoe,YAAY,CAAZ,CAAf,EAA+BA,YAAY,CAAZ,CAA/B;AACA7vG,kBAAQ0xF,MAAR,CAAeme,YAAY,CAAZ,CAAf,EAA+BA,YAAY,CAAZ,CAA/B;AACA7vG,kBAAQ0xF,MAAR,CAAeme,YAAY,CAAZ,CAAf,EAA+BA,YAAY,CAAZ,CAA/B;AACA7vG,kBAAQ0xF,MAAR,CAAeme,YAAY,CAAZ,CAAf,EAA+BA,YAAY,CAAZ,CAA/B;AACA;AACA7vG,kBAAQyxF,MAAR,CAAeuN,KAAK,CAAL,CAAf,EAAwBA,KAAK,CAAL,CAAxB;AACAh/F,kBAAQ0xF,MAAR,CAAesN,KAAK,CAAL,CAAf,EAAwBA,KAAK,CAAL,CAAxB;AACAh/F,kBAAQ0xF,MAAR,CAAesN,KAAK,CAAL,CAAf,EAAwBA,KAAK,CAAL,CAAxB;AACAh/F,kBAAQ0xF,MAAR,CAAesN,KAAK,CAAL,CAAf,EAAwBA,KAAK,CAAL,CAAxB;AACAh/F,kBAAQg/F,IAAR;AACD;AACF;AACDoN,mBAAYxP,MAAZ,CAAmB58F,OAAnB,EAA4B6vC,SAA5B,EAAuCjT,QAAvC,EAAiD,EAAjD,EAAqD2jE,WAArD,EAAkE7B,gBAAlE;AACA1+F,cAAQwgG,OAAR;AACAmP,YAAM3uG,IAAN,CAAW6uG,WAAX;AACAlR,SAAG39F,IAAH,CAAQyiG,QAAR;AACD;AACF;AACD,MAAI/E,gBAAJ,EAAsB;AACpB,sCAAgBA,gBAAhB,EAAkC1+F,OAAlC,EAA2C48B,QAA3C;AACD;AACD,MAAIA,QAAJ,EAAc;AACZ,gCAAe58B,OAAf,EAAwB48B,QAAxB;AACE,yBAAuBmvD,OADzB,EACmC,qBAAuBC,OAD1D;AAED;AACDlgE,sBAAwB5S,SAAxB,CAAkC8uF,WAAlC,CAA8CxmG,KAA9C,CAAoD,IAApD,EAA0D6gC,SAA1D;AACD,CA/ED;;AAkFA;;;;;;;AAOArW,8BAA8B9S,SAA9B,CAAwCy0F,aAAxC,GAAwD,UAASlgG,OAAT,EAAkBw3C,gBAAlB,EAAoCh9B,MAApC,EAA4CmkF,WAA5C,EAAyD;AAC/G,MAAI,CAACnkF,MAAL,EAAa;AACX,WAAO,KAAP;AACD;AACD,MAAI4lF,UAAU,KAAd;AACA,MAAIxtG,MAAMC,OAAN,CAAc2nB,MAAd,CAAJ,EAA2B;AACzB,SAAK,IAAIjpB,IAAI,CAAR,EAAWwkB,KAAKyE,OAAOhpB,MAA5B,EAAoCD,IAAIwkB,EAAxC,EAA4C,EAAExkB,CAA9C,EAAiD;AAC/C6uG,gBAAU,2BACRzB,WADQ,EACK3+F,OADL,EACcwa,OAAOjpB,CAAP,CADd,EACyBimD,gBADzB,EAER,KAAK8nD,uBAFG,EAEsB,IAFtB,KAE+Bc,OAFzC;AAGD;AACF,GAND,MAMO;AACLA,cAAU,2BACRzB,WADQ,EACK3+F,OADL,EACcwa,MADd,EACsBg9B,gBADtB,EAER,KAAK8nD,uBAFG,EAEsB,IAFtB,CAAV;AAGD;AACD,SAAOc,OAAP;AACD,CAjBD;;AAoBA;;;;;;AAMA7hF,8BAA8B9S,SAA9B,CAAwCk1F,gBAAxC,GAA2D,UACzDn1E,IADyD,EACnD3Q,UADmD,EACvCgY,UADuC,EAC3B;AAC9B,MAAMtjC,QAAQ,KAAKiyE,QAAL,EAAd;AACA,MAAMs/B,cAAct1E,KAAKu1E,cAAL,CAAoBxxG,KAApB,CAApB;AACA,MAAMsxG,WAAWtxG,MAAM00B,WAAN,EAAjB;AACA,MAAM0tE,UAAU0O,cAAc9wG,MAAMu5E,aAAN,EAAd,CAAhB;AACA,MAAI6oB,WAAWmP,YAAYuB,oBAAZ,KAAqCxB,QAApD,EAA8D;AAC5DC,gBAAYuB,oBAAZ,GAAmCxB,QAAnC;AACA,QAAMjvE,YAAYpG,KAAK82E,gBAAvB;AACA,QAAMl8F,IAAIwrB,UAAU,CAAV,CAAV;AACA,QAAMliC,SAAS,0CAA4CH,MAAM+wC,SAAN,EAA3D;AACA,QAAM4oC,WAAWx5E,OAAOysG,wBAAP,CAAgCtpE,UAAhC,CAAjB;AACA,QAAMjY,aAAasuD,SAAS9tD,aAAT,CAAuBhV,CAAvB,CAAnB;AACA,QAAM7T,UAAUi5B,KAAK4a,UAAL,CAAgB72C,KAAhB,CAAhB;AACA,QAAMimB,OAAO9lB,OAAOytG,gBAAP,CAAwB/2F,CAAxB,EAA2ByU,UAA3B,EAAuCgY,UAAvC,CAAb;AACAtgC,YAAQipB,MAAR,CAAeuK,KAAf,GAAuBvQ,KAAK,CAAL,CAAvB;AACAjjB,YAAQipB,MAAR,CAAewK,MAAf,GAAwBxQ,KAAK,CAAL,CAAxB;AACA,QAAM8nF,aAAap0B,SAASI,kBAAT,CAA4B13C,SAA5B,EAAuC,KAAKi5D,SAA5C,CAAnB;AACA,SAAK,IAAIt5F,IAAI,CAAR,EAAWwkB,KAAKyV,KAAK81E,QAAL,CAAc9vG,MAAnC,EAA2CD,IAAIwkB,EAA/C,EAAmD,EAAExkB,CAArD,EAAwD;AACtD,UAAM8vG,eAAa71E,KAAK2qE,OAAL,CAAa3qE,KAAK81E,QAAL,CAAc/vG,CAAd,CAAb,CAAnB;AACA,UAAI8vG,aAAWhmF,QAAX,MAAyBuV,oBAAU/U,MAAvC,EAA+C;AAC7C;AACD;AACD,UAAM0mF,aAAa1nF,aAAaD,UAAhC;AACA,UAAMwnB,YAAY,sBAAe,KAAKo+D,aAApB,CAAlB;AACA,4BAAep+D,SAAf,EAA0BmgE,UAA1B,EAAsC,CAACA,UAAvC;AACA,gCAAmBngE,SAAnB,EAA8B,CAACk7D,WAAW,CAAX,CAA/B,EAA8C,CAACA,WAAW,CAAX,CAA/C;AACA,UAAMqB,gBAAc0C,aAAWU,cAAX,CAA0BxyG,KAA1B,EAAiCi8B,KAAKoG,SAAL,CAAex9B,QAAf,EAAjC,CAApB;AACAuqG,oBAAYxP,MAAZ,CAAmB58F,OAAnB,EAA4B6vC,SAA5B,EAAuC,CAAvC,EAA0C,EAA1C,EAA8CuvD,OAA9C;AACD;AACF;AACF,CA/BD;;kBAiCepzE,6B;;;;;;;;;;;;;;;;;QCldCikF,Y,GAAAA,Y;QAUAC,mB,GAAAA,mB;QAWAC,Y,GAAAA,Y;QAsCAxC,a,GAAAA,a;;AA/FhB;;AACA;;;;AACA;;;;AACA;;;;;;AAGA;;;;AATA;;;AAaA,IAAMyC,qBAAqB,GAA3B;;AAGA;;;;;;AAMA,IAAMC,qBAAqB;AACzB,WAASC,mBADgB;AAEzB,gBAAcC,wBAFW;AAGzB,aAAWC,qBAHc;AAIzB,gBAAcC,wBAJW;AAKzB,qBAAmBC,6BALM;AAMzB,kBAAgBC,0BANS;AAOzB,wBAAsBC,gCAPG;AAQzB,YAAUC;AARe,CAA3B;;AAYA;;;;;AAKO,SAASZ,YAAT,CAAsBa,QAAtB,EAAgCC,QAAhC,EAA0C;AAC/C,SAAO,mBAAOD,QAAP,IAAmB,mBAAOC,QAAP,CAA1B;AACD;;AAGD;;;;;AAKO,SAASb,mBAAT,CAA6B7nF,UAA7B,EAAyCC,UAAzC,EAAqD;AAC1D,MAAMy8B,YAAYorD,aAAa9nF,UAAb,EAAyBC,UAAzB,CAAlB;AACA,SAAOy8B,YAAYA,SAAnB;AACD;;AAGD;;;;;AAKO,SAASorD,YAAT,CAAsB9nF,UAAtB,EAAkCC,UAAlC,EAA8C;AACnD,SAAO8nF,qBAAqB/nF,UAArB,GAAkCC,UAAzC;AACD;;AAGD;;;;;;AAMA,SAASuoF,oBAAT,CAA8BzE,WAA9B,EAA2CplF,QAA3C,EAAqD5D,KAArD,EAA4D3V,OAA5D,EAAqE;AACnE,MAAMw7E,YAAY7lE,MAAM6uE,OAAN,EAAlB;AACA,MAAM/I,cAAc9lE,MAAM8uE,SAAN,EAApB;AACA,MAAIjJ,aAAaC,WAAjB,EAA8B;AAC5B,QAAM8nB,eAAe5E,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWn5D,MAApD,CAArB;AACAmqE,iBAAahoB,kBAAb,CAAgCC,SAAhC,EAA2CC,WAA3C;AACA8nB,iBAAajpB,UAAb,CAAwB/gE,QAAxB,EAAkCvZ,OAAlC;AACD;AACD,MAAM87E,YAAYnmE,MAAM+uE,OAAN,EAAlB;AACA,MAAI5I,SAAJ,EAAe;AACb,QAAM0nB,aAAa7E,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWniD,IAApD,CAAnB;AACAozD,eAAW3nB,YAAX,CAAwBC,SAAxB,EAAmC6iB,YAAYtN,YAAZ,CAAyB,KAAzB,CAAnC;AACAmS,eAAWloB,QAAX,CAAoB/hE,QAApB,EAA8BvZ,OAA9B;AACD;AACF;;AAGD;;;;;;;;;;AAUO,SAASkgG,aAAT,CAAuBvB,WAAvB,EAAoC3+F,OAApC,EAA6C2V,KAA7C,EAAoD6hC,gBAApD,EAAsErzB,QAAtE,EAAgF8F,OAAhF,EAAyF;AAC9F,MAAIm2E,UAAU,KAAd;AACA,MAAMzkB,aAAahmE,MAAMuF,QAAN,EAAnB;AACA,MAAIygE,UAAJ,EAAgB;AACd,QAAI6Z,aAAa7Z,WAAW8nB,aAAX,EAAjB;AACA,QAAIjO,cAAc75E,qBAAWE,MAAzB,IAAmC25E,cAAc75E,qBAAWO,KAAhE,EAAuE;AACrEy/D,iBAAW+nB,mBAAX,CAA+Bv/E,QAA/B,EAAyC8F,OAAzC;AACD,KAFD,MAEO;AACL,UAAIurE,cAAc75E,qBAAWC,IAA7B,EAAmC;AACjC+/D,mBAAWrgE,IAAX;AACD;AACDk6E,mBAAa7Z,WAAW8nB,aAAX,EAAb;AACA9nB,iBAAWgoB,iBAAX,CAA6Bx/E,QAA7B,EAAuC8F,OAAvC;AACAm2E,gBAAU,IAAV;AACD;AACF;AACDwD,wBAAsBjF,WAAtB,EAAmC3+F,OAAnC,EAA4C2V,KAA5C,EAAmD6hC,gBAAnD;;AAEA,SAAO4oD,OAAP;AACD;;AAGD;;;;;;AAMA,SAASwD,qBAAT,CAA+BjF,WAA/B,EAA4C3+F,OAA5C,EAAqD2V,KAArD,EAA4D6hC,gBAA5D,EAA8E;AAC5E,MAAMj+B,WAAW5D,MAAMgvE,mBAAN,GAA4B3kF,OAA5B,CAAjB;AACA,MAAI,CAACuZ,QAAL,EAAe;AACb;AACD;AACD,MAAMs/B,qBAAqBt/B,SAASg+B,qBAAT,CAA+BC,gBAA/B,CAA3B;AACA,MAAMv5B,WAAWtI,MAAMwV,WAAN,EAAjB;AACA,MAAIlN,QAAJ,EAAc;AACZ4lF,mBAAelF,WAAf,EAA4B9lD,kBAA5B,EAAgDljC,KAAhD,EAAuD3V,OAAvD;AACD,GAFD,MAEO;AACL,QAAM8jG,mBAAmBlB,mBAAmB/pD,mBAAmBluC,OAAnB,EAAnB,CAAzB;AACAm5F,qBAAiBnF,WAAjB,EAA8B9lD,kBAA9B,EAAkDljC,KAAlD,EAAyD3V,OAAzD;AACD;AACF;;AAGD;;;;;;AAMA,SAAS6jG,cAAT,CAAwBlF,WAAxB,EAAqCplF,QAArC,EAA+C5D,KAA/C,EAAsD3V,OAAtD,EAA+D;AAC7D,MAAIuZ,SAAS5O,OAAT,MAAsBwuB,uBAAa6f,mBAAvC,EAA4D;AAC1D,QAAMxF,aAAa,gDAAkDj6B,QAAD,CAAWm/B,aAAX,EAApE;AACA,SAAK,IAAInnD,IAAI,CAAR,EAAWwkB,KAAKy9B,WAAWhiD,MAAhC,EAAwCD,IAAIwkB,EAA5C,EAAgD,EAAExkB,CAAlD,EAAqD;AACnDsyG,qBAAelF,WAAf,EAA4BnrD,WAAWjiD,CAAX,CAA5B,EAA2CokB,KAA3C,EAAkD3V,OAAlD;AACD;AACD;AACD;AACD,MAAMmvF,SAASwP,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWrY,OAApD,CAAf;AACAiV,SAAO/U,UAAP,EAAkB,4CAA8C7gE,QAAhE,EAA2EvZ,OAA3E,EAAoF2V,MAAMwV,WAAN,EAApF;AACD;;AAGD;;;;;;AAMA,SAASg4E,gCAAT,CAA0CxE,WAA1C,EAAuDplF,QAAvD,EAAiE5D,KAAjE,EAAwE3V,OAAxE,EAAiF;AAC/E,MAAMwzC,aAAaj6B,SAAS06B,kBAAT,EAAnB;AACA,MAAI1iD,UAAJ;AAAA,MAAOwkB,WAAP;AACA,OAAKxkB,IAAI,CAAJ,EAAOwkB,KAAKy9B,WAAWhiD,MAA5B,EAAoCD,IAAIwkB,EAAxC,EAA4C,EAAExkB,CAA9C,EAAiD;AAC/C,QAAMuyG,mBACFlB,mBAAmBpvD,WAAWjiD,CAAX,EAAcoZ,OAAd,EAAnB,CADJ;AAEAm5F,qBAAiBnF,WAAjB,EAA8BnrD,WAAWjiD,CAAX,CAA9B,EAA6CokB,KAA7C,EAAoD3V,OAApD;AACD;AACF;;AAGD;;;;;;AAMA,SAAS8iG,wBAAT,CAAkCnE,WAAlC,EAA+CplF,QAA/C,EAAyD5D,KAAzD,EAAgE3V,OAAhE,EAAyE;AACvE,MAAMy7E,cAAc9lE,MAAM8uE,SAAN,EAApB;AACA,MAAIhJ,WAAJ,EAAiB;AACf,QAAMsoB,mBAAmBpF,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWl5C,WAApD,CAAzB;AACA0qD,qBAAiBxoB,kBAAjB,CAAoC,IAApC,EAA0CE,WAA1C;AACAsoB,qBAAiBrpB,cAAjB,CAAgCnhE,QAAhC,EAA0CvZ,OAA1C;AACD;AACD,MAAM87E,YAAYnmE,MAAM+uE,OAAN,EAAlB;AACA,MAAI5I,SAAJ,EAAe;AACb,QAAM0nB,aAAa7E,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWniD,IAApD,CAAnB;AACAozD,eAAW3nB,YAAX,CAAwBC,SAAxB,EAAmC6iB,YAAYtN,YAAZ,CAAyB,KAAzB,CAAnC;AACAmS,eAAWloB,QAAX,CAAoB/hE,QAApB,EAA8BvZ,OAA9B;AACD;AACF;;AAGD;;;;;;AAMA,SAASijG,6BAAT,CAAuCtE,WAAvC,EAAoDplF,QAApD,EAA8D5D,KAA9D,EAAqE3V,OAArE,EAA8E;AAC5E,MAAMy7E,cAAc9lE,MAAM8uE,SAAN,EAApB;AACA,MAAIhJ,WAAJ,EAAiB;AACf,QAAMsoB,mBAAmBpF,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWl5C,WAApD,CAAzB;AACA0qD,qBAAiBxoB,kBAAjB,CAAoC,IAApC,EAA0CE,WAA1C;AACAsoB,qBAAiBnpB,mBAAjB,CAAqCrhE,QAArC,EAA+CvZ,OAA/C;AACD;AACD,MAAM87E,YAAYnmE,MAAM+uE,OAAN,EAAlB;AACA,MAAI5I,SAAJ,EAAe;AACb,QAAM0nB,aAAa7E,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWniD,IAApD,CAAnB;AACAozD,eAAW3nB,YAAX,CAAwBC,SAAxB,EAAmC6iB,YAAYtN,YAAZ,CAAyB,KAAzB,CAAnC;AACAmS,eAAWloB,QAAX,CAAoB/hE,QAApB,EAA8BvZ,OAA9B;AACD;AACF;;AAGD;;;;;;AAMA,SAASkjG,0BAAT,CAAoCvE,WAApC,EAAiDplF,QAAjD,EAA2D5D,KAA3D,EAAkE3V,OAAlE,EAA2E;AACzE,MAAMw7E,YAAY7lE,MAAM6uE,OAAN,EAAlB;AACA,MAAM/I,cAAc9lE,MAAM8uE,SAAN,EAApB;AACA,MAAIhJ,eAAeD,SAAnB,EAA8B;AAC5B,QAAMwoB,gBAAgBrF,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWh5C,OAApD,CAAtB;AACAyqD,kBAAczoB,kBAAd,CAAiCC,SAAjC,EAA4CC,WAA5C;AACAuoB,kBAAchpB,gBAAd,CAA+BzhE,QAA/B,EAAyCvZ,OAAzC;AACD;AACD,MAAM87E,YAAYnmE,MAAM+uE,OAAN,EAAlB;AACA,MAAI5I,SAAJ,EAAe;AACb,QAAM0nB,aAAa7E,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWniD,IAApD,CAAnB;AACAozD,eAAW3nB,YAAX,CAAwBC,SAAxB,EAAmC6iB,YAAYtN,YAAZ,CAAyB,KAAzB,CAAnC;AACAmS,eAAWloB,QAAX,CAAoB/hE,QAApB,EAA8BvZ,OAA9B;AACD;AACF;;AAGD;;;;;;AAMA,SAAS6iG,mBAAT,CAA6BlE,WAA7B,EAA0CplF,QAA1C,EAAoD5D,KAApD,EAA2D3V,OAA3D,EAAoE;AAClE,MAAM27E,aAAahmE,MAAMuF,QAAN,EAAnB;AACA,MAAIygE,UAAJ,EAAgB;AACd,QAAIA,WAAW8nB,aAAX,MAA8B9nF,qBAAWE,MAA7C,EAAqD;AACnD;AACD;AACD,QAAMooF,cAActF,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAW90E,KAApD,CAApB;AACAwmF,gBAAYvoB,aAAZ,CAA0BC,UAA1B,EAAsCgjB,YAAYtN,YAAZ,CAAyB,KAAzB,CAAtC;AACA4S,gBAAY/oB,SAAZ,CAAsB3hE,QAAtB,EAAgCvZ,OAAhC;AACD;AACD,MAAM87E,YAAYnmE,MAAM+uE,OAAN,EAAlB;AACA,MAAI5I,SAAJ,EAAe;AACb,QAAM0nB,aAAa7E,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWniD,IAApD,CAAnB;AACAozD,eAAW3nB,YAAX,CAAwBC,SAAxB,EAAmC6iB,YAAYtN,YAAZ,CAAyB,CAAC,CAAC1V,UAA3B,CAAnC;AACA6nB,eAAWloB,QAAX,CAAoB/hE,QAApB,EAA8BvZ,OAA9B;AACD;AACF;;AAGD;;;;;;AAMA,SAASgjG,wBAAT,CAAkCrE,WAAlC,EAA+CplF,QAA/C,EAAyD5D,KAAzD,EAAgE3V,OAAhE,EAAyE;AACvE,MAAM27E,aAAahmE,MAAMuF,QAAN,EAAnB;AACA,MAAIygE,UAAJ,EAAgB;AACd,QAAIA,WAAW8nB,aAAX,MAA8B9nF,qBAAWE,MAA7C,EAAqD;AACnD;AACD;AACD,QAAMooF,cAActF,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAW90E,KAApD,CAApB;AACAwmF,gBAAYvoB,aAAZ,CAA0BC,UAA1B,EAAsCgjB,YAAYtN,YAAZ,CAAyB,KAAzB,CAAtC;AACA4S,gBAAYnpB,cAAZ,CAA2BvhE,QAA3B,EAAqCvZ,OAArC;AACD;AACD,MAAM87E,YAAYnmE,MAAM+uE,OAAN,EAAlB;AACA,MAAI5I,SAAJ,EAAe;AACb,QAAM0nB,aAAa7E,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWniD,IAApD,CAAnB;AACAozD,eAAW3nB,YAAX,CAAwBC,SAAxB,EAAmC6iB,YAAYtN,YAAZ,CAAyB,CAAC,CAAC1V,UAA3B,CAAnC;AACA6nB,eAAWloB,QAAX,CAAoB/hE,QAApB,EAA8BvZ,OAA9B;AACD;AACF;;AAGD;;;;;;AAMA,SAAS+iG,qBAAT,CAA+BpE,WAA/B,EAA4CplF,QAA5C,EAAsD5D,KAAtD,EAA6D3V,OAA7D,EAAsE;AACpE,MAAMw7E,YAAY7lE,MAAM6uE,OAAN,EAAlB;AACA,MAAM/I,cAAc9lE,MAAM8uE,SAAN,EAApB;AACA,MAAIjJ,aAAaC,WAAjB,EAA8B;AAC5B,QAAMuoB,gBAAgBrF,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWh5C,OAApD,CAAtB;AACAyqD,kBAAczoB,kBAAd,CAAiCC,SAAjC,EAA4CC,WAA5C;AACAuoB,kBAAc5oB,WAAd,CAA0B7hE,QAA1B,EAAoCvZ,OAApC;AACD;AACD,MAAM87E,YAAYnmE,MAAM+uE,OAAN,EAAlB;AACA,MAAI5I,SAAJ,EAAe;AACb,QAAM0nB,aAAa7E,YAAY3kB,SAAZ,CAAsBrkE,MAAM2vD,SAAN,EAAtB,EAAyCitB,qBAAWniD,IAApD,CAAnB;AACAozD,eAAW3nB,YAAX,CAAwBC,SAAxB,EAAmC6iB,YAAYtN,YAAZ,CAAyB,KAAzB,CAAnC;AACAmS,eAAWloB,QAAX,CAAoB/hE,QAApB,EAA8BvZ,OAA9B;AACD;AACF,C;;;;;;;;;;;;;;;;;AC3TD;;;;;AAKO,IAAMkkG,4CAAkB,GAAxB;;AAEP;;;;;AAKO,IAAM9K,kEAA6B,IAAnC,C;;;;;;;;;;;;;;;;;QCIS+K,uB,GAAAA,uB;QAiCAC,iB,GAAAA,iB;;AA9ChB;;AACA;;AAGA;;;;AAKA;;;;AAZA;;;AAgBO,SAASD,uBAAT,CAAiC1wE,WAAjC,EAA8C;AACnD;AACE;;;;;;AAMA,cAAS7Y,UAAT,EAAqBgb,KAArB,EAA4B0B,SAA5B,EAAuC;AACrC,UAAI1c,eAAezoB,SAAnB,EAA8B;AAC5B,YAAIiU,IAAI,8BAAkBqtB,WAAlB,EAA+B7Y,UAA/B,EAA2C0c,SAA3C,CAAR;AACAlxB,YAAI,iBAAMA,IAAIwvB,KAAV,EAAiB,CAAjB,EAAoBnC,YAAYjiC,MAAZ,GAAqB,CAAzC,CAAJ;AACA,YAAMoE,QAAQN,KAAKC,KAAL,CAAW6Q,CAAX,CAAd;AACA,YAAIA,KAAKxQ,KAAL,IAAcA,QAAQ69B,YAAYjiC,MAAZ,GAAqB,CAA/C,EAAkD;AAChD,cAAMmnC,QAAQlF,YAAY79B,KAAZ,IAAqB69B,YAAY79B,QAAQ,CAApB,CAAnC;AACA,iBAAO69B,YAAY79B,KAAZ,IAAqBN,KAAKoG,GAAL,CAASi9B,KAAT,EAAgBvyB,IAAIxQ,KAApB,CAA5B;AACD,SAHD,MAGO;AACL,iBAAO69B,YAAY79B,KAAZ,CAAP;AACD;AACF,OAVD,MAUO;AACL,eAAOzD,SAAP;AACD;AACF;AArBH;AAuBD;;AAGD;;;;;;AAMO,SAASiyG,iBAAT,CAA2BzrE,KAA3B,EAAkCxF,aAAlC,EAAiDkxE,YAAjD,EAA+D;AACpE;AACE;;;;;;AAMA,cAASzpF,UAAT,EAAqBgb,KAArB,EAA4B0B,SAA5B,EAAuC;AACrC,UAAI1c,eAAezoB,SAAnB,EAA8B;AAC5B,YAAM0mC,SAAS,CAACvB,SAAD,GAAa,CAAb,GAAiB,GAAhC;AACA,YAAMgtE,WAAWhvG,KAAKC,KAAL,CACfD,KAAKyG,GAAL,CAASo3B,gBAAgBvY,UAAzB,IAAuCtlB,KAAKyG,GAAL,CAAS48B,KAAT,CAAvC,GAAyDE,MAD1C,CAAjB;AAEA,YAAI0rE,WAAWjvG,KAAKkH,GAAL,CAAS8nG,WAAW1uE,KAApB,EAA2B,CAA3B,CAAf;AACA,YAAIyuE,iBAAiBlyG,SAArB,EAAgC;AAC9BoyG,qBAAWjvG,KAAKiH,GAAL,CAASgoG,QAAT,EAAmBF,YAAnB,CAAX;AACD;AACD,eAAOlxE,gBAAgB79B,KAAKoG,GAAL,CAASi9B,KAAT,EAAgB4rE,QAAhB,CAAvB;AACD,OATD,MASO;AACL,eAAOpyG,SAAP;AACD;AACF;AApBH;AAqBD,C;;;;;;;;;;;;;;;;;QCvDeqpC,O,GAAAA,O;QAcAiC,I,GAAAA,I;QAaA+mE,a,GAAAA,a;QAuBAC,gB,GAAAA,gB;;AA/DhB;;AAGA;;;;AAKA;;;;;AAKO,SAASjpE,OAAT,CAAiBrM,QAAjB,EAA2ByG,KAA3B,EAAkC;AACvC,MAAIzG,aAAah9B,SAAjB,EAA4B;AAC1B,WAAO,CAAP;AACD,GAFD,MAEO;AACL,WAAOA,SAAP;AACD;AACF;;AAGD;;;;;AAzBA;;;AA8BO,SAASsrC,IAAT,CAActO,QAAd,EAAwByG,KAAxB,EAA+B;AACpC,MAAIzG,aAAah9B,SAAjB,EAA4B;AAC1B,WAAOg9B,WAAWyG,KAAlB;AACD,GAFD,MAEO;AACL,WAAOzjC,SAAP;AACD;AACF;;AAGD;;;;AAIO,SAASqyG,aAAT,CAAuB3oG,CAAvB,EAA0B;AAC/B,MAAMqyD,QAAQ,IAAI54D,KAAKiG,EAAT,GAAcM,CAA5B;AACA;AACE;;;;;AAKA,cAASszB,QAAT,EAAmByG,KAAnB,EAA0B;AACxB,UAAIzG,aAAah9B,SAAjB,EAA4B;AAC1Bg9B,mBAAW75B,KAAKC,KAAL,CAAW,CAAC45B,WAAWyG,KAAZ,IAAqBs4B,KAArB,GAA6B,GAAxC,IAA+CA,KAA1D;AACA,eAAO/+B,QAAP;AACD,OAHD,MAGO;AACL,eAAOh9B,SAAP;AACD;AACF;AAbH;AAcD;;AAGD;;;;AAIO,SAASsyG,gBAAT,CAA0BC,aAA1B,EAAyC;AAC9C,MAAMptD,YAAYotD,iBAAiB,qBAAU,CAAV,CAAnC;AACA;AACE;;;;;AAKA,cAASv1E,QAAT,EAAmByG,KAAnB,EAA0B;AACxB,UAAIzG,aAAah9B,SAAjB,EAA4B;AAC1B,YAAImD,KAAKmH,GAAL,CAAS0yB,WAAWyG,KAApB,KAA8B0hB,SAAlC,EAA6C;AAC3C,iBAAO,CAAP;AACD,SAFD,MAEO;AACL,iBAAOnoB,WAAWyG,KAAlB;AACD;AACF,OAND,MAMO;AACL,eAAOzjC,SAAP;AACD;AACF;AAhBH;AAiBD,C;;;;;;;;;;;;;;;;;QClEegb,M,GAAAA,M;QAeAw3F,O,GAAAA,O;QAYA9gE,K,GAAAA,K;QAmBA+gE,M,GAAAA,M;AAjEhB;;;;AAKA;;;;;;AAOA;;;;;;;AAOO,SAASz3F,MAAT,CAAgBqI,IAAhB,EAAsBne,GAAtB,EAA2BsgC,QAA3B,EAAqC;AAC1C,MAAIA,aAAaxlC,SAAjB,EAA4B;AAC1BwlC,eAAW,CAAC,CAAD,EAAI,CAAJ,CAAX;AACD;AACDA,WAAS,CAAT,IAAcniB,KAAK,CAAL,IAAU,IAAIne,GAA5B;AACAsgC,WAAS,CAAT,IAAcniB,KAAK,CAAL,IAAU,IAAIne,GAA5B;AACA,SAAOsgC,QAAP;AACD;;AAGD;;;;;AAKO,SAASgtE,OAAT,CAAiBnvF,IAAjB,EAAuB;AAC5B,SAAOA,KAAK,CAAL,IAAU,CAAV,IAAeA,KAAK,CAAL,IAAU,CAAhC;AACD;;AAGD;;;;;;;AAOO,SAASquB,KAAT,CAAeruB,IAAf,EAAqBqvF,KAArB,EAA4BltE,QAA5B,EAAsC;AAC3C,MAAIA,aAAaxlC,SAAjB,EAA4B;AAC1BwlC,eAAW,CAAC,CAAD,EAAI,CAAJ,CAAX;AACD;AACDA,WAAS,CAAT,IAAeniB,KAAK,CAAL,IAAUqvF,KAAV,GAAkB,GAAnB,GAA0B,CAAxC;AACAltE,WAAS,CAAT,IAAeniB,KAAK,CAAL,IAAUqvF,KAAV,GAAkB,GAAnB,GAA0B,CAAxC;AACA,SAAOltE,QAAP;AACD;;AAGD;;;;;;;;;AASO,SAASitE,MAAT,CAAgBpvF,IAAhB,EAAsBmiB,QAAtB,EAAgC;AACrC,MAAI/kC,MAAMC,OAAN,CAAc2iB,IAAd,CAAJ,EAAyB;AACvB,WAAOA,IAAP;AACD,GAFD,MAEO;AACL,QAAImiB,aAAaxlC,SAAjB,EAA4B;AAC1BwlC,iBAAW,CAACniB,IAAD,EAAOA,IAAP,CAAX;AACD,KAFD,MAEO;AACLmiB,eAAS,CAAT,IAAcA,SAAS,CAAT,IAAc,qBAAuBniB,IAAnD;AACD;AACD,WAAOmiB,QAAP;AACD;AACF,C;;;;;;;;;;;;;;;;;;ACzED;;AACA;;AACA;;;;AACA;;AACA;;;;;;AAGA;;;;;;;AAQA;;;;;;;;;;;AAYA;;;;;;;;AASA;;;;;;;;;;;;;;AAcA,IAAMmtE,SAAS,SAATA,MAAS,CAASxsG,OAAT,EAAkB;;AAE/B0e,mBAAWlK,IAAX,CAAgB,IAAhB;;AAEA;;;;AAIA,OAAK8lB,WAAL,GAAmB,eAAct6B,QAAQu6B,UAAtB,CAAnB;;AAEA;;;;AAIA,OAAKkyE,aAAL,GAAqB,KAAKC,kBAAL,CAAwB1sG,QAAQmoC,YAAhC,CAArB;;AAEA;;;;AAIA,OAAKskC,MAAL,GAAczsE,QAAQwiB,KAAR,KAAkB3oB,SAAlB,GACZmG,QAAQwiB,KADI,GACI+rD,gBAAYC,KAD9B;;AAGA;;;;AAIA,OAAKm+B,MAAL,GAAc3sG,QAAQm5D,KAAR,KAAkBt/D,SAAlB,GAA8BmG,QAAQm5D,KAAtC,GAA8C,KAA5D;AAED,CA7BD,C,CArDA;;;;;AAoFA,qBAASqzC,MAAT,EAAiB9tF,gBAAjB;;AAEA;;;;;AAKA8tF,OAAOr5F,SAAP,CAAiBu5F,kBAAjB,GAAsC,UAASE,eAAT,EAA0B;AAC9D,MAAI,CAACA,eAAL,EAAsB;AACpB,WAAO,IAAP;AACD;AACD,MAAItyG,MAAMC,OAAN,CAAcqyG,eAAd,CAAJ,EAAoC;AAClC,WAAO,UAASziF,UAAT,EAAqB;AAC1B,aAAOyiF,eAAP;AACD,KAFD;AAGD;;AAED,MAAI,OAAOA,eAAP,KAA2B,UAA/B,EAA2C;AACzC,WAAOA,eAAP;AACD;;AAED,SAAO,UAASziF,UAAT,EAAqB;AAC1B,WAAO,CAACyiF,eAAD,CAAP;AACD,GAFD;AAGD,CAjBD;;AAmBA;;;;;;;;;;AAUAJ,OAAOr5F,SAAP,CAAiBie,0BAAjB,GAA8C9Q,oBAA9C;;AAGA;;;;AAIAksF,OAAOr5F,SAAP,CAAiB+0B,eAAjB,GAAmC,YAAW;AAC5C,SAAO,KAAKukE,aAAZ;AACD,CAFD;;AAKA;;;;;AAKAD,OAAOr5F,SAAP,CAAiB2sB,aAAjB,GAAiC,YAAW;AAC1C,SAAO,KAAKxF,WAAZ;AACD,CAFD;;AAKA;;;;AAIAkyE,OAAOr5F,SAAP,CAAiB4sB,cAAjB,GAAkC,YAAW,CAAE,CAA/C;;AAGA;;;;;AAKAysE,OAAOr5F,SAAP,CAAiB4P,QAAjB,GAA4B,YAAW;AACrC,SAAO,KAAK0pD,MAAZ;AACD,CAFD;;AAKA;;;AAGA+/B,OAAOr5F,SAAP,CAAiBksF,QAAjB,GAA4B,YAAW;AACrC,SAAO,KAAKsN,MAAZ;AACD,CAFD;;AAKA;;;;AAIAH,OAAOr5F,SAAP,CAAiB05F,OAAjB,GAA2B,YAAW;AACpC,OAAK/qF,OAAL;AACD,CAFD;;AAKA;;;;;;;AAOA0qF,OAAOr5F,SAAP,CAAiB25F,eAAjB,GAAmC,UAAS3kE,YAAT,EAAuB;AACxD,OAAKskE,aAAL,GAAqB,KAAKC,kBAAL,CAAwBvkE,YAAxB,CAArB;AACA,OAAKrmB,OAAL;AACD,CAHD;;AAMA;;;;;AAKA0qF,OAAOr5F,SAAP,CAAiBswF,QAAjB,GAA4B,UAASjhF,KAAT,EAAgB;AAC1C,OAAKiqD,MAAL,GAAcjqD,KAAd;AACA,OAAKV,OAAL;AACD,CAHD;kBAIe0qF,M;;;;;;;;;;;;;;;;;ACtMf;;;;AAIA;;;;kBAIe;AACblsF,aAAW,WADE;AAEbuD,WAAS,SAFI;AAGb2qD,SAAO,OAHM;AAIb5qD,SAAO;AAJM,C;;;;;;;;;;;;;;;;;;;ACJf;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;;;;;;;;;AAUA;;;;;;;;;;AAjCA;;;;AA2CO,IAAM0mD,gDAAoB,SAApBA,iBAAoB,CAAS/wE,IAAT,EAAewzG,WAAf,EAA4B;;AAE3D1uF,kBAAM7J,IAAN,CAAW,IAAX,EAAiBjb,IAAjB;;AAEA;;;;;AAKA,OAAKmO,OAAL,GAAeqlG,WAAf;AAED,CAXM;AAYP,qBAASziC,iBAAT,EAA4BjsD,eAA5B;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0FA;;;;;;;;;;;;AAYA,IAAMhnB,eAAe,SAAfA,YAAe,CAASonB,WAAT,EAAsB;;AAEzC,MAAMze,UAAUye,eAAe,EAA/B;;AAEA+tF,mBAAOh4F,IAAP,CAAY,IAAZ,EAAkB;AAChB2zB,kBAAcnoC,QAAQmoC,YADN;AAEhB5N,gBAAY1gC,SAFI;AAGhB2oB,WAAO+rD,gBAAYC,KAHH;AAIhBrV,WAAOn5D,QAAQm5D,KAAR,KAAkBt/D,SAAlB,GAA8BmG,QAAQm5D,KAAtC,GAA8C;AAJrC,GAAlB;;AAOA;;;;AAIA,OAAK/1C,OAAL,GAAe9C,oBAAf;;AAEA;;;;AAIA,OAAK0sF,OAAL,GAAehtG,QAAQ1I,MAAvB;;AAEA;;;;AAIA,OAAK6gG,SAAL,GAAiBn4F,QAAQ0mF,QAAR,IAAoB7sF,SAApB,GAAgC,IAAhC,GAAuCmG,QAAQ0mF,QAAhE;;AAEA;;;;AAIA,OAAKumB,IAAL,GAAYjtG,QAAQxI,GAApB;;AAEA,MAAIwI,QAAQktG,MAAR,KAAmBrzG,SAAvB,EAAkC;AAChC,SAAKupB,OAAL,GAAepjB,QAAQktG,MAAvB;AACD,GAFD,MAEO,IAAI,KAAKD,IAAL,KAAcpzG,SAAlB,EAA6B;AAClC,yBAAO,KAAKmzG,OAAZ,EAAqB,CAArB,EADkC,CACT;AACzB;AACA,SAAK5pF,OAAL,GAAe,wBAAI,KAAK6pF,IAAT,EAAe,uCAAyC,KAAKD,OAA7D,CAAf;AACD;;AAED;;;;AAIA,OAAKG,SAAL,GAAiBntG,QAAQotG,QAAR,KAAqBvzG,SAArB,GAAiCmG,QAAQotG,QAAzC,GAAoDC,oBAArE;;AAEA,MAAMn0C,kBACFl5D,QAAQk5D,eAAR,KAA4Br/D,SAA5B,GAAwCmG,QAAQk5D,eAAhD,GAAkE,IADtE;;AAGA;;;;AAIA,OAAKo0C,cAAL,GAAsBp0C,kBAAkB,IAAIiH,eAAJ,EAAlB,GAAgC,IAAtD;;AAEA;;;;AAIA,OAAKotC,mBAAL,GAA2B,IAAIptC,eAAJ,EAA3B;;AAEA;;;;AAIA,OAAKqtC,qBAAL,GAA6B,EAA7B;;AAEA;;;;;AAKA,OAAKC,QAAL,GAAgB,EAAhB;;AAEA;;;;;AAKA,OAAKC,aAAL,GAAqB,EAArB;;AAEA;;;;AAIA,OAAKC,kBAAL,GAA0B,EAA1B;;AAEA;;;;AAIA,OAAKC,mBAAL,GAA2B,IAA3B;;AAEA,MAAIC,mBAAJ;AAAA,MAAgBv8E,iBAAhB;AACA,MAAItxB,QAAQsxB,QAAR,YAA4B/S,oBAAhC,EAA4C;AAC1CsvF,iBAAa7tG,QAAQsxB,QAArB;AACAA,eAAWu8E,WAAWzuF,QAAX,EAAX;AACD,GAHD,MAGO,IAAI9kB,MAAMC,OAAN,CAAcyF,QAAQsxB,QAAtB,CAAJ,EAAqC;AAC1CA,eAAWtxB,QAAQsxB,QAAnB;AACD;AACD,MAAI,CAAC4nC,eAAD,IAAoB20C,eAAeh0G,SAAvC,EAAkD;AAChDg0G,iBAAa,IAAItvF,oBAAJ,CAAe+S,QAAf,CAAb;AACD;AACD,MAAIA,aAAaz3B,SAAjB,EAA4B;AAC1B,SAAKi0G,mBAAL,CAAyBx8E,QAAzB;AACD;AACD,MAAIu8E,eAAeh0G,SAAnB,EAA8B;AAC5B,SAAKk0G,uBAAL,CAA6BF,UAA7B;AACD;AAEF,CAjHD;;AAmHA,qBAASx2G,YAAT,EAAuBm1G,gBAAvB;;AAGA;;;;;;;;;AASAn1G,aAAa8b,SAAb,CAAuBmoD,UAAvB,GAAoC,UAAS5zD,OAAT,EAAkB;AACpD,OAAKsmG,kBAAL,CAAwBtmG,OAAxB;AACA,OAAKoa,OAAL;AACD,CAHD;;AAMA;;;;;AAKAzqB,aAAa8b,SAAb,CAAuB66F,kBAAvB,GAA4C,UAAStmG,OAAT,EAAkB;AAC5D,MAAMumG,aAAa,mBAAOvmG,OAAP,EAAgB5L,QAAhB,EAAnB;;AAEA,MAAI,CAAC,KAAKoyG,WAAL,CAAiBD,UAAjB,EAA6BvmG,OAA7B,CAAL,EAA4C;AAC1C;AACD;;AAED,OAAKymG,kBAAL,CAAwBF,UAAxB,EAAoCvmG,OAApC;;AAEA,MAAMuZ,WAAWvZ,QAAQ8Z,WAAR,EAAjB;AACA,MAAIP,QAAJ,EAAc;AACZ,QAAMoB,SAASpB,SAAS0B,SAAT,EAAf;AACA,QAAI,KAAK2qF,cAAT,EAAyB;AACvB,WAAKA,cAAL,CAAoBlrC,MAApB,CAA2B//C,MAA3B,EAAmC3a,OAAnC;AACD;AACF,GALD,MAKO;AACL,SAAK8lG,qBAAL,CAA2BS,UAA3B,IAAyCvmG,OAAzC;AACD;;AAED,OAAK8X,aAAL,CACE,IAAI8qD,iBAAJ,CAAsBtJ,0BAAgBC,UAAtC,EAAkDv5D,OAAlD,CADF;AAED,CArBD;;AAwBA;;;;;AAKArQ,aAAa8b,SAAb,CAAuBg7F,kBAAvB,GAA4C,UAASF,UAAT,EAAqBvmG,OAArB,EAA8B;AACxE,OAAKimG,kBAAL,CAAwBM,UAAxB,IAAsC,CACpC,oBAAOvmG,OAAP,EAAgBqa,oBAAUC,MAA1B,EACE,KAAK4/C,oBADP,EAC6B,IAD7B,CADoC,EAGpC,oBAAOl6D,OAAP,EAAgB2jB,0BAAgBC,cAAhC,EACE,KAAKs2C,oBADP,EAC6B,IAD7B,CAHoC,CAAtC;AAMD,CAPD;;AAUA;;;;;;;AAOAvqE,aAAa8b,SAAb,CAAuB+6F,WAAvB,GAAqC,UAASD,UAAT,EAAqBvmG,OAArB,EAA8B;AACjE,MAAI0mG,QAAQ,IAAZ;AACA,MAAMj1G,KAAKuO,QAAQia,KAAR,EAAX;AACA,MAAIxoB,OAAOU,SAAX,EAAsB;AACpB,QAAI,EAAEV,GAAG2C,QAAH,MAAiB,KAAK2xG,QAAxB,CAAJ,EAAuC;AACrC,WAAKA,QAAL,CAAct0G,GAAG2C,QAAH,EAAd,IAA+B4L,OAA/B;AACD,KAFD,MAEO;AACL0mG,cAAQ,KAAR;AACD;AACF,GAND,MAMO;AACL,yBAAO,EAAEH,cAAc,KAAKP,aAArB,CAAP,EACE,EADF,EADK,CAEE;AACP,SAAKA,aAAL,CAAmBO,UAAnB,IAAiCvmG,OAAjC;AACD;AACD,SAAO0mG,KAAP;AACD,CAfD;;AAkBA;;;;;AAKA/2G,aAAa8b,SAAb,CAAuBylC,WAAvB,GAAqC,UAAStnB,QAAT,EAAmB;AACtD,OAAKw8E,mBAAL,CAAyBx8E,QAAzB;AACA,OAAKxP,OAAL;AACD,CAHD;;AAMA;;;;;AAKAzqB,aAAa8b,SAAb,CAAuB26F,mBAAvB,GAA6C,UAASx8E,QAAT,EAAmB;AAC9D,MAAMy/C,UAAU,EAAhB;AACA,MAAMs9B,cAAc,EAApB;AACA,MAAMC,mBAAmB,EAAzB;;AAEA,OAAK,IAAIr1G,IAAI,CAAR,EAAWC,SAASo4B,SAASp4B,MAAlC,EAA0CD,IAAIC,MAA9C,EAAsDD,GAAtD,EAA2D;AACzD,QAAMyO,UAAU4pB,SAASr4B,CAAT,CAAhB;AACA,QAAMg1G,aAAa,mBAAOvmG,OAAP,EAAgB5L,QAAhB,EAAnB;AACA,QAAI,KAAKoyG,WAAL,CAAiBD,UAAjB,EAA6BvmG,OAA7B,CAAJ,EAA2C;AACzC2mG,kBAAYpzG,IAAZ,CAAiByM,OAAjB;AACD;AACF;;AAED,OAAK,IAAIzO,KAAI,CAAR,EAAWC,UAASm1G,YAAYn1G,MAArC,EAA6CD,KAAIC,OAAjD,EAAyDD,IAAzD,EAA8D;AAC5D,QAAMyO,WAAU2mG,YAAYp1G,EAAZ,CAAhB;AACA,QAAMg1G,cAAa,mBAAOvmG,QAAP,EAAgB5L,QAAhB,EAAnB;AACA,SAAKqyG,kBAAL,CAAwBF,WAAxB,EAAoCvmG,QAApC;;AAEA,QAAMuZ,WAAWvZ,SAAQ8Z,WAAR,EAAjB;AACA,QAAIP,QAAJ,EAAc;AACZ,UAAMoB,SAASpB,SAAS0B,SAAT,EAAf;AACAouD,cAAQ91E,IAAR,CAAaonB,MAAb;AACAisF,uBAAiBrzG,IAAjB,CAAsByM,QAAtB;AACD,KAJD,MAIO;AACL,WAAK8lG,qBAAL,CAA2BS,WAA3B,IAAyCvmG,QAAzC;AACD;AACF;AACD,MAAI,KAAK4lG,cAAT,EAAyB;AACvB,SAAKA,cAAL,CAAoBtqF,IAApB,CAAyB+tD,OAAzB,EAAkCu9B,gBAAlC;AACD;;AAED,OAAK,IAAIr1G,MAAI,CAAR,EAAWC,WAASm1G,YAAYn1G,MAArC,EAA6CD,MAAIC,QAAjD,EAAyDD,KAAzD,EAA8D;AAC5D,SAAKumB,aAAL,CAAmB,IAAI8qD,iBAAJ,CAAsBtJ,0BAAgBC,UAAtC,EAAkDotC,YAAYp1G,GAAZ,CAAlD,CAAnB;AACD;AACF,CAlCD;;AAqCA;;;;AAIA5B,aAAa8b,SAAb,CAAuB46F,uBAAvB,GAAiD,UAASF,UAAT,EAAqB;AACpE,MAAIU,sBAAsB,KAA1B;AACA,sBAAO,IAAP,EAAavtC,0BAAgBC,UAA7B,EACE,UAAS5xB,GAAT,EAAc;AACZ,QAAI,CAACk/D,mBAAL,EAA0B;AACxBA,4BAAsB,IAAtB;AACAV,iBAAW5yG,IAAX,CAAgBo0C,IAAI3nC,OAApB;AACA6mG,4BAAsB,KAAtB;AACD;AACF,GAPH;AAQA,sBAAO,IAAP,EAAavtC,0BAAgBG,aAA7B,EACE,UAAS9xB,GAAT,EAAc;AACZ,QAAI,CAACk/D,mBAAL,EAA0B;AACxBA,4BAAsB,IAAtB;AACAV,iBAAWjuF,MAAX,CAAkByvB,IAAI3nC,OAAtB;AACA6mG,4BAAsB,KAAtB;AACD;AACF,GAPH;AAQA,sBAAOV,UAAP,EAAmBpuF,8BAAoBC,GAAvC,EACE,UAAS2vB,GAAT,EAAc;AACZ,QAAI,CAACk/D,mBAAL,EAA0B;AACxBA,4BAAsB,IAAtB;AACA,WAAKjzC,UAAL,EAAgB,gCAAkCjsB,IAAI/wB,OAAtD;AACAiwF,4BAAsB,KAAtB;AACD;AACF,GAPH,EAOK,IAPL;AAQA,sBAAOV,UAAP,EAAmBpuF,8BAAoBK,MAAvC,EACE,UAASuvB,GAAT,EAAc;AACZ,QAAI,CAACk/D,mBAAL,EAA0B;AACxBA,4BAAsB,IAAtB;AACA,WAAKvsC,aAAL,EAAmB,gCAAkC3yB,IAAI/wB,OAAzD;AACAiwF,4BAAsB,KAAtB;AACD;AACF,GAPH,EAOK,IAPL;AAQA,OAAKX,mBAAL,GAA2BC,UAA3B;AACD,CAnCD;;AAsCA;;;;;AAKAx2G,aAAa8b,SAAb,CAAuB6L,KAAvB,GAA+B,UAASwvF,QAAT,EAAmB;AAChD,MAAIA,QAAJ,EAAc;AACZ,SAAK,IAAMC,SAAX,IAAwB,KAAKd,kBAA7B,EAAiD;AAC/C,UAAM/mG,OAAO,KAAK+mG,kBAAL,CAAwBc,SAAxB,CAAb;AACA7nG,WAAKjO,OAAL,CAAa4wB,qBAAb;AACD;AACD,QAAI,CAAC,KAAKqkF,mBAAV,EAA+B;AAC7B,WAAKD,kBAAL,GAA0B,EAA1B;AACA,WAAKF,QAAL,GAAgB,EAAhB;AACA,WAAKC,aAAL,GAAqB,EAArB;AACD;AACF,GAVD,MAUO;AACL,QAAI,KAAKJ,cAAT,EAAyB;AACvB,WAAKA,cAAL,CAAoB30G,OAApB,CAA4B,KAAK+1G,qBAAjC,EAAwD,IAAxD;AACA,WAAK,IAAMv1G,EAAX,IAAiB,KAAKq0G,qBAAtB,EAA6C;AAC3C,aAAKkB,qBAAL,CAA2B,KAAKlB,qBAAL,CAA2Br0G,EAA3B,CAA3B;AACD;AACF;AACF;AACD,MAAI,KAAKy0G,mBAAT,EAA8B;AAC5B,SAAKA,mBAAL,CAAyB5uF,KAAzB;AACD;;AAED,MAAI,KAAKsuF,cAAT,EAAyB;AACvB,SAAKA,cAAL,CAAoBtuF,KAApB;AACD;AACD,OAAKuuF,mBAAL,CAAyBvuF,KAAzB;AACA,OAAKwuF,qBAAL,GAA6B,EAA7B;;AAEA,MAAMmB,aAAa,IAAIrkC,iBAAJ,CAAsBtJ,0BAAgB1wB,KAAtC,CAAnB;AACA,OAAK9wB,aAAL,CAAmBmvF,UAAnB;AACA,OAAK7sF,OAAL;AACD,CAhCD;;AAmCA;;;;;;;;;;;;AAYAzqB,aAAa8b,SAAb,CAAuBy7F,cAAvB,GAAwC,UAAS59E,QAAT,EAAmB;AACzD,MAAI,KAAKs8E,cAAT,EAAyB;AACvB,WAAO,KAAKA,cAAL,CAAoB30G,OAApB,CAA4Bq4B,QAA5B,CAAP;AACD,GAFD,MAEO,IAAI,KAAK48E,mBAAT,EAA8B;AACnC,WAAO,KAAKA,mBAAL,CAAyBj1G,OAAzB,CAAiCq4B,QAAjC,CAAP;AACD;AACF,CAND;;AASA;;;;;;;;;;;;AAYA35B,aAAa8b,SAAb,CAAuB07F,gCAAvB,GAA0D,UAASnoF,UAAT,EAAqBsK,QAArB,EAA+B;AACvF,MAAM3O,SAAS,CAACqE,WAAW,CAAX,CAAD,EAAgBA,WAAW,CAAX,CAAhB,EAA+BA,WAAW,CAAX,CAA/B,EAA8CA,WAAW,CAAX,CAA9C,CAAf;AACA,SAAO,KAAKmhF,sBAAL,CAA4BxlF,MAA5B,EAAoC,UAAS3a,OAAT,EAAkB;AAC3D,QAAMuZ,WAAWvZ,QAAQ8Z,WAAR,EAAjB;AACA,QAAIP,SAAS28B,oBAAT,CAA8Bl3B,UAA9B,CAAJ,EAA+C;AAC7C,aAAOsK,SAAStpB,OAAT,CAAP;AACD,KAFD,MAEO;AACL,aAAO7N,SAAP;AACD;AACF,GAPM,CAAP;AAQD,CAVD;;AAaA;;;;;;;;;;;;;;;;;;;AAmBAxC,aAAa8b,SAAb,CAAuB00F,sBAAvB,GAAgD,UAASxlF,MAAT,EAAiB2O,QAAjB,EAA2B;AACzE,MAAI,KAAKs8E,cAAT,EAAyB;AACvB,WAAO,KAAKA,cAAL,CAAoBzoC,eAApB,CAAoCxiD,MAApC,EAA4C2O,QAA5C,CAAP;AACD,GAFD,MAEO,IAAI,KAAK48E,mBAAT,EAA8B;AACnC,WAAO,KAAKA,mBAAL,CAAyBj1G,OAAzB,CAAiCq4B,QAAjC,CAAP;AACD;AACF,CAND;;AASA;;;;;;;;;;;;;;;AAeA35B,aAAa8b,SAAb,CAAuB27F,gCAAvB,GAA0D,UAASzsF,MAAT,EAAiB2O,QAAjB,EAA2B;AACnF,SAAO,KAAK62E,sBAAL,CAA4BxlF,MAA5B;AACL;;;;;AAKA,YAAS3a,OAAT,EAAkB;AAChB,QAAMuZ,WAAWvZ,QAAQ8Z,WAAR,EAAjB;AACA,QAAIP,SAASy8B,gBAAT,CAA0Br7B,MAA1B,CAAJ,EAAuC;AACrC,UAAM7pB,SAASw4B,SAAStpB,OAAT,CAAf;AACA,UAAIlP,MAAJ,EAAY;AACV,eAAOA,MAAP;AACD;AACF;AACF,GAdI,CAAP;AAeD,CAhBD;;AAmBA;;;;;;;AAOAnB,aAAa8b,SAAb,CAAuB41D,qBAAvB,GAA+C,YAAW;AACxD,SAAO,KAAK6kC,mBAAZ;AACD,CAFD;;AAKA;;;;;AAKAv2G,aAAa8b,SAAb,CAAuB4tD,WAAvB,GAAqC,YAAW;AAC9C,MAAIzvC,iBAAJ;AACA,MAAI,KAAKs8E,mBAAT,EAA8B;AAC5Bt8E,eAAW,KAAKs8E,mBAAL,CAAyBxuF,QAAzB,EAAX;AACD,GAFD,MAEO,IAAI,KAAKkuF,cAAT,EAAyB;AAC9Bh8E,eAAW,KAAKg8E,cAAL,CAAoByB,MAApB,EAAX;AACA,QAAI,CAAC,kBAAQ,KAAKvB,qBAAb,CAAL,EAA0C;AACxC,yBAAOl8E,QAAP,EAAiB,oBAAU,KAAKk8E,qBAAf,CAAjB;AACD;AACF;AACD;AACE,4CAA0Cl8E;AAD5C;AAGD,CAbD;;AAgBA;;;;;;AAMAj6B,aAAa8b,SAAb,CAAuB67F,uBAAvB,GAAiD,UAAStoF,UAAT,EAAqB;AACpE,MAAM4K,WAAW,EAAjB;AACA,OAAKu9E,gCAAL,CAAsCnoF,UAAtC,EAAkD,UAAShf,OAAT,EAAkB;AAClE4pB,aAASr2B,IAAT,CAAcyM,OAAd;AACD,GAFD;AAGA,SAAO4pB,QAAP;AACD,CAND;;AASA;;;;;;;;;;;AAWAj6B,aAAa8b,SAAb,CAAuB87F,mBAAvB,GAA6C,UAAS5sF,MAAT,EAAiB;AAC5D,SAAO,KAAKirF,cAAL,CAAoBtqC,WAApB,CAAgC3gD,MAAhC,CAAP;AACD,CAFD;;AAKA;;;;;;;;;;;;AAYAhrB,aAAa8b,SAAb,CAAuB+7F,6BAAvB,GAAuD,UAASxoF,UAAT,EAAqByoF,UAArB,EAAiC;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM9rG,IAAIqjB,WAAW,CAAX,CAAV;AACA,MAAMtV,IAAIsV,WAAW,CAAX,CAAV;AACA,MAAI0oF,iBAAiB,IAArB;AACA,MAAM9xD,eAAe,CAACsB,GAAD,EAAMA,GAAN,CAArB;AACA,MAAIrB,qBAAqBl2C,QAAzB;AACA,MAAMgb,SAAS,CAAC,CAAChb,QAAF,EAAY,CAACA,QAAb,EAAuBA,QAAvB,EAAiCA,QAAjC,CAAf;AACA,MAAM3M,SAASy0G,aAAaA,UAAb,GAA0Bh+E,eAAzC;AACA,OAAKm8E,cAAL,CAAoBzoC,eAApB,CAAoCxiD,MAApC;AACE;;;AAGA,YAAS3a,OAAT,EAAkB;AAChB,QAAIhN,OAAOgN,OAAP,CAAJ,EAAqB;AACnB,UAAMuZ,WAAWvZ,QAAQ8Z,WAAR,EAAjB;AACA,UAAM6tF,6BAA6B9xD,kBAAnC;AACAA,2BAAqBt8B,SAASo8B,cAAT,CACnBh6C,CADmB,EAChB+N,CADgB,EACbksC,YADa,EACCC,kBADD,CAArB;AAEA,UAAIA,qBAAqB8xD,0BAAzB,EAAqD;AACnDD,yBAAiB1nG,OAAjB;AACA;AACA;AACA;AACA;AACA,YAAM4nG,cAActyG,KAAKsG,IAAL,CAAUi6C,kBAAV,CAApB;AACAl7B,eAAO,CAAP,IAAYhf,IAAIisG,WAAhB;AACAjtF,eAAO,CAAP,IAAYjR,IAAIk+F,WAAhB;AACAjtF,eAAO,CAAP,IAAYhf,IAAIisG,WAAhB;AACAjtF,eAAO,CAAP,IAAYjR,IAAIk+F,WAAhB;AACD;AACF;AACF,GAvBH;AAwBA,SAAOF,cAAP;AACD,CAxCD;;AA2CA;;;;;;;;;;AAUA/3G,aAAa8b,SAAb,CAAuBwP,SAAvB,GAAmC,UAASsyB,UAAT,EAAqB;AACtD,SAAO,KAAKq4D,cAAL,CAAoB3qF,SAApB,CAA8BsyB,UAA9B,CAAP;AACD,CAFD;;AAKA;;;;;;;;;AASA59C,aAAa8b,SAAb,CAAuBo8F,cAAvB,GAAwC,UAASp2G,EAAT,EAAa;AACnD,MAAMuO,UAAU,KAAK+lG,QAAL,CAAct0G,GAAG2C,QAAH,EAAd,CAAhB;AACA,SAAO4L,YAAY7N,SAAZ,GAAwB6N,OAAxB,GAAkC,IAAzC;AACD,CAHD;;AAMA;;;;;;AAMArQ,aAAa8b,SAAb,CAAuBq8F,SAAvB,GAAmC,YAAW;AAC5C,SAAO,KAAKxC,OAAZ;AACD,CAFD;;AAKA;;;AAGA31G,aAAa8b,SAAb,CAAuBq0F,WAAvB,GAAqC,YAAW;AAC9C,SAAO,KAAKrP,SAAZ;AACD,CAFD;;AAKA;;;AAGA9gG,aAAa8b,SAAb,CAAuB4sB,cAAvB,GAAwC,YAAW,CAAE,CAArD;;AAGA;;;;;;AAMA1oC,aAAa8b,SAAb,CAAuBs8F,MAAvB,GAAgC,YAAW;AACzC,SAAO,KAAKxC,IAAZ;AACD,CAFD;;AAKA;;;;AAIA51G,aAAa8b,SAAb,CAAuByuD,oBAAvB,GAA8C,UAAS54C,KAAT,EAAgB;AAC5D,MAAMthB,UAAU,gCAAkCshB,MAAMrxB,MAAxD;AACA,MAAMs2G,aAAa,mBAAOvmG,OAAP,EAAgB5L,QAAhB,EAAnB;AACA,MAAMmlB,WAAWvZ,QAAQ8Z,WAAR,EAAjB;AACA,MAAI,CAACP,QAAL,EAAe;AACb,QAAI,EAAEgtF,cAAc,KAAKT,qBAArB,CAAJ,EAAiD;AAC/C,UAAI,KAAKF,cAAT,EAAyB;AACvB,aAAKA,cAAL,CAAoB1tF,MAApB,CAA2BlY,OAA3B;AACD;AACD,WAAK8lG,qBAAL,CAA2BS,UAA3B,IAAyCvmG,OAAzC;AACD;AACF,GAPD,MAOO;AACL,QAAM2a,SAASpB,SAAS0B,SAAT,EAAf;AACA,QAAIsrF,cAAc,KAAKT,qBAAvB,EAA8C;AAC5C,aAAO,KAAKA,qBAAL,CAA2BS,UAA3B,CAAP;AACA,UAAI,KAAKX,cAAT,EAAyB;AACvB,aAAKA,cAAL,CAAoBlrC,MAApB,CAA2B//C,MAA3B,EAAmC3a,OAAnC;AACD;AACF,KALD,MAKO;AACL,UAAI,KAAK4lG,cAAT,EAAyB;AACvB,aAAKA,cAAL,CAAoB7oF,MAApB,CAA2BpC,MAA3B,EAAmC3a,OAAnC;AACD;AACF;AACF;AACD,MAAMvO,KAAKuO,QAAQia,KAAR,EAAX;AACA,MAAIxoB,OAAOU,SAAX,EAAsB;AACpB,QAAM61G,MAAMv2G,GAAG2C,QAAH,EAAZ;AACA,QAAImyG,cAAc,KAAKP,aAAvB,EAAsC;AACpC,aAAO,KAAKA,aAAL,CAAmBO,UAAnB,CAAP;AACA,WAAKR,QAAL,CAAciC,GAAd,IAAqBhoG,OAArB;AACD,KAHD,MAGO;AACL,UAAI,KAAK+lG,QAAL,CAAciC,GAAd,MAAuBhoG,OAA3B,EAAoC;AAClC,aAAKioG,kBAAL,CAAwBjoG,OAAxB;AACA,aAAK+lG,QAAL,CAAciC,GAAd,IAAqBhoG,OAArB;AACD;AACF;AACF,GAXD,MAWO;AACL,QAAI,EAAEumG,cAAc,KAAKP,aAArB,CAAJ,EAAyC;AACvC,WAAKiC,kBAAL,CAAwBjoG,OAAxB;AACA,WAAKgmG,aAAL,CAAmBO,UAAnB,IAAiCvmG,OAAjC;AACD;AACF;AACD,OAAKoa,OAAL;AACA,OAAKtC,aAAL,CAAmB,IAAI8qD,iBAAJ,CACjBtJ,0BAAgB4uC,aADC,EACcloG,OADd,CAAnB;AAED,CA7CD;;AA+CA;;;;;;AAMArQ,aAAa8b,SAAb,CAAuBmsF,UAAvB,GAAoC,UAAS53F,OAAT,EAAkB;AACpD,MAAMvO,KAAKuO,QAAQia,KAAR,EAAX;AACA,MAAIxoB,OAAOU,SAAX,EAAsB;AACpB,WAAOV,MAAM,KAAKs0G,QAAlB;AACD,GAFD,MAEO;AACL,QAAMQ,aAAa,mBAAOvmG,OAAP,EAAgB5L,QAAhB,EAAnB;AACA,WAAOmyG,cAAc,KAAKP,aAA1B;AACD;AACF,CARD;;AAUA;;;AAGAr2G,aAAa8b,SAAb,CAAuBihB,OAAvB,GAAiC,YAAW;AAC1C,SAAO,KAAKk5E,cAAL,CAAoBl5E,OAApB,MAAiC,kBAAQ,KAAKo5E,qBAAb,CAAxC;AACD,CAFD;;AAKA;;;;;AAKAn2G,aAAa8b,SAAb,CAAuBs0F,YAAvB,GAAsC,UAASplF,MAAT,EAAiBC,UAAjB,EAA6BiY,UAA7B,EAAyC;AAAA;;AAC7E,MAAMs1E,qBAAqB,KAAKtC,mBAAhC;AACA,MAAMuC,gBAAgB,KAAK3C,SAAL,CAAe9qF,MAAf,EAAuBC,UAAvB,CAAtB;;AAF6E,6BAGpErpB,CAHoE,EAG7DwkB,EAH6D;AAI3E,QAAMsyF,eAAeD,cAAc72G,CAAd,CAArB;AACA,QAAM+2G,gBAAgBH,mBAAmBhrC,eAAnB,CAAmCkrC,YAAnC;AACpB;;;;AAIA,cAAS7yG,MAAT,EAAiB;AACf,aAAO,4BAAeA,OAAOmlB,MAAtB,EAA8B0tF,YAA9B,CAAP;AACD,KAPmB,CAAtB;AAQA,QAAI,CAACC,aAAL,EAAoB;AAClB,YAAK5sF,OAAL,CAAa5O,IAAb,CAAkB,KAAlB,EAAwBu7F,YAAxB,EAAsCztF,UAAtC,EAAkDiY,UAAlD;AACAs1E,yBAAmBztC,MAAnB,CAA0B2tC,YAA1B,EAAwC,EAAC1tF,QAAQ0tF,aAAaj3G,KAAb,EAAT,EAAxC;AACD;AAhB0E;;AAG7E,OAAK,IAAIG,IAAI,CAAR,EAAWwkB,KAAKqyF,cAAc52G,MAAnC,EAA2CD,IAAIwkB,EAA/C,EAAmD,EAAExkB,CAArD,EAAwD;AAAA,UAA/CA,CAA+C,EAAxCwkB,EAAwC;AAcvD;AACF,CAlBD;;AAqBA;;;;;AAKApmB,aAAa8b,SAAb,CAAuB88F,kBAAvB,GAA4C,UAAS5tF,MAAT,EAAiB;AAC3D,MAAMwtF,qBAAqB,KAAKtC,mBAAhC;AACA,MAAIhsG,YAAJ;AACAsuG,qBAAmBhrC,eAAnB,CAAmCxiD,MAAnC,EAA2C,UAASnlB,MAAT,EAAiB;AAC1D,QAAI,oBAAOA,OAAOmlB,MAAd,EAAsBA,MAAtB,CAAJ,EAAmC;AACjC9gB,YAAMrE,MAAN;AACA,aAAO,IAAP;AACD;AACF,GALD;AAMA,MAAIqE,GAAJ,EAAS;AACPsuG,uBAAmBjwF,MAAnB,CAA0Bre,GAA1B;AACD;AACF,CAZD;;AAeA;;;;;;;AAOAlK,aAAa8b,SAAb,CAAuB6uD,aAAvB,GAAuC,UAASt6D,OAAT,EAAkB;AACvD,MAAMumG,aAAa,mBAAOvmG,OAAP,EAAgB5L,QAAhB,EAAnB;AACA,MAAImyG,cAAc,KAAKT,qBAAvB,EAA8C;AAC5C,WAAO,KAAKA,qBAAL,CAA2BS,UAA3B,CAAP;AACD,GAFD,MAEO;AACL,QAAI,KAAKX,cAAT,EAAyB;AACvB,WAAKA,cAAL,CAAoB1tF,MAApB,CAA2BlY,OAA3B;AACD;AACF;AACD,OAAKgnG,qBAAL,CAA2BhnG,OAA3B;AACA,OAAKoa,OAAL;AACD,CAXD;;AAcA;;;;;AAKAzqB,aAAa8b,SAAb,CAAuBu7F,qBAAvB,GAA+C,UAAShnG,OAAT,EAAkB;AAC/D,MAAMumG,aAAa,mBAAOvmG,OAAP,EAAgB5L,QAAhB,EAAnB;AACA,OAAK6xG,kBAAL,CAAwBM,UAAxB,EAAoCt1G,OAApC,CAA4C4wB,qBAA5C;AACA,SAAO,KAAKokF,kBAAL,CAAwBM,UAAxB,CAAP;AACA,MAAM90G,KAAKuO,QAAQia,KAAR,EAAX;AACA,MAAIxoB,OAAOU,SAAX,EAAsB;AACpB,WAAO,KAAK4zG,QAAL,CAAct0G,GAAG2C,QAAH,EAAd,CAAP;AACD,GAFD,MAEO;AACL,WAAO,KAAK4xG,aAAL,CAAmBO,UAAnB,CAAP;AACD;AACD,OAAKzuF,aAAL,CAAmB,IAAI8qD,iBAAJ,CACjBtJ,0BAAgBG,aADC,EACcz5D,OADd,CAAnB;AAED,CAZD;;AAeA;;;;;;;AAOArQ,aAAa8b,SAAb,CAAuBw8F,kBAAvB,GAA4C,UAASjoG,OAAT,EAAkB;AAC5D,MAAIwoG,UAAU,KAAd;AACA,OAAK,IAAM/2G,EAAX,IAAiB,KAAKs0G,QAAtB,EAAgC;AAC9B,QAAI,KAAKA,QAAL,CAAct0G,EAAd,MAAsBuO,OAA1B,EAAmC;AACjC,aAAO,KAAK+lG,QAAL,CAAct0G,EAAd,CAAP;AACA+2G,gBAAU,IAAV;AACA;AACD;AACF;AACD,SAAOA,OAAP;AACD,CAVD;;AAaA;;;;;;AAMA74G,aAAa8b,SAAb,CAAuBg9F,SAAvB,GAAmC,UAASjD,MAAT,EAAiB;AAClD,OAAK9pF,OAAL,GAAe8pF,MAAf;AACD,CAFD;;kBAIe71G,Y;;;;;;;;;;;;;;;;;ACt9Bf;;;;AAIA;;;kBAGe;AACb;;;;;AAKA4pE,cAAY,YANC;;AAQb;;;;;AAKA2uC,iBAAe,eAbF;;AAeb;;;;;AAKAt/D,SAAO,OApBM;;AAsBb;;;;;;AAMA6wB,iBAAe;AA5BF,C;;;;;;;;;;;;;;;;;;QCoCCl8C,W,GAAAA,W;QAwCAhG,S,GAAAA,S;QAgGA60B,O,GAAAA,O;QA+DAvT,M,GAAAA,M;;AAxOhB;;AACA;;;;;;AAGA;;;;;;;;;;;AAYA;;;;;AA1BA;;;;;;;AAOA;;;AAwBO,IAAM6vE,0CAAiB,SAAvB;;AAGP;;;;;;;;;AASO,SAASnrF,WAAT,CAAqBorF,EAArB,EAAyBC,EAAzB,EAA6BvzD,UAA7B,EAAyC;AAC9C,MAAME,SAASF,cAAcqzD,cAA7B;AACA,MAAMG,OAAO,qBAAUF,GAAG,CAAH,CAAV,CAAb;AACA,MAAMG,OAAO,qBAAUF,GAAG,CAAH,CAAV,CAAb;AACA,MAAMG,cAAc,CAACD,OAAOD,IAAR,IAAgB,CAApC;AACA,MAAMG,cAAc,qBAAUJ,GAAG,CAAH,IAAQD,GAAG,CAAH,CAAlB,IAA2B,CAA/C;AACA,MAAMlvG,IAAInE,KAAK2G,GAAL,CAAS8sG,WAAT,IAAwBzzG,KAAK2G,GAAL,CAAS8sG,WAAT,CAAxB,GACNzzG,KAAK2G,GAAL,CAAS+sG,WAAT,IAAwB1zG,KAAK2G,GAAL,CAAS+sG,WAAT,CAAxB,GACA1zG,KAAK4G,GAAL,CAAS2sG,IAAT,CADA,GACiBvzG,KAAK4G,GAAL,CAAS4sG,IAAT,CAFrB;AAGA,SAAO,IAAIvzD,MAAJ,GAAajgD,KAAK4U,KAAL,CAAW5U,KAAKsG,IAAL,CAAUnC,CAAV,CAAX,EAAyBnE,KAAKsG,IAAL,CAAU,IAAInC,CAAd,CAAzB,CAApB;AACD;;AAGD;;;;;;AAMA,SAASwvG,iBAAT,CAA2B97D,WAA3B,EAAwCoI,MAAxC,EAAgD;AAC9C,MAAI/jD,SAAS,CAAb;AACA,OAAK,IAAID,IAAI,CAAR,EAAWwkB,KAAKo3B,YAAY37C,MAAjC,EAAyCD,IAAIwkB,KAAK,CAAlD,EAAqD,EAAExkB,CAAvD,EAA0D;AACxDC,cAAU+rB,YAAY4vB,YAAY57C,CAAZ,CAAZ,EAA4B47C,YAAY57C,IAAI,CAAhB,CAA5B,EAAgDgkD,MAAhD,CAAV;AACD;AACD,SAAO/jD,MAAP;AACD;;AAGD;;;;;;;;;;;;AAYO,SAAS+lB,SAAT,CAAmBgC,QAAnB,EAA6BxC,WAA7B,EAA0C;AAC/C,MAAMze,UAAUye,eAAe,EAA/B;AACA,MAAMw+B,SAASj9C,QAAQi9C,MAAR,IAAkBmzD,cAAjC;AACA,MAAM71E,aAAav6B,QAAQu6B,UAAR,IAAsB,WAAzC;AACA,MAAMhhC,OAAO0nB,SAAS5O,OAAT,EAAb;AACA,MAAI9Y,SAASsnC,uBAAa6f,mBAA1B,EAA+C;AAC7Cz/B,eAAWA,SAASG,KAAT,GAAiB0oB,SAAjB,CAA2BvP,UAA3B,EAAuC,WAAvC,CAAX;AACD;AACD,MAAIrhC,SAAS,CAAb;AACA,MAAI27C,oBAAJ;AAAA,MAAiB5T,eAAjB;AAAA,MAAyBhoC,UAAzB;AAAA,MAA4BwkB,WAA5B;AAAA,MAAgCtb,UAAhC;AAAA,MAAmC27B,WAAnC;AACA,UAAQvkC,IAAR;AACE,SAAKsnC,uBAAaigB,KAAlB;AACA,SAAKjgB,uBAAaqgB,WAAlB;AAA+B;AAC7B;AACD;AACD,SAAKrgB,uBAAakgB,WAAlB;AACA,SAAKlgB,uBAAamgB,WAAlB;AAA+B;AAC7BnM,sBAAc,4CAA8C5zB,QAAD,CAAW26B,cAAX,EAA3D;AACA1iD,iBAASy3G,kBAAkB97D,WAAlB,EAA+BoI,MAA/B,CAAT;AACA;AACD;AACD,SAAKpc,uBAAasgB,iBAAlB;AACA,SAAKtgB,uBAAaogB,OAAlB;AAA2B;AACzBpM,sBAAc,4CAA8C5zB,QAAD,CAAW26B,cAAX,EAA3D;AACA,aAAK3iD,IAAI,CAAJ,EAAOwkB,KAAKo3B,YAAY37C,MAA7B,EAAqCD,IAAIwkB,EAAzC,EAA6C,EAAExkB,CAA/C,EAAkD;AAChDC,oBAAUy3G,kBAAkB97D,YAAY57C,CAAZ,CAAlB,EAAkCgkD,MAAlC,CAAV;AACD;AACD;AACD;AACD,SAAKpc,uBAAaugB,aAAlB;AAAiC;AAC/BvM,sBAAc,4CAA8C5zB,QAAD,CAAW26B,cAAX,EAA3D;AACA,aAAK3iD,IAAI,CAAJ,EAAOwkB,KAAKo3B,YAAY37C,MAA7B,EAAqCD,IAAIwkB,EAAzC,EAA6C,EAAExkB,CAA/C,EAAkD;AAChDgoC,mBAAS4T,YAAY57C,CAAZ,CAAT;AACA,eAAKkJ,IAAI,CAAJ,EAAO27B,KAAKmD,OAAO/nC,MAAxB,EAAgCiJ,IAAI27B,EAApC,EAAwC,EAAE37B,CAA1C,EAA6C;AAC3CjJ,sBAAUy3G,kBAAkB1vE,OAAO9+B,CAAP,CAAlB,EAA6B86C,MAA7B,CAAV;AACD;AACF;AACD;AACD;AACD,SAAKpc,uBAAa6f,mBAAlB;AAAuC;AACrC,YAAMxF,aAAa,gDAAkDj6B,QAAD,CAAWm/B,aAAX,EAApE;AACA,aAAKnnD,IAAI,CAAJ,EAAOwkB,KAAKy9B,WAAWhiD,MAA5B,EAAoCD,IAAIwkB,EAAxC,EAA4C,EAAExkB,CAA9C,EAAiD;AAC/CC,oBAAU+lB,UAAUi8B,WAAWjiD,CAAX,CAAV,EAAyBwlB,WAAzB,CAAV;AACD;AACD;AACD;AACD;AAAS;AACP,cAAM,IAAIzU,KAAJ,CAAU,gCAAgCzQ,IAA1C,CAAN;AACD;AAtCH;AAwCA,SAAOL,MAAP;AACD;;AAGD;;;;;;;;;;;;;;AAcA,SAAS03G,eAAT,CAAyB/7D,WAAzB,EAAsCoI,MAAtC,EAA8C;AAC5C,MAAIrH,OAAO,CAAX;AACA,MAAMjiC,MAAMkhC,YAAY37C,MAAxB;AACA,MAAIilC,KAAK0W,YAAYlhC,MAAM,CAAlB,EAAqB,CAArB,CAAT;AACA,MAAIyqB,KAAKyW,YAAYlhC,MAAM,CAAlB,EAAqB,CAArB,CAAT;AACA,OAAK,IAAI1a,IAAI,CAAb,EAAgBA,IAAI0a,GAApB,EAAyB1a,GAAzB,EAA8B;AAC5B,QAAMwa,KAAKohC,YAAY57C,CAAZ,EAAe,CAAf,CAAX;AACA,QAAM+yC,KAAK6I,YAAY57C,CAAZ,EAAe,CAAf,CAAX;AACA28C,YAAQ,qBAAUniC,KAAK0qB,EAAf,KACH,IAAInhC,KAAK2G,GAAL,CAAS,qBAAUy6B,EAAV,CAAT,CAAJ,GACDphC,KAAK2G,GAAL,CAAS,qBAAUqoC,EAAV,CAAT,CAFI,CAAR;AAGA7N,SAAK1qB,EAAL;AACA2qB,SAAK4N,EAAL;AACD;AACD,SAAO4J,OAAOqH,MAAP,GAAgBA,MAAhB,GAAyB,GAAhC;AACD;;AAGD;;;;;;;;;;AAUO,SAASnJ,OAAT,CAAiB7yB,QAAjB,EAA2BxC,WAA3B,EAAwC;AAC7C,MAAMze,UAAUye,eAAe,EAA/B;AACA,MAAMw+B,SAASj9C,QAAQi9C,MAAR,IAAkBmzD,cAAjC;AACA,MAAM71E,aAAav6B,QAAQu6B,UAAR,IAAsB,WAAzC;AACA,MAAMhhC,OAAO0nB,SAAS5O,OAAT,EAAb;AACA,MAAI9Y,SAASsnC,uBAAa6f,mBAA1B,EAA+C;AAC7Cz/B,eAAWA,SAASG,KAAT,GAAiB0oB,SAAjB,CAA2BvP,UAA3B,EAAuC,WAAvC,CAAX;AACD;AACD,MAAIqb,OAAO,CAAX;AACA,MAAIf,oBAAJ;AAAA,MAAiB5T,eAAjB;AAAA,MAAyBhoC,UAAzB;AAAA,MAA4BwkB,WAA5B;AAAA,MAAgCtb,UAAhC;AAAA,MAAmC27B,WAAnC;AACA,UAAQvkC,IAAR;AACE,SAAKsnC,uBAAaigB,KAAlB;AACA,SAAKjgB,uBAAaqgB,WAAlB;AACA,SAAKrgB,uBAAakgB,WAAlB;AACA,SAAKlgB,uBAAasgB,iBAAlB;AACA,SAAKtgB,uBAAamgB,WAAlB;AAA+B;AAC7B;AACD;AACD,SAAKngB,uBAAaogB,OAAlB;AAA2B;AACzBpM,sBAAc,qCAAuC5zB,QAAD,CAAW26B,cAAX,EAApD;AACAhG,eAAO54C,KAAKmH,GAAL,CAASysG,gBAAgB/7D,YAAY,CAAZ,CAAhB,EAAgCoI,MAAhC,CAAT,CAAP;AACA,aAAKhkD,IAAI,CAAJ,EAAOwkB,KAAKo3B,YAAY37C,MAA7B,EAAqCD,IAAIwkB,EAAzC,EAA6C,EAAExkB,CAA/C,EAAkD;AAChD28C,kBAAQ54C,KAAKmH,GAAL,CAASysG,gBAAgB/7D,YAAY57C,CAAZ,CAAhB,EAAgCgkD,MAAhC,CAAT,CAAR;AACD;AACD;AACD;AACD,SAAKpc,uBAAaugB,aAAlB;AAAiC;AAC/BvM,sBAAc,4CAA8C5zB,QAAD,CAAW26B,cAAX,EAA3D;AACA,aAAK3iD,IAAI,CAAJ,EAAOwkB,KAAKo3B,YAAY37C,MAA7B,EAAqCD,IAAIwkB,EAAzC,EAA6C,EAAExkB,CAA/C,EAAkD;AAChDgoC,mBAAS4T,YAAY57C,CAAZ,CAAT;AACA28C,kBAAQ54C,KAAKmH,GAAL,CAASysG,gBAAgB3vE,OAAO,CAAP,CAAhB,EAA2Bgc,MAA3B,CAAT,CAAR;AACA,eAAK96C,IAAI,CAAJ,EAAO27B,KAAKmD,OAAO/nC,MAAxB,EAAgCiJ,IAAI27B,EAApC,EAAwC,EAAE37B,CAA1C,EAA6C;AAC3CyzC,oBAAQ54C,KAAKmH,GAAL,CAASysG,gBAAgB3vE,OAAO9+B,CAAP,CAAhB,EAA2B86C,MAA3B,CAAT,CAAR;AACD;AACF;AACD;AACD;AACD,SAAKpc,uBAAa6f,mBAAlB;AAAuC;AACrC,YAAMxF,aAAa,gDAAkDj6B,QAAD,CAAWm/B,aAAX,EAApE;AACA,aAAKnnD,IAAI,CAAJ,EAAOwkB,KAAKy9B,WAAWhiD,MAA5B,EAAoCD,IAAIwkB,EAAxC,EAA4C,EAAExkB,CAA9C,EAAiD;AAC/C28C,kBAAQ9B,QAAQoH,WAAWjiD,CAAX,CAAR,EAAuBwlB,WAAvB,CAAR;AACD;AACD;AACD;AACD;AAAS;AACP,cAAM,IAAIzU,KAAJ,CAAU,gCAAgCzQ,IAA1C,CAAN;AACD;AApCH;AAsCA,SAAOq8C,IAAP;AACD;;AAGD;;;;;;;;;;;AAWO,SAASrV,MAAT,CAAgB8vE,EAAhB,EAAoB5kE,QAApB,EAA8BolE,OAA9B,EAAuC9zD,UAAvC,EAAmD;AACxD,MAAME,SAASF,cAAcqzD,cAA7B;AACA,MAAMG,OAAO,qBAAUF,GAAG,CAAH,CAAV,CAAb;AACA,MAAMS,OAAO,qBAAUT,GAAG,CAAH,CAAV,CAAb;AACA,MAAMU,OAAOtlE,WAAWwR,MAAxB;AACA,MAAM+zD,MAAMh0G,KAAK8G,IAAL,CACV9G,KAAK2G,GAAL,CAAS4sG,IAAT,IAAiBvzG,KAAK4G,GAAL,CAASmtG,IAAT,CAAjB,GACE/zG,KAAK4G,GAAL,CAAS2sG,IAAT,IAAiBvzG,KAAK2G,GAAL,CAASotG,IAAT,CAAjB,GAAkC/zG,KAAK4G,GAAL,CAASitG,OAAT,CAF1B,CAAZ;AAGA,MAAM5yB,MAAM6yB,OAAO9zG,KAAK4U,KAAL,CACjB5U,KAAK2G,GAAL,CAASktG,OAAT,IAAoB7zG,KAAK2G,GAAL,CAASotG,IAAT,CAApB,GAAqC/zG,KAAK4G,GAAL,CAAS2sG,IAAT,CADpB,EAEjBvzG,KAAK4G,GAAL,CAASmtG,IAAT,IAAiB/zG,KAAK2G,GAAL,CAAS4sG,IAAT,IAAiBvzG,KAAK2G,GAAL,CAASqtG,GAAT,CAFjB,CAAnB;AAGA,SAAO,CAAC,qBAAU/yB,GAAV,CAAD,EAAiB,qBAAU+yB,GAAV,CAAjB,CAAP;AACD,C;;;;;;;;;;;;;;;;;QCpPeC,S,GAAAA,S;QAcAC,e,GAAAA,e;AAxBhB;;;;AAIA;;;;;;AAMO,SAASD,SAAT,CAAmB/0G,MAAnB,EAA2BuxB,KAA3B,EAAkC0jF,aAAlC,EAAiD;AACtD,MAAMC,eAAeD,kBAAkBt3G,SAAlB,GAA8BqC,OAAO0wC,OAAP,CAAeukE,aAAf,CAA9B,GAA8D,KAAKj1G,MAAxF;AACA,MAAIm1G,UAAUD,aAAa9sG,OAAb,CAAqB,GAArB,CAAd;AACA+sG,YAAUA,YAAY,CAAC,CAAb,GAAiBD,aAAal4G,MAA9B,GAAuCm4G,OAAjD;AACA,SAAOA,UAAU5jF,KAAV,GAAkB2jF,YAAlB,GAAiC,IAAI92G,KAAJ,CAAU,IAAImzB,KAAJ,GAAY4jF,OAAtB,EAA+Bz1G,IAA/B,CAAoC,GAApC,IAA2Cw1G,YAAnF;AACD;;AAGD;;;;;;AAMO,SAASF,eAAT,CAAyBI,EAAzB,EAA6BC,EAA7B,EAAiC;AACtC,MAAMC,KAAK,CAAC,KAAKF,EAAN,EAAUj2F,KAAV,CAAgB,GAAhB,CAAX;AACA,MAAMo2F,KAAK,CAAC,KAAKF,EAAN,EAAUl2F,KAAV,CAAgB,GAAhB,CAAX;;AAEA,OAAK,IAAIpiB,IAAI,CAAb,EAAgBA,IAAI+D,KAAKkH,GAAL,CAASstG,GAAGt4G,MAAZ,EAAoBu4G,GAAGv4G,MAAvB,CAApB,EAAoDD,GAApD,EAAyD;AACvD,QAAMy4G,KAAKj3F,SAAS+2F,GAAGv4G,CAAH,KAAS,GAAlB,EAAuB,EAAvB,CAAX;AACA,QAAM04G,KAAKl3F,SAASg3F,GAAGx4G,CAAH,KAAS,GAAlB,EAAuB,EAAvB,CAAX;;AAEA,QAAIy4G,KAAKC,EAAT,EAAa;AACX,aAAO,CAAP;AACD;AACD,QAAIA,KAAKD,EAAT,EAAa;AACX,aAAO,CAAC,CAAR;AACD;AACF;;AAED,SAAO,CAAP;AACD,C;;;;;;;;;;;;;;;;;;ACtCD;;AACA;;AACA;;;;AACA;;;;;;AAGA;;;;;;;;AASA;;;;;;;;;;;AAlBA;;;AA6BA,IAAMjtB,WAAW,SAAXA,QAAW,CAASmtB,iBAAT,EAA4B;;AAE3CnvF,wBAAYjO,IAAZ,CAAiB,IAAjB;;AAEA;;;AAGA,OAAKq9F,aAAL,GAAqBD,sBAAsB/3G,SAAtB,GAAkC+3G,iBAAlC,GAAsD,IAA3E;;AAEA;;;;AAIA,OAAKE,MAAL,GAAc,CAAd;;AAEA;;;;AAIA,OAAKC,QAAL,GAAgB,EAAhB;;AAEA;;;;AAIA,OAAKC,OAAL,GAAe,IAAf;;AAEA;;;;AAIA,OAAKC,OAAL,GAAe,IAAf;AAED,CAjCD;;AAmCA,qBAASxtB,QAAT,EAAmBhiE,qBAAnB;;AAGA;;;AAGAgiE,SAAStxE,SAAT,CAAmBkqF,cAAnB,GAAoC,YAAW;AAC7C,SAAO,KAAKzkE,QAAL,KAAkB,KAAKi5E,aAA9B;AACD,CAFD;;AAKA;;;AAGAptB,SAAStxE,SAAT,CAAmB6L,KAAnB,GAA2B,YAAW;AACpC,OAAK8yF,MAAL,GAAc,CAAd;AACA,OAAKC,QAAL,GAAgB,EAAhB;AACA,OAAKC,OAAL,GAAe,IAAf;AACA,OAAKC,OAAL,GAAe,IAAf;AACA,OAAKzyF,aAAL,CAAmBuC,oBAAUuuB,KAA7B;AACD,CAND;;AASA;;;;AAIAm0C,SAAStxE,SAAT,CAAmB4oF,WAAnB,GAAiC,UAASz6F,GAAT,EAAc;AAC7C,SAAO,KAAKywG,QAAL,CAAc59F,cAAd,CAA6B7S,GAA7B,CAAP;AACD,CAFD;;AAKA;;;;;;;;AAQAmjF,SAAStxE,SAAT,CAAmBxa,OAAnB,GAA6B,UAASoT,CAAT,EAAYylB,QAAZ,EAAsB;AACjD,MAAIsoE,QAAQ,KAAKkY,OAAjB;AACA,SAAOlY,KAAP,EAAc;AACZ/tF,MAAEyI,IAAF,CAAOgd,QAAP,EAAiBsoE,MAAMoY,MAAvB,EAA+BpY,MAAMqY,IAArC,EAA2C,IAA3C;AACArY,YAAQA,MAAMsY,KAAd;AACD;AACF,CAND;;AASA;;;;AAIA3tB,SAAStxE,SAAT,CAAmB3R,GAAnB,GAAyB,UAASF,GAAT,EAAc;AACrC,MAAMw4F,QAAQ,KAAKiY,QAAL,CAAczwG,GAAd,CAAd;AACA,uBAAOw4F,UAAUjgG,SAAjB,EACE,EADF,EAFqC,CAG9B;AACP,MAAIigG,UAAU,KAAKmY,OAAnB,EAA4B;AAC1B,WAAOnY,MAAMoY,MAAb;AACD,GAFD,MAEO,IAAIpY,UAAU,KAAKkY,OAAnB,EAA4B;AACjC,SAAKA,OAAL,GAAe,+CAAiD,KAAKA,OAAL,CAAaI,KAA7E;AACA,SAAKJ,OAAL,CAAaK,KAAb,GAAqB,IAArB;AACD,GAHM,MAGA;AACLvY,UAAMsY,KAAN,CAAYC,KAAZ,GAAoBvY,MAAMuY,KAA1B;AACAvY,UAAMuY,KAAN,CAAYD,KAAZ,GAAoBtY,MAAMsY,KAA1B;AACD;AACDtY,QAAMsY,KAAN,GAAc,IAAd;AACAtY,QAAMuY,KAAN,GAAc,KAAKJ,OAAnB;AACA,OAAKA,OAAL,CAAaG,KAAb,GAAqBtY,KAArB;AACA,OAAKmY,OAAL,GAAenY,KAAf;AACA,SAAOA,MAAMoY,MAAb;AACD,CAlBD;;AAqBA;;;;;AAKAztB,SAAStxE,SAAT,CAAmByM,MAAnB,GAA4B,UAASte,GAAT,EAAc;AACxC,MAAMw4F,QAAQ,KAAKiY,QAAL,CAAczwG,GAAd,CAAd;AACA,uBAAOw4F,UAAUjgG,SAAjB,EAA4B,EAA5B,EAFwC,CAEP;AACjC,MAAIigG,UAAU,KAAKmY,OAAnB,EAA4B;AAC1B,SAAKA,OAAL,GAAe,+CAAiDnY,MAAMuY,KAAtE;AACA,QAAI,KAAKJ,OAAT,EAAkB;AAChB,WAAKA,OAAL,CAAaG,KAAb,GAAqB,IAArB;AACD;AACF,GALD,MAKO,IAAItY,UAAU,KAAKkY,OAAnB,EAA4B;AACjC,SAAKA,OAAL,GAAe,+CAAiDlY,MAAMsY,KAAtE;AACA,QAAI,KAAKJ,OAAT,EAAkB;AAChB,WAAKA,OAAL,CAAaK,KAAb,GAAqB,IAArB;AACD;AACF,GALM,MAKA;AACLvY,UAAMsY,KAAN,CAAYC,KAAZ,GAAoBvY,MAAMuY,KAA1B;AACAvY,UAAMuY,KAAN,CAAYD,KAAZ,GAAoBtY,MAAMsY,KAA1B;AACD;AACD,SAAO,KAAKL,QAAL,CAAczwG,GAAd,CAAP;AACA,IAAE,KAAKwwG,MAAP;AACA,SAAOhY,MAAMoY,MAAb;AACD,CApBD;;AAuBA;;;AAGAztB,SAAStxE,SAAT,CAAmBylB,QAAnB,GAA8B,YAAW;AACvC,SAAO,KAAKk5E,MAAZ;AACD,CAFD;;AAKA;;;AAGArtB,SAAStxE,SAAT,CAAmB+X,OAAnB,GAA6B,YAAW;AACtC,MAAMtkB,OAAO,IAAItM,KAAJ,CAAU,KAAKw3G,MAAf,CAAb;AACA,MAAI74G,IAAI,CAAR;AACA,MAAI6gG,cAAJ;AACA,OAAKA,QAAQ,KAAKmY,OAAlB,EAA2BnY,KAA3B,EAAkCA,QAAQA,MAAMuY,KAAhD,EAAuD;AACrDzrG,SAAK3N,GAAL,IAAY6gG,MAAMqY,IAAlB;AACD;AACD,SAAOvrG,IAAP;AACD,CARD;;AAWA;;;AAGA69E,SAAStxE,SAAT,CAAmB++D,SAAnB,GAA+B,YAAW;AACxC,MAAM3pE,SAAS,IAAIjO,KAAJ,CAAU,KAAKw3G,MAAf,CAAf;AACA,MAAI74G,IAAI,CAAR;AACA,MAAI6gG,cAAJ;AACA,OAAKA,QAAQ,KAAKmY,OAAlB,EAA2BnY,KAA3B,EAAkCA,QAAQA,MAAMuY,KAAhD,EAAuD;AACrD9pG,WAAOtP,GAAP,IAAc6gG,MAAMoY,MAApB;AACD;AACD,SAAO3pG,MAAP;AACD,CARD;;AAWA;;;AAGAk8E,SAAStxE,SAAT,CAAmBm/F,QAAnB,GAA8B,YAAW;AACvC,SAAO,KAAKN,OAAL,CAAaE,MAApB;AACD,CAFD;;AAKA;;;AAGAztB,SAAStxE,SAAT,CAAmBo/F,WAAnB,GAAiC,YAAW;AAC1C,SAAO,KAAKP,OAAL,CAAaG,IAApB;AACD,CAFD;;AAKA;;;;AAIA1tB,SAAStxE,SAAT,CAAmBq/F,YAAnB,GAAkC,YAAW;AAC3C,SAAO,KAAKP,OAAL,CAAaE,IAApB;AACD,CAFD;;AAKA;;;AAGA1tB,SAAStxE,SAAT,CAAmBmI,GAAnB,GAAyB,YAAW;AAClC,MAAMw+E,QAAQ,KAAKkY,OAAnB;AACA,SAAO,KAAKD,QAAL,CAAcjY,MAAMqY,IAApB,CAAP;AACA,MAAIrY,MAAMsY,KAAV,EAAiB;AACftY,UAAMsY,KAAN,CAAYC,KAAZ,GAAoB,IAApB;AACD;AACD,OAAKL,OAAL,GAAe,+CAAiDlY,MAAMsY,KAAtE;AACA,MAAI,CAAC,KAAKJ,OAAV,EAAmB;AACjB,SAAKC,OAAL,GAAe,IAAf;AACD;AACD,IAAE,KAAKH,MAAP;AACA,SAAOhY,MAAMoY,MAAb;AACD,CAZD;;AAeA;;;;AAIAztB,SAAStxE,SAAT,CAAmB6H,OAAnB,GAA6B,UAAS1Z,GAAT,EAAc9E,KAAd,EAAqB;AAChD,OAAKgF,GAAL,CAASF,GAAT,EADgD,CAChC;AAChB,OAAKywG,QAAL,CAAczwG,GAAd,EAAmB4wG,MAAnB,GAA4B11G,KAA5B;AACD,CAHD;;AAMA;;;;AAIAioF,SAAStxE,SAAT,CAAmB6M,GAAnB,GAAyB,UAAS1e,GAAT,EAAc9E,KAAd,EAAqB;AAC5C,uBAAO,EAAE8E,OAAO,KAAKywG,QAAd,CAAP,EACE,EADF,EAD4C,CAErC;AACP,MAAMjY,QAAQ,+CAAiD;AAC7DqY,UAAM7wG,GADuD;AAE7D8wG,WAAO,IAFsD;AAG7DC,WAAO,KAAKJ,OAHiD;AAI7DC,YAAQ11G;AAJqD,GAA/D;AAMA,MAAI,CAAC,KAAKy1G,OAAV,EAAmB;AACjB,SAAKD,OAAL,GAAelY,KAAf;AACD,GAFD,MAEO;AACL,SAAKmY,OAAL,CAAaG,KAAb,GAAqBtY,KAArB;AACD;AACD,OAAKmY,OAAL,GAAenY,KAAf;AACA,OAAKiY,QAAL,CAAczwG,GAAd,IAAqBw4F,KAArB;AACA,IAAE,KAAKgY,MAAP;AACD,CAjBD;;AAoBA;;;;;AAKArtB,SAAStxE,SAAT,CAAmBgkB,OAAnB,GAA6B,UAASja,IAAT,EAAe;AAC1C,OAAK20F,aAAL,GAAqB30F,IAArB;AACD,CAFD;;AAKA;;;AAGAunE,SAAStxE,SAAT,CAAmB+nF,KAAnB,GAA2B,YAAW;AACpC,SAAO,KAAKmC,cAAL,EAAP,EAA8B;AAC5B,SAAK/hF,GAAL;AACD;AACF,CAJD;kBAKempE,Q;;;;;;;;;;;;;;;;;;;ACtSf;;AACA;;AAEA;;;;;;;;;;;;;;;AANA;;;AAqBA,IAAM1sD,gBAAgB,SAAhBA,aAAgB,CAAS06E,gBAAT,EAA2BC,WAA3B,EAAwC;;AAE5D;;;;AAIA,OAAKC,iBAAL,GAAyBF,gBAAzB;;AAEA;;;;AAIA,OAAKG,YAAL,GAAoBF,WAApB;;AAEA;;;;AAIA,OAAKG,SAAL,GAAiB,EAAjB;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmB,EAAnB;;AAEA;;;;AAIA,OAAKC,eAAL,GAAuB,EAAvB;AAED,CAhCD;;AAmCA;;;AAGO,IAAMx/E,sBAAOlsB,QAAb;;AAGP;;;AAGA0wB,cAAc5kB,SAAd,CAAwB6L,KAAxB,GAAgC,YAAW;AACzC,OAAK6zF,SAAL,CAAe35G,MAAf,GAAwB,CAAxB;AACA,OAAK45G,WAAL,CAAiB55G,MAAjB,GAA0B,CAA1B;AACA,kBAAM,KAAK65G,eAAX;AACD,CAJD;;AAOA;;;;AAIAh7E,cAAc5kB,SAAd,CAAwB0lB,OAAxB,GAAkC,YAAW;AAC3C,MAAMm6E,WAAW,KAAKH,SAAtB;AACA,MAAMI,aAAa,KAAKH,WAAxB;AACA,MAAMx0F,UAAU00F,SAAS,CAAT,CAAhB;AACA,MAAIA,SAAS95G,MAAT,IAAmB,CAAvB,EAA0B;AACxB85G,aAAS95G,MAAT,GAAkB,CAAlB;AACA+5G,eAAW/5G,MAAX,GAAoB,CAApB;AACD,GAHD,MAGO;AACL85G,aAAS,CAAT,IAAcA,SAAS13F,GAAT,EAAd;AACA23F,eAAW,CAAX,IAAgBA,WAAW33F,GAAX,EAAhB;AACA,SAAK43F,OAAL,CAAa,CAAb;AACD;AACD,MAAMC,aAAa,KAAKP,YAAL,CAAkBt0F,OAAlB,CAAnB;AACA,SAAO,KAAKy0F,eAAL,CAAqBI,UAArB,CAAP;AACA,SAAO70F,OAAP;AACD,CAfD;;AAkBA;;;;;AAKAyZ,cAAc5kB,SAAd,CAAwBglB,OAAxB,GAAkC,UAAS7Z,OAAT,EAAkB;AAClD,uBAAO,EAAE,KAAKs0F,YAAL,CAAkBt0F,OAAlB,KAA8B,KAAKy0F,eAArC,CAAP,EACE,EADF,EADkD,CAE3C;AACP,MAAMK,WAAW,KAAKT,iBAAL,CAAuBr0F,OAAvB,CAAjB;AACA,MAAI80F,YAAY7/E,IAAhB,EAAsB;AACpB,SAAKs/E,SAAL,CAAe53G,IAAf,CAAoBqjB,OAApB;AACA,SAAKw0F,WAAL,CAAiB73G,IAAjB,CAAsBm4G,QAAtB;AACA,SAAKL,eAAL,CAAqB,KAAKH,YAAL,CAAkBt0F,OAAlB,CAArB,IAAmD,IAAnD;AACA,SAAK+0F,SAAL,CAAe,CAAf,EAAkB,KAAKR,SAAL,CAAe35G,MAAf,GAAwB,CAA1C;AACA,WAAO,IAAP;AACD;AACD,SAAO,KAAP;AACD,CAZD;;AAeA;;;AAGA6+B,cAAc5kB,SAAd,CAAwBylB,QAAxB,GAAmC,YAAW;AAC5C,SAAO,KAAKi6E,SAAL,CAAe35G,MAAtB;AACD,CAFD;;AAKA;;;;;;AAMA6+B,cAAc5kB,SAAd,CAAwBmgG,kBAAxB,GAA6C,UAASh2G,KAAT,EAAgB;AAC3D,SAAOA,QAAQ,CAAR,GAAY,CAAnB;AACD,CAFD;;AAKA;;;;;;AAMAy6B,cAAc5kB,SAAd,CAAwBogG,mBAAxB,GAA8C,UAASj2G,KAAT,EAAgB;AAC5D,SAAOA,QAAQ,CAAR,GAAY,CAAnB;AACD,CAFD;;AAKA;;;;;;AAMAy6B,cAAc5kB,SAAd,CAAwBqgG,eAAxB,GAA0C,UAASl2G,KAAT,EAAgB;AACxD,SAAQA,QAAQ,CAAT,IAAe,CAAtB;AACD,CAFD;;AAKA;;;;AAIAy6B,cAAc5kB,SAAd,CAAwBsgG,QAAxB,GAAmC,YAAW;AAC5C,MAAIx6G,UAAJ;AACA,OAAKA,IAAI,CAAC,KAAK45G,SAAL,CAAe35G,MAAf,IAAyB,CAA1B,IAA+B,CAAxC,EAA2CD,KAAK,CAAhD,EAAmDA,GAAnD,EAAwD;AACtD,SAAKi6G,OAAL,CAAaj6G,CAAb;AACD;AACF,CALD;;AAQA;;;AAGA8+B,cAAc5kB,SAAd,CAAwBihB,OAAxB,GAAkC,YAAW;AAC3C,SAAO,KAAKy+E,SAAL,CAAe35G,MAAf,KAA0B,CAAjC;AACD,CAFD;;AAKA;;;;AAIA6+B,cAAc5kB,SAAd,CAAwB2qF,WAAxB,GAAsC,UAASx8F,GAAT,EAAc;AAClD,SAAOA,OAAO,KAAKyxG,eAAnB;AACD,CAFD;;AAKA;;;;AAIAh7E,cAAc5kB,SAAd,CAAwBugG,QAAxB,GAAmC,UAASp1F,OAAT,EAAkB;AACnD,SAAO,KAAKw/E,WAAL,CAAiB,KAAK8U,YAAL,CAAkBt0F,OAAlB,CAAjB,CAAP;AACD,CAFD;;AAKA;;;;AAIAyZ,cAAc5kB,SAAd,CAAwB+/F,OAAxB,GAAkC,UAAS51G,KAAT,EAAgB;AAChD,MAAM01G,WAAW,KAAKH,SAAtB;AACA,MAAMI,aAAa,KAAKH,WAAxB;AACA,MAAMz5B,QAAQ25B,SAAS95G,MAAvB;AACA,MAAMolB,UAAU00F,SAAS11G,KAAT,CAAhB;AACA,MAAM81G,WAAWH,WAAW31G,KAAX,CAAjB;AACA,MAAMq2G,aAAar2G,KAAnB;;AAEA,SAAOA,QAAS+7E,SAAS,CAAzB,EAA6B;AAC3B,QAAMu6B,SAAS,KAAKN,kBAAL,CAAwBh2G,KAAxB,CAAf;AACA,QAAMu2G,SAAS,KAAKN,mBAAL,CAAyBj2G,KAAzB,CAAf;;AAEA,QAAMw2G,oBAAoBD,SAASx6B,KAAT,IACtB45B,WAAWY,MAAX,IAAqBZ,WAAWW,MAAX,CADC,GAExBC,MAFwB,GAEfD,MAFX;;AAIAZ,aAAS11G,KAAT,IAAkB01G,SAASc,iBAAT,CAAlB;AACAb,eAAW31G,KAAX,IAAoB21G,WAAWa,iBAAX,CAApB;AACAx2G,YAAQw2G,iBAAR;AACD;;AAEDd,WAAS11G,KAAT,IAAkBghB,OAAlB;AACA20F,aAAW31G,KAAX,IAAoB81G,QAApB;AACA,OAAKC,SAAL,CAAeM,UAAf,EAA2Br2G,KAA3B;AACD,CAxBD;;AA2BA;;;;;AAKAy6B,cAAc5kB,SAAd,CAAwBkgG,SAAxB,GAAoC,UAASM,UAAT,EAAqBr2G,KAArB,EAA4B;AAC9D,MAAM01G,WAAW,KAAKH,SAAtB;AACA,MAAMI,aAAa,KAAKH,WAAxB;AACA,MAAMx0F,UAAU00F,SAAS11G,KAAT,CAAhB;AACA,MAAM81G,WAAWH,WAAW31G,KAAX,CAAjB;;AAEA,SAAOA,QAAQq2G,UAAf,EAA2B;AACzB,QAAMI,cAAc,KAAKP,eAAL,CAAqBl2G,KAArB,CAApB;AACA,QAAI21G,WAAWc,WAAX,IAA0BX,QAA9B,EAAwC;AACtCJ,eAAS11G,KAAT,IAAkB01G,SAASe,WAAT,CAAlB;AACAd,iBAAW31G,KAAX,IAAoB21G,WAAWc,WAAX,CAApB;AACAz2G,cAAQy2G,WAAR;AACD,KAJD,MAIO;AACL;AACD;AACF;AACDf,WAAS11G,KAAT,IAAkBghB,OAAlB;AACA20F,aAAW31G,KAAX,IAAoB81G,QAApB;AACD,CAlBD;;AAqBA;;;AAGAr7E,cAAc5kB,SAAd,CAAwB0hB,YAAxB,GAAuC,YAAW;AAChD,MAAM49E,mBAAmB,KAAKE,iBAA9B;AACA,MAAMK,WAAW,KAAKH,SAAtB;AACA,MAAMI,aAAa,KAAKH,WAAxB;AACA,MAAIx1G,QAAQ,CAAZ;AACA,MAAMiG,IAAIyvG,SAAS95G,MAAnB;AACA,MAAIolB,gBAAJ;AAAA,MAAarlB,UAAb;AAAA,MAAgBm6G,iBAAhB;AACA,OAAKn6G,IAAI,CAAT,EAAYA,IAAIsK,CAAhB,EAAmB,EAAEtK,CAArB,EAAwB;AACtBqlB,cAAU00F,SAAS/5G,CAAT,CAAV;AACAm6G,eAAWX,iBAAiBn0F,OAAjB,CAAX;AACA,QAAI80F,YAAY7/E,IAAhB,EAAsB;AACpB,aAAO,KAAKw/E,eAAL,CAAqB,KAAKH,YAAL,CAAkBt0F,OAAlB,CAArB,CAAP;AACD,KAFD,MAEO;AACL20F,iBAAW31G,KAAX,IAAoB81G,QAApB;AACAJ,eAAS11G,OAAT,IAAoBghB,OAApB;AACD;AACF;AACD00F,WAAS95G,MAAT,GAAkBoE,KAAlB;AACA21G,aAAW/5G,MAAX,GAAoBoE,KAApB;AACA,OAAKm2G,QAAL;AACD,CApBD;kBAqBe17E,a;;;;;;;;;;;;;;;;;;AC/Qf;;AACA;;;;AACA;;AACA;;;;AAEA;;;;;;;;;AASA;;;;;;;;;AAjBA;;;AA0BA,IAAMooC,QAAQ,SAARA,KAAQ,CAAS6zC,cAAT,EAAyB;;AAErC;;;AAGA,OAAKC,MAAL,GAAc,qBAAMD,cAAN,EAAsBn6G,SAAtB,CAAd;;AAEA;;;;;;AAMA,OAAKq6G,MAAL,GAAc,EAAd;AAED,CAfD;;AAkBA;;;;;AAKA/zC,MAAMhtD,SAAN,CAAgBivD,MAAhB,GAAyB,UAAS//C,MAAT,EAAiB7lB,KAAjB,EAAwB;AAC/C;AACA,MAAMoP,OAAO;AACXotB,UAAM3W,OAAO,CAAP,CADK;AAEX6W,UAAM7W,OAAO,CAAP,CAFK;AAGX4W,UAAM5W,OAAO,CAAP,CAHK;AAIX8W,UAAM9W,OAAO,CAAP,CAJK;AAKX7lB,WAAOA;AALI,GAAb;;AAQA,OAAKy3G,MAAL,CAAY7xC,MAAZ,CAAmBx2D,IAAnB;AACA,OAAKsoG,MAAL,CAAY,mBAAO13G,KAAP,CAAZ,IAA6BoP,IAA7B;AACD,CAZD;;AAeA;;;;;AAKAu0D,MAAMhtD,SAAN,CAAgB6P,IAAhB,GAAuB,UAAS+tD,OAAT,EAAkBxoE,MAAlB,EAA0B;AAC/C,MAAM4rG,QAAQ,IAAI75G,KAAJ,CAAUiO,OAAOrP,MAAjB,CAAd;AACA,OAAK,IAAID,IAAI,CAAR,EAAWkY,IAAI5I,OAAOrP,MAA3B,EAAmCD,IAAIkY,CAAvC,EAA0ClY,GAA1C,EAA+C;AAC7C,QAAMopB,SAAS0uD,QAAQ93E,CAAR,CAAf;AACA,QAAMuD,QAAQ+L,OAAOtP,CAAP,CAAd;;AAEA;AACA,QAAM2S,OAAO;AACXotB,YAAM3W,OAAO,CAAP,CADK;AAEX6W,YAAM7W,OAAO,CAAP,CAFK;AAGX4W,YAAM5W,OAAO,CAAP,CAHK;AAIX8W,YAAM9W,OAAO,CAAP,CAJK;AAKX7lB,aAAOA;AALI,KAAb;AAOA23G,UAAMl7G,CAAN,IAAW2S,IAAX;AACA,SAAKsoG,MAAL,CAAY,mBAAO13G,KAAP,CAAZ,IAA6BoP,IAA7B;AACD;AACD,OAAKqoG,MAAL,CAAYjxF,IAAZ,CAAiBmxF,KAAjB;AACD,CAlBD;;AAqBA;;;;;AAKAh0C,MAAMhtD,SAAN,CAAgByM,MAAhB,GAAyB,UAASpjB,KAAT,EAAgB;AACvC,MAAM2mE,MAAM,mBAAO3mE,KAAP,CAAZ;;AAEA;AACA;AACA,MAAMoP,OAAO,KAAKsoG,MAAL,CAAY/wC,GAAZ,CAAb;AACA,SAAO,KAAK+wC,MAAL,CAAY/wC,GAAZ,CAAP;AACA,SAAO,KAAK8wC,MAAL,CAAYr0F,MAAZ,CAAmBhU,IAAnB,MAA6B,IAApC;AACD,CARD;;AAWA;;;;;AAKAu0D,MAAMhtD,SAAN,CAAgBsR,MAAhB,GAAyB,UAASpC,MAAT,EAAiB7lB,KAAjB,EAAwB;AAC/C,MAAMoP,OAAO,KAAKsoG,MAAL,CAAY,mBAAO13G,KAAP,CAAZ,CAAb;AACA,MAAMm0E,OAAO,CAAC/kE,KAAKotB,IAAN,EAAYptB,KAAKstB,IAAjB,EAAuBttB,KAAKqtB,IAA5B,EAAkCrtB,KAAKutB,IAAvC,CAAb;AACA,MAAI,CAAC,oBAAOw3C,IAAP,EAAatuD,MAAb,CAAL,EAA2B;AACzB,SAAKzC,MAAL,CAAYpjB,KAAZ;AACA,SAAK4lE,MAAL,CAAY//C,MAAZ,EAAoB7lB,KAApB;AACD;AACF,CAPD;;AAUA;;;;AAIA2jE,MAAMhtD,SAAN,CAAgB47F,MAAhB,GAAyB,YAAW;AAClC,MAAMoF,QAAQ,KAAKF,MAAL,CAAYvjC,GAAZ,EAAd;AACA,SAAOyjC,MAAM18G,GAAN,CAAU,UAASmU,IAAT,EAAe;AAC9B,WAAOA,KAAKpP,KAAZ;AACD,GAFM,CAAP;AAGD,CALD;;AAQA;;;;;AAKA2jE,MAAMhtD,SAAN,CAAgB6vD,WAAhB,GAA8B,UAAS3gD,MAAT,EAAiB;AAC7C;AACA,MAAMsuD,OAAO;AACX33C,UAAM3W,OAAO,CAAP,CADK;AAEX6W,UAAM7W,OAAO,CAAP,CAFK;AAGX4W,UAAM5W,OAAO,CAAP,CAHK;AAIX8W,UAAM9W,OAAO,CAAP;AAJK,GAAb;AAMA,MAAM8xF,QAAQ,KAAKF,MAAL,CAAYG,MAAZ,CAAmBzjC,IAAnB,CAAd;AACA,SAAOwjC,MAAM18G,GAAN,CAAU,UAASmU,IAAT,EAAe;AAC9B,WAAOA,KAAKpP,KAAZ;AACD,GAFM,CAAP;AAGD,CAZD;;AAeA;;;;;;;;;AASA2jE,MAAMhtD,SAAN,CAAgBxa,OAAhB,GAA0B,UAASq4B,QAAT,EAAmBQ,QAAnB,EAA6B;AACrD,SAAO,KAAK6iF,QAAL,CAAc,KAAKtF,MAAL,EAAd,EAA6B/9E,QAA7B,EAAuCQ,QAAvC,CAAP;AACD,CAFD;;AAKA;;;;;;;;AAQA2uC,MAAMhtD,SAAN,CAAgB0xD,eAAhB,GAAkC,UAASxiD,MAAT,EAAiB2O,QAAjB,EAA2BQ,QAA3B,EAAqC;AACrE,SAAO,KAAK6iF,QAAL,CAAc,KAAKrxC,WAAL,CAAiB3gD,MAAjB,CAAd,EAAwC2O,QAAxC,EAAkDQ,QAAlD,CAAP;AACD,CAFD;;AAKA;;;;;;;;AAQA2uC,MAAMhtD,SAAN,CAAgBkhG,QAAhB,GAA2B,UAAS9rG,MAAT,EAAiByoB,QAAjB,EAA2BQ,QAA3B,EAAqC;AAC9D,MAAIh5B,eAAJ;AACA,OAAK,IAAIS,IAAI,CAAR,EAAWkY,IAAI5I,OAAOrP,MAA3B,EAAmCD,IAAIkY,CAAvC,EAA0ClY,GAA1C,EAA+C;AAC7CT,aAASw4B,SAASxc,IAAT,CAAcgd,QAAd,EAAwBjpB,OAAOtP,CAAP,CAAxB,CAAT;AACA,QAAIT,MAAJ,EAAY;AACV,aAAOA,MAAP;AACD;AACF;AACD,SAAOA,MAAP;AACD,CATD;;AAYA;;;AAGA2nE,MAAMhtD,SAAN,CAAgBihB,OAAhB,GAA0B,YAAW;AACnC,SAAO,kBAAQ,KAAK8/E,MAAb,CAAP;AACD,CAFD;;AAKA;;;AAGA/zC,MAAMhtD,SAAN,CAAgB6L,KAAhB,GAAwB,YAAW;AACjC,OAAKi1F,MAAL,CAAYj1F,KAAZ;AACA,OAAKk1F,MAAL,GAAc,EAAd;AACD,CAHD;;AAMA;;;;AAIA/zC,MAAMhtD,SAAN,CAAgBwP,SAAhB,GAA4B,UAASsyB,UAAT,EAAqB;AAC/C;AACA,MAAM96B,OAAO,KAAK85F,MAAL,CAAY95F,IAAzB;AACA,SAAO,4BAAeA,KAAK6e,IAApB,EAA0B7e,KAAK+e,IAA/B,EAAqC/e,KAAK8e,IAA1C,EAAgD9e,KAAKgf,IAArD,EAA2D8b,UAA3D,CAAP;AACD,CAJD;;AAOA;;;AAGAkrB,MAAMhtD,SAAN,CAAgBrZ,MAAhB,GAAyB,UAASw6G,KAAT,EAAgB;AACvC,OAAKL,MAAL,CAAYjxF,IAAZ,CAAiBsxF,MAAML,MAAN,CAAavjC,GAAb,EAAjB;AACA,OAAK,IAAMz3E,CAAX,IAAgBq7G,MAAMJ,MAAtB,EAA8B;AAC5B,SAAKA,MAAL,CAAYj7G,IAAI,CAAhB,IAAqBq7G,MAAMJ,MAAN,CAAaj7G,IAAI,CAAjB,CAArB;AACD;AACF,CALD;kBAMeknE,K;;;;;;;;;;;;;;;;;;AC1Of;;AACA;;;;;;AAGA;;;;;;;;;;;;;;AAeA;;;;;;;;;AAtBA;;;AA+BA,IAAMo0C,cAAc,SAAdA,WAAc,CAAS91F,WAAT,EAAsB;;AAExC,MAAMze,UAAUye,eAAe,EAA/B;;AAEA+1F,yBAAahgG,IAAb,CAAkB,IAAlB,EAAwB;AACtBovC,YAAQv8C,QADc;AAEtB2kF,UAAMhsF,QAAQgsF,IAFQ;AAGtB/uC,YAAQj9C,QAAQi9C,MAHM;AAItB+1C,iBAAahzF,QAAQgzF,WAJC;AAKtB/G,YAAQjsF,QAAQisF,MALM;AAMtBwoB,kBAAcz0G,QAAQy0G;AANA,GAAxB;AASD,CAbD;;AAeA,qBAASF,WAAT,EAAsBC,sBAAtB;;AAGA;;;;;;AAMAD,YAAYphG,SAAZ,CAAsBiO,KAAtB,GAA8B,YAAW;AACvC,MAAM/D,QAAQ,IAAIk3F,WAAJ,CAAgB;AAC5BvoB,UAAM,KAAKE,OAAL,KAAiB,KAAKA,OAAL,GAAe9qE,KAAf,EAAjB,GAA0CvnB,SADpB;AAE5BoyF,YAAQ,KAAKE,SAAL,KAAmB,KAAKA,SAAL,GAAiB/qE,KAAjB,EAAnB,GAA8CvnB,SAF1B;AAG5BojD,YAAQ,KAAKnR,SAAL,EAHoB;AAI5BknD,iBAAa,KAAKlK,cAAL,EAJe;AAK5B2rB,kBAAc,KAAKC;AALS,GAAhB,CAAd;AAOAr3F,QAAMiwD,UAAN,CAAiB,KAAKV,UAAL,EAAjB;AACAvvD,QAAMs3F,QAAN,CAAe,KAAK9rB,QAAL,EAAf;AACA,SAAOxrE,KAAP;AACD,CAXD;;AAcA;;;;;;AAMAk3F,YAAYphG,SAAZ,CAAsB+qC,SAAtB,GAAkC,UAASjB,MAAT,EAAiB;AACjD,OAAK23D,OAAL,GAAe33D,MAAf;AACA,OAAK4jC,OAAL,CAAa,KAAK6zB,aAAlB;AACD,CAHD;kBAIeH,W;;;;;;;;;;;;;;;;;;AC5Ef;;AACA;;AAGA;;;;;;;AAQA;;;;;;;;AAfA;;;AAuBA,IAAMM,OAAO,SAAPA,IAAO,CAASp2F,WAAT,EAAsB;;AAEjC,MAAMze,UAAUye,eAAe,EAA/B;;AAEA;;;;AAIA,OAAKq2F,MAAL,GAAc90G,QAAQqK,KAAR,KAAkBxQ,SAAlB,GAA8BmG,QAAQqK,KAAtC,GAA8C,IAA5D;;AAEA;;;;AAIA,OAAK0qG,SAAL,GAAiBl7G,SAAjB;AACD,CAfD;;AAkBA;;;;;AAKAg7G,KAAK1hG,SAAL,CAAeiO,KAAf,GAAuB,YAAW;AAChC,MAAM/W,QAAQ,KAAKqjF,QAAL,EAAd;AACA,SAAO,IAAImnB,IAAJ,CAAS;AACdxqG,WAAQA,SAASA,MAAMvR,KAAhB,GAAyBuR,MAAMvR,KAAN,EAAzB,GAAyCuR,SAASxQ;AAD3C,GAAT,CAAP;AAGD,CALD;;AAQA;;;;;AAKAg7G,KAAK1hG,SAAL,CAAeu6E,QAAf,GAA0B,YAAW;AACnC,SAAO,KAAKonB,MAAZ;AACD,CAFD;;AAKA;;;;;;AAMAD,KAAK1hG,SAAL,CAAe6hG,QAAf,GAA0B,UAAS3qG,KAAT,EAAgB;AACxC,OAAKyqG,MAAL,GAAczqG,KAAd;AACA,OAAK0qG,SAAL,GAAiBl7G,SAAjB;AACD,CAHD;;AAMA;;;AAGAg7G,KAAK1hG,SAAL,CAAe8hG,WAAf,GAA6B,YAAW;AACtC,MAAI,KAAKF,SAAL,KAAmBl7G,SAAvB,EAAkC;AAChC,QACE,KAAKi7G,MAAL,YAAuBzuE,aAAvB,IACE,KAAKyuE,MAAL,YAAuBxuE,cAF3B,EAGE;AACA,WAAKyuE,SAAL,GAAiB,mBAAO,KAAKD,MAAZ,EAAoBh5G,QAApB,EAAjB;AACD,KALD,MAKO;AACL,WAAKi5G,SAAL,GAAiB,OAAO,KAAKD,MAAL,GAAc,qBAAS,KAAKA,MAAd,CAAd,GAAsC,GAA7C,CAAjB;AACD;AACF;;AAED,SAAO,KAAKC,SAAZ;AACD,CAbD;kBAceF,I;;;;;;;;;;;;;;;;;;AC1Ff;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA;;;;;;;;;AAtDA;;;AA+DA,IAAMK,OAAO,SAAPA,IAAO,CAASz2F,WAAT,EAAsB;;AAEjC,MAAMze,UAAUye,eAAe,EAA/B;;AAEA;;;;AAIA,OAAK8nD,OAAL,GAAevmE,QAAQ88B,MAAR,KAAmBjjC,SAAnB,GAA+BmG,QAAQ88B,MAAvC,GAAgD,CAAC,GAAD,EAAM,GAAN,CAA/D;;AAEA;;;;AAIA,OAAKq4E,iBAAL,GAAyB,IAAzB;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqBp1G,QAAQq1G,YAAR,KAAyBx7G,SAAzB,GACnBmG,QAAQq1G,YADW,GACIC,qBAAWr/D,QADpC;;AAGA;;;;AAIA,OAAKs/D,aAAL,GAAqBv1G,QAAQw1G,YAAR,KAAyB37G,SAAzB,GACnBmG,QAAQw1G,YADW,GACIC,0BAAgBC,QADzC;;AAGA;;;;AAIA,OAAKC,aAAL,GAAqB31G,QAAQ41G,YAAR,KAAyB/7G,SAAzB,GACnBmG,QAAQ41G,YADW,GACIH,0BAAgBC,QADzC;;AAGA;;;;AAIA,OAAKG,YAAL,GACI71G,QAAQ81G,WAAR,KAAwBj8G,SAAxB,GAAoCmG,QAAQ81G,WAA5C,GAA0D,IAD9D;;AAGA;;;AAGA,MAAM3vB,QAAQnmF,QAAQ+1G,GAAR,KAAgBl8G,SAAhB,GAA4BmG,QAAQ+1G,GAApC,GAA0C,IAAxD;;AAEA;;;AAGA,MAAMC,UAAUh2G,QAAQg2G,OAAR,KAAoBn8G,SAApB,GAAgCmG,QAAQg2G,OAAxC,GAAkD,IAAlE;;AAEA;;;AAGA,MAAIC,MAAMj2G,QAAQi2G,GAAlB;;AAEA,uBAAO,EAAEA,QAAQp8G,SAAR,IAAqBssF,KAAvB,CAAP,EACE,CADF,EA3DiC,CA4D3B;AACN,uBAAO,CAACA,KAAD,IAAWA,SAAS6vB,OAA3B,EACE,CADF,EA7DiC,CA8D3B;;AAEN,MAAI,CAACC,QAAQp8G,SAAR,IAAqBo8G,IAAI/8G,MAAJ,KAAe,CAArC,KAA2CitF,KAA/C,EAAsD;AACpD8vB,UAAM9vB,MAAM8vB,GAAN,IAAa,mBAAO9vB,KAAP,EAAcrqF,QAAd,EAAnB;AACD;AACD,uBAAOm6G,QAAQp8G,SAAR,IAAqBo8G,IAAI/8G,MAAJ,GAAa,CAAzC,EACE,CADF,EAnEiC,CAoE3B;;AAEN;;;AAGA,MAAMgkG,aAAal9F,QAAQi2G,GAAR,KAAgBp8G,SAAhB,GACjBwpB,qBAAWC,IADM,GACCD,qBAAWE,MAD/B;;AAGA;;;;AAIA,OAAKuxF,MAAL,GAAc90G,QAAQqK,KAAR,KAAkBxQ,SAAlB,GAA8B,oBAAQmG,QAAQqK,KAAhB,CAA9B,GAAuD,IAArE;;AAEA;;;;AAIA,OAAK6rG,UAAL,GAAkB,oBAChB/vB,KADgB,EACT,qBAAuB8vB,GADd,EACoBD,OADpB,EAC6B,KAAKH,YADlC,EACgD3Y,UADhD,EAC4D,KAAK4X,MADjE,CAAlB;;AAGA;;;;AAIA,OAAKqB,OAAL,GAAen2G,QAAQugC,MAAR,KAAmB1mC,SAAnB,GAA+BmG,QAAQugC,MAAvC,GAAgD,CAAC,CAAD,EAAI,CAAJ,CAA/D;;AAEA;;;;AAIA,OAAK61E,aAAL,GAAqBp2G,QAAQq2G,YAAR,KAAyBx8G,SAAzB,GACnBmG,QAAQq2G,YADW,GACIf,qBAAWr/D,QADpC;;AAGA;;;;AAIA,OAAKqgE,OAAL,GAAe,IAAf;;AAEA;;;;AAIA,OAAKC,KAAL,GAAav2G,QAAQkd,IAAR,KAAiBrjB,SAAjB,GAA6BmG,QAAQkd,IAArC,GAA4C,IAAzD;;AAEA;;;AAGA,MAAMivD,UAAUnsE,QAAQmsE,OAAR,KAAoBtyE,SAApB,GAAgCmG,QAAQmsE,OAAxC,GAAkD,CAAlE;;AAEA;;;AAGA,MAAM4pB,iBAAiB/1F,QAAQ+1F,cAAR,KAA2Bl8F,SAA3B,GACrBmG,QAAQ+1F,cADa,GACI,KAD3B;;AAGA;;;AAGA,MAAMl/D,WAAW72B,QAAQ62B,QAAR,KAAqBh9B,SAArB,GAAiCmG,QAAQ62B,QAAzC,GAAoD,CAArE;;AAEA;;;AAGA,MAAM0U,QAAQvrC,QAAQurC,KAAR,KAAkB1xC,SAAlB,GAA8BmG,QAAQurC,KAAtC,GAA8C,CAA5D;;AAEA;;;AAGA,MAAMynD,cAAchzF,QAAQgzF,WAAR,KAAwBn5F,SAAxB,GAClBmG,QAAQgzF,WADU,GACI,IADxB;;AAGAwjB,kBAAWhiG,IAAX,CAAgB,IAAhB,EAAsB;AACpB23D,aAASA,OADW;AAEpBt1C,cAAUA,QAFU;AAGpB0U,WAAOA,KAHa;AAIpBynD,iBAAaA,WAJO;AAKpB+C,oBAAgBA;AALI,GAAtB;AAQD,CArJD;;AAuJA,qBAASmf,IAAT,EAAesB,eAAf;;AAGA;;;;;AAKAtB,KAAK/hG,SAAL,CAAeiO,KAAf,GAAuB,YAAW;AAChC,SAAO,IAAI8zF,IAAJ,CAAS;AACdp4E,YAAQ,KAAKypC,OAAL,CAAaztE,KAAb,EADM;AAEdu8G,kBAAc,KAAKD,aAFL;AAGdI,kBAAc,KAAKD,aAHL;AAIdK,kBAAc,KAAKD,aAJL;AAKdG,iBAAa,KAAKD,YALJ;AAMdxrG,WAAQ,KAAKyqG,MAAL,IAAe,KAAKA,MAAL,CAAYh8G,KAA5B,GAAqC,KAAKg8G,MAAL,CAAYh8G,KAAZ,EAArC,GAA2D,KAAKg8G,MAAL,IAAej7G,SANnE;AAOdo8G,SAAK,KAAKQ,MAAL,EAPS;AAQdl2E,YAAQ,KAAK41E,OAAL,CAAar9G,KAAb,EARM;AASdu9G,kBAAc,KAAKD,aATL;AAUdl5F,UAAM,KAAKq5F,KAAL,KAAe,IAAf,GAAsB,KAAKA,KAAL,CAAWz9G,KAAX,EAAtB,GAA2Ce,SAVnC;AAWdsyE,aAAS,KAAKS,UAAL,EAXK;AAYdrhC,WAAO,KAAKs9C,QAAL,EAZO;AAadmK,iBAAa,KAAKlK,cAAL,EAbC;AAcdjyD,cAAU,KAAKsF,WAAL,EAdI;AAed45D,oBAAgB,KAAKnN,iBAAL;AAfF,GAAT,CAAP;AAiBD,CAlBD;;AAqBA;;;;AAIAssB,KAAK/hG,SAAL,CAAeo1E,SAAf,GAA2B,YAAW;AACpC,MAAI,KAAK4sB,iBAAT,EAA4B;AAC1B,WAAO,KAAKA,iBAAZ;AACD;AACD,MAAIr4E,SAAS,KAAKypC,OAAlB;AACA,MAAMrpD,OAAO,KAAK4V,OAAL,EAAb;AACA,MAAI,KAAKyiF,aAAL,IAAsBE,0BAAgBC,QAAtC,IACA,KAAKC,aAAL,IAAsBF,0BAAgBC,QAD1C,EACoD;AAClD,QAAI,CAACx4F,IAAL,EAAW;AACT,aAAO,IAAP;AACD;AACD4f,aAAS,KAAKypC,OAAL,CAAaztE,KAAb,EAAT;AACA,QAAI,KAAKy8G,aAAL,IAAsBE,0BAAgBC,QAA1C,EAAoD;AAClD54E,aAAO,CAAP,KAAa5f,KAAK,CAAL,CAAb;AACD;AACD,QAAI,KAAKy4F,aAAL,IAAsBF,0BAAgBC,QAA1C,EAAoD;AAClD54E,aAAO,CAAP,KAAa5f,KAAK,CAAL,CAAb;AACD;AACF;;AAED,MAAI,KAAKk4F,aAAL,IAAsBE,qBAAWr/D,QAArC,EAA+C;AAC7C,QAAI,CAAC/4B,IAAL,EAAW;AACT,aAAO,IAAP;AACD;AACD,QAAI4f,WAAW,KAAKypC,OAApB,EAA6B;AAC3BzpC,eAAS,KAAKypC,OAAL,CAAaztE,KAAb,EAAT;AACD;AACD,QAAI,KAAKs8G,aAAL,IAAsBE,qBAAWp/D,SAAjC,IACA,KAAKk/D,aAAL,IAAsBE,qBAAWt/D,YADrC,EACmD;AACjDlZ,aAAO,CAAP,IAAY,CAACA,OAAO,CAAP,CAAD,GAAa5f,KAAK,CAAL,CAAzB;AACD;AACD,QAAI,KAAKk4F,aAAL,IAAsBE,qBAAWv/D,WAAjC,IACA,KAAKq/D,aAAL,IAAsBE,qBAAWt/D,YADrC,EACmD;AACjDlZ,aAAO,CAAP,IAAY,CAACA,OAAO,CAAP,CAAD,GAAa5f,KAAK,CAAL,CAAzB;AACD;AACF;AACD,OAAKi4F,iBAAL,GAAyBr4E,MAAzB;AACA,SAAO,KAAKq4E,iBAAZ;AACD,CAtCD;;AAyCA;;;;;AAKAD,KAAK/hG,SAAL,CAAeu6E,QAAf,GAA0B,YAAW;AACnC,SAAO,KAAKonB,MAAZ;AACD,CAFD;;AAKA;;;;;;;AAOAI,KAAK/hG,SAAL,CAAeyP,QAAf,GAA0B,UAASL,UAAT,EAAqB;AAC7C,SAAO,KAAK2zF,UAAL,CAAgBtzF,QAAhB,CAAyBL,UAAzB,CAAP;AACD,CAFD;;AAKA;;;AAGA2yF,KAAK/hG,SAAL,CAAeujG,YAAf,GAA8B,YAAW;AACvC,SAAO,KAAKR,UAAL,CAAgBpjF,OAAhB,EAAP;AACD,CAFD;;AAKA;;;AAGAoiF,KAAK/hG,SAAL,CAAewjG,wBAAf,GAA0C,YAAW;AACnD,SAAO,KAAKD,YAAL,EAAP;AACD,CAFD;;AAKA;;;AAGAxB,KAAK/hG,SAAL,CAAeg4F,aAAf,GAA+B,YAAW;AACxC,SAAO,KAAK+K,UAAL,CAAgB/K,aAAhB,EAAP;AACD,CAFD;;AAKA;;;AAGA+J,KAAK/hG,SAAL,CAAes1E,oBAAf,GAAsC,UAASlmE,UAAT,EAAqB;AACzD,SAAO,KAAK2zF,UAAL,CAAgBztB,oBAAhB,CAAqClmE,UAArC,CAAP;AACD,CAFD;;AAKA;;;;AAIA2yF,KAAK/hG,SAAL,CAAew1E,SAAf,GAA2B,YAAW;AACpC,MAAI,KAAK2tB,OAAT,EAAkB;AAChB,WAAO,KAAKA,OAAZ;AACD;AACD,MAAI/1E,SAAS,KAAK41E,OAAlB;;AAEA,MAAI,KAAKC,aAAL,IAAsBd,qBAAWr/D,QAArC,EAA+C;AAC7C,QAAM/4B,OAAO,KAAK4V,OAAL,EAAb;AACA,QAAM8jF,gBAAgB,KAAKV,UAAL,CAAgBpjF,OAAhB,EAAtB;AACA,QAAI,CAAC5V,IAAD,IAAS,CAAC05F,aAAd,EAA6B;AAC3B,aAAO,IAAP;AACD;AACDr2E,aAASA,OAAOznC,KAAP,EAAT;AACA,QAAI,KAAKs9G,aAAL,IAAsBd,qBAAWp/D,SAAjC,IACA,KAAKkgE,aAAL,IAAsBd,qBAAWt/D,YADrC,EACmD;AACjDzV,aAAO,CAAP,IAAYq2E,cAAc,CAAd,IAAmB15F,KAAK,CAAL,CAAnB,GAA6BqjB,OAAO,CAAP,CAAzC;AACD;AACD,QAAI,KAAK61E,aAAL,IAAsBd,qBAAWv/D,WAAjC,IACA,KAAKqgE,aAAL,IAAsBd,qBAAWt/D,YADrC,EACmD;AACjDzV,aAAO,CAAP,IAAYq2E,cAAc,CAAd,IAAmB15F,KAAK,CAAL,CAAnB,GAA6BqjB,OAAO,CAAP,CAAzC;AACD;AACF;AACD,OAAK+1E,OAAL,GAAe/1E,MAAf;AACA,SAAO,KAAK+1E,OAAZ;AACD,CAxBD;;AA2BA;;;;;AAKApB,KAAK/hG,SAAL,CAAesjG,MAAf,GAAwB,YAAW;AACjC,SAAO,KAAKP,UAAL,CAAgBO,MAAhB,EAAP;AACD,CAFD;;AAKA;;;;AAIAvB,KAAK/hG,SAAL,CAAe2f,OAAf,GAAyB,YAAW;AAClC,SAAO,CAAC,KAAKyjF,KAAN,GAAc,KAAKL,UAAL,CAAgBpjF,OAAhB,EAAd,GAA0C,KAAKyjF,KAAtD;AACD,CAFD;;AAKA;;;AAGArB,KAAK/hG,SAAL,CAAek4F,iBAAf,GAAmC,UAASx/E,QAAT,EAAmB8F,OAAnB,EAA4B;AAC7D,SAAO,oBAAO,KAAKukF,UAAZ,EAAwBn0F,oBAAUC,MAAlC,EACL6J,QADK,EACK8F,OADL,CAAP;AAED,CAHD;;AAMA;;;;;;;;AAQAujF,KAAK/hG,SAAL,CAAe6P,IAAf,GAAsB,YAAW;AAC/B,OAAKkzF,UAAL,CAAgBlzF,IAAhB;AACD,CAFD;;AAKA;;;AAGAkyF,KAAK/hG,SAAL,CAAei4F,mBAAf,GAAqC,UAASv/E,QAAT,EAAmB8F,OAAnB,EAA4B;AAC/D,wBAAS,KAAKukF,UAAd,EAA0Bn0F,oBAAUC,MAApC,EACE6J,QADF,EACY8F,OADZ;AAED,CAHD;kBAIeujF,I;;;;;;;;;;;;;;;;;ACraf;;;;AAIA;;;;kBAIe;AACbQ,YAAU,UADG;AAEb11B,UAAQ;AAFK,C;;;;;;;;;;;;;;;;;QC8FCx+E,G,GAAAA,G;;AAnGhB;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;;;;;AAUA,IAAMq1G,YAAY,SAAZA,SAAY,CAAS1wB,KAAT,EAAgB8vB,GAAhB,EAAqB/4F,IAArB,EAA2B44F,WAA3B,EAAwC5Y,UAAxC,EAAoD7yF,KAApD,EAA2D;;AAE3EoY,wBAAYjO,IAAZ,CAAiB,IAAjB;;AAEA;;;;AAIA,OAAKsyE,kBAAL,GAA0B,IAA1B;;AAEA;;;;AAIA,OAAKC,MAAL,GAAc,CAACZ,KAAD,GAAS,IAAI2wB,KAAJ,EAAT,GAAuB3wB,KAArC;;AAEA,MAAI2vB,gBAAgB,IAApB,EAA0B;AACxB,SAAK/uB,MAAL,CAAY+uB,WAAZ,GAA0BA,WAA1B;AACD;;AAED;;;;AAIA,OAAKtyF,OAAL,GAAenZ;AACb,kCAAkCof,SAAS2D,aAAT,CAAuB,QAAvB,CADrB,GAEb,IAFF;;AAIA;;;;AAIA,OAAK0nF,MAAL,GAAczqG,KAAd;;AAEA;;;;AAIA,OAAK0sG,kBAAL,GAA0B,IAA1B;;AAEA;;;;AAIA,OAAKC,WAAL,GAAmB9Z,UAAnB;;AAEA;;;;AAIA,OAAKqZ,KAAL,GAAar5F,IAAb;;AAEA;;;;AAIA,OAAK+5F,IAAL,GAAYhB,GAAZ;;AAEA;;;;AAIA,OAAKiB,SAAL,GAAiB,KAAjB;AACA,MAAI,KAAKF,WAAL,IAAoB3zF,qBAAWE,MAAnC,EAA2C;AACzC,SAAK4zF,kBAAL;AACD;AAEF,CAnED,C,CArBA;;;;;AA0FA,qBAASN,SAAT,EAAoBp0F,qBAApB;;AAGA;;;;;;;;;AASO,SAASjhB,GAAT,CAAa2kF,KAAb,EAAoB8vB,GAApB,EAAyB/4F,IAAzB,EAA+B44F,WAA/B,EAA4C5Y,UAA5C,EAAwD7yF,KAAxD,EAA+D;AACpE,MAAI+sG,YAAYzY,uBAAen9F,GAAf,CAAmBy0G,GAAnB,EAAwBH,WAAxB,EAAqCzrG,KAArC,CAAhB;AACA,MAAI,CAAC+sG,SAAL,EAAgB;AACdA,gBAAY,IAAIP,SAAJ,CAAc1wB,KAAd,EAAqB8vB,GAArB,EAA0B/4F,IAA1B,EAAgC44F,WAAhC,EAA6C5Y,UAA7C,EAAyD7yF,KAAzD,CAAZ;AACAs0F,2BAAe3+E,GAAf,CAAmBi2F,GAAnB,EAAwBH,WAAxB,EAAqCzrG,KAArC,EAA4C+sG,SAA5C;AACD;AACD,SAAOA,SAAP;AACD;;AAGD;;;AAGAP,UAAU1jG,SAAV,CAAoBgkG,kBAApB,GAAyC,YAAW;AAClD,MAAMl9G,UAAU,gCAAsB,CAAtB,EAAyB,CAAzB,CAAhB;AACA,MAAI;AACFA,YAAQ0pF,SAAR,CAAkB,KAAKoD,MAAvB,EAA+B,CAA/B,EAAkC,CAAlC;AACA9sF,YAAQ+/F,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B;AACD,GAHD,CAGE,OAAO72F,CAAP,EAAU;AACV,SAAK+zG,SAAL,GAAiB,IAAjB;AACD;AACF,CARD;;AAWA;;;AAGAL,UAAU1jG,SAAV,CAAoBkkG,oBAApB,GAA2C,YAAW;AACpD,OAAK73F,aAAL,CAAmBuC,oBAAUC,MAA7B;AACD,CAFD;;AAKA;;;AAGA60F,UAAU1jG,SAAV,CAAoBmkG,iBAApB,GAAwC,YAAW;AACjD,OAAKN,WAAL,GAAmB3zF,qBAAWO,KAA9B;AACA,OAAK2zF,cAAL;AACA,OAAKF,oBAAL;AACD,CAJD;;AAOA;;;AAGAR,UAAU1jG,SAAV,CAAoBqkG,gBAApB,GAAuC,YAAW;AAChD,OAAKR,WAAL,GAAmB3zF,qBAAWE,MAA9B;AACA,MAAI,KAAKgzF,KAAT,EAAgB;AACd,SAAKxvB,MAAL,CAAYt5D,KAAZ,GAAoB,KAAK8oF,KAAL,CAAW,CAAX,CAApB;AACA,SAAKxvB,MAAL,CAAYr5D,MAAZ,GAAqB,KAAK6oF,KAAL,CAAW,CAAX,CAArB;AACD;AACD,OAAKA,KAAL,GAAa,CAAC,KAAKxvB,MAAL,CAAYt5D,KAAb,EAAoB,KAAKs5D,MAAL,CAAYr5D,MAAhC,CAAb;AACA,OAAK6pF,cAAL;AACA,OAAKJ,kBAAL;AACA,OAAKM,aAAL;AACA,OAAKJ,oBAAL;AACD,CAXD;;AAcA;;;;AAIAR,UAAU1jG,SAAV,CAAoByP,QAApB,GAA+B,UAASL,UAAT,EAAqB;AAClD,SAAO,KAAKiB,OAAL,GAAe,KAAKA,OAApB,GAA8B,KAAKujE,MAA1C;AACD,CAFD;;AAKA;;;AAGA8vB,UAAU1jG,SAAV,CAAoBg4F,aAApB,GAAoC,YAAW;AAC7C,SAAO,KAAK6L,WAAZ;AACD,CAFD;;AAKA;;;;AAIAH,UAAU1jG,SAAV,CAAoBs1E,oBAApB,GAA2C,UAASlmE,UAAT,EAAqB;AAC9D,MAAI,CAAC,KAAKukE,kBAAV,EAA8B;AAC5B,QAAI,KAAKowB,SAAT,EAAoB;AAClB,UAAMzpF,QAAQ,KAAK8oF,KAAL,CAAW,CAAX,CAAd;AACA,UAAM7oF,SAAS,KAAK6oF,KAAL,CAAW,CAAX,CAAf;AACA,UAAMt8G,UAAU,gCAAsBwzB,KAAtB,EAA6BC,MAA7B,CAAhB;AACAzzB,cAAQy9G,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuBjqF,KAAvB,EAA8BC,MAA9B;AACA,WAAKo5D,kBAAL,GAA0B7sF,QAAQipB,MAAlC;AACD,KAND,MAMO;AACL,WAAK4jE,kBAAL,GAA0B,KAAKC,MAA/B;AACD;AACF;AACD,SAAO,KAAKD,kBAAZ;AACD,CAbD;;AAgBA;;;AAGA+vB,UAAU1jG,SAAV,CAAoB2f,OAApB,GAA8B,YAAW;AACvC,SAAO,KAAKyjF,KAAZ;AACD,CAFD;;AAKA;;;AAGAM,UAAU1jG,SAAV,CAAoBsjG,MAApB,GAA6B,YAAW;AACtC,SAAO,KAAKQ,IAAZ;AACD,CAFD;;AAKA;;;AAGAJ,UAAU1jG,SAAV,CAAoB6P,IAApB,GAA2B,YAAW;AACpC,MAAI,KAAKg0F,WAAL,IAAoB3zF,qBAAWC,IAAnC,EAAyC;AACvC,SAAK0zF,WAAL,GAAmB3zF,qBAAWQ,OAA9B;AACA,SAAKkzF,kBAAL,GAA0B,CACxB,wBAAW,KAAKhwB,MAAhB,EAAwBhlE,oBAAU6B,KAAlC,EACE,KAAK0zF,iBADP,EAC0B,IAD1B,CADwB,EAGxB,wBAAW,KAAKvwB,MAAhB,EAAwBhlE,oBAAU0uB,IAAlC,EACE,KAAK+mE,gBADP,EACyB,IADzB,CAHwB,CAA1B;AAMA,QAAI;AACF,WAAKzwB,MAAL,CAAYkvB,GAAZ,GAAkB,KAAKgB,IAAvB;AACD,KAFD,CAEE,OAAO9zG,CAAP,EAAU;AACV,WAAKm0G,iBAAL;AACD;AACF;AACF,CAfD;;AAkBA;;;AAGAT,UAAU1jG,SAAV,CAAoBskG,aAApB,GAAoC,YAAW;AAC7C,MAAI,KAAKP,SAAL,IAAkB,KAAKpC,MAAL,KAAgB,IAAtC,EAA4C;AAC1C;AACD;;AAED,OAAKtxF,OAAL,CAAaiK,KAAb,GAAqB,KAAKs5D,MAAL,CAAYt5D,KAAjC;AACA,OAAKjK,OAAL,CAAakK,MAAb,GAAsB,KAAKq5D,MAAL,CAAYr5D,MAAlC;;AAEA,MAAM/zB,MAAM,KAAK6pB,OAAL,CAAasqB,UAAb,CAAwB,IAAxB,CAAZ;AACAn0C,MAAIgqF,SAAJ,CAAc,KAAKoD,MAAnB,EAA2B,CAA3B,EAA8B,CAA9B;;AAEA,MAAM4wB,UAAUh+G,IAAIqgG,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,KAAKjT,MAAL,CAAYt5D,KAAnC,EAA0C,KAAKs5D,MAAL,CAAYr5D,MAAtD,CAAhB;AACA,MAAMvT,OAAOw9F,QAAQx9F,IAArB;AACA,MAAMjiB,IAAI,KAAK48G,MAAL,CAAY,CAAZ,IAAiB,KAA3B;AACA,MAAM7zG,IAAI,KAAK6zG,MAAL,CAAY,CAAZ,IAAiB,KAA3B;AACA,MAAM5zG,IAAI,KAAK4zG,MAAL,CAAY,CAAZ,IAAiB,KAA3B;;AAEA,OAAK,IAAI77G,IAAI,CAAR,EAAWwkB,KAAKtD,KAAKjhB,MAA1B,EAAkCD,IAAIwkB,EAAtC,EAA0CxkB,KAAK,CAA/C,EAAkD;AAChDkhB,SAAKlhB,CAAL,KAAWf,CAAX;AACAiiB,SAAKlhB,IAAI,CAAT,KAAegI,CAAf;AACAkZ,SAAKlhB,IAAI,CAAT,KAAeiI,CAAf;AACD;AACDvH,MAAIi+G,YAAJ,CAAiBD,OAAjB,EAA0B,CAA1B,EAA6B,CAA7B;AACD,CAvBD;;AA0BA;;;;;AAKAd,UAAU1jG,SAAV,CAAoBokG,cAApB,GAAqC,YAAW;AAC9C,OAAKR,kBAAL,CAAwBp+G,OAAxB,CAAgC4wB,qBAAhC;AACA,OAAKwtF,kBAAL,GAA0B,IAA1B;AACD,CAHD;kBAIeF,S;;;;;;;;;;;;;;;;;;;AC9Qf;;AAEA;;;;AAIA,IAAMgB,iBAAiB,SAAjBA,cAAiB,GAAW;;AAEhC;;;;AAIA,OAAKC,MAAL,GAAc,EAAd;;AAEA;;;;AAIA,OAAKC,UAAL,GAAkB,CAAlB;;AAEA;;;;AAIA,OAAKC,aAAL,GAAqB,EAArB;AACD,CAnBD;;AAsBA;;;;;;AA/BA;;;AAqCA,SAASxkF,MAAT,CAAgByiF,GAAhB,EAAqBH,WAArB,EAAkCzrG,KAAlC,EAAyC;AACvC,MAAM4tG,cAAc5tG,QAAQ,qBAASA,KAAT,CAAR,GAA0B,MAA9C;AACA,SAAOyrG,cAAc,GAAd,GAAoBG,GAApB,GAA0B,GAA1B,GAAgCgC,WAAvC;AACD;;AAGD;;;AAGAJ,eAAe1kG,SAAf,CAAyB6L,KAAzB,GAAiC,YAAW;AAC1C,OAAK84F,MAAL,GAAc,EAAd;AACA,OAAKC,UAAL,GAAkB,CAAlB;AACD,CAHD;;AAMA;;;AAGAF,eAAe1kG,SAAf,CAAyByrF,MAAzB,GAAkC,YAAW;AAC3C,MAAI,KAAKmZ,UAAL,GAAkB,KAAKC,aAA3B,EAA0C;AACxC,QAAI/+G,IAAI,CAAR;AACA,SAAK,IAAMqI,GAAX,IAAkB,KAAKw2G,MAAvB,EAA+B;AAC7B,UAAMV,YAAY,KAAKU,MAAL,CAAYx2G,GAAZ,CAAlB;AACA,UAAI,CAACrI,MAAM,CAAP,MAAc,CAAd,IAAmB,CAACm+G,UAAU/mE,WAAV,EAAxB,EAAiD;AAC/C,eAAO,KAAKynE,MAAL,CAAYx2G,GAAZ,CAAP;AACA,UAAE,KAAKy2G,UAAP;AACD;AACF;AACF;AACF,CAXD;;AAcA;;;;;;AAMAF,eAAe1kG,SAAf,CAAyB3R,GAAzB,GAA+B,UAASy0G,GAAT,EAAcH,WAAd,EAA2BzrG,KAA3B,EAAkC;AAC/D,MAAM/I,MAAMkyB,OAAOyiF,GAAP,EAAYH,WAAZ,EAAyBzrG,KAAzB,CAAZ;AACA,SAAO/I,OAAO,KAAKw2G,MAAZ,GAAqB,KAAKA,MAAL,CAAYx2G,GAAZ,CAArB,GAAwC,IAA/C;AACD,CAHD;;AAMA;;;;;;AAMAu2G,eAAe1kG,SAAf,CAAyB6M,GAAzB,GAA+B,UAASi2F,GAAT,EAAcH,WAAd,EAA2BzrG,KAA3B,EAAkC+sG,SAAlC,EAA6C;AAC1E,MAAM91G,MAAMkyB,OAAOyiF,GAAP,EAAYH,WAAZ,EAAyBzrG,KAAzB,CAAZ;AACA,OAAKytG,MAAL,CAAYx2G,GAAZ,IAAmB81G,SAAnB;AACA,IAAE,KAAKW,UAAP;AACD,CAJD;;AAOA;;;;;;;AAOAF,eAAe1kG,SAAf,CAAyBgkB,OAAzB,GAAmC,UAAS+gF,YAAT,EAAuB;AACxD,OAAKF,aAAL,GAAqBE,YAArB;AACA,OAAKtZ,MAAL;AACD,CAHD;kBAIeiZ,c;;AAGf;;;;;;AAKO,IAAMM,0BAAS,IAAIN,cAAJ,EAAf,C;;;;;;;;;;;;;;;;;ACjHP;;;;AAIA;;;;kBAIe;AACb9hE,eAAa,aADA;AAEbC,gBAAc,cAFD;AAGbC,YAAU,UAHG;AAIbC,aAAW;AAJE,C;;;;;;;;;;;;;;;;;ACRf;;;;AAKA;;;;;;;;;AAUA;;;;;;;;;;;AAWA,IAAMsgE,aAAa,SAAbA,UAAa,CAASx2G,OAAT,EAAkB;;AAEnC;;;;AAIA,OAAKmnF,QAAL,GAAgBnnF,QAAQmsE,OAAxB;;AAEA;;;;AAIA,OAAKmb,eAAL,GAAuBtnF,QAAQ+1F,cAA/B;;AAEA;;;;AAIA,OAAKrsD,SAAL,GAAiB1pC,QAAQ62B,QAAzB;;AAEA;;;;AAIA,OAAK0wD,MAAL,GAAcvnF,QAAQurC,KAAtB;;AAEA;;;;AAIA,OAAKi8C,YAAL,GAAoBxnF,QAAQgzF,WAA5B;AAED,CAhCD;;AAmCA;;;;;AAKAwjB,WAAWrjG,SAAX,CAAqBy5D,UAArB,GAAkC,YAAW;AAC3C,SAAO,KAAKua,QAAZ;AACD,CAFD;;AAKA;;;;;AAKAqvB,WAAWrjG,SAAX,CAAqBy1E,iBAArB,GAAyC,YAAW;AAClD,SAAO,KAAKtB,eAAZ;AACD,CAFD;;AAKA;;;;;AAKAkvB,WAAWrjG,SAAX,CAAqBgpB,WAArB,GAAmC,YAAW;AAC5C,SAAO,KAAKuN,SAAZ;AACD,CAFD;;AAKA;;;;;AAKA8sE,WAAWrjG,SAAX,CAAqB01E,QAArB,GAAgC,YAAW;AACzC,SAAO,KAAKtB,MAAZ;AACD,CAFD;;AAKA;;;;;AAKAivB,WAAWrjG,SAAX,CAAqB21E,cAArB,GAAsC,YAAW;AAC/C,SAAO,KAAKtB,YAAZ;AACD,CAFD;;AAKA;;;;;;AAMAgvB,WAAWrjG,SAAX,CAAqBo1E,SAArB,GAAiC,YAAW,CAAE,CAA9C;;AAGA;;;;;;AAMAiuB,WAAWrjG,SAAX,CAAqByP,QAArB,GAAgC,UAASL,UAAT,EAAqB,CAAE,CAAvD;;AAGA;;;;;AAKAi0F,WAAWrjG,SAAX,CAAqBs1E,oBAArB,GAA4C,UAASlmE,UAAT,EAAqB,CAAE,CAAnE;;AAGA;;;;AAIAi0F,WAAWrjG,SAAX,CAAqBg4F,aAArB,GAAqC,YAAW,CAAE,CAAlD;;AAGA;;;;AAIAqL,WAAWrjG,SAAX,CAAqBujG,YAArB,GAAoC,YAAW,CAAE,CAAjD;;AAGA;;;;AAIAF,WAAWrjG,SAAX,CAAqBwjG,wBAArB,GAAgD,YAAW,CAAE,CAA7D;;AAGA;;;;;AAKAH,WAAWrjG,SAAX,CAAqBw1E,SAArB,GAAiC,YAAW,CAAE,CAA9C;;AAGA;;;;;AAKA6tB,WAAWrjG,SAAX,CAAqB2f,OAArB,GAA+B,YAAW,CAAE,CAA5C;;AAGA;;;;;;AAMA0jF,WAAWrjG,SAAX,CAAqBm6D,UAArB,GAAkC,UAASnB,OAAT,EAAkB;AAClD,OAAKgb,QAAL,GAAgBhb,OAAhB;AACD,CAFD;;AAKA;;;;;;AAMAqqC,WAAWrjG,SAAX,CAAqBilG,iBAArB,GAAyC,UAASriB,cAAT,EAAyB;AAChE,OAAKzO,eAAL,GAAuByO,cAAvB;AACD,CAFD;;AAKA;;;;;;AAMAygB,WAAWrjG,SAAX,CAAqBspB,WAArB,GAAmC,UAAS5F,QAAT,EAAmB;AACpD,OAAK6S,SAAL,GAAiB7S,QAAjB;AACD,CAFD;;AAKA;;;;;;AAMA2/E,WAAWrjG,SAAX,CAAqBwhG,QAArB,GAAgC,UAASppE,KAAT,EAAgB;AAC9C,OAAKg8C,MAAL,GAAch8C,KAAd;AACD,CAFD;;AAKA;;;;;;AAMAirE,WAAWrjG,SAAX,CAAqBklG,cAArB,GAAsC,UAASrlB,WAAT,EAAsB;AAC1D,OAAKxL,YAAL,GAAoBwL,WAApB;AACD,CAFD;;AAKA;;;;;;;AAOAwjB,WAAWrjG,SAAX,CAAqBk4F,iBAArB,GAAyC,UAASx/E,QAAT,EAAmB8F,OAAnB,EAA4B,CAAE,CAAvE;;AAGA;;;;AAIA6kF,WAAWrjG,SAAX,CAAqB6P,IAArB,GAA4B,YAAW,CAAE,CAAzC;;AAGA;;;;;;AAMAwzF,WAAWrjG,SAAX,CAAqBi4F,mBAArB,GAA2C,UAASv/E,QAAT,EAAmB8F,OAAnB,EAA4B,CAAE,CAAzE;kBACe6kF,U;;;;;;;;;;;;;;;;;;AC1Pf;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;;;;;AAGA;;;;;;;;;;;;;;;;;;;;;;AAuBA;;;;;;;;;;;;AAaA;;;;;;;;;;;AAWA,IAAMhC,eAAe,SAAfA,YAAe,CAASx0G,OAAT,EAAkB;AACrC;;;;AAIA,OAAKs4G,UAAL,GAAkB,IAAlB;;AAEA;;;;AAIA,OAAK90F,OAAL,GAAe,IAAf;;AAEA;;;;AAIA,OAAK+0F,mBAAL,GAA2B,IAA3B;;AAEA;;;;AAIA,OAAK1lB,KAAL,GAAa7yF,QAAQgsF,IAAR,KAAiBnyF,SAAjB,GAA6BmG,QAAQgsF,IAArC,GAA4C,IAAzD;;AAEA;;;;AAIA,OAAKsqB,OAAL,GAAe,CAAC,CAAD,EAAI,CAAJ,CAAf;;AAEA;;;;AAIA,OAAKjyF,OAAL,GAAerkB,QAAQ4jD,MAAvB;;AAEA;;;;AAIA,OAAKgxD,OAAL,GAAe,qBAAuB50G,QAAQi9C,MAAR,KAAmBpjD,SAAnB,GACpCmG,QAAQi9C,MAD4B,GACnBj9C,QAAQw4G,OAD3B;;AAGA;;;;AAIA,OAAKC,QAAL,GAAgBz4G,QAAQ04G,OAAxB;;AAEA;;;;AAIA,OAAKp0F,MAAL,GAActkB,QAAQ+sC,KAAR,KAAkBlzC,SAAlB,GAA8BmG,QAAQ+sC,KAAtC,GAA8C,CAA5D;;AAEA;;;;AAIA,OAAK4rE,OAAL,GAAe34G,QAAQisF,MAAR,KAAmBpyF,SAAnB,GAA+BmG,QAAQisF,MAAvC,GAAgD,IAA/D;;AAEA;;;;AAIA,OAAK1lB,OAAL,GAAe,IAAf;;AAEA;;;;AAIA,OAAKgwC,KAAL,GAAa,IAAb;;AAEA;;;;AAIA,OAAKqC,UAAL,GAAkB,IAAlB;;AAEA;;;;AAIA,OAAKC,sBAAL,GAA8B,IAA9B;;AAEA;;;;AAIA,OAAKnE,aAAL,GAAqB10G,QAAQy0G,YAA7B;;AAEA,OAAK5zB,OAAL,CAAa,KAAK6zB,aAAlB;;AAEA;;;AAGA,MAAM1hB,cAAchzF,QAAQgzF,WAAR,KAAwBn5F,SAAxB,GAClBmG,QAAQgzF,WADU,GACI,IADxB;;AAGA;;;AAGA,MAAM+C,iBAAiB/1F,QAAQ+1F,cAAR,KAA2Bl8F,SAA3B,GACrBmG,QAAQ+1F,cADa,GACI,KAD3B;;AAGAygB,kBAAWhiG,IAAX,CAAgB,IAAhB,EAAsB;AACpB23D,aAAS,CADW;AAEpB4pB,oBAAgBA,cAFI;AAGpBl/D,cAAU72B,QAAQ62B,QAAR,KAAqBh9B,SAArB,GAAiCmG,QAAQ62B,QAAzC,GAAoD,CAH1C;AAIpB0U,WAAO,CAJa;AAKpBynD,iBAAaA;AALO,GAAtB;AAOD,CAjHD,C,CA3DA;;;;;AA8KA,qBAASwhB,YAAT,EAAuBgC,eAAvB;;AAGA;;;;;AAKAhC,aAAarhG,SAAb,CAAuBiO,KAAvB,GAA+B,YAAW;AACxC,MAAM/D,QAAQ,IAAIm3F,YAAJ,CAAiB;AAC7BxoB,UAAM,KAAKE,OAAL,KAAiB,KAAKA,OAAL,GAAe9qE,KAAf,EAAjB,GAA0CvnB,SADnB;AAE7B+pD,YAAQ,KAAKD,SAAL,EAFqB;AAG7B1G,YAAQ,KAAKnR,SAAL,EAHqB;AAI7B4sE,aAAS,KAAKI,UAAL,EAJoB;AAK7B/rE,WAAO,KAAK7nB,QAAL,EALsB;AAM7B8tE,iBAAa,KAAKlK,cAAL,EANgB;AAO7BmD,YAAQ,KAAKE,SAAL,KAAoB,KAAKA,SAAL,GAAiB/qE,KAAjB,EAApB,GAA+CvnB,SAP1B;AAQ7Bg9B,cAAU,KAAKsF,WAAL,EARmB;AAS7B45D,oBAAgB,KAAKnN,iBAAL,EATa;AAU7B6rB,kBAAc,KAAKC;AAVU,GAAjB,CAAd;AAYAr3F,QAAMiwD,UAAN,CAAiB,KAAKV,UAAL,EAAjB;AACAvvD,QAAMs3F,QAAN,CAAe,KAAK9rB,QAAL,EAAf;AACA,SAAOxrE,KAAP;AACD,CAhBD;;AAmBA;;;;AAIAm3F,aAAarhG,SAAb,CAAuBo1E,SAAvB,GAAmC,YAAW;AAC5C,SAAO,KAAKhiB,OAAZ;AACD,CAFD;;AAKA;;;;;AAKAiuC,aAAarhG,SAAb,CAAuB+R,QAAvB,GAAkC,YAAW;AAC3C,SAAO,KAAKZ,MAAZ;AACD,CAFD;;AAKA;;;;;AAKAkwF,aAAarhG,SAAb,CAAuB+4E,OAAvB,GAAiC,YAAW;AAC1C,SAAO,KAAK2G,KAAZ;AACD,CAFD;;AAKA;;;AAGA2hB,aAAarhG,SAAb,CAAuBs1E,oBAAvB,GAA8C,UAASlmE,UAAT,EAAqB;AACjE,SAAO,KAAKg2F,mBAAZ;AACD,CAFD;;AAKA;;;;AAIA/D,aAAarhG,SAAb,CAAuByP,QAAvB,GAAkC,UAASL,UAAT,EAAqB;AACrD,SAAO,KAAKiB,OAAZ;AACD,CAFD;;AAKA;;;AAGAgxF,aAAarhG,SAAb,CAAuBujG,YAAvB,GAAsC,YAAW;AAC/C,SAAO,KAAKkC,UAAZ;AACD,CAFD;;AAKA;;;AAGApE,aAAarhG,SAAb,CAAuBwjG,wBAAvB,GAAkD,YAAW;AAC3D,SAAO,KAAKkC,sBAAZ;AACD,CAFD;;AAKA;;;AAGArE,aAAarhG,SAAb,CAAuBg4F,aAAvB,GAAuC,YAAW;AAChD,SAAO9nF,qBAAWE,MAAlB;AACD,CAFD;;AAKA;;;;AAIAixF,aAAarhG,SAAb,CAAuBw1E,SAAvB,GAAmC,YAAW;AAC5C,SAAO,KAAK2tB,OAAZ;AACD,CAFD;;AAKA;;;;;AAKA9B,aAAarhG,SAAb,CAAuBwwC,SAAvB,GAAmC,YAAW;AAC5C,SAAO,KAAKt/B,OAAZ;AACD,CAFD;;AAKA;;;;;AAKAmwF,aAAarhG,SAAb,CAAuB24B,SAAvB,GAAmC,YAAW;AAC5C,SAAO,KAAK8oE,OAAZ;AACD,CAFD;;AAKA;;;;;AAKAJ,aAAarhG,SAAb,CAAuB2lG,UAAvB,GAAoC,YAAW;AAC7C,SAAO,KAAKL,QAAZ;AACD,CAFD;;AAKA;;;;AAIAjE,aAAarhG,SAAb,CAAuB2f,OAAvB,GAAiC,YAAW;AAC1C,SAAO,KAAKyjF,KAAZ;AACD,CAFD;;AAKA;;;;;AAKA/B,aAAarhG,SAAb,CAAuBg5E,SAAvB,GAAmC,YAAW;AAC5C,SAAO,KAAKwsB,OAAZ;AACD,CAFD;;AAKA;;;AAGAnE,aAAarhG,SAAb,CAAuBk4F,iBAAvB,GAA2C,UAASx/E,QAAT,EAAmB8F,OAAnB,EAA4B,CAAE,CAAzE;;AAGA;;;AAGA6iF,aAAarhG,SAAb,CAAuB6P,IAAvB,GAA8B,YAAW,CAAE,CAA3C;;AAGA;;;AAGAwxF,aAAarhG,SAAb,CAAuBi4F,mBAAvB,GAA6C,UAASv/E,QAAT,EAAmB8F,OAAnB,EAA4B,CAAE,CAA3E;;AAGA;;;;AAIA6iF,aAAarhG,SAAb,CAAuB0tE,OAAvB,GAAiC,UAAS4zB,YAAT,EAAuB;AACtD,MAAI/lB,kBAAJ;AACA,MAAI3B,UAAU,EAAd;AACA,MAAIG,WAAW,EAAf;AACA,MAAIE,aAAa,CAAjB;AACA,MAAIJ,WAAW,IAAf;AACA,MAAIC,iBAAiB,CAArB;AACA,MAAI9J,oBAAJ;AACA,MAAIkT,cAAc,CAAlB;;AAEA,MAAI,KAAKsiB,OAAT,EAAkB;AAChBx1B,kBAAc,KAAKw1B,OAAL,CAAajrB,QAAb,EAAd;AACA,QAAIvK,gBAAgB,IAApB,EAA0B;AACxBA,oBAAcgB,0BAAd;AACD;AACDhB,kBAAc,4BAAYA,WAAZ,CAAd;AACAkT,kBAAc,KAAKsiB,OAAL,CAAah/E,QAAb,EAAd;AACA,QAAI08D,gBAAgBx8F,SAApB,EAA+B;AAC7Bw8F,oBAAc9R,wBAAd;AACD;AACDyI,eAAW,KAAK2rB,OAAL,CAAa5qB,WAAb,EAAX;AACAd,qBAAiB,KAAK0rB,OAAL,CAAa1qB,iBAAb,EAAjB;AACA,QAAI,CAAC9+B,qBAAL,EAAuB;AACrB69B,iBAAW,IAAX;AACAC,uBAAiB,CAAjB;AACD;AACDC,eAAW,KAAKyrB,OAAL,CAAaxqB,WAAb,EAAX;AACA,QAAIjB,aAAarzF,SAAjB,EAA4B;AAC1BqzF,iBAAWjJ,uBAAX;AACD;AACD8I,cAAU,KAAK4rB,OAAL,CAAa9qB,UAAb,EAAV;AACA,QAAId,YAAYlzF,SAAhB,EAA2B;AACzBkzF,gBAAUjJ,sBAAV;AACD;AACDsJ,iBAAa,KAAKurB,OAAL,CAAarqB,aAAb,EAAb;AACA,QAAIlB,eAAevzF,SAAnB,EAA8B;AAC5BuzF,mBAAalJ,yBAAb;AACD;AACF;;AAED,MAAIhnE,OAAO,KAAK,KAAK03F,OAAL,GAAeve,WAApB,IAAmC,CAA9C;;AAEA;AACA,MAAM0iB,gBAAgB;AACpB51B,iBAAaA,WADO;AAEpBkT,iBAAaA,WAFO;AAGpBn5E,UAAMA,IAHc;AAIpB6vE,aAASA,OAJW;AAKpBC,cAAUA,QALU;AAMpBC,oBAAgBA,cANI;AAOpBC,cAAUA,QAPU;AAQpBE,gBAAYA;AARQ,GAAtB;;AAWA,MAAIqnB,iBAAiB56G,SAArB,EAAgC;AAC9B;AACA,QAAMI,UAAU,gCAAsBijB,IAAtB,EAA4BA,IAA5B,CAAhB;AACA,SAAKsG,OAAL,GAAevpB,QAAQipB,MAAvB;;AAEA;AACAhG,WAAO,KAAKsG,OAAL,CAAaiK,KAApB;AACAihE,gBAAYxxE,IAAZ;;AAEA,SAAK87F,KAAL,CAAWD,aAAX,EAA0B9+G,OAA1B,EAAmC,CAAnC,EAAsC,CAAtC;;AAEA,SAAKg/G,yBAAL,CAA+BF,aAA/B;AACD,GAZD,MAYO;AACL;AACA77F,WAAOlgB,KAAKoH,KAAL,CAAW8Y,IAAX,CAAP;;AAEA,QAAMg8F,6BAA6B,CAAC,KAAKrmB,KAAzC;AACA,QAAIsmB,mCAAJ;AACA,QAAID,0BAAJ,EAAgC;AAC9B;AACAC,mCACI,KAAKC,uBAAL,CAA6B7pG,IAA7B,CAAkC,IAAlC,EAAwCwpG,aAAxC,CADJ;AAED;;AAED,QAAM5/G,KAAK,KAAK87G,WAAL,EAAX;AACA,QAAMoE,OAAO5E,aAAarrE,GAAb,CACXjwC,EADW,EACP+jB,IADO,EACDA,IADC,EACK,KAAK87F,KAAL,CAAWzpG,IAAX,CAAgB,IAAhB,EAAsBwpG,aAAtB,CADL,EAEXI,0BAFW,CAAb;;AAIA,SAAK31F,OAAL,GAAe61F,KAAKlzB,KAApB;AACA,SAAKmwB,OAAL,GAAe,CAAC+C,KAAKrzB,OAAN,EAAeqzB,KAAKpzB,OAApB,CAAf;AACAyI,gBAAY2qB,KAAKlzB,KAAL,CAAW14D,KAAvB;;AAEA,QAAIyrF,0BAAJ,EAAgC;AAC9B,WAAKX,mBAAL,GAA2Bc,KAAKC,QAAhC;AACA,WAAKT,sBAAL,GACI,CAACQ,KAAKC,QAAL,CAAc7rF,KAAf,EAAsB4rF,KAAKC,QAAL,CAAc5rF,MAApC,CADJ;AAED,KAJD,MAIO;AACL,WAAK6qF,mBAAL,GAA2B,KAAK/0F,OAAhC;AACA,WAAKq1F,sBAAL,GAA8B,CAACnqB,SAAD,EAAYA,SAAZ,CAA9B;AACD;AACF;;AAED,OAAKnoB,OAAL,GAAe,CAACrpD,OAAO,CAAR,EAAWA,OAAO,CAAlB,CAAf;AACA,OAAKq5F,KAAL,GAAa,CAACr5F,IAAD,EAAOA,IAAP,CAAb;AACA,OAAK07F,UAAL,GAAkB,CAAClqB,SAAD,EAAYA,SAAZ,CAAlB;AACD,CApGD;;AAuGA;;;;;;;AAOA8lB,aAAarhG,SAAb,CAAuB6lG,KAAvB,GAA+B,UAASD,aAAT,EAAwB9+G,OAAxB,EAAiCoJ,CAAjC,EAAoC+N,CAApC,EAAuC;AACpE,MAAInY,UAAJ;AAAA,MAAOsgH,eAAP;AAAA,MAAeC,gBAAf;AACA;AACAv/G,UAAQssF,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC;;AAEA;AACAtsF,UAAQklD,SAAR,CAAkB97C,CAAlB,EAAqB+N,CAArB;;AAEAnX,UAAQ6xF,SAAR;;AAEA,MAAIloC,SAAS,KAAKv/B,OAAlB;AACA,MAAIu/B,WAAWv8C,QAAf,EAAyB;AACvBpN,YAAQ8xF,GAAR,CACEgtB,cAAc77F,IAAd,GAAqB,CADvB,EAC0B67F,cAAc77F,IAAd,GAAqB,CAD/C,EAEE,KAAK03F,OAFP,EAEgB,CAFhB,EAEmB,IAAI53G,KAAKiG,EAF5B,EAEgC,IAFhC;AAGD,GAJD,MAIO;AACL,QAAMy1G,UAAW,KAAKD,QAAL,KAAkB5+G,SAAnB,GAAgC,KAAK4+G,QAArC,GACZ,KAAK7D,OADT;AAEA,QAAI8D,YAAY,KAAK9D,OAArB,EAA8B;AAC5BhxD,eAAS,IAAIA,MAAb;AACD;AACD,SAAK3qD,IAAI,CAAT,EAAYA,KAAK2qD,MAAjB,EAAyB3qD,GAAzB,EAA8B;AAC5BsgH,eAAStgH,IAAI,CAAJ,GAAQ+D,KAAKiG,EAAb,GAAkB2gD,MAAlB,GAA2B5mD,KAAKiG,EAAL,GAAU,CAArC,GAAyC,KAAKqhB,MAAvD;AACAk1F,gBAAUvgH,IAAI,CAAJ,KAAU,CAAV,GAAc,KAAK27G,OAAnB,GAA6B8D,OAAvC;AACAz+G,cAAQ0xF,MAAR,CAAeotB,cAAc77F,IAAd,GAAqB,CAArB,GAAyBs8F,UAAUx8G,KAAK4G,GAAL,CAAS21G,MAAT,CAAlD,EACER,cAAc77F,IAAd,GAAqB,CAArB,GAAyBs8F,UAAUx8G,KAAK2G,GAAL,CAAS41G,MAAT,CADrC;AAED;AACF;;AAGD,MAAI,KAAK1mB,KAAT,EAAgB;AACd,QAAIxoF,QAAQ,KAAKwoF,KAAL,CAAWnF,QAAX,EAAZ;AACA,QAAIrjF,UAAU,IAAd,EAAoB;AAClBA,cAAQw5E,wBAAR;AACD;AACD5pF,YAAQipF,SAAR,GAAoB,4BAAY74E,KAAZ,CAApB;AACApQ,YAAQ+xF,IAAR;AACD;AACD,MAAI,KAAK2sB,OAAT,EAAkB;AAChB1+G,YAAQkpF,WAAR,GAAsB41B,cAAc51B,WAApC;AACAlpF,YAAQkzF,SAAR,GAAoB4rB,cAAc1iB,WAAlC;AACA,QAAI0iB,cAAc/rB,QAAlB,EAA4B;AAC1B/yF,cAAQm1D,WAAR,CAAoB2pD,cAAc/rB,QAAlC;AACA/yF,cAAQgzF,cAAR,GAAyB8rB,cAAc9rB,cAAvC;AACD;AACDhzF,YAAQ8yF,OAAR,GAAkBgsB,cAAchsB,OAAhC;AACA9yF,YAAQizF,QAAR,GAAmB6rB,cAAc7rB,QAAjC;AACAjzF,YAAQmzF,UAAR,GAAqB2rB,cAAc3rB,UAAnC;AACAnzF,YAAQgyF,MAAR;AACD;AACDhyF,UAAQ2xF,SAAR;AACD,CAnDD;;AAsDA;;;;AAIA4oB,aAAarhG,SAAb,CAAuB8lG,yBAAvB,GAAmD,UAASF,aAAT,EAAwB;AACzE,OAAKF,sBAAL,GAA8B,CAACE,cAAc77F,IAAf,EAAqB67F,cAAc77F,IAAnC,CAA9B;AACA,MAAI,KAAK21E,KAAT,EAAgB;AACd,SAAK0lB,mBAAL,GAA2B,KAAK/0F,OAAhC;AACA;AACD;;AAED;AACA;AACA,MAAMvpB,UAAU,gCAAsB8+G,cAAc77F,IAApC,EAA0C67F,cAAc77F,IAAxD,CAAhB;AACA,OAAKq7F,mBAAL,GAA2Bt+G,QAAQipB,MAAnC;;AAEA,OAAKk2F,uBAAL,CAA6BL,aAA7B,EAA4C9+G,OAA5C,EAAqD,CAArD,EAAwD,CAAxD;AACD,CAbD;;AAgBA;;;;;;;AAOAu6G,aAAarhG,SAAb,CAAuBimG,uBAAvB,GAAiD,UAASL,aAAT,EAAwB9+G,OAAxB,EAAiCoJ,CAAjC,EAAoC+N,CAApC,EAAuC;AACtF;AACAnX,UAAQssF,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC;;AAEA;AACAtsF,UAAQklD,SAAR,CAAkB97C,CAAlB,EAAqB+N,CAArB;;AAEAnX,UAAQ6xF,SAAR;;AAEA,MAAIloC,SAAS,KAAKv/B,OAAlB;AACA,MAAIu/B,WAAWv8C,QAAf,EAAyB;AACvBpN,YAAQ8xF,GAAR,CACEgtB,cAAc77F,IAAd,GAAqB,CADvB,EAC0B67F,cAAc77F,IAAd,GAAqB,CAD/C,EAEE,KAAK03F,OAFP,EAEgB,CAFhB,EAEmB,IAAI53G,KAAKiG,EAF5B,EAEgC,IAFhC;AAGD,GAJD,MAIO;AACL,QAAMy1G,UAAW,KAAKD,QAAL,KAAkB5+G,SAAnB,GAAgC,KAAK4+G,QAArC,GACZ,KAAK7D,OADT;AAEA,QAAI8D,YAAY,KAAK9D,OAArB,EAA8B;AAC5BhxD,eAAS,IAAIA,MAAb;AACD;AACD,QAAI3qD,UAAJ;AAAA,QAAOugH,gBAAP;AAAA,QAAgBD,eAAhB;AACA,SAAKtgH,IAAI,CAAT,EAAYA,KAAK2qD,MAAjB,EAAyB3qD,GAAzB,EAA8B;AAC5BsgH,eAAStgH,IAAI,CAAJ,GAAQ+D,KAAKiG,EAAb,GAAkB2gD,MAAlB,GAA2B5mD,KAAKiG,EAAL,GAAU,CAArC,GAAyC,KAAKqhB,MAAvD;AACAk1F,gBAAUvgH,IAAI,CAAJ,KAAU,CAAV,GAAc,KAAK27G,OAAnB,GAA6B8D,OAAvC;AACAz+G,cAAQ0xF,MAAR,CAAeotB,cAAc77F,IAAd,GAAqB,CAArB,GAAyBs8F,UAAUx8G,KAAK4G,GAAL,CAAS21G,MAAT,CAAlD,EACER,cAAc77F,IAAd,GAAqB,CAArB,GAAyBs8F,UAAUx8G,KAAK2G,GAAL,CAAS41G,MAAT,CADrC;AAED;AACF;;AAEDt/G,UAAQipF,SAAR,GAAoBW,wBAApB;AACA5pF,UAAQ+xF,IAAR;AACA,MAAI,KAAK2sB,OAAT,EAAkB;AAChB1+G,YAAQkpF,WAAR,GAAsB41B,cAAc51B,WAApC;AACAlpF,YAAQkzF,SAAR,GAAoB4rB,cAAc1iB,WAAlC;AACA,QAAI0iB,cAAc/rB,QAAlB,EAA4B;AAC1B/yF,cAAQm1D,WAAR,CAAoB2pD,cAAc/rB,QAAlC;AACA/yF,cAAQgzF,cAAR,GAAyB8rB,cAAc9rB,cAAvC;AACD;AACDhzF,YAAQgyF,MAAR;AACD;AACDhyF,UAAQ2xF,SAAR;AACD,CAzCD;;AA4CA;;;AAGA4oB,aAAarhG,SAAb,CAAuB8hG,WAAvB,GAAqC,YAAW;AAC9C,MAAMwE,iBAAiB,KAAKd,OAAL,GACrB,KAAKA,OAAL,CAAa1D,WAAb,EADqB,GACQ,GAD/B;AAEA,MAAMyE,eAAe,KAAK7mB,KAAL,GACnB,KAAKA,KAAL,CAAWoiB,WAAX,EADmB,GACQ,GAD7B;;AAGA,MAAM0E,cAAc,CAAC,KAAKrB,UAAN,IACfmB,kBAAkB,KAAKnB,UAAL,CAAgB,CAAhB,CAAlB,IACDoB,gBAAgB,KAAKpB,UAAL,CAAgB,CAAhB,CADf,IAED,KAAK1D,OAAL,IAAgB,KAAK0D,UAAL,CAAgB,CAAhB,CAFf,IAGD,KAAKG,QAAL,IAAiB,KAAKH,UAAL,CAAgB,CAAhB,CAHhB,IAID,KAAKh0F,MAAL,IAAe,KAAKg0F,UAAL,CAAgB,CAAhB,CAJd,IAKD,KAAKj0F,OAAL,IAAgB,KAAKi0F,UAAL,CAAgB,CAAhB,CANpB;;AAQA,MAAIqB,WAAJ,EAAiB;AACf,QAAMC,WAAW,MAAMH,cAAN,GAAuBC,YAAvB,IACZ,KAAK9E,OAAL,KAAiB/6G,SAAjB,GAA6B,KAAK+6G,OAAL,CAAa94G,QAAb,EAA7B,GAAuD,GAD3C,KAEZ,KAAK28G,QAAL,KAAkB5+G,SAAlB,GAA8B,KAAK4+G,QAAL,CAAc38G,QAAd,EAA9B,GAAyD,GAF7C,KAGZ,KAAKwoB,MAAL,KAAgBzqB,SAAhB,GAA4B,KAAKyqB,MAAL,CAAYxoB,QAAZ,EAA5B,GAAqD,GAHzC,KAIZ,KAAKuoB,OAAL,KAAiBxqB,SAAjB,GAA6B,KAAKwqB,OAAL,CAAavoB,QAAb,EAA7B,GAAuD,GAJ3C,CAAjB;AAKA,SAAKw8G,UAAL,GAAkB,CAACsB,QAAD,EAAWH,cAAX,EAA2BC,YAA3B,EAChB,KAAK9E,OADW,EACF,KAAK6D,QADH,EACa,KAAKn0F,MADlB,EAC0B,KAAKD,OAD/B,CAAlB;AAED;;AAED,SAAO,KAAKi0F,UAAL,CAAgB,CAAhB,CAAP;AACD,CAzBD;kBA0Be9D,Y;;;;;;;;;;;;;;;;;;ACpmBf;;AAGA;;;;;;;;;;;;;;;AAgBA;;;;;;;;;;;AAWA,IAAMqF,SAAS,SAATA,MAAS,CAASp7F,WAAT,EAAsB;;AAEnC,MAAMze,UAAUye,eAAe,EAA/B;;AAEA;;;;AAIA,OAAKq2F,MAAL,GAAc90G,QAAQqK,KAAR,KAAkBxQ,SAAlB,GAA8BmG,QAAQqK,KAAtC,GAA8C,IAA5D;;AAEA;;;;AAIA,OAAKyvG,QAAL,GAAgB95G,QAAQ+sF,OAAxB;;AAEA;;;;AAIA,OAAKgtB,SAAL,GAAiB/5G,QAAQgtF,QAAR,KAAqBnzF,SAArB,GAAiCmG,QAAQgtF,QAAzC,GAAoD,IAArE;;AAEA;;;;AAIA,OAAKgtB,eAAL,GAAuBh6G,QAAQitF,cAA/B;;AAEA;;;;AAIA,OAAKgtB,SAAL,GAAiBj6G,QAAQktF,QAAzB;;AAEA;;;;AAIA,OAAKgtB,WAAL,GAAmBl6G,QAAQotF,UAA3B;;AAEA;;;;AAIA,OAAK3F,MAAL,GAAcznF,QAAQytB,KAAtB;;AAEA;;;;AAIA,OAAKsnF,SAAL,GAAiBl7G,SAAjB;AACD,CAnDD;;AAsDA;;;;;AAvFA;;;AA4FAggH,OAAO1mG,SAAP,CAAiBiO,KAAjB,GAAyB,YAAW;AAClC,MAAM/W,QAAQ,KAAKqjF,QAAL,EAAd;AACA,SAAO,IAAImsB,MAAJ,CAAW;AAChBxvG,WAAQA,SAASA,MAAMvR,KAAhB,GAAyBuR,MAAMvR,KAAN,EAAzB,GAAyCuR,SAASxQ,SADzC;AAEhBkzF,aAAS,KAAKc,UAAL,EAFO;AAGhBb,cAAU,KAAKe,WAAL,KAAqB,KAAKA,WAAL,GAAmBj1F,KAAnB,EAArB,GAAkDe,SAH5C;AAIhBozF,oBAAgB,KAAKgB,iBAAL,EAJA;AAKhBf,cAAU,KAAKiB,WAAL,EALM;AAMhBf,gBAAY,KAAKkB,aAAL,EANI;AAOhB7gE,WAAO,KAAKkM,QAAL;AAPS,GAAX,CAAP;AASD,CAXD;;AAcA;;;;;AAKAkgF,OAAO1mG,SAAP,CAAiBu6E,QAAjB,GAA4B,YAAW;AACrC,SAAO,KAAKonB,MAAZ;AACD,CAFD;;AAKA;;;;;AAKA+E,OAAO1mG,SAAP,CAAiB06E,UAAjB,GAA8B,YAAW;AACvC,SAAO,KAAKisB,QAAZ;AACD,CAFD;;AAKA;;;;;AAKAD,OAAO1mG,SAAP,CAAiB46E,WAAjB,GAA+B,YAAW;AACxC,SAAO,KAAKgsB,SAAZ;AACD,CAFD;;AAKA;;;;;AAKAF,OAAO1mG,SAAP,CAAiB86E,iBAAjB,GAAqC,YAAW;AAC9C,SAAO,KAAK+rB,eAAZ;AACD,CAFD;;AAKA;;;;;AAKAH,OAAO1mG,SAAP,CAAiBg7E,WAAjB,GAA+B,YAAW;AACxC,SAAO,KAAK8rB,SAAZ;AACD,CAFD;;AAKA;;;;;AAKAJ,OAAO1mG,SAAP,CAAiBm7E,aAAjB,GAAiC,YAAW;AAC1C,SAAO,KAAK4rB,WAAZ;AACD,CAFD;;AAKA;;;;;AAKAL,OAAO1mG,SAAP,CAAiBwmB,QAAjB,GAA4B,YAAW;AACrC,SAAO,KAAK8tD,MAAZ;AACD,CAFD;;AAKA;;;;;;AAMAoyB,OAAO1mG,SAAP,CAAiB6hG,QAAjB,GAA4B,UAAS3qG,KAAT,EAAgB;AAC1C,OAAKyqG,MAAL,GAAczqG,KAAd;AACA,OAAK0qG,SAAL,GAAiBl7G,SAAjB;AACD,CAHD;;AAMA;;;;;;AAMAggH,OAAO1mG,SAAP,CAAiBgnG,UAAjB,GAA8B,UAASptB,OAAT,EAAkB;AAC9C,OAAK+sB,QAAL,GAAgB/sB,OAAhB;AACA,OAAKgoB,SAAL,GAAiBl7G,SAAjB;AACD,CAHD;;AAMA;;;;;;;;;;;;AAYAggH,OAAO1mG,SAAP,CAAiBi8C,WAAjB,GAA+B,UAAS49B,QAAT,EAAmB;AAChD,OAAK+sB,SAAL,GAAiB/sB,QAAjB;AACA,OAAK+nB,SAAL,GAAiBl7G,SAAjB;AACD,CAHD;;AAMA;;;;;;AAMAggH,OAAO1mG,SAAP,CAAiBinG,iBAAjB,GAAqC,UAASntB,cAAT,EAAyB;AAC5D,OAAK+sB,eAAL,GAAuB/sB,cAAvB;AACA,OAAK8nB,SAAL,GAAiBl7G,SAAjB;AACD,CAHD;;AAMA;;;;;;AAMAggH,OAAO1mG,SAAP,CAAiBknG,WAAjB,GAA+B,UAASntB,QAAT,EAAmB;AAChD,OAAK+sB,SAAL,GAAiB/sB,QAAjB;AACA,OAAK6nB,SAAL,GAAiBl7G,SAAjB;AACD,CAHD;;AAMA;;;;;;AAMAggH,OAAO1mG,SAAP,CAAiBmnG,aAAjB,GAAiC,UAASltB,UAAT,EAAqB;AACpD,OAAK8sB,WAAL,GAAmB9sB,UAAnB;AACA,OAAK2nB,SAAL,GAAiBl7G,SAAjB;AACD,CAHD;;AAMA;;;;;;AAMAggH,OAAO1mG,SAAP,CAAiBonG,QAAjB,GAA4B,UAAS9sF,KAAT,EAAgB;AAC1C,OAAKg6D,MAAL,GAAch6D,KAAd;AACA,OAAKsnF,SAAL,GAAiBl7G,SAAjB;AACD,CAHD;;AAMA;;;AAGAggH,OAAO1mG,SAAP,CAAiB8hG,WAAjB,GAA+B,YAAW;AACxC,MAAI,KAAKF,SAAL,KAAmBl7G,SAAvB,EAAkC;AAChC,SAAKk7G,SAAL,GAAiB,GAAjB;AACA,QAAI,KAAKD,MAAT,EAAiB;AACf,UAAI,OAAO,KAAKA,MAAZ,KAAuB,QAA3B,EAAqC;AACnC,aAAKC,SAAL,IAAkB,KAAKD,MAAvB;AACD,OAFD,MAEO;AACL,aAAKC,SAAL,IAAkB,mBAAO,KAAKD,MAAZ,EAAoBh5G,QAApB,EAAlB;AACD;AACF,KAND,MAMO;AACL,WAAKi5G,SAAL,IAAkB,GAAlB;AACD;AACD,SAAKA,SAAL,IAAkB,OACb,KAAK+E,QAAL,KAAkBjgH,SAAlB,GACC,KAAKigH,QAAL,CAAch+G,QAAd,EADD,GAC4B,GAFf,IAEsB,GAFtB,IAGb,KAAKi+G,SAAL,GACC,KAAKA,SAAL,CAAej+G,QAAf,EADD,GAC6B,GAJhB,IAIuB,GAJvB,IAKb,KAAKk+G,eAAL,KAAyBngH,SAAzB,GACC,KAAKmgH,eADN,GACwB,GANX,IAMkB,GANlB,IAOb,KAAKC,SAAL,KAAmBpgH,SAAnB,GACC,KAAKogH,SADN,GACkB,GARL,IAQY,GARZ,IASb,KAAKC,WAAL,KAAqBrgH,SAArB,GACC,KAAKqgH,WAAL,CAAiBp+G,QAAjB,EADD,GAC+B,GAVlB,IAUyB,GAVzB,IAWb,KAAK2rF,MAAL,KAAgB5tF,SAAhB,GACC,KAAK4tF,MAAL,CAAY3rF,QAAZ,EADD,GAC0B,GAZb,CAAlB;AAaD;;AAED,SAAO,KAAKi5G,SAAZ;AACD,CA5BD;kBA6Be8E,M;;;;;;;;;;;;;;;;;QCoHCW,U,GAAAA,U;QAoCAjqC,kB,GAAAA,kB;QAkCAkqC,kB,GAAAA,kB;;AA7YhB;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAGA;;;;;;;;;;AAWA;;;;;;;;AASA;;;;;;;;;;AAWA;;;;;;;;;;;;;AAcA;;;;;;;;;;;AAWA,IAAMt4F,QAAQ,SAARA,KAAQ,CAAS1D,WAAT,EAAsB;;AAElC,MAAMze,UAAUye,eAAe,EAA/B;;AAEA;;;;AAIA,OAAKkiE,SAAL,GAAiB,IAAjB;;AAEA;;;;AAIA,OAAKroB,iBAAL,GAAyBoiD,uBAAzB;;AAEA,MAAI16G,QAAQihB,QAAR,KAAqBpnB,SAAzB,EAAoC;AAClC,SAAKqnB,WAAL,CAAiBlhB,QAAQihB,QAAzB;AACD;;AAED;;;;AAIA,OAAK4xE,KAAL,GAAa7yF,QAAQgsF,IAAR,KAAiBnyF,SAAjB,GAA6BmG,QAAQgsF,IAArC,GAA4C,IAAzD;;AAEA;;;;AAIA,OAAKjF,MAAL,GAAc/mF,QAAQmmF,KAAR,KAAkBtsF,SAAlB,GAA8BmG,QAAQmmF,KAAtC,GAA8C,IAA5D;;AAEA;;;;AAIA,OAAKn3D,SAAL,GAAiBhvB,QAAQ2lB,QAAR,KAAqB9rB,SAArB,GAAiCmG,QAAQ2lB,QAAzC,GAAoD,IAArE;;AAEA;;;;AAIA,OAAKgzF,OAAL,GAAe34G,QAAQisF,MAAR,KAAmBpyF,SAAnB,GAA+BmG,QAAQisF,MAAvC,GAAgD,IAA/D;;AAEA;;;;AAIA,OAAK7B,KAAL,GAAapqF,QAAQ4tD,IAAR,KAAiB/zD,SAAjB,GAA6BmG,QAAQ4tD,IAArC,GAA4C,IAAzD;;AAEA;;;;AAIA,OAAK+sD,OAAL,GAAe36G,QAAQssE,MAAvB;AAED,CAxDD;;AA2DA;;;;;AAjNA;;;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkNAnqD,MAAMhP,SAAN,CAAgBiO,KAAhB,GAAwB,YAAW;AACjC,MAAIH,WAAW,KAAKO,WAAL,EAAf;AACA,MAAIP,YAAYA,SAASG,KAAzB,EAAgC;AAC9BH,eAAWA,SAASG,KAAT,EAAX;AACD;AACD,SAAO,IAAIe,KAAJ,CAAU;AACflB,cAAUA,QADK;AAEf+qE,UAAM,KAAKE,OAAL,KAAiB,KAAKA,OAAL,GAAe9qE,KAAf,EAAjB,GAA0CvnB,SAFjC;AAGfssF,WAAO,KAAKvjE,QAAL,KAAkB,KAAKA,QAAL,GAAgBxB,KAAhB,EAAlB,GAA4CvnB,SAHpC;AAIfoyF,YAAQ,KAAKE,SAAL,KAAmB,KAAKA,SAAL,GAAiB/qE,KAAjB,EAAnB,GAA8CvnB,SAJvC;AAKf+zD,UAAM,KAAKw+B,OAAL,KAAiB,KAAKA,OAAL,GAAehrE,KAAf,EAAjB,GAA0CvnB,SALjC;AAMfyyE,YAAQ,KAAKU,SAAL;AANO,GAAV,CAAP;AAQD,CAbD;;AAgBA;;;;;;AAMA7qD,MAAMhP,SAAN,CAAgB0f,WAAhB,GAA8B,YAAW;AACvC,SAAO,KAAK7D,SAAZ;AACD,CAFD;;AAKA;;;;;;AAMA7M,MAAMhP,SAAN,CAAgBynG,WAAhB,GAA8B,UAASj1F,QAAT,EAAmB;AAC/C,OAAKqJ,SAAL,GAAiBrJ,QAAjB;AACD,CAFD;;AAKA;;;;;;;AAOAxD,MAAMhP,SAAN,CAAgBqO,WAAhB,GAA8B,YAAW;AACvC,SAAO,KAAKm/D,SAAZ;AACD,CAFD;;AAKA;;;;;;AAMAx+D,MAAMhP,SAAN,CAAgBk5E,mBAAhB,GAAsC,YAAW;AAC/C,SAAO,KAAK/zB,iBAAZ;AACD,CAFD;;AAKA;;;;;AAKAn2C,MAAMhP,SAAN,CAAgB+4E,OAAhB,GAA0B,YAAW;AACnC,SAAO,KAAK2G,KAAZ;AACD,CAFD;;AAKA;;;;;AAKA1wE,MAAMhP,SAAN,CAAgB0nG,OAAhB,GAA0B,UAAS7uB,IAAT,EAAe;AACvC,OAAK6G,KAAL,GAAa7G,IAAb;AACD,CAFD;;AAKA;;;;;AAKA7pE,MAAMhP,SAAN,CAAgByP,QAAhB,GAA2B,YAAW;AACpC,SAAO,KAAKmkE,MAAZ;AACD,CAFD;;AAKA;;;;;AAKA5kE,MAAMhP,SAAN,CAAgB2nG,QAAhB,GAA2B,UAAS30B,KAAT,EAAgB;AACzC,OAAKY,MAAL,GAAcZ,KAAd;AACD,CAFD;;AAKA;;;;;AAKAhkE,MAAMhP,SAAN,CAAgBg5E,SAAhB,GAA4B,YAAW;AACrC,SAAO,KAAKwsB,OAAZ;AACD,CAFD;;AAKA;;;;;AAKAx2F,MAAMhP,SAAN,CAAgB4nG,SAAhB,GAA4B,UAAS9uB,MAAT,EAAiB;AAC3C,OAAK0sB,OAAL,GAAe1sB,MAAf;AACD,CAFD;;AAKA;;;;;AAKA9pE,MAAMhP,SAAN,CAAgBi5E,OAAhB,GAA0B,YAAW;AACnC,SAAO,KAAKhC,KAAZ;AACD,CAFD;;AAKA;;;;;AAKAjoE,MAAMhP,SAAN,CAAgB6nG,OAAhB,GAA0B,UAASptD,IAAT,EAAe;AACvC,OAAKw8B,KAAL,GAAax8B,IAAb;AACD,CAFD;;AAKA;;;;;AAKAzrC,MAAMhP,SAAN,CAAgB65D,SAAhB,GAA4B,YAAW;AACrC,SAAO,KAAK2tC,OAAZ;AACD,CAFD;;AAKA;;;;;;;;AAQAx4F,MAAMhP,SAAN,CAAgB+N,WAAhB,GAA8B,UAASD,QAAT,EAAmB;AAC/C,MAAI,OAAOA,QAAP,KAAoB,UAAxB,EAAoC;AAClC,SAAKq3C,iBAAL,GAAyBr3C,QAAzB;AACD,GAFD,MAEO,IAAI,OAAOA,QAAP,KAAoB,QAAxB,EAAkC;AACvC,SAAKq3C,iBAAL,GAAyB,UAAS5wD,OAAT,EAAkB;AACzC;AACE,8CAAwCA,QAAQlG,GAAR,CAAYyf,QAAZ;AAD1C;AAGD,KAJD;AAKD,GANM,MAMA,IAAI,CAACA,QAAL,EAAe;AACpB,SAAKq3C,iBAAL,GAAyBoiD,uBAAzB;AACD,GAFM,MAEA,IAAIz5F,aAAapnB,SAAjB,EAA4B;AACjC,SAAKy+D,iBAAL,GAAyB,YAAW;AAClC;AACE,8CAAwCr3C;AAD1C;AAGD,KAJD;AAKD;AACD,OAAK0/D,SAAL,GAAiB1/D,QAAjB;AACD,CAnBD;;AAsBA;;;;;;AAMAkB,MAAMhP,SAAN,CAAgBq6D,SAAhB,GAA4B,UAASlB,MAAT,EAAiB;AAC3C,OAAKquC,OAAL,GAAeruC,MAAf;AACD,CAFD;;AAKA;;;;;;;;AAQO,SAASkuC,UAAT,CAAoBj5G,GAApB,EAAyB;AAC9B,MAAImmG,sBAAJ;;AAEA,MAAI,OAAOnmG,GAAP,KAAe,UAAnB,EAA+B;AAC7BmmG,oBAAgBnmG,GAAhB;AACD,GAFD,MAEO;AACL;;;AAGA,QAAI2gB,eAAJ;AACA,QAAI5nB,MAAMC,OAAN,CAAcgH,GAAd,CAAJ,EAAwB;AACtB2gB,eAAS3gB,GAAT;AACD,KAFD,MAEO;AACL,2BAAOA,eAAe4gB,KAAtB,EACE,EADF,EADK,CAEE;AACPD,eAAS,CAAC3gB,GAAD,CAAT;AACD;AACDmmG,oBAAgB,yBAAW;AACzB,aAAOxlF,MAAP;AACD,KAFD;AAGD;AACD,SAAOwlF,aAAP;AACD;;AAGD;;;AAGA,IAAIuT,gBAAgB,IAApB;;AAGA;;;;;AAKO,SAAS1qC,kBAAT,CAA4B7oE,OAA5B,EAAqC4a,UAArC,EAAiD;AACtD;AACA;AACA;AACA;AACA;AACA,MAAI,CAAC24F,aAAL,EAAoB;AAClB,QAAMjvB,OAAO,IAAI6oB,cAAJ,CAAS;AACpBxqG,aAAO;AADa,KAAT,CAAb;AAGA,QAAM4hF,SAAS,IAAI4tB,gBAAJ,CAAW;AACxBxvG,aAAO,SADiB;AAExBojB,aAAO;AAFiB,KAAX,CAAf;AAIAwtF,oBAAgB,CACd,IAAI94F,KAAJ,CAAU;AACRgkE,aAAO,IAAIouB,gBAAJ,CAAgB;AACrBvoB,cAAMA,IADe;AAErBC,gBAAQA,MAFa;AAGrBhvC,gBAAQ;AAHa,OAAhB,CADC;AAMR+uC,YAAMA,IANE;AAORC,cAAQA;AAPA,KAAV,CADc,CAAhB;AAWD;AACD,SAAOgvB,aAAP;AACD;;AAGD;;;;AAIO,SAASR,kBAAT,GAA8B;AACnC;AACA,MAAMv4F,SAAS,EAAf;AACA,MAAMhS,QAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAAd;AACA,MAAMgrG,OAAO,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,CAAd,CAAb;AACA,MAAMztF,QAAQ,CAAd;AACAvL,SAAO2e,uBAAaogB,OAApB,IAA+B,CAC7B,IAAI9+B,KAAJ,CAAU;AACR6pE,UAAM,IAAI6oB,cAAJ,CAAS;AACbxqG,aAAO,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB;AADM,KAAT;AADE,GAAV,CAD6B,CAA/B;AAOA6X,SAAO2e,uBAAaugB,aAApB,IACIl/B,OAAO2e,uBAAaogB,OAApB,CADJ;;AAGA/+B,SAAO2e,uBAAakgB,WAApB,IAAmC,CACjC,IAAI5+B,KAAJ,CAAU;AACR8pE,YAAQ,IAAI4tB,gBAAJ,CAAW;AACjBxvG,aAAO6F,KADU;AAEjBud,aAAOA,QAAQ;AAFE,KAAX;AADA,GAAV,CADiC,EAOjC,IAAItL,KAAJ,CAAU;AACR8pE,YAAQ,IAAI4tB,gBAAJ,CAAW;AACjBxvG,aAAO6wG,IADU;AAEjBztF,aAAOA;AAFU,KAAX;AADA,GAAV,CAPiC,CAAnC;AAcAvL,SAAO2e,uBAAasgB,iBAApB,IACIj/B,OAAO2e,uBAAakgB,WAApB,CADJ;;AAGA7+B,SAAO2e,uBAAaC,MAApB,IACI5e,OAAO2e,uBAAaogB,OAApB,EAA6BnnD,MAA7B,CACEooB,OAAO2e,uBAAakgB,WAApB,CADF,CADJ;;AAMA7+B,SAAO2e,uBAAaigB,KAApB,IAA6B,CAC3B,IAAI3+B,KAAJ,CAAU;AACRgkE,WAAO,IAAIouB,gBAAJ,CAAgB;AACrBt3D,cAAQxvB,QAAQ,CADK;AAErBu+D,YAAM,IAAI6oB,cAAJ,CAAS;AACbxqG,eAAO6wG;AADM,OAAT,CAFe;AAKrBjvB,cAAQ,IAAI4tB,gBAAJ,CAAW;AACjBxvG,eAAO6F,KADU;AAEjBud,eAAOA,QAAQ;AAFE,OAAX;AALa,KAAhB,CADC;AAWR6+C,YAAQjlE;AAXA,GAAV,CAD2B,CAA7B;AAeA6a,SAAO2e,uBAAaqgB,WAApB,IACIh/B,OAAO2e,uBAAaigB,KAApB,CADJ;;AAGA5+B,SAAO2e,uBAAa6f,mBAApB,IACIx+B,OAAO2e,uBAAaogB,OAApB,EAA6BnnD,MAA7B,CACEooB,OAAO2e,uBAAakgB,WAApB,CADF,EAEE7+B,OAAO2e,uBAAaigB,KAApB,CAFF,CADJ;;AAMA,SAAO5+B,MAAP;AACD;;AAGD;;;;;AAKA,SAASw4F,uBAAT,CAAiChzG,OAAjC,EAA0C;AACxC,SAAOA,QAAQ8Z,WAAR,EAAP;AACD;;kBAEcW,K;;;;;;;;;;;;;;;;;;AC7iBf;;;;AACA;;;;;;AAGA;;;;;;AAPA;;;AAaA,IAAMg5F,qBAAqB,MAA3B;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;;;;;;;;AAQA,IAAMC,OAAO,SAAPA,IAAO,CAAS38F,WAAT,EAAsB;;AAEjC,MAAMze,UAAUye,eAAe,EAA/B;;AAEA;;;;AAIA,OAAK48F,KAAL,GAAar7G,QAAQ0d,IAArB;;AAEA;;;;AAIA,OAAKgsB,SAAL,GAAiB1pC,QAAQ62B,QAAzB;;AAEA;;;;AAIA,OAAKywD,eAAL,GAAuBtnF,QAAQ+1F,cAA/B;;AAEA;;;;AAIA,OAAKxO,MAAL,GAAcvnF,QAAQurC,KAAtB;;AAEA;;;;AAIA,OAAK6+C,KAAL,GAAapqF,QAAQ4tD,IAArB;;AAEA;;;;AAIA,OAAK0tD,UAAL,GAAkBt7G,QAAQutF,SAA1B;;AAEA;;;;AAIA,OAAKguB,aAAL,GAAqBv7G,QAAQwtF,YAA7B;;AAEA;;;;AAIA,OAAKqF,KAAL,GAAa7yF,QAAQgsF,IAAR,KAAiBnyF,SAAjB,GAA6BmG,QAAQgsF,IAArC,GACX,IAAI6oB,cAAJ,CAAS,EAACxqG,OAAO8wG,kBAAR,EAAT,CADF;;AAGA;;;;AAIA,OAAKK,SAAL,GAAiBx7G,QAAQitD,QAAR,KAAqBpzD,SAArB,GAAiCmG,QAAQitD,QAAzC,GAAoDjwD,KAAKiG,EAAL,GAAU,CAA/E;;AAEA;;;;AAIA,OAAKw4G,UAAL,GAAkBz7G,QAAQs7F,SAAR,KAAsBzhG,SAAtB,GAAkCmG,QAAQs7F,SAA1C,GAAsDC,wBAAcz6C,KAAtF;;AAEA;;;;AAIA,OAAK46D,SAAL,GAAiB,CAAC,CAAC17G,QAAQwtB,QAA3B;;AAEA;;;;AAIA,OAAKmrF,OAAL,GAAe34G,QAAQisF,MAAR,KAAmBpyF,SAAnB,GAA+BmG,QAAQisF,MAAvC,GAAgD,IAA/D;;AAEA;;;;AAIA,OAAK0vB,QAAL,GAAgB37G,QAAQgmF,OAAR,KAAoBnsF,SAApB,GAAgCmG,QAAQgmF,OAAxC,GAAkD,CAAlE;;AAEA;;;;AAIA,OAAK41B,QAAL,GAAgB57G,QAAQimF,OAAR,KAAoBpsF,SAApB,GAAgCmG,QAAQimF,OAAxC,GAAkD,CAAlE;;AAEA;;;;AAIA,OAAK41B,eAAL,GAAuB77G,QAAQg2F,cAAR,GAAyBh2F,QAAQg2F,cAAjC,GAAkD,IAAzE;;AAEA;;;;AAIA,OAAK8lB,iBAAL,GAAyB97G,QAAQi2F,gBAAR,GAA2Bj2F,QAAQi2F,gBAAnC,GAAsD,IAA/E;;AAEA;;;;AAIA,OAAK8lB,QAAL,GAAgB/7G,QAAQghC,OAAR,KAAoBnnC,SAApB,GAAgC,IAAhC,GAAuCmG,QAAQghC,OAA/D;AACD,CA1GD;;AA6GA;;;;;AAKAo6E,KAAKjoG,SAAL,CAAeiO,KAAf,GAAuB,YAAW;AAChC,SAAO,IAAIg6F,IAAJ,CAAS;AACd19F,UAAM,KAAK4xE,OAAL,EADQ;AAEdgM,eAAW,KAAKgB,YAAL,EAFG;AAGdrvC,cAAU,KAAKovC,WAAL,EAHI;AAId7uE,cAAU,KAAK4uE,WAAL,EAJI;AAKdvlE,cAAU,KAAKsF,WAAL,EALI;AAMd45D,oBAAgB,KAAKnN,iBAAL,EANF;AAOdr9C,WAAO,KAAKs9C,QAAL,EAPO;AAQdj7B,UAAM,KAAKw+B,OAAL,EARQ;AASdmB,eAAW,KAAKyC,YAAL,EATG;AAUdxC,kBAAc,KAAK0C,eAAL,EAVA;AAWdlE,UAAM,KAAKE,OAAL,KAAiB,KAAKA,OAAL,GAAe9qE,KAAf,EAAjB,GAA0CvnB,SAXlC;AAYdoyF,YAAQ,KAAKE,SAAL,KAAmB,KAAKA,SAAL,GAAiB/qE,KAAjB,EAAnB,GAA8CvnB,SAZxC;AAadmsF,aAAS,KAAKwJ,UAAL,EAbK;AAcdvJ,aAAS,KAAKyJ,UAAL,EAdK;AAedsG,oBAAgB,KAAKuG,iBAAL,KAA2B,KAAKA,iBAAL,GAAyBn7E,KAAzB,EAA3B,GAA8DvnB,SAfhE;AAgBdo8F,sBAAkB,KAAKuG,mBAAL,KAA6B,KAAKA,mBAAL,GAA2Bp7E,KAA3B,EAA7B,GAAkEvnB;AAhBtE,GAAT,CAAP;AAkBD,CAnBD;;AAsBA;;;;;AAKAuhH,KAAKjoG,SAAL,CAAeipF,WAAf,GAA6B,YAAW;AACtC,SAAO,KAAKsf,SAAZ;AACD,CAFD;;AAKA;;;;;AAKAN,KAAKjoG,SAAL,CAAem8E,OAAf,GAAyB,YAAW;AAClC,SAAO,KAAK+rB,KAAZ;AACD,CAFD;;AAKA;;;;;AAKAD,KAAKjoG,SAAL,CAAekpF,WAAf,GAA6B,YAAW;AACtC,SAAO,KAAKmf,SAAZ;AACD,CAFD;;AAKA;;;;;AAKAJ,KAAKjoG,SAAL,CAAempF,YAAf,GAA8B,YAAW;AACvC,SAAO,KAAKmf,UAAZ;AACD,CAFD;;AAKA;;;;;AAKAL,KAAKjoG,SAAL,CAAeq8E,UAAf,GAA4B,YAAW;AACrC,SAAO,KAAKmsB,QAAZ;AACD,CAFD;;AAKA;;;;;AAKAP,KAAKjoG,SAAL,CAAeu8E,UAAf,GAA4B,YAAW;AACrC,SAAO,KAAKksB,QAAZ;AACD,CAFD;;AAKA;;;;;AAKAR,KAAKjoG,SAAL,CAAe+4E,OAAf,GAAyB,YAAW;AAClC,SAAO,KAAK2G,KAAZ;AACD,CAFD;;AAKA;;;;;AAKAuoB,KAAKjoG,SAAL,CAAey1E,iBAAf,GAAmC,YAAW;AAC5C,SAAO,KAAKtB,eAAZ;AACD,CAFD;;AAKA;;;;;AAKA8zB,KAAKjoG,SAAL,CAAegpB,WAAf,GAA6B,YAAW;AACtC,SAAO,KAAKuN,SAAZ;AACD,CAFD;;AAKA;;;;;AAKA0xE,KAAKjoG,SAAL,CAAe01E,QAAf,GAA0B,YAAW;AACnC,SAAO,KAAKtB,MAAZ;AACD,CAFD;;AAKA;;;;;AAKA6zB,KAAKjoG,SAAL,CAAeg5E,SAAf,GAA2B,YAAW;AACpC,SAAO,KAAKwsB,OAAZ;AACD,CAFD;;AAKA;;;;;AAKAyC,KAAKjoG,SAAL,CAAei5E,OAAf,GAAyB,YAAW;AAClC,SAAO,KAAKhC,KAAZ;AACD,CAFD;;AAKA;;;;;AAKAgxB,KAAKjoG,SAAL,CAAe68E,YAAf,GAA8B,YAAW;AACvC,SAAO,KAAKsrB,UAAZ;AACD,CAFD;;AAKA;;;;;AAKAF,KAAKjoG,SAAL,CAAe+8E,eAAf,GAAiC,YAAW;AAC1C,SAAO,KAAKqrB,aAAZ;AACD,CAFD;;AAKA;;;;;AAKAH,KAAKjoG,SAAL,CAAeopF,iBAAf,GAAmC,YAAW;AAC5C,SAAO,KAAKsf,eAAZ;AACD,CAFD;;AAKA;;;;;AAKAT,KAAKjoG,SAAL,CAAeqpF,mBAAf,GAAqC,YAAW;AAC9C,SAAO,KAAKsf,iBAAZ;AACD,CAFD;;AAKA;;;;;AAKAV,KAAKjoG,SAAL,CAAespF,UAAf,GAA4B,YAAW;AACrC,SAAO,KAAKsf,QAAZ;AACD,CAFD;;AAKA;;;;;;AAMAX,KAAKjoG,SAAL,CAAe6oG,WAAf,GAA6B,UAASxuF,QAAT,EAAmB;AAC9C,OAAKkuF,SAAL,GAAiBluF,QAAjB;AACD,CAFD;;AAKA;;;;;;AAMA4tF,KAAKjoG,SAAL,CAAe8oG,OAAf,GAAyB,UAASv+F,IAAT,EAAe;AACtC,OAAK29F,KAAL,GAAa39F,IAAb;AACD,CAFD;;AAKA;;;;;;AAMA09F,KAAKjoG,SAAL,CAAe+oG,WAAf,GAA6B,UAASjvD,QAAT,EAAmB;AAC9C,OAAKuuD,SAAL,GAAiBvuD,QAAjB;AACD,CAFD;;AAKA;;;;;;AAMAmuD,KAAKjoG,SAAL,CAAegpG,UAAf,GAA4B,UAASn2B,OAAT,EAAkB;AAC5C,OAAK21B,QAAL,GAAgB31B,OAAhB;AACD,CAFD;;AAKA;;;;;;AAMAo1B,KAAKjoG,SAAL,CAAeipG,UAAf,GAA4B,UAASn2B,OAAT,EAAkB;AAC5C,OAAK21B,QAAL,GAAgB31B,OAAhB;AACD,CAFD;;AAKA;;;;;;AAMAm1B,KAAKjoG,SAAL,CAAekpG,YAAf,GAA8B,UAAS/gB,SAAT,EAAoB;AAChD,OAAKmgB,UAAL,GAAkBngB,SAAlB;AACD,CAFD;;AAKA;;;;;;AAMA8f,KAAKjoG,SAAL,CAAe0nG,OAAf,GAAyB,UAAS7uB,IAAT,EAAe;AACtC,OAAK6G,KAAL,GAAa7G,IAAb;AACD,CAFD;;AAKA;;;;;;AAMAovB,KAAKjoG,SAAL,CAAespB,WAAf,GAA6B,UAAS5F,QAAT,EAAmB;AAC9C,OAAK6S,SAAL,GAAiB7S,QAAjB;AACD,CAFD;;AAKA;;;;;;AAMAukF,KAAKjoG,SAAL,CAAewhG,QAAf,GAA0B,UAASppE,KAAT,EAAgB;AACxC,OAAKg8C,MAAL,GAAch8C,KAAd;AACD,CAFD;;AAKA;;;;;;AAMA6vE,KAAKjoG,SAAL,CAAe4nG,SAAf,GAA2B,UAAS9uB,MAAT,EAAiB;AAC1C,OAAK0sB,OAAL,GAAe1sB,MAAf;AACD,CAFD;;AAKA;;;;;;AAMAmvB,KAAKjoG,SAAL,CAAe6nG,OAAf,GAAyB,UAASptD,IAAT,EAAe;AACtC,OAAKw8B,KAAL,GAAax8B,IAAb;AACD,CAFD;;AAKA;;;;;;AAMAwtD,KAAKjoG,SAAL,CAAempG,YAAf,GAA8B,UAAS/uB,SAAT,EAAoB;AAChD,OAAK+tB,UAAL,GAAkB/tB,SAAlB;AACD,CAFD;;AAKA;;;;;;AAMA6tB,KAAKjoG,SAAL,CAAeopG,eAAf,GAAiC,UAAS/uB,YAAT,EAAuB;AACtD,OAAK+tB,aAAL,GAAqB/tB,YAArB;AACD,CAFD;;AAKA;;;;;;AAMA4tB,KAAKjoG,SAAL,CAAeqpG,iBAAf,GAAmC,UAASxwB,IAAT,EAAe;AAChD,OAAK6vB,eAAL,GAAuB7vB,IAAvB;AACD,CAFD;;AAKA;;;;;;AAMAovB,KAAKjoG,SAAL,CAAespG,mBAAf,GAAqC,UAASxwB,MAAT,EAAiB;AACpD,OAAK6vB,iBAAL,GAAyB7vB,MAAzB;AACD,CAFD;;AAKA;;;;;;AAMAmvB,KAAKjoG,SAAL,CAAeupG,UAAf,GAA4B,UAAS17E,OAAT,EAAkB;AAC5C,OAAK+6E,QAAL,GAAgB/6E,OAAhB;AACD,CAFD;kBAGeo6E,I;;;;;;;;;;;;;;;;;ACvhBf;;;;AAIA;;;;;;;kBAOe;AACbt6D,SAAO,OADM;AAEb06C,QAAM;AAFO,C;;;;;;;;;;;;;;;;;ACXf;;;;AAIA;;;;AAIO,IAAMmhB,8CAAmB,EAAzB;;AAEP;;;;AAIO,IAAM75E,gDAAoB,GAA1B,C;;;;;;;;;;;;;;;;;QCuBS9pC,M,GAAAA,M;QAUA4jH,K,GAAAA,K;QAYAC,Q,GAAAA,Q;QAmCA78F,G,GAAAA,G;QAiBA88F,Y,GAAAA,Y;QAoBArhH,K,GAAAA,K;QAeAslC,M,GAAAA,M;QAcAwK,K,GAAAA,K;QAYA4T,S,GAAAA,S;QAkBAgiD,O,GAAAA,O;QAkBA4b,M,GAAAA,M;QA2BAC,W,GAAAA,W;;AAxOhB;;AAGA;;;;;;AAOA;;;;;;;;;;;;AAaA;;;;AAIA,IAAMC,OAAO,IAAI3iH,KAAJ,CAAU,CAAV,CAAb;;AAGA;;;;AAjCA;;;AAqCO,SAAStB,MAAT,GAAkB;AACvB,SAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CAAP;AACD;;AAGD;;;;;AAKO,SAAS4jH,KAAT,CAAe9yE,SAAf,EAA0B;AAC/B,SAAO9pB,IAAI8pB,SAAJ,EAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,CAAP;AACD;;AAGD;;;;;;;AAOO,SAAS+yE,QAAT,CAAkBK,UAAlB,EAA8BC,UAA9B,EAA0C;AAC/C,MAAMC,KAAKF,WAAW,CAAX,CAAX;AACA,MAAMG,KAAKH,WAAW,CAAX,CAAX;AACA,MAAM7M,KAAK6M,WAAW,CAAX,CAAX;AACA,MAAMI,KAAKJ,WAAW,CAAX,CAAX;AACA,MAAMK,KAAKL,WAAW,CAAX,CAAX;AACA,MAAMM,KAAKN,WAAW,CAAX,CAAX;AACA,MAAMO,KAAKN,WAAW,CAAX,CAAX;AACA,MAAMO,KAAKP,WAAW,CAAX,CAAX;AACA,MAAM7M,KAAK6M,WAAW,CAAX,CAAX;AACA,MAAMzpG,KAAKypG,WAAW,CAAX,CAAX;AACA,MAAMQ,KAAKR,WAAW,CAAX,CAAX;AACA,MAAMS,KAAKT,WAAW,CAAX,CAAX;;AAEAD,aAAW,CAAX,IAAgBE,KAAKK,EAAL,GAAUpN,KAAKqN,EAA/B;AACAR,aAAW,CAAX,IAAgBG,KAAKI,EAAL,GAAUH,KAAKI,EAA/B;AACAR,aAAW,CAAX,IAAgBE,KAAK9M,EAAL,GAAUD,KAAK38F,EAA/B;AACAwpG,aAAW,CAAX,IAAgBG,KAAK/M,EAAL,GAAUgN,KAAK5pG,EAA/B;AACAwpG,aAAW,CAAX,IAAgBE,KAAKO,EAAL,GAAUtN,KAAKuN,EAAf,GAAoBL,EAApC;AACAL,aAAW,CAAX,IAAgBG,KAAKM,EAAL,GAAUL,KAAKM,EAAf,GAAoBJ,EAApC;;AAEA,SAAON,UAAP;AACD;;AAED;;;;;;;;;;;AAWO,SAASl9F,GAAT,CAAa8pB,SAAb,EAAwB3oC,CAAxB,EAA2BD,CAA3B,EAA8BxC,CAA9B,EAAiCsT,CAAjC,EAAoC7O,CAApC,EAAuC4I,CAAvC,EAA0C;AAC/C+9B,YAAU,CAAV,IAAe3oC,CAAf;AACA2oC,YAAU,CAAV,IAAe5oC,CAAf;AACA4oC,YAAU,CAAV,IAAeprC,CAAf;AACAorC,YAAU,CAAV,IAAe93B,CAAf;AACA83B,YAAU,CAAV,IAAe3mC,CAAf;AACA2mC,YAAU,CAAV,IAAe/9B,CAAf;AACA,SAAO+9B,SAAP;AACD;;AAGD;;;;;;AAMO,SAASgzE,YAAT,CAAsBI,UAAtB,EAAkCC,UAAlC,EAA8C;AACnDD,aAAW,CAAX,IAAgBC,WAAW,CAAX,CAAhB;AACAD,aAAW,CAAX,IAAgBC,WAAW,CAAX,CAAhB;AACAD,aAAW,CAAX,IAAgBC,WAAW,CAAX,CAAhB;AACAD,aAAW,CAAX,IAAgBC,WAAW,CAAX,CAAhB;AACAD,aAAW,CAAX,IAAgBC,WAAW,CAAX,CAAhB;AACAD,aAAW,CAAX,IAAgBC,WAAW,CAAX,CAAhB;AACA,SAAOD,UAAP;AACD;;AAGD;;;;;;;;;AASO,SAASzhH,KAAT,CAAequC,SAAf,EAA0BpjB,UAA1B,EAAsC;AAC3C,MAAMrjB,IAAIqjB,WAAW,CAAX,CAAV;AACA,MAAMtV,IAAIsV,WAAW,CAAX,CAAV;AACAA,aAAW,CAAX,IAAgBojB,UAAU,CAAV,IAAezmC,CAAf,GAAmBymC,UAAU,CAAV,IAAe14B,CAAlC,GAAsC04B,UAAU,CAAV,CAAtD;AACApjB,aAAW,CAAX,IAAgBojB,UAAU,CAAV,IAAezmC,CAAf,GAAmBymC,UAAU,CAAV,IAAe14B,CAAlC,GAAsC04B,UAAU,CAAV,CAAtD;AACA,SAAOpjB,UAAP;AACD;;AAGD;;;;;;AAMO,SAASqa,MAAT,CAAgB+I,SAAhB,EAA2BiD,KAA3B,EAAkC;AACvC,MAAMnpC,MAAM5G,KAAK4G,GAAL,CAASmpC,KAAT,CAAZ;AACA,MAAMppC,MAAM3G,KAAK2G,GAAL,CAASopC,KAAT,CAAZ;AACA,SAAO8vE,SAAS/yE,SAAT,EAAoB9pB,IAAIi9F,IAAJ,EAAUr5G,GAAV,EAAeD,GAAf,EAAoB,CAACA,GAArB,EAA0BC,GAA1B,EAA+B,CAA/B,EAAkC,CAAlC,CAApB,CAAP;AACD;;AAGD;;;;;;;AAOO,SAAS2nC,KAAT,CAAezB,SAAf,EAA0BzmC,CAA1B,EAA6B+N,CAA7B,EAAgC;AACrC,SAAOyrG,SAAS/yE,SAAT,EAAoB9pB,IAAIi9F,IAAJ,EAAU55G,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB+N,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAApB,CAAP;AACD;;AAGD;;;;;;;AAOO,SAAS+tC,SAAT,CAAmBrV,SAAnB,EAA8B/kB,EAA9B,EAAkCC,EAAlC,EAAsC;AAC3C,SAAO63F,SAAS/yE,SAAT,EAAoB9pB,IAAIi9F,IAAJ,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsBl4F,EAAtB,EAA0BC,EAA1B,CAApB,CAAP;AACD;;AAGD;;;;;;;;;;;;;AAaO,SAASm8E,OAAT,CAAiBr3D,SAAjB,EAA4B8iB,GAA5B,EAAiCC,GAAjC,EAAsChO,EAAtC,EAA0CqI,EAA1C,EAA8Cna,KAA9C,EAAqD+f,GAArD,EAA0DC,GAA1D,EAA+D;AACpE,MAAMppD,MAAM3G,KAAK2G,GAAL,CAASopC,KAAT,CAAZ;AACA,MAAMnpC,MAAM5G,KAAK4G,GAAL,CAASmpC,KAAT,CAAZ;AACAjD,YAAU,CAAV,IAAe+U,KAAKj7C,GAApB;AACAkmC,YAAU,CAAV,IAAeod,KAAKvjD,GAApB;AACAmmC,YAAU,CAAV,IAAe,CAAC+U,EAAD,GAAMl7C,GAArB;AACAmmC,YAAU,CAAV,IAAeod,KAAKtjD,GAApB;AACAkmC,YAAU,CAAV,IAAegjB,MAAMjO,EAAN,GAAWj7C,GAAX,GAAiBmpD,MAAMlO,EAAN,GAAWl7C,GAA5B,GAAkCipD,GAAjD;AACA9iB,YAAU,CAAV,IAAegjB,MAAM5F,EAAN,GAAWvjD,GAAX,GAAiBopD,MAAM7F,EAAN,GAAWtjD,GAA5B,GAAkCipD,GAAjD;AACA,SAAO/iB,SAAP;AACD;;AAGD;;;;;AAKO,SAASizE,MAAT,CAAgBjzE,SAAhB,EAA2B;AAChC,MAAM+zE,MAAMb,YAAYlzE,SAAZ,CAAZ;AACA,uBAAO+zE,QAAQ,CAAf,EAAkB,EAAlB,EAFgC,CAET;;AAEvB,MAAM18G,IAAI2oC,UAAU,CAAV,CAAV;AACA,MAAM5oC,IAAI4oC,UAAU,CAAV,CAAV;AACA,MAAMprC,IAAIorC,UAAU,CAAV,CAAV;AACA,MAAM93B,IAAI83B,UAAU,CAAV,CAAV;AACA,MAAM3mC,IAAI2mC,UAAU,CAAV,CAAV;AACA,MAAM/9B,IAAI+9B,UAAU,CAAV,CAAV;;AAEAA,YAAU,CAAV,IAAe93B,IAAI6rG,GAAnB;AACA/zE,YAAU,CAAV,IAAe,CAAC5oC,CAAD,GAAK28G,GAApB;AACA/zE,YAAU,CAAV,IAAe,CAACprC,CAAD,GAAKm/G,GAApB;AACA/zE,YAAU,CAAV,IAAe3oC,IAAI08G,GAAnB;AACA/zE,YAAU,CAAV,IAAe,CAACprC,IAAIqN,CAAJ,GAAQiG,IAAI7O,CAAb,IAAkB06G,GAAjC;AACA/zE,YAAU,CAAV,IAAe,EAAE3oC,IAAI4K,CAAJ,GAAQ7K,IAAIiC,CAAd,IAAmB06G,GAAlC;;AAEA,SAAO/zE,SAAP;AACD;;AAGD;;;;;AAKO,SAASkzE,WAAT,CAAqBrrC,GAArB,EAA0B;AAC/B,SAAOA,IAAI,CAAJ,IAASA,IAAI,CAAJ,CAAT,GAAkBA,IAAI,CAAJ,IAASA,IAAI,CAAJ,CAAlC;AACD,C;;;;;;;;;;;;;;;;;QCsCe7jC,U,GAAAA,U;AAnRhB;;;;AAIA;;;;AAKA;;;;AAIO,IAAMgwE,oBAAM,CAAZ;;AAGP;;;;AAIO,IAAMC,gCAAY,MAAlB;;AAGP;;;;AAIO,IAAMC,gDAAoB,MAA1B;;AAGP;;;;AAIO,IAAMC,8CAAmB,UAAzB;;AAGP;;;;AAIO,IAAMC,gCAAY,MAAlB;;AAGP;;;;AAIO,IAAMC,0CAAiB,MAAvB;;AAGP;;;;AAIO,IAAMC,oDAAsB,MAA5B;;AAGP;;;;AAIO,IAAM1mE,sCAAe,MAArB;;AAGP;;;;AAIO,IAAM2mE,sDAAuB,MAA7B;;AAGP;;;;AAIO,IAAMC,oCAAc,MAApB;;AAGP;;;;AAIO,IAAMC,oCAAc,MAApB;;AAGP;;;;AAIO,IAAMC,sCAAe,MAArB;;AAGP;;;;AAIO,IAAMC,gCAAY,MAAlB;;AAGP;;;;AAIO,IAAMC,wBAAQ,MAAd;;AAGP;;;;AAIO,IAAMC,sCAAe,MAArB;;AAGP;;;;AAIO,IAAMC,kCAAa,MAAnB;;AAGP;;;;AAIO,IAAMC,sCAAe,MAArB;;AAGP;;;;AAIO,IAAMC,wCAAgB,MAAtB;;AAGP;;;;AAIO,IAAMC,0CAAiB,MAAvB;;AAGP;;;;AAIO,IAAMC,sCAAe,MAArB;;AAGP;;;;AAIO,IAAMC,wBAAQ,MAAd;;AAGP;;;;AAIO,IAAMC,sBAAO,MAAb;;AAGP;;;;AAIO,IAAMC,4CAAkB,MAAxB;;AAGP;;;;AAIO,IAAMC,wCAAgB,MAAtB;;AAGP;;;;AAIO,IAAMC,oCAAc,MAApB;;AAGP;;;;AAIO,IAAMC,0BAAS,MAAf;;AAGP;;;;AAIO,IAAMC,kDAAqB,MAA3B;;AAGP;;;;AAIO,IAAMC,kDAAqB,MAA3B;;AAGP;;;;AAIO,IAAMC,0CAAiB,MAAvB;;AAGP;;;;AAIO,IAAMC,0CAAiB,MAAvB;;AAGP;;;;AAIO,IAAMC,kCAAa,MAAnB;;AAGP;;;;AAIO,IAAMC,8BAAW,MAAjB;;AAGP;;;;AAIO,IAAMC,wCAAgB,MAAtB;;AAGP;;;;AAIO,IAAMC,0CAAiB,MAAvB;;AAGP;;;;AAIO,IAAMC,oCAAc,MAApB;;AAGP;;;AAIA;;;;AAIA,IAAMC,cAAc,CAClB,oBADkB,EAElB,OAFkB,EAGlB,WAHkB,EAIlB,WAJkB,CAApB;;AAQA;;;;;AAKO,SAASlyE,UAAT,CAAoB5qB,MAApB,EAA4B+8F,cAA5B,EAA4C;AACjD,MAAMxiG,KAAKuiG,YAAY9mH,MAAvB;AACA,OAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIwkB,EAApB,EAAwB,EAAExkB,CAA1B,EAA6B;AAC3B,QAAI;AACF,UAAMgB,UAAUipB,OAAO4qB,UAAP,CAAkBkyE,YAAY/mH,CAAZ,CAAlB,EAAkCgnH,cAAlC,CAAhB;AACA,UAAIhmH,OAAJ,EAAa;AACX,eAAO,sCAAuCA;AAA9C;AACD;AACF,KALD,CAKE,OAAOkJ,CAAP,EAAU;AACV;AACD;AACF;AACD,SAAO,IAAP;AACD,C;;;;;;;;;;;;;;AChSD;AACA,IAAI+8G,UAAU3tG,OAAOC,OAAP,GAAiB,EAA/B;;AAEA;AACA;AACA;AACA;;AAEA,IAAI2tG,gBAAJ;AACA,IAAIC,kBAAJ;;AAEA,SAASC,gBAAT,GAA4B;AACxB,UAAM,IAAIr2G,KAAJ,CAAU,iCAAV,CAAN;AACH;AACD,SAASs2G,mBAAT,GAAgC;AAC5B,UAAM,IAAIt2G,KAAJ,CAAU,mCAAV,CAAN;AACH;AACA,aAAY;AACT,QAAI;AACA,YAAI,OAAO6e,UAAP,KAAsB,UAA1B,EAAsC;AAClCs3F,+BAAmBt3F,UAAnB;AACH,SAFD,MAEO;AACHs3F,+BAAmBE,gBAAnB;AACH;AACJ,KAND,CAME,OAAOl9G,CAAP,EAAU;AACRg9G,2BAAmBE,gBAAnB;AACH;AACD,QAAI;AACA,YAAI,OAAO13F,YAAP,KAAwB,UAA5B,EAAwC;AACpCy3F,iCAAqBz3F,YAArB;AACH,SAFD,MAEO;AACHy3F,iCAAqBE,mBAArB;AACH;AACJ,KAND,CAME,OAAOn9G,CAAP,EAAU;AACRi9G,6BAAqBE,mBAArB;AACH;AACJ,CAnBA,GAAD;AAoBA,SAASC,UAAT,CAAoBC,GAApB,EAAyB;AACrB,QAAIL,qBAAqBt3F,UAAzB,EAAqC;AACjC;AACA,eAAOA,WAAW23F,GAAX,EAAgB,CAAhB,CAAP;AACH;AACD;AACA,QAAI,CAACL,qBAAqBE,gBAArB,IAAyC,CAACF,gBAA3C,KAAgEt3F,UAApE,EAAgF;AAC5Es3F,2BAAmBt3F,UAAnB;AACA,eAAOA,WAAW23F,GAAX,EAAgB,CAAhB,CAAP;AACH;AACD,QAAI;AACA;AACA,eAAOL,iBAAiBK,GAAjB,EAAsB,CAAtB,CAAP;AACH,KAHD,CAGE,OAAMr9G,CAAN,EAAQ;AACN,YAAI;AACA;AACA,mBAAOg9G,iBAAiB3rG,IAAjB,CAAsB,IAAtB,EAA4BgsG,GAA5B,EAAiC,CAAjC,CAAP;AACH,SAHD,CAGE,OAAMr9G,CAAN,EAAQ;AACN;AACA,mBAAOg9G,iBAAiB3rG,IAAjB,CAAsB,IAAtB,EAA4BgsG,GAA5B,EAAiC,CAAjC,CAAP;AACH;AACJ;AAGJ;AACD,SAASC,eAAT,CAAyBC,MAAzB,EAAiC;AAC7B,QAAIN,uBAAuBz3F,YAA3B,EAAyC;AACrC;AACA,eAAOA,aAAa+3F,MAAb,CAAP;AACH;AACD;AACA,QAAI,CAACN,uBAAuBE,mBAAvB,IAA8C,CAACF,kBAAhD,KAAuEz3F,YAA3E,EAAyF;AACrFy3F,6BAAqBz3F,YAArB;AACA,eAAOA,aAAa+3F,MAAb,CAAP;AACH;AACD,QAAI;AACA;AACA,eAAON,mBAAmBM,MAAnB,CAAP;AACH,KAHD,CAGE,OAAOv9G,CAAP,EAAS;AACP,YAAI;AACA;AACA,mBAAOi9G,mBAAmB5rG,IAAnB,CAAwB,IAAxB,EAA8BksG,MAA9B,CAAP;AACH,SAHD,CAGE,OAAOv9G,CAAP,EAAS;AACP;AACA;AACA,mBAAOi9G,mBAAmB5rG,IAAnB,CAAwB,IAAxB,EAA8BksG,MAA9B,CAAP;AACH;AACJ;AAIJ;AACD,IAAIC,QAAQ,EAAZ;AACA,IAAIC,WAAW,KAAf;AACA,IAAIC,YAAJ;AACA,IAAIC,aAAa,CAAC,CAAlB;;AAEA,SAASC,eAAT,GAA2B;AACvB,QAAI,CAACH,QAAD,IAAa,CAACC,YAAlB,EAAgC;AAC5B;AACH;AACDD,eAAW,KAAX;AACA,QAAIC,aAAa3nH,MAAjB,EAAyB;AACrBynH,gBAAQE,aAAa/mH,MAAb,CAAoB6mH,KAApB,CAAR;AACH,KAFD,MAEO;AACHG,qBAAa,CAAC,CAAd;AACH;AACD,QAAIH,MAAMznH,MAAV,EAAkB;AACd8nH;AACH;AACJ;;AAED,SAASA,UAAT,GAAsB;AAClB,QAAIJ,QAAJ,EAAc;AACV;AACH;AACD,QAAI37C,UAAUs7C,WAAWQ,eAAX,CAAd;AACAH,eAAW,IAAX;;AAEA,QAAIjtG,MAAMgtG,MAAMznH,MAAhB;AACA,WAAMya,GAAN,EAAW;AACPktG,uBAAeF,KAAf;AACAA,gBAAQ,EAAR;AACA,eAAO,EAAEG,UAAF,GAAentG,GAAtB,EAA2B;AACvB,gBAAIktG,YAAJ,EAAkB;AACdA,6BAAaC,UAAb,EAAyBG,GAAzB;AACH;AACJ;AACDH,qBAAa,CAAC,CAAd;AACAntG,cAAMgtG,MAAMznH,MAAZ;AACH;AACD2nH,mBAAe,IAAf;AACAD,eAAW,KAAX;AACAH,oBAAgBx7C,OAAhB;AACH;;AAEDi7C,QAAQgB,QAAR,GAAmB,UAAUV,GAAV,EAAe;AAC9B,QAAI/mH,OAAO,IAAIa,KAAJ,CAAUgiC,UAAUpjC,MAAV,GAAmB,CAA7B,CAAX;AACA,QAAIojC,UAAUpjC,MAAV,GAAmB,CAAvB,EAA0B;AACtB,aAAK,IAAID,IAAI,CAAb,EAAgBA,IAAIqjC,UAAUpjC,MAA9B,EAAsCD,GAAtC,EAA2C;AACvCQ,iBAAKR,IAAI,CAAT,IAAcqjC,UAAUrjC,CAAV,CAAd;AACH;AACJ;AACD0nH,UAAM1lH,IAAN,CAAW,IAAIkmH,IAAJ,CAASX,GAAT,EAAc/mH,IAAd,CAAX;AACA,QAAIknH,MAAMznH,MAAN,KAAiB,CAAjB,IAAsB,CAAC0nH,QAA3B,EAAqC;AACjCL,mBAAWS,UAAX;AACH;AACJ,CAXD;;AAaA;AACA,SAASG,IAAT,CAAcX,GAAd,EAAmBjjH,KAAnB,EAA0B;AACtB,SAAKijH,GAAL,GAAWA,GAAX;AACA,SAAKjjH,KAAL,GAAaA,KAAb;AACH;AACD4jH,KAAKhuG,SAAL,CAAe8tG,GAAf,GAAqB,YAAY;AAC7B,SAAKT,GAAL,CAAS/kH,KAAT,CAAe,IAAf,EAAqB,KAAK8B,KAA1B;AACH,CAFD;AAGA2iH,QAAQ/4E,KAAR,GAAgB,SAAhB;AACA+4E,QAAQkB,OAAR,GAAkB,IAAlB;AACAlB,QAAQmB,GAAR,GAAc,EAAd;AACAnB,QAAQoB,IAAR,GAAe,EAAf;AACApB,QAAQqB,OAAR,GAAkB,EAAlB,C,CAAsB;AACtBrB,QAAQsB,QAAR,GAAmB,EAAnB;;AAEA,SAASC,IAAT,GAAgB,CAAE;;AAElBvB,QAAQt0F,EAAR,GAAa61F,IAAb;AACAvB,QAAQwB,WAAR,GAAsBD,IAAtB;AACAvB,QAAQp0F,IAAR,GAAe21F,IAAf;AACAvB,QAAQyB,GAAR,GAAcF,IAAd;AACAvB,QAAQ0B,cAAR,GAAyBH,IAAzB;AACAvB,QAAQ2B,kBAAR,GAA6BJ,IAA7B;AACAvB,QAAQ4B,IAAR,GAAeL,IAAf;AACAvB,QAAQ6B,eAAR,GAA0BN,IAA1B;AACAvB,QAAQ8B,mBAAR,GAA8BP,IAA9B;;AAEAvB,QAAQ1wE,SAAR,GAAoB,UAAUl2C,IAAV,EAAgB;AAAE,WAAO,EAAP;AAAW,CAAjD;;AAEA4mH,QAAQ35G,OAAR,GAAkB,UAAUjN,IAAV,EAAgB;AAC9B,UAAM,IAAI0Q,KAAJ,CAAU,kCAAV,CAAN;AACH,CAFD;;AAIAk2G,QAAQ+B,GAAR,GAAc,YAAY;AAAE,WAAO,GAAP;AAAY,CAAxC;AACA/B,QAAQgC,KAAR,GAAgB,UAAUC,GAAV,EAAe;AAC3B,UAAM,IAAIn4G,KAAJ,CAAU,gCAAV,CAAN;AACH,CAFD;AAGAk2G,QAAQkC,KAAR,GAAgB,YAAW;AAAE,WAAO,CAAP;AAAW,CAAxC,C;;;;;;;;;;;;;;;;ACvLC,WAAUvuG,MAAV,EAAkBwuG,OAAlB,EAA2B;AAC3B,kCAAO7vG,OAAP,OAAmB,QAAnB,IAA+B,OAAOD,MAAP,KAAkB,WAAjD,GAA+DA,OAAOC,OAAP,GAAiB6vG,SAAhF,GACA,QAA6C,oCAAOA,OAAP;AAAA;AAAA;AAAA;AAAA,oGAA7C,GACC,SAFD;AAGA,CAJA,aAIQ,YAAY;AAAE;;AAEvB,aAASC,WAAT,CAAqBnjG,GAArB,EAA0B1mB,CAA1B,EAA6B25B,IAA7B,EAAmCypB,KAAnC,EAA0Cj8C,OAA1C,EAAmD;AAC/C2iH,wBAAgBpjG,GAAhB,EAAqB1mB,CAArB,EAAwB25B,QAAQ,CAAhC,EAAmCypB,SAAU18B,IAAIjmB,MAAJ,GAAa,CAA1D,EAA8D0G,WAAW4iH,cAAzE;AACH;;AAED,aAASD,eAAT,CAAyBpjG,GAAzB,EAA8B1mB,CAA9B,EAAiC25B,IAAjC,EAAuCypB,KAAvC,EAA8Cj8C,OAA9C,EAAuD;;AAEnD,eAAOi8C,QAAQzpB,IAAf,EAAqB;AACjB,gBAAIypB,QAAQzpB,IAAR,GAAe,GAAnB,EAAwB;AACpB,oBAAI7uB,IAAIs4C,QAAQzpB,IAAR,GAAe,CAAvB;AACA,oBAAIhwB,IAAI3J,IAAI25B,IAAJ,GAAW,CAAnB;AACA,oBAAItkB,IAAI9Q,KAAKyG,GAAL,CAASF,CAAT,CAAR;AACA,oBAAIgB,IAAI,MAAMvH,KAAK00E,GAAL,CAAS,IAAI5jE,CAAJ,GAAQ,CAAjB,CAAd;AACA,oBAAI20G,KAAK,MAAMzlH,KAAKsG,IAAL,CAAUwK,IAAIvJ,CAAJ,IAAShB,IAAIgB,CAAb,IAAkBhB,CAA5B,CAAN,IAAwCnB,IAAImB,IAAI,CAAR,GAAY,CAAZ,GAAgB,CAAC,CAAjB,GAAqB,CAA7D,CAAT;AACA,oBAAIm/G,UAAU1lH,KAAKkH,GAAL,CAASkuB,IAAT,EAAep1B,KAAKC,KAAL,CAAWxE,IAAI2J,IAAImC,CAAJ,GAAQhB,CAAZ,GAAgBk/G,EAA3B,CAAf,CAAd;AACA,oBAAIE,WAAW3lH,KAAKiH,GAAL,CAAS43C,KAAT,EAAgB7+C,KAAKC,KAAL,CAAWxE,IAAI,CAAC8K,IAAInB,CAAL,IAAUmC,CAAV,GAAchB,CAAlB,GAAsBk/G,EAAjC,CAAhB,CAAf;AACAF,gCAAgBpjG,GAAhB,EAAqB1mB,CAArB,EAAwBiqH,OAAxB,EAAiCC,QAAjC,EAA2C/iH,OAA3C;AACH;;AAED,gBAAInC,IAAI0hB,IAAI1mB,CAAJ,CAAR;AACA,gBAAIQ,IAAIm5B,IAAR;AACA,gBAAIjwB,IAAI05C,KAAR;;AAEA+mE,iBAAKzjG,GAAL,EAAUiT,IAAV,EAAgB35B,CAAhB;AACA,gBAAImH,QAAQuf,IAAI08B,KAAJ,CAAR,EAAoBp+C,CAApB,IAAyB,CAA7B,EAAgCmlH,KAAKzjG,GAAL,EAAUiT,IAAV,EAAgBypB,KAAhB;;AAEhC,mBAAO5iD,IAAIkJ,CAAX,EAAc;AACVygH,qBAAKzjG,GAAL,EAAUlmB,CAAV,EAAakJ,CAAb;AACAlJ;AACAkJ;AACA,uBAAOvC,QAAQuf,IAAIlmB,CAAJ,CAAR,EAAgBwE,CAAhB,IAAqB,CAA5B;AAA+BxE;AAA/B,iBACA,OAAO2G,QAAQuf,IAAIhd,CAAJ,CAAR,EAAgB1E,CAAhB,IAAqB,CAA5B;AAA+B0E;AAA/B;AACH;;AAED,gBAAIvC,QAAQuf,IAAIiT,IAAJ,CAAR,EAAmB30B,CAAnB,MAA0B,CAA9B,EAAiCmlH,KAAKzjG,GAAL,EAAUiT,IAAV,EAAgBjwB,CAAhB,EAAjC,KACK;AACDA;AACAygH,qBAAKzjG,GAAL,EAAUhd,CAAV,EAAa05C,KAAb;AACH;;AAED,gBAAI15C,KAAK1J,CAAT,EAAY25B,OAAOjwB,IAAI,CAAX;AACZ,gBAAI1J,KAAK0J,CAAT,EAAY05C,QAAQ15C,IAAI,CAAZ;AACf;AACJ;;AAED,aAASygH,IAAT,CAAczjG,GAAd,EAAmBlmB,CAAnB,EAAsBkJ,CAAtB,EAAyB;AACrB,YAAIiiC,MAAMjlB,IAAIlmB,CAAJ,CAAV;AACAkmB,YAAIlmB,CAAJ,IAASkmB,IAAIhd,CAAJ,CAAT;AACAgd,YAAIhd,CAAJ,IAASiiC,GAAT;AACH;;AAED,aAASo+E,cAAT,CAAwBrhH,CAAxB,EAA2BD,CAA3B,EAA8B;AAC1B,eAAOC,IAAID,CAAJ,GAAQ,CAAC,CAAT,GAAaC,IAAID,CAAJ,GAAQ,CAAR,GAAY,CAAhC;AACH;;AAED,WAAOohH,WAAP;AAEC,CA9DA,CAAD,C;;;;;;;;;;;;ACAA;;AAEA/vG,OAAOC,OAAP,GAAiB8hG,KAAjB;AACA/hG,OAAOC,OAAP,CAAejI,OAAf,GAAyB+pG,KAAzB;;AAEA,IAAIgO,cAAc,mBAAAruG,CAAQ,8DAAR,CAAlB;;AAEA,SAASqgG,KAAT,CAAeuO,UAAf,EAA2BvrH,MAA3B,EAAmC;AAC/B,QAAI,EAAE,gBAAgBg9G,KAAlB,CAAJ,EAA8B,OAAO,IAAIA,KAAJ,CAAUuO,UAAV,EAAsBvrH,MAAtB,CAAP;;AAE9B;AACA,SAAKwrH,WAAL,GAAmB9lH,KAAKkH,GAAL,CAAS,CAAT,EAAY2+G,cAAc,CAA1B,CAAnB;AACA,SAAKE,WAAL,GAAmB/lH,KAAKkH,GAAL,CAAS,CAAT,EAAYlH,KAAKqH,IAAL,CAAU,KAAKy+G,WAAL,GAAmB,GAA7B,CAAZ,CAAnB;;AAEA,QAAIxrH,MAAJ,EAAY;AACR,aAAK0rH,WAAL,CAAiB1rH,MAAjB;AACH;;AAED,SAAK0nB,KAAL;AACH;;AAEDs1F,MAAMnhG,SAAN,GAAkB;;AAEdu9D,SAAK,eAAY;AACb,eAAO,KAAKuyC,IAAL,CAAU,KAAK9oG,IAAf,EAAqB,EAArB,CAAP;AACH,KAJa;;AAMdi6F,YAAQ,gBAAUzjC,IAAV,EAAgB;;AAEpB,YAAIpiC,OAAO,KAAKp0B,IAAhB;AAAA,YACI3hB,SAAS,EADb;AAAA,YAEI0qH,SAAS,KAAKA,MAFlB;;AAIA,YAAI,CAACtpF,WAAW+2C,IAAX,EAAiBpiC,IAAjB,CAAL,EAA6B,OAAO/1C,MAAP;;AAE7B,YAAI2qH,gBAAgB,EAApB;AAAA,YACIlqH,CADJ;AAAA,YACO0a,GADP;AAAA,YACYzV,KADZ;AAAA,YACmBklH,SADnB;;AAGA,eAAO70E,IAAP,EAAa;AACT,iBAAKt1C,IAAI,CAAJ,EAAO0a,MAAM46B,KAAK80E,QAAL,CAAcnqH,MAAhC,EAAwCD,IAAI0a,GAA5C,EAAiD1a,GAAjD,EAAsD;;AAElDiF,wBAAQqwC,KAAK80E,QAAL,CAAcpqH,CAAd,CAAR;AACAmqH,4BAAY70E,KAAK+0E,IAAL,GAAYJ,OAAOhlH,KAAP,CAAZ,GAA4BA,KAAxC;;AAEA,oBAAI07B,WAAW+2C,IAAX,EAAiByyC,SAAjB,CAAJ,EAAiC;AAC7B,wBAAI70E,KAAK+0E,IAAT,EAAe9qH,OAAOyC,IAAP,CAAYiD,KAAZ,EAAf,KACK,IAAIm7B,SAASs3C,IAAT,EAAeyyC,SAAf,CAAJ,EAA+B,KAAKH,IAAL,CAAU/kH,KAAV,EAAiB1F,MAAjB,EAA/B,KACA2qH,cAAcloH,IAAd,CAAmBiD,KAAnB;AACR;AACJ;AACDqwC,mBAAO40E,cAAc7nG,GAAd,EAAP;AACH;;AAED,eAAO9iB,MAAP;AACH,KAjCa;;AAmCdq8F,cAAU,kBAAUlkB,IAAV,EAAgB;;AAEtB,YAAIpiC,OAAO,KAAKp0B,IAAhB;AAAA,YACI+oG,SAAS,KAAKA,MADlB;;AAGA,YAAI,CAACtpF,WAAW+2C,IAAX,EAAiBpiC,IAAjB,CAAL,EAA6B,OAAO,KAAP;;AAE7B,YAAI40E,gBAAgB,EAApB;AAAA,YACIlqH,CADJ;AAAA,YACO0a,GADP;AAAA,YACYzV,KADZ;AAAA,YACmBklH,SADnB;;AAGA,eAAO70E,IAAP,EAAa;AACT,iBAAKt1C,IAAI,CAAJ,EAAO0a,MAAM46B,KAAK80E,QAAL,CAAcnqH,MAAhC,EAAwCD,IAAI0a,GAA5C,EAAiD1a,GAAjD,EAAsD;;AAElDiF,wBAAQqwC,KAAK80E,QAAL,CAAcpqH,CAAd,CAAR;AACAmqH,4BAAY70E,KAAK+0E,IAAL,GAAYJ,OAAOhlH,KAAP,CAAZ,GAA4BA,KAAxC;;AAEA,oBAAI07B,WAAW+2C,IAAX,EAAiByyC,SAAjB,CAAJ,EAAiC;AAC7B,wBAAI70E,KAAK+0E,IAAL,IAAajqF,SAASs3C,IAAT,EAAeyyC,SAAf,CAAjB,EAA4C,OAAO,IAAP;AAC5CD,kCAAcloH,IAAd,CAAmBiD,KAAnB;AACH;AACJ;AACDqwC,mBAAO40E,cAAc7nG,GAAd,EAAP;AACH;;AAED,eAAO,KAAP;AACH,KA5Da;;AA8Dd0H,UAAM,cAAU7I,IAAV,EAAgB;AAClB,YAAI,EAAEA,QAAQA,KAAKjhB,MAAf,CAAJ,EAA4B,OAAO,IAAP;;AAE5B,YAAIihB,KAAKjhB,MAAL,GAAc,KAAK6pH,WAAvB,EAAoC;AAChC,iBAAK,IAAI9pH,IAAI,CAAR,EAAW0a,MAAMwG,KAAKjhB,MAA3B,EAAmCD,IAAI0a,GAAvC,EAA4C1a,GAA5C,EAAiD;AAC7C,qBAAKmpE,MAAL,CAAYjoD,KAAKlhB,CAAL,CAAZ;AACH;AACD,mBAAO,IAAP;AACH;;AAED;AACA,YAAIs1C,OAAO,KAAKg1E,MAAL,CAAYppG,KAAKrhB,KAAL,EAAZ,EAA0B,CAA1B,EAA6BqhB,KAAKjhB,MAAL,GAAc,CAA3C,EAA8C,CAA9C,CAAX;;AAEA,YAAI,CAAC,KAAKihB,IAAL,CAAUkpG,QAAV,CAAmBnqH,MAAxB,EAAgC;AAC5B;AACA,iBAAKihB,IAAL,GAAYo0B,IAAZ;AAEH,SAJD,MAIO,IAAI,KAAKp0B,IAAL,CAAUuT,MAAV,KAAqB6gB,KAAK7gB,MAA9B,EAAsC;AACzC;AACA,iBAAK81F,UAAL,CAAgB,KAAKrpG,IAArB,EAA2Bo0B,IAA3B;AAEH,SAJM,MAIA;AACH,gBAAI,KAAKp0B,IAAL,CAAUuT,MAAV,GAAmB6gB,KAAK7gB,MAA5B,EAAoC;AAChC;AACA,oBAAI+1F,UAAU,KAAKtpG,IAAnB;AACA,qBAAKA,IAAL,GAAYo0B,IAAZ;AACAA,uBAAOk1E,OAAP;AACH;;AAED;AACA,iBAAKC,OAAL,CAAan1E,IAAb,EAAmB,KAAKp0B,IAAL,CAAUuT,MAAV,GAAmB6gB,KAAK7gB,MAAxB,GAAiC,CAApD,EAAuD,IAAvD;AACH;;AAED,eAAO,IAAP;AACH,KAhGa;;AAkGd00C,YAAQ,gBAAUx2D,IAAV,EAAgB;AACpB,YAAIA,IAAJ,EAAU,KAAK83G,OAAL,CAAa93G,IAAb,EAAmB,KAAKuO,IAAL,CAAUuT,MAAV,GAAmB,CAAtC;AACV,eAAO,IAAP;AACH,KArGa;;AAuGd1O,WAAO,iBAAY;AACf,aAAK7E,IAAL,GAAYwpG,WAAW,EAAX,CAAZ;AACA,eAAO,IAAP;AACH,KA1Ga;;AA4Gd/jG,YAAQ,gBAAUhU,IAAV,EAAgBg4G,QAAhB,EAA0B;AAC9B,YAAI,CAACh4G,IAAL,EAAW,OAAO,IAAP;;AAEX,YAAI2iC,OAAO,KAAKp0B,IAAhB;AAAA,YACIw2D,OAAO,KAAKuyC,MAAL,CAAYt3G,IAAZ,CADX;AAAA,YAEIvQ,OAAO,EAFX;AAAA,YAGIwoH,UAAU,EAHd;AAAA,YAII5qH,CAJJ;AAAA,YAIOV,MAJP;AAAA,YAIe+E,KAJf;AAAA,YAIsBwmH,OAJtB;;AAMA;AACA,eAAOv1E,QAAQlzC,KAAKnC,MAApB,EAA4B;;AAExB,gBAAI,CAACq1C,IAAL,EAAW;AAAE;AACTA,uBAAOlzC,KAAKigB,GAAL,EAAP;AACA/iB,yBAAS8C,KAAKA,KAAKnC,MAAL,GAAc,CAAnB,CAAT;AACAD,oBAAI4qH,QAAQvoG,GAAR,EAAJ;AACAwoG,0BAAU,IAAV;AACH;;AAED,gBAAIv1E,KAAK+0E,IAAT,EAAe;AAAE;AACbhmH,wBAAQymH,SAASn4G,IAAT,EAAe2iC,KAAK80E,QAApB,EAA8BO,QAA9B,CAAR;;AAEA,oBAAItmH,UAAU,CAAC,CAAf,EAAkB;AACd;AACAixC,yBAAK80E,QAAL,CAAc9jG,MAAd,CAAqBjiB,KAArB,EAA4B,CAA5B;AACAjC,yBAAKJ,IAAL,CAAUszC,IAAV;AACA,yBAAKy1E,SAAL,CAAe3oH,IAAf;AACA,2BAAO,IAAP;AACH;AACJ;;AAED,gBAAI,CAACyoH,OAAD,IAAY,CAACv1E,KAAK+0E,IAAlB,IAA0BjqF,SAASkV,IAAT,EAAeoiC,IAAf,CAA9B,EAAoD;AAAE;AAClDt1E,qBAAKJ,IAAL,CAAUszC,IAAV;AACAs1E,wBAAQ5oH,IAAR,CAAahC,CAAb;AACAA,oBAAI,CAAJ;AACAV,yBAASg2C,IAAT;AACAA,uBAAOA,KAAK80E,QAAL,CAAc,CAAd,CAAP;AAEH,aAPD,MAOO,IAAI9qH,MAAJ,EAAY;AAAE;AACjBU;AACAs1C,uBAAOh2C,OAAO8qH,QAAP,CAAgBpqH,CAAhB,CAAP;AACA6qH,0BAAU,KAAV;AAEH,aALM,MAKAv1E,OAAO,IAAP,CAjCiB,CAiCJ;AACvB;;AAED,eAAO,IAAP;AACH,KA3Ja;;AA6Jd20E,YAAQ,gBAAUt3G,IAAV,EAAgB;AAAE,eAAOA,IAAP;AAAc,KA7J1B;;AA+Jdq4G,iBAAaC,eA/JC;AAgKdC,iBAAaC,eAhKC;;AAkKdC,YAAQ,kBAAY;AAAE,eAAO,KAAKlqG,IAAZ;AAAmB,KAlK3B;;AAoKdmqG,cAAU,kBAAUnqG,IAAV,EAAgB;AACtB,aAAKA,IAAL,GAAYA,IAAZ;AACA,eAAO,IAAP;AACH,KAvKa;;AAyKd8oG,UAAM,cAAU10E,IAAV,EAAgB/1C,MAAhB,EAAwB;AAC1B,YAAI2qH,gBAAgB,EAApB;AACA,eAAO50E,IAAP,EAAa;AACT,gBAAIA,KAAK+0E,IAAT,EAAe9qH,OAAOyC,IAAP,CAAYQ,KAAZ,CAAkBjD,MAAlB,EAA0B+1C,KAAK80E,QAA/B,EAAf,KACKF,cAAcloH,IAAd,CAAmBQ,KAAnB,CAAyB0nH,aAAzB,EAAwC50E,KAAK80E,QAA7C;;AAEL90E,mBAAO40E,cAAc7nG,GAAd,EAAP;AACH;AACD,eAAO9iB,MAAP;AACH,KAlLa;;AAoLd+qH,YAAQ,gBAAUpP,KAAV,EAAiB/hF,IAAjB,EAAuBypB,KAAvB,EAA8BnuB,MAA9B,EAAsC;;AAE1C,YAAI5wB,IAAI++C,QAAQzpB,IAAR,GAAe,CAAvB;AAAA,YACImyF,IAAI,KAAKzB,WADb;AAAA,YAEIv0E,IAFJ;;AAIA,YAAIzxC,KAAKynH,CAAT,EAAY;AACR;AACAh2E,mBAAOo1E,WAAWxP,MAAMr7G,KAAN,CAAYs5B,IAAZ,EAAkBypB,QAAQ,CAA1B,CAAX,CAAP;AACA2oE,qBAASj2E,IAAT,EAAe,KAAK20E,MAApB;AACA,mBAAO30E,IAAP;AACH;;AAED,YAAI,CAAC7gB,MAAL,EAAa;AACT;AACAA,qBAAS1wB,KAAKqH,IAAL,CAAUrH,KAAKyG,GAAL,CAAS3G,CAAT,IAAcE,KAAKyG,GAAL,CAAS8gH,CAAT,CAAxB,CAAT;;AAEA;AACAA,gBAAIvnH,KAAKqH,IAAL,CAAUvH,IAAIE,KAAKoG,GAAL,CAASmhH,CAAT,EAAY72F,SAAS,CAArB,CAAd,CAAJ;AACH;;AAED6gB,eAAOo1E,WAAW,EAAX,CAAP;AACAp1E,aAAK+0E,IAAL,GAAY,KAAZ;AACA/0E,aAAK7gB,MAAL,GAAcA,MAAd;;AAEA;;AAEA,YAAI+2F,KAAKznH,KAAKqH,IAAL,CAAUvH,IAAIynH,CAAd,CAAT;AAAA,YACIG,KAAKD,KAAKznH,KAAKqH,IAAL,CAAUrH,KAAKsG,IAAL,CAAUihH,CAAV,CAAV,CADd;AAAA,YAEItrH,CAFJ;AAAA,YAEOkJ,CAFP;AAAA,YAEUwiH,MAFV;AAAA,YAEkBC,MAFlB;;AAIAC,oBAAY1Q,KAAZ,EAAmB/hF,IAAnB,EAAyBypB,KAAzB,EAAgC6oE,EAAhC,EAAoC,KAAKT,WAAzC;;AAEA,aAAKhrH,IAAIm5B,IAAT,EAAen5B,KAAK4iD,KAApB,EAA2B5iD,KAAKyrH,EAAhC,EAAoC;;AAEhCC,qBAAS3nH,KAAKiH,GAAL,CAAShL,IAAIyrH,EAAJ,GAAS,CAAlB,EAAqB7oE,KAArB,CAAT;;AAEAgpE,wBAAY1Q,KAAZ,EAAmBl7G,CAAnB,EAAsB0rH,MAAtB,EAA8BF,EAA9B,EAAkC,KAAKN,WAAvC;;AAEA,iBAAKhiH,IAAIlJ,CAAT,EAAYkJ,KAAKwiH,MAAjB,EAAyBxiH,KAAKsiH,EAA9B,EAAkC;;AAE9BG,yBAAS5nH,KAAKiH,GAAL,CAAS9B,IAAIsiH,EAAJ,GAAS,CAAlB,EAAqBE,MAArB,CAAT;;AAEA;AACAp2E,qBAAK80E,QAAL,CAAcpoH,IAAd,CAAmB,KAAKsoH,MAAL,CAAYpP,KAAZ,EAAmBhyG,CAAnB,EAAsByiH,MAAtB,EAA8Bl3F,SAAS,CAAvC,CAAnB;AACH;AACJ;;AAED82F,iBAASj2E,IAAT,EAAe,KAAK20E,MAApB;;AAEA,eAAO30E,IAAP;AACH,KAvOa;;AAyOdu2E,oBAAgB,wBAAUn0C,IAAV,EAAgBpiC,IAAhB,EAAsBw2E,KAAtB,EAA6B1pH,IAA7B,EAAmC;;AAE/C,YAAIpC,CAAJ,EAAO0a,GAAP,EAAYzV,KAAZ,EAAmB8mH,UAAnB,EAA+BpvE,IAA/B,EAAqCqvE,WAArC,EAAkD1wD,OAAlD,EAA2D2wD,cAA3D;;AAEA,eAAO,IAAP,EAAa;AACT7pH,iBAAKJ,IAAL,CAAUszC,IAAV;;AAEA,gBAAIA,KAAK+0E,IAAL,IAAajoH,KAAKnC,MAAL,GAAc,CAAd,KAAoB6rH,KAArC,EAA4C;;AAE5CxwD,sBAAU2wD,iBAAiB79G,QAA3B;;AAEA,iBAAKpO,IAAI,CAAJ,EAAO0a,MAAM46B,KAAK80E,QAAL,CAAcnqH,MAAhC,EAAwCD,IAAI0a,GAA5C,EAAiD1a,GAAjD,EAAsD;AAClDiF,wBAAQqwC,KAAK80E,QAAL,CAAcpqH,CAAd,CAAR;AACA28C,uBAAOuvE,SAASjnH,KAAT,CAAP;AACA+mH,8BAAcG,aAAaz0C,IAAb,EAAmBzyE,KAAnB,IAA4B03C,IAA1C;;AAEA;AACA,oBAAIqvE,cAAcC,cAAlB,EAAkC;AAC9BA,qCAAiBD,WAAjB;AACA1wD,8BAAU3e,OAAO2e,OAAP,GAAiB3e,IAAjB,GAAwB2e,OAAlC;AACAywD,iCAAa9mH,KAAb;AAEH,iBALD,MAKO,IAAI+mH,gBAAgBC,cAApB,EAAoC;AACvC;AACA,wBAAItvE,OAAO2e,OAAX,EAAoB;AAChBA,kCAAU3e,IAAV;AACAovE,qCAAa9mH,KAAb;AACH;AACJ;AACJ;;AAEDqwC,mBAAOy2E,cAAcz2E,KAAK80E,QAAL,CAAc,CAAd,CAArB;AACH;;AAED,eAAO90E,IAAP;AACH,KA5Qa;;AA8Qdm1E,aAAS,iBAAU93G,IAAV,EAAgBm5G,KAAhB,EAAuBM,MAAvB,EAA+B;;AAEpC,YAAInC,SAAS,KAAKA,MAAlB;AAAA,YACIvyC,OAAO00C,SAASz5G,IAAT,GAAgBs3G,OAAOt3G,IAAP,CAD3B;AAAA,YAEI05G,aAAa,EAFjB;;AAIA;AACA,YAAI/2E,OAAO,KAAKu2E,cAAL,CAAoBn0C,IAApB,EAA0B,KAAKx2D,IAA/B,EAAqC4qG,KAArC,EAA4CO,UAA5C,CAAX;;AAEA;AACA/2E,aAAK80E,QAAL,CAAcpoH,IAAd,CAAmB2Q,IAAnB;AACAsT,eAAOqvB,IAAP,EAAaoiC,IAAb;;AAEA;AACA,eAAOo0C,SAAS,CAAhB,EAAmB;AACf,gBAAIO,WAAWP,KAAX,EAAkB1B,QAAlB,CAA2BnqH,MAA3B,GAAoC,KAAK4pH,WAA7C,EAA0D;AACtD,qBAAKyC,MAAL,CAAYD,UAAZ,EAAwBP,KAAxB;AACAA;AACH,aAHD,MAGO;AACV;;AAED;AACA,aAAKS,mBAAL,CAAyB70C,IAAzB,EAA+B20C,UAA/B,EAA2CP,KAA3C;AACH,KArSa;;AAuSd;AACAQ,YAAQ,gBAAUD,UAAV,EAAsBP,KAAtB,EAA6B;;AAEjC,YAAIx2E,OAAO+2E,WAAWP,KAAX,CAAX;AAAA,YACIR,IAAIh2E,KAAK80E,QAAL,CAAcnqH,MADtB;AAAA,YAEIkJ,IAAI,KAAK2gH,WAFb;;AAIA,aAAK0C,gBAAL,CAAsBl3E,IAAtB,EAA4BnsC,CAA5B,EAA+BmiH,CAA/B;;AAEA,YAAImB,aAAa,KAAKC,iBAAL,CAAuBp3E,IAAvB,EAA6BnsC,CAA7B,EAAgCmiH,CAAhC,CAAjB;;AAEA,YAAIp2E,UAAUw1E,WAAWp1E,KAAK80E,QAAL,CAAc9jG,MAAd,CAAqBmmG,UAArB,EAAiCn3E,KAAK80E,QAAL,CAAcnqH,MAAd,GAAuBwsH,UAAxD,CAAX,CAAd;AACAv3E,gBAAQzgB,MAAR,GAAiB6gB,KAAK7gB,MAAtB;AACAygB,gBAAQm1E,IAAR,GAAe/0E,KAAK+0E,IAApB;;AAEAkB,iBAASj2E,IAAT,EAAe,KAAK20E,MAApB;AACAsB,iBAASr2E,OAAT,EAAkB,KAAK+0E,MAAvB;;AAEA,YAAI6B,KAAJ,EAAWO,WAAWP,QAAQ,CAAnB,EAAsB1B,QAAtB,CAA+BpoH,IAA/B,CAAoCkzC,OAApC,EAAX,KACK,KAAKq1E,UAAL,CAAgBj1E,IAAhB,EAAsBJ,OAAtB;AACR,KA3Ta;;AA6Tdq1E,gBAAY,oBAAUj1E,IAAV,EAAgBJ,OAAhB,EAAyB;AACjC;AACA,aAAKh0B,IAAL,GAAYwpG,WAAW,CAACp1E,IAAD,EAAOJ,OAAP,CAAX,CAAZ;AACA,aAAKh0B,IAAL,CAAUuT,MAAV,GAAmB6gB,KAAK7gB,MAAL,GAAc,CAAjC;AACA,aAAKvT,IAAL,CAAUmpG,IAAV,GAAiB,KAAjB;AACAkB,iBAAS,KAAKrqG,IAAd,EAAoB,KAAK+oG,MAAzB;AACH,KAnUa;;AAqUdyC,uBAAmB,2BAAUp3E,IAAV,EAAgBnsC,CAAhB,EAAmBmiH,CAAnB,EAAsB;;AAErC,YAAItrH,CAAJ,EAAO2sH,KAAP,EAAcC,KAAd,EAAqBC,OAArB,EAA8BlwE,IAA9B,EAAoCmwE,UAApC,EAAgDxxD,OAAhD,EAAyDj3D,KAAzD;;AAEAyoH,qBAAaxxD,UAAUltD,QAAvB;;AAEA,aAAKpO,IAAImJ,CAAT,EAAYnJ,KAAKsrH,IAAIniH,CAArB,EAAwBnJ,GAAxB,EAA6B;AACzB2sH,oBAAQI,SAASz3E,IAAT,EAAe,CAAf,EAAkBt1C,CAAlB,EAAqB,KAAKiqH,MAA1B,CAAR;AACA2C,oBAAQG,SAASz3E,IAAT,EAAet1C,CAAf,EAAkBsrH,CAAlB,EAAqB,KAAKrB,MAA1B,CAAR;;AAEA4C,sBAAUG,iBAAiBL,KAAjB,EAAwBC,KAAxB,CAAV;AACAjwE,mBAAOuvE,SAASS,KAAT,IAAkBT,SAASU,KAAT,CAAzB;;AAEA;AACA,gBAAIC,UAAUC,UAAd,EAA0B;AACtBA,6BAAaD,OAAb;AACAxoH,wBAAQrE,CAAR;;AAEAs7D,0BAAU3e,OAAO2e,OAAP,GAAiB3e,IAAjB,GAAwB2e,OAAlC;AAEH,aAND,MAMO,IAAIuxD,YAAYC,UAAhB,EAA4B;AAC/B;AACA,oBAAInwE,OAAO2e,OAAX,EAAoB;AAChBA,8BAAU3e,IAAV;AACAt4C,4BAAQrE,CAAR;AACH;AACJ;AACJ;;AAED,eAAOqE,KAAP;AACH,KAnWa;;AAqWd;AACAmoH,sBAAkB,0BAAUl3E,IAAV,EAAgBnsC,CAAhB,EAAmBmiH,CAAnB,EAAsB;;AAEpC,YAAIN,cAAc11E,KAAK+0E,IAAL,GAAY,KAAKW,WAAjB,GAA+BC,eAAjD;AAAA,YACIC,cAAc51E,KAAK+0E,IAAL,GAAY,KAAKa,WAAjB,GAA+BC,eADjD;AAAA,YAEI8B,UAAU,KAAKC,cAAL,CAAoB53E,IAApB,EAA0BnsC,CAA1B,EAA6BmiH,CAA7B,EAAgCN,WAAhC,CAFd;AAAA,YAGImC,UAAU,KAAKD,cAAL,CAAoB53E,IAApB,EAA0BnsC,CAA1B,EAA6BmiH,CAA7B,EAAgCJ,WAAhC,CAHd;;AAKA;AACA;AACA,YAAI+B,UAAUE,OAAd,EAAuB73E,KAAK80E,QAAL,CAAcx8G,IAAd,CAAmBo9G,WAAnB;AAC1B,KAhXa;;AAkXd;AACAkC,oBAAgB,wBAAU53E,IAAV,EAAgBnsC,CAAhB,EAAmBmiH,CAAnB,EAAsB3kH,OAAtB,EAA+B;;AAE3C2uC,aAAK80E,QAAL,CAAcx8G,IAAd,CAAmBjH,OAAnB;;AAEA,YAAIsjH,SAAS,KAAKA,MAAlB;AAAA,YACImD,WAAWL,SAASz3E,IAAT,EAAe,CAAf,EAAkBnsC,CAAlB,EAAqB8gH,MAArB,CADf;AAAA,YAEIoD,YAAYN,SAASz3E,IAAT,EAAeg2E,IAAIniH,CAAnB,EAAsBmiH,CAAtB,EAAyBrB,MAAzB,CAFhB;AAAA,YAGIn9B,SAASwgC,WAAWF,QAAX,IAAuBE,WAAWD,SAAX,CAHpC;AAAA,YAIIrtH,CAJJ;AAAA,YAIOiF,KAJP;;AAMA,aAAKjF,IAAImJ,CAAT,EAAYnJ,IAAIsrH,IAAIniH,CAApB,EAAuBnJ,GAAvB,EAA4B;AACxBiF,oBAAQqwC,KAAK80E,QAAL,CAAcpqH,CAAd,CAAR;AACAimB,mBAAOmnG,QAAP,EAAiB93E,KAAK+0E,IAAL,GAAYJ,OAAOhlH,KAAP,CAAZ,GAA4BA,KAA7C;AACA6nF,sBAAUwgC,WAAWF,QAAX,CAAV;AACH;;AAED,aAAKptH,IAAIsrH,IAAIniH,CAAJ,GAAQ,CAAjB,EAAoBnJ,KAAKmJ,CAAzB,EAA4BnJ,GAA5B,EAAiC;AAC7BiF,oBAAQqwC,KAAK80E,QAAL,CAAcpqH,CAAd,CAAR;AACAimB,mBAAOonG,SAAP,EAAkB/3E,KAAK+0E,IAAL,GAAYJ,OAAOhlH,KAAP,CAAZ,GAA4BA,KAA9C;AACA6nF,sBAAUwgC,WAAWD,SAAX,CAAV;AACH;;AAED,eAAOvgC,MAAP;AACH,KA1Ya;;AA4Ydy/B,yBAAqB,6BAAU70C,IAAV,EAAgBt1E,IAAhB,EAAsB0pH,KAAtB,EAA6B;AAC9C;AACA,aAAK,IAAI9rH,IAAI8rH,KAAb,EAAoB9rH,KAAK,CAAzB,EAA4BA,GAA5B,EAAiC;AAC7BimB,mBAAO7jB,KAAKpC,CAAL,CAAP,EAAgB03E,IAAhB;AACH;AACJ,KAjZa;;AAmZdqzC,eAAW,mBAAU3oH,IAAV,EAAgB;AACvB;AACA,aAAK,IAAIpC,IAAIoC,KAAKnC,MAAL,GAAc,CAAtB,EAAyBstH,QAA9B,EAAwCvtH,KAAK,CAA7C,EAAgDA,GAAhD,EAAqD;AACjD,gBAAIoC,KAAKpC,CAAL,EAAQoqH,QAAR,CAAiBnqH,MAAjB,KAA4B,CAAhC,EAAmC;AAC/B,oBAAID,IAAI,CAAR,EAAW;AACPutH,+BAAWnrH,KAAKpC,IAAI,CAAT,EAAYoqH,QAAvB;AACAmD,6BAASjnG,MAAT,CAAgBinG,SAASliH,OAAT,CAAiBjJ,KAAKpC,CAAL,CAAjB,CAAhB,EAA2C,CAA3C;AAEH,iBAJD,MAIO,KAAK+lB,KAAL;AAEV,aAPD,MAOOwlG,SAASnpH,KAAKpC,CAAL,CAAT,EAAkB,KAAKiqH,MAAvB;AACV;AACJ,KA/Za;;AAiadF,iBAAa,qBAAU1rH,MAAV,EAAkB;AAC3B;;AAEA;AACA;AACA;;AAEA,YAAImvH,aAAa,CAAC,UAAD,EAAa,MAAb,EAAqB,GAArB,CAAjB;;AAEA,aAAKxC,WAAL,GAAmB,IAAIyC,QAAJ,CAAa,GAAb,EAAkB,GAAlB,EAAuBD,WAAW7qH,IAAX,CAAgBtE,OAAO,CAAP,CAAhB,CAAvB,CAAnB;AACA,aAAK6sH,WAAL,GAAmB,IAAIuC,QAAJ,CAAa,GAAb,EAAkB,GAAlB,EAAuBD,WAAW7qH,IAAX,CAAgBtE,OAAO,CAAP,CAAhB,CAAvB,CAAnB;;AAEA,aAAK4rH,MAAL,GAAc,IAAIwD,QAAJ,CAAa,GAAb,EACV,oBAAoBpvH,OAAO,CAAP,CAApB,GACA,WADA,GACcA,OAAO,CAAP,CADd,GAEA,WAFA,GAEcA,OAAO,CAAP,CAFd,GAGA,WAHA,GAGcA,OAAO,CAAP,CAHd,GAG0B,IAJhB,CAAd;AAKH;AAlba,CAAlB;;AAqbA,SAASysH,QAAT,CAAkBn4G,IAAlB,EAAwBuoG,KAAxB,EAA+ByP,QAA/B,EAAyC;AACrC,QAAI,CAACA,QAAL,EAAe,OAAOzP,MAAM7vG,OAAN,CAAcsH,IAAd,CAAP;;AAEf,SAAK,IAAI3S,IAAI,CAAb,EAAgBA,IAAIk7G,MAAMj7G,MAA1B,EAAkCD,GAAlC,EAAuC;AACnC,YAAI2qH,SAASh4G,IAAT,EAAeuoG,MAAMl7G,CAAN,CAAf,CAAJ,EAA8B,OAAOA,CAAP;AACjC;AACD,WAAO,CAAC,CAAR;AACH;;AAED;AACA,SAASurH,QAAT,CAAkBj2E,IAAlB,EAAwB20E,MAAxB,EAAgC;AAC5B8C,aAASz3E,IAAT,EAAe,CAAf,EAAkBA,KAAK80E,QAAL,CAAcnqH,MAAhC,EAAwCgqH,MAAxC,EAAgD30E,IAAhD;AACH;;AAED;AACA,SAASy3E,QAAT,CAAkBz3E,IAAlB,EAAwB91C,CAAxB,EAA2Bo7E,CAA3B,EAA8BqvC,MAA9B,EAAsCyD,QAAtC,EAAgD;AAC5C,QAAI,CAACA,QAAL,EAAeA,WAAWhD,WAAW,IAAX,CAAX;AACfgD,aAAS3tF,IAAT,GAAgB3xB,QAAhB;AACAs/G,aAASztF,IAAT,GAAgB7xB,QAAhB;AACAs/G,aAAS1tF,IAAT,GAAgB,CAAC5xB,QAAjB;AACAs/G,aAASxtF,IAAT,GAAgB,CAAC9xB,QAAjB;;AAEA,SAAK,IAAIpO,IAAIR,CAAR,EAAWyF,KAAhB,EAAuBjF,IAAI46E,CAA3B,EAA8B56E,GAA9B,EAAmC;AAC/BiF,gBAAQqwC,KAAK80E,QAAL,CAAcpqH,CAAd,CAAR;AACAimB,eAAOynG,QAAP,EAAiBp4E,KAAK+0E,IAAL,GAAYJ,OAAOhlH,KAAP,CAAZ,GAA4BA,KAA7C;AACH;;AAED,WAAOyoH,QAAP;AACH;;AAED,SAASznG,MAAT,CAAgB/d,CAAhB,EAAmBD,CAAnB,EAAsB;AAClBC,MAAE63B,IAAF,GAASh8B,KAAKiH,GAAL,CAAS9C,EAAE63B,IAAX,EAAiB93B,EAAE83B,IAAnB,CAAT;AACA73B,MAAE+3B,IAAF,GAASl8B,KAAKiH,GAAL,CAAS9C,EAAE+3B,IAAX,EAAiBh4B,EAAEg4B,IAAnB,CAAT;AACA/3B,MAAE83B,IAAF,GAASj8B,KAAKkH,GAAL,CAAS/C,EAAE83B,IAAX,EAAiB/3B,EAAE+3B,IAAnB,CAAT;AACA93B,MAAEg4B,IAAF,GAASn8B,KAAKkH,GAAL,CAAS/C,EAAEg4B,IAAX,EAAiBj4B,EAAEi4B,IAAnB,CAAT;AACA,WAAOh4B,CAAP;AACH;;AAED,SAAS+iH,eAAT,CAAyB/iH,CAAzB,EAA4BD,CAA5B,EAA+B;AAAE,WAAOC,EAAE63B,IAAF,GAAS93B,EAAE83B,IAAlB;AAAyB;AAC1D,SAASorF,eAAT,CAAyBjjH,CAAzB,EAA4BD,CAA5B,EAA+B;AAAE,WAAOC,EAAE+3B,IAAF,GAASh4B,EAAEg4B,IAAlB;AAAyB;;AAE1D,SAASisF,QAAT,CAAkBhkH,CAAlB,EAAuB;AAAE,WAAO,CAACA,EAAE83B,IAAF,GAAS93B,EAAE63B,IAAZ,KAAqB73B,EAAEg4B,IAAF,GAASh4B,EAAE+3B,IAAhC,CAAP;AAA+C;AACxE,SAASqtF,UAAT,CAAoBplH,CAApB,EAAuB;AAAE,WAAQA,EAAE83B,IAAF,GAAS93B,EAAE63B,IAAZ,IAAqB73B,EAAEg4B,IAAF,GAASh4B,EAAE+3B,IAAhC,CAAP;AAA+C;;AAExE,SAASksF,YAAT,CAAsBjkH,CAAtB,EAAyBD,CAAzB,EAA4B;AACxB,WAAO,CAAClE,KAAKkH,GAAL,CAAShD,EAAE+3B,IAAX,EAAiB93B,EAAE83B,IAAnB,IAA2Bj8B,KAAKiH,GAAL,CAAS/C,EAAE83B,IAAX,EAAiB73B,EAAE63B,IAAnB,CAA5B,KACCh8B,KAAKkH,GAAL,CAAShD,EAAEi4B,IAAX,EAAiBh4B,EAAEg4B,IAAnB,IAA2Bn8B,KAAKiH,GAAL,CAAS/C,EAAEg4B,IAAX,EAAiB/3B,EAAE+3B,IAAnB,CAD5B,CAAP;AAEH;;AAED,SAAS+sF,gBAAT,CAA0B9kH,CAA1B,EAA6BD,CAA7B,EAAgC;AAC5B,QAAI83B,OAAOh8B,KAAKkH,GAAL,CAAS/C,EAAE63B,IAAX,EAAiB93B,EAAE83B,IAAnB,CAAX;AAAA,QACIE,OAAOl8B,KAAKkH,GAAL,CAAS/C,EAAE+3B,IAAX,EAAiBh4B,EAAEg4B,IAAnB,CADX;AAAA,QAEID,OAAOj8B,KAAKiH,GAAL,CAAS9C,EAAE83B,IAAX,EAAiB/3B,EAAE+3B,IAAnB,CAFX;AAAA,QAGIE,OAAOn8B,KAAKiH,GAAL,CAAS9C,EAAEg4B,IAAX,EAAiBj4B,EAAEi4B,IAAnB,CAHX;;AAKA,WAAOn8B,KAAKkH,GAAL,CAAS,CAAT,EAAY+0B,OAAOD,IAAnB,IACAh8B,KAAKkH,GAAL,CAAS,CAAT,EAAYi1B,OAAOD,IAAnB,CADP;AAEH;;AAED,SAASG,QAAT,CAAkBl4B,CAAlB,EAAqBD,CAArB,EAAwB;AACpB,WAAOC,EAAE63B,IAAF,IAAU93B,EAAE83B,IAAZ,IACA73B,EAAE+3B,IAAF,IAAUh4B,EAAEg4B,IADZ,IAEAh4B,EAAE+3B,IAAF,IAAU93B,EAAE83B,IAFZ,IAGA/3B,EAAEi4B,IAAF,IAAUh4B,EAAEg4B,IAHnB;AAIH;;AAED,SAASS,UAAT,CAAoBz4B,CAApB,EAAuBD,CAAvB,EAA0B;AACtB,WAAOA,EAAE83B,IAAF,IAAU73B,EAAE83B,IAAZ,IACA/3B,EAAEg4B,IAAF,IAAU/3B,EAAEg4B,IADZ,IAEAj4B,EAAE+3B,IAAF,IAAU93B,EAAE63B,IAFZ,IAGA93B,EAAEi4B,IAAF,IAAUh4B,EAAE+3B,IAHnB;AAIH;;AAED,SAASyqF,UAAT,CAAoBN,QAApB,EAA8B;AAC1B,WAAO;AACHA,kBAAUA,QADP;AAEH31F,gBAAQ,CAFL;AAGH41F,cAAM,IAHH;AAIHtqF,cAAM3xB,QAJH;AAKH6xB,cAAM7xB,QALH;AAMH4xB,cAAM,CAAC5xB,QANJ;AAOH8xB,cAAM,CAAC9xB;AAPJ,KAAP;AASH;;AAED;AACA;;AAEA,SAASw9G,WAAT,CAAqB1lG,GAArB,EAA0BiT,IAA1B,EAAgCypB,KAAhC,EAAuCt4C,CAAvC,EAA0C3D,OAA1C,EAAmD;AAC/C,QAAI+V,QAAQ,CAACyc,IAAD,EAAOypB,KAAP,CAAZ;AAAA,QACI/X,GADJ;;AAGA,WAAOnuB,MAAMzc,MAAb,EAAqB;AACjB2iD,gBAAQlmC,MAAM2F,GAAN,EAAR;AACA8W,eAAOzc,MAAM2F,GAAN,EAAP;;AAEA,YAAIugC,QAAQzpB,IAAR,IAAgB7uB,CAApB,EAAuB;;AAEvBugC,cAAM1R,OAAOp1B,KAAKqH,IAAL,CAAU,CAACw3C,QAAQzpB,IAAT,IAAiB7uB,CAAjB,GAAqB,CAA/B,IAAoCA,CAAjD;AACA++G,oBAAYnjG,GAAZ,EAAiB2kB,GAAjB,EAAsB1R,IAAtB,EAA4BypB,KAA5B,EAAmCj8C,OAAnC;;AAEA+V,cAAM1a,IAAN,CAAWm3B,IAAX,EAAiB0R,GAAjB,EAAsBA,GAAtB,EAA2B+X,KAA3B;AACH;AACJ,C;;;;;;;;;;;ACjjBD;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,iBAAiB,mBAAmB;AACpC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA,mBAAmB,2BAA2B;;AAE9C;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,mBAAmB;AACnC;AACA;;AAEA;AACA;;AAEA,iBAAiB,2BAA2B;AAC5C;AACA;;AAEA,QAAQ,uBAAuB;AAC/B;AACA;AACA,GAAG;AACH;;AAEA,iBAAiB,uBAAuB;AACxC;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,cAAc;;AAEd,kDAAkD,sBAAsB;AACxE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD;;AAEA,6BAA6B,mBAAmB;;AAEhD;;AAEA;;AAEA;AACA;;;;;;;;;;;;;;;ACtXA;;;;;;;;;;;;;AAaAtpC,OAAOC,OAAP,GAAiB,UAAUo0G,GAAV,EAAe;AAC9B;AACA,KAAIC,WAAW,OAAO53D,MAAP,KAAkB,WAAlB,IAAiCA,OAAO43D,QAAvD;;AAEA,KAAI,CAACA,QAAL,EAAe;AACb,QAAM,IAAI78G,KAAJ,CAAU,kCAAV,CAAN;AACD;;AAEF;AACA,KAAI,CAAC48G,GAAD,IAAQ,OAAOA,GAAP,KAAe,QAA3B,EAAqC;AACnC,SAAOA,GAAP;AACA;;AAED,KAAIE,UAAUD,SAASE,QAAT,GAAoB,IAApB,GAA2BF,SAASG,IAAlD;AACA,KAAIC,aAAaH,UAAUD,SAASK,QAAT,CAAkBlsG,OAAlB,CAA0B,WAA1B,EAAuC,GAAvC,CAA3B;;AAED;AACA;;;;;;;;;;;;;;;;;;;;;;;AAyBA,KAAI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","file":"stylefunction.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./example/stylefunction.js\");\n","import 'ol/ol.css';\nimport VectorLayer from 'ol/layer/Vector';\nimport VectorSource from 'ol/source/Vector';\nimport GeoJsonFormat from 'ol/format/GeoJSON';\nimport Map from 'ol/Map';\nimport View from 'ol/View';\n\nimport stylefunction from 'ol-mapbox-style/stylefunction';\n\nconst layer = new VectorLayer({\n  declutter: true,\n  source: new VectorSource({\n    format: new GeoJsonFormat(),\n    url: 'data/states.geojson'\n  })\n});\n\nconst map = new Map({\n  target: 'map',\n  view: new View({\n    center: [-13603186.115192635, 6785744.563386],\n    zoom: 2\n  })\n});\n\nfetch('data/states.json')\n  .then(r => r.json())\n  .then((glStyle) => {\n    stylefunction(layer, glStyle, 'states');\n    map.addLayer(layer);\n  });\n","\nimport refProperties from './util/ref_properties';\n\nfunction deref(layer, parent) {\n    const result = {};\n\n    for (const k in layer) {\n        if (k !== 'ref') {\n            result[k] = layer[k];\n        }\n    }\n\n    refProperties.forEach((k) => {\n        if (k in parent) {\n            result[k] = parent[k];\n        }\n    });\n\n    return result;\n}\n\nexport default derefLayers;\n\n/**\n * Given an array of layers, some of which may contain `ref` properties\n * whose value is the `id` of another property, return a new array where\n * such layers have been augmented with the 'type', 'source', etc. properties\n * from the parent layer, and the `ref` property has been removed.\n *\n * The input is not modified. The output may contain references to portions\n * of the input.\n *\n * @private\n * @param {Array<Layer>} layers\n * @returns {Array<Layer>}\n */\nfunction derefLayers(layers) {\n    layers = layers.slice();\n\n    const map = Object.create(null);\n    for (let i = 0; i < layers.length; i++) {\n        map[layers[i].id] = layers[i];\n    }\n\n    for (let i = 0; i < layers.length; i++) {\n        if ('ref' in layers[i]) {\n            layers[i] = deref(layers[i], map[layers[i].ref]);\n        }\n    }\n\n    return layers;\n}\n","// @flow\n\nimport { toString } from './types';\n\nimport ParsingContext from './parsing_context';\nimport EvaluationContext from './evaluation_context';\nimport assert from 'assert';\n\nimport type { Expression, ExpressionRegistry } from './expression';\nimport type { Type } from './types';\nimport type { Value } from './values';\n\nexport type Varargs = {| type: Type |};\ntype Signature = Array<Type> | Varargs;\ntype Evaluate = (EvaluationContext, Array<Expression>) => Value;\ntype Definition = [Type, Signature, Evaluate] |\n    {|type: Type, overloads: Array<[Signature, Evaluate]>|};\n\nclass CompoundExpression implements Expression {\n    name: string;\n    type: Type;\n    _evaluate: Evaluate;\n    args: Array<Expression>;\n\n    static definitions: { [string]: Definition };\n\n    constructor(name: string, type: Type, evaluate: Evaluate, args: Array<Expression>) {\n        this.name = name;\n        this.type = type;\n        this._evaluate = evaluate;\n        this.args = args;\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        return this._evaluate(ctx, this.args);\n    }\n\n    eachChild(fn: (Expression) => void) {\n        this.args.forEach(fn);\n    }\n\n    possibleOutputs() {\n        return [undefined];\n    }\n\n    serialize() {\n        return [this.name].concat(this.args.map(arg => arg.serialize()));\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext): ?Expression {\n        const op: string = (args[0]: any);\n        const definition = CompoundExpression.definitions[op];\n        if (!definition) {\n            return context.error(`Unknown expression \"${op}\". If you wanted a literal array, use [\"literal\", [...]].`, 0);\n        }\n\n        // Now check argument types against each signature\n        const type = Array.isArray(definition) ?\n            definition[0] : definition.type;\n\n        const availableOverloads = Array.isArray(definition) ?\n            [[definition[1], definition[2]]] :\n            definition.overloads;\n\n        const overloads = availableOverloads.filter(([signature]) => (\n            !Array.isArray(signature) || // varags\n            signature.length === args.length - 1 // correct param count\n        ));\n\n        // First parse all the args\n        const parsedArgs: Array<Expression> = [];\n        for (let i = 1; i < args.length; i++) {\n            const arg = args[i];\n            let expected;\n            if (overloads.length === 1) {\n                const params = overloads[0][0];\n                expected = Array.isArray(params) ?\n                    params[i - 1] :\n                    params.type;\n            }\n            const parsed = context.parse(arg, 1 + parsedArgs.length, expected);\n            if (!parsed) return null;\n            parsedArgs.push(parsed);\n        }\n\n        let signatureContext: ParsingContext = (null: any);\n\n        for (const [params, evaluate] of overloads) {\n            // Use a fresh context for each attempted signature so that, if\n            // we eventually succeed, we haven't polluted `context.errors`.\n            signatureContext = new ParsingContext(context.registry, context.path, null, context.scope);\n\n            if (Array.isArray(params)) {\n                if (params.length !== parsedArgs.length) {\n                    signatureContext.error(`Expected ${params.length} arguments, but found ${parsedArgs.length} instead.`);\n                    continue;\n                }\n            }\n\n            for (let i = 0; i < parsedArgs.length; i++) {\n                const expected = Array.isArray(params) ? params[i] : params.type;\n                const arg = parsedArgs[i];\n                signatureContext.concat(i + 1).checkSubtype(expected, arg.type);\n            }\n\n            if (signatureContext.errors.length === 0) {\n                return new CompoundExpression(op, type, evaluate, parsedArgs);\n            }\n        }\n\n        assert(!signatureContext || signatureContext.errors.length > 0);\n\n        if (overloads.length === 1) {\n            context.errors.push.apply(context.errors, signatureContext.errors);\n        } else {\n            const expected = overloads.length ? overloads : availableOverloads;\n            const signatures = expected\n                .map(([params]) => stringifySignature(params))\n                .join(' | ');\n            const actualTypes = parsedArgs\n                .map(arg => toString(arg.type))\n                .join(', ');\n            context.error(`Expected arguments of type ${signatures}, but found (${actualTypes}) instead.`);\n        }\n\n        return null;\n    }\n\n    static register(\n        registry: ExpressionRegistry,\n        definitions: { [string]: Definition }\n    ) {\n        assert(!CompoundExpression.definitions);\n        CompoundExpression.definitions = definitions;\n        for (const name in definitions) {\n            registry[name] = CompoundExpression;\n        }\n    }\n}\n\nfunction stringifySignature(signature: Signature): string {\n    if (Array.isArray(signature)) {\n        return `(${signature.map(toString).join(', ')})`;\n    } else {\n        return `(${toString(signature.type)}...)`;\n    }\n}\n\nexport default CompoundExpression;\n","// @flow\n\nimport { toString, array, ValueType, StringType, NumberType, BooleanType, checkSubtype } from '../types';\n\nimport { typeOf } from '../values';\nimport RuntimeError from '../runtime_error';\n\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { ArrayType } from '../types';\n\nconst types = {\n    string: StringType,\n    number: NumberType,\n    boolean: BooleanType\n};\n\nclass ArrayAssertion implements Expression {\n    type: ArrayType;\n    input: Expression;\n\n    constructor(type: ArrayType, input: Expression) {\n        this.type = type;\n        this.input = input;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext): ?Expression {\n        if (args.length < 2 || args.length > 4)\n            return context.error(`Expected 1, 2, or 3 arguments, but found ${args.length - 1} instead.`);\n\n        let itemType;\n        let N;\n        if (args.length > 2) {\n            const type = args[1];\n            if (typeof type !== 'string' || !(type in types))\n                return context.error('The item type argument of \"array\" must be one of string, number, boolean', 1);\n            itemType = types[type];\n        } else {\n            itemType = ValueType;\n        }\n\n        if (args.length > 3) {\n            if (\n                typeof args[2] !== 'number' ||\n                args[2] < 0 ||\n                args[2] !== Math.floor(args[2])\n            ) {\n                return context.error('The length argument to \"array\" must be a positive integer literal', 2);\n            }\n            N = args[2];\n        }\n\n        const type = array(itemType, N);\n\n        const input = context.parse(args[args.length - 1], args.length - 1, ValueType);\n        if (!input) return null;\n\n        return new ArrayAssertion(type, input);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        const value = this.input.evaluate(ctx);\n        const error = checkSubtype(this.type, typeOf(value));\n        if (error) {\n            throw new RuntimeError(`Expected value to be of type ${toString(this.type)}, but found ${toString(typeOf(value))} instead.`);\n        }\n        return value;\n    }\n\n    eachChild(fn: (Expression) => void) {\n        fn(this.input);\n    }\n\n    possibleOutputs() {\n        return this.input.possibleOutputs();\n    }\n\n    serialize() {\n        const serialized = [\"array\"];\n        const itemType = this.type.itemType;\n        if (itemType.kind === 'string' ||\n            itemType.kind === 'number' ||\n            itemType.kind === 'boolean') {\n            serialized.push(itemType.kind);\n            const N = this.type.N;\n            if (typeof N === 'number') {\n                serialized.push(N);\n            }\n        }\n        serialized.push(this.input.serialize());\n        return serialized;\n    }\n}\n\nexport default ArrayAssertion;\n","// @flow\n\nimport assert from 'assert';\n\nimport {\n    ObjectType,\n    ValueType,\n    StringType,\n    NumberType,\n    BooleanType,\n    checkSubtype,\n    toString\n} from '../types';\nimport RuntimeError from '../runtime_error';\nimport { typeOf } from '../values';\n\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { Type } from '../types';\n\nconst types = {\n    string: StringType,\n    number: NumberType,\n    boolean: BooleanType,\n    object: ObjectType\n};\n\nclass Assertion implements Expression {\n    type: Type;\n    args: Array<Expression>;\n\n    constructor(type: Type, args: Array<Expression>) {\n        this.type = type;\n        this.args = args;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext): ?Expression {\n        if (args.length < 2)\n            return context.error(`Expected at least one argument.`);\n\n        const name: string = (args[0]: any);\n        assert(types[name], name);\n\n        const type = types[name];\n\n        const parsed = [];\n        for (let i = 1; i < args.length; i++) {\n            const input = context.parse(args[i], i, ValueType);\n            if (!input) return null;\n            parsed.push(input);\n        }\n\n        return new Assertion(type, parsed);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        for (let i = 0; i < this.args.length; i++) {\n            const value = this.args[i].evaluate(ctx);\n            const error = checkSubtype(this.type, typeOf(value));\n            if (!error) {\n                return value;\n            } else if (i === this.args.length - 1) {\n                throw new RuntimeError(`Expected value to be of type ${toString(this.type)}, but found ${toString(typeOf(value))} instead.`);\n            }\n        }\n\n        assert(false);\n        return null;\n    }\n\n    eachChild(fn: (Expression) => void) {\n        this.args.forEach(fn);\n    }\n\n    possibleOutputs() {\n        return [].concat(...this.args.map((arg) => arg.possibleOutputs()));\n    }\n\n    serialize() {\n        return [this.type.kind].concat(this.args.map(arg => arg.serialize()));\n    }\n}\n\nexport default Assertion;\n","// @flow\n\nimport { array, ValueType, NumberType } from '../types';\n\nimport RuntimeError from '../runtime_error';\n\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { Type, ArrayType } from '../types';\nimport type { Value } from '../values';\n\nclass At implements Expression {\n    type: Type;\n    index: Expression;\n    input: Expression;\n\n    constructor(type: Type, index: Expression, input: Expression) {\n        this.type = type;\n        this.index = index;\n        this.input = input;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        if (args.length !== 3)\n            return context.error(`Expected 2 arguments, but found ${args.length - 1} instead.`);\n\n        const index = context.parse(args[1], 1, NumberType);\n        const input = context.parse(args[2], 2, array(context.expectedType || ValueType));\n\n        if (!index || !input) return null;\n\n        const t: ArrayType = (input.type: any);\n        return new At(t.itemType, index, input);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        const index = ((this.index.evaluate(ctx): any): number);\n        const array = ((this.input.evaluate(ctx): any): Array<Value>);\n\n        if (index < 0) {\n            throw new RuntimeError(`Array index out of bounds: ${index} < 0.`);\n        }\n\n        if (index >= array.length) {\n            throw new RuntimeError(`Array index out of bounds: ${index} > ${array.length - 1}.`);\n        }\n\n        if (index !== Math.floor(index)) {\n            throw new RuntimeError(`Array index must be an integer, but found ${index} instead.`);\n        }\n\n        return array[index];\n    }\n\n    eachChild(fn: (Expression) => void) {\n        fn(this.index);\n        fn(this.input);\n    }\n\n    possibleOutputs() {\n        return [undefined];\n    }\n\n    serialize() {\n        return [\"at\", this.index.serialize(), this.input.serialize()];\n    }\n}\n\nexport default At;\n","// @flow\n\nimport assert from 'assert';\n\nimport { BooleanType } from '../types';\n\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { Type } from '../types';\n\ntype Branches = Array<[Expression, Expression]>;\n\nclass Case implements Expression {\n    type: Type;\n\n    branches: Branches;\n    otherwise: Expression;\n\n    constructor(type: Type, branches: Branches, otherwise: Expression) {\n        this.type = type;\n        this.branches = branches;\n        this.otherwise = otherwise;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        if (args.length < 4)\n            return context.error(`Expected at least 3 arguments, but found only ${args.length - 1}.`);\n        if (args.length % 2 !== 0)\n            return context.error(`Expected an odd number of arguments.`);\n\n        let outputType: ?Type;\n        if (context.expectedType && context.expectedType.kind !== 'value') {\n            outputType = context.expectedType;\n        }\n\n        const branches = [];\n        for (let i = 1; i < args.length - 1; i += 2) {\n            const test = context.parse(args[i], i, BooleanType);\n            if (!test) return null;\n\n            const result = context.parse(args[i + 1], i + 1, outputType);\n            if (!result) return null;\n\n            branches.push([test, result]);\n\n            outputType = outputType || result.type;\n        }\n\n        const otherwise = context.parse(args[args.length - 1], args.length - 1, outputType);\n        if (!otherwise) return null;\n\n        assert(outputType);\n        return new Case((outputType: any), branches, otherwise);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        for (const [test, expression] of this.branches) {\n            if (test.evaluate(ctx)) {\n                return expression.evaluate(ctx);\n            }\n        }\n        return this.otherwise.evaluate(ctx);\n    }\n\n    eachChild(fn: (Expression) => void) {\n        for (const [test, expression] of this.branches) {\n            fn(test);\n            fn(expression);\n        }\n        fn(this.otherwise);\n    }\n\n    possibleOutputs() {\n        return []\n            .concat(...this.branches.map(([_, out]) => out.possibleOutputs()))\n            .concat(this.otherwise.possibleOutputs());\n    }\n\n    serialize() {\n        const serialized = [\"case\"];\n        this.eachChild(child => { serialized.push(child.serialize()); });\n        return serialized;\n    }\n}\n\nexport default Case;\n","// @flow\n\nimport assert from 'assert';\n\nimport { checkSubtype, ValueType } from '../types';\n\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { Type } from '../types';\n\nclass Coalesce implements Expression {\n    type: Type;\n    args: Array<Expression>;\n\n    constructor(type: Type, args: Array<Expression>) {\n        this.type = type;\n        this.args = args;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        if (args.length < 2) {\n            return context.error(\"Expectected at least one argument.\");\n        }\n        let outputType: Type = (null: any);\n        const expectedType = context.expectedType;\n        if (expectedType && expectedType.kind !== 'value') {\n            outputType = expectedType;\n        }\n        const parsedArgs = [];\n\n        for (const arg of args.slice(1)) {\n            const parsed = context.parse(arg, 1 + parsedArgs.length, outputType, undefined, {omitTypeAnnotations: true});\n            if (!parsed) return null;\n            outputType = outputType || parsed.type;\n            parsedArgs.push(parsed);\n        }\n        assert(outputType);\n\n        // Above, we parse arguments without inferred type annotation so that\n        // they don't produce a runtime error for `null` input, which would\n        // preempt the desired null-coalescing behavior.\n        // Thus, if any of our arguments would have needed an annotation, we\n        // need to wrap the enclosing coalesce expression with it instead.\n        const needsAnnotation = expectedType &&\n            parsedArgs.some(arg => checkSubtype(expectedType, arg.type));\n\n        return needsAnnotation ?\n            new Coalesce(ValueType, parsedArgs) :\n            new Coalesce((outputType: any), parsedArgs);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        let result = null;\n        for (const arg of this.args) {\n            result = arg.evaluate(ctx);\n            if (result !== null) break;\n        }\n        return result;\n    }\n\n    eachChild(fn: (Expression) => void) {\n        this.args.forEach(fn);\n    }\n\n    possibleOutputs() {\n        return [].concat(...this.args.map((arg) => arg.possibleOutputs()));\n    }\n\n    serialize() {\n        const serialized = [\"coalesce\"];\n        this.eachChild(child => { serialized.push(child.serialize()); });\n        return serialized;\n    }\n}\n\nexport default Coalesce;\n","// @flow\n\nimport assert from 'assert';\n\nimport { ColorType, ValueType, NumberType } from '../types';\nimport { Color, validateRGBA } from '../values';\nimport RuntimeError from '../runtime_error';\n\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { Type } from '../types';\n\nconst types = {\n    'to-number': NumberType,\n    'to-color': ColorType\n};\n\n/**\n * Special form for error-coalescing coercion expressions \"to-number\",\n * \"to-color\".  Since these coercions can fail at runtime, they accept multiple\n * arguments, only evaluating one at a time until one succeeds.\n *\n * @private\n */\nclass Coercion implements Expression {\n    type: Type;\n    args: Array<Expression>;\n\n    constructor(type: Type, args: Array<Expression>) {\n        this.type = type;\n        this.args = args;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext): ?Expression {\n        if (args.length < 2)\n            return context.error(`Expected at least one argument.`);\n\n        const name: string = (args[0]: any);\n        assert(types[name], name);\n\n        const type = types[name];\n\n        const parsed = [];\n        for (let i = 1; i < args.length; i++) {\n            const input = context.parse(args[i], i, ValueType);\n            if (!input) return null;\n            parsed.push(input);\n        }\n\n        return new Coercion(type, parsed);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        if (this.type.kind === 'color') {\n            let input;\n            let error;\n            for (const arg of this.args) {\n                input = arg.evaluate(ctx);\n                error = null;\n                if (typeof input === 'string') {\n                    const c = ctx.parseColor(input);\n                    if (c) return c;\n                } else if (Array.isArray(input)) {\n                    if (input.length < 3 || input.length > 4) {\n                        error = `Invalid rbga value ${JSON.stringify(input)}: expected an array containing either three or four numeric values.`;\n                    } else {\n                        error = validateRGBA(input[0], input[1], input[2], input[3]);\n                    }\n                    if (!error) {\n                        return new Color((input[0]: any) / 255, (input[1]: any) / 255, (input[2]: any) / 255, (input[3]: any));\n                    }\n                }\n            }\n            throw new RuntimeError(error || `Could not parse color from value '${typeof input === 'string' ? input : JSON.stringify(input)}'`);\n        } else {\n            let value = null;\n            for (const arg of this.args) {\n                value = arg.evaluate(ctx);\n                if (value === null) continue;\n                const num = Number(value);\n                if (isNaN(num)) continue;\n                return num;\n            }\n            throw new RuntimeError(`Could not convert ${JSON.stringify(value)} to number.`);\n        }\n    }\n\n    eachChild(fn: (Expression) => void) {\n        this.args.forEach(fn);\n    }\n\n    possibleOutputs() {\n        return [].concat(...this.args.map((arg) => arg.possibleOutputs()));\n    }\n\n    serialize() {\n        const serialized = [`to-${this.type.kind}`];\n        this.eachChild(child => { serialized.push(child.serialize()); });\n        return serialized;\n    }\n}\n\nexport default Coercion;\n","// @flow\n\nimport { StringType, BooleanType, CollatorType } from '../types';\n\nimport type { Expression } from '../expression';\nimport type EvaluationContext from '../evaluation_context';\nimport type ParsingContext from '../parsing_context';\nimport type { Type } from '../types';\n\n// Flow type declarations for Intl cribbed from\n// https://github.com/facebook/flow/issues/1270\n\ndeclare var Intl: {\n  Collator: Class<Intl$Collator>\n}\n\ndeclare class Intl$Collator {\n  constructor (\n    locales?: string | string[],\n    options?: CollatorOptions\n  ): Intl$Collator;\n\n  static (\n    locales?: string | string[],\n    options?: CollatorOptions\n  ): Intl$Collator;\n\n  compare (a: string, b: string): number;\n\n  resolvedOptions(): any;\n}\n\ntype CollatorOptions = {\n  localeMatcher?: 'lookup' | 'best fit',\n  usage?: 'sort' | 'search',\n  sensitivity?: 'base' | 'accent' | 'case' | 'variant',\n  ignorePunctuation?: boolean,\n  numeric?: boolean,\n  caseFirst?: 'upper' | 'lower' | 'false'\n}\n\nexport class Collator {\n    locale: string | null;\n    sensitivity: 'base' | 'accent' | 'case' | 'variant';\n    collator: Intl$Collator;\n\n    constructor(caseSensitive: boolean, diacriticSensitive: boolean, locale: string | null) {\n        if (caseSensitive)\n            this.sensitivity = diacriticSensitive ? 'variant' : 'case';\n        else\n            this.sensitivity = diacriticSensitive ? 'accent' : 'base';\n\n        this.locale = locale;\n        this.collator = new Intl.Collator(this.locale ? this.locale : [],\n            { sensitivity: this.sensitivity, usage: 'search' });\n    }\n\n    compare(lhs: string, rhs: string): number {\n        return this.collator.compare(lhs, rhs);\n    }\n\n    resolvedLocale(): string {\n        // We create a Collator without \"usage: search\" because we don't want\n        // the search options encoded in our result (e.g. \"en-u-co-search\")\n        return new Intl.Collator(this.locale ? this.locale : [])\n            .resolvedOptions().locale;\n    }\n}\n\nexport class CollatorExpression implements Expression {\n    type: Type;\n    caseSensitive: Expression;\n    diacriticSensitive: Expression;\n    locale: Expression | null;\n\n    constructor(caseSensitive: Expression, diacriticSensitive: Expression, locale: Expression | null) {\n        this.type = CollatorType;\n        this.locale = locale;\n        this.caseSensitive = caseSensitive;\n        this.diacriticSensitive = diacriticSensitive;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext): ?Expression {\n        if (args.length !== 2)\n            return context.error(`Expected one argument.`);\n\n        const options = (args[1]: any);\n        if (typeof options !== \"object\" || Array.isArray(options))\n            return context.error(`Collator options argument must be an object.`);\n\n        const caseSensitive = context.parse(\n            options['case-sensitive'] === undefined ? false : options['case-sensitive'], 1, BooleanType);\n        if (!caseSensitive) return null;\n\n        const diacriticSensitive = context.parse(\n            options['diacritic-sensitive'] === undefined ? false : options['diacritic-sensitive'], 1, BooleanType);\n        if (!diacriticSensitive) return null;\n\n        let locale = null;\n        if (options['locale']) {\n            locale = context.parse(options['locale'], 1, StringType);\n            if (!locale) return null;\n        }\n\n        return new CollatorExpression(caseSensitive, diacriticSensitive, locale);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        return new Collator(this.caseSensitive.evaluate(ctx), this.diacriticSensitive.evaluate(ctx), this.locale ? this.locale.evaluate(ctx) : null);\n    }\n\n    eachChild(fn: (Expression) => void) {\n        fn(this.caseSensitive);\n        fn(this.diacriticSensitive);\n        if (this.locale) {\n            fn(this.locale);\n        }\n    }\n\n    possibleOutputs() {\n        // Technically the set of possible outputs is the combinatoric set of Collators produced\n        // by all possibleOutputs of locale/caseSensitive/diacriticSensitive\n        // But for the primary use of Collators in comparison operators, we ignore the Collator's\n        // possibleOutputs anyway, so we can get away with leaving this undefined for now.\n        return [undefined];\n    }\n\n    serialize() {\n        const options = {};\n        options['case-sensitive'] = this.caseSensitive.serialize();\n        options['diacritic-sensitive'] = this.diacriticSensitive.serialize();\n        if (this.locale) {\n            options['locale'] = this.locale.serialize();\n        }\n        return [\"collator\", options];\n    }\n}\n","// @flow\n\nimport { toString, ValueType, BooleanType, CollatorType } from '../types';\n\nimport type { Expression } from '../expression';\nimport type EvaluationContext from '../evaluation_context';\nimport type ParsingContext from '../parsing_context';\nimport type { Type } from '../types';\n\nfunction isComparableType(type: Type) {\n    return type.kind === 'string' ||\n        type.kind === 'number' ||\n        type.kind === 'boolean' ||\n        type.kind === 'null';\n}\n\n/**\n * Special form for ==, !=, implementing the following signatures:\n * - (T1: Comparable, T2: Comparable) => boolean { T1 == T2 }\n * - (Comparable, value) => boolean\n * - (value, Comparable) => boolean\n *\n * Where Comparable = string | number | boolean | null.\n *\n * Evaluation semantics for the value cases are equivalent to Javascript's\n * strict equality (===/!==) -- i.e., when the value argument's type doesn't\n * match that of the Comparable argument, == evaluates to false, != to true.\n *\n * @private\n */\nfunction makeComparison(op: string, negate: boolean) {\n    return class Comparison implements Expression {\n        type: Type;\n        lhs: Expression;\n        rhs: Expression;\n        collator: Expression | null;\n\n        constructor(lhs: Expression, rhs: Expression, collator: Expression | null) {\n            this.type = BooleanType;\n            this.lhs = lhs;\n            this.rhs = rhs;\n            this.collator = collator;\n        }\n\n        static parse(args: Array<mixed>, context: ParsingContext): ?Expression {\n            if (args.length !== 3 && args.length !== 4)\n                return context.error(`Expected two or three arguments.`);\n\n            const lhs = context.parse(args[1], 1, ValueType);\n            if (!lhs) return null;\n            const rhs = context.parse(args[2], 2, ValueType);\n            if (!rhs) return null;\n\n            if (!isComparableType(lhs.type) && !isComparableType(rhs.type)) {\n                return context.error(`Expected at least one argument to be a string, number, boolean, or null, but found (${toString(lhs.type)}, ${toString(rhs.type)}) instead.`);\n            }\n\n            if (lhs.type.kind !== rhs.type.kind && lhs.type.kind !== 'value' && rhs.type.kind !== 'value') {\n                return context.error(`Cannot compare ${toString(lhs.type)} and ${toString(rhs.type)}.`);\n            }\n\n            let collator = null;\n            if (args.length === 4) {\n                if (lhs.type.kind !== 'string' && rhs.type.kind !== 'string') {\n                    return context.error(`Cannot use collator to compare non-string types.`);\n                }\n                collator = context.parse(args[3], 3, CollatorType);\n                if (!collator) return null;\n            }\n\n            return new Comparison(lhs, rhs, collator);\n        }\n\n        evaluate(ctx: EvaluationContext) {\n            const equal = this.collator ?\n                this.collator.evaluate(ctx).compare(this.lhs.evaluate(ctx), this.rhs.evaluate(ctx)) === 0 :\n                this.lhs.evaluate(ctx) === this.rhs.evaluate(ctx);\n\n            return negate ? !equal : equal;\n        }\n\n        eachChild(fn: (Expression) => void) {\n            fn(this.lhs);\n            fn(this.rhs);\n            if (this.collator) {\n                fn(this.collator);\n            }\n        }\n\n        possibleOutputs() {\n            return [true, false];\n        }\n\n        serialize() {\n            const serialized = [op];\n            this.eachChild(child => { serialized.push(child.serialize()); });\n            return serialized;\n        }\n    };\n}\n\nexport const Equals = makeComparison('==', false);\nexport const NotEquals = makeComparison('!=', true);\n","// @flow\n\nimport { NumberType, StringType, BooleanType, ColorType, ObjectType, ValueType, ErrorType, CollatorType, array, toString } from '../types';\n\nimport { typeOf, Color, validateRGBA } from '../values';\nimport CompoundExpression from '../compound_expression';\nimport RuntimeError from '../runtime_error';\nimport Let from './let';\nimport Var from './var';\nimport Literal from './literal';\nimport Assertion from './assertion';\nimport ArrayAssertion from './array';\nimport Coercion from './coercion';\nimport At from './at';\nimport Match from './match';\nimport Case from './case';\nimport Step from './step';\nimport Interpolate from './interpolate';\nimport Coalesce from './coalesce';\nimport { Equals, NotEquals } from './equals';\nimport { CollatorExpression } from './collator';\nimport Length from './length';\n\nimport type { Type } from '../types';\nimport type { Varargs } from '../compound_expression';\nimport type { ExpressionRegistry } from '../expression';\n\nconst expressions: ExpressionRegistry = {\n    // special forms\n    '==': Equals,\n    '!=': NotEquals,\n    'array': ArrayAssertion,\n    'at': At,\n    'boolean': Assertion,\n    'case': Case,\n    'coalesce': Coalesce,\n    'collator': CollatorExpression,\n    'interpolate': Interpolate,\n    'length': Length,\n    'let': Let,\n    'literal': Literal,\n    'match': Match,\n    'number': Assertion,\n    'object': Assertion,\n    'step': Step,\n    'string': Assertion,\n    'to-color': Coercion,\n    'to-number': Coercion,\n    'var': Var\n};\n\nfunction rgba(ctx, [r, g, b, a]) {\n    r = r.evaluate(ctx);\n    g = g.evaluate(ctx);\n    b = b.evaluate(ctx);\n    const alpha = a ? a.evaluate(ctx) : 1;\n    const error = validateRGBA(r, g, b, alpha);\n    if (error) throw new RuntimeError(error);\n    return new Color(r / 255 * alpha, g / 255 * alpha, b / 255 * alpha, alpha);\n}\n\nfunction has(key, obj) {\n    return key in obj;\n}\n\nfunction get(key, obj) {\n    const v = obj[key];\n    return typeof v === 'undefined' ? null : v;\n}\n\nfunction lt(ctx, [a, b]) { return a.evaluate(ctx) < b.evaluate(ctx); }\nfunction gt(ctx, [a, b]) { return a.evaluate(ctx) > b.evaluate(ctx); }\nfunction lteq(ctx, [a, b]) { return a.evaluate(ctx) <= b.evaluate(ctx); }\nfunction gteq(ctx, [a, b]) { return a.evaluate(ctx) >= b.evaluate(ctx); }\n\nfunction ltCollate(ctx, [a, b, c]) { return c.evaluate(ctx).compare(a.evaluate(ctx), b.evaluate(ctx)) < 0; }\nfunction gtCollate(ctx, [a, b, c]) { return c.evaluate(ctx).compare(a.evaluate(ctx), b.evaluate(ctx)) > 0; }\nfunction lteqCollate(ctx, [a, b, c]) { return c.evaluate(ctx).compare(a.evaluate(ctx), b.evaluate(ctx)) <= 0; }\nfunction gteqCollate(ctx, [a, b, c]) { return c.evaluate(ctx).compare(a.evaluate(ctx), b.evaluate(ctx)) >= 0; }\n\nfunction binarySearch(v, a, i, j) {\n    while (i <= j) {\n        const m = (i + j) >> 1;\n        if (a[m] === v)\n            return true;\n        if (a[m] > v)\n            j = m - 1;\n        else\n            i = m + 1;\n    }\n    return false;\n}\n\nfunction varargs(type: Type): Varargs {\n    return { type };\n}\n\nCompoundExpression.register(expressions, {\n    'error': [\n        ErrorType,\n        [StringType],\n        (ctx, [v]) => { throw new RuntimeError(v.evaluate(ctx)); }\n    ],\n    'typeof': [\n        StringType,\n        [ValueType],\n        (ctx, [v]) => toString(typeOf(v.evaluate(ctx)))\n    ],\n    'to-string': [\n        StringType,\n        [ValueType],\n        (ctx, [v]) => {\n            v = v.evaluate(ctx);\n            const type = typeof v;\n            if (v === null) {\n                return '';\n            } else if (type === 'string' || type === 'number' || type === 'boolean') {\n                return String(v);\n            } else if (v instanceof Color) {\n                return v.toString();\n            } else {\n                return JSON.stringify(v);\n            }\n        }\n    ],\n    'to-boolean': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => Boolean(v.evaluate(ctx))\n    ],\n    'to-rgba': [\n        array(NumberType, 4),\n        [ColorType],\n        (ctx, [v]) => {\n            return v.evaluate(ctx).toArray();\n        }\n    ],\n    'rgb': [\n        ColorType,\n        [NumberType, NumberType, NumberType],\n        rgba\n    ],\n    'rgba': [\n        ColorType,\n        [NumberType, NumberType, NumberType, NumberType],\n        rgba\n    ],\n    'has': {\n        type: BooleanType,\n        overloads: [\n            [\n                [StringType],\n                (ctx, [key]) => has(key.evaluate(ctx), ctx.properties())\n            ], [\n                [StringType, ObjectType],\n                (ctx, [key, obj]) => has(key.evaluate(ctx), obj.evaluate(ctx))\n            ]\n        ]\n    },\n    'get': {\n        type: ValueType,\n        overloads: [\n            [\n                [StringType],\n                (ctx, [key]) => get(key.evaluate(ctx), ctx.properties())\n            ], [\n                [StringType, ObjectType],\n                (ctx, [key, obj]) => get(key.evaluate(ctx), obj.evaluate(ctx))\n            ]\n        ]\n    },\n    'properties': [\n        ObjectType,\n        [],\n        (ctx) => ctx.properties()\n    ],\n    'geometry-type': [\n        StringType,\n        [],\n        (ctx) => ctx.geometryType()\n    ],\n    'id': [\n        ValueType,\n        [],\n        (ctx) => ctx.id()\n    ],\n    'zoom': [\n        NumberType,\n        [],\n        (ctx) => ctx.globals.zoom\n    ],\n    'heatmap-density': [\n        NumberType,\n        [],\n        (ctx) => ctx.globals.heatmapDensity || 0\n    ],\n    'line-progress': [\n        NumberType,\n        [],\n        (ctx) => ctx.globals.lineProgress || 0\n    ],\n    '+': [\n        NumberType,\n        varargs(NumberType),\n        (ctx, args) => {\n            let result = 0;\n            for (const arg of args) {\n                result += arg.evaluate(ctx);\n            }\n            return result;\n        }\n    ],\n    '*': [\n        NumberType,\n        varargs(NumberType),\n        (ctx, args) => {\n            let result = 1;\n            for (const arg of args) {\n                result *= arg.evaluate(ctx);\n            }\n            return result;\n        }\n    ],\n    '-': {\n        type: NumberType,\n        overloads: [\n            [\n                [NumberType, NumberType],\n                (ctx, [a, b]) => a.evaluate(ctx) - b.evaluate(ctx)\n            ], [\n                [NumberType],\n                (ctx, [a]) => -a.evaluate(ctx)\n            ]\n        ]\n    },\n    '/': [\n        NumberType,\n        [NumberType, NumberType],\n        (ctx, [a, b]) => a.evaluate(ctx) / b.evaluate(ctx)\n    ],\n    '%': [\n        NumberType,\n        [NumberType, NumberType],\n        (ctx, [a, b]) => a.evaluate(ctx) % b.evaluate(ctx)\n    ],\n    'ln2': [\n        NumberType,\n        [],\n        () => Math.LN2\n    ],\n    'pi': [\n        NumberType,\n        [],\n        () => Math.PI\n    ],\n    'e': [\n        NumberType,\n        [],\n        () => Math.E\n    ],\n    '^': [\n        NumberType,\n        [NumberType, NumberType],\n        (ctx, [b, e]) => Math.pow(b.evaluate(ctx), e.evaluate(ctx))\n    ],\n    'sqrt': [\n        NumberType,\n        [NumberType],\n        (ctx, [x]) => Math.sqrt(x.evaluate(ctx))\n    ],\n    'log10': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.log10(n.evaluate(ctx))\n    ],\n    'ln': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.log(n.evaluate(ctx))\n    ],\n    'log2': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.log2(n.evaluate(ctx))\n    ],\n    'sin': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.sin(n.evaluate(ctx))\n    ],\n    'cos': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.cos(n.evaluate(ctx))\n    ],\n    'tan': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.tan(n.evaluate(ctx))\n    ],\n    'asin': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.asin(n.evaluate(ctx))\n    ],\n    'acos': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.acos(n.evaluate(ctx))\n    ],\n    'atan': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.atan(n.evaluate(ctx))\n    ],\n    'min': [\n        NumberType,\n        varargs(NumberType),\n        (ctx, args) => Math.min(...args.map(arg => arg.evaluate(ctx)))\n    ],\n    'max': [\n        NumberType,\n        varargs(NumberType),\n        (ctx, args) => Math.max(...args.map(arg => arg.evaluate(ctx)))\n    ],\n    'abs': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.abs(n.evaluate(ctx))\n    ],\n    'round': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => {\n            const v = n.evaluate(ctx);\n            // Javascript's Math.round() rounds towards +Infinity for halfway\n            // values, even when they're negative. It's more common to round\n            // away from 0 (e.g., this is what python and C++ do)\n            return v < 0 ? -Math.round(-v) : Math.round(v);\n        }\n    ],\n    'floor': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.floor(n.evaluate(ctx))\n    ],\n    'ceil': [\n        NumberType,\n        [NumberType],\n        (ctx, [n]) => Math.ceil(n.evaluate(ctx))\n    ],\n    'filter-==': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => ctx.properties()[(k: any).value] === (v: any).value\n    ],\n    'filter-id-==': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => ctx.id() === (v: any).value\n    ],\n    'filter-type-==': [\n        BooleanType,\n        [StringType],\n        (ctx, [v]) => ctx.geometryType() === (v: any).value\n    ],\n    'filter-<': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => {\n            const a = ctx.properties()[(k: any).value];\n            const b = (v: any).value;\n            return typeof a === typeof b && a < b;\n        }\n    ],\n    'filter-id-<': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => {\n            const a = ctx.id();\n            const b = (v: any).value;\n            return typeof a === typeof b && a < b;\n        }\n    ],\n    'filter->': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => {\n            const a = ctx.properties()[(k: any).value];\n            const b = (v: any).value;\n            return typeof a === typeof b && a > b;\n        }\n    ],\n    'filter-id->': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => {\n            const a = ctx.id();\n            const b = (v: any).value;\n            return typeof a === typeof b && a > b;\n        }\n    ],\n    'filter-<=': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => {\n            const a = ctx.properties()[(k: any).value];\n            const b = (v: any).value;\n            return typeof a === typeof b && a <= b;\n        }\n    ],\n    'filter-id-<=': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => {\n            const a = ctx.id();\n            const b = (v: any).value;\n            return typeof a === typeof b && a <= b;\n        }\n    ],\n    'filter->=': [\n        BooleanType,\n        [StringType, ValueType],\n        (ctx, [k, v]) => {\n            const a = ctx.properties()[(k: any).value];\n            const b = (v: any).value;\n            return typeof a === typeof b && a >= b;\n        }\n    ],\n    'filter-id->=': [\n        BooleanType,\n        [ValueType],\n        (ctx, [v]) => {\n            const a = ctx.id();\n            const b = (v: any).value;\n            return typeof a === typeof b && a >= b;\n        }\n    ],\n    'filter-has': [\n        BooleanType,\n        [ValueType],\n        (ctx, [k]) => (k: any).value in ctx.properties()\n    ],\n    'filter-has-id': [\n        BooleanType,\n        [],\n        (ctx) => ctx.id() !== null\n    ],\n    'filter-type-in': [\n        BooleanType,\n        [array(StringType)],\n        (ctx, [v]) => (v: any).value.indexOf(ctx.geometryType()) >= 0\n    ],\n    'filter-id-in': [\n        BooleanType,\n        [array(ValueType)],\n        (ctx, [v]) => (v: any).value.indexOf(ctx.id()) >= 0\n    ],\n    'filter-in-small': [\n        BooleanType,\n        [StringType, array(ValueType)],\n        // assumes v is an array literal\n        (ctx, [k, v]) => (v: any).value.indexOf(ctx.properties()[(k: any).value]) >= 0\n    ],\n    'filter-in-large': [\n        BooleanType,\n        [StringType, array(ValueType)],\n        // assumes v is a array literal with values sorted in ascending order and of a single type\n        (ctx, [k, v]) => binarySearch(ctx.properties()[(k: any).value], (v: any).value, 0, (v: any).value.length - 1)\n    ],\n    '>': {\n        type: BooleanType,\n        overloads: [\n            [[NumberType, NumberType], gt],\n            [[StringType, StringType], gt],\n            [[StringType, StringType, CollatorType], gtCollate]\n        ]\n    },\n    '<': {\n        type: BooleanType,\n        overloads: [\n            [[NumberType, NumberType], lt],\n            [[StringType, StringType], lt],\n            [[StringType, StringType, CollatorType], ltCollate]\n        ]\n    },\n    '>=': {\n        type: BooleanType,\n        overloads: [\n            [[NumberType, NumberType], gteq],\n            [[StringType, StringType], gteq],\n            [[StringType, StringType, CollatorType], gteqCollate]\n        ]\n    },\n    '<=': {\n        type: BooleanType,\n        overloads: [\n            [[NumberType, NumberType], lteq],\n            [[StringType, StringType], lteq],\n            [[StringType, StringType, CollatorType], lteqCollate]\n        ]\n    },\n    'all': {\n        type: BooleanType,\n        overloads: [\n            [\n                [BooleanType, BooleanType],\n                (ctx, [a, b]) => a.evaluate(ctx) && b.evaluate(ctx)\n            ],\n            [\n                varargs(BooleanType),\n                (ctx, args) => {\n                    for (const arg of args) {\n                        if (!arg.evaluate(ctx))\n                            return false;\n                    }\n                    return true;\n                }\n            ]\n        ]\n    },\n    'any': {\n        type: BooleanType,\n        overloads: [\n            [\n                [BooleanType, BooleanType],\n                (ctx, [a, b]) => a.evaluate(ctx) || b.evaluate(ctx)\n            ],\n            [\n                varargs(BooleanType),\n                (ctx, args) => {\n                    for (const arg of args) {\n                        if (arg.evaluate(ctx))\n                            return true;\n                    }\n                    return false;\n                }\n            ]\n        ]\n    },\n    '!': [\n        BooleanType,\n        [BooleanType],\n        (ctx, [b]) => !b.evaluate(ctx)\n    ],\n    'is-supported-script': [\n        BooleanType,\n        [StringType],\n        // At parse time this will always return true, so we need to exclude this expression with isGlobalPropertyConstant\n        (ctx, [s]) => {\n            const isSupportedScript = ctx.globals && ctx.globals.isSupportedScript;\n            if (isSupportedScript) {\n                return isSupportedScript(s.evaluate(ctx));\n            }\n            return true;\n        }\n    ],\n    'upcase': [\n        StringType,\n        [StringType],\n        (ctx, [s]) => s.evaluate(ctx).toUpperCase()\n    ],\n    'downcase': [\n        StringType,\n        [StringType],\n        (ctx, [s]) => s.evaluate(ctx).toLowerCase()\n    ],\n    'concat': [\n        StringType,\n        varargs(StringType),\n        (ctx, args) => args.map(arg => arg.evaluate(ctx)).join('')\n    ],\n    'resolved-locale': [\n        StringType,\n        [CollatorType],\n        (ctx, [collator]) => collator.evaluate(ctx).resolvedLocale()\n    ]\n});\n\nexport default expressions;\n","// @flow\n\nimport UnitBezier from '@mapbox/unitbezier';\n\nimport * as interpolate from '../../util/interpolate';\nimport { toString, NumberType } from '../types';\nimport { findStopLessThanOrEqualTo } from '../stops';\n\nimport type { Stops } from '../stops';\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { Type } from '../types';\n\nexport type InterpolationType =\n    { name: 'linear' } |\n    { name: 'exponential', base: number } |\n    { name: 'cubic-bezier', controlPoints: [number, number, number, number] };\n\nclass Interpolate implements Expression {\n    type: Type;\n\n    interpolation: InterpolationType;\n    input: Expression;\n    labels: Array<number>;\n    outputs: Array<Expression>;\n\n    constructor(type: Type, interpolation: InterpolationType, input: Expression, stops: Stops) {\n        this.type = type;\n        this.interpolation = interpolation;\n        this.input = input;\n\n        this.labels = [];\n        this.outputs = [];\n        for (const [label, expression] of stops) {\n            this.labels.push(label);\n            this.outputs.push(expression);\n        }\n    }\n\n    static interpolationFactor(interpolation: InterpolationType, input: number, lower: number, upper: number) {\n        let t = 0;\n        if (interpolation.name === 'exponential') {\n            t = exponentialInterpolation(input, interpolation.base, lower, upper);\n        } else if (interpolation.name === 'linear') {\n            t = exponentialInterpolation(input, 1, lower, upper);\n        } else if (interpolation.name === 'cubic-bezier') {\n            const c = interpolation.controlPoints;\n            const ub = new UnitBezier(c[0], c[1], c[2], c[3]);\n            t = ub.solve(exponentialInterpolation(input, 1, lower, upper));\n        }\n        return t;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        let [ , interpolation, input, ...rest] = args;\n\n        if (!Array.isArray(interpolation) || interpolation.length === 0) {\n            return context.error(`Expected an interpolation type expression.`, 1);\n        }\n\n        if (interpolation[0] === 'linear') {\n            interpolation = { name: 'linear' };\n        } else if (interpolation[0] === 'exponential') {\n            const base = interpolation[1];\n            if (typeof base !== 'number')\n                return context.error(`Exponential interpolation requires a numeric base.`, 1, 1);\n            interpolation = {\n                name: 'exponential',\n                base\n            };\n        } else if (interpolation[0] === 'cubic-bezier') {\n            const controlPoints = interpolation.slice(1);\n            if (\n                controlPoints.length !== 4 ||\n                controlPoints.some(t => typeof t !== 'number' || t < 0 || t > 1)\n            ) {\n                return context.error('Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.', 1);\n            }\n\n            interpolation = {\n                name: 'cubic-bezier',\n                controlPoints: (controlPoints: any)\n            };\n        } else {\n            return context.error(`Unknown interpolation type ${String(interpolation[0])}`, 1, 0);\n        }\n\n        if (args.length - 1 < 4) {\n            return context.error(`Expected at least 4 arguments, but found only ${args.length - 1}.`);\n        }\n\n        if ((args.length - 1) % 2 !== 0) {\n            return context.error(`Expected an even number of arguments.`);\n        }\n\n        input = context.parse(input, 2, NumberType);\n        if (!input) return null;\n\n        const stops: Stops = [];\n\n        let outputType: Type = (null: any);\n        if (context.expectedType && context.expectedType.kind !== 'value') {\n            outputType = context.expectedType;\n        }\n\n        for (let i = 0; i < rest.length; i += 2) {\n            const label = rest[i];\n            const value = rest[i + 1];\n\n            const labelKey = i + 3;\n            const valueKey = i + 4;\n\n            if (typeof label !== 'number') {\n                return context.error('Input/output pairs for \"interpolate\" expressions must be defined using literal numeric values (not computed expressions) for the input values.', labelKey);\n            }\n\n            if (stops.length && stops[stops.length - 1][0] >= label) {\n                return context.error('Input/output pairs for \"interpolate\" expressions must be arranged with input values in strictly ascending order.', labelKey);\n            }\n\n            const parsed = context.parse(value, valueKey, outputType);\n            if (!parsed) return null;\n            outputType = outputType || parsed.type;\n            stops.push([label, parsed]);\n        }\n\n        if (outputType.kind !== 'number' &&\n            outputType.kind !== 'color' &&\n            !(\n                outputType.kind === 'array' &&\n                outputType.itemType.kind === 'number' &&\n                typeof outputType.N === 'number'\n            )\n        ) {\n            return context.error(`Type ${toString(outputType)} is not interpolatable.`);\n        }\n\n        return new Interpolate(outputType, interpolation, input, stops);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        const labels = this.labels;\n        const outputs = this.outputs;\n\n        if (labels.length === 1) {\n            return outputs[0].evaluate(ctx);\n        }\n\n        const value = ((this.input.evaluate(ctx): any): number);\n        if (value <= labels[0]) {\n            return outputs[0].evaluate(ctx);\n        }\n\n        const stopCount = labels.length;\n        if (value >= labels[stopCount - 1]) {\n            return outputs[stopCount - 1].evaluate(ctx);\n        }\n\n        const index = findStopLessThanOrEqualTo(labels, value);\n        const lower = labels[index];\n        const upper = labels[index + 1];\n        const t = Interpolate.interpolationFactor(this.interpolation, value, lower, upper);\n\n        const outputLower = outputs[index].evaluate(ctx);\n        const outputUpper = outputs[index + 1].evaluate(ctx);\n\n        return (interpolate[this.type.kind.toLowerCase()]: any)(outputLower, outputUpper, t); // eslint-disable-line import/namespace\n    }\n\n    eachChild(fn: (Expression) => void) {\n        fn(this.input);\n        for (const expression of this.outputs) {\n            fn(expression);\n        }\n    }\n\n    possibleOutputs() {\n        return [].concat(...this.outputs.map((output) => output.possibleOutputs()));\n    }\n\n    serialize() {\n        let interpolation;\n        if (this.interpolation.name === 'linear') {\n            interpolation = [\"linear\"];\n        } else if (this.interpolation.name === 'exponential') {\n            if  (this.interpolation.base === 1) {\n                interpolation = [\"linear\"];\n            } else {\n                interpolation = [\"exponential\", this.interpolation.base];\n            }\n        } else {\n            interpolation = [\"cubic-bezier\" ].concat(this.interpolation.controlPoints);\n        }\n\n        const serialized = [\"interpolate\", interpolation, this.input.serialize()];\n\n        for (let i = 0; i < this.labels.length; i++) {\n            serialized.push(\n                this.labels[i],\n                this.outputs[i].serialize()\n            );\n        }\n        return serialized;\n    }\n}\n\n/**\n * Returns a ratio that can be used to interpolate between exponential function\n * stops.\n * How it works: Two consecutive stop values define a (scaled and shifted) exponential function `f(x) = a * base^x + b`, where `base` is the user-specified base,\n * and `a` and `b` are constants affording sufficient degrees of freedom to fit\n * the function to the given stops.\n *\n * Here's a bit of algebra that lets us compute `f(x)` directly from the stop\n * values without explicitly solving for `a` and `b`:\n *\n * First stop value: `f(x0) = y0 = a * base^x0 + b`\n * Second stop value: `f(x1) = y1 = a * base^x1 + b`\n * => `y1 - y0 = a(base^x1 - base^x0)`\n * => `a = (y1 - y0)/(base^x1 - base^x0)`\n *\n * Desired value: `f(x) = y = a * base^x + b`\n * => `f(x) = y0 + a * (base^x - base^x0)`\n *\n * From the above, we can replace the `a` in `a * (base^x - base^x0)` and do a\n * little algebra:\n * ```\n * a * (base^x - base^x0) = (y1 - y0)/(base^x1 - base^x0) * (base^x - base^x0)\n *                     = (y1 - y0) * (base^x - base^x0) / (base^x1 - base^x0)\n * ```\n *\n * If we let `(base^x - base^x0) / (base^x1 base^x0)`, then we have\n * `f(x) = y0 + (y1 - y0) * ratio`.  In other words, `ratio` may be treated as\n * an interpolation factor between the two stops' output values.\n *\n * (Note: a slightly different form for `ratio`,\n * `(base^(x-x0) - 1) / (base^(x1-x0) - 1) `, is equivalent, but requires fewer\n * expensive `Math.pow()` operations.)\n *\n * @private\n*/\nfunction exponentialInterpolation(input, base, lowerValue, upperValue) {\n    const difference = upperValue - lowerValue;\n    const progress = input - lowerValue;\n\n    if (difference === 0) {\n        return 0;\n    } else if (base === 1) {\n        return progress / difference;\n    } else {\n        return (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n    }\n}\n\nexport default Interpolate;\n","// @flow\n\nimport { NumberType, toString } from '../types';\n\nimport { typeOf } from '../values';\nimport RuntimeError from '../runtime_error';\n\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { Type } from '../types';\n\nclass Length implements Expression {\n    type: Type;\n    input: Expression;\n\n    constructor(input: Expression) {\n        this.type = NumberType;\n        this.input = input;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        if (args.length !== 2)\n            return context.error(`Expected 1 argument, but found ${args.length - 1} instead.`);\n\n        const input = context.parse(args[1], 1);\n        if (!input) return null;\n\n        if (input.type.kind !== 'array' && input.type.kind !== 'string' && input.type.kind !== 'value')\n            return context.error(`Expected argument of type string or array, but found ${toString(input.type)} instead.`);\n\n        return new Length(input);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        const input = this.input.evaluate(ctx);\n        if (typeof input === 'string') {\n            return input.length;\n        } else if (Array.isArray(input)) {\n            return input.length;\n        } else {\n            throw new RuntimeError(`Expected value to be of type string or array, but found ${toString(typeOf(input))} instead.`);\n        }\n    }\n\n    eachChild(fn: (Expression) => void) {\n        fn(this.input);\n    }\n\n    possibleOutputs() {\n        return [undefined];\n    }\n\n    serialize() {\n        const serialized = [\"length\"];\n        this.eachChild(child => { serialized.push(child.serialize()); });\n        return serialized;\n    }\n}\n\nexport default Length;\n","// @flow\n\nimport type { Type } from '../types';\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext  from '../evaluation_context';\n\nclass Let implements Expression {\n    type: Type;\n    bindings: Array<[string, Expression]>;\n    result: Expression;\n\n    constructor(bindings: Array<[string, Expression]>, result: Expression) {\n        this.type = result.type;\n        this.bindings = [].concat(bindings);\n        this.result = result;\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        return this.result.evaluate(ctx);\n    }\n\n    eachChild(fn: (Expression) => void) {\n        for (const binding of this.bindings) {\n            fn(binding[1]);\n        }\n        fn(this.result);\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        if (args.length < 4)\n            return context.error(`Expected at least 3 arguments, but found ${args.length - 1} instead.`);\n\n        const bindings: Array<[string, Expression]> = [];\n        for (let i = 1; i < args.length - 1; i += 2) {\n            const name = args[i];\n\n            if (typeof name !== 'string') {\n                return context.error(`Expected string, but found ${typeof name} instead.`, i);\n            }\n\n            if (/[^a-zA-Z0-9_]/.test(name)) {\n                return context.error(`Variable names must contain only alphanumeric characters or '_'.`, i);\n            }\n\n            const value = context.parse(args[i + 1], i + 1);\n            if (!value) return null;\n\n            bindings.push([name, value]);\n        }\n\n        const result = context.parse(args[args.length - 1], args.length - 1, undefined, bindings);\n        if (!result) return null;\n\n        return new Let(bindings, result);\n    }\n\n    possibleOutputs() {\n        return this.result.possibleOutputs();\n    }\n\n    serialize() {\n        const serialized = [\"let\"];\n        for (const [name, expr] of this.bindings) {\n            serialized.push(name, expr.serialize());\n        }\n        serialized.push(this.result.serialize());\n        return serialized;\n    }\n}\n\nexport default Let;\n","// @flow\n\nimport assert from 'assert';\nimport { isValue, typeOf, Color } from '../values';\n\nimport type { Type } from '../types';\nimport type { Value }  from '../values';\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\n\nclass Literal implements Expression {\n    type: Type;\n    value: Value;\n\n    constructor(type: Type, value: Value) {\n        this.type = type;\n        this.value = value;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        if (args.length !== 2)\n            return context.error(`'literal' expression requires exactly one argument, but found ${args.length - 1} instead.`);\n\n        if (!isValue(args[1]))\n            return context.error(`invalid value`);\n\n        const value = (args[1]: any);\n        let type = typeOf(value);\n\n        // special case: infer the item type if possible for zero-length arrays\n        const expected = context.expectedType;\n        if (\n            type.kind === 'array' &&\n            type.N === 0 &&\n            expected &&\n            expected.kind === 'array' &&\n            (typeof expected.N !== 'number' || expected.N === 0)\n        ) {\n            type = expected;\n        }\n\n        return new Literal(type, value);\n    }\n\n    evaluate() {\n        return this.value;\n    }\n\n    eachChild() {}\n\n    possibleOutputs() {\n        return [this.value];\n    }\n\n    serialize() {\n        if (this.type.kind === 'array' || this.type.kind === 'object') {\n            return [\"literal\", this.value];\n        } else if (this.value instanceof Color) {\n            // Constant-folding can generate Literal expressions that you\n            // couldn't actually generate with a \"literal\" expression,\n            // so we have to implement an equivalent serialization here\n            return [\"rgba\"].concat(this.value.toArray());\n        } else {\n            assert(this.value === null ||\n                typeof this.value === 'string' ||\n                typeof this.value === 'number' ||\n                typeof this.value === 'boolean');\n            return (this.value: any);\n        }\n    }\n}\n\nexport default Literal;\n","// @flow\n\nimport assert from 'assert';\n\nimport { typeOf } from '../values';\n\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { Type } from '../types';\n\n// Map input label values to output expression index\ntype Cases = {[number | string]: number};\n\nclass Match implements Expression {\n    type: Type;\n    inputType: Type;\n\n    input: Expression;\n    cases: Cases;\n    outputs: Array<Expression>;\n    otherwise: Expression;\n\n    constructor(inputType: Type, outputType: Type, input: Expression, cases: Cases, outputs: Array<Expression>, otherwise: Expression) {\n        this.inputType = inputType;\n        this.type = outputType;\n        this.input = input;\n        this.cases = cases;\n        this.outputs = outputs;\n        this.otherwise = otherwise;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        if (args.length < 5)\n            return context.error(`Expected at least 4 arguments, but found only ${args.length - 1}.`);\n        if (args.length % 2 !== 1)\n            return context.error(`Expected an even number of arguments.`);\n\n        let inputType;\n        let outputType;\n        if (context.expectedType && context.expectedType.kind !== 'value') {\n            outputType = context.expectedType;\n        }\n        const cases = {};\n        const outputs = [];\n        for (let i = 2; i < args.length - 1; i += 2) {\n            let labels = args[i];\n            const value = args[i + 1];\n\n            if (!Array.isArray(labels)) {\n                labels = [labels];\n            }\n\n            const labelContext = context.concat(i);\n            if (labels.length === 0) {\n                return labelContext.error('Expected at least one branch label.');\n            }\n\n            for (const label of labels) {\n                if (typeof label !== 'number' && typeof label !== 'string') {\n                    return labelContext.error(`Branch labels must be numbers or strings.`);\n                } else if (typeof label === 'number' && Math.abs(label) > Number.MAX_SAFE_INTEGER) {\n                    return labelContext.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);\n\n                } else if (typeof label === 'number' && Math.floor(label) !== label) {\n                    return labelContext.error(`Numeric branch labels must be integer values.`);\n\n                } else if (!inputType) {\n                    inputType = typeOf(label);\n                } else if (labelContext.checkSubtype(inputType, typeOf(label))) {\n                    return null;\n                }\n\n                if (typeof cases[String(label)] !== 'undefined') {\n                    return labelContext.error('Branch labels must be unique.');\n                }\n\n                cases[String(label)] = outputs.length;\n            }\n\n            const result = context.parse(value, i, outputType);\n            if (!result) return null;\n            outputType = outputType || result.type;\n            outputs.push(result);\n        }\n\n        const input = context.parse(args[1], 1, inputType);\n        if (!input) return null;\n\n        const otherwise = context.parse(args[args.length - 1], args.length - 1, outputType);\n        if (!otherwise) return null;\n\n        assert(inputType && outputType);\n        return new Match((inputType: any), (outputType: any), input, cases, outputs, otherwise);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        const input = (this.input.evaluate(ctx): any);\n        return (this.outputs[this.cases[input]] || this.otherwise).evaluate(ctx);\n    }\n\n    eachChild(fn: (Expression) => void) {\n        fn(this.input);\n        this.outputs.forEach(fn);\n        fn(this.otherwise);\n    }\n\n    possibleOutputs() {\n        return []\n            .concat(...this.outputs.map((out) => out.possibleOutputs()))\n            .concat(this.otherwise.possibleOutputs());\n    }\n\n    serialize() {\n        const serialized = [\"match\", this.input.serialize()];\n\n        // Sort so serialization has an arbitrary defined order, even though\n        // branch order doesn't affect evaluation\n        const sortedLabels = Object.keys(this.cases).sort();\n\n        // Group branches by unique match expression to support condensed\n        // serializations of the form [case1, case2, ...] -> matchExpression\n        const groupedByOutput: Array<[number, Array<number | string>]> = [];\n        const outputLookup: {[index: number]: number} = {}; // lookup index into groupedByOutput for a given output expression\n        for (const label of sortedLabels) {\n            const outputIndex = outputLookup[this.cases[label]];\n            if (outputIndex === undefined) {\n                // First time seeing this output, add it to the end of the grouped list\n                outputLookup[this.cases[label]] = groupedByOutput.length;\n                groupedByOutput.push([this.cases[label], [label]]);\n            } else {\n                // We've seen this expression before, add the label to that output's group\n                groupedByOutput[outputIndex][1].push(label);\n            }\n        }\n\n        const coerceLabel = (label) => this.input.type.kind === 'number' ? Number(label) : label;\n\n        for (const [outputIndex, labels] of groupedByOutput) {\n            if (labels.length === 1) {\n                // Only a single label matches this output expression\n                serialized.push(coerceLabel(labels[0]));\n            } else {\n                // Array of literal labels pointing to this output expression\n                serialized.push(labels.map(coerceLabel));\n            }\n            serialized.push(this.outputs[outputIndex].serialize());\n        }\n        serialized.push(this.otherwise.serialize());\n        return serialized;\n    }\n}\n\nexport default Match;\n","// @flow\n\nimport { NumberType } from '../types';\n\nimport { findStopLessThanOrEqualTo } from '../stops';\n\nimport type { Stops } from '../stops';\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext from '../evaluation_context';\nimport type { Type } from '../types';\n\nclass Step implements Expression {\n    type: Type;\n\n    input: Expression;\n    labels: Array<number>;\n    outputs: Array<Expression>;\n\n    constructor(type: Type, input: Expression, stops: Stops) {\n        this.type = type;\n        this.input = input;\n\n        this.labels = [];\n        this.outputs = [];\n        for (const [label, expression] of stops) {\n            this.labels.push(label);\n            this.outputs.push(expression);\n        }\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        let [ , input, ...rest] = args;\n\n        if (args.length - 1 < 4) {\n            return context.error(`Expected at least 4 arguments, but found only ${args.length - 1}.`);\n        }\n\n        if ((args.length - 1) % 2 !== 0) {\n            return context.error(`Expected an even number of arguments.`);\n        }\n\n        input = context.parse(input, 1, NumberType);\n        if (!input) return null;\n\n        const stops: Stops = [];\n\n        let outputType: Type = (null: any);\n        if (context.expectedType && context.expectedType.kind !== 'value') {\n            outputType = context.expectedType;\n        }\n\n        rest.unshift(-Infinity);\n\n        for (let i = 0; i < rest.length; i += 2) {\n            const label = rest[i];\n            const value = rest[i + 1];\n\n            const labelKey = i + 1;\n            const valueKey = i + 2;\n\n            if (typeof label !== 'number') {\n                return context.error('Input/output pairs for \"step\" expressions must be defined using literal numeric values (not computed expressions) for the input values.', labelKey);\n            }\n\n            if (stops.length && stops[stops.length - 1][0] >= label) {\n                return context.error('Input/output pairs for \"step\" expressions must be arranged with input values in strictly ascending order.', labelKey);\n            }\n\n            const parsed = context.parse(value, valueKey, outputType);\n            if (!parsed) return null;\n            outputType = outputType || parsed.type;\n            stops.push([label, parsed]);\n        }\n\n        return new Step(outputType, input, stops);\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        const labels = this.labels;\n        const outputs = this.outputs;\n\n        if (labels.length === 1) {\n            return outputs[0].evaluate(ctx);\n        }\n\n        const value = ((this.input.evaluate(ctx): any): number);\n        if (value <= labels[0]) {\n            return outputs[0].evaluate(ctx);\n        }\n\n        const stopCount = labels.length;\n        if (value >= labels[stopCount - 1]) {\n            return outputs[stopCount - 1].evaluate(ctx);\n        }\n\n        const index = findStopLessThanOrEqualTo(labels, value);\n        return outputs[index].evaluate(ctx);\n    }\n\n    eachChild(fn: (Expression) => void) {\n        fn(this.input);\n        for (const expression of this.outputs) {\n            fn(expression);\n        }\n    }\n\n    possibleOutputs() {\n        return [].concat(...this.outputs.map((output) => output.possibleOutputs()));\n    }\n\n    serialize() {\n        const serialized = [\"step\", this.input.serialize()];\n        for (let i = 0; i < this.labels.length; i++) {\n            if (i > 0) {\n                serialized.push(this.labels[i]);\n            }\n            serialized.push(this.outputs[i].serialize());\n        }\n        return serialized;\n    }\n}\n\nexport default Step;\n","// @flow\n\nimport type { Type } from '../types';\nimport type { Expression } from '../expression';\nimport type ParsingContext from '../parsing_context';\nimport type EvaluationContext  from '../evaluation_context';\n\nclass Var implements Expression {\n    type: Type;\n    name: string;\n    boundExpression: Expression;\n\n    constructor(name: string, boundExpression: Expression) {\n        this.type = boundExpression.type;\n        this.name = name;\n        this.boundExpression = boundExpression;\n    }\n\n    static parse(args: Array<mixed>, context: ParsingContext) {\n        if (args.length !== 2 || typeof args[1] !== 'string')\n            return context.error(`'var' expression requires exactly one string literal argument.`);\n\n        const name = args[1];\n        if (!context.scope.has(name)) {\n            return context.error(`Unknown variable \"${name}\". Make sure \"${name}\" has been bound in an enclosing \"let\" expression before using it.`, 1);\n        }\n\n        return new Var(name, context.scope.get(name));\n    }\n\n    evaluate(ctx: EvaluationContext) {\n        return this.boundExpression.evaluate(ctx);\n    }\n\n    eachChild() {}\n\n    possibleOutputs() {\n        return [undefined];\n    }\n\n    serialize() {\n        return [\"var\", this.name];\n    }\n}\n\nexport default Var;\n","// @flow\n\nimport { Color } from './values';\n\nimport type { Feature, GlobalProperties } from './index';\n\nconst geometryTypes = ['Unknown', 'Point', 'LineString', 'Polygon'];\n\nclass EvaluationContext {\n    globals: GlobalProperties;\n    feature: ?Feature;\n\n    _parseColorCache: {[string]: ?Color};\n\n    constructor() {\n        this._parseColorCache = {};\n    }\n\n    id() {\n        return this.feature && 'id' in this.feature ? this.feature.id : null;\n    }\n\n    geometryType() {\n        return this.feature ? typeof this.feature.type === 'number' ? geometryTypes[this.feature.type] : this.feature.type : null;\n    }\n\n    properties() {\n        return this.feature && this.feature.properties || {};\n    }\n\n    parseColor(input: string): ?Color {\n        let cached = this._parseColorCache[input];\n        if (!cached) {\n            cached = this._parseColorCache[input] = Color.parse(input);\n        }\n        return cached;\n    }\n}\n\nexport default EvaluationContext;\n","// @flow\n\nimport assert from 'assert';\n\nimport extend from '../util/extend';\nimport ParsingError from './parsing_error';\nimport ParsingContext from './parsing_context';\nimport EvaluationContext from './evaluation_context';\nimport CompoundExpression from './compound_expression';\nimport Step from './definitions/step';\nimport Interpolate from './definitions/interpolate';\nimport Coalesce from './definitions/coalesce';\nimport Let from './definitions/let';\nimport definitions from './definitions';\nimport * as isConstant from './is_constant';\nimport RuntimeError from './runtime_error';\nimport { success, error } from '../util/result';\n\nimport type {Type} from './types';\nimport type {Value} from './values';\nimport type {Expression} from './expression';\nimport type {StylePropertySpecification} from '../style-spec';\nimport type {Result} from '../util/result';\nimport type {InterpolationType} from './definitions/interpolate';\n\nexport type Feature = {\n    +type: 1 | 2 | 3 | 'Unknown' | 'Point' | 'MultiPoint' | 'LineString' | 'MultiLineString' | 'Polygon' | 'MultiPolygon',\n    +id?: any,\n    +properties: {[string]: any}\n};\n\nexport type GlobalProperties = $ReadOnly<{\n    zoom: number,\n    heatmapDensity?: number,\n    lineProgress?: number,\n    isSupportedScript?: (string) => boolean\n}>;\n\nexport class StyleExpression {\n    expression: Expression;\n\n    _evaluator: EvaluationContext;\n    _defaultValue: Value;\n    _warningHistory: {[key: string]: boolean};\n    _enumValues: {[string]: any};\n\n    constructor(expression: Expression, propertySpec: StylePropertySpecification) {\n        this.expression = expression;\n        this._warningHistory = {};\n        this._defaultValue = getDefaultValue(propertySpec);\n        if (propertySpec.type === 'enum') {\n            this._enumValues = propertySpec.values;\n        }\n    }\n\n    evaluateWithoutErrorHandling(globals: GlobalProperties, feature?: Feature): any {\n        if (!this._evaluator) {\n            this._evaluator = new EvaluationContext();\n        }\n\n        this._evaluator.globals = globals;\n        this._evaluator.feature = feature;\n\n        return this.expression.evaluate(this._evaluator);\n    }\n\n    evaluate(globals: GlobalProperties, feature?: Feature): any {\n        if (!this._evaluator) {\n            this._evaluator = new EvaluationContext();\n        }\n\n        this._evaluator.globals = globals;\n        this._evaluator.feature = feature;\n\n        try {\n            const val = this.expression.evaluate(this._evaluator);\n            if (val === null || val === undefined) {\n                return this._defaultValue;\n            }\n            if (this._enumValues && !(val in this._enumValues)) {\n                throw new RuntimeError(`Expected value to be one of ${Object.keys(this._enumValues).map(v => JSON.stringify(v)).join(', ')}, but found ${JSON.stringify(val)} instead.`);\n            }\n            return val;\n        } catch (e) {\n            if (!this._warningHistory[e.message]) {\n                this._warningHistory[e.message] = true;\n                if (typeof console !== 'undefined') {\n                    console.warn(e.message);\n                }\n            }\n            return this._defaultValue;\n        }\n    }\n}\n\nexport function isExpression(expression: mixed) {\n    return Array.isArray(expression) && expression.length > 0 &&\n        typeof expression[0] === 'string' && expression[0] in definitions;\n}\n\n/**\n * Parse and typecheck the given style spec JSON expression.  If\n * options.defaultValue is provided, then the resulting StyleExpression's\n * `evaluate()` method will handle errors by logging a warning (once per\n * message) and returning the default value.  Otherwise, it will throw\n * evaluation errors.\n *\n * @private\n */\nexport function createExpression(expression: mixed, propertySpec: StylePropertySpecification): Result<StyleExpression, Array<ParsingError>> {\n    const parser = new ParsingContext(definitions, [], getExpectedType(propertySpec));\n    const parsed = parser.parse(expression);\n    if (!parsed) {\n        assert(parser.errors.length > 0);\n        return error(parser.errors);\n    }\n\n    return success(new StyleExpression(parsed, propertySpec));\n}\n\nexport class ZoomConstantExpression<Kind> {\n    kind: Kind;\n    _styleExpression: StyleExpression;\n\n    constructor(kind: Kind, expression: StyleExpression) {\n        this.kind = kind;\n        this._styleExpression = expression;\n    }\n\n    evaluateWithoutErrorHandling(globals: GlobalProperties, feature?: Feature): any {\n        return this._styleExpression.evaluateWithoutErrorHandling(globals, feature);\n    }\n\n    evaluate(globals: GlobalProperties, feature?: Feature): any {\n        return this._styleExpression.evaluate(globals, feature);\n    }\n}\n\nexport class ZoomDependentExpression<Kind> {\n    kind: Kind;\n    zoomStops: Array<number>;\n\n    _styleExpression: StyleExpression;\n    _interpolationType: ?InterpolationType;\n\n    constructor(kind: Kind, expression: StyleExpression, zoomCurve: Step | Interpolate) {\n        this.kind = kind;\n        this.zoomStops = zoomCurve.labels;\n        this._styleExpression = expression;\n        if (zoomCurve instanceof Interpolate) {\n            this._interpolationType = zoomCurve.interpolation;\n        }\n    }\n\n    evaluateWithoutErrorHandling(globals: GlobalProperties, feature?: Feature): any {\n        return this._styleExpression.evaluateWithoutErrorHandling(globals, feature);\n    }\n\n    evaluate(globals: GlobalProperties, feature?: Feature): any {\n        return this._styleExpression.evaluate(globals, feature);\n    }\n\n    interpolationFactor(input: number, lower: number, upper: number): number {\n        if (this._interpolationType) {\n            return Interpolate.interpolationFactor(this._interpolationType, input, lower, upper);\n        } else {\n            return 0;\n        }\n    }\n}\n\nexport type ConstantExpression = {\n    kind: 'constant',\n    +evaluate: (globals: GlobalProperties, feature?: Feature) => any,\n}\n\nexport type SourceExpression = {\n    kind: 'source',\n    +evaluate: (globals: GlobalProperties, feature?: Feature) => any,\n};\n\nexport type CameraExpression = {\n    kind: 'camera',\n    +evaluate: (globals: GlobalProperties, feature?: Feature) => any,\n    +interpolationFactor: (input: number, lower: number, upper: number) => number,\n    zoomStops: Array<number>\n};\n\nexport type CompositeExpression = {\n    kind: 'composite',\n    +evaluate: (globals: GlobalProperties, feature?: Feature) => any,\n    +interpolationFactor: (input: number, lower: number, upper: number) => number,\n    zoomStops: Array<number>\n};\n\nexport type StylePropertyExpression =\n    | ConstantExpression\n    | SourceExpression\n    | CameraExpression\n    | CompositeExpression;\n\nexport function createPropertyExpression(expression: mixed, propertySpec: StylePropertySpecification): Result<StylePropertyExpression, Array<ParsingError>> {\n    expression = createExpression(expression, propertySpec);\n    if (expression.result === 'error') {\n        return expression;\n    }\n\n    const parsed = expression.value.expression;\n\n    const isFeatureConstant = isConstant.isFeatureConstant(parsed);\n    if (!isFeatureConstant && !propertySpec['property-function']) {\n        return error([new ParsingError('', 'property expressions not supported')]);\n    }\n\n    const isZoomConstant = isConstant.isGlobalPropertyConstant(parsed, ['zoom']);\n    if (!isZoomConstant && propertySpec['zoom-function'] === false) {\n        return error([new ParsingError('', 'zoom expressions not supported')]);\n    }\n\n    const zoomCurve = findZoomCurve(parsed);\n    if (!zoomCurve && !isZoomConstant) {\n        return error([new ParsingError('', '\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.')]);\n    } else if (zoomCurve instanceof ParsingError) {\n        return error([zoomCurve]);\n    } else if (zoomCurve instanceof Interpolate && propertySpec['function'] === 'piecewise-constant') {\n        return error([new ParsingError('', '\"interpolate\" expressions cannot be used with this property')]);\n    }\n\n    if (!zoomCurve) {\n        return success(isFeatureConstant ?\n            (new ZoomConstantExpression('constant', expression.value): ConstantExpression) :\n            (new ZoomConstantExpression('source', expression.value): SourceExpression));\n    }\n\n    return success(isFeatureConstant ?\n        (new ZoomDependentExpression('camera', expression.value, zoomCurve): CameraExpression) :\n        (new ZoomDependentExpression('composite', expression.value, zoomCurve): CompositeExpression));\n}\n\nimport { isFunction, createFunction } from '../function';\nimport { Color } from './values';\n\n// serialization wrapper for old-style stop functions normalized to the\n// expression interface\nexport class StylePropertyFunction<T> {\n    _parameters: PropertyValueSpecification<T>;\n    _specification: StylePropertySpecification;\n\n    kind: 'constant' | 'source' | 'camera' | 'composite';\n    evaluate: (globals: GlobalProperties, feature?: Feature) => any;\n    interpolationFactor: ?(input: number, lower: number, upper: number) => number;\n    zoomStops: ?Array<number>;\n\n    constructor(parameters: PropertyValueSpecification<T>, specification: StylePropertySpecification) {\n        this._parameters = parameters;\n        this._specification = specification;\n        extend(this, createFunction(this._parameters, this._specification));\n    }\n\n    static deserialize(serialized: {_parameters: PropertyValueSpecification<T>, _specification: StylePropertySpecification}) {\n        return ((new StylePropertyFunction(serialized._parameters, serialized._specification)): StylePropertyFunction<T>);\n    }\n\n    static serialize(input: StylePropertyFunction<T>) {\n        return {\n            _parameters: input._parameters,\n            _specification: input._specification\n        };\n    }\n}\n\nexport function normalizePropertyExpression<T>(value: PropertyValueSpecification<T>, specification: StylePropertySpecification): StylePropertyExpression {\n    if (isFunction(value)) {\n        return (new StylePropertyFunction(value, specification): any);\n\n    } else if (isExpression(value)) {\n        const expression = createPropertyExpression(value, specification);\n        if (expression.result === 'error') {\n            // this should have been caught in validation\n            throw new Error(expression.value.map(err => `${err.key}: ${err.message}`).join(', '));\n        }\n        return expression.value;\n\n    } else {\n        let constant: any = value;\n        if (typeof value === 'string' && specification.type === 'color') {\n            constant = Color.parse(value);\n        }\n        return {\n            kind: 'constant',\n            evaluate: () => constant\n        };\n    }\n}\n\n// Zoom-dependent expressions may only use [\"zoom\"] as the input to a top-level \"step\" or \"interpolate\"\n// expression (collectively referred to as a \"curve\"). The curve may be wrapped in one or more \"let\" or\n// \"coalesce\" expressions.\nfunction findZoomCurve(expression: Expression): Step | Interpolate | ParsingError | null {\n    let result = null;\n    if (expression instanceof Let) {\n        result = findZoomCurve(expression.result);\n\n    } else if (expression instanceof Coalesce) {\n        for (const arg of expression.args) {\n            result = findZoomCurve(arg);\n            if (result) {\n                break;\n            }\n        }\n\n    } else if ((expression instanceof Step || expression instanceof Interpolate) &&\n        expression.input instanceof CompoundExpression &&\n        expression.input.name === 'zoom') {\n\n        result = expression;\n    }\n\n    if (result instanceof ParsingError) {\n        return result;\n    }\n\n    expression.eachChild((child) => {\n        const childResult = findZoomCurve(child);\n        if (childResult instanceof ParsingError) {\n            result = childResult;\n        } else if (!result && childResult) {\n            result = new ParsingError('', '\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.');\n        } else if (result && childResult && result !== childResult) {\n            result = new ParsingError('', 'Only one zoom-based \"step\" or \"interpolate\" subexpression may be used in an expression.');\n        }\n    });\n\n    return result;\n}\n\nimport { ColorType, StringType, NumberType, BooleanType, ValueType, array } from './types';\n\nfunction getExpectedType(spec: StylePropertySpecification): Type | null {\n    const types = {\n        color: ColorType,\n        string: StringType,\n        number: NumberType,\n        enum: StringType,\n        boolean: BooleanType\n    };\n\n    if (spec.type === 'array') {\n        return array(types[spec.value] || ValueType, spec.length);\n    }\n\n    return types[spec.type] || null;\n}\n\nfunction getDefaultValue(spec: StylePropertySpecification): Value {\n    if (spec.type === 'color' && isFunction(spec.default)) {\n        // Special case for heatmap-color: it uses the 'default:' to define a\n        // default color ramp, but createExpression expects a simple value to fall\n        // back to in case of runtime errors\n        return new Color(0, 0, 0, 0);\n    } else if (spec.type === 'color') {\n        return Color.parse(spec.default) || null;\n    } else if (spec.default === undefined) {\n        return null;\n    } else {\n        return spec.default;\n    }\n}\n","// @flow\n\nimport CompoundExpression from './compound_expression';\n\nimport type { Expression } from './expression.js';\n\nfunction isFeatureConstant(e: Expression) {\n    if (e instanceof CompoundExpression) {\n        if (e.name === 'get' && e.args.length === 1) {\n            return false;\n        } else if (e.name === 'has' && e.args.length === 1) {\n            return false;\n        } else if (\n            e.name === 'properties' ||\n            e.name === 'geometry-type' ||\n            e.name === 'id'\n        ) {\n            return false;\n        } else if (/^filter-/.test(e.name)) {\n            return false;\n        }\n    }\n\n    let result = true;\n    e.eachChild(arg => {\n        if (result && !isFeatureConstant(arg)) { result = false; }\n    });\n    return result;\n}\n\nfunction isGlobalPropertyConstant(e: Expression, properties: Array<string>) {\n    if (e instanceof CompoundExpression && properties.indexOf(e.name) >= 0) { return false; }\n    let result = true;\n    e.eachChild((arg) => {\n        if (result && !isGlobalPropertyConstant(arg, properties)) { result = false; }\n    });\n    return result;\n}\n\nexport { isFeatureConstant, isGlobalPropertyConstant };\n","// @flow\n\nimport Scope from './scope';\n\nimport { checkSubtype } from './types';\nimport ParsingError from './parsing_error';\nimport Literal from './definitions/literal';\nimport Assertion from './definitions/assertion';\nimport ArrayAssertion from './definitions/array';\nimport Coercion from './definitions/coercion';\nimport EvaluationContext from './evaluation_context';\nimport CompoundExpression from './compound_expression';\nimport { CollatorExpression } from './definitions/collator';\nimport {isGlobalPropertyConstant, isFeatureConstant} from './is_constant';\nimport Var from './definitions/var';\n\n\nimport type {Expression, ExpressionRegistry} from './expression';\nimport type {Type} from './types';\n\n/**\n * State associated parsing at a given point in an expression tree.\n * @private\n */\nclass ParsingContext {\n    registry: ExpressionRegistry;\n    path: Array<number>;\n    key: string;\n    scope: Scope;\n    errors: Array<ParsingError>;\n\n    // The expected type of this expression. Provided only to allow Expression\n    // implementations to infer argument types: Expression#parse() need not\n    // check that the output type of the parsed expression matches\n    // `expectedType`.\n    expectedType: ?Type;\n\n    constructor(\n        registry: ExpressionRegistry,\n        path: Array<number> = [],\n        expectedType: ?Type,\n        scope: Scope = new Scope(),\n        errors: Array<ParsingError> = []\n    ) {\n        this.registry = registry;\n        this.path = path;\n        this.key = path.map(part => `[${part}]`).join('');\n        this.scope = scope;\n        this.errors = errors;\n        this.expectedType = expectedType;\n    }\n\n    /**\n     * @param expr the JSON expression to parse\n     * @param index the optional argument index if this expression is an argument of a parent expression that's being parsed\n     * @param options\n     * @param options.omitTypeAnnotations set true to omit inferred type annotations.  Caller beware: with this option set, the parsed expression's type will NOT satisfy `expectedType` if it would normally be wrapped in an inferred annotation.\n     * @private\n     */\n    parse(\n        expr: mixed,\n        index?: number,\n        expectedType?: ?Type,\n        bindings?: Array<[string, Expression]>,\n        options: {omitTypeAnnotations?: boolean} = {}\n    ): ?Expression {\n        if (index) {\n            return this.concat(index, expectedType, bindings)._parse(expr, options);\n        }\n        return this._parse(expr, options);\n    }\n\n    _parse(expr: mixed, options: {omitTypeAnnotations?: boolean}): ?Expression {\n\n        if (expr === null || typeof expr === 'string' || typeof expr === 'boolean' || typeof expr === 'number') {\n            expr = ['literal', expr];\n        }\n\n        if (Array.isArray(expr)) {\n            if (expr.length === 0) {\n                return this.error(`Expected an array with at least one element. If you wanted a literal array, use [\"literal\", []].`);\n            }\n\n            const op = expr[0];\n            if (typeof op !== 'string') {\n                this.error(`Expression name must be a string, but found ${typeof op} instead. If you wanted a literal array, use [\"literal\", [...]].`, 0);\n                return null;\n            }\n\n            const Expr = this.registry[op];\n            if (Expr) {\n                let parsed = Expr.parse(expr, this);\n                if (!parsed) return null;\n\n                if (this.expectedType) {\n                    const expected = this.expectedType;\n                    const actual = parsed.type;\n\n                    // When we expect a number, string, boolean, or array but\n                    // have a Value, we can wrap it in a refining assertion.\n                    // When we expect a Color but have a String or Value, we\n                    // can wrap it in \"to-color\" coercion.\n                    // Otherwise, we do static type-checking.\n                    if ((expected.kind === 'string' || expected.kind === 'number' || expected.kind === 'boolean' || expected.kind === 'object') && actual.kind === 'value') {\n                        if (!options.omitTypeAnnotations) {\n                            parsed = new Assertion(expected, [parsed]);\n                        }\n                    } else if (expected.kind === 'array' && actual.kind === 'value') {\n                        if (!options.omitTypeAnnotations) {\n                            parsed = new ArrayAssertion(expected, parsed);\n                        }\n                    } else if (expected.kind === 'color' && (actual.kind === 'value' || actual.kind === 'string')) {\n                        if (!options.omitTypeAnnotations) {\n                            parsed = new Coercion(expected, [parsed]);\n                        }\n                    } else if (this.checkSubtype(this.expectedType, parsed.type)) {\n                        return null;\n                    }\n                }\n\n                // If an expression's arguments are all literals, we can evaluate\n                // it immediately and replace it with a literal value in the\n                // parsed/compiled result.\n                if (!(parsed instanceof Literal) && isConstant(parsed)) {\n                    const ec = new EvaluationContext();\n                    try {\n                        parsed = new Literal(parsed.type, parsed.evaluate(ec));\n                    } catch (e) {\n                        this.error(e.message);\n                        return null;\n                    }\n                }\n\n                return parsed;\n            }\n\n            return this.error(`Unknown expression \"${op}\". If you wanted a literal array, use [\"literal\", [...]].`, 0);\n        } else if (typeof expr === 'undefined') {\n            return this.error(`'undefined' value invalid. Use null instead.`);\n        } else if (typeof expr === 'object') {\n            return this.error(`Bare objects invalid. Use [\"literal\", {...}] instead.`);\n        } else {\n            return this.error(`Expected an array, but found ${typeof expr} instead.`);\n        }\n    }\n\n    /**\n     * Returns a copy of this context suitable for parsing the subexpression at\n     * index `index`, optionally appending to 'let' binding map.\n     *\n     * Note that `errors` property, intended for collecting errors while\n     * parsing, is copied by reference rather than cloned.\n     * @private\n     */\n    concat(index: number, expectedType?: ?Type, bindings?: Array<[string, Expression]>) {\n        const path = typeof index === 'number' ? this.path.concat(index) : this.path;\n        const scope = bindings ? this.scope.concat(bindings) : this.scope;\n        return new ParsingContext(\n            this.registry,\n            path,\n            expectedType || null,\n            scope,\n            this.errors\n        );\n    }\n\n    /**\n     * Push a parsing (or type checking) error into the `this.errors`\n     * @param error The message\n     * @param keys Optionally specify the source of the error at a child\n     * of the current expression at `this.key`.\n     * @private\n     */\n    error(error: string, ...keys: Array<number>) {\n        const key = `${this.key}${keys.map(k => `[${k}]`).join('')}`;\n        this.errors.push(new ParsingError(key, error));\n    }\n\n    /**\n     * Returns null if `t` is a subtype of `expected`; otherwise returns an\n     * error message and also pushes it to `this.errors`.\n     */\n    checkSubtype(expected: Type, t: Type): ?string {\n        const error = checkSubtype(expected, t);\n        if (error) this.error(error);\n        return error;\n    }\n}\n\nexport default ParsingContext;\n\nfunction isConstant(expression: Expression) {\n    if (expression instanceof Var) {\n        return isConstant(expression.boundExpression);\n    } else if (expression instanceof CompoundExpression && expression.name === 'error') {\n        return false;\n    } else if (expression instanceof CollatorExpression) {\n        // Although the results of a Collator expression with fixed arguments\n        // generally shouldn't change between executions, we can't serialize them\n        // as constant expressions because results change based on environment.\n        return false;\n    }\n\n    const isTypeAnnotation = expression instanceof Coercion ||\n        expression instanceof Assertion ||\n        expression instanceof ArrayAssertion;\n\n    let childrenConstant = true;\n    expression.eachChild(child => {\n        // We can _almost_ assume that if `expressions` children are constant,\n        // they would already have been evaluated to Literal values when they\n        // were parsed.  Type annotations are the exception, because they might\n        // have been inferred and added after a child was parsed.\n\n        // So we recurse into isConstant() for the children of type annotations,\n        // but otherwise simply check whether they are Literals.\n        if (isTypeAnnotation) {\n            childrenConstant = childrenConstant && isConstant(child);\n        } else {\n            childrenConstant = childrenConstant && child instanceof Literal;\n        }\n    });\n    if (!childrenConstant) {\n        return false;\n    }\n\n    return isFeatureConstant(expression) &&\n        isGlobalPropertyConstant(expression, ['zoom', 'heatmap-density', 'line-progress', 'is-supported-script']);\n}\n","// @flow\n\nclass ParsingError extends Error {\n    key: string;\n    message: string;\n    constructor(key: string, message: string) {\n        super(message);\n        this.message = message;\n        this.key = key;\n    }\n}\n\nexport default ParsingError;\n","// @flow\n\nclass RuntimeError {\n    name: string;\n    message: string;\n\n    constructor(message: string) {\n        this.name = 'ExpressionEvaluationError';\n        this.message = message;\n    }\n\n    toJSON() {\n        return this.message;\n    }\n}\n\nexport default RuntimeError;\n","// @flow\n\nimport type {Expression} from './expression';\n\n/**\n * Tracks `let` bindings during expression parsing.\n * @private\n */\nclass Scope {\n    parent: ?Scope;\n    bindings: {[string]: Expression};\n    constructor(parent?: Scope, bindings: Array<[string, Expression]> = []) {\n        this.parent = parent;\n        this.bindings = {};\n        for (const [name, expression] of bindings) {\n            this.bindings[name] = expression;\n        }\n    }\n\n    concat(bindings: Array<[string, Expression]>) {\n        return new Scope(this, bindings);\n    }\n\n    get(name: string): Expression {\n        if (this.bindings[name]) { return this.bindings[name]; }\n        if (this.parent) { return this.parent.get(name); }\n        throw new Error(`${name} not found in scope.`);\n    }\n\n    has(name: string): boolean {\n        if (this.bindings[name]) return true;\n        return this.parent ? this.parent.has(name) : false;\n    }\n}\n\nexport default Scope;\n","// @flow\n\nimport RuntimeError from './runtime_error';\n\nimport type { Expression } from './expression';\n\nexport type Stops = Array<[number, Expression]>;\n\n/**\n * Returns the index of the last stop <= input, or 0 if it doesn't exist.\n * @private\n */\nexport function findStopLessThanOrEqualTo(stops: Array<number>, input: number) {\n    const n = stops.length;\n    let lowerIndex = 0;\n    let upperIndex = n - 1;\n    let currentIndex = 0;\n    let currentValue, upperValue;\n\n    while (lowerIndex <= upperIndex) {\n        currentIndex = Math.floor((lowerIndex + upperIndex) / 2);\n        currentValue = stops[currentIndex];\n        upperValue = stops[currentIndex + 1];\n        if (input === currentValue || input > currentValue && input < upperValue) { // Search complete\n            return currentIndex;\n        } else if (currentValue < input) {\n            lowerIndex = currentIndex + 1;\n        } else if (currentValue > input) {\n            upperIndex = currentIndex - 1;\n        } else {\n            throw new RuntimeError('Input is not a number.');\n        }\n    }\n\n    return Math.max(currentIndex - 1, 0);\n}\n","// @flow\n\nexport type NullTypeT = { kind: 'null' };\nexport type NumberTypeT = { kind: 'number' };\nexport type StringTypeT = { kind: 'string' };\nexport type BooleanTypeT = { kind: 'boolean' };\nexport type ColorTypeT = { kind: 'color' };\nexport type ObjectTypeT = { kind: 'object' };\nexport type ValueTypeT = { kind: 'value' };\nexport type ErrorTypeT = { kind: 'error' };\nexport type CollatorTypeT = { kind: 'collator' };\n\nexport type Type =\n    NullTypeT |\n    NumberTypeT |\n    StringTypeT |\n    BooleanTypeT |\n    ColorTypeT |\n    ObjectTypeT |\n    ValueTypeT |\n    ArrayType | // eslint-disable-line no-use-before-define\n    ErrorTypeT |\n    CollatorTypeT\n\nexport type ArrayType = {\n    kind: 'array',\n    itemType: Type,\n    N: ?number\n}\n\nexport const NullType = { kind: 'null' };\nexport const NumberType = { kind: 'number' };\nexport const StringType = { kind: 'string' };\nexport const BooleanType = { kind: 'boolean' };\nexport const ColorType = { kind: 'color' };\nexport const ObjectType = { kind: 'object' };\nexport const ValueType = { kind: 'value' };\nexport const ErrorType = { kind: 'error' };\nexport const CollatorType = { kind: 'collator' };\n\nexport function array(itemType: Type, N: ?number): ArrayType {\n    return {\n        kind: 'array',\n        itemType,\n        N\n    };\n}\n\nexport function toString(type: Type): string {\n    if (type.kind === 'array') {\n        const itemType = toString(type.itemType);\n        return typeof type.N === 'number' ?\n            `array<${itemType}, ${type.N}>` :\n            type.itemType.kind === 'value' ? 'array' : `array<${itemType}>`;\n    } else {\n        return type.kind;\n    }\n}\n\nconst valueMemberTypes = [\n    NullType,\n    NumberType,\n    StringType,\n    BooleanType,\n    ColorType,\n    ObjectType,\n    array(ValueType)\n];\n\n/**\n * Returns null if `t` is a subtype of `expected`; otherwise returns an\n * error message.\n * @private\n */\nexport function checkSubtype(expected: Type, t: Type): ?string {\n    if (t.kind === 'error') {\n        // Error is a subtype of every type\n        return null;\n    } else if (expected.kind === 'array') {\n        if (t.kind === 'array' &&\n            !checkSubtype(expected.itemType, t.itemType) &&\n            (typeof expected.N !== 'number' || expected.N === t.N)) {\n            return null;\n        }\n    } else if (expected.kind === t.kind) {\n        return null;\n    } else if (expected.kind === 'value') {\n        for (const memberType of valueMemberTypes) {\n            if (!checkSubtype(memberType, t)) {\n                return null;\n            }\n        }\n    }\n\n    return `Expected ${toString(expected)} but found ${toString(t)} instead.`;\n}\n","// @flow\n\nimport assert from 'assert';\n\nimport Color from '../util/color';\nimport { Collator } from './definitions/collator';\nimport { NullType, NumberType, StringType, BooleanType, ColorType, ObjectType, ValueType, CollatorType, array } from './types';\n\nimport type { Type } from './types';\n\nexport function validateRGBA(r: mixed, g: mixed, b: mixed, a?: mixed): ?string {\n    if (!(\n        typeof r === 'number' && r >= 0 && r <= 255 &&\n        typeof g === 'number' && g >= 0 && g <= 255 &&\n        typeof b === 'number' && b >= 0 && b <= 255\n    )) {\n        const value = typeof a === 'number' ? [r, g, b, a] : [r, g, b];\n        return `Invalid rgba value [${value.join(', ')}]: 'r', 'g', and 'b' must be between 0 and 255.`;\n    }\n\n    if (!(\n        typeof a === 'undefined' || (typeof a === 'number' && a >= 0 && a <= 1)\n    )) {\n        return `Invalid rgba value [${[r, g, b, a].join(', ')}]: 'a' must be between 0 and 1.`;\n    }\n\n    return null;\n}\n\nexport type Value = null | string | boolean | number | Color | Collator | $ReadOnlyArray<Value> | { +[string]: Value }\n\nexport function isValue(mixed: mixed): boolean {\n    if (mixed === null) {\n        return true;\n    } else if (typeof mixed === 'string') {\n        return true;\n    } else if (typeof mixed === 'boolean') {\n        return true;\n    } else if (typeof mixed === 'number') {\n        return true;\n    } else if (mixed instanceof Color) {\n        return true;\n    } else if (mixed instanceof Collator) {\n        return true;\n    } else if (Array.isArray(mixed)) {\n        for (const item of mixed) {\n            if (!isValue(item)) {\n                return false;\n            }\n        }\n        return true;\n    } else if (typeof mixed === 'object') {\n        for (const key in mixed) {\n            if (!isValue(mixed[key])) {\n                return false;\n            }\n        }\n        return true;\n    } else {\n        return false;\n    }\n}\n\nexport function typeOf(value: Value): Type {\n    if (value === null) {\n        return NullType;\n    } else if (typeof value === 'string') {\n        return StringType;\n    } else if (typeof value === 'boolean') {\n        return BooleanType;\n    } else if (typeof value === 'number') {\n        return NumberType;\n    } else if (value instanceof Color) {\n        return ColorType;\n    } else if (value instanceof Collator) {\n        return CollatorType;\n    } else if (Array.isArray(value)) {\n        const length = value.length;\n        let itemType: ?Type;\n\n        for (const item of value) {\n            const t = typeOf(item);\n            if (!itemType) {\n                itemType = t;\n            } else if (itemType === t) {\n                continue;\n            } else {\n                itemType = ValueType;\n                break;\n            }\n        }\n\n        return array(itemType || ValueType, length);\n    } else {\n        assert(typeof value === 'object');\n        return ObjectType;\n    }\n}\n\nexport { Color, Collator };\n","// @flow\n\nimport { createExpression } from '../expression';\n\nimport type {GlobalProperties} from '../expression';\nexport type FeatureFilter = (globalProperties: GlobalProperties, feature: VectorTileFeature) => boolean;\n\nexport default createFilter;\nexport { isExpressionFilter };\n\nfunction isExpressionFilter(filter: any) {\n    if (!Array.isArray(filter) || filter.length === 0) {\n        return false;\n    }\n    switch (filter[0]) {\n    case 'has':\n        return filter.length >= 2 && filter[1] !== '$id' && filter[1] !== '$type';\n\n    case 'in':\n    case '!in':\n    case '!has':\n    case 'none':\n        return false;\n\n    case '==':\n    case '!=':\n    case '>':\n    case '>=':\n    case '<':\n    case '<=':\n        return filter.length === 3 && (Array.isArray(filter[1]) || Array.isArray(filter[2]));\n\n    case 'any':\n    case 'all':\n        for (const f of filter.slice(1)) {\n            if (!isExpressionFilter(f) && typeof f !== 'boolean') {\n                return false;\n            }\n        }\n        return true;\n\n    default:\n        return true;\n    }\n}\n\nconst filterSpec = {\n    'type': 'boolean',\n    'default': false,\n    'function': true,\n    'property-function': true,\n    'zoom-function': true\n};\n\n/**\n * Given a filter expressed as nested arrays, return a new function\n * that evaluates whether a given feature (with a .properties or .tags property)\n * passes its test.\n *\n * @private\n * @param {Array} filter mapbox gl filter\n * @returns {Function} filter-evaluating function\n */\nfunction createFilter(filter: any): FeatureFilter {\n    if (!filter) {\n        return () => true;\n    }\n\n    if (!isExpressionFilter(filter)) {\n        filter = convertFilter(filter);\n    }\n\n    const compiled = createExpression(filter, filterSpec);\n    if (compiled.result === 'error') {\n        throw new Error(compiled.value.map(err => `${err.key}: ${err.message}`).join(', '));\n    } else {\n        return (globalProperties: GlobalProperties, feature: VectorTileFeature) => compiled.value.evaluate(globalProperties, feature);\n    }\n}\n\n// Comparison function to sort numbers and strings\nfunction compare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nfunction convertFilter(filter: ?Array<any>): mixed {\n    if (!filter) return true;\n    const op = filter[0];\n    if (filter.length <= 1) return (op !== 'any');\n    const converted =\n        op === '==' ? convertComparisonOp(filter[1], filter[2], '==') :\n        op === '!=' ? convertNegation(convertComparisonOp(filter[1], filter[2], '==')) :\n        op === '<' ||\n        op === '>' ||\n        op === '<=' ||\n        op === '>=' ? convertComparisonOp(filter[1], filter[2], op) :\n        op === 'any' ? convertDisjunctionOp(filter.slice(1)) :\n        op === 'all' ? ['all'].concat(filter.slice(1).map(convertFilter)) :\n        op === 'none' ? ['all'].concat(filter.slice(1).map(convertFilter).map(convertNegation)) :\n        op === 'in' ? convertInOp(filter[1], filter.slice(2)) :\n        op === '!in' ? convertNegation(convertInOp(filter[1], filter.slice(2))) :\n        op === 'has' ? convertHasOp(filter[1]) :\n        op === '!has' ? convertNegation(convertHasOp(filter[1])) :\n        true;\n    return converted;\n}\n\nfunction convertComparisonOp(property: string, value: any, op: string) {\n    switch (property) {\n    case '$type':\n        return [`filter-type-${op}`, value];\n    case '$id':\n        return [`filter-id-${op}`, value];\n    default:\n        return [`filter-${op}`, property, value];\n    }\n}\n\nfunction convertDisjunctionOp(filters: Array<Array<any>>) {\n    return ['any'].concat(filters.map(convertFilter));\n}\n\nfunction convertInOp(property: string, values: Array<any>) {\n    if (values.length === 0) { return false; }\n    switch (property) {\n    case '$type':\n        return [`filter-type-in`, ['literal', values]];\n    case '$id':\n        return [`filter-id-in`, ['literal', values]];\n    default:\n        if (values.length > 200 && !values.some(v => typeof v !== typeof values[0])) {\n            return ['filter-in-large', property, ['literal', values.sort(compare)]];\n        } else {\n            return ['filter-in-small', property, ['literal', values]];\n        }\n    }\n}\n\nfunction convertHasOp(property: string) {\n    switch (property) {\n    case '$type':\n        return true;\n    case '$id':\n        return [`filter-has-id`];\n    default:\n        return [`filter-has`, property];\n    }\n}\n\nfunction convertNegation(filter: mixed) {\n    return ['!', filter];\n}\n\n","// @flow\n\nimport assert from 'assert';\n\nimport extend from '../util/extend';\n\nimport type {StylePropertySpecification} from '../style-spec';\n\nexport default convertFunction;\n\nfunction convertFunction(parameters: PropertyValueSpecification<any>, propertySpec: StylePropertySpecification) {\n    let expression;\n\n    parameters = extend({}, parameters);\n    let defaultExpression;\n    if (typeof parameters.default !== 'undefined') {\n        defaultExpression = convertValue(parameters.default, propertySpec);\n    } else {\n        defaultExpression = convertValue(propertySpec.default, propertySpec);\n        if (defaultExpression === null) {\n            defaultExpression = ['error', 'No default property value available.'];\n        }\n    }\n\n    if (parameters.stops) {\n        const zoomAndFeatureDependent = parameters.stops && typeof parameters.stops[0][0] === 'object';\n        const featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\n        const zoomDependent = zoomAndFeatureDependent || !featureDependent;\n\n        const stops = parameters.stops.map((stop) => {\n            if (!featureDependent && propertySpec.tokens && typeof stop[1] === 'string') {\n                return [stop[0], convertTokenString(stop[1])];\n\n            }\n            return [stop[0], convertValue(stop[1], propertySpec)];\n        });\n\n        if (parameters.colorSpace && parameters.colorSpace !== 'rgb') {\n            throw new Error('Unimplemented');\n        }\n\n        if (zoomAndFeatureDependent) {\n            expression = convertZoomAndPropertyFunction(parameters, propertySpec, stops, defaultExpression);\n        } else if (zoomDependent) {\n            expression = convertZoomFunction(parameters, propertySpec, stops);\n        } else {\n            expression = convertPropertyFunction(parameters, propertySpec, stops, defaultExpression);\n        }\n    } else {\n        // identity function\n        expression = convertIdentityFunction(parameters, propertySpec, defaultExpression);\n    }\n\n    return expression;\n}\n\nfunction convertIdentityFunction(parameters, propertySpec, defaultExpression) {\n    const get = ['get', parameters.property];\n\n    if (propertySpec.type === 'color') {\n        return parameters.default === undefined ? get : ['to-color', get, parameters.default];\n    } else if (propertySpec.type === 'array' && typeof propertySpec.length === 'number') {\n        return ['array', propertySpec.value, propertySpec.length, get];\n    } else if (propertySpec.type === 'array') {\n        return ['array', propertySpec.value, get];\n    } else if (propertySpec.type === 'enum') {\n        return [\n            'let',\n            'property_value', ['string', get],\n            [\n                'match',\n                ['var', 'property_value'],\n                Object.keys(propertySpec.values), ['var', 'property_value'],\n                defaultExpression\n            ]\n        ];\n    } else {\n        return parameters.default === undefined ? get : [propertySpec.type, get, parameters.default];\n    }\n}\n\nfunction convertValue(value, spec) {\n    if (typeof value === 'undefined' || value === null) return null;\n    if (spec.type === 'color') {\n        return value;\n    } else if (spec.type === 'array') {\n        return ['literal', value];\n    } else {\n        return value;\n    }\n}\n\nfunction convertZoomAndPropertyFunction(parameters, propertySpec, stops, defaultExpression) {\n    const featureFunctionParameters = {};\n    const featureFunctionStops = {};\n    const zoomStops = [];\n    for (let s = 0; s < stops.length; s++) {\n        const stop = stops[s];\n        const zoom = stop[0].zoom;\n        if (featureFunctionParameters[zoom] === undefined) {\n            featureFunctionParameters[zoom] = {\n                zoom: zoom,\n                type: parameters.type,\n                property: parameters.property,\n                default: parameters.default,\n            };\n            featureFunctionStops[zoom] = [];\n            zoomStops.push(zoom);\n        }\n        featureFunctionStops[zoom].push([stop[0].value, stop[1]]);\n    }\n\n    // the interpolation type for the zoom dimension of a zoom-and-property\n    // function is determined directly from the style property specification\n    // for which it's being used: linear for interpolatable properties, step\n    // otherwise.\n    const functionType = getFunctionType({}, propertySpec);\n    if (functionType === 'exponential') {\n        const expression = ['interpolate', ['linear'], ['zoom']];\n\n        for (const z of zoomStops) {\n            const output = convertPropertyFunction(featureFunctionParameters[z], propertySpec, featureFunctionStops[z], defaultExpression);\n            appendStopPair(expression, z, output, false);\n        }\n\n        return expression;\n    } else {\n        const expression = ['step', ['zoom']];\n\n        for (const z of zoomStops) {\n            const output = convertPropertyFunction(featureFunctionParameters[z], propertySpec, featureFunctionStops[z], defaultExpression);\n            appendStopPair(expression, z, output, true);\n        }\n\n        fixupDegenerateStepCurve(expression);\n\n        return expression;\n    }\n}\n\nfunction convertPropertyFunction(parameters, propertySpec, stops, defaultExpression) {\n    const type = getFunctionType(parameters, propertySpec);\n\n    const inputType = typeof stops[0][0];\n    assert(\n        inputType === 'string' ||\n        inputType === 'number' ||\n        inputType === 'boolean'\n    );\n\n    let input = [inputType, ['get', parameters.property]];\n\n    let expression;\n    let isStep = false;\n    if (type === 'categorical' && inputType === 'boolean') {\n        assert(parameters.stops.length > 0 && parameters.stops.length <= 2);\n        if (parameters.stops[0][0] === false) {\n            input = ['!', input];\n        }\n        expression = [ 'case', input, parameters.stops[0][1] ];\n        if (parameters.stops.length > 1) {\n            expression.push(parameters.stops[1][1]);\n        } else {\n            expression.push(defaultExpression);\n        }\n        return expression;\n    } else if (type === 'categorical') {\n        expression = ['match', input];\n    } else if (type === 'interval') {\n        expression = ['step', input];\n        isStep = true;\n    } else if (type === 'exponential') {\n        const base = parameters.base !== undefined ? parameters.base : 1;\n        expression = ['interpolate', ['exponential', base], input];\n    } else {\n        throw new Error(`Unknown property function type ${type}`);\n    }\n\n    for (const stop of stops) {\n        appendStopPair(expression, stop[0], stop[1], isStep);\n    }\n\n    if (expression[0] === 'match') {\n        expression.push(defaultExpression);\n    }\n\n    fixupDegenerateStepCurve(expression);\n\n    return expression;\n}\n\nfunction convertZoomFunction(parameters, propertySpec, stops, input = ['zoom']) {\n    const type = getFunctionType(parameters, propertySpec);\n    let expression;\n    let isStep = false;\n    if (type === 'interval') {\n        expression = ['step', input];\n        isStep = true;\n    } else if (type === 'exponential') {\n        const base = parameters.base !== undefined ? parameters.base : 1;\n        expression = ['interpolate', ['exponential', base], input];\n    } else {\n        throw new Error(`Unknown zoom function type \"${type}\"`);\n    }\n\n    for (const stop of stops) {\n        appendStopPair(expression, stop[0], stop[1], isStep);\n    }\n\n    fixupDegenerateStepCurve(expression);\n\n    return expression;\n}\n\nfunction fixupDegenerateStepCurve(expression) {\n    // degenerate step curve (i.e. a constant function): add a noop stop\n    if (expression[0] === 'step' && expression.length === 3) {\n        expression.push(0);\n        expression.push(expression[3]);\n    }\n}\n\nfunction appendStopPair(curve, input, output, isStep) {\n    // Skip duplicate stop values. They were not validated for functions, but they are for expressions.\n    // https://github.com/mapbox/mapbox-gl-js/issues/4107\n    if (curve.length > 3 && input === curve[curve.length - 2]) {\n        return;\n    }\n    // step curves don't get the first input value, as it is redundant.\n    if (!(isStep && curve.length === 2)) {\n        curve.push(input);\n    }\n    curve.push(output);\n}\n\nfunction getFunctionType(parameters, propertySpec) {\n    if (parameters.type) {\n        return parameters.type;\n    } else if (propertySpec.function) {\n        return propertySpec.function === 'interpolated' ? 'exponential' : 'interval';\n    } else {\n        return 'exponential';\n    }\n}\n\n// \"String with {name} token\" => [\"concat\", \"String with \", [\"get\", \"name\"], \" token\"]\nfunction convertTokenString(s) {\n    const result = ['concat'];\n    const re = /{([^{}]+)}/g;\n    let pos = 0;\n    let match;\n    while ((match = re.exec(s)) !== null) {\n        const literal = s.slice(pos, re.lastIndex - match[0].length);\n        pos = re.lastIndex;\n        if (literal.length > 0) result.push(literal);\n        result.push(['to-string', ['get', match[1]]]);\n    }\n\n    if (result.length === 1) {\n        return s;\n    }\n\n    if (pos < s.length) {\n        result.push(s.slice(pos));\n    } else if (result.length === 2) {\n        return result[1];\n    }\n\n    return result;\n}\n\n","\nimport * as colorSpaces from '../util/color_spaces';\nimport Color from '../util/color';\nimport extend from '../util/extend';\nimport getType from '../util/get_type';\nimport * as interpolate from '../util/interpolate';\nimport Interpolate from '../expression/definitions/interpolate';\n\nexport function isFunction(value) {\n    return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\n\nfunction identityFunction(x) {\n    return x;\n}\n\nexport function createFunction(parameters, propertySpec) {\n    const isColor = propertySpec.type === 'color';\n    const zoomAndFeatureDependent = parameters.stops && typeof parameters.stops[0][0] === 'object';\n    const featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\n    const zoomDependent = zoomAndFeatureDependent || !featureDependent;\n    const type = parameters.type || (propertySpec.function === 'interpolated' ? 'exponential' : 'interval');\n\n    if (isColor) {\n        parameters = extend({}, parameters);\n\n        if (parameters.stops) {\n            parameters.stops = parameters.stops.map((stop) => {\n                return [stop[0], Color.parse(stop[1])];\n            });\n        }\n\n        if (parameters.default) {\n            parameters.default = Color.parse(parameters.default);\n        } else {\n            parameters.default = Color.parse(propertySpec.default);\n        }\n    }\n\n    if (parameters.colorSpace && parameters.colorSpace !== 'rgb' && !colorSpaces[parameters.colorSpace]) { // eslint-disable-line import/namespace\n        throw new Error(`Unknown color space: ${parameters.colorSpace}`);\n    }\n\n    let innerFun;\n    let hashedStops;\n    let categoricalKeyType;\n    if (type === 'exponential') {\n        innerFun = evaluateExponentialFunction;\n    } else if (type === 'interval') {\n        innerFun = evaluateIntervalFunction;\n    } else if (type === 'categorical') {\n        innerFun = evaluateCategoricalFunction;\n\n        // For categorical functions, generate an Object as a hashmap of the stops for fast searching\n        hashedStops = Object.create(null);\n        for (const stop of parameters.stops) {\n            hashedStops[stop[0]] = stop[1];\n        }\n\n        // Infer key type based on first stop key-- used to encforce strict type checking later\n        categoricalKeyType = typeof parameters.stops[0][0];\n\n    } else if (type === 'identity') {\n        innerFun = evaluateIdentityFunction;\n    } else {\n        throw new Error(`Unknown function type \"${type}\"`);\n    }\n\n    if (zoomAndFeatureDependent) {\n        const featureFunctions = {};\n        const zoomStops = [];\n        for (let s = 0; s < parameters.stops.length; s++) {\n            const stop = parameters.stops[s];\n            const zoom = stop[0].zoom;\n            if (featureFunctions[zoom] === undefined) {\n                featureFunctions[zoom] = {\n                    zoom: zoom,\n                    type: parameters.type,\n                    property: parameters.property,\n                    default: parameters.default,\n                    stops: []\n                };\n                zoomStops.push(zoom);\n            }\n            featureFunctions[zoom].stops.push([stop[0].value, stop[1]]);\n        }\n\n        const featureFunctionStops = [];\n        for (const z of zoomStops) {\n            featureFunctionStops.push([featureFunctions[z].zoom, createFunction(featureFunctions[z], propertySpec)]);\n        }\n\n        return {\n            kind: 'composite',\n            interpolationFactor: Interpolate.interpolationFactor.bind(undefined, {name: 'linear'}),\n            zoomStops: featureFunctionStops.map(s => s[0]),\n            evaluate({zoom}, properties) {\n                return evaluateExponentialFunction({\n                    stops: featureFunctionStops,\n                    base: parameters.base\n                }, propertySpec, zoom).evaluate(zoom, properties);\n            }\n        };\n    } else if (zoomDependent) {\n        return {\n            kind: 'camera',\n            interpolationFactor: type === 'exponential' ?\n                Interpolate.interpolationFactor.bind(undefined, {name: 'exponential', base: parameters.base !== undefined ? parameters.base : 1}) :\n                () => 0,\n            zoomStops: parameters.stops.map(s => s[0]),\n            evaluate: ({zoom}) => innerFun(parameters, propertySpec, zoom, hashedStops, categoricalKeyType)\n        };\n    } else {\n        return {\n            kind: 'source',\n            evaluate(_, feature) {\n                const value = feature && feature.properties ? feature.properties[parameters.property] : undefined;\n                if (value === undefined) {\n                    return coalesce(parameters.default, propertySpec.default);\n                }\n                return innerFun(parameters, propertySpec, value, hashedStops, categoricalKeyType);\n            }\n        };\n    }\n}\n\nfunction coalesce(a, b, c) {\n    if (a !== undefined) return a;\n    if (b !== undefined) return b;\n    if (c !== undefined) return c;\n}\n\nfunction evaluateCategoricalFunction(parameters, propertySpec, input, hashedStops, keyType) {\n    const evaluated = typeof input === keyType ? hashedStops[input] : undefined; // Enforce strict typing on input\n    return coalesce(evaluated, parameters.default, propertySpec.default);\n}\n\nfunction evaluateIntervalFunction(parameters, propertySpec, input) {\n    // Edge cases\n    if (getType(input) !== 'number') return coalesce(parameters.default, propertySpec.default);\n    const n = parameters.stops.length;\n    if (n === 1) return parameters.stops[0][1];\n    if (input <= parameters.stops[0][0]) return parameters.stops[0][1];\n    if (input >= parameters.stops[n - 1][0]) return parameters.stops[n - 1][1];\n\n    const index = findStopLessThanOrEqualTo(parameters.stops, input);\n\n    return parameters.stops[index][1];\n}\n\nfunction evaluateExponentialFunction(parameters, propertySpec, input) {\n    const base = parameters.base !== undefined ? parameters.base : 1;\n\n    // Edge cases\n    if (getType(input) !== 'number') return coalesce(parameters.default, propertySpec.default);\n    const n = parameters.stops.length;\n    if (n === 1) return parameters.stops[0][1];\n    if (input <= parameters.stops[0][0]) return parameters.stops[0][1];\n    if (input >= parameters.stops[n - 1][0]) return parameters.stops[n - 1][1];\n\n    const index = findStopLessThanOrEqualTo(parameters.stops, input);\n    const t = interpolationFactor(\n        input, base,\n        parameters.stops[index][0],\n        parameters.stops[index + 1][0]);\n\n    const outputLower = parameters.stops[index][1];\n    const outputUpper = parameters.stops[index + 1][1];\n    let interp = interpolate[propertySpec.type] || identityFunction; // eslint-disable-line import/namespace\n\n    if (parameters.colorSpace && parameters.colorSpace !== 'rgb') {\n        const colorspace = colorSpaces[parameters.colorSpace]; // eslint-disable-line import/namespace\n        interp = (a, b) => colorspace.reverse(colorspace.interpolate(colorspace.forward(a), colorspace.forward(b), t));\n    }\n\n    if (typeof outputLower.evaluate === 'function') {\n        return {\n            evaluate(...args) {\n                const evaluatedLower = outputLower.evaluate.apply(undefined, args);\n                const evaluatedUpper = outputUpper.evaluate.apply(undefined, args);\n                // Special case for fill-outline-color, which has no spec default.\n                if (evaluatedLower === undefined || evaluatedUpper === undefined) {\n                    return undefined;\n                }\n                return interp(evaluatedLower, evaluatedUpper, t);\n            }\n        };\n    }\n\n    return interp(outputLower, outputUpper, t);\n}\n\nfunction evaluateIdentityFunction(parameters, propertySpec, input) {\n    if (propertySpec.type === 'color') {\n        input = Color.parse(input);\n    } else if (getType(input) !== propertySpec.type && (propertySpec.type !== 'enum' || !propertySpec.values[input])) {\n        input = undefined;\n    }\n    return coalesce(input, parameters.default, propertySpec.default);\n}\n\n/**\n * Returns the index of the last stop <= input, or 0 if it doesn't exist.\n *\n * @private\n */\nfunction findStopLessThanOrEqualTo(stops, input) {\n    const n = stops.length;\n    let lowerIndex = 0;\n    let upperIndex = n - 1;\n    let currentIndex = 0;\n    let currentValue, upperValue;\n\n    while (lowerIndex <= upperIndex) {\n        currentIndex = Math.floor((lowerIndex + upperIndex) / 2);\n        currentValue = stops[currentIndex][0];\n        upperValue = stops[currentIndex + 1][0];\n        if (input === currentValue || input > currentValue && input < upperValue) { // Search complete\n            return currentIndex;\n        } else if (currentValue < input) {\n            lowerIndex = currentIndex + 1;\n        } else if (currentValue > input) {\n            upperIndex = currentIndex - 1;\n        }\n    }\n\n    return Math.max(currentIndex - 1, 0);\n}\n\n/**\n * Returns a ratio that can be used to interpolate between exponential function\n * stops.\n *\n * How it works:\n * Two consecutive stop values define a (scaled and shifted) exponential\n * function `f(x) = a * base^x + b`, where `base` is the user-specified base,\n * and `a` and `b` are constants affording sufficient degrees of freedom to fit\n * the function to the given stops.\n *\n * Here's a bit of algebra that lets us compute `f(x)` directly from the stop\n * values without explicitly solving for `a` and `b`:\n *\n * First stop value: `f(x0) = y0 = a * base^x0 + b`\n * Second stop value: `f(x1) = y1 = a * base^x1 + b`\n * => `y1 - y0 = a(base^x1 - base^x0)`\n * => `a = (y1 - y0)/(base^x1 - base^x0)`\n *\n * Desired value: `f(x) = y = a * base^x + b`\n * => `f(x) = y0 + a * (base^x - base^x0)`\n *\n * From the above, we can replace the `a` in `a * (base^x - base^x0)` and do a\n * little algebra:\n * ```\n * a * (base^x - base^x0) = (y1 - y0)/(base^x1 - base^x0) * (base^x - base^x0)\n *                     = (y1 - y0) * (base^x - base^x0) / (base^x1 - base^x0)\n * ```\n *\n * If we let `(base^x - base^x0) / (base^x1 base^x0)`, then we have\n * `f(x) = y0 + (y1 - y0) * ratio`.  In other words, `ratio` may be treated as\n * an interpolation factor between the two stops' output values.\n *\n * (Note: a slightly different form for `ratio`,\n * `(base^(x-x0) - 1) / (base^(x1-x0) - 1) `, is equivalent, but requires fewer\n * expensive `Math.pow()` operations.)\n *\n * @private\n */\nfunction interpolationFactor(input, base, lowerValue, upperValue) {\n    const difference = upperValue - lowerValue;\n    const progress = input - lowerValue;\n\n    if (difference === 0) {\n        return 0;\n    } else if (base === 1) {\n        return progress / difference;\n    } else {\n        return (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n    }\n}\n","\nimport spec from './v8.json';\nexport default spec;\n","// @flow\n\nimport { parseCSSColor } from 'csscolorparser';\n\n/**\n * An RGBA color value. Create instances from color strings using the static\n * method `Color.parse`. The constructor accepts RGB channel values in the range\n * `[0, 1]`, premultiplied by A.\n *\n * @param {number} r The red channel.\n * @param {number} g The green channel.\n * @param {number} b The blue channel.\n * @param {number} a The alpha channel.\n * @private\n */\nclass Color {\n    r: number;\n    g: number;\n    b: number;\n    a: number;\n\n    constructor(r: number, g: number, b: number, a: number = 1) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n        this.a = a;\n    }\n\n    static black: Color;\n    static white: Color;\n    static transparent: Color;\n\n    /**\n     * Parses valid CSS color strings and returns a `Color` instance.\n     * @returns A `Color` instance, or `undefined` if the input is not a valid color string.\n     */\n    static parse(input: ?string): Color | void {\n        if (!input) {\n            return undefined;\n        }\n\n        if (input instanceof Color) {\n            return input;\n        }\n\n        if (typeof input !== 'string') {\n            return undefined;\n        }\n\n        const rgba = parseCSSColor(input);\n        if (!rgba) {\n            return undefined;\n        }\n\n        return new Color(\n            rgba[0] / 255 * rgba[3],\n            rgba[1] / 255 * rgba[3],\n            rgba[2] / 255 * rgba[3],\n            rgba[3]\n        );\n    }\n\n    /**\n     * Returns an RGBA string representing the color value.\n     *\n     * @returns An RGBA string.\n     * @example\n     * var purple = new Color.parse('purple');\n     * purple.toString; // = \"rgba(128,0,128,1)\"\n     * var translucentGreen = new Color.parse('rgba(26, 207, 26, .73)');\n     * translucentGreen.toString(); // = \"rgba(26,207,26,0.73)\"\n     */\n    toString(): string {\n        const [r, g, b, a] = this.toArray();\n        return `rgba(${Math.round(r)},${Math.round(g)},${Math.round(b)},${a})`;\n    }\n\n    toArray(): [number, number, number, number] {\n        const {r, g, b, a} = this;\n        return a === 0 ? [0, 0, 0, 0] : [\n            r * 255 / a,\n            g * 255 / a,\n            b * 255 / a,\n            a\n        ];\n    }\n}\n\nColor.black = new Color(0, 0, 0, 1);\nColor.white = new Color(1, 1, 1, 1);\nColor.transparent = new Color(0, 0, 0, 0);\n\nexport default Color;\n","// @flow\n\nimport Color from './color';\n\nimport {number as interpolateNumber} from './interpolate';\n\ntype LABColor = {\n    l: number,\n    a: number,\n    b: number,\n    alpha: number\n};\n\ntype HCLColor = {\n    h: number,\n    c: number,\n    l: number,\n    alpha: number\n};\n\n// Constants\nconst Xn = 0.950470, // D65 standard referent\n    Yn = 1,\n    Zn = 1.088830,\n    t0 = 4 / 29,\n    t1 = 6 / 29,\n    t2 = 3 * t1 * t1,\n    t3 = t1 * t1 * t1,\n    deg2rad = Math.PI / 180,\n    rad2deg = 180 / Math.PI;\n\n// Utilities\nfunction xyz2lab(t) {\n    return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n    return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction xyz2rgb(x) {\n    return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nfunction rgb2xyz(x) {\n    x /= 255;\n    return x <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\n// LAB\nfunction rgbToLab(rgbColor: Color): LABColor {\n    const b = rgb2xyz(rgbColor.r),\n        a = rgb2xyz(rgbColor.g),\n        l = rgb2xyz(rgbColor.b),\n        x = xyz2lab((0.4124564 * b + 0.3575761 * a + 0.1804375 * l) / Xn),\n        y = xyz2lab((0.2126729 * b + 0.7151522 * a + 0.0721750 * l) / Yn),\n        z = xyz2lab((0.0193339 * b + 0.1191920 * a + 0.9503041 * l) / Zn);\n\n    return {\n        l: 116 * y - 16,\n        a: 500 * (x - y),\n        b: 200 * (y - z),\n        alpha: rgbColor.a\n    };\n}\n\nfunction labToRgb(labColor: LABColor): Color {\n    let y = (labColor.l + 16) / 116,\n        x = isNaN(labColor.a) ? y : y + labColor.a / 500,\n        z = isNaN(labColor.b) ? y : y - labColor.b / 200;\n    y = Yn * lab2xyz(y);\n    x = Xn * lab2xyz(x);\n    z = Zn * lab2xyz(z);\n    return new Color(\n        xyz2rgb(3.2404542 * x - 1.5371385 * y - 0.4985314 * z), // D65 -> sRGB\n        xyz2rgb(-0.9692660 * x + 1.8760108 * y + 0.0415560 * z),\n        xyz2rgb(0.0556434 * x - 0.2040259 * y + 1.0572252 * z),\n        labColor.alpha\n    );\n}\n\nfunction interpolateLab(from: LABColor, to: LABColor, t: number) {\n    return {\n        l: interpolateNumber(from.l, to.l, t),\n        a: interpolateNumber(from.a, to.a, t),\n        b: interpolateNumber(from.b, to.b, t),\n        alpha: interpolateNumber(from.alpha, to.alpha, t)\n    };\n}\n\n// HCL\nfunction rgbToHcl(rgbColor: Color): HCLColor {\n    const {l, a, b} = rgbToLab(rgbColor);\n    const h = Math.atan2(b, a) * rad2deg;\n    return {\n        h: h < 0 ? h + 360 : h,\n        c: Math.sqrt(a * a + b * b),\n        l: l,\n        alpha: rgbColor.a\n    };\n}\n\nfunction hclToRgb(hclColor: HCLColor): Color {\n    const h = hclColor.h * deg2rad,\n        c = hclColor.c,\n        l = hclColor.l;\n    return labToRgb({\n        l: l,\n        a: Math.cos(h) * c,\n        b: Math.sin(h) * c,\n        alpha: hclColor.alpha\n    });\n}\n\nfunction interpolateHue(a: number, b: number, t: number) {\n    const d = b - a;\n    return a + t * (d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d);\n}\n\nfunction interpolateHcl(from: HCLColor, to: HCLColor, t: number) {\n    return {\n        h: interpolateHue(from.h, to.h, t),\n        c: interpolateNumber(from.c, to.c, t),\n        l: interpolateNumber(from.l, to.l, t),\n        alpha: interpolateNumber(from.alpha, to.alpha, t)\n    };\n}\n\nexport const lab = {\n    forward: rgbToLab,\n    reverse: labToRgb,\n    interpolate: interpolateLab\n};\n\nexport const hcl = {\n    forward: rgbToHcl,\n    reverse: hclToRgb,\n    interpolate: interpolateHcl\n};\n","\nexport default function (output, ...inputs) {\n    for (const input of inputs) {\n        for (const k in input) {\n            output[k] = input[k];\n        }\n    }\n    return output;\n}\n","\nexport default function getType(val) {\n    if (val instanceof Number) {\n        return 'number';\n    } else if (val instanceof String) {\n        return 'string';\n    } else if (val instanceof Boolean) {\n        return 'boolean';\n    } else if (Array.isArray(val)) {\n        return 'array';\n    } else if (val === null) {\n        return 'null';\n    } else {\n        return typeof val;\n    }\n}\n","// @flow\n\nimport Color from './color';\n\nexport function number(a: number, b: number, t: number) {\n    return (a * (1 - t)) + (b * t);\n}\n\nexport function color(from: Color, to: Color, t: number) {\n    return new Color(\n        number(from.r, to.r, t),\n        number(from.g, to.g, t),\n        number(from.b, to.b, t),\n        number(from.a, to.a, t)\n    );\n}\n\nexport function array(from: Array<number>, to: Array<number>, t: number) {\n    return from.map((d, i) => {\n        return number(d, to[i], t);\n    });\n}\n","\nexport default ['type', 'source', 'source-layer', 'minzoom', 'maxzoom', 'filter', 'layout'];\n","// @flow\n\n/**\n * A type used for returning and propagating errors. The first element of the union\n * represents success and contains a value, and the second represents an error and\n * contains an error value.\n * @private\n */\nexport type Result<T, E> =\n    | {| result: 'success', value: T |}\n    | {| result: 'error', value: E |};\n\nexport function success<T, E>(value: T): Result<T, E> {\n    return { result: 'success', value };\n}\n\nexport function error<T, E>(value: E): Result<T, E> {\n    return { result: 'error', value };\n}\n","/*\n * Copyright (C) 2008 Apple Inc. All Rights Reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Ported from Webkit\n * http://svn.webkit.org/repository/webkit/trunk/Source/WebCore/platform/graphics/UnitBezier.h\n */\n\nmodule.exports = UnitBezier;\n\nfunction UnitBezier(p1x, p1y, p2x, p2y) {\n    // Calculate the polynomial coefficients, implicit first and last control points are (0,0) and (1,1).\n    this.cx = 3.0 * p1x;\n    this.bx = 3.0 * (p2x - p1x) - this.cx;\n    this.ax = 1.0 - this.cx - this.bx;\n\n    this.cy = 3.0 * p1y;\n    this.by = 3.0 * (p2y - p1y) - this.cy;\n    this.ay = 1.0 - this.cy - this.by;\n\n    this.p1x = p1x;\n    this.p1y = p2y;\n    this.p2x = p2x;\n    this.p2y = p2y;\n}\n\nUnitBezier.prototype.sampleCurveX = function(t) {\n    // `ax t^3 + bx t^2 + cx t' expanded using Horner's rule.\n    return ((this.ax * t + this.bx) * t + this.cx) * t;\n};\n\nUnitBezier.prototype.sampleCurveY = function(t) {\n    return ((this.ay * t + this.by) * t + this.cy) * t;\n};\n\nUnitBezier.prototype.sampleCurveDerivativeX = function(t) {\n    return (3.0 * this.ax * t + 2.0 * this.bx) * t + this.cx;\n};\n\nUnitBezier.prototype.solveCurveX = function(x, epsilon) {\n    if (typeof epsilon === 'undefined') epsilon = 1e-6;\n\n    var t0, t1, t2, x2, i;\n\n    // First try a few iterations of Newton's method -- normally very fast.\n    for (t2 = x, i = 0; i < 8; i++) {\n\n        x2 = this.sampleCurveX(t2) - x;\n        if (Math.abs(x2) < epsilon) return t2;\n\n        var d2 = this.sampleCurveDerivativeX(t2);\n        if (Math.abs(d2) < 1e-6) break;\n\n        t2 = t2 - x2 / d2;\n    }\n\n    // Fall back to the bisection method for reliability.\n    t0 = 0.0;\n    t1 = 1.0;\n    t2 = x;\n\n    if (t2 < t0) return t0;\n    if (t2 > t1) return t1;\n\n    while (t0 < t1) {\n\n        x2 = this.sampleCurveX(t2);\n        if (Math.abs(x2 - x) < epsilon) return t2;\n\n        if (x > x2) {\n            t0 = t2;\n        } else {\n            t1 = t2;\n        }\n\n        t2 = (t1 - t0) * 0.5 + t0;\n    }\n\n    // Failure.\n    return t2;\n};\n\nUnitBezier.prototype.solve = function(x, epsilon) {\n    return this.sampleCurveY(this.solveCurveX(x, epsilon));\n};\n","'use strict';\n\n// compare and isBuffer taken from https://github.com/feross/buffer/blob/680e9e5e488f22aac27599a57dc844a6315928dd/index.js\n// original notice:\n\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\nfunction compare(a, b) {\n  if (a === b) {\n    return 0;\n  }\n\n  var x = a.length;\n  var y = b.length;\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i];\n      y = b[i];\n      break;\n    }\n  }\n\n  if (x < y) {\n    return -1;\n  }\n  if (y < x) {\n    return 1;\n  }\n  return 0;\n}\nfunction isBuffer(b) {\n  if (global.Buffer && typeof global.Buffer.isBuffer === 'function') {\n    return global.Buffer.isBuffer(b);\n  }\n  return !!(b != null && b._isBuffer);\n}\n\n// based on node assert, original notice:\n\n// http://wiki.commonjs.org/wiki/Unit_Testing/1.0\n//\n// THIS IS NOT TESTED NOR LIKELY TO WORK OUTSIDE V8!\n//\n// Originally from narwhal.js (http://narwhaljs.org)\n// Copyright (c) 2009 Thomas Robinson <280north.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the 'Software'), to\n// deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n// sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n// ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar util = require('util/');\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar pSlice = Array.prototype.slice;\nvar functionsHaveNames = (function () {\n  return function foo() {}.name === 'foo';\n}());\nfunction pToString (obj) {\n  return Object.prototype.toString.call(obj);\n}\nfunction isView(arrbuf) {\n  if (isBuffer(arrbuf)) {\n    return false;\n  }\n  if (typeof global.ArrayBuffer !== 'function') {\n    return false;\n  }\n  if (typeof ArrayBuffer.isView === 'function') {\n    return ArrayBuffer.isView(arrbuf);\n  }\n  if (!arrbuf) {\n    return false;\n  }\n  if (arrbuf instanceof DataView) {\n    return true;\n  }\n  if (arrbuf.buffer && arrbuf.buffer instanceof ArrayBuffer) {\n    return true;\n  }\n  return false;\n}\n// 1. The assert module provides functions that throw\n// AssertionError's when particular conditions are not met. The\n// assert module must conform to the following interface.\n\nvar assert = module.exports = ok;\n\n// 2. The AssertionError is defined in assert.\n// new assert.AssertionError({ message: message,\n//                             actual: actual,\n//                             expected: expected })\n\nvar regex = /\\s*function\\s+([^\\(\\s]*)\\s*/;\n// based on https://github.com/ljharb/function.prototype.name/blob/adeeeec8bfcc6068b187d7d9fb3d5bb1d3a30899/implementation.js\nfunction getName(func) {\n  if (!util.isFunction(func)) {\n    return;\n  }\n  if (functionsHaveNames) {\n    return func.name;\n  }\n  var str = func.toString();\n  var match = str.match(regex);\n  return match && match[1];\n}\nassert.AssertionError = function AssertionError(options) {\n  this.name = 'AssertionError';\n  this.actual = options.actual;\n  this.expected = options.expected;\n  this.operator = options.operator;\n  if (options.message) {\n    this.message = options.message;\n    this.generatedMessage = false;\n  } else {\n    this.message = getMessage(this);\n    this.generatedMessage = true;\n  }\n  var stackStartFunction = options.stackStartFunction || fail;\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, stackStartFunction);\n  } else {\n    // non v8 browsers so we can have a stacktrace\n    var err = new Error();\n    if (err.stack) {\n      var out = err.stack;\n\n      // try to strip useless frames\n      var fn_name = getName(stackStartFunction);\n      var idx = out.indexOf('\\n' + fn_name);\n      if (idx >= 0) {\n        // once we have located the function frame\n        // we need to strip out everything before it (and its line)\n        var next_line = out.indexOf('\\n', idx + 1);\n        out = out.substring(next_line + 1);\n      }\n\n      this.stack = out;\n    }\n  }\n};\n\n// assert.AssertionError instanceof Error\nutil.inherits(assert.AssertionError, Error);\n\nfunction truncate(s, n) {\n  if (typeof s === 'string') {\n    return s.length < n ? s : s.slice(0, n);\n  } else {\n    return s;\n  }\n}\nfunction inspect(something) {\n  if (functionsHaveNames || !util.isFunction(something)) {\n    return util.inspect(something);\n  }\n  var rawname = getName(something);\n  var name = rawname ? ': ' + rawname : '';\n  return '[Function' +  name + ']';\n}\nfunction getMessage(self) {\n  return truncate(inspect(self.actual), 128) + ' ' +\n         self.operator + ' ' +\n         truncate(inspect(self.expected), 128);\n}\n\n// At present only the three keys mentioned above are used and\n// understood by the spec. Implementations or sub modules can pass\n// other keys to the AssertionError's constructor - they will be\n// ignored.\n\n// 3. All of the following functions must throw an AssertionError\n// when a corresponding condition is not met, with a message that\n// may be undefined if not provided.  All assertion methods provide\n// both the actual and expected values to the assertion error for\n// display purposes.\n\nfunction fail(actual, expected, message, operator, stackStartFunction) {\n  throw new assert.AssertionError({\n    message: message,\n    actual: actual,\n    expected: expected,\n    operator: operator,\n    stackStartFunction: stackStartFunction\n  });\n}\n\n// EXTENSION! allows for well behaved errors defined elsewhere.\nassert.fail = fail;\n\n// 4. Pure assertion tests whether a value is truthy, as determined\n// by !!guard.\n// assert.ok(guard, message_opt);\n// This statement is equivalent to assert.equal(true, !!guard,\n// message_opt);. To test strictly for the value true, use\n// assert.strictEqual(true, guard, message_opt);.\n\nfunction ok(value, message) {\n  if (!value) fail(value, true, message, '==', assert.ok);\n}\nassert.ok = ok;\n\n// 5. The equality assertion tests shallow, coercive equality with\n// ==.\n// assert.equal(actual, expected, message_opt);\n\nassert.equal = function equal(actual, expected, message) {\n  if (actual != expected) fail(actual, expected, message, '==', assert.equal);\n};\n\n// 6. The non-equality assertion tests for whether two objects are not equal\n// with != assert.notEqual(actual, expected, message_opt);\n\nassert.notEqual = function notEqual(actual, expected, message) {\n  if (actual == expected) {\n    fail(actual, expected, message, '!=', assert.notEqual);\n  }\n};\n\n// 7. The equivalence assertion tests a deep equality relation.\n// assert.deepEqual(actual, expected, message_opt);\n\nassert.deepEqual = function deepEqual(actual, expected, message) {\n  if (!_deepEqual(actual, expected, false)) {\n    fail(actual, expected, message, 'deepEqual', assert.deepEqual);\n  }\n};\n\nassert.deepStrictEqual = function deepStrictEqual(actual, expected, message) {\n  if (!_deepEqual(actual, expected, true)) {\n    fail(actual, expected, message, 'deepStrictEqual', assert.deepStrictEqual);\n  }\n};\n\nfunction _deepEqual(actual, expected, strict, memos) {\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n  } else if (isBuffer(actual) && isBuffer(expected)) {\n    return compare(actual, expected) === 0;\n\n  // 7.2. If the expected value is a Date object, the actual value is\n  // equivalent if it is also a Date object that refers to the same time.\n  } else if (util.isDate(actual) && util.isDate(expected)) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3 If the expected value is a RegExp object, the actual value is\n  // equivalent if it is also a RegExp object with the same source and\n  // properties (`global`, `multiline`, `lastIndex`, `ignoreCase`).\n  } else if (util.isRegExp(actual) && util.isRegExp(expected)) {\n    return actual.source === expected.source &&\n           actual.global === expected.global &&\n           actual.multiline === expected.multiline &&\n           actual.lastIndex === expected.lastIndex &&\n           actual.ignoreCase === expected.ignoreCase;\n\n  // 7.4. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if ((actual === null || typeof actual !== 'object') &&\n             (expected === null || typeof expected !== 'object')) {\n    return strict ? actual === expected : actual == expected;\n\n  // If both values are instances of typed arrays, wrap their underlying\n  // ArrayBuffers in a Buffer each to increase performance\n  // This optimization requires the arrays to have the same type as checked by\n  // Object.prototype.toString (aka pToString). Never perform binary\n  // comparisons for Float*Arrays, though, since e.g. +0 === -0 but their\n  // bit patterns are not identical.\n  } else if (isView(actual) && isView(expected) &&\n             pToString(actual) === pToString(expected) &&\n             !(actual instanceof Float32Array ||\n               actual instanceof Float64Array)) {\n    return compare(new Uint8Array(actual.buffer),\n                   new Uint8Array(expected.buffer)) === 0;\n\n  // 7.5 For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else if (isBuffer(actual) !== isBuffer(expected)) {\n    return false;\n  } else {\n    memos = memos || {actual: [], expected: []};\n\n    var actualIndex = memos.actual.indexOf(actual);\n    if (actualIndex !== -1) {\n      if (actualIndex === memos.expected.indexOf(expected)) {\n        return true;\n      }\n    }\n\n    memos.actual.push(actual);\n    memos.expected.push(expected);\n\n    return objEquiv(actual, expected, strict, memos);\n  }\n}\n\nfunction isArguments(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n}\n\nfunction objEquiv(a, b, strict, actualVisitedObjects) {\n  if (a === null || a === undefined || b === null || b === undefined)\n    return false;\n  // if one is a primitive, the other must be same\n  if (util.isPrimitive(a) || util.isPrimitive(b))\n    return a === b;\n  if (strict && Object.getPrototypeOf(a) !== Object.getPrototypeOf(b))\n    return false;\n  var aIsArgs = isArguments(a);\n  var bIsArgs = isArguments(b);\n  if ((aIsArgs && !bIsArgs) || (!aIsArgs && bIsArgs))\n    return false;\n  if (aIsArgs) {\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return _deepEqual(a, b, strict);\n  }\n  var ka = objectKeys(a);\n  var kb = objectKeys(b);\n  var key, i;\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length !== kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] !== kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!_deepEqual(a[key], b[key], strict, actualVisitedObjects))\n      return false;\n  }\n  return true;\n}\n\n// 8. The non-equivalence assertion tests for any deep inequality.\n// assert.notDeepEqual(actual, expected, message_opt);\n\nassert.notDeepEqual = function notDeepEqual(actual, expected, message) {\n  if (_deepEqual(actual, expected, false)) {\n    fail(actual, expected, message, 'notDeepEqual', assert.notDeepEqual);\n  }\n};\n\nassert.notDeepStrictEqual = notDeepStrictEqual;\nfunction notDeepStrictEqual(actual, expected, message) {\n  if (_deepEqual(actual, expected, true)) {\n    fail(actual, expected, message, 'notDeepStrictEqual', notDeepStrictEqual);\n  }\n}\n\n\n// 9. The strict equality assertion tests strict equality, as determined by ===.\n// assert.strictEqual(actual, expected, message_opt);\n\nassert.strictEqual = function strictEqual(actual, expected, message) {\n  if (actual !== expected) {\n    fail(actual, expected, message, '===', assert.strictEqual);\n  }\n};\n\n// 10. The strict non-equality assertion tests for strict inequality, as\n// determined by !==.  assert.notStrictEqual(actual, expected, message_opt);\n\nassert.notStrictEqual = function notStrictEqual(actual, expected, message) {\n  if (actual === expected) {\n    fail(actual, expected, message, '!==', assert.notStrictEqual);\n  }\n};\n\nfunction expectedException(actual, expected) {\n  if (!actual || !expected) {\n    return false;\n  }\n\n  if (Object.prototype.toString.call(expected) == '[object RegExp]') {\n    return expected.test(actual);\n  }\n\n  try {\n    if (actual instanceof expected) {\n      return true;\n    }\n  } catch (e) {\n    // Ignore.  The instanceof check doesn't work for arrow functions.\n  }\n\n  if (Error.isPrototypeOf(expected)) {\n    return false;\n  }\n\n  return expected.call({}, actual) === true;\n}\n\nfunction _tryBlock(block) {\n  var error;\n  try {\n    block();\n  } catch (e) {\n    error = e;\n  }\n  return error;\n}\n\nfunction _throws(shouldThrow, block, expected, message) {\n  var actual;\n\n  if (typeof block !== 'function') {\n    throw new TypeError('\"block\" argument must be a function');\n  }\n\n  if (typeof expected === 'string') {\n    message = expected;\n    expected = null;\n  }\n\n  actual = _tryBlock(block);\n\n  message = (expected && expected.name ? ' (' + expected.name + ').' : '.') +\n            (message ? ' ' + message : '.');\n\n  if (shouldThrow && !actual) {\n    fail(actual, expected, 'Missing expected exception' + message);\n  }\n\n  var userProvidedMessage = typeof message === 'string';\n  var isUnwantedException = !shouldThrow && util.isError(actual);\n  var isUnexpectedException = !shouldThrow && actual && !expected;\n\n  if ((isUnwantedException &&\n      userProvidedMessage &&\n      expectedException(actual, expected)) ||\n      isUnexpectedException) {\n    fail(actual, expected, 'Got unwanted exception' + message);\n  }\n\n  if ((shouldThrow && actual && expected &&\n      !expectedException(actual, expected)) || (!shouldThrow && actual)) {\n    throw actual;\n  }\n}\n\n// 11. Expected to throw an error:\n// assert.throws(block, Error_opt, message_opt);\n\nassert.throws = function(block, /*optional*/error, /*optional*/message) {\n  _throws(true, block, error, message);\n};\n\n// EXTENSION! This is annoying to write outside this module.\nassert.doesNotThrow = function(block, /*optional*/error, /*optional*/message) {\n  _throws(false, block, error, message);\n};\n\nassert.ifError = function(err) { if (err) throw err; };\n\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) {\n    if (hasOwn.call(obj, key)) keys.push(key);\n  }\n  return keys;\n};\n","exports = module.exports = require(\"../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".ol-box {\\n  box-sizing: border-box;\\n  border-radius: 2px;\\n  border: 2px solid blue;\\n}\\n\\n.ol-mouse-position {\\n  top: 8px;\\n  right: 8px;\\n  position: absolute;\\n}\\n\\n.ol-scale-line {\\n  background: rgba(0,60,136,0.3);\\n  border-radius: 4px;\\n  bottom: 8px;\\n  left: 8px;\\n  padding: 2px;\\n  position: absolute;\\n}\\n.ol-scale-line-inner {\\n  border: 1px solid #eee;\\n  border-top: none;\\n  color: #eee;\\n  font-size: 10px;\\n  text-align: center;\\n  margin: 1px;\\n  will-change: contents, width;\\n}\\n.ol-overlay-container {\\n  will-change: left,right,top,bottom;\\n}\\n\\n.ol-unsupported {\\n  display: none;\\n}\\n.ol-viewport, .ol-unselectable {\\n  -webkit-touch-callout: none;\\n  -webkit-user-select: none;\\n  -moz-user-select: none;\\n  -ms-user-select: none;\\n  user-select: none;\\n  -webkit-tap-highlight-color: rgba(0,0,0,0);\\n}\\n.ol-selectable {\\n  -webkit-touch-callout: default;\\n  -webkit-user-select: text;\\n  -moz-user-select: text;\\n  -ms-user-select: text;\\n  user-select: text;\\n}\\n.ol-grabbing {\\n  cursor: -webkit-grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: grabbing;\\n}\\n.ol-grab {\\n  cursor: move;\\n  cursor: -webkit-grab;\\n  cursor: -moz-grab;\\n  cursor: grab;\\n}\\n.ol-control {\\n  position: absolute;\\n  background-color: rgba(255,255,255,0.4);\\n  border-radius: 4px;\\n  padding: 2px;\\n}\\n.ol-control:hover {\\n  background-color: rgba(255,255,255,0.6);\\n}\\n.ol-zoom {\\n  top: .5em;\\n  left: .5em;\\n}\\n.ol-rotate {\\n  top: .5em;\\n  right: .5em;\\n  transition: opacity .25s linear, visibility 0s linear;\\n}\\n.ol-rotate.ol-hidden {\\n  opacity: 0;\\n  visibility: hidden;\\n  transition: opacity .25s linear, visibility 0s linear .25s;\\n}\\n.ol-zoom-extent {\\n  top: 4.643em;\\n  left: .5em;\\n}\\n.ol-full-screen {\\n  right: .5em;\\n  top: .5em;\\n}\\n@media print {\\n  .ol-control {\\n    display: none;\\n  }\\n}\\n\\n.ol-control button {\\n  display: block;\\n  margin: 1px;\\n  padding: 0;\\n  color: white;\\n  font-size: 1.14em;\\n  font-weight: bold;\\n  text-decoration: none;\\n  text-align: center;\\n  height: 1.375em;\\n  width: 1.375em;\\n  line-height: .4em;\\n  background-color: rgba(0,60,136,0.5);\\n  border: none;\\n  border-radius: 2px;\\n}\\n.ol-control button::-moz-focus-inner {\\n  border: none;\\n  padding: 0;\\n}\\n.ol-zoom-extent button {\\n  line-height: 1.4em;\\n}\\n.ol-compass {\\n  display: block;\\n  font-weight: normal;\\n  font-size: 1.2em;\\n  will-change: transform;\\n}\\n.ol-touch .ol-control button {\\n  font-size: 1.5em;\\n}\\n.ol-touch .ol-zoom-extent {\\n  top: 5.5em;\\n}\\n.ol-control button:hover,\\n.ol-control button:focus {\\n  text-decoration: none;\\n  background-color: rgba(0,60,136,0.7);\\n}\\n.ol-zoom .ol-zoom-in {\\n  border-radius: 2px 2px 0 0;\\n}\\n.ol-zoom .ol-zoom-out {\\n  border-radius: 0 0 2px 2px;\\n}\\n\\n\\n.ol-attribution {\\n  text-align: right;\\n  bottom: .5em;\\n  right: .5em;\\n  max-width: calc(100% - 1.3em);\\n}\\n\\n.ol-attribution ul {\\n  margin: 0;\\n  padding: 0 .5em;\\n  font-size: .7rem;\\n  line-height: 1.375em;\\n  color: #000;\\n  text-shadow: 0 0 2px #fff;\\n}\\n.ol-attribution li {\\n  display: inline;\\n  list-style: none;\\n  line-height: inherit;\\n}\\n.ol-attribution li:not(:last-child):after {\\n  content: \\\" \\\";\\n}\\n.ol-attribution img {\\n  max-height: 2em;\\n  max-width: inherit;\\n  vertical-align: middle;\\n}\\n.ol-attribution ul, .ol-attribution button {\\n  display: inline-block;\\n}\\n.ol-attribution.ol-collapsed ul {\\n  display: none;\\n}\\n.ol-attribution:not(.ol-collapsed) {\\n  background: rgba(255,255,255,0.8);\\n}\\n.ol-attribution.ol-uncollapsible {\\n  bottom: 0;\\n  right: 0;\\n  border-radius: 4px 0 0;\\n  height: 1.1em;\\n  line-height: 1em;\\n}\\n.ol-attribution.ol-uncollapsible img {\\n  margin-top: -.2em;\\n  max-height: 1.6em;\\n}\\n.ol-attribution.ol-uncollapsible button {\\n  display: none;\\n}\\n\\n.ol-zoomslider {\\n  top: 4.5em;\\n  left: .5em;\\n  height: 200px;\\n}\\n.ol-zoomslider button {\\n  position: relative;\\n  height: 10px;\\n}\\n\\n.ol-touch .ol-zoomslider {\\n  top: 5.5em;\\n}\\n\\n.ol-overviewmap {\\n  left: 0.5em;\\n  bottom: 0.5em;\\n}\\n.ol-overviewmap.ol-uncollapsible {\\n  bottom: 0;\\n  left: 0;\\n  border-radius: 0 4px 0 0;\\n}\\n.ol-overviewmap .ol-overviewmap-map,\\n.ol-overviewmap button {\\n  display: inline-block;\\n}\\n.ol-overviewmap .ol-overviewmap-map {\\n  border: 1px solid #7b98bc;\\n  height: 150px;\\n  margin: 2px;\\n  width: 150px;\\n}\\n.ol-overviewmap:not(.ol-collapsed) button{\\n  bottom: 1px;\\n  left: 2px;\\n  position: absolute;\\n}\\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\\n.ol-overviewmap.ol-uncollapsible button {\\n  display: none;\\n}\\n.ol-overviewmap:not(.ol-collapsed) {\\n  background: rgba(255,255,255,0.8);\\n}\\n.ol-overviewmap-box {\\n  border: 2px dotted rgba(0,60,136,0.7);\\n}\\n\\n.ol-overviewmap .ol-overviewmap-box:hover {\\n  cursor: move;\\n}\\n\", \"\"]);\n\n// exports\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","// (c) Dean McNamee <dean@gmail.com>, 2012.\n//\n// https://github.com/deanm/css-color-parser-js\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to\n// deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n// sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n// FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n// IN THE SOFTWARE.\n\n// http://www.w3.org/TR/css3-color/\nvar kCSSColorTable = {\n  \"transparent\": [0,0,0,0], \"aliceblue\": [240,248,255,1],\n  \"antiquewhite\": [250,235,215,1], \"aqua\": [0,255,255,1],\n  \"aquamarine\": [127,255,212,1], \"azure\": [240,255,255,1],\n  \"beige\": [245,245,220,1], \"bisque\": [255,228,196,1],\n  \"black\": [0,0,0,1], \"blanchedalmond\": [255,235,205,1],\n  \"blue\": [0,0,255,1], \"blueviolet\": [138,43,226,1],\n  \"brown\": [165,42,42,1], \"burlywood\": [222,184,135,1],\n  \"cadetblue\": [95,158,160,1], \"chartreuse\": [127,255,0,1],\n  \"chocolate\": [210,105,30,1], \"coral\": [255,127,80,1],\n  \"cornflowerblue\": [100,149,237,1], \"cornsilk\": [255,248,220,1],\n  \"crimson\": [220,20,60,1], \"cyan\": [0,255,255,1],\n  \"darkblue\": [0,0,139,1], \"darkcyan\": [0,139,139,1],\n  \"darkgoldenrod\": [184,134,11,1], \"darkgray\": [169,169,169,1],\n  \"darkgreen\": [0,100,0,1], \"darkgrey\": [169,169,169,1],\n  \"darkkhaki\": [189,183,107,1], \"darkmagenta\": [139,0,139,1],\n  \"darkolivegreen\": [85,107,47,1], \"darkorange\": [255,140,0,1],\n  \"darkorchid\": [153,50,204,1], \"darkred\": [139,0,0,1],\n  \"darksalmon\": [233,150,122,1], \"darkseagreen\": [143,188,143,1],\n  \"darkslateblue\": [72,61,139,1], \"darkslategray\": [47,79,79,1],\n  \"darkslategrey\": [47,79,79,1], \"darkturquoise\": [0,206,209,1],\n  \"darkviolet\": [148,0,211,1], \"deeppink\": [255,20,147,1],\n  \"deepskyblue\": [0,191,255,1], \"dimgray\": [105,105,105,1],\n  \"dimgrey\": [105,105,105,1], \"dodgerblue\": [30,144,255,1],\n  \"firebrick\": [178,34,34,1], \"floralwhite\": [255,250,240,1],\n  \"forestgreen\": [34,139,34,1], \"fuchsia\": [255,0,255,1],\n  \"gainsboro\": [220,220,220,1], \"ghostwhite\": [248,248,255,1],\n  \"gold\": [255,215,0,1], \"goldenrod\": [218,165,32,1],\n  \"gray\": [128,128,128,1], \"green\": [0,128,0,1],\n  \"greenyellow\": [173,255,47,1], \"grey\": [128,128,128,1],\n  \"honeydew\": [240,255,240,1], \"hotpink\": [255,105,180,1],\n  \"indianred\": [205,92,92,1], \"indigo\": [75,0,130,1],\n  \"ivory\": [255,255,240,1], \"khaki\": [240,230,140,1],\n  \"lavender\": [230,230,250,1], \"lavenderblush\": [255,240,245,1],\n  \"lawngreen\": [124,252,0,1], \"lemonchiffon\": [255,250,205,1],\n  \"lightblue\": [173,216,230,1], \"lightcoral\": [240,128,128,1],\n  \"lightcyan\": [224,255,255,1], \"lightgoldenrodyellow\": [250,250,210,1],\n  \"lightgray\": [211,211,211,1], \"lightgreen\": [144,238,144,1],\n  \"lightgrey\": [211,211,211,1], \"lightpink\": [255,182,193,1],\n  \"lightsalmon\": [255,160,122,1], \"lightseagreen\": [32,178,170,1],\n  \"lightskyblue\": [135,206,250,1], \"lightslategray\": [119,136,153,1],\n  \"lightslategrey\": [119,136,153,1], \"lightsteelblue\": [176,196,222,1],\n  \"lightyellow\": [255,255,224,1], \"lime\": [0,255,0,1],\n  \"limegreen\": [50,205,50,1], \"linen\": [250,240,230,1],\n  \"magenta\": [255,0,255,1], \"maroon\": [128,0,0,1],\n  \"mediumaquamarine\": [102,205,170,1], \"mediumblue\": [0,0,205,1],\n  \"mediumorchid\": [186,85,211,1], \"mediumpurple\": [147,112,219,1],\n  \"mediumseagreen\": [60,179,113,1], \"mediumslateblue\": [123,104,238,1],\n  \"mediumspringgreen\": [0,250,154,1], \"mediumturquoise\": [72,209,204,1],\n  \"mediumvioletred\": [199,21,133,1], \"midnightblue\": [25,25,112,1],\n  \"mintcream\": [245,255,250,1], \"mistyrose\": [255,228,225,1],\n  \"moccasin\": [255,228,181,1], \"navajowhite\": [255,222,173,1],\n  \"navy\": [0,0,128,1], \"oldlace\": [253,245,230,1],\n  \"olive\": [128,128,0,1], \"olivedrab\": [107,142,35,1],\n  \"orange\": [255,165,0,1], \"orangered\": [255,69,0,1],\n  \"orchid\": [218,112,214,1], \"palegoldenrod\": [238,232,170,1],\n  \"palegreen\": [152,251,152,1], \"paleturquoise\": [175,238,238,1],\n  \"palevioletred\": [219,112,147,1], \"papayawhip\": [255,239,213,1],\n  \"peachpuff\": [255,218,185,1], \"peru\": [205,133,63,1],\n  \"pink\": [255,192,203,1], \"plum\": [221,160,221,1],\n  \"powderblue\": [176,224,230,1], \"purple\": [128,0,128,1],\n  \"rebeccapurple\": [102,51,153,1],\n  \"red\": [255,0,0,1], \"rosybrown\": [188,143,143,1],\n  \"royalblue\": [65,105,225,1], \"saddlebrown\": [139,69,19,1],\n  \"salmon\": [250,128,114,1], \"sandybrown\": [244,164,96,1],\n  \"seagreen\": [46,139,87,1], \"seashell\": [255,245,238,1],\n  \"sienna\": [160,82,45,1], \"silver\": [192,192,192,1],\n  \"skyblue\": [135,206,235,1], \"slateblue\": [106,90,205,1],\n  \"slategray\": [112,128,144,1], \"slategrey\": [112,128,144,1],\n  \"snow\": [255,250,250,1], \"springgreen\": [0,255,127,1],\n  \"steelblue\": [70,130,180,1], \"tan\": [210,180,140,1],\n  \"teal\": [0,128,128,1], \"thistle\": [216,191,216,1],\n  \"tomato\": [255,99,71,1], \"turquoise\": [64,224,208,1],\n  \"violet\": [238,130,238,1], \"wheat\": [245,222,179,1],\n  \"white\": [255,255,255,1], \"whitesmoke\": [245,245,245,1],\n  \"yellow\": [255,255,0,1], \"yellowgreen\": [154,205,50,1]}\n\nfunction clamp_css_byte(i) {  // Clamp to integer 0 .. 255.\n  i = Math.round(i);  // Seems to be what Chrome does (vs truncation).\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\nfunction clamp_css_float(f) {  // Clamp to float 0.0 .. 1.0.\n  return f < 0 ? 0 : f > 1 ? 1 : f;\n}\n\nfunction parse_css_int(str) {  // int or percentage.\n  if (str[str.length - 1] === '%')\n    return clamp_css_byte(parseFloat(str) / 100 * 255);\n  return clamp_css_byte(parseInt(str));\n}\n\nfunction parse_css_float(str) {  // float or percentage.\n  if (str[str.length - 1] === '%')\n    return clamp_css_float(parseFloat(str) / 100);\n  return clamp_css_float(parseFloat(str));\n}\n\nfunction css_hue_to_rgb(m1, m2, h) {\n  if (h < 0) h += 1;\n  else if (h > 1) h -= 1;\n\n  if (h * 6 < 1) return m1 + (m2 - m1) * h * 6;\n  if (h * 2 < 1) return m2;\n  if (h * 3 < 2) return m1 + (m2 - m1) * (2/3 - h) * 6;\n  return m1;\n}\n\nfunction parseCSSColor(css_str) {\n  // Remove all whitespace, not compliant, but should just be more accepting.\n  var str = css_str.replace(/ /g, '').toLowerCase();\n\n  // Color keywords (and transparent) lookup.\n  if (str in kCSSColorTable) return kCSSColorTable[str].slice();  // dup.\n\n  // #abc and #abc123 syntax.\n  if (str[0] === '#') {\n    if (str.length === 4) {\n      var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\n      if (!(iv >= 0 && iv <= 0xfff)) return null;  // Covers NaN.\n      return [((iv & 0xf00) >> 4) | ((iv & 0xf00) >> 8),\n              (iv & 0xf0) | ((iv & 0xf0) >> 4),\n              (iv & 0xf) | ((iv & 0xf) << 4),\n              1];\n    } else if (str.length === 7) {\n      var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\n      if (!(iv >= 0 && iv <= 0xffffff)) return null;  // Covers NaN.\n      return [(iv & 0xff0000) >> 16,\n              (iv & 0xff00) >> 8,\n              iv & 0xff,\n              1];\n    }\n\n    return null;\n  }\n\n  var op = str.indexOf('('), ep = str.indexOf(')');\n  if (op !== -1 && ep + 1 === str.length) {\n    var fname = str.substr(0, op);\n    var params = str.substr(op+1, ep-(op+1)).split(',');\n    var alpha = 1;  // To allow case fallthrough.\n    switch (fname) {\n      case 'rgba':\n        if (params.length !== 4) return null;\n        alpha = parse_css_float(params.pop());\n        // Fall through.\n      case 'rgb':\n        if (params.length !== 3) return null;\n        return [parse_css_int(params[0]),\n                parse_css_int(params[1]),\n                parse_css_int(params[2]),\n                alpha];\n      case 'hsla':\n        if (params.length !== 4) return null;\n        alpha = parse_css_float(params.pop());\n        // Fall through.\n      case 'hsl':\n        if (params.length !== 3) return null;\n        var h = (((parseFloat(params[0]) % 360) + 360) % 360) / 360;  // 0 .. 1\n        // NOTE(deanm): According to the CSS spec s/l should only be\n        // percentages, but we don't bother and let float or percentage.\n        var s = parse_css_float(params[1]);\n        var l = parse_css_float(params[2]);\n        var m2 = l <= 0.5 ? l * (s + 1) : l + s - l * s;\n        var m1 = l * 2 - m2;\n        return [clamp_css_byte(css_hue_to_rgb(m1, m2, h+1/3) * 255),\n                clamp_css_byte(css_hue_to_rgb(m1, m2, h) * 255),\n                clamp_css_byte(css_hue_to_rgb(m1, m2, h-1/3) * 255),\n                alpha];\n      default:\n        return null;\n    }\n  }\n\n  return null;\n}\n\ntry { exports.parseCSSColor = parseCSSColor } catch(e) { }\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","var fontWeights = {\n  thin: 100,\n  hairline: 100,\n  'ultra-light': 100,\n  'extra-light': 100,\n  light: 200,\n  book: 300,\n  regular: 400,\n  normal: 400,\n  plain: 400,\n  roman: 400,\n  standard: 400,\n  medium: 500,\n  'semi-bold': 600,\n  'demi-bold': 600,\n  bold: 700,\n  heavy: 800,\n  black: 800,\n  'extra-bold': 800,\n  'ultra-black': 900,\n  'extra-black': 900,\n  'ultra-bold': 900,\n  'heavy-black': 900,\n  fat: 900,\n  poster: 900\n};\nvar sp = ' ';\nvar italicRE = /(italic|oblique)$/i;\n\nvar fontCache = {};\n\nmodule.exports = function(fonts, size) {\n  var cssData = fontCache[fonts];\n  if (!cssData) {\n    if (!Array.isArray(fonts)) {\n      fonts = [fonts];\n    }\n    var weight = 'normal';\n    var style = 'normal';\n    var fontFamilies = []\n    var haveWeight, haveStyle;\n    for (var i = 0, ii = fonts.length; i < ii; ++i) {\n      var font = fonts[i];\n      var parts = font.split(' ');\n      var maybeWeight = parts[parts.length - 1].toLowerCase();\n      if (maybeWeight == 'normal' || maybeWeight == 'italic' || maybeWeight == 'oblique') {\n        style = haveStyle ? style : maybeWeight;\n        parts.pop();\n        maybeWeight = parts[parts.length - 1].toLowerCase();\n      } else if (italicRE.test(maybeWeight)) {\n        maybeWeight = maybeWeight.replace(italicRE, '');\n        style = haveStyle ? style : parts[parts.length - 1].replace(maybeWeight, '');\n      }\n      for (var w in fontWeights) {\n        if (maybeWeight == w || maybeWeight == w.replace('-', '') || maybeWeight == w.replace('-', sp)) {\n          weight = haveWeight ? weight : fontWeights[w];\n          parts.pop();\n          break;\n        }\n      }\n      if (!haveWeight && typeof maybeWeight == 'number') {\n        weight = maybeWeight;\n      }\n      var fontFamily = parts.join(sp)\n          .replace('Klokantech Noto Sans', 'Noto Sans');\n      if (fontFamily.indexOf(sp) !== -1) {\n        fontFamily = '\"' + fontFamily + '\"';\n      }\n      fontFamilies.push(fontFamily);\n    }\n    // CSS font property: font-style font-weight font-size font-family\n    cssData = fontCache[fonts] = [style, weight, fontFamilies];\n  }\n  return cssData[0] + sp + cssData[1] + sp + size + 'px' + sp + cssData[2];\n}\n","/**\n * @module ol/AssertionError\n */\nimport {VERSION, inherits} from './index.js';\n\n/**\n * Error object thrown when an assertion failed. This is an ECMA-262 Error,\n * extended with a `code` property.\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error}\n * @constructor\n * @extends {Error}\n * @param {number} code Error code.\n */\nconst AssertionError = function(code) {\n\n  const path = VERSION ? VERSION.split('-')[0] : 'latest';\n\n  /**\n   * @type {string}\n   */\n  this.message = 'Assertion failed. See https://openlayers.org/en/' + path +\n      '/doc/errors/#' + code + ' for details.';\n\n  /**\n   * Error code. The meaning of the code can be found on\n   * {@link https://openlayers.org/en/latest/doc/errors/} (replace `latest` with\n   * the version found in the OpenLayers script's header comment if a version\n   * other than the latest is used).\n   * @type {number}\n   * @api\n   */\n  this.code = code;\n\n  this.name = 'AssertionError';\n\n};\n\ninherits(AssertionError, Error);\n\nexport default AssertionError;\n","/**\n * @module ol/Collection\n */\nimport {inherits} from './index.js';\nimport AssertionError from './AssertionError.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport BaseObject from './Object.js';\nimport Event from './events/Event.js';\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LENGTH: 'length'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Collection~Collection} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/CollectionEventType} type Type.\n * @param {*=} opt_element Element.\n */\nexport const CollectionEvent = function(type, opt_element) {\n\n  Event.call(this, type);\n\n  /**\n   * The element that is added to or removed from the collection.\n   * @type {*}\n   * @api\n   */\n  this.element = opt_element;\n\n};\n\ninherits(CollectionEvent, Event);\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [unique=false] Disallow the same item from being added to\n * the collection twice.\n */\n\n/**\n * @classdesc\n * An expanded version of standard JS Array, adding convenience methods for\n * manipulation. Add and remove changes to the Collection trigger a Collection\n * event. Note that this does not cover changes to the objects _within_ the\n * Collection; they trigger events on the appropriate object, not on the\n * Collection as a whole.\n *\n * @constructor\n * @extends {module:ol/Object}\n * @fires module:ol/Collection~CollectionEvent\n * @param {Array.<T>=} opt_array Array.\n * @param {module:ol/Collection~Options=} opt_options Collection options.\n * @template T\n * @api\n */\nconst Collection = function(opt_array, opt_options) {\n\n  BaseObject.call(this);\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.unique_ = !!options.unique;\n\n  /**\n   * @private\n   * @type {!Array.<T>}\n   */\n  this.array_ = opt_array ? opt_array : [];\n\n  if (this.unique_) {\n    for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n      this.assertUnique_(this.array_[i], i);\n    }\n  }\n\n  this.updateLength_();\n\n};\n\ninherits(Collection, BaseObject);\n\n\n/**\n * Remove all elements from the collection.\n * @api\n */\nCollection.prototype.clear = function() {\n  while (this.getLength() > 0) {\n    this.pop();\n  }\n};\n\n\n/**\n * Add elements to the collection.  This pushes each item in the provided array\n * to the end of the collection.\n * @param {!Array.<T>} arr Array.\n * @return {module:ol/Collection.<T>} This collection.\n * @api\n */\nCollection.prototype.extend = function(arr) {\n  for (let i = 0, ii = arr.length; i < ii; ++i) {\n    this.push(arr[i]);\n  }\n  return this;\n};\n\n\n/**\n * Iterate over each element, calling the provided callback.\n * @param {function(T, number, Array.<T>): *} f The function to call\n *     for every element. This function takes 3 arguments (the element, the\n *     index and the array). The return value is ignored.\n * @api\n */\nCollection.prototype.forEach = function(f) {\n  const array = this.array_;\n  for (let i = 0, ii = array.length; i < ii; ++i) {\n    f(array[i], i, array);\n  }\n};\n\n\n/**\n * Get a reference to the underlying Array object. Warning: if the array\n * is mutated, no events will be dispatched by the collection, and the\n * collection's \"length\" property won't be in sync with the actual length\n * of the array.\n * @return {!Array.<T>} Array.\n * @api\n */\nCollection.prototype.getArray = function() {\n  return this.array_;\n};\n\n\n/**\n * Get the element at the provided index.\n * @param {number} index Index.\n * @return {T} Element.\n * @api\n */\nCollection.prototype.item = function(index) {\n  return this.array_[index];\n};\n\n\n/**\n * Get the length of this collection.\n * @return {number} The length of the array.\n * @observable\n * @api\n */\nCollection.prototype.getLength = function() {\n  return /** @type {number} */ (this.get(Property.LENGTH));\n};\n\n\n/**\n * Insert an element at the provided index.\n * @param {number} index Index.\n * @param {T} elem Element.\n * @api\n */\nCollection.prototype.insertAt = function(index, elem) {\n  if (this.unique_) {\n    this.assertUnique_(elem);\n  }\n  this.array_.splice(index, 0, elem);\n  this.updateLength_();\n  this.dispatchEvent(\n    new CollectionEvent(CollectionEventType.ADD, elem));\n};\n\n\n/**\n * Remove the last element of the collection and return it.\n * Return `undefined` if the collection is empty.\n * @return {T|undefined} Element.\n * @api\n */\nCollection.prototype.pop = function() {\n  return this.removeAt(this.getLength() - 1);\n};\n\n\n/**\n * Insert the provided element at the end of the collection.\n * @param {T} elem Element.\n * @return {number} New length of the collection.\n * @api\n */\nCollection.prototype.push = function(elem) {\n  if (this.unique_) {\n    this.assertUnique_(elem);\n  }\n  const n = this.getLength();\n  this.insertAt(n, elem);\n  return this.getLength();\n};\n\n\n/**\n * Remove the first occurrence of an element from the collection.\n * @param {T} elem Element.\n * @return {T|undefined} The removed element or undefined if none found.\n * @api\n */\nCollection.prototype.remove = function(elem) {\n  const arr = this.array_;\n  for (let i = 0, ii = arr.length; i < ii; ++i) {\n    if (arr[i] === elem) {\n      return this.removeAt(i);\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * Remove the element at the provided index and return it.\n * Return `undefined` if the collection does not contain this index.\n * @param {number} index Index.\n * @return {T|undefined} Value.\n * @api\n */\nCollection.prototype.removeAt = function(index) {\n  const prev = this.array_[index];\n  this.array_.splice(index, 1);\n  this.updateLength_();\n  this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE, prev));\n  return prev;\n};\n\n\n/**\n * Set the element at the provided index.\n * @param {number} index Index.\n * @param {T} elem Element.\n * @api\n */\nCollection.prototype.setAt = function(index, elem) {\n  const n = this.getLength();\n  if (index < n) {\n    if (this.unique_) {\n      this.assertUnique_(elem, index);\n    }\n    const prev = this.array_[index];\n    this.array_[index] = elem;\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.REMOVE, prev));\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.ADD, elem));\n  } else {\n    for (let j = n; j < index; ++j) {\n      this.insertAt(j, undefined);\n    }\n    this.insertAt(index, elem);\n  }\n};\n\n\n/**\n * @private\n */\nCollection.prototype.updateLength_ = function() {\n  this.set(Property.LENGTH, this.array_.length);\n};\n\n\n/**\n * @private\n * @param {T} elem Element.\n * @param {number=} opt_except Optional index to ignore.\n */\nCollection.prototype.assertUnique_ = function(elem, opt_except) {\n  for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n    if (this.array_[i] === elem && i !== opt_except) {\n      throw new AssertionError(58);\n    }\n  }\n};\n\nexport default Collection;\n","/**\n * @module ol/CollectionEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when an item is added to the collection.\n   * @event module:ol/Collection~CollectionEvent#add\n   * @api\n   */\n  ADD: 'add',\n  /**\n   * Triggered when an item is removed from the collection.\n   * @event module:ol/Collection~CollectionEvent#remove\n   * @api\n   */\n  REMOVE: 'remove'\n};\n","/**\n * @module ol/Disposable\n */\nimport {UNDEFINED} from './functions.js';\n\n/**\n * Objects that need to clean up after themselves.\n * @constructor\n */\nconst Disposable = function() {};\n\n/**\n * The object has already been disposed.\n * @type {boolean}\n * @private\n */\nDisposable.prototype.disposed_ = false;\n\n/**\n * Clean up.\n */\nDisposable.prototype.dispose = function() {\n  if (!this.disposed_) {\n    this.disposed_ = true;\n    this.disposeInternal();\n  }\n};\n\n/**\n * Extension point for disposable objects.\n * @protected\n */\nDisposable.prototype.disposeInternal = UNDEFINED;\nexport default Disposable;\n","/**\n * @module ol/Feature\n */\nimport {assert} from './asserts.js';\nimport {listen, unlisten, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport {inherits} from './index.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport Geometry from './geom/Geometry.js';\nimport Style from './style/Style.js';\n\n/**\n * @classdesc\n * A vector object for geographic features with a geometry and other\n * attribute properties, similar to the features in vector file formats like\n * GeoJSON.\n *\n * Features can be styled individually with `setStyle`; otherwise they use the\n * style of their vector layer.\n *\n * Note that attribute properties are set as {@link module:ol/Object} properties on\n * the feature object, so they are observable, and have get/set accessors.\n *\n * Typically, a feature has a single geometry property. You can set the\n * geometry using the `setGeometry` method and get it with `getGeometry`.\n * It is possible to store more than one geometry on a feature using attribute\n * properties. By default, the geometry used for rendering is identified by\n * the property name `geometry`. If you want to use another geometry property\n * for rendering, use the `setGeometryName` method to change the attribute\n * property associated with the geometry for the feature.  For example:\n *\n * ```js\n *\n * import Feature from 'ol/Feature';\n * import Polygon from 'ol/geom/Polygon';\n * import Point from 'ol/geom/Point';\n *\n * var feature = new Feature({\n *   geometry: new Polygon(polyCoords),\n *   labelPoint: new Point(labelCoords),\n *   name: 'My Polygon'\n * });\n *\n * // get the polygon geometry\n * var poly = feature.getGeometry();\n *\n * // Render the feature as a point using the coordinates from labelPoint\n * feature.setGeometryName('labelPoint');\n *\n * // get the point geometry\n * var point = feature.getGeometry();\n * ```\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/geom/Geometry|Object.<string, *>=} opt_geometryOrProperties\n * You may pass a Geometry object directly, or an object literal containing\n * properties. If you pass an object literal, you may include a Geometry\n * associated with a `geometry` key.\n * @api\n */\nconst Feature = function(opt_geometryOrProperties) {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {number|string|undefined}\n   */\n  this.id_ = undefined;\n\n  /**\n   * @type {string}\n   * @private\n   */\n  this.geometryName_ = 'geometry';\n\n  /**\n   * User provided style.\n   * @private\n   * @type {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction}\n   */\n  this.style_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Style~StyleFunction|undefined}\n   */\n  this.styleFunction_ = undefined;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.geometryChangeKey_ = null;\n\n  listen(\n    this, getChangeEventType(this.geometryName_),\n    this.handleGeometryChanged_, this);\n\n  if (opt_geometryOrProperties !== undefined) {\n    if (opt_geometryOrProperties instanceof Geometry ||\n        !opt_geometryOrProperties) {\n      const geometry = opt_geometryOrProperties;\n      this.setGeometry(geometry);\n    } else {\n      /** @type {Object.<string, *>} */\n      const properties = opt_geometryOrProperties;\n      this.setProperties(properties);\n    }\n  }\n};\n\ninherits(Feature, BaseObject);\n\n\n/**\n * Clone this feature. If the original feature has a geometry it\n * is also cloned. The feature id is not set in the clone.\n * @return {module:ol/Feature} The clone.\n * @api\n */\nFeature.prototype.clone = function() {\n  const clone = new Feature(this.getProperties());\n  clone.setGeometryName(this.getGeometryName());\n  const geometry = this.getGeometry();\n  if (geometry) {\n    clone.setGeometry(geometry.clone());\n  }\n  const style = this.getStyle();\n  if (style) {\n    clone.setStyle(style);\n  }\n  return clone;\n};\n\n\n/**\n * Get the feature's default geometry.  A feature may have any number of named\n * geometries.  The \"default\" geometry (the one that is rendered by default) is\n * set when calling {@link module:ol/Feature~Feature#setGeometry}.\n * @return {module:ol/geom/Geometry|undefined} The default geometry for the feature.\n * @api\n * @observable\n */\nFeature.prototype.getGeometry = function() {\n  return (\n    /** @type {module:ol/geom/Geometry|undefined} */ (this.get(this.geometryName_))\n  );\n};\n\n\n/**\n * Get the feature identifier.  This is a stable identifier for the feature and\n * is either set when reading data from a remote source or set explicitly by\n * calling {@link module:ol/Feature~Feature#setId}.\n * @return {number|string|undefined} Id.\n * @api\n */\nFeature.prototype.getId = function() {\n  return this.id_;\n};\n\n\n/**\n * Get the name of the feature's default geometry.  By default, the default\n * geometry is named `geometry`.\n * @return {string} Get the property name associated with the default geometry\n *     for this feature.\n * @api\n */\nFeature.prototype.getGeometryName = function() {\n  return this.geometryName_;\n};\n\n\n/**\n * Get the feature's style. Will return what was provided to the\n * {@link module:ol/Feature~Feature#setStyle} method.\n * @return {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} The feature style.\n * @api\n */\nFeature.prototype.getStyle = function() {\n  return this.style_;\n};\n\n\n/**\n * Get the feature's style function.\n * @return {module:ol/style/Style~StyleFunction|undefined} Return a function\n * representing the current style of this feature.\n * @api\n */\nFeature.prototype.getStyleFunction = function() {\n  return this.styleFunction_;\n};\n\n\n/**\n * @private\n */\nFeature.prototype.handleGeometryChange_ = function() {\n  this.changed();\n};\n\n\n/**\n * @private\n */\nFeature.prototype.handleGeometryChanged_ = function() {\n  if (this.geometryChangeKey_) {\n    unlistenByKey(this.geometryChangeKey_);\n    this.geometryChangeKey_ = null;\n  }\n  const geometry = this.getGeometry();\n  if (geometry) {\n    this.geometryChangeKey_ = listen(geometry,\n      EventType.CHANGE, this.handleGeometryChange_, this);\n  }\n  this.changed();\n};\n\n\n/**\n * Set the default geometry for the feature.  This will update the property\n * with the name returned by {@link module:ol/Feature~Feature#getGeometryName}.\n * @param {module:ol/geom/Geometry|undefined} geometry The new geometry.\n * @api\n * @observable\n */\nFeature.prototype.setGeometry = function(geometry) {\n  this.set(this.geometryName_, geometry);\n};\n\n\n/**\n * Set the style for the feature.  This can be a single style object, an array\n * of styles, or a function that takes a resolution and returns an array of\n * styles. If it is `null` the feature has no style (a `null` style).\n * @param {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} style Style for this feature.\n * @api\n * @fires module:ol/events/Event~Event#event:change\n */\nFeature.prototype.setStyle = function(style) {\n  this.style_ = style;\n  this.styleFunction_ = !style ? undefined : createStyleFunction(style);\n  this.changed();\n};\n\n\n/**\n * Set the feature id.  The feature id is considered stable and may be used when\n * requesting features or comparing identifiers returned from a remote source.\n * The feature id can be used with the\n * {@link module:ol/source/Vector~VectorSource#getFeatureById} method.\n * @param {number|string|undefined} id The feature id.\n * @api\n * @fires module:ol/events/Event~Event#event:change\n */\nFeature.prototype.setId = function(id) {\n  this.id_ = id;\n  this.changed();\n};\n\n\n/**\n * Set the property name to be used when getting the feature's default geometry.\n * When calling {@link module:ol/Feature~Feature#getGeometry}, the value of the property with\n * this name will be returned.\n * @param {string} name The property name of the default geometry.\n * @api\n */\nFeature.prototype.setGeometryName = function(name) {\n  unlisten(\n    this, getChangeEventType(this.geometryName_),\n    this.handleGeometryChanged_, this);\n  this.geometryName_ = name;\n  listen(\n    this, getChangeEventType(this.geometryName_),\n    this.handleGeometryChanged_, this);\n  this.handleGeometryChanged_();\n};\n\n\n/**\n * Convert the provided object into a feature style function.  Functions passed\n * through unchanged.  Arrays of module:ol/style/Style or single style objects wrapped\n * in a new feature style function.\n * @param {module:ol/style/Style~StyleFunction|!Array.<module:ol/style/Style>|!module:ol/style/Style} obj\n *     A feature style function, a single style, or an array of styles.\n * @return {module:ol/style/Style~StyleFunction} A style function.\n */\nexport function createStyleFunction(obj) {\n  if (typeof obj === 'function') {\n    return obj;\n  } else {\n    /**\n     * @type {Array.<module:ol/style/Style>}\n     */\n    let styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(obj instanceof Style,\n        41); // Expected an `module:ol/style/Style~Style` or an array of `module:ol/style/Style~Style`\n      styles = [obj];\n    }\n    return function() {\n      return styles;\n    };\n  }\n}\nexport default Feature;\n","/**\n * @module ol/ImageBase\n */\nimport {inherits} from './index.js';\nimport EventTarget from './events/EventTarget.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/events/EventTarget}\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number|undefined} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/ImageState} state State.\n */\nconst ImageBase = function(extent, resolution, pixelRatio, state) {\n\n  EventTarget.call(this);\n\n  /**\n   * @protected\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent = extent;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.resolution = resolution;\n\n  /**\n   * @protected\n   * @type {module:ol/ImageState}\n   */\n  this.state = state;\n\n};\n\ninherits(ImageBase, EventTarget);\n\n\n/**\n * @protected\n */\nImageBase.prototype.changed = function() {\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * @return {module:ol/extent~Extent} Extent.\n */\nImageBase.prototype.getExtent = function() {\n  return this.extent;\n};\n\n\n/**\n * @abstract\n * @return {HTMLCanvasElement|Image|HTMLVideoElement} Image.\n */\nImageBase.prototype.getImage = function() {};\n\n\n/**\n * @return {number} PixelRatio.\n */\nImageBase.prototype.getPixelRatio = function() {\n  return this.pixelRatio_;\n};\n\n\n/**\n * @return {number} Resolution.\n */\nImageBase.prototype.getResolution = function() {\n  return /** @type {number} */ (this.resolution);\n};\n\n\n/**\n * @return {module:ol/ImageState} State.\n */\nImageBase.prototype.getState = function() {\n  return this.state;\n};\n\n\n/**\n * Load not yet loaded URI.\n * @abstract\n */\nImageBase.prototype.load = function() {};\n\nexport default ImageBase;\n","/**\n * @module ol/ImageCanvas\n */\nimport {inherits} from './index.js';\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\n\n\n/**\n * A function that is called to trigger asynchronous canvas drawing.  It is\n * called with a \"done\" callback that should be called when drawing is done.\n * If any error occurs during drawing, the \"done\" callback should be called with\n * that error.\n *\n * @typedef {function(function(Error))} Loader\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/ImageBase}\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {HTMLCanvasElement} canvas Canvas.\n * @param {module:ol/ImageCanvas~Loader=} opt_loader Optional loader function to\n *     support asynchronous canvas drawing.\n */\nconst ImageCanvas = function(extent, resolution, pixelRatio, canvas, opt_loader) {\n\n  /**\n   * Optional canvas loader function.\n   * @type {?module:ol/ImageCanvas~Loader}\n   * @private\n   */\n  this.loader_ = opt_loader !== undefined ? opt_loader : null;\n\n  const state = opt_loader !== undefined ? ImageState.IDLE : ImageState.LOADED;\n\n  ImageBase.call(this, extent, resolution, pixelRatio, state);\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = canvas;\n\n  /**\n   * @private\n   * @type {Error}\n   */\n  this.error_ = null;\n\n};\n\ninherits(ImageCanvas, ImageBase);\n\n\n/**\n * Get any error associated with asynchronous rendering.\n * @return {Error} Any error that occurred during rendering.\n */\nImageCanvas.prototype.getError = function() {\n  return this.error_;\n};\n\n\n/**\n * Handle async drawing complete.\n * @param {Error} err Any error during drawing.\n * @private\n */\nImageCanvas.prototype.handleLoad_ = function(err) {\n  if (err) {\n    this.error_ = err;\n    this.state = ImageState.ERROR;\n  } else {\n    this.state = ImageState.LOADED;\n  }\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n */\nImageCanvas.prototype.load = function() {\n  if (this.state == ImageState.IDLE) {\n    this.state = ImageState.LOADING;\n    this.changed();\n    this.loader_(this.handleLoad_.bind(this));\n  }\n};\n\n\n/**\n * @return {HTMLCanvasElement} Canvas element.\n */\nImageCanvas.prototype.getImage = function() {\n  return this.canvas_;\n};\nexport default ImageCanvas;\n","/**\n * @module ol/ImageState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3\n};\n","/**\n * @module ol/Kinetic\n */\n\n/**\n * @classdesc\n * Implementation of inertial deceleration for map movement.\n *\n * @constructor\n * @param {number} decay Rate of decay (must be negative).\n * @param {number} minVelocity Minimum velocity (pixels/millisecond).\n * @param {number} delay Delay to consider to calculate the kinetic\n *     initial values (milliseconds).\n * @struct\n * @api\n */\nconst Kinetic = function(decay, minVelocity, delay) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.decay_ = decay;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minVelocity_ = minVelocity;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delay_ = delay;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.points_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.angle_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.initialVelocity_ = 0;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nKinetic.prototype.begin = function() {\n  this.points_.length = 0;\n  this.angle_ = 0;\n  this.initialVelocity_ = 0;\n};\n\n\n/**\n * @param {number} x X.\n * @param {number} y Y.\n */\nKinetic.prototype.update = function(x, y) {\n  this.points_.push(x, y, Date.now());\n};\n\n\n/**\n * @return {boolean} Whether we should do kinetic animation.\n */\nKinetic.prototype.end = function() {\n  if (this.points_.length < 6) {\n    // at least 2 points are required (i.e. there must be at least 6 elements\n    // in the array)\n    return false;\n  }\n  const delay = Date.now() - this.delay_;\n  const lastIndex = this.points_.length - 3;\n  if (this.points_[lastIndex + 2] < delay) {\n    // the last tracked point is too old, which means that the user stopped\n    // panning before releasing the map\n    return false;\n  }\n\n  // get the first point which still falls into the delay time\n  let firstIndex = lastIndex - 3;\n  while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {\n    firstIndex -= 3;\n  }\n\n  const duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];\n  // we don't want a duration of 0 (divide by zero)\n  // we also make sure the user panned for a duration of at least one frame\n  // (1/60s) to compute sane displacement values\n  if (duration < 1000 / 60) {\n    return false;\n  }\n\n  const dx = this.points_[lastIndex] - this.points_[firstIndex];\n  const dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];\n  this.angle_ = Math.atan2(dy, dx);\n  this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;\n  return this.initialVelocity_ > this.minVelocity_;\n};\n\n\n/**\n * @return {number} Total distance travelled (pixels).\n */\nKinetic.prototype.getDistance = function() {\n  return (this.minVelocity_ - this.initialVelocity_) / this.decay_;\n};\n\n\n/**\n * @return {number} Angle of the kinetic panning animation (radians).\n */\nKinetic.prototype.getAngle = function() {\n  return this.angle_;\n};\nexport default Kinetic;\n","/**\n * @module ol/LayerType\n */\n\n/**\n * A layer type used when creating layer renderers.\n * @enum {string}\n */\nexport default {\n  IMAGE: 'IMAGE',\n  TILE: 'TILE',\n  VECTOR_TILE: 'VECTOR_TILE',\n  VECTOR: 'VECTOR'\n};\n","/**\n * @module ol/Map\n */\nimport {inherits} from './index.js';\nimport PluggableMap from './PluggableMap.js';\nimport {defaults as defaultControls} from './control/util.js';\nimport {defaults as defaultInteractions} from './interaction.js';\nimport {assign} from './obj.js';\nimport CanvasImageLayerRenderer from './renderer/canvas/ImageLayer.js';\nimport CanvasMapRenderer from './renderer/canvas/Map.js';\nimport CanvasTileLayerRenderer from './renderer/canvas/TileLayer.js';\nimport CanvasVectorLayerRenderer from './renderer/canvas/VectorLayer.js';\nimport CanvasVectorTileLayerRenderer from './renderer/canvas/VectorTileLayer.js';\n\n/**\n * @classdesc\n * The map is the core component of OpenLayers. For a map to render, a view,\n * one or more layers, and a target container are needed:\n *\n *     import Map from 'ol/Map';\n *     import View from 'ol/View';\n *     import TileLayer from 'ol/layer/Tile';\n *     import OSM from 'ol/source/OSM';\n *\n *     var map = new Map({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM()\n *         })\n *       ],\n *       target: 'map'\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`. Note that {@link module:ol/layer/Group~Group}\n * is a subclass of {@link module:ol/layer/Base}, so layers entered in the\n * options or added with `addLayer` can be groups, which can contain further\n * groups, and so on.\n *\n * @constructor\n * @extends {module:ol/PluggableMap}\n * @param {module:ol/PluggableMap~MapOptions} options Map options.\n * @fires module:ol/MapBrowserEvent~MapBrowserEvent\n * @fires module:ol/MapEvent~MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nconst Map = function(options) {\n  options = assign({}, options);\n  if (!options.controls) {\n    options.controls = defaultControls();\n  }\n  if (!options.interactions) {\n    options.interactions = defaultInteractions();\n  }\n\n  PluggableMap.call(this, options);\n};\n\ninherits(Map, PluggableMap);\n\nMap.prototype.createRenderer = function() {\n  const renderer = new CanvasMapRenderer(this);\n  renderer.registerLayerRenderers([\n    CanvasImageLayerRenderer,\n    CanvasTileLayerRenderer,\n    CanvasVectorLayerRenderer,\n    CanvasVectorTileLayerRenderer\n  ]);\n  return renderer;\n};\n\nexport default Map;\n","/**\n * @module ol/MapBrowserEvent\n */\nimport {inherits} from './index.js';\nimport MapEvent from './MapEvent.js';\n\n/**\n * @classdesc\n * Events emitted as map browser events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map browser event.\n *\n * @constructor\n * @extends {module:ol/MapEvent}\n * @param {string} type Event type.\n * @param {module:ol/PluggableMap} map Map.\n * @param {Event} browserEvent Browser event.\n * @param {boolean=} opt_dragging Is the map currently being dragged?\n * @param {?module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n */\nconst MapBrowserEvent = function(type, map, browserEvent, opt_dragging, opt_frameState) {\n\n  MapEvent.call(this, type, map, opt_frameState);\n\n  /**\n   * The original browser event.\n   * @const\n   * @type {Event}\n   * @api\n   */\n  this.originalEvent = browserEvent;\n\n  /**\n   * The map pixel relative to the viewport corresponding to the original browser event.\n   * @type {module:ol~Pixel}\n   * @api\n   */\n  this.pixel = map.getEventPixel(browserEvent);\n\n  /**\n   * The coordinate in view projection corresponding to the original browser event.\n   * @type {module:ol/coordinate~Coordinate}\n   * @api\n   */\n  this.coordinate = map.getCoordinateFromPixel(this.pixel);\n\n  /**\n   * Indicates if the map is currently being dragged. Only set for\n   * `POINTERDRAG` and `POINTERMOVE` events. Default is `false`.\n   *\n   * @type {boolean}\n   * @api\n   */\n  this.dragging = opt_dragging !== undefined ? opt_dragging : false;\n\n};\n\ninherits(MapBrowserEvent, MapEvent);\n\n\n/**\n * Prevents the default browser action.\n * @see https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault\n * @override\n * @api\n */\nMapBrowserEvent.prototype.preventDefault = function() {\n  MapEvent.prototype.preventDefault.call(this);\n  this.originalEvent.preventDefault();\n};\n\n\n/**\n * Prevents further propagation of the current event.\n * @see https://developer.mozilla.org/en-US/docs/Web/API/event.stopPropagation\n * @override\n * @api\n */\nMapBrowserEvent.prototype.stopPropagation = function() {\n  MapEvent.prototype.stopPropagation.call(this);\n  this.originalEvent.stopPropagation();\n};\nexport default MapBrowserEvent;\n","/**\n * @module ol/MapBrowserEventHandler\n */\nimport {inherits} from './index.js';\nimport {DEVICE_PIXEL_RATIO} from './has.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapBrowserPointerEvent from './MapBrowserPointerEvent.js';\nimport {listen, unlistenByKey} from './events.js';\nimport EventTarget from './events/EventTarget.js';\nimport PointerEventType from './pointer/EventType.js';\nimport PointerEventHandler from './pointer/PointerEventHandler.js';\n\n/**\n * @param {module:ol/PluggableMap} map The map with the viewport to\n * listen to events on.\n * @param {number=} moveTolerance The minimal distance the pointer must travel\n * to trigger a move.\n * @constructor\n * @extends {module:ol/events/EventTarget}\n */\nconst MapBrowserEventHandler = function(map, moveTolerance) {\n\n  EventTarget.call(this);\n\n  /**\n   * This is the element that we will listen to the real events on.\n   * @type {module:ol/PluggableMap}\n   * @private\n   */\n  this.map_ = map;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.clickTimeoutId_ = 0;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.dragging_ = false;\n\n  /**\n   * @type {!Array.<module:ol/events~EventsKey>}\n   * @private\n   */\n  this.dragListenerKeys_ = [];\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.moveTolerance_ = moveTolerance ?\n    moveTolerance * DEVICE_PIXEL_RATIO : DEVICE_PIXEL_RATIO;\n\n  /**\n   * The most recent \"down\" type event (or null if none have occurred).\n   * Set on pointerdown.\n   * @type {module:ol/pointer/PointerEvent}\n   * @private\n   */\n  this.down_ = null;\n\n  const element = this.map_.getViewport();\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.activePointers_ = 0;\n\n  /**\n   * @type {!Object.<number, boolean>}\n   * @private\n   */\n  this.trackedTouches_ = {};\n\n  /**\n   * Event handler which generates pointer events for\n   * the viewport element.\n   *\n   * @type {module:ol/pointer/PointerEventHandler}\n   * @private\n   */\n  this.pointerEventHandler_ = new PointerEventHandler(element);\n\n  /**\n   * Event handler which generates pointer events for\n   * the document (used when dragging).\n   *\n   * @type {module:ol/pointer/PointerEventHandler}\n   * @private\n   */\n  this.documentPointerEventHandler_ = null;\n\n  /**\n   * @type {?module:ol/events~EventsKey}\n   * @private\n   */\n  this.pointerdownListenerKey_ = listen(this.pointerEventHandler_,\n    PointerEventType.POINTERDOWN,\n    this.handlePointerDown_, this);\n\n  /**\n   * @type {?module:ol/events~EventsKey}\n   * @private\n   */\n  this.relayedListenerKey_ = listen(this.pointerEventHandler_,\n    PointerEventType.POINTERMOVE,\n    this.relayEvent_, this);\n\n};\n\ninherits(MapBrowserEventHandler, EventTarget);\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.emulateClick_ = function(pointerEvent) {\n  let newEvent = new MapBrowserPointerEvent(\n    MapBrowserEventType.CLICK, this.map_, pointerEvent);\n  this.dispatchEvent(newEvent);\n  if (this.clickTimeoutId_ !== 0) {\n    // double-click\n    clearTimeout(this.clickTimeoutId_);\n    this.clickTimeoutId_ = 0;\n    newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.DBLCLICK, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n  } else {\n    // click\n    this.clickTimeoutId_ = setTimeout(function() {\n      this.clickTimeoutId_ = 0;\n      const newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.SINGLECLICK, this.map_, pointerEvent);\n      this.dispatchEvent(newEvent);\n    }.bind(this), 250);\n  }\n};\n\n\n/**\n * Keeps track on how many pointers are currently active.\n *\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.updateActivePointers_ = function(pointerEvent) {\n  const event = pointerEvent;\n\n  if (event.type == MapBrowserEventType.POINTERUP ||\n      event.type == MapBrowserEventType.POINTERCANCEL) {\n    delete this.trackedTouches_[event.pointerId];\n  } else if (event.type == MapBrowserEventType.POINTERDOWN) {\n    this.trackedTouches_[event.pointerId] = true;\n  }\n  this.activePointers_ = Object.keys(this.trackedTouches_).length;\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.handlePointerUp_ = function(pointerEvent) {\n  this.updateActivePointers_(pointerEvent);\n  const newEvent = new MapBrowserPointerEvent(\n    MapBrowserEventType.POINTERUP, this.map_, pointerEvent);\n  this.dispatchEvent(newEvent);\n\n  // We emulate click events on left mouse button click, touch contact, and pen\n  // contact. isMouseActionButton returns true in these cases (evt.button is set\n  // to 0).\n  // See http://www.w3.org/TR/pointerevents/#button-states\n  // We only fire click, singleclick, and doubleclick if nobody has called\n  // event.stopPropagation() or event.preventDefault().\n  if (!newEvent.propagationStopped && !this.dragging_ && this.isMouseActionButton_(pointerEvent)) {\n    this.emulateClick_(this.down_);\n  }\n\n  if (this.activePointers_ === 0) {\n    this.dragListenerKeys_.forEach(unlistenByKey);\n    this.dragListenerKeys_.length = 0;\n    this.dragging_ = false;\n    this.down_ = null;\n    this.documentPointerEventHandler_.dispose();\n    this.documentPointerEventHandler_ = null;\n  }\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @return {boolean} If the left mouse button was pressed.\n * @private\n */\nMapBrowserEventHandler.prototype.isMouseActionButton_ = function(pointerEvent) {\n  return pointerEvent.button === 0;\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.handlePointerDown_ = function(pointerEvent) {\n  this.updateActivePointers_(pointerEvent);\n  const newEvent = new MapBrowserPointerEvent(\n    MapBrowserEventType.POINTERDOWN, this.map_, pointerEvent);\n  this.dispatchEvent(newEvent);\n\n  this.down_ = pointerEvent;\n\n  if (this.dragListenerKeys_.length === 0) {\n    /* Set up a pointer event handler on the `document`,\n     * which is required when the pointer is moved outside\n     * the viewport when dragging.\n     */\n    this.documentPointerEventHandler_ =\n        new PointerEventHandler(document);\n\n    this.dragListenerKeys_.push(\n      listen(this.documentPointerEventHandler_,\n        MapBrowserEventType.POINTERMOVE,\n        this.handlePointerMove_, this),\n      listen(this.documentPointerEventHandler_,\n        MapBrowserEventType.POINTERUP,\n        this.handlePointerUp_, this),\n      /* Note that the listener for `pointercancel is set up on\n       * `pointerEventHandler_` and not `documentPointerEventHandler_` like\n       * the `pointerup` and `pointermove` listeners.\n       *\n       * The reason for this is the following: `TouchSource.vacuumTouches_()`\n       * issues `pointercancel` events, when there was no `touchend` for a\n       * `touchstart`. Now, let's say a first `touchstart` is registered on\n       * `pointerEventHandler_`. The `documentPointerEventHandler_` is set up.\n       * But `documentPointerEventHandler_` doesn't know about the first\n       * `touchstart`. If there is no `touchend` for the `touchstart`, we can\n       * only receive a `touchcancel` from `pointerEventHandler_`, because it is\n       * only registered there.\n       */\n      listen(this.pointerEventHandler_,\n        MapBrowserEventType.POINTERCANCEL,\n        this.handlePointerUp_, this)\n    );\n  }\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.handlePointerMove_ = function(pointerEvent) {\n  // Between pointerdown and pointerup, pointermove events are triggered.\n  // To avoid a 'false' touchmove event to be dispatched, we test if the pointer\n  // moved a significant distance.\n  if (this.isMoving_(pointerEvent)) {\n    this.dragging_ = true;\n    const newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERDRAG, this.map_, pointerEvent,\n      this.dragging_);\n    this.dispatchEvent(newEvent);\n  }\n\n  // Some native android browser triggers mousemove events during small period\n  // of time. See: https://code.google.com/p/android/issues/detail?id=5491 or\n  // https://code.google.com/p/android/issues/detail?id=19827\n  // ex: Galaxy Tab P3110 + Android 4.1.1\n  pointerEvent.preventDefault();\n};\n\n\n/**\n * Wrap and relay a pointer event.  Note that this requires that the type\n * string for the MapBrowserPointerEvent matches the PointerEvent type.\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.relayEvent_ = function(pointerEvent) {\n  const dragging = !!(this.down_ && this.isMoving_(pointerEvent));\n  this.dispatchEvent(new MapBrowserPointerEvent(\n    pointerEvent.type, this.map_, pointerEvent, dragging));\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @return {boolean} Is moving.\n * @private\n */\nMapBrowserEventHandler.prototype.isMoving_ = function(pointerEvent) {\n  return this.dragging_ ||\n      Math.abs(pointerEvent.clientX - this.down_.clientX) > this.moveTolerance_ ||\n      Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_;\n};\n\n\n/**\n * @inheritDoc\n */\nMapBrowserEventHandler.prototype.disposeInternal = function() {\n  if (this.relayedListenerKey_) {\n    unlistenByKey(this.relayedListenerKey_);\n    this.relayedListenerKey_ = null;\n  }\n  if (this.pointerdownListenerKey_) {\n    unlistenByKey(this.pointerdownListenerKey_);\n    this.pointerdownListenerKey_ = null;\n  }\n\n  this.dragListenerKeys_.forEach(unlistenByKey);\n  this.dragListenerKeys_.length = 0;\n\n  if (this.documentPointerEventHandler_) {\n    this.documentPointerEventHandler_.dispose();\n    this.documentPointerEventHandler_ = null;\n  }\n  if (this.pointerEventHandler_) {\n    this.pointerEventHandler_.dispose();\n    this.pointerEventHandler_ = null;\n  }\n  EventTarget.prototype.disposeInternal.call(this);\n};\nexport default MapBrowserEventHandler;\n","/**\n * @module ol/MapBrowserEventType\n */\nimport EventType from './events/EventType.js';\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n\n  /**\n   * A true single click with no dragging and no double click. Note that this\n   * event is delayed by 250 ms to ensure that it is not a double click.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#singleclick\n   * @api\n   */\n  SINGLECLICK: 'singleclick',\n\n  /**\n   * A click with no dragging. A double click will fire two of this.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#click\n   * @api\n   */\n  CLICK: EventType.CLICK,\n\n  /**\n   * A true double click, with no dragging.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#dblclick\n   * @api\n   */\n  DBLCLICK: EventType.DBLCLICK,\n\n  /**\n   * Triggered when a pointer is dragged.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointerdrag\n   * @api\n   */\n  POINTERDRAG: 'pointerdrag',\n\n  /**\n   * Triggered when a pointer is moved. Note that on touch devices this is\n   * triggered when the map is panned, so is not the same as mousemove.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointermove\n   * @api\n   */\n  POINTERMOVE: 'pointermove',\n\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n","/**\n * @module ol/MapBrowserPointerEvent\n */\nimport {inherits} from './index.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\n\n/**\n * @constructor\n * @extends {module:ol/MapBrowserEvent}\n * @param {string} type Event type.\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @param {boolean=} opt_dragging Is the map currently being dragged?\n * @param {?module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n */\nconst MapBrowserPointerEvent = function(type, map, pointerEvent, opt_dragging,\n  opt_frameState) {\n\n  MapBrowserEvent.call(this, type, map, pointerEvent.originalEvent, opt_dragging,\n    opt_frameState);\n\n  /**\n   * @const\n   * @type {module:ol/pointer/PointerEvent}\n   */\n  this.pointerEvent = pointerEvent;\n\n};\n\ninherits(MapBrowserPointerEvent, MapBrowserEvent);\nexport default MapBrowserPointerEvent;\n","/**\n * @module ol/MapEvent\n */\nimport {inherits} from './index.js';\nimport Event from './events/Event.js';\n\n/**\n * @classdesc\n * Events emitted as map events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map event.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Event type.\n * @param {module:ol/PluggableMap} map Map.\n * @param {?module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n */\nconst MapEvent = function(type, map, opt_frameState) {\n\n  Event.call(this, type);\n\n  /**\n   * The map where the event occurred.\n   * @type {module:ol/PluggableMap}\n   * @api\n   */\n  this.map = map;\n\n  /**\n   * The frame state at the time of the event.\n   * @type {?module:ol/PluggableMap~FrameState}\n   * @api\n   */\n  this.frameState = opt_frameState !== undefined ? opt_frameState : null;\n\n};\n\ninherits(MapEvent, Event);\nexport default MapEvent;\n","/**\n * @module ol/MapEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered after a map frame is rendered.\n   * @event module:ol/MapEvent~MapEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered when the map starts moving.\n   * @event module:ol/MapEvent~MapEvent#movestart\n   * @api\n   */\n  MOVESTART: 'movestart',\n\n  /**\n   * Triggered after the map is moved.\n   * @event module:ol/MapEvent~MapEvent#moveend\n   * @api\n   */\n  MOVEEND: 'moveend'\n\n};\n","/**\n * @module ol/MapProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LAYERGROUP: 'layergroup',\n  SIZE: 'size',\n  TARGET: 'target',\n  VIEW: 'view'\n};\n","/**\n * @module ol/Object\n */\nimport {getUid, inherits} from './index.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport Observable from './Observable.js';\nimport Event from './events/Event.js';\nimport {assign} from './obj.js';\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Object~BaseObject} instances are instances of\n * this type.\n *\n * @param {string} type The event type.\n * @param {string} key The property name.\n * @param {*} oldValue The old value for `key`.\n * @extends {module:ol/events/Event}\n * @constructor\n */\nconst ObjectEvent = function(type, key, oldValue) {\n  Event.call(this, type);\n\n  /**\n   * The name of the property whose value is changing.\n   * @type {string}\n   * @api\n   */\n  this.key = key;\n\n  /**\n   * The old value. To get the new value use `e.target.get(e.key)` where\n   * `e` is the event object.\n   * @type {*}\n   * @api\n   */\n  this.oldValue = oldValue;\n\n};\ninherits(ObjectEvent, Event);\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Most non-trivial classes inherit from this.\n *\n * This extends {@link module:ol/Observable} with observable\n * properties, where each property is observable as well as the object as a\n * whole.\n *\n * Classes that inherit from this have pre-defined properties, to which you can\n * add your owns. The pre-defined properties are listed in this documentation as\n * 'Observable Properties', and have their own accessors; for example,\n * {@link module:ol/Map~Map} has a `target` property, accessed with\n * `getTarget()` and changed with `setTarget()`. Not all properties are however\n * settable. There are also general-purpose accessors `get()` and `set()`. For\n * example, `get('target')` is equivalent to `getTarget()`.\n *\n * The `set` accessors trigger a change event, and you can monitor this by\n * registering a listener. For example, {@link module:ol/View~View} has a\n * `center` property, so `view.on('change:center', function(evt) {...});` would\n * call the function whenever the value of the center property changes. Within\n * the function, `evt.target` would be the view, so `evt.target.getCenter()`\n * would return the new center.\n *\n * You can add your own observable properties with\n * `object.set('prop', 'value')`, and retrieve that with `object.get('prop')`.\n * You can listen for changes on that property value with\n * `object.on('change:prop', listener)`. You can get a list of all\n * properties with {@link module:ol/Object~BaseObject#getProperties}.\n *\n * Note that the observable properties are separate from standard JS properties.\n * You can, for example, give your map object a title with\n * `map.title='New title'` and with `map.set('title', 'Another title')`. The\n * first will be a `hasOwnProperty`; the second will appear in\n * `getProperties()`. Only the second is observable.\n *\n * Properties can be deleted by using the unset method. E.g.\n * object.unset('foo').\n *\n * @constructor\n * @extends {module:ol/Observable}\n * @param {Object.<string, *>=} opt_values An object with key-value pairs.\n * @fires module:ol/Object~ObjectEvent\n * @api\n */\nconst BaseObject = function(opt_values) {\n  Observable.call(this);\n\n  // Call {@link module:ol~getUid} to ensure that the order of objects' ids is\n  // the same as the order in which they were created.  This also helps to\n  // ensure that object properties are always added in the same order, which\n  // helps many JavaScript engines generate faster code.\n  getUid(this);\n\n  /**\n   * @private\n   * @type {!Object.<string, *>}\n   */\n  this.values_ = {};\n\n  if (opt_values !== undefined) {\n    this.setProperties(opt_values);\n  }\n};\n\ninherits(BaseObject, Observable);\n\n\n/**\n * @type {Object.<string, string>}\n */\nconst changeEventTypeCache = {};\n\n\n/**\n * @param {string} key Key name.\n * @return {string} Change name.\n */\nexport function getChangeEventType(key) {\n  return changeEventTypeCache.hasOwnProperty(key) ?\n    changeEventTypeCache[key] :\n    (changeEventTypeCache[key] = 'change:' + key);\n}\n\n\n/**\n * Gets a value.\n * @param {string} key Key name.\n * @return {*} Value.\n * @api\n */\nBaseObject.prototype.get = function(key) {\n  let value;\n  if (this.values_.hasOwnProperty(key)) {\n    value = this.values_[key];\n  }\n  return value;\n};\n\n\n/**\n * Get a list of object property names.\n * @return {Array.<string>} List of property names.\n * @api\n */\nBaseObject.prototype.getKeys = function() {\n  return Object.keys(this.values_);\n};\n\n\n/**\n * Get an object of all property names and values.\n * @return {Object.<string, *>} Object.\n * @api\n */\nBaseObject.prototype.getProperties = function() {\n  return assign({}, this.values_);\n};\n\n\n/**\n * @param {string} key Key name.\n * @param {*} oldValue Old value.\n */\nBaseObject.prototype.notify = function(key, oldValue) {\n  let eventType;\n  eventType = getChangeEventType(key);\n  this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n  eventType = ObjectEventType.PROPERTYCHANGE;\n  this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n};\n\n\n/**\n * Sets a value.\n * @param {string} key Key name.\n * @param {*} value Value.\n * @param {boolean=} opt_silent Update without triggering an event.\n * @api\n */\nBaseObject.prototype.set = function(key, value, opt_silent) {\n  if (opt_silent) {\n    this.values_[key] = value;\n  } else {\n    const oldValue = this.values_[key];\n    this.values_[key] = value;\n    if (oldValue !== value) {\n      this.notify(key, oldValue);\n    }\n  }\n};\n\n\n/**\n * Sets a collection of key-value pairs.  Note that this changes any existing\n * properties and adds new ones (it does not remove any existing properties).\n * @param {Object.<string, *>} values Values.\n * @param {boolean=} opt_silent Update without triggering an event.\n * @api\n */\nBaseObject.prototype.setProperties = function(values, opt_silent) {\n  for (const key in values) {\n    this.set(key, values[key], opt_silent);\n  }\n};\n\n\n/**\n * Unsets a property.\n * @param {string} key Key name.\n * @param {boolean=} opt_silent Unset without triggering an event.\n * @api\n */\nBaseObject.prototype.unset = function(key, opt_silent) {\n  if (key in this.values_) {\n    const oldValue = this.values_[key];\n    delete this.values_[key];\n    if (!opt_silent) {\n      this.notify(key, oldValue);\n    }\n  }\n};\n\n\nexport default BaseObject;\n","/**\n * @module ol/ObjectEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a property is changed.\n   * @event module:ol/Object~ObjectEvent#propertychange\n   * @api\n   */\n  PROPERTYCHANGE: 'propertychange'\n};\n","/**\n * @module ol/Observable\n */\nimport {inherits} from './index.js';\nimport {listen, unlistenByKey, unlisten, listenOnce} from './events.js';\nimport EventTarget from './events/EventTarget.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * An event target providing convenient methods for listener registration\n * and unregistration. A generic `change` event is always available through\n * {@link module:ol/Observable~Observable#changed}.\n *\n * @constructor\n * @extends {module:ol/events/EventTarget}\n * @fires module:ol/events/Event~Event\n * @struct\n * @api\n */\nconst Observable = function() {\n\n  EventTarget.call(this);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.revision_ = 0;\n\n};\n\ninherits(Observable, EventTarget);\n\n\n/**\n * Removes an event listener using the key returned by `on()` or `once()`.\n * @param {module:ol/events~EventsKey|Array.<module:ol/events~EventsKey>} key The key returned by `on()`\n *     or `once()` (or an array of keys).\n * @api\n */\nexport function unByKey(key) {\n  if (Array.isArray(key)) {\n    for (let i = 0, ii = key.length; i < ii; ++i) {\n      unlistenByKey(key[i]);\n    }\n  } else {\n    unlistenByKey(/** @type {module:ol/events~EventsKey} */ (key));\n  }\n}\n\n\n/**\n * Increases the revision counter and dispatches a 'change' event.\n * @api\n */\nObservable.prototype.changed = function() {\n  ++this.revision_;\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * Dispatches an event and calls all listeners listening for events\n * of this type. The event parameter can either be a string or an\n * Object with a `type` property.\n *\n * @param {{type: string,\n *     target: (EventTarget|module:ol/events/EventTarget|undefined)}|\n *     module:ol/events/Event|string} event Event object.\n * @function\n * @api\n */\nObservable.prototype.dispatchEvent;\n\n\n/**\n * Get the version number for this object.  Each time the object is modified,\n * its version number will be incremented.\n * @return {number} Revision.\n * @api\n */\nObservable.prototype.getRevision = function() {\n  return this.revision_;\n};\n\n\n/**\n * Listen for a certain type of event.\n * @param {string|Array.<string>} type The event type or array of event types.\n * @param {function(?): ?} listener The listener function.\n * @return {module:ol/events~EventsKey|Array.<module:ol/events~EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.on = function(type, listener) {\n  if (Array.isArray(type)) {\n    const len = type.length;\n    const keys = new Array(len);\n    for (let i = 0; i < len; ++i) {\n      keys[i] = listen(this, type[i], listener);\n    }\n    return keys;\n  } else {\n    return listen(this, /** @type {string} */ (type), listener);\n  }\n};\n\n\n/**\n * Listen once for a certain type of event.\n * @param {string|Array.<string>} type The event type or array of event types.\n * @param {function(?): ?} listener The listener function.\n * @return {module:ol/events~EventsKey|Array.<module:ol/events~EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.once = function(type, listener) {\n  if (Array.isArray(type)) {\n    const len = type.length;\n    const keys = new Array(len);\n    for (let i = 0; i < len; ++i) {\n      keys[i] = listenOnce(this, type[i], listener);\n    }\n    return keys;\n  } else {\n    return listenOnce(this, /** @type {string} */ (type), listener);\n  }\n};\n\n\n/**\n * Unlisten for a certain type of event.\n * @param {string|Array.<string>} type The event type or array of event types.\n * @param {function(?): ?} listener The listener function.\n * @api\n */\nObservable.prototype.un = function(type, listener) {\n  if (Array.isArray(type)) {\n    for (let i = 0, ii = type.length; i < ii; ++i) {\n      unlisten(this, type[i], listener);\n    }\n    return;\n  } else {\n    unlisten(this, /** @type {string} */ (type), listener);\n  }\n};\nexport default Observable;\n","/**\n * @module ol/PluggableMap\n */\nimport {getUid, inherits} from './index.js';\nimport Collection from './Collection.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventHandler from './MapBrowserEventHandler.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapEvent from './MapEvent.js';\nimport MapEventType from './MapEventType.js';\nimport MapProperty from './MapProperty.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport TileQueue from './TileQueue.js';\nimport View from './View.js';\nimport ViewHint from './ViewHint.js';\nimport {assert} from './asserts.js';\nimport {removeNode} from './dom.js';\nimport {listen, unlistenByKey, unlisten} from './events.js';\nimport {stopPropagation} from './events/Event.js';\nimport EventType from './events/EventType.js';\nimport {createEmpty, clone, createOrUpdateEmpty, equals, getForViewAndSize, isEmpty} from './extent.js';\nimport {TRUE} from './functions.js';\nimport {DEVICE_PIXEL_RATIO, TOUCH} from './has.js';\nimport LayerGroup from './layer/Group.js';\nimport {hasArea} from './size.js';\nimport {DROP} from './structs/PriorityQueue.js';\nimport {create as createTransform, apply as applyTransform} from './transform.js';\n\n\n/**\n * State of the current frame. Only `pixelRatio`, `time` and `viewState` should\n * be used in applications.\n * @typedef {Object} FrameState\n * @property {number} pixelRatio The pixel ratio of the frame.\n * @property {number} time The time when rendering of the frame was requested.\n * @property {module:ol/View~State} viewState The state of the current view.\n * @property {boolean} animate\n * @property {module:ol/transform~Transform} coordinateToPixelTransform\n * @property {null|module:ol/extent~Extent} extent\n * @property {module:ol/coordinate~Coordinate} focus\n * @property {number} index\n * @property {Object.<number, module:ol/layer/Layer~State>} layerStates\n * @property {Array.<module:ol/layer/Layer~State>} layerStatesArray\n * @property {module:ol/transform~Transform} pixelToCoordinateTransform\n * @property {Array.<module:ol/PluggableMap~PostRenderFunction>} postRenderFunctions\n * @property {module:ol/size~Size} size\n * @property {!Object.<string, boolean>} skippedFeatureUids\n * @property {module:ol/TileQueue} tileQueue\n * @property {Object.<string, Object.<string, module:ol/TileRange>>} usedTiles\n * @property {Array.<number>} viewHints\n * @property {!Object.<string, Object.<string, boolean>>} wantedTiles\n */\n\n\n/**\n * @typedef {function(module:ol/PluggableMap, ?module:ol/PluggableMap~FrameState): boolean} PostRenderFunction\n */\n\n\n/**\n * @typedef {Object} AtPixelOptions\n * @property {((function(module:ol/layer/Layer): boolean)|undefined)} layerFilter Layer filter\n * function. The filter function will receive one argument, the\n * {@link module:ol/layer/Layer layer-candidate} and it should return a boolean value.\n * Only layers which are visible and for which this function returns `true`\n * will be tested for features. By default, all visible layers will be tested.\n * @property {number} [hitTolerance=0] Hit-detection tolerance in pixels. Pixels\n * inside the radius around the given position will be checked for features. This only\n * works for the canvas renderer and not for WebGL.\n */\n\n\n/**\n * @typedef {Object} MapOptionsInternal\n * @property {module:ol/Collection.<module:ol/control/Control>} [controls]\n * @property {module:ol/Collection.<module:ol/interaction/Interaction>} [interactions]\n * @property {Element|Document} keyboardEventTarget\n * @property {module:ol/Collection.<module:ol/Overlay>} overlays\n * @property {Object.<string, *>} values\n */\n\n\n/**\n * Object literal with config options for the map.\n * @typedef {Object} MapOptions\n * @property {module:ol/Collection.<module:ol/control/Control>|Array.<module:ol/control/Control>} [controls]\n * Controls initially added to the map. If not specified,\n * {@link module:ol/control/util~defaults} is used.\n * @property {number} [pixelRatio=window.devicePixelRatio] The ratio between\n * physical pixels and device-independent pixels (dips) on the device.\n * @property {module:ol/Collection.<module:ol/interaction/Interaction>|Array.<module:ol/interaction/Interaction>} [interactions]\n * Interactions that are initially added to the map. If not specified,\n * {@link module:ol/interaction~defaults} is used.\n * @property {Element|Document|string} [keyboardEventTarget] The element to\n * listen to keyboard events on. This determines when the `KeyboardPan` and\n * `KeyboardZoom` interactions trigger. For example, if this option is set to\n * `document` the keyboard interactions will always trigger. If this option is\n * not specified, the element the library listens to keyboard events on is the\n * map target (i.e. the user-provided div for the map). If this is not\n * `document`, the target element needs to be focused for key events to be\n * emitted, requiring that the target element has a `tabindex` attribute.\n * @property {Array.<module:ol/layer/Base>|module:ol/Collection.<module:ol/layer/Base>} [layers]\n * Layers. If this is not defined, a map with no layers will be rendered. Note\n * that layers are rendered in the order supplied, so if you want, for example,\n * a vector layer to appear on top of a tile layer, it must come after the tile\n * layer.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load\n * simultaneously.\n * @property {boolean} [loadTilesWhileAnimating=false] When set to `true`, tiles\n * will be loaded during animations. This may improve the user experience, but\n * can also make animations stutter on devices with slow memory.\n * @property {boolean} [loadTilesWhileInteracting=false] When set to `true`,\n * tiles will be loaded while interacting with the map. This may improve the\n * user experience, but can also make map panning and zooming choppy on devices\n * with slow memory.\n * @property {number} [moveTolerance=1] The minimum distance in pixels the\n * cursor must move to be detected as a map move event instead of a click.\n * Increasing this value can make it easier to click on the map.\n * @property {module:ol/Collection.<module:ol/Overlay>|Array.<module:ol/Overlay>} [overlays]\n * Overlays initially added to the map. By default, no overlays are added.\n * @property {Element|string} [target] The container for the map, either the\n * element itself or the `id` of the element. If not specified at construction\n * time, {@link module:ol/Map~Map#setTarget} must be called for the map to be\n * rendered.\n * @property {module:ol/View} [view] The map's view.  No layer sources will be\n * fetched unless this is specified at construction time or through\n * {@link module:ol/Map~Map#setView}.\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/PluggableMap~MapOptions} options Map options.\n * @fires module:ol/MapBrowserEvent~MapBrowserEvent\n * @fires module:ol/MapEvent~MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nconst PluggableMap = function(options) {\n\n  BaseObject.call(this);\n\n  const optionsInternal = createOptionsInternal(options);\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxTilesLoading_ = options.maxTilesLoading !== undefined ? options.maxTilesLoading : 16;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.loadTilesWhileAnimating_ =\n      options.loadTilesWhileAnimating !== undefined ?\n        options.loadTilesWhileAnimating : false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.loadTilesWhileInteracting_ =\n      options.loadTilesWhileInteracting !== undefined ?\n        options.loadTilesWhileInteracting : false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = options.pixelRatio !== undefined ?\n    options.pixelRatio : DEVICE_PIXEL_RATIO;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.animationDelayKey_;\n\n  /**\n   * @private\n   */\n  this.animationDelay_ = function() {\n    this.animationDelayKey_ = undefined;\n    this.renderFrame_.call(this, Date.now());\n  }.bind(this);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.coordinateToPixelTransform_ = createTransform();\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.pixelToCoordinateTransform_ = createTransform();\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.frameIndex_ = 0;\n\n  /**\n   * @private\n   * @type {?module:ol/PluggableMap~FrameState}\n   */\n  this.frameState_ = null;\n\n  /**\n   * The extent at the previous 'moveend' event.\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.previousExtent_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.viewPropertyListenerKey_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.viewChangeListenerKey_ = null;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.layerGroupPropertyListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.viewport_ = document.createElement('DIV');\n  this.viewport_.className = 'ol-viewport' + (TOUCH ? ' ol-touch' : '');\n  this.viewport_.style.position = 'relative';\n  this.viewport_.style.overflow = 'hidden';\n  this.viewport_.style.width = '100%';\n  this.viewport_.style.height = '100%';\n  // prevent page zoom on IE >= 10 browsers\n  this.viewport_.style.msTouchAction = 'none';\n  this.viewport_.style.touchAction = 'none';\n\n  /**\n   * @private\n   * @type {!Element}\n   */\n  this.overlayContainer_ = document.createElement('DIV');\n  this.overlayContainer_.className = 'ol-overlaycontainer';\n  this.viewport_.appendChild(this.overlayContainer_);\n\n  /**\n   * @private\n   * @type {!Element}\n   */\n  this.overlayContainerStopEvent_ = document.createElement('DIV');\n  this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n  const overlayEvents = [\n    EventType.CLICK,\n    EventType.DBLCLICK,\n    EventType.MOUSEDOWN,\n    EventType.TOUCHSTART,\n    EventType.MSPOINTERDOWN,\n    MapBrowserEventType.POINTERDOWN,\n    EventType.MOUSEWHEEL,\n    EventType.WHEEL\n  ];\n  for (let i = 0, ii = overlayEvents.length; i < ii; ++i) {\n    listen(this.overlayContainerStopEvent_, overlayEvents[i], stopPropagation);\n  }\n  this.viewport_.appendChild(this.overlayContainerStopEvent_);\n\n  /**\n   * @private\n   * @type {module:ol/MapBrowserEventHandler}\n   */\n  this.mapBrowserEventHandler_ = new MapBrowserEventHandler(this, options.moveTolerance);\n  for (const key in MapBrowserEventType) {\n    listen(this.mapBrowserEventHandler_, MapBrowserEventType[key],\n      this.handleMapBrowserEvent, this);\n  }\n\n  /**\n   * @private\n   * @type {Element|Document}\n   */\n  this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.keyHandlerKeys_ = null;\n\n  listen(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n  listen(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n  listen(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n\n  /**\n   * @type {module:ol/Collection.<module:ol/control/Control>}\n   * @protected\n   */\n  this.controls = optionsInternal.controls || new Collection();\n\n  /**\n   * @type {module:ol/Collection.<module:ol/interaction/Interaction>}\n   * @protected\n   */\n  this.interactions = optionsInternal.interactions || new Collection();\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Overlay>}\n   * @private\n   */\n  this.overlays_ = optionsInternal.overlays;\n\n  /**\n   * A lookup of overlays by id.\n   * @private\n   * @type {Object.<string, module:ol/Overlay>}\n   */\n  this.overlayIdIndex_ = {};\n\n  /**\n   * @type {module:ol/renderer/Map}\n   * @private\n   */\n  this.renderer_ = this.createRenderer(this.viewport_, this);\n\n  /**\n   * @type {function(Event)|undefined}\n   * @private\n   */\n  this.handleResize_;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.focus_ = null;\n\n  /**\n   * @private\n   * @type {!Array.<module:ol/PluggableMap~PostRenderFunction>}\n   */\n  this.postRenderFunctions_ = [];\n\n  /**\n   * @private\n   * @type {module:ol/TileQueue}\n   */\n  this.tileQueue_ = new TileQueue(\n    this.getTilePriority.bind(this),\n    this.handleTileChange_.bind(this));\n\n  /**\n   * Uids of features to skip at rendering time.\n   * @type {Object.<string, boolean>}\n   * @private\n   */\n  this.skippedFeatureUids_ = {};\n\n  listen(\n    this, getChangeEventType(MapProperty.LAYERGROUP),\n    this.handleLayerGroupChanged_, this);\n  listen(this, getChangeEventType(MapProperty.VIEW),\n    this.handleViewChanged_, this);\n  listen(this, getChangeEventType(MapProperty.SIZE),\n    this.handleSizeChanged_, this);\n  listen(this, getChangeEventType(MapProperty.TARGET),\n    this.handleTargetChanged_, this);\n\n  // setProperties will trigger the rendering of the map if the map\n  // is \"defined\" already.\n  this.setProperties(optionsInternal.values);\n\n  this.controls.forEach(\n    /**\n     * @param {module:ol/control/Control} control Control.\n     * @this {module:ol/PluggableMap}\n     */\n    (function(control) {\n      control.setMap(this);\n    }).bind(this));\n\n  listen(this.controls, CollectionEventType.ADD,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(this);\n    }, this);\n\n  listen(this.controls, CollectionEventType.REMOVE,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(null);\n    }, this);\n\n  this.interactions.forEach(\n    /**\n     * @param {module:ol/interaction/Interaction} interaction Interaction.\n     * @this {module:ol/PluggableMap}\n     */\n    (function(interaction) {\n      interaction.setMap(this);\n    }).bind(this));\n\n  listen(this.interactions, CollectionEventType.ADD,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(this);\n    }, this);\n\n  listen(this.interactions, CollectionEventType.REMOVE,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(null);\n    }, this);\n\n  this.overlays_.forEach(this.addOverlayInternal_.bind(this));\n\n  listen(this.overlays_, CollectionEventType.ADD,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      this.addOverlayInternal_(/** @type {module:ol/Overlay} */ (event.element));\n    }, this);\n\n  listen(this.overlays_, CollectionEventType.REMOVE,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      const overlay = /** @type {module:ol/Overlay} */ (event.element);\n      const id = overlay.getId();\n      if (id !== undefined) {\n        delete this.overlayIdIndex_[id.toString()];\n      }\n      event.element.setMap(null);\n    }, this);\n\n};\n\ninherits(PluggableMap, BaseObject);\n\n\nPluggableMap.prototype.createRenderer = function() {\n  throw new Error('Use a map type that has a createRenderer method');\n};\n\n\n/**\n * Add the given control to the map.\n * @param {module:ol/control/Control} control Control.\n * @api\n */\nPluggableMap.prototype.addControl = function(control) {\n  this.getControls().push(control);\n};\n\n\n/**\n * Add the given interaction to the map.\n * @param {module:ol/interaction/Interaction} interaction Interaction to add.\n * @api\n */\nPluggableMap.prototype.addInteraction = function(interaction) {\n  this.getInteractions().push(interaction);\n};\n\n\n/**\n * Adds the given layer to the top of this map. If you want to add a layer\n * elsewhere in the stack, use `getLayers()` and the methods available on\n * {@link module:ol/Collection~Collection}.\n * @param {module:ol/layer/Base} layer Layer.\n * @api\n */\nPluggableMap.prototype.addLayer = function(layer) {\n  const layers = this.getLayerGroup().getLayers();\n  layers.push(layer);\n};\n\n\n/**\n * Add the given overlay to the map.\n * @param {module:ol/Overlay} overlay Overlay.\n * @api\n */\nPluggableMap.prototype.addOverlay = function(overlay) {\n  this.getOverlays().push(overlay);\n};\n\n\n/**\n * This deals with map's overlay collection changes.\n * @param {module:ol/Overlay} overlay Overlay.\n * @private\n */\nPluggableMap.prototype.addOverlayInternal_ = function(overlay) {\n  const id = overlay.getId();\n  if (id !== undefined) {\n    this.overlayIdIndex_[id.toString()] = overlay;\n  }\n  overlay.setMap(this);\n};\n\n\n/**\n *\n * @inheritDoc\n */\nPluggableMap.prototype.disposeInternal = function() {\n  this.mapBrowserEventHandler_.dispose();\n  unlisten(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n  unlisten(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n  unlisten(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n  if (this.handleResize_ !== undefined) {\n    removeEventListener(EventType.RESIZE, this.handleResize_, false);\n    this.handleResize_ = undefined;\n  }\n  if (this.animationDelayKey_) {\n    cancelAnimationFrame(this.animationDelayKey_);\n    this.animationDelayKey_ = undefined;\n  }\n  this.setTarget(null);\n  BaseObject.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Detect features that intersect a pixel on the viewport, and execute a\n * callback with each intersecting feature. Layers included in the detection can\n * be configured through the `layerFilter` option in `opt_options`.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature),\n *     module:ol/layer/Layer): T} callback Feature callback. The callback will be\n *     called with two arguments. The first argument is one\n *     {@link module:ol/Feature feature} or\n *     {@link module:ol/render/Feature render feature} at the pixel, the second is\n *     the {@link module:ol/layer/Layer layer} of the feature and will be null for\n *     unmanaged layers. To stop detection, callback functions can return a\n *     truthy value.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Optional options.\n * @return {T|undefined} Callback result, i.e. the return value of last\n * callback execution, or the first truthy callback return value.\n * @template S,T\n * @api\n */\nPluggableMap.prototype.forEachFeatureAtPixel = function(pixel, callback, opt_options) {\n  if (!this.frameState_) {\n    return;\n  }\n  const coordinate = this.getCoordinateFromPixel(pixel);\n  opt_options = opt_options !== undefined ? opt_options : {};\n  const hitTolerance = opt_options.hitTolerance !== undefined ?\n    opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n  const layerFilter = opt_options.layerFilter !== undefined ?\n    opt_options.layerFilter : TRUE;\n  return this.renderer_.forEachFeatureAtCoordinate(\n    coordinate, this.frameState_, hitTolerance, callback, null,\n    layerFilter, null);\n};\n\n\n/**\n * Get all features that intersect a pixel on the viewport.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Optional options.\n * @return {Array.<module:ol/Feature|module:ol/render/Feature>} The detected features or\n * `null` if none were found.\n * @api\n */\nPluggableMap.prototype.getFeaturesAtPixel = function(pixel, opt_options) {\n  let features = null;\n  this.forEachFeatureAtPixel(pixel, function(feature) {\n    if (!features) {\n      features = [];\n    }\n    features.push(feature);\n  }, opt_options);\n  return features;\n};\n\n/**\n * Detect layers that have a color value at a pixel on the viewport, and\n * execute a callback with each matching layer. Layers included in the\n * detection can be configured through `opt_layerFilter`.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback\n *     Layer callback. This callback will receive two arguments: first is the\n *     {@link module:ol/layer/Layer layer}, second argument is an array representing\n *     [R, G, B, A] pixel values (0 - 255) and will be `null` for layer types\n *     that do not currently support this argument. To stop detection, callback\n *     functions can return a truthy value.\n * @param {S=} opt_this Value to use as `this` when executing `callback`.\n * @param {(function(this: U, module:ol/layer/Layer): boolean)=} opt_layerFilter Layer\n *     filter function. The filter function will receive one argument, the\n *     {@link module:ol/layer/Layer layer-candidate} and it should return a boolean\n *     value. Only layers which are visible and for which this function returns\n *     `true` will be tested for features. By default, all visible layers will\n *     be tested.\n * @param {U=} opt_this2 Value to use as `this` when executing `layerFilter`.\n * @return {T|undefined} Callback result, i.e. the return value of last\n * callback execution, or the first truthy callback return value.\n * @template S,T,U\n * @api\n */\nPluggableMap.prototype.forEachLayerAtPixel = function(pixel, callback, opt_this, opt_layerFilter, opt_this2) {\n  if (!this.frameState_) {\n    return;\n  }\n  const thisArg = opt_this !== undefined ? opt_this : null;\n  const layerFilter = opt_layerFilter !== undefined ? opt_layerFilter : TRUE;\n  const thisArg2 = opt_this2 !== undefined ? opt_this2 : null;\n  return this.renderer_.forEachLayerAtPixel(\n    pixel, this.frameState_, callback, thisArg,\n    layerFilter, thisArg2);\n};\n\n\n/**\n * Detect if features intersect a pixel on the viewport. Layers included in the\n * detection can be configured through `opt_layerFilter`.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Optional options.\n * @return {boolean} Is there a feature at the given pixel?\n * @template U\n * @api\n */\nPluggableMap.prototype.hasFeatureAtPixel = function(pixel, opt_options) {\n  if (!this.frameState_) {\n    return false;\n  }\n  const coordinate = this.getCoordinateFromPixel(pixel);\n  opt_options = opt_options !== undefined ? opt_options : {};\n  const layerFilter = opt_options.layerFilter !== undefined ? opt_options.layerFilter : TRUE;\n  const hitTolerance = opt_options.hitTolerance !== undefined ?\n    opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n  return this.renderer_.hasFeatureAtCoordinate(\n    coordinate, this.frameState_, hitTolerance, layerFilter, null);\n};\n\n\n/**\n * Returns the coordinate in view projection for a browser event.\n * @param {Event} event Event.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nPluggableMap.prototype.getEventCoordinate = function(event) {\n  return this.getCoordinateFromPixel(this.getEventPixel(event));\n};\n\n\n/**\n * Returns the map pixel position for a browser event relative to the viewport.\n * @param {Event} event Event.\n * @return {module:ol~Pixel} Pixel.\n * @api\n */\nPluggableMap.prototype.getEventPixel = function(event) {\n  const viewportPosition = this.viewport_.getBoundingClientRect();\n  const eventPosition = event.changedTouches ? event.changedTouches[0] : event;\n  return [\n    eventPosition.clientX - viewportPosition.left,\n    eventPosition.clientY - viewportPosition.top\n  ];\n};\n\n\n/**\n * Get the target in which this map is rendered.\n * Note that this returns what is entered as an option or in setTarget:\n * if that was an element, it returns an element; if a string, it returns that.\n * @return {Element|string|undefined} The Element or id of the Element that the\n *     map is rendered in.\n * @observable\n * @api\n */\nPluggableMap.prototype.getTarget = function() {\n  return /** @type {Element|string|undefined} */ (this.get(MapProperty.TARGET));\n};\n\n\n/**\n * Get the DOM element into which this map is rendered. In contrast to\n * `getTarget` this method always return an `Element`, or `null` if the\n * map has no target.\n * @return {Element} The element that the map is rendered in.\n * @api\n */\nPluggableMap.prototype.getTargetElement = function() {\n  const target = this.getTarget();\n  if (target !== undefined) {\n    return typeof target === 'string' ? document.getElementById(target) : target;\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * Get the coordinate for a given pixel.  This returns a coordinate in the\n * map view projection.\n * @param {module:ol~Pixel} pixel Pixel position in the map viewport.\n * @return {module:ol/coordinate~Coordinate} The coordinate for the pixel position.\n * @api\n */\nPluggableMap.prototype.getCoordinateFromPixel = function(pixel) {\n  const frameState = this.frameState_;\n  if (!frameState) {\n    return null;\n  } else {\n    return applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n  }\n};\n\n\n/**\n * Get the map controls. Modifying this collection changes the controls\n * associated with the map.\n * @return {module:ol/Collection.<module:ol/control/Control>} Controls.\n * @api\n */\nPluggableMap.prototype.getControls = function() {\n  return this.controls;\n};\n\n\n/**\n * Get the map overlays. Modifying this collection changes the overlays\n * associated with the map.\n * @return {module:ol/Collection.<module:ol/Overlay>} Overlays.\n * @api\n */\nPluggableMap.prototype.getOverlays = function() {\n  return this.overlays_;\n};\n\n\n/**\n * Get an overlay by its identifier (the value returned by overlay.getId()).\n * Note that the index treats string and numeric identifiers as the same. So\n * `map.getOverlayById(2)` will return an overlay with id `'2'` or `2`.\n * @param {string|number} id Overlay identifier.\n * @return {module:ol/Overlay} Overlay.\n * @api\n */\nPluggableMap.prototype.getOverlayById = function(id) {\n  const overlay = this.overlayIdIndex_[id.toString()];\n  return overlay !== undefined ? overlay : null;\n};\n\n\n/**\n * Get the map interactions. Modifying this collection changes the interactions\n * associated with the map.\n *\n * Interactions are used for e.g. pan, zoom and rotate.\n * @return {module:ol/Collection.<module:ol/interaction/Interaction>} Interactions.\n * @api\n */\nPluggableMap.prototype.getInteractions = function() {\n  return this.interactions;\n};\n\n\n/**\n * Get the layergroup associated with this map.\n * @return {module:ol/layer/Group} A layer group containing the layers in this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.getLayerGroup = function() {\n  return (\n    /** @type {module:ol/layer/Group} */ (this.get(MapProperty.LAYERGROUP))\n  );\n};\n\n\n/**\n * Get the collection of layers associated with this map.\n * @return {!module:ol/Collection.<module:ol/layer/Base>} Layers.\n * @api\n */\nPluggableMap.prototype.getLayers = function() {\n  const layers = this.getLayerGroup().getLayers();\n  return layers;\n};\n\n\n/**\n * Get the pixel for a coordinate.  This takes a coordinate in the map view\n * projection and returns the corresponding pixel.\n * @param {module:ol/coordinate~Coordinate} coordinate A map coordinate.\n * @return {module:ol~Pixel} A pixel position in the map viewport.\n * @api\n */\nPluggableMap.prototype.getPixelFromCoordinate = function(coordinate) {\n  const frameState = this.frameState_;\n  if (!frameState) {\n    return null;\n  } else {\n    return applyTransform(frameState.coordinateToPixelTransform, coordinate.slice(0, 2));\n  }\n};\n\n\n/**\n * Get the map renderer.\n * @return {module:ol/renderer/Map} Renderer\n */\nPluggableMap.prototype.getRenderer = function() {\n  return this.renderer_;\n};\n\n\n/**\n * Get the size of this map.\n * @return {module:ol/size~Size|undefined} The size in pixels of the map in the DOM.\n * @observable\n * @api\n */\nPluggableMap.prototype.getSize = function() {\n  return (\n    /** @type {module:ol/size~Size|undefined} */ (this.get(MapProperty.SIZE))\n  );\n};\n\n\n/**\n * Get the view associated with this map. A view manages properties such as\n * center and resolution.\n * @return {module:ol/View} The view that controls this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.getView = function() {\n  return (\n    /** @type {module:ol/View} */ (this.get(MapProperty.VIEW))\n  );\n};\n\n\n/**\n * Get the element that serves as the map viewport.\n * @return {Element} Viewport.\n * @api\n */\nPluggableMap.prototype.getViewport = function() {\n  return this.viewport_;\n};\n\n\n/**\n * Get the element that serves as the container for overlays.  Elements added to\n * this container will let mousedown and touchstart events through to the map,\n * so clicks and gestures on an overlay will trigger {@link module:ol/MapBrowserEvent~MapBrowserEvent}\n * events.\n * @return {!Element} The map's overlay container.\n */\nPluggableMap.prototype.getOverlayContainer = function() {\n  return this.overlayContainer_;\n};\n\n\n/**\n * Get the element that serves as a container for overlays that don't allow\n * event propagation. Elements added to this container won't let mousedown and\n * touchstart events through to the map, so clicks and gestures on an overlay\n * don't trigger any {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n * @return {!Element} The map's overlay container that stops events.\n */\nPluggableMap.prototype.getOverlayContainerStopEvent = function() {\n  return this.overlayContainerStopEvent_;\n};\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @param {string} tileSourceKey Tile source key.\n * @param {module:ol/coordinate~Coordinate} tileCenter Tile center.\n * @param {number} tileResolution Tile resolution.\n * @return {number} Tile priority.\n */\nPluggableMap.prototype.getTilePriority = function(tile, tileSourceKey, tileCenter, tileResolution) {\n  // Filter out tiles at higher zoom levels than the current zoom level, or that\n  // are outside the visible extent.\n  const frameState = this.frameState_;\n  if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n    return DROP;\n  }\n  if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n    return DROP;\n  }\n  // Prioritize the highest zoom level tiles closest to the focus.\n  // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n  // Within a zoom level, tiles are prioritized by the distance in pixels\n  // between the center of the tile and the focus.  The factor of 65536 means\n  // that the prioritization should behave as desired for tiles up to\n  // 65536 * Math.log(2) = 45426 pixels from the focus.\n  const deltaX = tileCenter[0] - frameState.focus[0];\n  const deltaY = tileCenter[1] - frameState.focus[1];\n  return 65536 * Math.log(tileResolution) +\n      Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n};\n\n\n/**\n * @param {Event} browserEvent Browser event.\n * @param {string=} opt_type Type.\n */\nPluggableMap.prototype.handleBrowserEvent = function(browserEvent, opt_type) {\n  const type = opt_type || browserEvent.type;\n  const mapBrowserEvent = new MapBrowserEvent(type, this, browserEvent);\n  this.handleMapBrowserEvent(mapBrowserEvent);\n};\n\n\n/**\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent The event to handle.\n */\nPluggableMap.prototype.handleMapBrowserEvent = function(mapBrowserEvent) {\n  if (!this.frameState_) {\n    // With no view defined, we cannot translate pixels into geographical\n    // coordinates so interactions cannot be used.\n    return;\n  }\n  this.focus_ = mapBrowserEvent.coordinate;\n  mapBrowserEvent.frameState = this.frameState_;\n  const interactionsArray = this.getInteractions().getArray();\n  if (this.dispatchEvent(mapBrowserEvent) !== false) {\n    for (let i = interactionsArray.length - 1; i >= 0; i--) {\n      const interaction = interactionsArray[i];\n      if (!interaction.getActive()) {\n        continue;\n      }\n      const cont = interaction.handleEvent(mapBrowserEvent);\n      if (!cont) {\n        break;\n      }\n    }\n  }\n};\n\n\n/**\n * @protected\n */\nPluggableMap.prototype.handlePostRender = function() {\n\n  const frameState = this.frameState_;\n\n  // Manage the tile queue\n  // Image loads are expensive and a limited resource, so try to use them\n  // efficiently:\n  // * When the view is static we allow a large number of parallel tile loads\n  //   to complete the frame as quickly as possible.\n  // * When animating or interacting, image loads can cause janks, so we reduce\n  //   the maximum number of loads per frame and limit the number of parallel\n  //   tile loads to remain reactive to view changes and to reduce the chance of\n  //   loading tiles that will quickly disappear from view.\n  const tileQueue = this.tileQueue_;\n  if (!tileQueue.isEmpty()) {\n    let maxTotalLoading = this.maxTilesLoading_;\n    let maxNewLoads = maxTotalLoading;\n    if (frameState) {\n      const hints = frameState.viewHints;\n      if (hints[ViewHint.ANIMATING]) {\n        maxTotalLoading = this.loadTilesWhileAnimating_ ? 8 : 0;\n        maxNewLoads = 2;\n      }\n      if (hints[ViewHint.INTERACTING]) {\n        maxTotalLoading = this.loadTilesWhileInteracting_ ? 8 : 0;\n        maxNewLoads = 2;\n      }\n    }\n    if (tileQueue.getTilesLoading() < maxTotalLoading) {\n      tileQueue.reprioritize(); // FIXME only call if view has changed\n      tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);\n    }\n  }\n\n  const postRenderFunctions = this.postRenderFunctions_;\n  for (let i = 0, ii = postRenderFunctions.length; i < ii; ++i) {\n    postRenderFunctions[i](this, frameState);\n  }\n  postRenderFunctions.length = 0;\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleSizeChanged_ = function() {\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleTargetChanged_ = function() {\n  // target may be undefined, null, a string or an Element.\n  // If it's a string we convert it to an Element before proceeding.\n  // If it's not now an Element we remove the viewport from the DOM.\n  // If it's an Element we append the viewport element to it.\n\n  let targetElement;\n  if (this.getTarget()) {\n    targetElement = this.getTargetElement();\n  }\n\n  if (this.keyHandlerKeys_) {\n    for (let i = 0, ii = this.keyHandlerKeys_.length; i < ii; ++i) {\n      unlistenByKey(this.keyHandlerKeys_[i]);\n    }\n    this.keyHandlerKeys_ = null;\n  }\n\n  if (!targetElement) {\n    this.renderer_.removeLayerRenderers();\n    removeNode(this.viewport_);\n    if (this.handleResize_ !== undefined) {\n      removeEventListener(EventType.RESIZE, this.handleResize_, false);\n      this.handleResize_ = undefined;\n    }\n  } else {\n    targetElement.appendChild(this.viewport_);\n\n    const keyboardEventTarget = !this.keyboardEventTarget_ ?\n      targetElement : this.keyboardEventTarget_;\n    this.keyHandlerKeys_ = [\n      listen(keyboardEventTarget, EventType.KEYDOWN, this.handleBrowserEvent, this),\n      listen(keyboardEventTarget, EventType.KEYPRESS, this.handleBrowserEvent, this)\n    ];\n\n    if (!this.handleResize_) {\n      this.handleResize_ = this.updateSize.bind(this);\n      addEventListener(EventType.RESIZE, this.handleResize_, false);\n    }\n  }\n\n  this.updateSize();\n  // updateSize calls setSize, so no need to call this.render\n  // ourselves here.\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleTileChange_ = function() {\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleViewPropertyChanged_ = function() {\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleViewChanged_ = function() {\n  if (this.viewPropertyListenerKey_) {\n    unlistenByKey(this.viewPropertyListenerKey_);\n    this.viewPropertyListenerKey_ = null;\n  }\n  if (this.viewChangeListenerKey_) {\n    unlistenByKey(this.viewChangeListenerKey_);\n    this.viewChangeListenerKey_ = null;\n  }\n  const view = this.getView();\n  if (view) {\n    this.viewport_.setAttribute('data-view', getUid(view));\n    this.viewPropertyListenerKey_ = listen(\n      view, ObjectEventType.PROPERTYCHANGE,\n      this.handleViewPropertyChanged_, this);\n    this.viewChangeListenerKey_ = listen(\n      view, EventType.CHANGE,\n      this.handleViewPropertyChanged_, this);\n  }\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleLayerGroupChanged_ = function() {\n  if (this.layerGroupPropertyListenerKeys_) {\n    this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);\n    this.layerGroupPropertyListenerKeys_ = null;\n  }\n  const layerGroup = this.getLayerGroup();\n  if (layerGroup) {\n    this.layerGroupPropertyListenerKeys_ = [\n      listen(\n        layerGroup, ObjectEventType.PROPERTYCHANGE,\n        this.render, this),\n      listen(\n        layerGroup, EventType.CHANGE,\n        this.render, this)\n    ];\n  }\n  this.render();\n};\n\n\n/**\n * @return {boolean} Is rendered.\n */\nPluggableMap.prototype.isRendered = function() {\n  return !!this.frameState_;\n};\n\n\n/**\n * Requests an immediate render in a synchronous manner.\n * @api\n */\nPluggableMap.prototype.renderSync = function() {\n  if (this.animationDelayKey_) {\n    cancelAnimationFrame(this.animationDelayKey_);\n  }\n  this.animationDelay_();\n};\n\n\n/**\n * Request a map rendering (at the next animation frame).\n * @api\n */\nPluggableMap.prototype.render = function() {\n  if (this.animationDelayKey_ === undefined) {\n    this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);\n  }\n};\n\n\n/**\n * Remove the given control from the map.\n * @param {module:ol/control/Control} control Control.\n * @return {module:ol/control/Control|undefined} The removed control (or undefined\n *     if the control was not found).\n * @api\n */\nPluggableMap.prototype.removeControl = function(control) {\n  return this.getControls().remove(control);\n};\n\n\n/**\n * Remove the given interaction from the map.\n * @param {module:ol/interaction/Interaction} interaction Interaction to remove.\n * @return {module:ol/interaction/Interaction|undefined} The removed interaction (or\n *     undefined if the interaction was not found).\n * @api\n */\nPluggableMap.prototype.removeInteraction = function(interaction) {\n  return this.getInteractions().remove(interaction);\n};\n\n\n/**\n * Removes the given layer from the map.\n * @param {module:ol/layer/Base} layer Layer.\n * @return {module:ol/layer/Base|undefined} The removed layer (or undefined if the\n *     layer was not found).\n * @api\n */\nPluggableMap.prototype.removeLayer = function(layer) {\n  const layers = this.getLayerGroup().getLayers();\n  return layers.remove(layer);\n};\n\n\n/**\n * Remove the given overlay from the map.\n * @param {module:ol/Overlay} overlay Overlay.\n * @return {module:ol/Overlay|undefined} The removed overlay (or undefined\n *     if the overlay was not found).\n * @api\n */\nPluggableMap.prototype.removeOverlay = function(overlay) {\n  return this.getOverlays().remove(overlay);\n};\n\n\n/**\n * @param {number} time Time.\n * @private\n */\nPluggableMap.prototype.renderFrame_ = function(time) {\n  let viewState;\n\n  const size = this.getSize();\n  const view = this.getView();\n  const extent = createEmpty();\n  const previousFrameState = this.frameState_;\n  /** @type {?module:ol/PluggableMap~FrameState} */\n  let frameState = null;\n  if (size !== undefined && hasArea(size) && view && view.isDef()) {\n    const viewHints = view.getHints(this.frameState_ ? this.frameState_.viewHints : undefined);\n    const layerStatesArray = this.getLayerGroup().getLayerStatesArray();\n    const layerStates = {};\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      layerStates[getUid(layerStatesArray[i].layer)] = layerStatesArray[i];\n    }\n    viewState = view.getState();\n    let focus = this.focus_;\n    if (!focus) {\n      focus = viewState.center;\n      const pixelResolution = viewState.resolution / this.pixelRatio_;\n      focus[0] = Math.round(focus[0] / pixelResolution) * pixelResolution;\n      focus[1] = Math.round(focus[1] / pixelResolution) * pixelResolution;\n    }\n    frameState = /** @type {module:ol/PluggableMap~FrameState} */ ({\n      animate: false,\n      coordinateToPixelTransform: this.coordinateToPixelTransform_,\n      extent: extent,\n      focus: focus,\n      index: this.frameIndex_++,\n      layerStates: layerStates,\n      layerStatesArray: layerStatesArray,\n      pixelRatio: this.pixelRatio_,\n      pixelToCoordinateTransform: this.pixelToCoordinateTransform_,\n      postRenderFunctions: [],\n      size: size,\n      skippedFeatureUids: this.skippedFeatureUids_,\n      tileQueue: this.tileQueue_,\n      time: time,\n      usedTiles: {},\n      viewState: viewState,\n      viewHints: viewHints,\n      wantedTiles: {}\n    });\n  }\n\n  if (frameState) {\n    frameState.extent = getForViewAndSize(viewState.center,\n      viewState.resolution, viewState.rotation, frameState.size, extent);\n  }\n\n  this.frameState_ = frameState;\n  this.renderer_.renderFrame(frameState);\n\n  if (frameState) {\n    if (frameState.animate) {\n      this.render();\n    }\n    Array.prototype.push.apply(this.postRenderFunctions_, frameState.postRenderFunctions);\n\n    if (previousFrameState) {\n      const moveStart = !this.previousExtent_ ||\n                  (!isEmpty(this.previousExtent_) &&\n                  !equals(frameState.extent, this.previousExtent_));\n      if (moveStart) {\n        this.dispatchEvent(\n          new MapEvent(MapEventType.MOVESTART, this, previousFrameState));\n        this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);\n      }\n    }\n\n    const idle = this.previousExtent_ &&\n        !frameState.viewHints[ViewHint.ANIMATING] &&\n        !frameState.viewHints[ViewHint.INTERACTING] &&\n        !equals(frameState.extent, this.previousExtent_);\n\n    if (idle) {\n      this.dispatchEvent(new MapEvent(MapEventType.MOVEEND, this, frameState));\n      clone(frameState.extent, this.previousExtent_);\n    }\n  }\n\n  this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER, this, frameState));\n\n  setTimeout(this.handlePostRender.bind(this), 0);\n\n};\n\n\n/**\n * Sets the layergroup of this map.\n * @param {module:ol/layer/Group} layerGroup A layer group containing the layers in this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.setLayerGroup = function(layerGroup) {\n  this.set(MapProperty.LAYERGROUP, layerGroup);\n};\n\n\n/**\n * Set the size of this map.\n * @param {module:ol/size~Size|undefined} size The size in pixels of the map in the DOM.\n * @observable\n * @api\n */\nPluggableMap.prototype.setSize = function(size) {\n  this.set(MapProperty.SIZE, size);\n};\n\n\n/**\n * Set the target element to render this map into.\n * @param {Element|string|undefined} target The Element or id of the Element\n *     that the map is rendered in.\n * @observable\n * @api\n */\nPluggableMap.prototype.setTarget = function(target) {\n  this.set(MapProperty.TARGET, target);\n};\n\n\n/**\n * Set the view for this map.\n * @param {module:ol/View} view The view that controls this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.setView = function(view) {\n  this.set(MapProperty.VIEW, view);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n */\nPluggableMap.prototype.skipFeature = function(feature) {\n  const featureUid = getUid(feature).toString();\n  this.skippedFeatureUids_[featureUid] = true;\n  this.render();\n};\n\n\n/**\n * Force a recalculation of the map viewport size.  This should be called when\n * third-party code changes the size of the map viewport.\n * @api\n */\nPluggableMap.prototype.updateSize = function() {\n  const targetElement = this.getTargetElement();\n\n  if (!targetElement) {\n    this.setSize(undefined);\n  } else {\n    const computedStyle = getComputedStyle(targetElement);\n    this.setSize([\n      targetElement.offsetWidth -\n          parseFloat(computedStyle['borderLeftWidth']) -\n          parseFloat(computedStyle['paddingLeft']) -\n          parseFloat(computedStyle['paddingRight']) -\n          parseFloat(computedStyle['borderRightWidth']),\n      targetElement.offsetHeight -\n          parseFloat(computedStyle['borderTopWidth']) -\n          parseFloat(computedStyle['paddingTop']) -\n          parseFloat(computedStyle['paddingBottom']) -\n          parseFloat(computedStyle['borderBottomWidth'])\n    ]);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n */\nPluggableMap.prototype.unskipFeature = function(feature) {\n  const featureUid = getUid(feature).toString();\n  delete this.skippedFeatureUids_[featureUid];\n  this.render();\n};\n\n\n/**\n * @param {MapOptions} options Map options.\n * @return {module:ol/PluggableMap~MapOptionsInternal} Internal map options.\n */\nfunction createOptionsInternal(options) {\n\n  /**\n   * @type {Element|Document}\n   */\n  let keyboardEventTarget = null;\n  if (options.keyboardEventTarget !== undefined) {\n    keyboardEventTarget = typeof options.keyboardEventTarget === 'string' ?\n      document.getElementById(options.keyboardEventTarget) :\n      options.keyboardEventTarget;\n  }\n\n  /**\n   * @type {Object.<string, *>}\n   */\n  const values = {};\n\n  const layerGroup = (options.layers instanceof LayerGroup) ?\n    options.layers : new LayerGroup({layers: options.layers});\n  values[MapProperty.LAYERGROUP] = layerGroup;\n\n  values[MapProperty.TARGET] = options.target;\n\n  values[MapProperty.VIEW] = options.view !== undefined ?\n    options.view : new View();\n\n  let controls;\n  if (options.controls !== undefined) {\n    if (Array.isArray(options.controls)) {\n      controls = new Collection(options.controls.slice());\n    } else {\n      assert(options.controls instanceof Collection,\n        47); // Expected `controls` to be an array or an `module:ol/Collection~Collection`\n      controls = options.controls;\n    }\n  }\n\n  let interactions;\n  if (options.interactions !== undefined) {\n    if (Array.isArray(options.interactions)) {\n      interactions = new Collection(options.interactions.slice());\n    } else {\n      assert(options.interactions instanceof Collection,\n        48); // Expected `interactions` to be an array or an `module:ol/Collection~Collection`\n      interactions = options.interactions;\n    }\n  }\n\n  let overlays;\n  if (options.overlays !== undefined) {\n    if (Array.isArray(options.overlays)) {\n      overlays = new Collection(options.overlays.slice());\n    } else {\n      assert(options.overlays instanceof Collection,\n        49); // Expected `overlays` to be an array or an `module:ol/Collection~Collection`\n      overlays = options.overlays;\n    }\n  } else {\n    overlays = new Collection();\n  }\n\n  return {\n    controls: controls,\n    interactions: interactions,\n    keyboardEventTarget: keyboardEventTarget,\n    overlays: overlays,\n    values: values\n  };\n\n}\nexport default PluggableMap;\n","/**\n * @module ol/TileQueue\n */\nimport {inherits} from './index.js';\nimport TileState from './TileState.js';\nimport {listen, unlisten} from './events.js';\nimport EventType from './events/EventType.js';\nimport PriorityQueue from './structs/PriorityQueue.js';\n\n\n/**\n * @typedef {function(module:ol/Tile, string, module:ol/coordinate~Coordinate, number): number} PriorityFunction\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/structs/PriorityQueue.<Array>}\n * @param {module:ol/TileQueue~PriorityFunction} tilePriorityFunction\n *     Tile priority function.\n * @param {function(): ?} tileChangeCallback\n *     Function called on each tile change event.\n * @struct\n */\nconst TileQueue = function(tilePriorityFunction, tileChangeCallback) {\n\n  PriorityQueue.call(\n    this,\n    /**\n     * @param {Array} element Element.\n     * @return {number} Priority.\n     */\n    function(element) {\n      return tilePriorityFunction.apply(null, element);\n    },\n    /**\n     * @param {Array} element Element.\n     * @return {string} Key.\n     */\n    function(element) {\n      return (/** @type {module:ol/Tile} */ (element[0]).getKey());\n    });\n\n  /**\n   * @private\n   * @type {function(): ?}\n   */\n  this.tileChangeCallback_ = tileChangeCallback;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.tilesLoading_ = 0;\n\n  /**\n   * @private\n   * @type {!Object.<string,boolean>}\n   */\n  this.tilesLoadingKeys_ = {};\n\n};\n\ninherits(TileQueue, PriorityQueue);\n\n\n/**\n * @inheritDoc\n */\nTileQueue.prototype.enqueue = function(element) {\n  const added = PriorityQueue.prototype.enqueue.call(this, element);\n  if (added) {\n    const tile = element[0];\n    listen(tile, EventType.CHANGE, this.handleTileChange, this);\n  }\n  return added;\n};\n\n\n/**\n * @return {number} Number of tiles loading.\n */\nTileQueue.prototype.getTilesLoading = function() {\n  return this.tilesLoading_;\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @protected\n */\nTileQueue.prototype.handleTileChange = function(event) {\n  const tile = /** @type {module:ol/Tile} */ (event.target);\n  const state = tile.getState();\n  if (state === TileState.LOADED || state === TileState.ERROR ||\n      state === TileState.EMPTY || state === TileState.ABORT) {\n    unlisten(tile, EventType.CHANGE, this.handleTileChange, this);\n    const tileKey = tile.getKey();\n    if (tileKey in this.tilesLoadingKeys_) {\n      delete this.tilesLoadingKeys_[tileKey];\n      --this.tilesLoading_;\n    }\n    this.tileChangeCallback_();\n  }\n};\n\n\n/**\n * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n * @param {number} maxNewLoads Maximum number of new tiles to load.\n */\nTileQueue.prototype.loadMoreTiles = function(maxTotalLoading, maxNewLoads) {\n  let newLoads = 0;\n  let abortedTiles = false;\n  let state, tile, tileKey;\n  while (this.tilesLoading_ < maxTotalLoading && newLoads < maxNewLoads &&\n         this.getCount() > 0) {\n    tile = /** @type {module:ol/Tile} */ (this.dequeue()[0]);\n    tileKey = tile.getKey();\n    state = tile.getState();\n    if (state === TileState.ABORT) {\n      abortedTiles = true;\n    } else if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n      this.tilesLoadingKeys_[tileKey] = true;\n      ++this.tilesLoading_;\n      ++newLoads;\n      tile.load();\n    }\n  }\n  if (newLoads === 0 && abortedTiles) {\n    // Do not stop the render loop when all wanted tiles were aborted due to\n    // a small, saturated tile cache.\n    this.tileChangeCallback_();\n  }\n};\nexport default TileQueue;\n","/**\n * @module ol/TileRange\n */\n/**\n * A representation of a contiguous block of tiles.  A tile range is specified\n * by its min/max tile coordinates and is inclusive of coordinates.\n *\n * @constructor\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @struct\n */\nconst TileRange = function(minX, maxX, minY, maxY) {\n\n  /**\n   * @type {number}\n   */\n  this.minX = minX;\n\n  /**\n   * @type {number}\n   */\n  this.maxX = maxX;\n\n  /**\n   * @type {number}\n   */\n  this.minY = minY;\n\n  /**\n   * @type {number}\n   */\n  this.maxY = maxY;\n\n};\n\n\n/**\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @param {module:ol/TileRange=} tileRange TileRange.\n * @return {module:ol/TileRange} Tile range.\n */\nexport function createOrUpdate(minX, maxX, minY, maxY, tileRange) {\n  if (tileRange !== undefined) {\n    tileRange.minX = minX;\n    tileRange.maxX = maxX;\n    tileRange.minY = minY;\n    tileRange.maxY = maxY;\n    return tileRange;\n  } else {\n    return new TileRange(minX, maxX, minY, maxY);\n  }\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @return {boolean} Contains tile coordinate.\n */\nTileRange.prototype.contains = function(tileCoord) {\n  return this.containsXY(tileCoord[1], tileCoord[2]);\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n * @return {boolean} Contains.\n */\nTileRange.prototype.containsTileRange = function(tileRange) {\n  return this.minX <= tileRange.minX && tileRange.maxX <= this.maxX &&\n      this.minY <= tileRange.minY && tileRange.maxY <= this.maxY;\n};\n\n\n/**\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @return {boolean} Contains coordinate.\n */\nTileRange.prototype.containsXY = function(x, y) {\n  return this.minX <= x && x <= this.maxX && this.minY <= y && y <= this.maxY;\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n * @return {boolean} Equals.\n */\nTileRange.prototype.equals = function(tileRange) {\n  return this.minX == tileRange.minX && this.minY == tileRange.minY &&\n      this.maxX == tileRange.maxX && this.maxY == tileRange.maxY;\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n */\nTileRange.prototype.extend = function(tileRange) {\n  if (tileRange.minX < this.minX) {\n    this.minX = tileRange.minX;\n  }\n  if (tileRange.maxX > this.maxX) {\n    this.maxX = tileRange.maxX;\n  }\n  if (tileRange.minY < this.minY) {\n    this.minY = tileRange.minY;\n  }\n  if (tileRange.maxY > this.maxY) {\n    this.maxY = tileRange.maxY;\n  }\n};\n\n\n/**\n * @return {number} Height.\n */\nTileRange.prototype.getHeight = function() {\n  return this.maxY - this.minY + 1;\n};\n\n\n/**\n * @return {module:ol/size~Size} Size.\n */\nTileRange.prototype.getSize = function() {\n  return [this.getWidth(), this.getHeight()];\n};\n\n\n/**\n * @return {number} Width.\n */\nTileRange.prototype.getWidth = function() {\n  return this.maxX - this.minX + 1;\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n * @return {boolean} Intersects.\n */\nTileRange.prototype.intersects = function(tileRange) {\n  return this.minX <= tileRange.maxX &&\n      this.maxX >= tileRange.minX &&\n      this.minY <= tileRange.maxY &&\n      this.maxY >= tileRange.minY;\n};\nexport default TileRange;\n","/**\n * @module ol/TileState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3,\n  EMPTY: 4,\n  ABORT: 5\n};\n","/**\n * @module ol/View\n */\nimport {DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {inherits, getUid} from './index.js';\nimport {UNDEFINED} from './functions.js';\nimport {createExtent, none as centerNone} from './centerconstraint.js';\nimport BaseObject from './Object.js';\nimport {createSnapToResolutions, createSnapToPower} from './resolutionconstraint.js';\nimport {createSnapToZero, createSnapToN, none as rotationNone, disable} from './rotationconstraint.js';\nimport ViewHint from './ViewHint.js';\nimport ViewProperty from './ViewProperty.js';\nimport {linearFindNearest} from './array.js';\nimport {assert} from './asserts.js';\nimport {add as addCoordinate, rotate as rotateCoordinate, equals as coordinatesEqual} from './coordinate.js';\nimport {inAndOut} from './easing.js';\nimport {getForViewAndSize, getCenter, getHeight, getWidth, isEmpty} from './extent.js';\nimport GeometryType from './geom/GeometryType.js';\nimport {fromExtent as polygonFromExtent} from './geom/Polygon.js';\nimport SimpleGeometry from './geom/SimpleGeometry.js';\nimport {clamp, modulo} from './math.js';\nimport {assign} from './obj.js';\nimport {createProjection, METERS_PER_UNIT} from './proj.js';\nimport Units from './proj/Units.js';\n\n\n/**\n * An animation configuration\n *\n * @typedef {Object} Animation\n * @property {module:ol/coordinate~Coordinate} [sourceCenter]\n * @property {module:ol/coordinate~Coordinate} [targetCenter]\n * @property {number} [sourceResolution]\n * @property {number} [targetResolution]\n * @property {number} [sourceRotation]\n * @property {number} [sourceRotation]\n * @property {module:ol/coordinate~Coordinate} [anchor]\n * @property {number} start\n * @property {number} duration\n * @property {boolean} complete\n * @property {function(number):number} easing\n * @property {function(boolean)} callback\n */\n\n\n/**\n * @typedef {Object} Constraints\n * @property {module:ol/centerconstraint~Type} center\n * @property {module:ol/resolutionconstraint~Type} resolution\n * @property {module:ol/rotationconstraint~Type} rotation\n */\n\n\n/**\n * @typedef {Object} FitOptions\n * @property {module:ol/size~Size} [size] The size in pixels of the box to fit\n * the extent into. Default is the current size of the first map in the DOM that\n * uses this view, or `[100, 100]` if no such map is found.\n * @property {!Array.<number>} [padding=[0, 0, 0, 0]] Padding (in pixels) to be\n * cleared inside the view. Values in the array are top, right, bottom and left\n * padding.\n * @property {boolean} [constrainResolution=true] Constrain the resolution.\n * @property {boolean} [nearest=false] If `constrainResolution` is `true`, get\n * the nearest extent instead of the closest that actually fits the view.\n * @property {number} [minResolution=0] Minimum resolution that we zoom to.\n * @property {number} [maxZoom] Maximum zoom level that we zoom to. If\n * `minResolution` is given, this property is ignored.\n * @property {number} [duration] The duration of the animation in milliseconds.\n * By default, there is no animation to the target extent.\n * @property {function(number):number} [easing] The easing function used during\n * the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n * @property {function(boolean)} [callback] Function called when the view is in\n * its final position. The callback will be called with `true` if the animation\n * series completed on its own or `false` if it was cancelled.\n */\n\n\n/**\n * @typedef {Object} ViewOptions\n * @property {module:ol/coordinate~Coordinate} [center] The initial center for\n * the view. The coordinate system for the center is specified with the\n * `projection` option. Layer sources will not be fetched if this is not set,\n * but the center can be set later with {@link #setCenter}.\n * @property {boolean|number} [constrainRotation=true] Rotation constraint.\n * `false` means no constraint. `true` means no constraint, but snap to zero\n * near zero. A number constrains the rotation to that number of values. For\n * example, `4` will constrain the rotation to 0, 90, 180, and 270 degrees.\n * @property {boolean} [enableRotation=true] Enable rotation.\n * If `false`, a rotation constraint that always sets the rotation to zero is\n * used. The `constrainRotation` option has no effect if `enableRotation` is\n * `false`.\n * @property {module:ol/extent~Extent} [extent] The extent that constrains the\n * center, in other words, center cannot be set outside this extent.\n * @property {number} [maxResolution] The maximum resolution used to determine\n * the resolution constraint. It is used together with `minResolution` (or\n * `maxZoom`) and `zoomFactor`. If unspecified it is calculated in such a way\n * that the projection's validity extent fits in a 256x256 px tile. If the\n * projection is Spherical Mercator (the default) then `maxResolution` defaults\n * to `40075016.68557849 / 256 = 156543.03392804097`.\n * @property {number} [minResolution] The minimum resolution used to determine\n * the resolution constraint.  It is used together with `maxResolution` (or\n * `minZoom`) and `zoomFactor`.  If unspecified it is calculated assuming 29\n * zoom levels (with a factor of 2). If the projection is Spherical Mercator\n * (the default) then `minResolution` defaults to\n * `40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253`.\n * @property {number} [maxZoom=28] The maximum zoom level used to determine the\n * resolution constraint. It is used together with `minZoom` (or\n * `maxResolution`) and `zoomFactor`.  Note that if `minResolution` is also\n * provided, it is given precedence over `maxZoom`.\n * @property {number} [minZoom=0] The minimum zoom level used to determine the\n * resolution constraint. It is used together with `maxZoom` (or\n * `minResolution`) and `zoomFactor`.  Note that if `maxResolution` is also\n * provided, it is given precedence over `minZoom`.\n * @property {module:ol/proj~ProjectionLike} [projection='EPSG:3857'] The\n * projection. The default is Spherical Mercator.\n * @property {number} [resolution] The initial resolution for the view. The\n * units are `projection` units per pixel (e.g. meters per pixel). An\n * alternative to setting this is to set `zoom`. Layer sources will not be\n * fetched if neither this nor `zoom` are defined, but they can be set later\n * with {@link #setZoom} or {@link #setResolution}.\n * @property {Array.<number>} [resolutions] Resolutions to determine the\n * resolution constraint. If set the `maxResolution`, `minResolution`,\n * `minZoom`, `maxZoom`, and `zoomFactor` options are ignored.\n * @property {number} [rotation=0] The initial rotation for the view in radians\n * (positive rotation clockwise, 0 means North).\n * @property {number} [zoom] Only used if `resolution` is not defined. Zoom\n * level used to calculate the initial resolution for the view. The initial\n * resolution is determined using the {@link #constrainResolution} method.\n * @property {number} [zoomFactor=2] The zoom factor used to determine the\n * resolution constraint.\n */\n\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {module:ol/coordinate~Coordinate|undefined} center The center of the view at the end of\n * the animation.\n * @property {number|undefined} zoom The zoom level of the view at the end of the\n * animation. This takes precedence over `resolution`.\n * @property {number|undefined} resolution The resolution of the view at the end\n * of the animation.  If `zoom` is also provided, this option will be ignored.\n * @property {number|undefined} rotation The rotation of the view at the end of\n * the animation.\n * @property {module:ol/coordinate~Coordinate|undefined} anchor Optional anchor to remained fixed\n * during a rotation or resolution animation.\n * @property {number} [duration=1000] The duration of the animation in milliseconds.\n * @property {function(number):number} [easing] The easing function used\n * during the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {module:ol/coordinate~Coordinate} center\n * @property {module:ol/proj/Projection} projection\n * @property {number} resolution\n * @property {number} rotation\n * @property {number} zoom\n */\n\n\n/**\n * Default min zoom level for the map view.\n * @type {number}\n */\nconst DEFAULT_MIN_ZOOM = 0;\n\n\n/**\n * @classdesc\n * A View object represents a simple 2D view of the map.\n *\n * This is the object to act upon to change the center, resolution,\n * and rotation of the map.\n *\n * ### The view states\n *\n * An View is determined by three states: `center`, `resolution`,\n * and `rotation`. Each state has a corresponding getter and setter, e.g.\n * `getCenter` and `setCenter` for the `center` state.\n *\n * An View has a `projection`. The projection determines the\n * coordinate system of the center, and its units determine the units of the\n * resolution (projection units per pixel). The default projection is\n * Spherical Mercator (EPSG:3857).\n *\n * ### The constraints\n *\n * `setCenter`, `setResolution` and `setRotation` can be used to change the\n * states of the view. Any value can be passed to the setters. And the value\n * that is passed to a setter will effectively be the value set in the view,\n * and returned by the corresponding getter.\n *\n * But a View object also has a *resolution constraint*, a\n * *rotation constraint* and a *center constraint*.\n *\n * As said above, no constraints are applied when the setters are used to set\n * new states for the view. Applying constraints is done explicitly through\n * the use of the `constrain*` functions (`constrainResolution` and\n * `constrainRotation` and `constrainCenter`).\n *\n * The main users of the constraints are the interactions and the\n * controls. For example, double-clicking on the map changes the view to\n * the \"next\" resolution. And releasing the fingers after pinch-zooming\n * snaps to the closest resolution (with an animation).\n *\n * The *resolution constraint* snaps to specific resolutions. It is\n * determined by the following options: `resolutions`, `maxResolution`,\n * `maxZoom`, and `zoomFactor`. If `resolutions` is set, the other three\n * options are ignored. See documentation for each option for more\n * information.\n *\n * The *rotation constraint* snaps to specific angles. It is determined\n * by the following options: `enableRotation` and `constrainRotation`.\n * By default the rotation value is snapped to zero when approaching the\n * horizontal.\n *\n * The *center constraint* is determined by the `extent` option. By\n * default the center is not constrained at all.\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/View~ViewOptions=} opt_options View options.\n * @api\n */\nconst View = function(opt_options) {\n  BaseObject.call(this);\n\n  const options = assign({}, opt_options);\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.hints_ = [0, 0];\n\n  /**\n   * @private\n   * @type {Array.<Array.<module:ol/View~Animation>>}\n   */\n  this.animations_ = [];\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.updateAnimationKey_;\n\n  this.updateAnimations_ = this.updateAnimations_.bind(this);\n\n  /**\n   * @private\n   * @const\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = createProjection(options.projection, 'EPSG:3857');\n\n  this.applyOptions_(options);\n};\n\ninherits(View, BaseObject);\n\n\n/**\n * Set up the view with the given options.\n * @param {module:ol/View~ViewOptions} options View options.\n */\nView.prototype.applyOptions_ = function(options) {\n\n  /**\n   * @type {Object.<string, *>}\n   */\n  const properties = {};\n  properties[ViewProperty.CENTER] = options.center !== undefined ?\n    options.center : null;\n\n  const resolutionConstraintInfo = createResolutionConstraint(options);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxResolution_ = resolutionConstraintInfo.maxResolution;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minResolution_ = resolutionConstraintInfo.minResolution;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;\n\n  /**\n   * @private\n   * @type {Array.<number>|undefined}\n   */\n  this.resolutions_ = options.resolutions;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minZoom_ = resolutionConstraintInfo.minZoom;\n\n  const centerConstraint = createCenterConstraint(options);\n  const resolutionConstraint = resolutionConstraintInfo.constraint;\n  const rotationConstraint = createRotationConstraint(options);\n\n  /**\n   * @private\n   * @type {module:ol/View~Constraints}\n   */\n  this.constraints_ = {\n    center: centerConstraint,\n    resolution: resolutionConstraint,\n    rotation: rotationConstraint\n  };\n\n  if (options.resolution !== undefined) {\n    properties[ViewProperty.RESOLUTION] = options.resolution;\n  } else if (options.zoom !== undefined) {\n    properties[ViewProperty.RESOLUTION] = this.constrainResolution(\n      this.maxResolution_, options.zoom - this.minZoom_);\n\n    if (this.resolutions_) { // in case map zoom is out of min/max zoom range\n      properties[ViewProperty.RESOLUTION] = clamp(\n        Number(this.getResolution() || properties[ViewProperty.RESOLUTION]),\n        this.minResolution_, this.maxResolution_);\n    }\n  }\n  properties[ViewProperty.ROTATION] = options.rotation !== undefined ? options.rotation : 0;\n  this.setProperties(properties);\n\n  /**\n   * @private\n   * @type {module:ol/View~ViewOptions}\n   */\n  this.options_ = options;\n\n};\n\n/**\n * Get an updated version of the view options used to construct the view.  The\n * current resolution (or zoom), center, and rotation are applied to any stored\n * options.  The provided options can be used to apply new min/max zoom or\n * resolution limits.\n * @param {module:ol/View~ViewOptions} newOptions New options to be applied.\n * @return {module:ol/View~ViewOptions} New options updated with the current view state.\n */\nView.prototype.getUpdatedOptions_ = function(newOptions) {\n  const options = assign({}, this.options_);\n\n  // preserve resolution (or zoom)\n  if (options.resolution !== undefined) {\n    options.resolution = this.getResolution();\n  } else {\n    options.zoom = this.getZoom();\n  }\n\n  // preserve center\n  options.center = this.getCenter();\n\n  // preserve rotation\n  options.rotation = this.getRotation();\n\n  return assign({}, options, newOptions);\n};\n\n\n/**\n * Animate the view.  The view's center, zoom (or resolution), and rotation\n * can be animated for smooth transitions between view states.  For example,\n * to animate the view to a new zoom level:\n *\n *     view.animate({zoom: view.getZoom() + 1});\n *\n * By default, the animation lasts one second and uses in-and-out easing.  You\n * can customize this behavior by including `duration` (in milliseconds) and\n * `easing` options (see {@link module:ol/easing}).\n *\n * To chain together multiple animations, call the method with multiple\n * animation objects.  For example, to first zoom and then pan:\n *\n *     view.animate({zoom: 10}, {center: [0, 0]});\n *\n * If you provide a function as the last argument to the animate method, it\n * will get called at the end of an animation series.  The callback will be\n * called with `true` if the animation series completed on its own or `false`\n * if it was cancelled.\n *\n * Animations are cancelled by user interactions (e.g. dragging the map) or by\n * calling `view.setCenter()`, `view.setResolution()`, or `view.setRotation()`\n * (or another method that calls one of these).\n *\n * @param {...(module:ol/View~AnimationOptions|function(boolean))} var_args Animation\n *     options.  Multiple animations can be run in series by passing multiple\n *     options objects.  To run multiple animations in parallel, call the method\n *     multiple times.  An optional callback can be provided as a final\n *     argument.  The callback will be called with a boolean indicating whether\n *     the animation completed without being cancelled.\n * @api\n */\nView.prototype.animate = function(var_args) {\n  let animationCount = arguments.length;\n  let callback;\n  if (animationCount > 1 && typeof arguments[animationCount - 1] === 'function') {\n    callback = arguments[animationCount - 1];\n    --animationCount;\n  }\n  if (!this.isDef()) {\n    // if view properties are not yet set, shortcut to the final state\n    const state = arguments[animationCount - 1];\n    if (state.center) {\n      this.setCenter(state.center);\n    }\n    if (state.zoom !== undefined) {\n      this.setZoom(state.zoom);\n    }\n    if (state.rotation !== undefined) {\n      this.setRotation(state.rotation);\n    }\n    if (callback) {\n      setTimeout(function() {\n        callback(true);\n      }, 0);\n    }\n    return;\n  }\n  let start = Date.now();\n  let center = this.getCenter().slice();\n  let resolution = this.getResolution();\n  let rotation = this.getRotation();\n  const series = [];\n  for (let i = 0; i < animationCount; ++i) {\n    const options = /** @type {module:ol/View~AnimationOptions} */ (arguments[i]);\n\n    const animation = /** @type {module:ol/View~Animation} */ ({\n      start: start,\n      complete: false,\n      anchor: options.anchor,\n      duration: options.duration !== undefined ? options.duration : 1000,\n      easing: options.easing || inAndOut\n    });\n\n    if (options.center) {\n      animation.sourceCenter = center;\n      animation.targetCenter = options.center;\n      center = animation.targetCenter;\n    }\n\n    if (options.zoom !== undefined) {\n      animation.sourceResolution = resolution;\n      animation.targetResolution = this.constrainResolution(\n        this.maxResolution_, options.zoom - this.minZoom_, 0);\n      resolution = animation.targetResolution;\n    } else if (options.resolution) {\n      animation.sourceResolution = resolution;\n      animation.targetResolution = options.resolution;\n      resolution = animation.targetResolution;\n    }\n\n    if (options.rotation !== undefined) {\n      animation.sourceRotation = rotation;\n      const delta = modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;\n      animation.targetRotation = rotation + delta;\n      rotation = animation.targetRotation;\n    }\n\n    animation.callback = callback;\n\n    // check if animation is a no-op\n    if (isNoopAnimation(animation)) {\n      animation.complete = true;\n      // we still push it onto the series for callback handling\n    } else {\n      start += animation.duration;\n    }\n    series.push(animation);\n  }\n  this.animations_.push(series);\n  this.setHint(ViewHint.ANIMATING, 1);\n  this.updateAnimations_();\n};\n\n\n/**\n * Determine if the view is being animated.\n * @return {boolean} The view is being animated.\n * @api\n */\nView.prototype.getAnimating = function() {\n  return this.hints_[ViewHint.ANIMATING] > 0;\n};\n\n\n/**\n * Determine if the user is interacting with the view, such as panning or zooming.\n * @return {boolean} The view is being interacted with.\n * @api\n */\nView.prototype.getInteracting = function() {\n  return this.hints_[ViewHint.INTERACTING] > 0;\n};\n\n\n/**\n * Cancel any ongoing animations.\n * @api\n */\nView.prototype.cancelAnimations = function() {\n  this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);\n  for (let i = 0, ii = this.animations_.length; i < ii; ++i) {\n    const series = this.animations_[i];\n    if (series[0].callback) {\n      series[0].callback(false);\n    }\n  }\n  this.animations_.length = 0;\n};\n\n/**\n * Update all animations.\n */\nView.prototype.updateAnimations_ = function() {\n  if (this.updateAnimationKey_ !== undefined) {\n    cancelAnimationFrame(this.updateAnimationKey_);\n    this.updateAnimationKey_ = undefined;\n  }\n  if (!this.getAnimating()) {\n    return;\n  }\n  const now = Date.now();\n  let more = false;\n  for (let i = this.animations_.length - 1; i >= 0; --i) {\n    const series = this.animations_[i];\n    let seriesComplete = true;\n    for (let j = 0, jj = series.length; j < jj; ++j) {\n      const animation = series[j];\n      if (animation.complete) {\n        continue;\n      }\n      const elapsed = now - animation.start;\n      let fraction = animation.duration > 0 ? elapsed / animation.duration : 1;\n      if (fraction >= 1) {\n        animation.complete = true;\n        fraction = 1;\n      } else {\n        seriesComplete = false;\n      }\n      const progress = animation.easing(fraction);\n      if (animation.sourceCenter) {\n        const x0 = animation.sourceCenter[0];\n        const y0 = animation.sourceCenter[1];\n        const x1 = animation.targetCenter[0];\n        const y1 = animation.targetCenter[1];\n        const x = x0 + progress * (x1 - x0);\n        const y = y0 + progress * (y1 - y0);\n        this.set(ViewProperty.CENTER, [x, y]);\n      }\n      if (animation.sourceResolution && animation.targetResolution) {\n        const resolution = progress === 1 ?\n          animation.targetResolution :\n          animation.sourceResolution + progress * (animation.targetResolution - animation.sourceResolution);\n        if (animation.anchor) {\n          this.set(ViewProperty.CENTER,\n            this.calculateCenterZoom(resolution, animation.anchor));\n        }\n        this.set(ViewProperty.RESOLUTION, resolution);\n      }\n      if (animation.sourceRotation !== undefined && animation.targetRotation !== undefined) {\n        const rotation = progress === 1 ?\n          modulo(animation.targetRotation + Math.PI, 2 * Math.PI) - Math.PI :\n          animation.sourceRotation + progress * (animation.targetRotation - animation.sourceRotation);\n        if (animation.anchor) {\n          this.set(ViewProperty.CENTER,\n            this.calculateCenterRotate(rotation, animation.anchor));\n        }\n        this.set(ViewProperty.ROTATION, rotation);\n      }\n      more = true;\n      if (!animation.complete) {\n        break;\n      }\n    }\n    if (seriesComplete) {\n      this.animations_[i] = null;\n      this.setHint(ViewHint.ANIMATING, -1);\n      const callback = series[0].callback;\n      if (callback) {\n        setTimeout(function() {\n          callback(true);\n        }, 0);\n      }\n    }\n  }\n  // prune completed series\n  this.animations_ = this.animations_.filter(Boolean);\n  if (more && this.updateAnimationKey_ === undefined) {\n    this.updateAnimationKey_ = requestAnimationFrame(this.updateAnimations_);\n  }\n};\n\n/**\n * @param {number} rotation Target rotation.\n * @param {module:ol/coordinate~Coordinate} anchor Rotation anchor.\n * @return {module:ol/coordinate~Coordinate|undefined} Center for rotation and anchor.\n */\nView.prototype.calculateCenterRotate = function(rotation, anchor) {\n  let center;\n  const currentCenter = this.getCenter();\n  if (currentCenter !== undefined) {\n    center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];\n    rotateCoordinate(center, rotation - this.getRotation());\n    addCoordinate(center, anchor);\n  }\n  return center;\n};\n\n\n/**\n * @param {number} resolution Target resolution.\n * @param {module:ol/coordinate~Coordinate} anchor Zoom anchor.\n * @return {module:ol/coordinate~Coordinate|undefined} Center for resolution and anchor.\n */\nView.prototype.calculateCenterZoom = function(resolution, anchor) {\n  let center;\n  const currentCenter = this.getCenter();\n  const currentResolution = this.getResolution();\n  if (currentCenter !== undefined && currentResolution !== undefined) {\n    const x = anchor[0] - resolution * (anchor[0] - currentCenter[0]) / currentResolution;\n    const y = anchor[1] - resolution * (anchor[1] - currentCenter[1]) / currentResolution;\n    center = [x, y];\n  }\n  return center;\n};\n\n\n/**\n * @private\n * @return {module:ol/size~Size} Viewport size or `[100, 100]` when no viewport is found.\n */\nView.prototype.getSizeFromViewport_ = function() {\n  const size = [100, 100];\n  const selector = '.ol-viewport[data-view=\"' + getUid(this) + '\"]';\n  const element = document.querySelector(selector);\n  if (element) {\n    const metrics = getComputedStyle(element);\n    size[0] = parseInt(metrics.width, 10);\n    size[1] = parseInt(metrics.height, 10);\n  }\n  return size;\n};\n\n\n/**\n * Get the constrained center of this view.\n * @param {module:ol/coordinate~Coordinate|undefined} center Center.\n * @return {module:ol/coordinate~Coordinate|undefined} Constrained center.\n * @api\n */\nView.prototype.constrainCenter = function(center) {\n  return this.constraints_.center(center);\n};\n\n\n/**\n * Get the constrained resolution of this view.\n * @param {number|undefined} resolution Resolution.\n * @param {number=} opt_delta Delta. Default is `0`.\n * @param {number=} opt_direction Direction. Default is `0`.\n * @return {number|undefined} Constrained resolution.\n * @api\n */\nView.prototype.constrainResolution = function(resolution, opt_delta, opt_direction) {\n  const delta = opt_delta || 0;\n  const direction = opt_direction || 0;\n  return this.constraints_.resolution(resolution, delta, direction);\n};\n\n\n/**\n * Get the constrained rotation of this view.\n * @param {number|undefined} rotation Rotation.\n * @param {number=} opt_delta Delta. Default is `0`.\n * @return {number|undefined} Constrained rotation.\n * @api\n */\nView.prototype.constrainRotation = function(rotation, opt_delta) {\n  const delta = opt_delta || 0;\n  return this.constraints_.rotation(rotation, delta);\n};\n\n\n/**\n * Get the view center.\n * @return {module:ol/coordinate~Coordinate|undefined} The center of the view.\n * @observable\n * @api\n */\nView.prototype.getCenter = function() {\n  return (\n    /** @type {module:ol/coordinate~Coordinate|undefined} */ (this.get(ViewProperty.CENTER))\n  );\n};\n\n\n/**\n * @return {module:ol/View~Constraints} Constraints.\n */\nView.prototype.getConstraints = function() {\n  return this.constraints_;\n};\n\n\n/**\n * @param {Array.<number>=} opt_hints Destination array.\n * @return {Array.<number>} Hint.\n */\nView.prototype.getHints = function(opt_hints) {\n  if (opt_hints !== undefined) {\n    opt_hints[0] = this.hints_[0];\n    opt_hints[1] = this.hints_[1];\n    return opt_hints;\n  } else {\n    return this.hints_.slice();\n  }\n};\n\n\n/**\n * Calculate the extent for the current view state and the passed size.\n * The size is the pixel dimensions of the box into which the calculated extent\n * should fit. In most cases you want to get the extent of the entire map,\n * that is `map.getSize()`.\n * @param {module:ol/size~Size=} opt_size Box pixel size. If not provided, the size of the\n * first map that uses this view will be used.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nView.prototype.calculateExtent = function(opt_size) {\n  const size = opt_size || this.getSizeFromViewport_();\n  const center = /** @type {!module:ol/coordinate~Coordinate} */ (this.getCenter());\n  assert(center, 1); // The view center is not defined\n  const resolution = /** @type {!number} */ (this.getResolution());\n  assert(resolution !== undefined, 2); // The view resolution is not defined\n  const rotation = /** @type {!number} */ (this.getRotation());\n  assert(rotation !== undefined, 3); // The view rotation is not defined\n\n  return getForViewAndSize(center, resolution, rotation, size);\n};\n\n\n/**\n * Get the maximum resolution of the view.\n * @return {number} The maximum resolution of the view.\n * @api\n */\nView.prototype.getMaxResolution = function() {\n  return this.maxResolution_;\n};\n\n\n/**\n * Get the minimum resolution of the view.\n * @return {number} The minimum resolution of the view.\n * @api\n */\nView.prototype.getMinResolution = function() {\n  return this.minResolution_;\n};\n\n\n/**\n * Get the maximum zoom level for the view.\n * @return {number} The maximum zoom level.\n * @api\n */\nView.prototype.getMaxZoom = function() {\n  return /** @type {number} */ (this.getZoomForResolution(this.minResolution_));\n};\n\n\n/**\n * Set a new maximum zoom level for the view.\n * @param {number} zoom The maximum zoom level.\n * @api\n */\nView.prototype.setMaxZoom = function(zoom) {\n  this.applyOptions_(this.getUpdatedOptions_({maxZoom: zoom}));\n};\n\n\n/**\n * Get the minimum zoom level for the view.\n * @return {number} The minimum zoom level.\n * @api\n */\nView.prototype.getMinZoom = function() {\n  return /** @type {number} */ (this.getZoomForResolution(this.maxResolution_));\n};\n\n\n/**\n * Set a new minimum zoom level for the view.\n * @param {number} zoom The minimum zoom level.\n * @api\n */\nView.prototype.setMinZoom = function(zoom) {\n  this.applyOptions_(this.getUpdatedOptions_({minZoom: zoom}));\n};\n\n\n/**\n * Get the view projection.\n * @return {module:ol/proj/Projection} The projection of the view.\n * @api\n */\nView.prototype.getProjection = function() {\n  return this.projection_;\n};\n\n\n/**\n * Get the view resolution.\n * @return {number|undefined} The resolution of the view.\n * @observable\n * @api\n */\nView.prototype.getResolution = function() {\n  return /** @type {number|undefined} */ (this.get(ViewProperty.RESOLUTION));\n};\n\n\n/**\n * Get the resolutions for the view. This returns the array of resolutions\n * passed to the constructor of the View, or undefined if none were given.\n * @return {Array.<number>|undefined} The resolutions of the view.\n * @api\n */\nView.prototype.getResolutions = function() {\n  return this.resolutions_;\n};\n\n\n/**\n * Get the resolution for a provided extent (in map units) and size (in pixels).\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/size~Size=} opt_size Box pixel size.\n * @return {number} The resolution at which the provided extent will render at\n *     the given size.\n * @api\n */\nView.prototype.getResolutionForExtent = function(extent, opt_size) {\n  const size = opt_size || this.getSizeFromViewport_();\n  const xResolution = getWidth(extent) / size[0];\n  const yResolution = getHeight(extent) / size[1];\n  return Math.max(xResolution, yResolution);\n};\n\n\n/**\n * Return a function that returns a value between 0 and 1 for a\n * resolution. Exponential scaling is assumed.\n * @param {number=} opt_power Power.\n * @return {function(number): number} Resolution for value function.\n */\nView.prototype.getResolutionForValueFunction = function(opt_power) {\n  const power = opt_power || 2;\n  const maxResolution = this.maxResolution_;\n  const minResolution = this.minResolution_;\n  const max = Math.log(maxResolution / minResolution) / Math.log(power);\n  return (\n    /**\n     * @param {number} value Value.\n     * @return {number} Resolution.\n     */\n    function(value) {\n      const resolution = maxResolution / Math.pow(power, value * max);\n      return resolution;\n    });\n};\n\n\n/**\n * Get the view rotation.\n * @return {number} The rotation of the view in radians.\n * @observable\n * @api\n */\nView.prototype.getRotation = function() {\n  return /** @type {number} */ (this.get(ViewProperty.ROTATION));\n};\n\n\n/**\n * Return a function that returns a resolution for a value between\n * 0 and 1. Exponential scaling is assumed.\n * @param {number=} opt_power Power.\n * @return {function(number): number} Value for resolution function.\n */\nView.prototype.getValueForResolutionFunction = function(opt_power) {\n  const power = opt_power || 2;\n  const maxResolution = this.maxResolution_;\n  const minResolution = this.minResolution_;\n  const max = Math.log(maxResolution / minResolution) / Math.log(power);\n  return (\n    /**\n     * @param {number} resolution Resolution.\n     * @return {number} Value.\n     */\n    function(resolution) {\n      const value = (Math.log(maxResolution / resolution) / Math.log(power)) / max;\n      return value;\n    });\n};\n\n\n/**\n * @return {module:ol/View~State} View state.\n */\nView.prototype.getState = function() {\n  const center = /** @type {module:ol/coordinate~Coordinate} */ (this.getCenter());\n  const projection = this.getProjection();\n  const resolution = /** @type {number} */ (this.getResolution());\n  const rotation = this.getRotation();\n  return (\n    /** @type {module:ol/View~State} */ ({\n      center: center.slice(),\n      projection: projection !== undefined ? projection : null,\n      resolution: resolution,\n      rotation: rotation,\n      zoom: this.getZoom()\n    })\n  );\n};\n\n\n/**\n * Get the current zoom level.  If you configured your view with a resolutions\n * array (this is rare), this method may return non-integer zoom levels (so\n * the zoom level is not safe to use as an index into a resolutions array).\n * @return {number|undefined} Zoom.\n * @api\n */\nView.prototype.getZoom = function() {\n  let zoom;\n  const resolution = this.getResolution();\n  if (resolution !== undefined) {\n    zoom = this.getZoomForResolution(resolution);\n  }\n  return zoom;\n};\n\n\n/**\n * Get the zoom level for a resolution.\n * @param {number} resolution The resolution.\n * @return {number|undefined} The zoom level for the provided resolution.\n * @api\n */\nView.prototype.getZoomForResolution = function(resolution) {\n  let offset = this.minZoom_ || 0;\n  let max, zoomFactor;\n  if (this.resolutions_) {\n    const nearest = linearFindNearest(this.resolutions_, resolution, 1);\n    offset = nearest;\n    max = this.resolutions_[nearest];\n    if (nearest == this.resolutions_.length - 1) {\n      zoomFactor = 2;\n    } else {\n      zoomFactor = max / this.resolutions_[nearest + 1];\n    }\n  } else {\n    max = this.maxResolution_;\n    zoomFactor = this.zoomFactor_;\n  }\n  return offset + Math.log(max / resolution) / Math.log(zoomFactor);\n};\n\n\n/**\n * Get the resolution for a zoom level.\n * @param {number} zoom Zoom level.\n * @return {number} The view resolution for the provided zoom level.\n * @api\n */\nView.prototype.getResolutionForZoom = function(zoom) {\n  return /** @type {number} */ (this.constrainResolution(\n    this.maxResolution_, zoom - this.minZoom_, 0));\n};\n\n\n/**\n * Fit the given geometry or extent based on the given map size and border.\n * The size is pixel dimensions of the box to fit the extent into.\n * In most cases you will want to use the map size, that is `map.getSize()`.\n * Takes care of the map angle.\n * @param {module:ol/geom/SimpleGeometry|module:ol/extent~Extent} geometryOrExtent The geometry or\n *     extent to fit the view to.\n * @param {module:ol/View~FitOptions=} opt_options Options.\n * @api\n */\nView.prototype.fit = function(geometryOrExtent, opt_options) {\n  const options = opt_options || {};\n  let size = options.size;\n  if (!size) {\n    size = this.getSizeFromViewport_();\n  }\n  /** @type {module:ol/geom/SimpleGeometry} */\n  let geometry;\n  if (!(geometryOrExtent instanceof SimpleGeometry)) {\n    assert(Array.isArray(geometryOrExtent),\n      24); // Invalid extent or geometry provided as `geometry`\n    assert(!isEmpty(geometryOrExtent),\n      25); // Cannot fit empty extent provided as `geometry`\n    geometry = polygonFromExtent(geometryOrExtent);\n  } else if (geometryOrExtent.getType() === GeometryType.CIRCLE) {\n    geometryOrExtent = geometryOrExtent.getExtent();\n    geometry = polygonFromExtent(geometryOrExtent);\n    geometry.rotate(this.getRotation(), getCenter(geometryOrExtent));\n  } else {\n    geometry = geometryOrExtent;\n  }\n\n  const padding = options.padding !== undefined ? options.padding : [0, 0, 0, 0];\n  const constrainResolution = options.constrainResolution !== undefined ?\n    options.constrainResolution : true;\n  const nearest = options.nearest !== undefined ? options.nearest : false;\n  let minResolution;\n  if (options.minResolution !== undefined) {\n    minResolution = options.minResolution;\n  } else if (options.maxZoom !== undefined) {\n    minResolution = this.constrainResolution(\n      this.maxResolution_, options.maxZoom - this.minZoom_, 0);\n  } else {\n    minResolution = 0;\n  }\n  const coords = geometry.getFlatCoordinates();\n\n  // calculate rotated extent\n  const rotation = this.getRotation();\n  const cosAngle = Math.cos(-rotation);\n  let sinAngle = Math.sin(-rotation);\n  let minRotX = +Infinity;\n  let minRotY = +Infinity;\n  let maxRotX = -Infinity;\n  let maxRotY = -Infinity;\n  const stride = geometry.getStride();\n  for (let i = 0, ii = coords.length; i < ii; i += stride) {\n    const rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;\n    const rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;\n    minRotX = Math.min(minRotX, rotX);\n    minRotY = Math.min(minRotY, rotY);\n    maxRotX = Math.max(maxRotX, rotX);\n    maxRotY = Math.max(maxRotY, rotY);\n  }\n\n  // calculate resolution\n  let resolution = this.getResolutionForExtent(\n    [minRotX, minRotY, maxRotX, maxRotY],\n    [size[0] - padding[1] - padding[3], size[1] - padding[0] - padding[2]]);\n  resolution = isNaN(resolution) ? minResolution :\n    Math.max(resolution, minResolution);\n  if (constrainResolution) {\n    let constrainedResolution = this.constrainResolution(resolution, 0, 0);\n    if (!nearest && constrainedResolution < resolution) {\n      constrainedResolution = this.constrainResolution(\n        constrainedResolution, -1, 0);\n    }\n    resolution = constrainedResolution;\n  }\n\n  // calculate center\n  sinAngle = -sinAngle; // go back to original rotation\n  let centerRotX = (minRotX + maxRotX) / 2;\n  let centerRotY = (minRotY + maxRotY) / 2;\n  centerRotX += (padding[1] - padding[3]) / 2 * resolution;\n  centerRotY += (padding[0] - padding[2]) / 2 * resolution;\n  const centerX = centerRotX * cosAngle - centerRotY * sinAngle;\n  const centerY = centerRotY * cosAngle + centerRotX * sinAngle;\n  const center = [centerX, centerY];\n  const callback = options.callback ? options.callback : UNDEFINED;\n\n  if (options.duration !== undefined) {\n    this.animate({\n      resolution: resolution,\n      center: center,\n      duration: options.duration,\n      easing: options.easing\n    }, callback);\n  } else {\n    this.setResolution(resolution);\n    this.setCenter(center);\n    setTimeout(callback.bind(undefined, true), 0);\n  }\n};\n\n\n/**\n * Center on coordinate and view position.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/size~Size} size Box pixel size.\n * @param {module:ol~Pixel} position Position on the view to center on.\n * @api\n */\nView.prototype.centerOn = function(coordinate, size, position) {\n  // calculate rotated position\n  const rotation = this.getRotation();\n  const cosAngle = Math.cos(-rotation);\n  let sinAngle = Math.sin(-rotation);\n  let rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n  let rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n  const resolution = this.getResolution();\n  rotX += (size[0] / 2 - position[0]) * resolution;\n  rotY += (position[1] - size[1] / 2) * resolution;\n\n  // go back to original angle\n  sinAngle = -sinAngle; // go back to original rotation\n  const centerX = rotX * cosAngle - rotY * sinAngle;\n  const centerY = rotY * cosAngle + rotX * sinAngle;\n\n  this.setCenter([centerX, centerY]);\n};\n\n\n/**\n * @return {boolean} Is defined.\n */\nView.prototype.isDef = function() {\n  return !!this.getCenter() && this.getResolution() !== undefined;\n};\n\n\n/**\n * Rotate the view around a given coordinate.\n * @param {number} rotation New rotation value for the view.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor The rotation center.\n * @api\n */\nView.prototype.rotate = function(rotation, opt_anchor) {\n  if (opt_anchor !== undefined) {\n    const center = this.calculateCenterRotate(rotation, opt_anchor);\n    this.setCenter(center);\n  }\n  this.setRotation(rotation);\n};\n\n\n/**\n * Set the center of the current view.\n * @param {module:ol/coordinate~Coordinate|undefined} center The center of the view.\n * @observable\n * @api\n */\nView.prototype.setCenter = function(center) {\n  this.set(ViewProperty.CENTER, center);\n  if (this.getAnimating()) {\n    this.cancelAnimations();\n  }\n};\n\n\n/**\n * @param {module:ol/ViewHint} hint Hint.\n * @param {number} delta Delta.\n * @return {number} New value.\n */\nView.prototype.setHint = function(hint, delta) {\n  this.hints_[hint] += delta;\n  this.changed();\n  return this.hints_[hint];\n};\n\n\n/**\n * Set the resolution for this view.\n * @param {number|undefined} resolution The resolution of the view.\n * @observable\n * @api\n */\nView.prototype.setResolution = function(resolution) {\n  this.set(ViewProperty.RESOLUTION, resolution);\n  if (this.getAnimating()) {\n    this.cancelAnimations();\n  }\n};\n\n\n/**\n * Set the rotation for this view.\n * @param {number} rotation The rotation of the view in radians.\n * @observable\n * @api\n */\nView.prototype.setRotation = function(rotation) {\n  this.set(ViewProperty.ROTATION, rotation);\n  if (this.getAnimating()) {\n    this.cancelAnimations();\n  }\n};\n\n\n/**\n * Zoom to a specific zoom level.\n * @param {number} zoom Zoom level.\n * @api\n */\nView.prototype.setZoom = function(zoom) {\n  this.setResolution(this.getResolutionForZoom(zoom));\n};\n\n\n/**\n * @param {module:ol/View~ViewOptions} options View options.\n * @return {module:ol/centerconstraint~Type} The constraint.\n */\nexport function createCenterConstraint(options) {\n  if (options.extent !== undefined) {\n    return createExtent(options.extent);\n  } else {\n    return centerNone;\n  }\n}\n\n\n/**\n * @param {module:ol/View~ViewOptions} options View options.\n * @return {{constraint: module:ol/resolutionconstraint~Type, maxResolution: number,\n *     minResolution: number, minZoom: number, zoomFactor: number}} The constraint.\n */\nexport function createResolutionConstraint(options) {\n  let resolutionConstraint;\n  let maxResolution;\n  let minResolution;\n\n  // TODO: move these to be ol constants\n  // see https://github.com/openlayers/openlayers/issues/2076\n  const defaultMaxZoom = 28;\n  const defaultZoomFactor = 2;\n\n  let minZoom = options.minZoom !== undefined ?\n    options.minZoom : DEFAULT_MIN_ZOOM;\n\n  let maxZoom = options.maxZoom !== undefined ?\n    options.maxZoom : defaultMaxZoom;\n\n  const zoomFactor = options.zoomFactor !== undefined ?\n    options.zoomFactor : defaultZoomFactor;\n\n  if (options.resolutions !== undefined) {\n    const resolutions = options.resolutions;\n    maxResolution = resolutions[minZoom];\n    minResolution = resolutions[maxZoom] !== undefined ?\n      resolutions[maxZoom] : resolutions[resolutions.length - 1];\n    resolutionConstraint = createSnapToResolutions(\n      resolutions);\n  } else {\n    // calculate the default min and max resolution\n    const projection = createProjection(options.projection, 'EPSG:3857');\n    const extent = projection.getExtent();\n    const size = !extent ?\n      // use an extent that can fit the whole world if need be\n      360 * METERS_PER_UNIT[Units.DEGREES] /\n            projection.getMetersPerUnit() :\n      Math.max(getWidth(extent), getHeight(extent));\n\n    const defaultMaxResolution = size / DEFAULT_TILE_SIZE / Math.pow(\n      defaultZoomFactor, DEFAULT_MIN_ZOOM);\n\n    const defaultMinResolution = defaultMaxResolution / Math.pow(\n      defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);\n\n    // user provided maxResolution takes precedence\n    maxResolution = options.maxResolution;\n    if (maxResolution !== undefined) {\n      minZoom = 0;\n    } else {\n      maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);\n    }\n\n    // user provided minResolution takes precedence\n    minResolution = options.minResolution;\n    if (minResolution === undefined) {\n      if (options.maxZoom !== undefined) {\n        if (options.maxResolution !== undefined) {\n          minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);\n        } else {\n          minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);\n        }\n      } else {\n        minResolution = defaultMinResolution;\n      }\n    }\n\n    // given discrete zoom levels, minResolution may be different than provided\n    maxZoom = minZoom + Math.floor(\n      Math.log(maxResolution / minResolution) / Math.log(zoomFactor));\n    minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);\n\n    resolutionConstraint = createSnapToPower(\n      zoomFactor, maxResolution, maxZoom - minZoom);\n  }\n  return {constraint: resolutionConstraint, maxResolution: maxResolution,\n    minResolution: minResolution, minZoom: minZoom, zoomFactor: zoomFactor};\n}\n\n\n/**\n * @param {module:ol/View~ViewOptions} options View options.\n * @return {module:ol/rotationconstraint~Type} Rotation constraint.\n */\nexport function createRotationConstraint(options) {\n  const enableRotation = options.enableRotation !== undefined ?\n    options.enableRotation : true;\n  if (enableRotation) {\n    const constrainRotation = options.constrainRotation;\n    if (constrainRotation === undefined || constrainRotation === true) {\n      return createSnapToZero();\n    } else if (constrainRotation === false) {\n      return rotationNone;\n    } else if (typeof constrainRotation === 'number') {\n      return createSnapToN(constrainRotation);\n    } else {\n      return rotationNone;\n    }\n  } else {\n    return disable;\n  }\n}\n\n\n/**\n * Determine if an animation involves no view change.\n * @param {module:ol/View~Animation} animation The animation.\n * @return {boolean} The animation involves no view change.\n */\nexport function isNoopAnimation(animation) {\n  if (animation.sourceCenter && animation.targetCenter) {\n    if (!coordinatesEqual(animation.sourceCenter, animation.targetCenter)) {\n      return false;\n    }\n  }\n  if (animation.sourceResolution !== animation.targetResolution) {\n    return false;\n  }\n  if (animation.sourceRotation !== animation.targetRotation) {\n    return false;\n  }\n  return true;\n}\n\nexport default View;\n","/**\n * @module ol/ViewHint\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  ANIMATING: 0,\n  INTERACTING: 1\n};\n","/**\n * @module ol/ViewProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CENTER: 'center',\n  RESOLUTION: 'resolution',\n  ROTATION: 'rotation'\n};\n","/**\n * @module ol/array\n */\n\n\n/**\n * Performs a binary search on the provided sorted list and returns the index of the item if found. If it can't be found it'll return -1.\n * https://github.com/darkskyapp/binary-search\n *\n * @param {Array.<*>} haystack Items to search through.\n * @param {*} needle The item to look for.\n * @param {Function=} opt_comparator Comparator function.\n * @return {number} The index of the item if found, -1 if not.\n */\nexport function binarySearch(haystack, needle, opt_comparator) {\n  let mid, cmp;\n  const comparator = opt_comparator || numberSafeCompareFunction;\n  let low = 0;\n  let high = haystack.length;\n  let found = false;\n\n  while (low < high) {\n    /* Note that \"(low + high) >>> 1\" may overflow, and results in a typecast\n     * to double (which gives the wrong results). */\n    mid = low + (high - low >> 1);\n    cmp = +comparator(haystack[mid], needle);\n\n    if (cmp < 0.0) { /* Too low. */\n      low  = mid + 1;\n\n    } else { /* Key found or too high */\n      high = mid;\n      found = !cmp;\n    }\n  }\n\n  /* Key not found. */\n  return found ? low : ~low;\n}\n\n\n/**\n * Compare function for array sort that is safe for numbers.\n * @param {*} a The first object to be compared.\n * @param {*} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is less than, equal to, or greater than the second.\n */\nexport function numberSafeCompareFunction(a, b) {\n  return a > b ? 1 : a < b ? -1 : 0;\n}\n\n\n/**\n * Whether the array contains the given object.\n * @param {Array.<*>} arr The array to test for the presence of the element.\n * @param {*} obj The object for which to test.\n * @return {boolean} The object is in the array.\n */\nexport function includes(arr, obj) {\n  return arr.indexOf(obj) >= 0;\n}\n\n\n/**\n * @param {Array.<number>} arr Array.\n * @param {number} target Target.\n * @param {number} direction 0 means return the nearest, > 0\n *    means return the largest nearest, < 0 means return the\n *    smallest nearest.\n * @return {number} Index.\n */\nexport function linearFindNearest(arr, target, direction) {\n  const n = arr.length;\n  if (arr[0] <= target) {\n    return 0;\n  } else if (target <= arr[n - 1]) {\n    return n - 1;\n  } else {\n    let i;\n    if (direction > 0) {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] < target) {\n          return i - 1;\n        }\n      }\n    } else if (direction < 0) {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] <= target) {\n          return i;\n        }\n      }\n    } else {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] == target) {\n          return i;\n        } else if (arr[i] < target) {\n          if (arr[i - 1] - target < target - arr[i]) {\n            return i - 1;\n          } else {\n            return i;\n          }\n        }\n      }\n    }\n    return n - 1;\n  }\n}\n\n\n/**\n * @param {Array.<*>} arr Array.\n * @param {number} begin Begin index.\n * @param {number} end End index.\n */\nexport function reverseSubArray(arr, begin, end) {\n  while (begin < end) {\n    const tmp = arr[begin];\n    arr[begin] = arr[end];\n    arr[end] = tmp;\n    ++begin;\n    --end;\n  }\n}\n\n\n/**\n * @param {Array.<VALUE>} arr The array to modify.\n * @param {!Array.<VALUE>|VALUE} data The elements or arrays of elements to add to arr.\n * @template VALUE\n */\nexport function extend(arr, data) {\n  const extension = Array.isArray(data) ? data : [data];\n  const length = extension.length;\n  for (let i = 0; i < length; i++) {\n    arr[arr.length] = extension[i];\n  }\n}\n\n\n/**\n * @param {Array.<VALUE>} arr The array to modify.\n * @param {VALUE} obj The element to remove.\n * @template VALUE\n * @return {boolean} If the element was removed.\n */\nexport function remove(arr, obj) {\n  const i = arr.indexOf(obj);\n  const found = i > -1;\n  if (found) {\n    arr.splice(i, 1);\n  }\n  return found;\n}\n\n\n/**\n * @param {Array.<VALUE>} arr The array to search in.\n * @param {function(VALUE, number, ?) : boolean} func The function to compare.\n * @template VALUE\n * @return {VALUE|null} The element found or null.\n */\nexport function find(arr, func) {\n  const length = arr.length >>> 0;\n  let value;\n\n  for (let i = 0; i < length; i++) {\n    value = arr[i];\n    if (func(value, i, arr)) {\n      return value;\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {Array|Uint8ClampedArray} arr1 The first array to compare.\n * @param {Array|Uint8ClampedArray} arr2 The second array to compare.\n * @return {boolean} Whether the two arrays are equal.\n */\nexport function equals(arr1, arr2) {\n  const len1 = arr1.length;\n  if (len1 !== arr2.length) {\n    return false;\n  }\n  for (let i = 0; i < len1; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array.<*>} arr The array to sort (modifies original).\n * @param {Function} compareFnc Comparison function.\n */\nexport function stableSort(arr, compareFnc) {\n  const length = arr.length;\n  const tmp = Array(arr.length);\n  let i;\n  for (i = 0; i < length; i++) {\n    tmp[i] = {index: i, value: arr[i]};\n  }\n  tmp.sort(function(a, b) {\n    return compareFnc(a.value, b.value) || a.index - b.index;\n  });\n  for (i = 0; i < arr.length; i++) {\n    arr[i] = tmp[i].value;\n  }\n}\n\n\n/**\n * @param {Array.<*>} arr The array to search in.\n * @param {Function} func Comparison function.\n * @return {number} Return index.\n */\nexport function findIndex(arr, func) {\n  let index;\n  const found = !arr.every(function(el, idx) {\n    index = idx;\n    return !func(el, idx, arr);\n  });\n  return found ? index : -1;\n}\n\n\n/**\n * @param {Array.<*>} arr The array to test.\n * @param {Function=} opt_func Comparison function.\n * @param {boolean=} opt_strict Strictly sorted (default false).\n * @return {boolean} Return index.\n */\nexport function isSorted(arr, opt_func, opt_strict) {\n  const compare = opt_func || numberSafeCompareFunction;\n  return arr.every(function(currentVal, index) {\n    if (index === 0) {\n      return true;\n    }\n    const res = compare(arr[index - 1], currentVal);\n    return !(res > 0 || opt_strict && res === 0);\n  });\n}\n","/**\n * @module ol/asserts\n */\nimport AssertionError from './AssertionError.js';\n\n/**\n * @param {*} assertion Assertion we expected to be truthy.\n * @param {number} errorCode Error code.\n */\nexport function assert(assertion, errorCode) {\n  if (!assertion) {\n    throw new AssertionError(errorCode);\n  }\n}\n","/**\n * @module ol/centerconstraint\n */\nimport {clamp} from './math.js';\n\n\n/**\n * @typedef {function((module:ol/coordinate~Coordinate|undefined)): (module:ol/coordinate~Coordinate|undefined)} Type\n */\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/centerconstraint~Type} The constraint.\n */\nexport function createExtent(extent) {\n  return (\n    /**\n     * @param {module:ol/coordinate~Coordinate=} center Center.\n     * @return {module:ol/coordinate~Coordinate|undefined} Center.\n     */\n    function(center) {\n      if (center) {\n        return [\n          clamp(center[0], extent[0], extent[2]),\n          clamp(center[1], extent[1], extent[3])\n        ];\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate=} center Center.\n * @return {module:ol/coordinate~Coordinate|undefined} Center.\n */\nexport function none(center) {\n  return center;\n}\n","/**\n * @module ol/color\n */\nimport {assert} from './asserts.js';\nimport {clamp} from './math.js';\n\n\n/**\n * A color represented as a short array [red, green, blue, alpha].\n * red, green, and blue should be integers in the range 0..255 inclusive.\n * alpha should be a float in the range 0..1 inclusive. If no alpha value is\n * given then `1` will be used.\n * @typedef {Array.<number>} Color\n * @api\n */\n\n\n/**\n * This RegExp matches # followed by 3, 4, 6, or 8 hex digits.\n * @const\n * @type {RegExp}\n * @private\n */\nconst HEX_COLOR_RE_ = /^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i;\n\n\n/**\n * Regular expression for matching potential named color style strings.\n * @const\n * @type {RegExp}\n * @private\n */\nconst NAMED_COLOR_RE_ = /^([a-z]*)$/i;\n\n\n/**\n * Return the color as an rgba string.\n * @param {module:ol/color~Color|string} color Color.\n * @return {string} Rgba string.\n * @api\n */\nexport function asString(color) {\n  if (typeof color === 'string') {\n    return color;\n  } else {\n    return toString(color);\n  }\n}\n\n/**\n * Return named color as an rgba string.\n * @param {string} color Named color.\n * @return {string} Rgb string.\n */\nfunction fromNamed(color) {\n  const el = document.createElement('div');\n  el.style.color = color;\n  if (el.style.color !== '') {\n    document.body.appendChild(el);\n    const rgb = getComputedStyle(el).color;\n    document.body.removeChild(el);\n    return rgb;\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * @param {string} s String.\n * @return {module:ol/color~Color} Color.\n */\nexport const fromString = (\n  function() {\n\n    // We maintain a small cache of parsed strings.  To provide cheap LRU-like\n    // semantics, whenever the cache grows too large we simply delete an\n    // arbitrary 25% of the entries.\n\n    /**\n     * @const\n     * @type {number}\n     */\n    const MAX_CACHE_SIZE = 1024;\n\n    /**\n     * @type {Object.<string, module:ol/color~Color>}\n     */\n    const cache = {};\n\n    /**\n     * @type {number}\n     */\n    let cacheSize = 0;\n\n    return (\n      /**\n       * @param {string} s String.\n       * @return {module:ol/color~Color} Color.\n       */\n      function(s) {\n        let color;\n        if (cache.hasOwnProperty(s)) {\n          color = cache[s];\n        } else {\n          if (cacheSize >= MAX_CACHE_SIZE) {\n            let i = 0;\n            for (const key in cache) {\n              if ((i++ & 3) === 0) {\n                delete cache[key];\n                --cacheSize;\n              }\n            }\n          }\n          color = fromStringInternal_(s);\n          cache[s] = color;\n          ++cacheSize;\n        }\n        return color;\n      }\n    );\n\n  })();\n\n/**\n * Return the color as an array. This function maintains a cache of calculated\n * arrays which means the result should not be modified.\n * @param {module:ol/color~Color|string} color Color.\n * @return {module:ol/color~Color} Color.\n * @api\n */\nexport function asArray(color) {\n  if (Array.isArray(color)) {\n    return color;\n  } else {\n    return fromString(/** @type {string} */ (color));\n  }\n}\n\n/**\n * @param {string} s String.\n * @private\n * @return {module:ol/color~Color} Color.\n */\nfunction fromStringInternal_(s) {\n  let r, g, b, a, color;\n\n  if (NAMED_COLOR_RE_.exec(s)) {\n    s = fromNamed(s);\n  }\n\n  if (HEX_COLOR_RE_.exec(s)) { // hex\n    const n = s.length - 1; // number of hex digits\n    let d; // number of digits per channel\n    if (n <= 4) {\n      d = 1;\n    } else {\n      d = 2;\n    }\n    const hasAlpha = n === 4 || n === 8;\n    r = parseInt(s.substr(1 + 0 * d, d), 16);\n    g = parseInt(s.substr(1 + 1 * d, d), 16);\n    b = parseInt(s.substr(1 + 2 * d, d), 16);\n    if (hasAlpha) {\n      a = parseInt(s.substr(1 + 3 * d, d), 16);\n    } else {\n      a = 255;\n    }\n    if (d == 1) {\n      r = (r << 4) + r;\n      g = (g << 4) + g;\n      b = (b << 4) + b;\n      if (hasAlpha) {\n        a = (a << 4) + a;\n      }\n    }\n    color = [r, g, b, a / 255];\n  } else if (s.indexOf('rgba(') == 0) { // rgba()\n    color = s.slice(5, -1).split(',').map(Number);\n    normalize(color);\n  } else if (s.indexOf('rgb(') == 0) { // rgb()\n    color = s.slice(4, -1).split(',').map(Number);\n    color.push(1);\n    normalize(color);\n  } else {\n    assert(false, 14); // Invalid color\n  }\n  return (\n    /** @type {module:ol/color~Color} */ (color)\n  );\n}\n\n\n/**\n * TODO this function is only used in the test, we probably shouldn't export it\n * @param {module:ol/color~Color} color Color.\n * @return {module:ol/color~Color} Clamped color.\n */\nexport function normalize(color) {\n  color[0] = clamp((color[0] + 0.5) | 0, 0, 255);\n  color[1] = clamp((color[1] + 0.5) | 0, 0, 255);\n  color[2] = clamp((color[2] + 0.5) | 0, 0, 255);\n  color[3] = clamp(color[3], 0, 1);\n  return color;\n}\n\n\n/**\n * @param {module:ol/color~Color} color Color.\n * @return {string} String.\n */\nexport function toString(color) {\n  let r = color[0];\n  if (r != (r | 0)) {\n    r = (r + 0.5) | 0;\n  }\n  let g = color[1];\n  if (g != (g | 0)) {\n    g = (g + 0.5) | 0;\n  }\n  let b = color[2];\n  if (b != (b | 0)) {\n    b = (b + 0.5) | 0;\n  }\n  const a = color[3] === undefined ? 1 : color[3];\n  return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n}\n","/**\n * @module ol/colorlike\n */\nimport {toString} from './color.js';\n\n\n/**\n * A type accepted by CanvasRenderingContext2D.fillStyle\n * or CanvasRenderingContext2D.strokeStyle.\n * Represents a color, pattern, or gradient. The origin for patterns and\n * gradients as fill style is an increment of 512 css pixels from map coordinate\n * `[0, 0]`. For seamless repeat patterns, width and height of the pattern image\n * must be a factor of two (2, 4, 8, ..., 512).\n *\n * @typedef {string|CanvasPattern|CanvasGradient} ColorLike\n * @api\n */\n\n\n/**\n * @param {module:ol/color~Color|module:ol/colorlike~ColorLike} color Color.\n * @return {module:ol/colorlike~ColorLike} The color as an {@link ol/colorlike~ColorLike}.\n * @api\n */\nexport function asColorLike(color) {\n  if (isColorLike(color)) {\n    return /** @type {string|CanvasPattern|CanvasGradient} */ (color);\n  } else {\n    return toString(/** @type {module:ol/color~Color} */ (color));\n  }\n}\n\n\n/**\n * @param {?} color The value that is potentially an {@link ol/colorlike~ColorLike}.\n * @return {boolean} The color is an {@link ol/colorlike~ColorLike}.\n */\nexport function isColorLike(color) {\n  return (\n    typeof color === 'string' ||\n    color instanceof CanvasPattern ||\n    color instanceof CanvasGradient\n  );\n}\n","/**\n * @module ol/control/Attribution\n */\nimport {inherits} from '../index.js';\nimport {equals} from '../array.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_COLLAPSED} from '../css.js';\nimport {removeChildren, replaceNode} from '../dom.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {visibleAtResolution} from '../layer/Layer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-attribution'] CSS class name.\n * @property {Element|string} [target] Specify a target if you\n * want the control to be rendered outside of the map's\n * viewport.\n * @property {boolean} [collapsible=true] Specify if attributions can\n * be collapsed. If you use an OSM source, should be set to `false`  see\n * {@link https://www.openstreetmap.org/copyright OSM Copyright} \n * @property {boolean} [collapsed=true] Specify if attributions should\n * be collapsed at startup.\n * @property {string} [tipLabel='Attributions'] Text label to use for the button tip.\n * @property {string} [label='i'] Text label to use for the\n * collapsed attributions button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|Element} [collapseLabel=''] Text label to use\n * for the expanded attributions button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {function(module:ol/MapEvent)} [render] Function called when\n * the control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n */\n\n\n/**\n * @classdesc\n * Control to show all the attributions associated with the layer sources\n * in the map. This control is one of the default controls included in maps.\n * By default it will show in the bottom right portion of the map, but this can\n * be changed by using a css selector for `.ol-attribution`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/Attribution~Options=} opt_options Attribution options.\n * @api\n */\nconst Attribution = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.ulElement_ = document.createElement('UL');\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.collapsed_ = options.collapsed !== undefined ? options.collapsed : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.collapsible_ = options.collapsible !== undefined ?\n    options.collapsible : true;\n\n  if (!this.collapsible_) {\n    this.collapsed_ = false;\n  }\n\n  const className = options.className !== undefined ? options.className : 'ol-attribution';\n\n  const tipLabel = options.tipLabel !== undefined ? options.tipLabel : 'Attributions';\n\n  const collapseLabel = options.collapseLabel !== undefined ? options.collapseLabel : '\\u00BB';\n\n  if (typeof collapseLabel === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.collapseLabel_ = document.createElement('span');\n    this.collapseLabel_.textContent = collapseLabel;\n  } else {\n    this.collapseLabel_ = collapseLabel;\n  }\n\n  const label = options.label !== undefined ? options.label : 'i';\n\n  if (typeof label === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.label_ = document.createElement('span');\n    this.label_.textContent = label;\n  } else {\n    this.label_ = label;\n  }\n\n\n  const activeLabel = (this.collapsible_ && !this.collapsed_) ?\n    this.collapseLabel_ : this.label_;\n  const button = document.createElement('button');\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(activeLabel);\n\n  listen(button, EventType.CLICK, this.handleClick_, this);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL +\n      (this.collapsed_ && this.collapsible_ ? ' ' + CLASS_COLLAPSED : '') +\n      (this.collapsible_ ? '' : ' ol-uncollapsible');\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(this.ulElement_);\n  element.appendChild(button);\n\n  Control.call(this, {\n    element: element,\n    render: options.render || render,\n    target: options.target\n  });\n\n  /**\n   * A list of currently rendered resolutions.\n   * @type {Array.<string>}\n   * @private\n   */\n  this.renderedAttributions_ = [];\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = true;\n\n};\n\ninherits(Attribution, Control);\n\n\n/**\n * Get a list of visible attributions.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @return {Array.<string>} Attributions.\n * @private\n */\nAttribution.prototype.getSourceAttributions_ = function(frameState) {\n  /**\n   * Used to determine if an attribution already exists.\n   * @type {!Object.<string, boolean>}\n   */\n  const lookup = {};\n\n  /**\n   * A list of visible attributions.\n   * @type {Array.<string>}\n   */\n  const visibleAttributions = [];\n\n  const layerStatesArray = frameState.layerStatesArray;\n  const resolution = frameState.viewState.resolution;\n  for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n    const layerState = layerStatesArray[i];\n    if (!visibleAtResolution(layerState, resolution)) {\n      continue;\n    }\n\n    const source = layerState.layer.getSource();\n    if (!source) {\n      continue;\n    }\n\n    const attributionGetter = source.getAttributions();\n    if (!attributionGetter) {\n      continue;\n    }\n\n    const attributions = attributionGetter(frameState);\n    if (!attributions) {\n      continue;\n    }\n\n    if (Array.isArray(attributions)) {\n      for (let j = 0, jj = attributions.length; j < jj; ++j) {\n        if (!(attributions[j] in lookup)) {\n          visibleAttributions.push(attributions[j]);\n          lookup[attributions[j]] = true;\n        }\n      }\n    } else {\n      if (!(attributions in lookup)) {\n        visibleAttributions.push(attributions);\n        lookup[attributions] = true;\n      }\n    }\n  }\n  return visibleAttributions;\n};\n\n\n/**\n * Update the attribution element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/Attribution}\n * @api\n */\nexport function render(mapEvent) {\n  this.updateElement_(mapEvent.frameState);\n}\n\n\n/**\n * @private\n * @param {?module:ol/PluggableMap~FrameState} frameState Frame state.\n */\nAttribution.prototype.updateElement_ = function(frameState) {\n  if (!frameState) {\n    if (this.renderedVisible_) {\n      this.element.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return;\n  }\n\n  const attributions = this.getSourceAttributions_(frameState);\n\n  const visible = attributions.length > 0;\n  if (this.renderedVisible_ != visible) {\n    this.element.style.display = visible ? '' : 'none';\n    this.renderedVisible_ = visible;\n  }\n\n  if (equals(attributions, this.renderedAttributions_)) {\n    return;\n  }\n\n  removeChildren(this.ulElement_);\n\n  // append the attributions\n  for (let i = 0, ii = attributions.length; i < ii; ++i) {\n    const element = document.createElement('LI');\n    element.innerHTML = attributions[i];\n    this.ulElement_.appendChild(element);\n  }\n\n  this.renderedAttributions_ = attributions;\n};\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nAttribution.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  this.handleToggle_();\n};\n\n\n/**\n * @private\n */\nAttribution.prototype.handleToggle_ = function() {\n  this.element.classList.toggle(CLASS_COLLAPSED);\n  if (this.collapsed_) {\n    replaceNode(this.collapseLabel_, this.label_);\n  } else {\n    replaceNode(this.label_, this.collapseLabel_);\n  }\n  this.collapsed_ = !this.collapsed_;\n};\n\n\n/**\n * Return `true` if the attribution is collapsible, `false` otherwise.\n * @return {boolean} True if the widget is collapsible.\n * @api\n */\nAttribution.prototype.getCollapsible = function() {\n  return this.collapsible_;\n};\n\n\n/**\n * Set whether the attribution should be collapsible.\n * @param {boolean} collapsible True if the widget is collapsible.\n * @api\n */\nAttribution.prototype.setCollapsible = function(collapsible) {\n  if (this.collapsible_ === collapsible) {\n    return;\n  }\n  this.collapsible_ = collapsible;\n  this.element.classList.toggle('ol-uncollapsible');\n  if (!collapsible && this.collapsed_) {\n    this.handleToggle_();\n  }\n};\n\n\n/**\n * Collapse or expand the attribution according to the passed parameter. Will\n * not do anything if the attribution isn't collapsible or if the current\n * collapsed state is already the one requested.\n * @param {boolean} collapsed True if the widget is collapsed.\n * @api\n */\nAttribution.prototype.setCollapsed = function(collapsed) {\n  if (!this.collapsible_ || this.collapsed_ === collapsed) {\n    return;\n  }\n  this.handleToggle_();\n};\n\n\n/**\n * Return `true` when the attribution is currently collapsed or `false`\n * otherwise.\n * @return {boolean} True if the widget is collapsed.\n * @api\n */\nAttribution.prototype.getCollapsed = function() {\n  return this.collapsed_;\n};\nexport default Attribution;\n","/**\n * @module ol/control/Control\n */\nimport {inherits} from '../index.js';\nimport {UNDEFINED} from '../functions.js';\nimport MapEventType from '../MapEventType.js';\nimport BaseObject from '../Object.js';\nimport {removeNode} from '../dom.js';\nimport {listen, unlistenByKey} from '../events.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Element} [element] The element is the control's\n * container element. This only needs to be specified if you're developing\n * a custom control.\n * @property {function(module:ol/MapEvent)} [render] Function called when\n * the control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n * @property {Element|string} [target] Specify a target if you want\n * the control to be rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A control is a visible widget with a DOM element in a fixed position on the\n * screen. They can involve user input (buttons), or be informational only;\n * the position is determined using CSS. By default these are placed in the\n * container with CSS class name `ol-overlaycontainer-stopevent`, but can use\n * any outside DOM element.\n *\n * This is the base class for controls. You can use it for simple custom\n * controls by creating the element with listeners, creating an instance:\n * ```js\n * var myControl = new Control({element: myElement});\n * ```\n * and then adding this to the map.\n *\n * The main advantage of having this as a control rather than a simple separate\n * DOM element is that preventing propagation is handled for you. Controls\n * will also be objects in a {@link module:ol/Collection~Collection}, so you can use their methods.\n *\n * You can also extend this base for your own control class. See\n * examples/custom-controls for an example of how to do this.\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/control/Control~Options} options Control options.\n * @api\n */\nconst Control = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @protected\n   * @type {Element}\n   */\n  this.element = options.element ? options.element : null;\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.target_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = null;\n\n  /**\n   * @protected\n   * @type {!Array.<module:ol/events~EventsKey>}\n   */\n  this.listenerKeys = [];\n\n  /**\n   * @type {function(module:ol/MapEvent)}\n   */\n  this.render = options.render ? options.render : UNDEFINED;\n\n  if (options.target) {\n    this.setTarget(options.target);\n  }\n\n};\n\ninherits(Control, BaseObject);\n\n\n/**\n * @inheritDoc\n */\nControl.prototype.disposeInternal = function() {\n  removeNode(this.element);\n  BaseObject.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Get the map associated with this control.\n * @return {module:ol/PluggableMap} Map.\n * @api\n */\nControl.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nControl.prototype.setMap = function(map) {\n  if (this.map_) {\n    removeNode(this.element);\n  }\n  for (let i = 0, ii = this.listenerKeys.length; i < ii; ++i) {\n    unlistenByKey(this.listenerKeys[i]);\n  }\n  this.listenerKeys.length = 0;\n  this.map_ = map;\n  if (this.map_) {\n    const target = this.target_ ?\n      this.target_ : map.getOverlayContainerStopEvent();\n    target.appendChild(this.element);\n    if (this.render !== UNDEFINED) {\n      this.listenerKeys.push(listen(map,\n        MapEventType.POSTRENDER, this.render, this));\n    }\n    map.render();\n  }\n};\n\n\n/**\n * This function is used to set a target element for the control. It has no\n * effect if it is called after the control has been added to the map (i.e.\n * after `setMap` is called on the control). If no `target` is set in the\n * options passed to the control constructor and if `setTarget` is not called\n * then the control is added to the map's overlay container.\n * @param {Element|string} target Target.\n * @api\n */\nControl.prototype.setTarget = function(target) {\n  this.target_ = typeof target === 'string' ?\n    document.getElementById(target) :\n    target;\n};\nexport default Control;\n","/**\n * @module ol/control/Rotate\n */\n\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_HIDDEN, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {inherits} from '../index.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-rotate'] CSS class name.\n * @property {string|Element} [label=''] Text label to use for the rotate button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [tipLabel='Reset rotation'] Text label to use for the rotate tip.\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {boolean} [autoHide=true] Hide the control when rotation is 0.\n * @property {function(module:ol/MapEvent)} [render] Function called when the control should\n * be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {function()} [resetNorth] Function called when the control is clicked.\n * This will override the default `resetNorth`.\n * @property {Element|string} [target] Specify a target if you want the control to be\n * rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A button control to reset rotation to 0.\n * To style this control use css selector `.ol-rotate`. A `.ol-hidden` css\n * selector is added to the button when the rotation is 0.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/Rotate~Options=} opt_options Rotate options.\n * @api\n */\nconst Rotate = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const className = options.className !== undefined ? options.className : 'ol-rotate';\n\n  const label = options.label !== undefined ? options.label : '\\u21E7';\n\n  /**\n   * @type {Element}\n   * @private\n   */\n  this.label_ = null;\n\n  if (typeof label === 'string') {\n    this.label_ = document.createElement('span');\n    this.label_.className = 'ol-compass';\n    this.label_.textContent = label;\n  } else {\n    this.label_ = label;\n    this.label_.classList.add('ol-compass');\n  }\n\n  const tipLabel = options.tipLabel ? options.tipLabel : 'Reset rotation';\n\n  const button = document.createElement('button');\n  button.className = className + '-reset';\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(this.label_);\n\n  listen(button, EventType.CLICK,\n    Rotate.prototype.handleClick_, this);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(button);\n\n  this.callResetNorth_ = options.resetNorth ? options.resetNorth : undefined;\n\n  Control.call(this, {\n    element: element,\n    render: options.render || render,\n    target: options.target\n  });\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.autoHide_ = options.autoHide !== undefined ? options.autoHide : true;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = undefined;\n\n  if (this.autoHide_) {\n    this.element.classList.add(CLASS_HIDDEN);\n  }\n\n};\n\ninherits(Rotate, Control);\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nRotate.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  if (this.callResetNorth_ !== undefined) {\n    this.callResetNorth_();\n  } else {\n    this.resetNorth_();\n  }\n};\n\n\n/**\n * @private\n */\nRotate.prototype.resetNorth_ = function() {\n  const map = this.getMap();\n  const view = map.getView();\n  if (!view) {\n    // the map does not have a view, so we can't act\n    // upon it\n    return;\n  }\n  if (view.getRotation() !== undefined) {\n    if (this.duration_ > 0) {\n      view.animate({\n        rotation: 0,\n        duration: this.duration_,\n        easing: easeOut\n      });\n    } else {\n      view.setRotation(0);\n    }\n  }\n};\n\n\n/**\n * Update the rotate control element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/Rotate}\n * @api\n */\nexport function render(mapEvent) {\n  const frameState = mapEvent.frameState;\n  if (!frameState) {\n    return;\n  }\n  const rotation = frameState.viewState.rotation;\n  if (rotation != this.rotation_) {\n    const transform = 'rotate(' + rotation + 'rad)';\n    if (this.autoHide_) {\n      const contains = this.element.classList.contains(CLASS_HIDDEN);\n      if (!contains && rotation === 0) {\n        this.element.classList.add(CLASS_HIDDEN);\n      } else if (contains && rotation !== 0) {\n        this.element.classList.remove(CLASS_HIDDEN);\n      }\n    }\n    this.label_.style.msTransform = transform;\n    this.label_.style.webkitTransform = transform;\n    this.label_.style.transform = transform;\n  }\n  this.rotation_ = rotation;\n}\n\nexport default Rotate;\n","/**\n * @module ol/control/Zoom\n */\nimport {inherits} from '../index.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {string} [className='ol-zoom'] CSS class name.\n * @property {string|Element} [zoomInLabel='+'] Text label to use for the zoom-in\n * button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|Element} [zoomOutLabel='-'] Text label to use for the zoom-out button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [zoomInTipLabel='Zoom in'] Text label to use for the button tip.\n * @property {string} [zoomOutTipLabel='Zoom out'] Text label to use for the button tip.\n * @property {number} [delta=1] The zoom delta applied on each click.\n * @property {Element|string} [target] Specify a target if you want the control to be\n * rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A control with 2 buttons, one for zoom in and one for zoom out.\n * This control is one of the default controls of a map. To style this control\n * use css selectors `.ol-zoom-in` and `.ol-zoom-out`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/Zoom~Options=} opt_options Zoom options.\n * @api\n */\nconst Zoom = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const className = options.className !== undefined ? options.className : 'ol-zoom';\n\n  const delta = options.delta !== undefined ? options.delta : 1;\n\n  const zoomInLabel = options.zoomInLabel !== undefined ? options.zoomInLabel : '+';\n  const zoomOutLabel = options.zoomOutLabel !== undefined ? options.zoomOutLabel : '\\u2212';\n\n  const zoomInTipLabel = options.zoomInTipLabel !== undefined ?\n    options.zoomInTipLabel : 'Zoom in';\n  const zoomOutTipLabel = options.zoomOutTipLabel !== undefined ?\n    options.zoomOutTipLabel : 'Zoom out';\n\n  const inElement = document.createElement('button');\n  inElement.className = className + '-in';\n  inElement.setAttribute('type', 'button');\n  inElement.title = zoomInTipLabel;\n  inElement.appendChild(\n    typeof zoomInLabel === 'string' ? document.createTextNode(zoomInLabel) : zoomInLabel\n  );\n\n  listen(inElement, EventType.CLICK,\n    Zoom.prototype.handleClick_.bind(this, delta));\n\n  const outElement = document.createElement('button');\n  outElement.className = className + '-out';\n  outElement.setAttribute('type', 'button');\n  outElement.title = zoomOutTipLabel;\n  outElement.appendChild(\n    typeof zoomOutLabel === 'string' ? document.createTextNode(zoomOutLabel) : zoomOutLabel\n  );\n\n  listen(outElement, EventType.CLICK,\n    Zoom.prototype.handleClick_.bind(this, -delta));\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(inElement);\n  element.appendChild(outElement);\n\n  Control.call(this, {\n    element: element,\n    target: options.target\n  });\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n};\n\ninherits(Zoom, Control);\n\n\n/**\n * @param {number} delta Zoom delta.\n * @param {Event} event The event to handle\n * @private\n */\nZoom.prototype.handleClick_ = function(delta, event) {\n  event.preventDefault();\n  this.zoomByDelta_(delta);\n};\n\n\n/**\n * @param {number} delta Zoom delta.\n * @private\n */\nZoom.prototype.zoomByDelta_ = function(delta) {\n  const map = this.getMap();\n  const view = map.getView();\n  if (!view) {\n    // the map does not have a view, so we can't act\n    // upon it\n    return;\n  }\n  const currentResolution = view.getResolution();\n  if (currentResolution) {\n    const newResolution = view.constrainResolution(currentResolution, delta);\n    if (this.duration_ > 0) {\n      if (view.getAnimating()) {\n        view.cancelAnimations();\n      }\n      view.animate({\n        resolution: newResolution,\n        duration: this.duration_,\n        easing: easeOut\n      });\n    } else {\n      view.setResolution(newResolution);\n    }\n  }\n};\nexport default Zoom;\n","/**\n * @module ol/control/util\n */\nimport Collection from '../Collection.js';\nimport Attribution from './Attribution.js';\nimport Rotate from './Rotate.js';\nimport Zoom from './Zoom.js';\n\n\n/**\n * @typedef {Object} DefaultsOptions\n * @property {boolean} [attribution=true] Include\n * {@link module:ol/control/Attribution~Attribution}.\n * @property {module:ol/control/Attribution~Options} [attributionOptions]\n * Options for {@link module:ol/control/Attribution~Attribution}.\n * @property {boolean} [rotate=true] Include\n * {@link module:ol/control/Rotate~Rotate}.\n * @property {module:ol/control/Rotate~Options} [rotateOptions] Options\n * for {@link module:ol/control/Rotate~Rotate}.\n * @property {boolean} [zoom] Include {@link module:ol/control/Zoom~Zoom}.\n * @property {module:ol/control/Zoom~Options} [zoomOptions] Options for\n * {@link module:ol/control/Zoom~Zoom}.\n * @api\n */\n\n\n/**\n * Set of controls included in maps by default. Unless configured otherwise,\n * this returns a collection containing an instance of each of the following\n * controls:\n * * {@link module:ol/control/Zoom~Zoom}\n * * {@link module:ol/control/Rotate~Rotate}\n * * {@link module:ol/control/Attribution~Attribution}\n *\n * @param {module:ol/control/util~DefaultsOptions=} opt_options\n * Defaults options.\n * @return {module:ol/Collection.<module:ol/control/Control>}\n * Controls.\n * @function module:ol/control.defaults\n * @api\n */\nexport function defaults(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const controls = new Collection();\n\n  const zoomControl = options.zoom !== undefined ? options.zoom : true;\n  if (zoomControl) {\n    controls.push(new Zoom(options.zoomOptions));\n  }\n\n  const rotateControl = options.rotate !== undefined ? options.rotate : true;\n  if (rotateControl) {\n    controls.push(new Rotate(options.rotateOptions));\n  }\n\n  const attributionControl = options.attribution !== undefined ?\n    options.attribution : true;\n  if (attributionControl) {\n    controls.push(new Attribution(options.attributionOptions));\n  }\n\n  return controls;\n}\n","/**\n * @module ol/coordinate\n */\nimport {modulo} from './math.js';\nimport {padNumber} from './string.js';\n\n\n/**\n * An array of numbers representing an xy coordinate. Example: `[16, 48]`.\n * @typedef {Array.<number>} Coordinate\n * @api\n */\n\n\n/**\n * A function that takes a {@link module:ol/coordinate~Coordinate} and\n * transforms it into a `{string}`.\n *\n * @typedef {function((module:ol/coordinate~Coordinate|undefined)): string} CoordinateFormat\n * @api\n */\n\n\n/**\n * Add `delta` to `coordinate`. `coordinate` is modified in place and returned\n * by the function.\n *\n * Example:\n *\n *     import {add} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     add(coord, [-2, 4]);\n *     // coord is now [5.85, 51.983333]\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/coordinate~Coordinate} delta Delta.\n * @return {module:ol/coordinate~Coordinate} The input coordinate adjusted by\n * the given delta.\n * @api\n */\nexport function add(coordinate, delta) {\n  coordinate[0] += delta[0];\n  coordinate[1] += delta[1];\n  return coordinate;\n}\n\n\n/**\n * Calculates the point closest to the passed coordinate on the passed circle.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate The coordinate.\n * @param {module:ol/geom/Circle} circle The circle.\n * @return {module:ol/coordinate~Coordinate} Closest point on the circumference.\n */\nexport function closestOnCircle(coordinate, circle) {\n  const r = circle.getRadius();\n  const center = circle.getCenter();\n  const x0 = center[0];\n  const y0 = center[1];\n  const x1 = coordinate[0];\n  const y1 = coordinate[1];\n\n  let dx = x1 - x0;\n  const dy = y1 - y0;\n  if (dx === 0 && dy === 0) {\n    dx = 1;\n  }\n  const d = Math.sqrt(dx * dx + dy * dy);\n\n  const x = x0 + r * dx / d;\n  const y = y0 + r * dy / d;\n\n  return [x, y];\n}\n\n\n/**\n * Calculates the point closest to the passed coordinate on the passed segment.\n * This is the foot of the perpendicular of the coordinate to the segment when\n * the foot is on the segment, or the closest segment coordinate when the foot\n * is outside the segment.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate The coordinate.\n * @param {Array.<module:ol/coordinate~Coordinate>} segment The two coordinates\n * of the segment.\n * @return {module:ol/coordinate~Coordinate} The foot of the perpendicular of\n * the coordinate to the segment.\n */\nexport function closestOnSegment(coordinate, segment) {\n  const x0 = coordinate[0];\n  const y0 = coordinate[1];\n  const start = segment[0];\n  const end = segment[1];\n  const x1 = start[0];\n  const y1 = start[1];\n  const x2 = end[0];\n  const y2 = end[1];\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  const along = (dx === 0 && dy === 0) ? 0 :\n    ((dx * (x0 - x1)) + (dy * (y0 - y1))) / ((dx * dx + dy * dy) || 0);\n  let x, y;\n  if (along <= 0) {\n    x = x1;\n    y = y1;\n  } else if (along >= 1) {\n    x = x2;\n    y = y2;\n  } else {\n    x = x1 + along * dx;\n    y = y1 + along * dy;\n  }\n  return [x, y];\n}\n\n\n/**\n * Returns a {@link module:ol/coordinate~CoordinateFormat} function that can be\n * used to format\n * a {module:ol/coordinate~Coordinate} to a string.\n *\n * Example without specifying the fractional digits:\n *\n *     import {createStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var stringifyFunc = createStringXY();\n *     var out = stringifyFunc(coord);\n *     // out is now '8, 48'\n *\n * Example with explicitly specifying 2 fractional digits:\n *\n *     import {createStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var stringifyFunc = createStringXY(2);\n *     var out = stringifyFunc(coord);\n *     // out is now '7.85, 47.98'\n *\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {module:ol/coordinate~CoordinateFormat} Coordinate format.\n * @api\n */\nexport function createStringXY(opt_fractionDigits) {\n  return (\n    /**\n     * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n     * @return {string} String XY.\n     */\n    function(coordinate) {\n      return toStringXY(coordinate, opt_fractionDigits);\n    }\n  );\n}\n\n\n/**\n * @param {string} hemispheres Hemispheres.\n * @param {number} degrees Degrees.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} String.\n */\nexport function degreesToStringHDMS(hemispheres, degrees, opt_fractionDigits) {\n  const normalizedDegrees = modulo(degrees + 180, 360) - 180;\n  const x = Math.abs(3600 * normalizedDegrees);\n  const dflPrecision = opt_fractionDigits || 0;\n  const precision = Math.pow(10, dflPrecision);\n\n  let deg = Math.floor(x / 3600);\n  let min = Math.floor((x - deg * 3600) / 60);\n  let sec = x - (deg * 3600) - (min * 60);\n  sec = Math.ceil(sec * precision) / precision;\n\n  if (sec >= 60) {\n    sec = 0;\n    min += 1;\n  }\n\n  if (min >= 60) {\n    min = 0;\n    deg += 1;\n  }\n\n  return deg + '\\u00b0 ' + padNumber(min, 2) + '\\u2032 ' +\n    padNumber(sec, 2, dflPrecision) + '\\u2033' +\n    (normalizedDegrees == 0 ? '' : ' ' + hemispheres.charAt(normalizedDegrees < 0 ? 1 : 0));\n}\n\n\n/**\n * Transforms the given {@link module:ol/coordinate~Coordinate} to a string\n * using the given string template. The strings `{x}` and `{y}` in the template\n * will be replaced with the first and second coordinate values respectively.\n *\n * Example without specifying the fractional digits:\n *\n *     import {format} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var template = 'Coordinate is ({x}|{y}).';\n *     var out = format(coord, template);\n *     // out is now 'Coordinate is (8|48).'\n *\n * Example explicitly specifying the fractional digits:\n *\n *     import {format} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var template = 'Coordinate is ({x}|{y}).';\n *     var out = format(coord, template, 2);\n *     // out is now 'Coordinate is (7.85|47.98).'\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {string} template A template string with `{x}` and `{y}` placeholders\n *     that will be replaced by first and second coordinate values.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} Formatted coordinate.\n * @api\n */\nexport function format(coordinate, template, opt_fractionDigits) {\n  if (coordinate) {\n    return template\n      .replace('{x}', coordinate[0].toFixed(opt_fractionDigits))\n      .replace('{y}', coordinate[1].toFixed(opt_fractionDigits));\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate1 First coordinate.\n * @param {module:ol/coordinate~Coordinate} coordinate2 Second coordinate.\n * @return {boolean} The two coordinates are equal.\n */\nexport function equals(coordinate1, coordinate2) {\n  let equals = true;\n  for (let i = coordinate1.length - 1; i >= 0; --i) {\n    if (coordinate1[i] != coordinate2[i]) {\n      equals = false;\n      break;\n    }\n  }\n  return equals;\n}\n\n\n/**\n * Rotate `coordinate` by `angle`. `coordinate` is modified in place and\n * returned by the function.\n *\n * Example:\n *\n *     import {rotate} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var rotateRadians = Math.PI / 2; // 90 degrees\n *     rotate(coord, rotateRadians);\n *     // coord is now [-47.983333, 7.85]\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} angle Angle in radian.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nexport function rotate(coordinate, angle) {\n  const cosAngle = Math.cos(angle);\n  const sinAngle = Math.sin(angle);\n  const x = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n  const y = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n  coordinate[0] = x;\n  coordinate[1] = y;\n  return coordinate;\n}\n\n\n/**\n * Scale `coordinate` by `scale`. `coordinate` is modified in place and returned\n * by the function.\n *\n * Example:\n *\n *     import {scale as scaleCoordinate} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var scale = 1.2;\n *     scaleCoordinate(coord, scale);\n *     // coord is now [9.42, 57.5799996]\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} scale Scale factor.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n */\nexport function scale(coordinate, scale) {\n  coordinate[0] *= scale;\n  coordinate[1] *= scale;\n  return coordinate;\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coord1 First coordinate.\n * @param {module:ol/coordinate~Coordinate} coord2 Second coordinate.\n * @return {number} Squared distance between coord1 and coord2.\n */\nexport function squaredDistance(coord1, coord2) {\n  const dx = coord1[0] - coord2[0];\n  const dy = coord1[1] - coord2[1];\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coord1 First coordinate.\n * @param {module:ol/coordinate~Coordinate} coord2 Second coordinate.\n * @return {number} Distance between coord1 and coord2.\n */\nexport function distance(coord1, coord2) {\n  return Math.sqrt(squaredDistance(coord1, coord2));\n}\n\n\n/**\n * Calculate the squared distance from a coordinate to a line segment.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate of the point.\n * @param {Array.<module:ol/coordinate~Coordinate>} segment Line segment (2\n * coordinates).\n * @return {number} Squared distance from the point to the line segment.\n */\nexport function squaredDistanceToSegment(coordinate, segment) {\n  return squaredDistance(coordinate,\n    closestOnSegment(coordinate, segment));\n}\n\n\n/**\n * Format a geographic coordinate with the hemisphere, degrees, minutes, and\n * seconds.\n *\n * Example without specifying fractional digits:\n *\n *     import {toStringHDMS} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringHDMS(coord);\n *     // out is now '47 58 60 N 7 50 60 E'\n *\n * Example explicitly specifying 1 fractional digit:\n *\n *     import {toStringHDMS} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringHDMS(coord, 1);\n *     // out is now '47 58 60.0 N 7 50 60.0 E'\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} Hemisphere, degrees, minutes and seconds.\n * @api\n */\nexport function toStringHDMS(coordinate, opt_fractionDigits) {\n  if (coordinate) {\n    return degreesToStringHDMS('NS', coordinate[1], opt_fractionDigits) + ' ' +\n        degreesToStringHDMS('EW', coordinate[0], opt_fractionDigits);\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * Format a coordinate as a comma delimited string.\n *\n * Example without specifying fractional digits:\n *\n *     import {toStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringXY(coord);\n *     // out is now '8, 48'\n *\n * Example explicitly specifying 1 fractional digit:\n *\n *     import {toStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringXY(coord, 1);\n *     // out is now '7.8, 48.0'\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} XY.\n * @api\n */\nexport function toStringXY(coordinate, opt_fractionDigits) {\n  return format(coordinate, '{x}, {y}', opt_fractionDigits);\n}\n","/**\n * @module ol/css\n */\n\n\n/**\n * The CSS class for hidden feature.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_HIDDEN = 'ol-hidden';\n\n\n/**\n * The CSS class that we'll give the DOM elements to have them selectable.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_SELECTABLE = 'ol-selectable';\n\n\n/**\n * The CSS class that we'll give the DOM elements to have them unselectable.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_UNSELECTABLE = 'ol-unselectable';\n\n\n/**\n * The CSS class for unsupported feature.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_UNSUPPORTED = 'ol-unsupported';\n\n\n/**\n * The CSS class for controls.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_CONTROL = 'ol-control';\n\n\n/**\n * The CSS class that we'll give the DOM elements that are collapsed, i.e.\n * to those elements which usually can be expanded.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_COLLAPSED = 'ol-collapsed';\n\n\n/**\n * Get the list of font families from a font spec.  Note that this doesn't work\n * for font families that have commas in them.\n * @param {string} The CSS font property.\n * @return {Object.<string>} The font families (or null if the input spec is invalid).\n */\nexport const getFontFamilies = (function() {\n  let style;\n  const cache = {};\n  return function(font) {\n    if (!style) {\n      style = document.createElement('div').style;\n    }\n    if (!(font in cache)) {\n      style.font = font;\n      const family = style.fontFamily;\n      style.font = '';\n      if (!family) {\n        return null;\n      }\n      cache[font] = family.split(/,\\s?/);\n    }\n    return cache[font];\n  };\n})();\n","/**\n * @module ol/dom\n */\n\n\n/**\n * Create an html canvas element and returns its 2d context.\n * @param {number=} opt_width Canvas width.\n * @param {number=} opt_height Canvas height.\n * @return {CanvasRenderingContext2D} The context.\n */\nexport function createCanvasContext2D(opt_width, opt_height) {\n  const canvas = /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS'));\n  if (opt_width) {\n    canvas.width = opt_width;\n  }\n  if (opt_height) {\n    canvas.height = opt_height;\n  }\n  return /** @type {CanvasRenderingContext2D} */ (canvas.getContext('2d'));\n}\n\n\n/**\n * Get the current computed width for the given element including margin,\n * padding and border.\n * Equivalent to jQuery's `$(el).outerWidth(true)`.\n * @param {!Element} element Element.\n * @return {number} The width.\n */\nexport function outerWidth(element) {\n  let width = element.offsetWidth;\n  const style = getComputedStyle(element);\n  width += parseInt(style.marginLeft, 10) + parseInt(style.marginRight, 10);\n\n  return width;\n}\n\n\n/**\n * Get the current computed height for the given element including margin,\n * padding and border.\n * Equivalent to jQuery's `$(el).outerHeight(true)`.\n * @param {!Element} element Element.\n * @return {number} The height.\n */\nexport function outerHeight(element) {\n  let height = element.offsetHeight;\n  const style = getComputedStyle(element);\n  height += parseInt(style.marginTop, 10) + parseInt(style.marginBottom, 10);\n\n  return height;\n}\n\n/**\n * @param {Node} newNode Node to replace old node\n * @param {Node} oldNode The node to be replaced\n */\nexport function replaceNode(newNode, oldNode) {\n  const parent = oldNode.parentNode;\n  if (parent) {\n    parent.replaceChild(newNode, oldNode);\n  }\n}\n\n/**\n * @param {Node} node The node to remove.\n * @returns {Node} The node that was removed or null.\n */\nexport function removeNode(node) {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n}\n\n/**\n * @param {Node} node The node to remove the children from.\n */\nexport function removeChildren(node) {\n  while (node.lastChild) {\n    node.removeChild(node.lastChild);\n  }\n}\n","/**\n * @module ol/easing\n */\n\n\n/**\n * Start slow and speed up.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function easeIn(t) {\n  return Math.pow(t, 3);\n}\n\n\n/**\n * Start fast and slow down.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function easeOut(t) {\n  return 1 - easeIn(1 - t);\n}\n\n\n/**\n * Start slow, speed up, and then slow down again.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function inAndOut(t) {\n  return 3 * t * t - 2 * t * t * t;\n}\n\n\n/**\n * Maintain a constant speed over time.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function linear(t) {\n  return t;\n}\n\n\n/**\n * Start slow, speed up, and at the very end slow down again.  This has the\n * same general behavior as {@link module:ol/easing~inAndOut}, but the final\n * slowdown is delayed.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function upAndDown(t) {\n  if (t < 0.5) {\n    return inAndOut(2 * t);\n  } else {\n    return 1 - inAndOut(2 * (t - 0.5));\n  }\n}\n","/**\n * @module ol/events\n */\nimport {clear} from './obj.js';\n\n\n/**\n * Key to use with {@link module:ol/Observable~Observable#unByKey}.\n * @typedef {Object} EventsKey\n * @property {Object} [bindTo]\n * @property {module:ol/events~ListenerFunction} [boundListener]\n * @property {boolean} callOnce\n * @property {number} [deleteIndex]\n * @property {module:ol/events~ListenerFunction} listener\n * @property {EventTarget|module:ol/events/EventTarget} target\n * @property {string} type\n * @api\n */\n\n\n/**\n * Listener function. This function is called with an event object as argument.\n * When the function returns `false`, event propagation will stop.\n *\n * @typedef {function(module:ol/events/Event)|function(module:ol/events/Event): boolean} ListenerFunction\n * @api\n */\n\n\n/**\n * @param {module:ol/events~EventsKey} listenerObj Listener object.\n * @return {module:ol/events~ListenerFunction} Bound listener.\n */\nexport function bindListener(listenerObj) {\n  const boundListener = function(evt) {\n    const listener = listenerObj.listener;\n    const bindTo = listenerObj.bindTo || listenerObj.target;\n    if (listenerObj.callOnce) {\n      unlistenByKey(listenerObj);\n    }\n    return listener.call(bindTo, evt);\n  };\n  listenerObj.boundListener = boundListener;\n  return boundListener;\n}\n\n\n/**\n * Finds the matching {@link module:ol/events~EventsKey} in the given listener\n * array.\n *\n * @param {!Array<!module:ol/events~EventsKey>} listeners Array of listeners.\n * @param {!Function} listener The listener function.\n * @param {Object=} opt_this The `this` value inside the listener.\n * @param {boolean=} opt_setDeleteIndex Set the deleteIndex on the matching\n *     listener, for {@link module:ol/events~unlistenByKey}.\n * @return {module:ol/events~EventsKey|undefined} The matching listener object.\n */\nexport function findListener(listeners, listener, opt_this, opt_setDeleteIndex) {\n  let listenerObj;\n  for (let i = 0, ii = listeners.length; i < ii; ++i) {\n    listenerObj = listeners[i];\n    if (listenerObj.listener === listener &&\n        listenerObj.bindTo === opt_this) {\n      if (opt_setDeleteIndex) {\n        listenerObj.deleteIndex = i;\n      }\n      return listenerObj;\n    }\n  }\n  return undefined;\n}\n\n\n/**\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n * @param {string} type Type.\n * @return {Array.<module:ol/events~EventsKey>|undefined} Listeners.\n */\nexport function getListeners(target, type) {\n  const listenerMap = target.ol_lm;\n  return listenerMap ? listenerMap[type] : undefined;\n}\n\n\n/**\n * Get the lookup of listeners.  If one does not exist on the target, it is\n * created.\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n * @return {!Object.<string, Array.<module:ol/events~EventsKey>>} Map of\n *     listeners by event type.\n */\nfunction getListenerMap(target) {\n  let listenerMap = target.ol_lm;\n  if (!listenerMap) {\n    listenerMap = target.ol_lm = {};\n  }\n  return listenerMap;\n}\n\n\n/**\n * Clean up all listener objects of the given type.  All properties on the\n * listener objects will be removed, and if no listeners remain in the listener\n * map, it will be removed from the target.\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n * @param {string} type Type.\n */\nfunction removeListeners(target, type) {\n  const listeners = getListeners(target, type);\n  if (listeners) {\n    for (let i = 0, ii = listeners.length; i < ii; ++i) {\n      target.removeEventListener(type, listeners[i].boundListener);\n      clear(listeners[i]);\n    }\n    listeners.length = 0;\n    const listenerMap = target.ol_lm;\n    if (listenerMap) {\n      delete listenerMap[type];\n      if (Object.keys(listenerMap).length === 0) {\n        delete target.ol_lm;\n      }\n    }\n  }\n}\n\n\n/**\n * Registers an event listener on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * This function efficiently binds a `listener` to a `this` object, and returns\n * a key for use with {@link module:ol/events~unlistenByKey}.\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n * @param {boolean=} opt_once If true, add the listener as one-off listener.\n * @return {module:ol/events~EventsKey} Unique key for the listener.\n */\nexport function listen(target, type, listener, opt_this, opt_once) {\n  const listenerMap = getListenerMap(target);\n  let listeners = listenerMap[type];\n  if (!listeners) {\n    listeners = listenerMap[type] = [];\n  }\n  let listenerObj = findListener(listeners, listener, opt_this, false);\n  if (listenerObj) {\n    if (!opt_once) {\n      // Turn one-off listener into a permanent one.\n      listenerObj.callOnce = false;\n    }\n  } else {\n    listenerObj = /** @type {module:ol/events~EventsKey} */ ({\n      bindTo: opt_this,\n      callOnce: !!opt_once,\n      listener: listener,\n      target: target,\n      type: type\n    });\n    target.addEventListener(type, bindListener(listenerObj));\n    listeners.push(listenerObj);\n  }\n\n  return listenerObj;\n}\n\n\n/**\n * Registers a one-off event listener on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * This function efficiently binds a `listener` as self-unregistering listener\n * to a `this` object, and returns a key for use with\n * {@link module:ol/events~unlistenByKey} in case the listener needs to be\n * unregistered before it is called.\n *\n * When {@link module:ol/events~listen} is called with the same arguments after this\n * function, the self-unregistering listener will be turned into a permanent\n * listener.\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n * @return {module:ol/events~EventsKey} Key for unlistenByKey.\n */\nexport function listenOnce(target, type, listener, opt_this) {\n  return listen(target, type, listener, opt_this, true);\n}\n\n\n/**\n * Unregisters an event listener on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * To return a listener, this function needs to be called with the exact same\n * arguments that were used for a previous {@link module:ol/events~listen} call.\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n */\nexport function unlisten(target, type, listener, opt_this) {\n  const listeners = getListeners(target, type);\n  if (listeners) {\n    const listenerObj = findListener(listeners, listener, opt_this, true);\n    if (listenerObj) {\n      unlistenByKey(listenerObj);\n    }\n  }\n}\n\n\n/**\n * Unregisters event listeners on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * The argument passed to this function is the key returned from\n * {@link module:ol/events~listen} or {@link module:ol/events~listenOnce}.\n *\n * @param {module:ol/events~EventsKey} key The key.\n */\nexport function unlistenByKey(key) {\n  if (key && key.target) {\n    key.target.removeEventListener(key.type, key.boundListener);\n    const listeners = getListeners(key.target, key.type);\n    if (listeners) {\n      const i = 'deleteIndex' in key ? key.deleteIndex : listeners.indexOf(key);\n      if (i !== -1) {\n        listeners.splice(i, 1);\n      }\n      if (listeners.length === 0) {\n        removeListeners(key.target, key.type);\n      }\n    }\n    clear(key);\n  }\n}\n\n\n/**\n * Unregisters all event listeners on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n */\nexport function unlistenAll(target) {\n  const listenerMap = getListenerMap(target);\n  for (const type in listenerMap) {\n    removeListeners(target, type);\n  }\n}\n","/**\n * @module ol/events/Event\n */\n/**\n * @classdesc\n * Stripped down implementation of the W3C DOM Level 2 Event interface.\n * @see {@link https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface}\n *\n * This implementation only provides `type` and `target` properties, and\n * `stopPropagation` and `preventDefault` methods. It is meant as base class\n * for higher level events defined in the library, and works with\n * {@link module:ol/events/EventTarget~EventTarget}.\n *\n * @constructor\n * @param {string} type Type.\n */\nconst Event = function(type) {\n\n  /**\n   * @type {boolean}\n   */\n  this.propagationStopped;\n\n  /**\n   * The event type.\n   * @type {string}\n   * @api\n   */\n  this.type = type;\n\n  /**\n   * The event target.\n   * @type {Object}\n   * @api\n   */\n  this.target = null;\n\n};\n\n\n/**\n * Stop event propagation.\n * @function\n * @api\n */\nEvent.prototype.preventDefault =\n\n  /**\n   * Stop event propagation.\n   * @function\n   * @api\n   */\n  Event.prototype.stopPropagation = function() {\n    this.propagationStopped = true;\n  };\n\n\n/**\n * @param {Event|module:ol/events/Event} evt Event\n */\nexport function stopPropagation(evt) {\n  evt.stopPropagation();\n}\n\n\n/**\n * @param {Event|module:ol/events/Event} evt Event\n */\nexport function preventDefault(evt) {\n  evt.preventDefault();\n}\n\nexport default Event;\n","/**\n * @module ol/events/EventTarget\n */\nimport {inherits} from '../index.js';\nimport Disposable from '../Disposable.js';\nimport {unlistenAll} from '../events.js';\nimport {UNDEFINED} from '../functions.js';\nimport Event from '../events/Event.js';\n\n\n/**\n * @typedef {EventTarget|module:ol/events/EventTarget} EventTargetLike\n */\n\n\n/**\n * @classdesc\n * A simplified implementation of the W3C DOM Level 2 EventTarget interface.\n * @see {@link https://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-EventTarget}\n *\n * There are two important simplifications compared to the specification:\n *\n * 1. The handling of `useCapture` in `addEventListener` and\n *    `removeEventListener`. There is no real capture model.\n * 2. The handling of `stopPropagation` and `preventDefault` on `dispatchEvent`.\n *    There is no event target hierarchy. When a listener calls\n *    `stopPropagation` or `preventDefault` on an event object, it means that no\n *    more listeners after this one will be called. Same as when the listener\n *    returns false.\n *\n * @constructor\n * @extends {module:ol/Disposable}\n */\nconst EventTarget = function() {\n\n  Disposable.call(this);\n\n  /**\n   * @private\n   * @type {!Object.<string, number>}\n   */\n  this.pendingRemovals_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, number>}\n   */\n  this.dispatching_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, Array.<module:ol/events~ListenerFunction>>}\n   */\n  this.listeners_ = {};\n\n};\n\ninherits(EventTarget, Disposable);\n\n\n/**\n * @param {string} type Type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n */\nEventTarget.prototype.addEventListener = function(type, listener) {\n  let listeners = this.listeners_[type];\n  if (!listeners) {\n    listeners = this.listeners_[type] = [];\n  }\n  if (listeners.indexOf(listener) === -1) {\n    listeners.push(listener);\n  }\n};\n\n\n/**\n * @param {{type: string,\n *     target: (EventTarget|module:ol/events/EventTarget|undefined)}|module:ol/events/Event|\n *     string} event Event or event type.\n * @return {boolean|undefined} `false` if anyone called preventDefault on the\n *     event object or if any of the listeners returned false.\n */\nEventTarget.prototype.dispatchEvent = function(event) {\n  const evt = typeof event === 'string' ? new Event(event) : event;\n  const type = evt.type;\n  evt.target = this;\n  const listeners = this.listeners_[type];\n  let propagate;\n  if (listeners) {\n    if (!(type in this.dispatching_)) {\n      this.dispatching_[type] = 0;\n      this.pendingRemovals_[type] = 0;\n    }\n    ++this.dispatching_[type];\n    for (let i = 0, ii = listeners.length; i < ii; ++i) {\n      if (listeners[i].call(this, evt) === false || evt.propagationStopped) {\n        propagate = false;\n        break;\n      }\n    }\n    --this.dispatching_[type];\n    if (this.dispatching_[type] === 0) {\n      let pendingRemovals = this.pendingRemovals_[type];\n      delete this.pendingRemovals_[type];\n      while (pendingRemovals--) {\n        this.removeEventListener(type, UNDEFINED);\n      }\n      delete this.dispatching_[type];\n    }\n    return propagate;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nEventTarget.prototype.disposeInternal = function() {\n  unlistenAll(this);\n};\n\n\n/**\n * Get the listeners for a specified event type. Listeners are returned in the\n * order that they will be called in.\n *\n * @param {string} type Type.\n * @return {Array.<module:ol/events~ListenerFunction>} Listeners.\n */\nEventTarget.prototype.getListeners = function(type) {\n  return this.listeners_[type];\n};\n\n\n/**\n * @param {string=} opt_type Type. If not provided,\n *     `true` will be returned if this EventTarget has any listeners.\n * @return {boolean} Has listeners.\n */\nEventTarget.prototype.hasListener = function(opt_type) {\n  return opt_type ?\n    opt_type in this.listeners_ :\n    Object.keys(this.listeners_).length > 0;\n};\n\n\n/**\n * @param {string} type Type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n */\nEventTarget.prototype.removeEventListener = function(type, listener) {\n  const listeners = this.listeners_[type];\n  if (listeners) {\n    const index = listeners.indexOf(listener);\n    if (type in this.pendingRemovals_) {\n      // make listener a no-op, and remove later in #dispatchEvent()\n      listeners[index] = UNDEFINED;\n      ++this.pendingRemovals_[type];\n    } else {\n      listeners.splice(index, 1);\n      if (listeners.length === 0) {\n        delete this.listeners_[type];\n      }\n    }\n  }\n};\nexport default EventTarget;\n","/**\n * @module ol/events/EventType\n */\n\n/**\n * @enum {string}\n * @const\n */\nexport default {\n  /**\n   * Generic change event. Triggered when the revision counter is increased.\n   * @event module:ol/events/Event~Event#change\n   * @api\n   */\n  CHANGE: 'change',\n\n  CLEAR: 'clear',\n  CONTEXTMENU: 'contextmenu',\n  CLICK: 'click',\n  DBLCLICK: 'dblclick',\n  DRAGENTER: 'dragenter',\n  DRAGOVER: 'dragover',\n  DROP: 'drop',\n  ERROR: 'error',\n  KEYDOWN: 'keydown',\n  KEYPRESS: 'keypress',\n  LOAD: 'load',\n  MOUSEDOWN: 'mousedown',\n  MOUSEMOVE: 'mousemove',\n  MOUSEOUT: 'mouseout',\n  MOUSEUP: 'mouseup',\n  MOUSEWHEEL: 'mousewheel',\n  MSPOINTERDOWN: 'MSPointerDown',\n  RESIZE: 'resize',\n  TOUCHSTART: 'touchstart',\n  TOUCHMOVE: 'touchmove',\n  TOUCHEND: 'touchend',\n  WHEEL: 'wheel'\n};\n","/**\n * @module ol/events/KeyCode\n */\n\n/**\n * @enum {number}\n * @const\n */\nexport default {\n  LEFT: 37,\n  UP: 38,\n  RIGHT: 39,\n  DOWN: 40\n};\n","/**\n * @module ol/events/condition\n */\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport {assert} from '../asserts.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport {WEBKIT, MAC} from '../has.js';\n\n\n/**\n * A function that takes an {@link module:ol/MapBrowserEvent} and returns a\n * `{boolean}`. If the condition is met, true should be returned.\n *\n * @typedef {function(this: ?, module:ol/MapBrowserEvent): boolean} Condition\n */\n\n\n/**\n * Return `true` if only the alt-key is pressed, `false` otherwise (e.g. when\n * additionally the shift-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the alt key is pressed.\n * @api\n */\nexport const altKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      !originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if only the alt-key and shift-key is pressed, `false` otherwise\n * (e.g. when additionally the platform-modifier-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the alt and shift keys are pressed.\n * @api\n */\nexport const altShiftKeysOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if the map has the focus. This condition requires a map target\n * element with a `tabindex` attribute, e.g. `<div id=\"map\" tabindex=\"1\">`.\n *\n * @param {module:ol/MapBrowserEvent} event Map browser event.\n * @return {boolean} The map has the focus.\n * @api\n */\nexport const focus = function(event) {\n  return event.target.getTargetElement() === document.activeElement;\n};\n\n\n/**\n * Return always true.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True.\n * @function\n * @api\n */\nexport const always = TRUE;\n\n\n/**\n * Return `true` if the event is a `click` event, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `click` event.\n * @api\n */\nexport const click = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.CLICK;\n};\n\n\n/**\n * Return `true` if the event has an \"action\"-producing mouse button.\n *\n * By definition, this includes left-click on windows/linux, and left-click\n * without the ctrl key on Macs.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} The result.\n */\nexport const mouseActionButton = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return originalEvent.button == 0 &&\n      !(WEBKIT && MAC && originalEvent.ctrlKey);\n};\n\n\n/**\n * Return always false.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} False.\n * @function\n * @api\n */\nexport const never = FALSE;\n\n\n/**\n * Return `true` if the browser event is a `pointermove` event, `false`\n * otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the browser event is a `pointermove` event.\n * @api\n */\nexport const pointerMove = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == 'pointermove';\n};\n\n\n/**\n * Return `true` if the event is a map `singleclick` event, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `singleclick` event.\n * @api\n */\nexport const singleClick = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.SINGLECLICK;\n};\n\n\n/**\n * Return `true` if the event is a map `dblclick` event, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `dblclick` event.\n * @api\n */\nexport const doubleClick = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.DBLCLICK;\n};\n\n\n/**\n * Return `true` if no modifier key (alt-, shift- or platform-modifier-key) is\n * pressed.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True only if there no modifier keys are pressed.\n * @api\n */\nexport const noModifierKeys = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    !originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      !originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if only the platform-modifier-key (the meta-key on Mac,\n * ctrl-key otherwise) is pressed, `false` otherwise (e.g. when additionally\n * the shift-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the platform modifier key is pressed.\n * @api\n */\nexport const platformModifierKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return !originalEvent.altKey &&\n    (MAC ? originalEvent.metaKey : originalEvent.ctrlKey) &&\n    !originalEvent.shiftKey;\n};\n\n\n/**\n * Return `true` if only the shift-key is pressed, `false` otherwise (e.g. when\n * additionally the alt-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the shift key is pressed.\n * @api\n */\nexport const shiftKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    !originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if the target element is not editable, i.e. not a `<input>`-,\n * `<select>`- or `<textarea>`-element, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True only if the target element is not editable.\n * @api\n */\nexport const targetNotEditable = function(mapBrowserEvent) {\n  const target = mapBrowserEvent.originalEvent.target;\n  const tagName = target.tagName;\n  return (\n    tagName !== 'INPUT' &&\n      tagName !== 'SELECT' &&\n      tagName !== 'TEXTAREA');\n};\n\n\n/**\n * Return `true` if the event originates from a mouse device.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a mouse device.\n * @api\n */\nexport const mouseOnly = function(mapBrowserEvent) {\n  assert(mapBrowserEvent.pointerEvent, 56); // mapBrowserEvent must originate from a pointer event\n  // see http://www.w3.org/TR/pointerevents/#widl-PointerEvent-pointerType\n  return (\n    /** @type {module:ol/MapBrowserEvent} */ (mapBrowserEvent).pointerEvent.pointerType == 'mouse'\n  );\n};\n\n\n/**\n * Return `true` if the event originates from a primary pointer in\n * contact with the surface or if the left mouse button is pressed.\n * @see http://www.w3.org/TR/pointerevents/#button-states\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a primary pointer.\n * @api\n */\nexport const primaryAction = function(mapBrowserEvent) {\n  const pointerEvent = mapBrowserEvent.pointerEvent;\n  return pointerEvent.isPrimary && pointerEvent.button === 0;\n};\n","/**\n * @module ol/extent\n */\nimport {assert} from './asserts.js';\nimport Corner from './extent/Corner.js';\nimport Relationship from './extent/Relationship.js';\n\n\n/**\n * An array of numbers representing an extent: `[minx, miny, maxx, maxy]`.\n * @typedef {Array.<number>} Extent\n * @api\n */\n\n/**\n * Build an extent that includes all given coordinates.\n *\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @return {module:ol/extent~Extent} Bounding extent.\n * @api\n */\nexport function boundingExtent(coordinates) {\n  const extent = createEmpty();\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {Array.<number>} xs Xs.\n * @param {Array.<number>} ys Ys.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @private\n * @return {module:ol/extent~Extent} Extent.\n */\nfunction _boundingExtentXYs(xs, ys, opt_extent) {\n  const minX = Math.min.apply(null, xs);\n  const minY = Math.min.apply(null, ys);\n  const maxX = Math.max.apply(null, xs);\n  const maxY = Math.max.apply(null, ys);\n  return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n}\n\n\n/**\n * Return extent increased by the provided value.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} value The amount by which the extent should be buffered.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nexport function buffer(extent, value, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0] - value;\n    opt_extent[1] = extent[1] - value;\n    opt_extent[2] = extent[2] + value;\n    opt_extent[3] = extent[3] + value;\n    return opt_extent;\n  } else {\n    return [\n      extent[0] - value,\n      extent[1] - value,\n      extent[2] + value,\n      extent[3] + value\n    ];\n  }\n}\n\n\n/**\n * Creates a clone of an extent.\n *\n * @param {module:ol/extent~Extent} extent Extent to clone.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} The clone.\n */\nexport function clone(extent, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0];\n    opt_extent[1] = extent[1];\n    opt_extent[2] = extent[2];\n    opt_extent[3] = extent[3];\n    return opt_extent;\n  } else {\n    return extent.slice();\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {number} Closest squared distance.\n */\nexport function closestSquaredDistanceXY(extent, x, y) {\n  let dx, dy;\n  if (x < extent[0]) {\n    dx = extent[0] - x;\n  } else if (extent[2] < x) {\n    dx = x - extent[2];\n  } else {\n    dx = 0;\n  }\n  if (y < extent[1]) {\n    dy = extent[1] - y;\n  } else if (extent[3] < y) {\n    dy = y - extent[3];\n  } else {\n    dy = 0;\n  }\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {boolean} The coordinate is contained in the extent.\n * @api\n */\nexport function containsCoordinate(extent, coordinate) {\n  return containsXY(extent, coordinate[0], coordinate[1]);\n}\n\n\n/**\n * Check if one extent contains another.\n *\n * An extent is deemed contained if it lies completely within the other extent,\n * including if they share one or more edges.\n *\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {boolean} The second extent is contained by or on the edge of the\n *     first.\n * @api\n */\nexport function containsExtent(extent1, extent2) {\n  return extent1[0] <= extent2[0] && extent2[2] <= extent1[2] &&\n      extent1[1] <= extent2[1] && extent2[3] <= extent1[3];\n}\n\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n * @return {boolean} The x, y values are contained in the extent.\n * @api\n */\nexport function containsXY(extent, x, y) {\n  return extent[0] <= x && x <= extent[2] && extent[1] <= y && y <= extent[3];\n}\n\n\n/**\n * Get the relationship between a coordinate and extent.\n * @param {module:ol/extent~Extent} extent The extent.\n * @param {module:ol/coordinate~Coordinate} coordinate The coordinate.\n * @return {module:ol/extent/Relationship} The relationship (bitwise compare with\n *     module:ol/extent/Relationship~Relationship).\n */\nexport function coordinateRelationship(extent, coordinate) {\n  const minX = extent[0];\n  const minY = extent[1];\n  const maxX = extent[2];\n  const maxY = extent[3];\n  const x = coordinate[0];\n  const y = coordinate[1];\n  let relationship = Relationship.UNKNOWN;\n  if (x < minX) {\n    relationship = relationship | Relationship.LEFT;\n  } else if (x > maxX) {\n    relationship = relationship | Relationship.RIGHT;\n  }\n  if (y < minY) {\n    relationship = relationship | Relationship.BELOW;\n  } else if (y > maxY) {\n    relationship = relationship | Relationship.ABOVE;\n  }\n  if (relationship === Relationship.UNKNOWN) {\n    relationship = Relationship.INTERSECTING;\n  }\n  return relationship;\n}\n\n\n/**\n * Create an empty extent.\n * @return {module:ol/extent~Extent} Empty extent.\n * @api\n */\nexport function createEmpty() {\n  return [Infinity, Infinity, -Infinity, -Infinity];\n}\n\n\n/**\n * Create a new extent or update the provided extent.\n * @param {number} minX Minimum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxX Maximum X.\n * @param {number} maxY Maximum Y.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdate(minX, minY, maxX, maxY, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = minX;\n    opt_extent[1] = minY;\n    opt_extent[2] = maxX;\n    opt_extent[3] = maxY;\n    return opt_extent;\n  } else {\n    return [minX, minY, maxX, maxY];\n  }\n}\n\n\n/**\n * Create a new empty extent or make the provided one empty.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateEmpty(opt_extent) {\n  return createOrUpdate(\n    Infinity, Infinity, -Infinity, -Infinity, opt_extent);\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromCoordinate(coordinate, opt_extent) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  return createOrUpdate(x, y, x, y, opt_extent);\n}\n\n\n/**\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromCoordinates(coordinates, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendCoordinates(extent, coordinates);\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromFlatCoordinates(flatCoordinates, offset, end, stride, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendFlatCoordinates(extent, flatCoordinates, offset, end, stride);\n}\n\n/**\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} rings Rings.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromRings(rings, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendRings(extent, rings);\n}\n\n\n/**\n * Determine if two extents are equivalent.\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {boolean} The two extents are equivalent.\n * @api\n */\nexport function equals(extent1, extent2) {\n  return extent1[0] == extent2[0] && extent1[2] == extent2[2] &&\n      extent1[1] == extent2[1] && extent1[3] == extent2[3];\n}\n\n\n/**\n * Modify an extent to include another extent.\n * @param {module:ol/extent~Extent} extent1 The extent to be modified.\n * @param {module:ol/extent~Extent} extent2 The extent that will be included in the first.\n * @return {module:ol/extent~Extent} A reference to the first (extended) extent.\n * @api\n */\nexport function extend(extent1, extent2) {\n  if (extent2[0] < extent1[0]) {\n    extent1[0] = extent2[0];\n  }\n  if (extent2[2] > extent1[2]) {\n    extent1[2] = extent2[2];\n  }\n  if (extent2[1] < extent1[1]) {\n    extent1[1] = extent2[1];\n  }\n  if (extent2[3] > extent1[3]) {\n    extent1[3] = extent2[3];\n  }\n  return extent1;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n */\nexport function extendCoordinate(extent, coordinate) {\n  if (coordinate[0] < extent[0]) {\n    extent[0] = coordinate[0];\n  }\n  if (coordinate[0] > extent[2]) {\n    extent[2] = coordinate[0];\n  }\n  if (coordinate[1] < extent[1]) {\n    extent[1] = coordinate[1];\n  }\n  if (coordinate[1] > extent[3]) {\n    extent[3] = coordinate[1];\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extendCoordinates(extent, coordinates) {\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extendFlatCoordinates(extent, flatCoordinates, offset, end, stride) {\n  for (; offset < end; offset += stride) {\n    extendXY(extent, flatCoordinates[offset], flatCoordinates[offset + 1]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} rings Rings.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extendRings(extent, rings) {\n  for (let i = 0, ii = rings.length; i < ii; ++i) {\n    extendCoordinates(extent, rings[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n */\nexport function extendXY(extent, x, y) {\n  extent[0] = Math.min(extent[0], x);\n  extent[1] = Math.min(extent[1], y);\n  extent[2] = Math.max(extent[2], x);\n  extent[3] = Math.max(extent[3], y);\n}\n\n\n/**\n * This function calls `callback` for each corner of the extent. If the\n * callback returns a truthy value the function returns that value\n * immediately. Otherwise the function returns `false`.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(this:T, module:ol/coordinate~Coordinate): S} callback Callback.\n * @param {T=} opt_this Value to use as `this` when executing `callback`.\n * @return {S|boolean} Value.\n * @template S, T\n */\nexport function forEachCorner(extent, callback, opt_this) {\n  let val;\n  val = callback.call(opt_this, getBottomLeft(extent));\n  if (val) {\n    return val;\n  }\n  val = callback.call(opt_this, getBottomRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback.call(opt_this, getTopRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback.call(opt_this, getTopLeft(extent));\n  if (val) {\n    return val;\n  }\n  return false;\n}\n\n\n/**\n * Get the size of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Area.\n * @api\n */\nexport function getArea(extent) {\n  let area = 0;\n  if (!isEmpty(extent)) {\n    area = getWidth(extent) * getHeight(extent);\n  }\n  return area;\n}\n\n\n/**\n * Get the bottom left coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Bottom left coordinate.\n * @api\n */\nexport function getBottomLeft(extent) {\n  return [extent[0], extent[1]];\n}\n\n\n/**\n * Get the bottom right coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Bottom right coordinate.\n * @api\n */\nexport function getBottomRight(extent) {\n  return [extent[2], extent[1]];\n}\n\n\n/**\n * Get the center coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Center.\n * @api\n */\nexport function getCenter(extent) {\n  return [(extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2];\n}\n\n\n/**\n * Get a corner coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/extent/Corner} corner Corner.\n * @return {module:ol/coordinate~Coordinate} Corner coordinate.\n */\nexport function getCorner(extent, corner) {\n  let coordinate;\n  if (corner === Corner.BOTTOM_LEFT) {\n    coordinate = getBottomLeft(extent);\n  } else if (corner === Corner.BOTTOM_RIGHT) {\n    coordinate = getBottomRight(extent);\n  } else if (corner === Corner.TOP_LEFT) {\n    coordinate = getTopLeft(extent);\n  } else if (corner === Corner.TOP_RIGHT) {\n    coordinate = getTopRight(extent);\n  } else {\n    assert(false, 13); // Invalid corner\n  }\n  return (\n    /** @type {!module:ol/coordinate~Coordinate} */ (coordinate)\n  );\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {number} Enlarged area.\n */\nexport function getEnlargedArea(extent1, extent2) {\n  const minX = Math.min(extent1[0], extent2[0]);\n  const minY = Math.min(extent1[1], extent2[1]);\n  const maxX = Math.max(extent1[2], extent2[2]);\n  const maxY = Math.max(extent1[3], extent2[3]);\n  return (maxX - minX) * (maxY - minY);\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function getForViewAndSize(center, resolution, rotation, size, opt_extent) {\n  const dx = resolution * size[0] / 2;\n  const dy = resolution * size[1] / 2;\n  const cosRotation = Math.cos(rotation);\n  const sinRotation = Math.sin(rotation);\n  const xCos = dx * cosRotation;\n  const xSin = dx * sinRotation;\n  const yCos = dy * cosRotation;\n  const ySin = dy * sinRotation;\n  const x = center[0];\n  const y = center[1];\n  const x0 = x - xCos + ySin;\n  const x1 = x - xCos - ySin;\n  const x2 = x + xCos - ySin;\n  const x3 = x + xCos + ySin;\n  const y0 = y - xSin - yCos;\n  const y1 = y - xSin + yCos;\n  const y2 = y + xSin + yCos;\n  const y3 = y + xSin - yCos;\n  return createOrUpdate(\n    Math.min(x0, x1, x2, x3), Math.min(y0, y1, y2, y3),\n    Math.max(x0, x1, x2, x3), Math.max(y0, y1, y2, y3),\n    opt_extent);\n}\n\n\n/**\n * Get the height of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Height.\n * @api\n */\nexport function getHeight(extent) {\n  return extent[3] - extent[1];\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {number} Intersection area.\n */\nexport function getIntersectionArea(extent1, extent2) {\n  const intersection = getIntersection(extent1, extent2);\n  return getArea(intersection);\n}\n\n\n/**\n * Get the intersection of two extents.\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @param {module:ol/extent~Extent=} opt_extent Optional extent to populate with intersection.\n * @return {module:ol/extent~Extent} Intersecting extent.\n * @api\n */\nexport function getIntersection(extent1, extent2, opt_extent) {\n  const intersection = opt_extent ? opt_extent : createEmpty();\n  if (intersects(extent1, extent2)) {\n    if (extent1[0] > extent2[0]) {\n      intersection[0] = extent1[0];\n    } else {\n      intersection[0] = extent2[0];\n    }\n    if (extent1[1] > extent2[1]) {\n      intersection[1] = extent1[1];\n    } else {\n      intersection[1] = extent2[1];\n    }\n    if (extent1[2] < extent2[2]) {\n      intersection[2] = extent1[2];\n    } else {\n      intersection[2] = extent2[2];\n    }\n    if (extent1[3] < extent2[3]) {\n      intersection[3] = extent1[3];\n    } else {\n      intersection[3] = extent2[3];\n    }\n  } else {\n    createOrUpdateEmpty(intersection);\n  }\n  return intersection;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Margin.\n */\nexport function getMargin(extent) {\n  return getWidth(extent) + getHeight(extent);\n}\n\n\n/**\n * Get the size (width, height) of an extent.\n * @param {module:ol/extent~Extent} extent The extent.\n * @return {module:ol/size~Size} The extent size.\n * @api\n */\nexport function getSize(extent) {\n  return [extent[2] - extent[0], extent[3] - extent[1]];\n}\n\n\n/**\n * Get the top left coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Top left coordinate.\n * @api\n */\nexport function getTopLeft(extent) {\n  return [extent[0], extent[3]];\n}\n\n\n/**\n * Get the top right coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Top right coordinate.\n * @api\n */\nexport function getTopRight(extent) {\n  return [extent[2], extent[3]];\n}\n\n\n/**\n * Get the width of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Width.\n * @api\n */\nexport function getWidth(extent) {\n  return extent[2] - extent[0];\n}\n\n\n/**\n * Determine if one extent intersects another.\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent.\n * @return {boolean} The two extents intersect.\n * @api\n */\nexport function intersects(extent1, extent2) {\n  return extent1[0] <= extent2[2] &&\n      extent1[2] >= extent2[0] &&\n      extent1[1] <= extent2[3] &&\n      extent1[3] >= extent2[1];\n}\n\n\n/**\n * Determine if an extent is empty.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} Is empty.\n * @api\n */\nexport function isEmpty(extent) {\n  return extent[2] < extent[0] || extent[3] < extent[1];\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function returnOrUpdate(extent, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0];\n    opt_extent[1] = extent[1];\n    opt_extent[2] = extent[2];\n    opt_extent[3] = extent[3];\n    return opt_extent;\n  } else {\n    return extent;\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} value Value.\n */\nexport function scaleFromCenter(extent, value) {\n  const deltaX = ((extent[2] - extent[0]) / 2) * (value - 1);\n  const deltaY = ((extent[3] - extent[1]) / 2) * (value - 1);\n  extent[0] -= deltaX;\n  extent[2] += deltaX;\n  extent[1] -= deltaY;\n  extent[3] += deltaY;\n}\n\n\n/**\n * Determine if the segment between two coordinates intersects (crosses,\n * touches, or is contained by) the provided extent.\n * @param {module:ol/extent~Extent} extent The extent.\n * @param {module:ol/coordinate~Coordinate} start Segment start coordinate.\n * @param {module:ol/coordinate~Coordinate} end Segment end coordinate.\n * @return {boolean} The segment intersects the extent.\n */\nexport function intersectsSegment(extent, start, end) {\n  let intersects = false;\n  const startRel = coordinateRelationship(extent, start);\n  const endRel = coordinateRelationship(extent, end);\n  if (startRel === Relationship.INTERSECTING ||\n      endRel === Relationship.INTERSECTING) {\n    intersects = true;\n  } else {\n    const minX = extent[0];\n    const minY = extent[1];\n    const maxX = extent[2];\n    const maxY = extent[3];\n    const startX = start[0];\n    const startY = start[1];\n    const endX = end[0];\n    const endY = end[1];\n    const slope = (endY - startY) / (endX - startX);\n    let x, y;\n    if (!!(endRel & Relationship.ABOVE) &&\n        !(startRel & Relationship.ABOVE)) {\n      // potentially intersects top\n      x = endX - ((endY - maxY) / slope);\n      intersects = x >= minX && x <= maxX;\n    }\n    if (!intersects && !!(endRel & Relationship.RIGHT) &&\n        !(startRel & Relationship.RIGHT)) {\n      // potentially intersects right\n      y = endY - ((endX - maxX) * slope);\n      intersects = y >= minY && y <= maxY;\n    }\n    if (!intersects && !!(endRel & Relationship.BELOW) &&\n        !(startRel & Relationship.BELOW)) {\n      // potentially intersects bottom\n      x = endX - ((endY - minY) / slope);\n      intersects = x >= minX && x <= maxX;\n    }\n    if (!intersects && !!(endRel & Relationship.LEFT) &&\n        !(startRel & Relationship.LEFT)) {\n      // potentially intersects left\n      y = endY - ((endX - minX) * slope);\n      intersects = y >= minY && y <= maxY;\n    }\n\n  }\n  return intersects;\n}\n\n\n/**\n * Apply a transform function to the extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/proj~TransformFunction} transformFn Transform function.\n * Called with `[minX, minY, maxX, maxY]` extent coordinates.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nexport function applyTransform(extent, transformFn, opt_extent) {\n  const coordinates = [\n    extent[0], extent[1],\n    extent[0], extent[3],\n    extent[2], extent[1],\n    extent[2], extent[3]\n  ];\n  transformFn(coordinates, coordinates, 2);\n  const xs = [coordinates[0], coordinates[2], coordinates[4], coordinates[6]];\n  const ys = [coordinates[1], coordinates[3], coordinates[5], coordinates[7]];\n  return _boundingExtentXYs(xs, ys, opt_extent);\n}\n","/**\n * @module ol/extent/Corner\n */\n\n/**\n * Extent corner.\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_RIGHT: 'bottom-right',\n  TOP_LEFT: 'top-left',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/extent/Relationship\n */\n\n/**\n * Relationship to an extent.\n * @enum {number}\n */\nexport default {\n  UNKNOWN: 0,\n  INTERSECTING: 1,\n  ABOVE: 2,\n  RIGHT: 4,\n  BELOW: 8,\n  LEFT: 16\n};\n","/**\n * @module ol/featureloader\n */\nimport {UNDEFINED} from './functions.js';\nimport FormatType from './format/FormatType.js';\n\n\n/**\n * {@link module:ol/source/Vector} sources use a function of this type to\n * load features.\n *\n * This function takes an {@link module:ol/extent~Extent} representing the area to be loaded,\n * a `{number}` representing the resolution (map units per pixel) and an\n * {@link module:ol/proj/Projection} for the projection  as\n * arguments. `this` within the function is bound to the\n * {@link module:ol/source/Vector} it's called from.\n *\n * The function is responsible for loading the features and adding them to the\n * source.\n * @typedef {function(this:module:ol/source/Vector, module:ol/extent~Extent, number,\n *                    module:ol/proj/Projection)} FeatureLoader\n * @api\n */\n\n\n/**\n * {@link module:ol/source/Vector} sources use a function of this type to\n * get the url to load features from.\n *\n * This function takes an {@link module:ol/extent~Extent} representing the area\n * to be loaded, a `{number}` representing the resolution (map units per pixel)\n * and an {@link module:ol/proj/Projection} for the projection  as\n * arguments and returns a `{string}` representing the URL.\n * @typedef {function(module:ol/extent~Extent, number, module:ol/proj/Projection): string} FeatureUrlFunction\n * @api\n */\n\n\n/**\n * @param {string|module:ol/featureloader~FeatureUrlFunction} url Feature URL service.\n * @param {module:ol/format/Feature} format Feature format.\n * @param {function(this:module:ol/VectorTile, Array.<module:ol/Feature>, module:ol/proj/Projection, module:ol/extent~Extent)|function(this:module:ol/source/Vector, Array.<module:ol/Feature>)} success\n *     Function called with the loaded features and optionally with the data\n *     projection. Called with the vector tile or source as `this`.\n * @param {function(this:module:ol/VectorTile)|function(this:module:ol/source/Vector)} failure\n *     Function called when loading failed. Called with the vector tile or\n *     source as `this`.\n * @return {module:ol/featureloader~FeatureLoader} The feature loader.\n */\nexport function loadFeaturesXhr(url, format, success, failure) {\n  return (\n    /**\n     * @param {module:ol/extent~Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @param {module:ol/proj/Projection} projection Projection.\n     * @this {module:ol/source/Vector|module:ol/VectorTile}\n     */\n    function(extent, resolution, projection) {\n      const xhr = new XMLHttpRequest();\n      xhr.open('GET',\n        typeof url === 'function' ? url(extent, resolution, projection) : url,\n        true);\n      if (format.getType() == FormatType.ARRAY_BUFFER) {\n        xhr.responseType = 'arraybuffer';\n      }\n      /**\n       * @param {Event} event Event.\n       * @private\n       */\n      xhr.onload = function(event) {\n        // status will be 0 for file:// urls\n        if (!xhr.status || xhr.status >= 200 && xhr.status < 300) {\n          const type = format.getType();\n          /** @type {Document|Node|Object|string|undefined} */\n          let source;\n          if (type == FormatType.JSON || type == FormatType.TEXT) {\n            source = xhr.responseText;\n          } else if (type == FormatType.XML) {\n            source = xhr.responseXML;\n            if (!source) {\n              source = new DOMParser().parseFromString(xhr.responseText, 'application/xml');\n            }\n          } else if (type == FormatType.ARRAY_BUFFER) {\n            source = /** @type {ArrayBuffer} */ (xhr.response);\n          }\n          if (source) {\n            success.call(this, format.readFeatures(source,\n              {featureProjection: projection}),\n            format.readProjection(source), format.getLastExtent());\n          } else {\n            failure.call(this);\n          }\n        } else {\n          failure.call(this);\n        }\n      }.bind(this);\n      /**\n       * @private\n       */\n      xhr.onerror = function() {\n        failure.call(this);\n      }.bind(this);\n      xhr.send();\n    }\n  );\n}\n\n\n/**\n * Create an XHR feature loader for a `url` and `format`. The feature loader\n * loads features (with XHR), parses the features, and adds them to the\n * vector source.\n * @param {string|module:ol/featureloader~FeatureUrlFunction} url Feature URL service.\n * @param {module:ol/format/Feature} format Feature format.\n * @return {module:ol/featureloader~FeatureLoader} The feature loader.\n * @api\n */\nexport function xhr(url, format) {\n  return loadFeaturesXhr(url, format,\n    /**\n     * @param {Array.<module:ol/Feature>} features The loaded features.\n     * @param {module:ol/proj/Projection} dataProjection Data\n     * projection.\n     * @this {module:ol/source/Vector}\n     */\n    function(features, dataProjection) {\n      this.addFeatures(features);\n    }, /* FIXME handle error */ UNDEFINED);\n}\n","/**\n * @module ol/format/Feature\n */\nimport Geometry from '../geom/Geometry.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection, equivalent as equivalentProjection, transformExtent} from '../proj.js';\n\n\n/**\n * @typedef {Object} ReadOptions\n * @property {module:ol/proj~ProjectionLike} dataProjection Projection of the data we are reading.\n * If not provided, the projection will be derived from the data (where possible) or\n * the `defaultDataProjection` of the format is assigned (where set). If the projection\n * can not be derived from the data and if no `defaultDataProjection` is set for a format,\n * the features will not be reprojected.\n * @property {module:ol/extent~Extent} extent Tile extent of the tile being read. This is only used and\n * required for {@link module:ol/format/MVT}.\n * @property {module:ol/proj~ProjectionLike} featureProjection Projection of the feature geometries\n * created by the format reader. If not provided, features will be returned in the\n * `dataProjection`.\n */\n\n\n/**\n * @typedef {Object} WriteOptions\n * @property {module:ol/proj~ProjectionLike} dataProjection Projection of the data we are writing.\n * If not provided, the `defaultDataProjection` of the format is assigned (where set).\n * If no `defaultDataProjection` is set for a format, the features will be returned\n * in the `featureProjection`.\n * @property {module:ol/proj~ProjectionLike} featureProjection Projection of the feature geometries\n * that will be serialized by the format writer. If not provided, geometries are assumed\n * to be in the `dataProjection` if that is set; in other words, they are not transformed.\n * @property {boolean} [rightHanded] When writing geometries, follow the right-hand\n * rule for linear ring orientation.  This means that polygons will have counter-clockwise\n * exterior rings and clockwise interior rings.  By default, coordinates are serialized\n * as they are provided at construction.  If `true`, the right-hand rule will\n * be applied.  If `false`, the left-hand rule will be applied (clockwise for\n * exterior and counter-clockwise for interior rings).  Note that not all\n * formats support this.  The GeoJSON format does use this property when writing\n * geometries.\n * @property {number} [decimals] Maximum number of decimal places for coordinates.\n * Coordinates are stored internally as floats, but floating-point arithmetic can create\n * coordinates with a large number of decimal places, not generally wanted on output.\n * Set a number here to round coordinates. Can also be used to ensure that\n * coordinates read in can be written back out with the same number of decimals.\n * Default is no rounding.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for feature formats.\n * {module:ol/format/Feature~FeatureFormat} subclasses provide the ability to decode and encode\n * {@link module:ol/Feature~Feature} objects from a variety of commonly used geospatial\n * file formats.  See the documentation for each format for more details.\n *\n * @constructor\n * @abstract\n * @api\n */\nconst FeatureFormat = function() {\n\n  /**\n   * @protected\n   * @type {module:ol/proj/Projection}\n   */\n  this.defaultDataProjection = null;\n\n  /**\n   * @protected\n   * @type {module:ol/proj/Projection}\n   */\n  this.defaultFeatureProjection = null;\n\n};\n\n\n/**\n * Adds the data projection to the read options.\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @return {module:ol/format/Feature~ReadOptions|undefined} Options.\n * @protected\n */\nFeatureFormat.prototype.getReadOptions = function(source, opt_options) {\n  let options;\n  if (opt_options) {\n    options = {\n      dataProjection: opt_options.dataProjection ?\n        opt_options.dataProjection : this.readProjection(source),\n      featureProjection: opt_options.featureProjection\n    };\n  }\n  return this.adaptOptions(options);\n};\n\n\n/**\n * Sets the `defaultDataProjection` on the options, if no `dataProjection`\n * is set.\n * @param {module:ol/format/Feature~WriteOptions|module:ol/format/Feature~ReadOptions|undefined} options\n *     Options.\n * @protected\n * @return {module:ol/format/Feature~WriteOptions|module:ol/format/Feature~ReadOptions|undefined}\n *     Updated options.\n */\nFeatureFormat.prototype.adaptOptions = function(options) {\n  return assign({\n    dataProjection: this.defaultDataProjection,\n    featureProjection: this.defaultFeatureProjection\n  }, options);\n};\n\n\n/**\n * Get the extent from the source of the last {@link readFeatures} call.\n * @return {module:ol/extent~Extent} Tile extent.\n */\nFeatureFormat.prototype.getLastExtent = function() {\n  return null;\n};\n\n\n/**\n * @abstract\n * @return {module:ol/format/FormatType} Format.\n */\nFeatureFormat.prototype.getType = function() {};\n\n\n/**\n * Read a single feature from a source.\n *\n * @abstract\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n */\nFeatureFormat.prototype.readFeature = function(source, opt_options) {};\n\n\n/**\n * Read all features from a source.\n *\n * @abstract\n * @param {Document|Node|ArrayBuffer|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n */\nFeatureFormat.prototype.readFeatures = function(source, opt_options) {};\n\n\n/**\n * Read a single geometry from a source.\n *\n * @abstract\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n */\nFeatureFormat.prototype.readGeometry = function(source, opt_options) {};\n\n\n/**\n * Read the projection from a source.\n *\n * @abstract\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n */\nFeatureFormat.prototype.readProjection = function(source) {};\n\n\n/**\n * Encode a feature in this format.\n *\n * @abstract\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} Result.\n */\nFeatureFormat.prototype.writeFeature = function(feature, opt_options) {};\n\n\n/**\n * Encode an array of features in this format.\n *\n * @abstract\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} Result.\n */\nFeatureFormat.prototype.writeFeatures = function(features, opt_options) {};\n\n\n/**\n * Write a single geometry in this format.\n *\n * @abstract\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} Result.\n */\nFeatureFormat.prototype.writeGeometry = function(geometry, opt_options) {};\n\nexport default FeatureFormat;\n\n/**\n * @param {module:ol/geom/Geometry|module:ol/extent~Extent} geometry Geometry.\n * @param {boolean} write Set to true for writing, false for reading.\n * @param {(module:ol/format/Feature~WriteOptions|module:ol/format/Feature~ReadOptions)=} opt_options\n *     Options.\n * @return {module:ol/geom/Geometry|module:ol/extent~Extent} Transformed geometry.\n */\nexport function transformWithOptions(geometry, write, opt_options) {\n  const featureProjection = opt_options ?\n    getProjection(opt_options.featureProjection) : null;\n  const dataProjection = opt_options ?\n    getProjection(opt_options.dataProjection) : null;\n  /**\n   * @type {module:ol/geom/Geometry|module:ol/extent~Extent}\n   */\n  let transformed;\n  if (featureProjection && dataProjection &&\n      !equivalentProjection(featureProjection, dataProjection)) {\n    if (geometry instanceof Geometry) {\n      transformed = (write ? geometry.clone() : geometry).transform(\n        write ? featureProjection : dataProjection,\n        write ? dataProjection : featureProjection);\n    } else {\n      // FIXME this is necessary because GML treats extents\n      // as geometries\n      transformed = transformExtent(\n        geometry,\n        dataProjection,\n        featureProjection);\n    }\n  } else {\n    transformed = geometry;\n  }\n  if (write && opt_options && opt_options.decimals !== undefined) {\n    const power = Math.pow(10, opt_options.decimals);\n    // if decimals option on write, round each coordinate appropriately\n    /**\n     * @param {Array.<number>} coordinates Coordinates.\n     * @return {Array.<number>} Transformed coordinates.\n     */\n    const transform = function(coordinates) {\n      for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n        coordinates[i] = Math.round(coordinates[i] * power) / power;\n      }\n      return coordinates;\n    };\n    if (transformed === geometry) {\n      transformed = transformed.clone();\n    }\n    transformed.applyTransform(transform);\n  }\n  return transformed;\n}\n","/**\n * @module ol/format/FormatType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ARRAY_BUFFER: 'arraybuffer',\n  JSON: 'json',\n  TEXT: 'text',\n  XML: 'xml'\n};\n","/**\n * @module ol/format/GeoJSON\n */\n// TODO: serialize dataProjection as crs member when writing\n// see https://github.com/openlayers/openlayers/issues/2078\n\nimport {inherits} from '../index.js';\nimport {assert} from '../asserts.js';\nimport Feature from '../Feature.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport JSONFeature from '../format/JSONFeature.js';\nimport GeometryCollection from '../geom/GeometryCollection.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {assign, isEmpty} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/proj~ProjectionLike} [defaultDataProjection='EPSG:4326'] Default data projection.\n * @property {module:ol/proj~ProjectionLike} [featureProjection] Projection for features read or\n * written by the format.  Options passed to read or write methods will take precedence.\n * @property {string} [geometryName] Geometry name to use when creating features.\n * @property {boolean} [extractGeometryName=false] Certain GeoJSON providers include\n * the geometry_name field in the feature GeoJSON. If set to `true` the GeoJSON reader\n * will look for that field to set the geometry name. If both this field is set to `true`\n * and a `geometryName` is provided, the `geometryName` will take precedence.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GeoJSON format.\n *\n * @constructor\n * @extends {module:ol/format/JSONFeature}\n * @param {module:ol/format/GeoJSON~Options=} opt_options Options.\n * @api\n */\nconst GeoJSON = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  JSONFeature.call(this);\n\n  /**\n   * @inheritDoc\n   */\n  this.defaultDataProjection = getProjection(\n    options.defaultDataProjection ?\n      options.defaultDataProjection : 'EPSG:4326');\n\n\n  if (options.featureProjection) {\n    this.defaultFeatureProjection = getProjection(options.featureProjection);\n  }\n\n  /**\n   * Name of the geometry attribute for features.\n   * @type {string|undefined}\n   * @private\n   */\n  this.geometryName_ = options.geometryName;\n\n  /**\n   * Look for the geometry name in the feature GeoJSON\n   * @type {boolean|undefined}\n   * @private\n   */\n  this.extractGeometryName_ = options.extractGeometryName;\n\n};\n\ninherits(GeoJSON, JSONFeature);\n\n\n/**\n * @const\n * @type {Object.<string, function(GeoJSONObject): module:ol/geom/Geometry>}\n */\nconst GEOMETRY_READERS = {\n  'Point': readPointGeometry,\n  'LineString': readLineStringGeometry,\n  'Polygon': readPolygonGeometry,\n  'MultiPoint': readMultiPointGeometry,\n  'MultiLineString': readMultiLineStringGeometry,\n  'MultiPolygon': readMultiPolygonGeometry,\n  'GeometryCollection': readGeometryCollectionGeometry\n};\n\n\n/**\n * @const\n * @type {Object.<string, function(module:ol/geom/Geometry, module:ol/format/Feature~WriteOptions=): (GeoJSONGeometry|GeoJSONGeometryCollection)>}\n */\nconst GEOMETRY_WRITERS = {\n  'Point': writePointGeometry,\n  'LineString': writeLineStringGeometry,\n  'Polygon': writePolygonGeometry,\n  'MultiPoint': writeMultiPointGeometry,\n  'MultiLineString': writeMultiLineStringGeometry,\n  'MultiPolygon': writeMultiPolygonGeometry,\n  'GeometryCollection': writeGeometryCollectionGeometry,\n  'Circle': writeEmptyGeometryCollectionGeometry\n};\n\n\n/**\n * @param {GeoJSONGeometry|GeoJSONGeometryCollection} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n */\nfunction readGeometry(object, opt_options) {\n  if (!object) {\n    return null;\n  }\n  const geometryReader = GEOMETRY_READERS[object.type];\n  return (\n    /** @type {module:ol/geom/Geometry} */ (transformWithOptions(geometryReader(object), false, opt_options))\n  );\n}\n\n\n/**\n * @param {GeoJSONGeometryCollection} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/GeometryCollection} Geometry collection.\n */\nfunction readGeometryCollectionGeometry(object, opt_options) {\n  const geometries = object.geometries.map(\n    /**\n     * @param {GeoJSONGeometry} geometry Geometry.\n     * @return {module:ol/geom/Geometry} geometry Geometry.\n     */\n    function(geometry) {\n      return readGeometry(geometry, opt_options);\n    });\n  return new GeometryCollection(geometries);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/Point} Point.\n */\nfunction readPointGeometry(object) {\n  return new Point(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/LineString} LineString.\n */\nfunction readLineStringGeometry(object) {\n  return new LineString(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/MultiLineString} MultiLineString.\n */\nfunction readMultiLineStringGeometry(object) {\n  return new MultiLineString(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/MultiPoint} MultiPoint.\n */\nfunction readMultiPointGeometry(object) {\n  return new MultiPoint(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/MultiPolygon} MultiPolygon.\n */\nfunction readMultiPolygonGeometry(object) {\n  return new MultiPolygon(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/Polygon} Polygon.\n */\nfunction readPolygonGeometry(object) {\n  return new Polygon(object.coordinates);\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry|GeoJSONGeometryCollection} GeoJSON geometry.\n */\nfunction writeGeometry(geometry, opt_options) {\n  const geometryWriter = GEOMETRY_WRITERS[geometry.getType()];\n  return geometryWriter(/** @type {module:ol/geom/Geometry} */ (\n    transformWithOptions(geometry, true, opt_options)), opt_options);\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @return {GeoJSONGeometryCollection} Empty GeoJSON geometry collection.\n */\nfunction writeEmptyGeometryCollectionGeometry(geometry) {\n  return /** @type {GeoJSONGeometryCollection} */ ({\n    type: 'GeometryCollection',\n    geometries: []\n  });\n}\n\n\n/**\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometryCollection} GeoJSON geometry collection.\n */\nfunction writeGeometryCollectionGeometry(geometry, opt_options) {\n  const geometries = geometry.getGeometriesArray().map(function(geometry) {\n    const options = assign({}, opt_options);\n    delete options.featureProjection;\n    return writeGeometry(geometry, options);\n  });\n  return /** @type {GeoJSONGeometryCollection} */ ({\n    type: 'GeometryCollection',\n    geometries: geometries\n  });\n}\n\n\n/**\n * @param {module:ol/geom/LineString} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeLineStringGeometry(geometry, opt_options) {\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'LineString',\n    coordinates: geometry.getCoordinates()\n  });\n}\n\n\n/**\n * @param {module:ol/geom/MultiLineString} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeMultiLineStringGeometry(geometry, opt_options) {\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'MultiLineString',\n    coordinates: geometry.getCoordinates()\n  });\n}\n\n\n/**\n * @param {module:ol/geom/MultiPoint} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeMultiPointGeometry(geometry, opt_options) {\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'MultiPoint',\n    coordinates: geometry.getCoordinates()\n  });\n}\n\n\n/**\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeMultiPolygonGeometry(geometry, opt_options) {\n  let right;\n  if (opt_options) {\n    right = opt_options.rightHanded;\n  }\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'MultiPolygon',\n    coordinates: geometry.getCoordinates(right)\n  });\n}\n\n\n/**\n * @param {module:ol/geom/Point} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writePointGeometry(geometry, opt_options) {\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'Point',\n    coordinates: geometry.getCoordinates()\n  });\n}\n\n\n/**\n * @param {module:ol/geom/Polygon} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writePolygonGeometry(geometry, opt_options) {\n  let right;\n  if (opt_options) {\n    right = opt_options.rightHanded;\n  }\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'Polygon',\n    coordinates: geometry.getCoordinates(right)\n  });\n}\n\n\n/**\n * Read a feature from a GeoJSON Feature source.  Only works for Feature or\n * geometry types.  Use {@link module:ol/format/GeoJSON#readFeatures} to read\n * FeatureCollection source. If feature at source has an id, it will be used\n * as Feature id by calling {@link module:ol/Feature#setId} internally.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n * @api\n */\nGeoJSON.prototype.readFeature;\n\n\n/**\n * Read all features from a GeoJSON source.  Works for all GeoJSON types.\n * If the source includes only geometries, features will be created with those\n * geometries.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nGeoJSON.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nGeoJSON.prototype.readFeatureFromObject = function(object, opt_options) {\n  /**\n   * @type {GeoJSONFeature}\n   */\n  let geoJSONFeature = null;\n  if (object.type === 'Feature') {\n    geoJSONFeature = /** @type {GeoJSONFeature} */ (object);\n  } else {\n    geoJSONFeature = /** @type {GeoJSONFeature} */ ({\n      type: 'Feature',\n      geometry: /** @type {GeoJSONGeometry|GeoJSONGeometryCollection} */ (object)\n    });\n  }\n\n  const geometry = readGeometry(geoJSONFeature.geometry, opt_options);\n  const feature = new Feature();\n  if (this.geometryName_) {\n    feature.setGeometryName(this.geometryName_);\n  } else if (this.extractGeometryName_ && geoJSONFeature.geometry_name !== undefined) {\n    feature.setGeometryName(geoJSONFeature.geometry_name);\n  }\n  feature.setGeometry(geometry);\n  if (geoJSONFeature.id !== undefined) {\n    feature.setId(geoJSONFeature.id);\n  }\n  if (geoJSONFeature.properties) {\n    feature.setProperties(geoJSONFeature.properties);\n  }\n  return feature;\n};\n\n\n/**\n * @inheritDoc\n */\nGeoJSON.prototype.readFeaturesFromObject = function(object, opt_options) {\n  const geoJSONObject = /** @type {GeoJSONObject} */ (object);\n  /** @type {Array.<module:ol/Feature>} */\n  let features = null;\n  if (geoJSONObject.type === 'FeatureCollection') {\n    const geoJSONFeatureCollection = /** @type {GeoJSONFeatureCollection} */ (object);\n    features = [];\n    const geoJSONFeatures = geoJSONFeatureCollection.features;\n    for (let i = 0, ii = geoJSONFeatures.length; i < ii; ++i) {\n      features.push(this.readFeatureFromObject(geoJSONFeatures[i], opt_options));\n    }\n  } else {\n    features = [this.readFeatureFromObject(object, opt_options)];\n  }\n  return features;\n};\n\n\n/**\n * Read a geometry from a GeoJSON source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n * @api\n */\nGeoJSON.prototype.readGeometry;\n\n\n/**\n * @inheritDoc\n */\nGeoJSON.prototype.readGeometryFromObject = function(object, opt_options) {\n  return readGeometry(/** @type {GeoJSONGeometry} */ (object), opt_options);\n};\n\n\n/**\n * Read the projection from a GeoJSON source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nGeoJSON.prototype.readProjection;\n\n\n/**\n * @inheritDoc\n */\nGeoJSON.prototype.readProjectionFromObject = function(object) {\n  const geoJSONObject = /** @type {GeoJSONObject} */ (object);\n  const crs = geoJSONObject.crs;\n  let projection;\n  if (crs) {\n    if (crs.type == 'name') {\n      projection = getProjection(crs.properties.name);\n    } else {\n      assert(false, 36); // Unknown SRS type\n    }\n  } else {\n    projection = this.defaultDataProjection;\n  }\n  return (\n    /** @type {module:ol/proj/Projection} */ (projection)\n  );\n};\n\n\n/**\n * Encode a feature as a GeoJSON Feature string.\n *\n * @function\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} GeoJSON.\n * @override\n * @api\n */\nGeoJSON.prototype.writeFeature;\n\n\n/**\n * Encode a feature as a GeoJSON Feature object.\n *\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONFeature} Object.\n * @override\n * @api\n */\nGeoJSON.prototype.writeFeatureObject = function(feature, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n\n  const object = /** @type {GeoJSONFeature} */ ({\n    'type': 'Feature'\n  });\n  const id = feature.getId();\n  if (id !== undefined) {\n    object.id = id;\n  }\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    object.geometry = writeGeometry(geometry, opt_options);\n  } else {\n    object.geometry = null;\n  }\n  const properties = feature.getProperties();\n  delete properties[feature.getGeometryName()];\n  if (!isEmpty(properties)) {\n    object.properties = properties;\n  } else {\n    object.properties = null;\n  }\n  return object;\n};\n\n\n/**\n * Encode an array of features as GeoJSON.\n *\n * @function\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} GeoJSON.\n * @api\n */\nGeoJSON.prototype.writeFeatures;\n\n\n/**\n * Encode an array of features as a GeoJSON object.\n *\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONFeatureCollection} GeoJSON Object.\n * @override\n * @api\n */\nGeoJSON.prototype.writeFeaturesObject = function(features, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n  const objects = [];\n  for (let i = 0, ii = features.length; i < ii; ++i) {\n    objects.push(this.writeFeatureObject(features[i], opt_options));\n  }\n  return /** @type {GeoJSONFeatureCollection} */ ({\n    type: 'FeatureCollection',\n    features: objects\n  });\n};\n\n\n/**\n * Encode a geometry as a GeoJSON string.\n *\n * @function\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} GeoJSON.\n * @api\n */\nGeoJSON.prototype.writeGeometry;\n\n\n/**\n * Encode a geometry as a GeoJSON object.\n *\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry|GeoJSONGeometryCollection} Object.\n * @override\n * @api\n */\nGeoJSON.prototype.writeGeometryObject = function(geometry, opt_options) {\n  return writeGeometry(geometry, this.adaptOptions(opt_options));\n};\nexport default GeoJSON;\n","/**\n * @module ol/format/JSONFeature\n */\nimport {inherits} from '../index.js';\nimport FeatureFormat from '../format/Feature.js';\nimport FormatType from '../format/FormatType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for JSON feature formats.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/format/Feature}\n */\nconst JSONFeature = function() {\n  FeatureFormat.call(this);\n};\n\ninherits(JSONFeature, FeatureFormat);\n\n\n/**\n * @param {Document|Node|Object|string} source Source.\n * @return {Object} Object.\n */\nfunction getObject(source) {\n  if (typeof source === 'string') {\n    const object = JSON.parse(source);\n    return object ? /** @type {Object} */ (object) : null;\n  } else if (source !== null) {\n    return source;\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.getType = function() {\n  return FormatType.JSON;\n};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.readFeature = function(source, opt_options) {\n  return this.readFeatureFromObject(\n    getObject(source), this.getReadOptions(source, opt_options));\n};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.readFeatures = function(source, opt_options) {\n  return this.readFeaturesFromObject(\n    getObject(source), this.getReadOptions(source, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {Object} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @protected\n * @return {module:ol/Feature} Feature.\n */\nJSONFeature.prototype.readFeatureFromObject = function(object, opt_options) {};\n\n\n/**\n * @abstract\n * @param {Object} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @protected\n * @return {Array.<module:ol/Feature>} Features.\n */\nJSONFeature.prototype.readFeaturesFromObject = function(object, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.readGeometry = function(source, opt_options) {\n  return this.readGeometryFromObject(\n    getObject(source), this.getReadOptions(source, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {Object} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @protected\n * @return {module:ol/geom/Geometry} Geometry.\n */\nJSONFeature.prototype.readGeometryFromObject = function(object, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.readProjection = function(source) {\n  return this.readProjectionFromObject(getObject(source));\n};\n\n\n/**\n * @abstract\n * @param {Object} object Object.\n * @protected\n * @return {module:ol/proj/Projection} Projection.\n */\nJSONFeature.prototype.readProjectionFromObject = function(object) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.writeFeature = function(feature, opt_options) {\n  return JSON.stringify(this.writeFeatureObject(feature, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {Object} Object.\n */\nJSONFeature.prototype.writeFeatureObject = function(feature, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.writeFeatures = function(features, opt_options) {\n  return JSON.stringify(this.writeFeaturesObject(features, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {Object} Object.\n */\nJSONFeature.prototype.writeFeaturesObject = function(features, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.writeGeometry = function(geometry, opt_options) {\n  return JSON.stringify(this.writeGeometryObject(geometry, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {Object} Object.\n */\nJSONFeature.prototype.writeGeometryObject = function(geometry, opt_options) {};\nexport default JSONFeature;\n","/**\n * @module ol/functions\n */\n\n/**\n * Always returns true.\n * @returns {boolean} true.\n */\nexport function TRUE() {\n  return true;\n}\n\n/**\n * Always returns false.\n * @returns {boolean} false.\n */\nexport function FALSE() {\n  return false;\n}\n\n/**\n * A reusable function, used e.g. as a default for callbacks.\n *\n * @return {undefined} Nothing.\n */\nexport function UNDEFINED() {}\n","/**\n * @module ol/geom/Circle\n */\nimport {inherits} from '../index.js';\nimport {createOrUpdate, forEachCorner, intersects} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {deflateCoordinate} from '../geom/flat/deflate.js';\n\n/**\n * @classdesc\n * Circle geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number=} opt_radius Radius.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst Circle = function(center, opt_radius, opt_layout) {\n  SimpleGeometry.call(this);\n  const radius = opt_radius ? opt_radius : 0;\n  this.setCenterAndRadius(center, radius, opt_layout);\n};\n\ninherits(Circle, SimpleGeometry);\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/Circle} Clone.\n * @override\n * @api\n */\nCircle.prototype.clone = function() {\n  const circle = new Circle(null);\n  circle.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return circle;\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  const flatCoordinates = this.flatCoordinates;\n  const dx = x - flatCoordinates[0];\n  const dy = y - flatCoordinates[1];\n  const squaredDistance = dx * dx + dy * dy;\n  if (squaredDistance < minSquaredDistance) {\n    if (squaredDistance === 0) {\n      for (let i = 0; i < this.stride; ++i) {\n        closestPoint[i] = flatCoordinates[i];\n      }\n    } else {\n      const delta = this.getRadius() / Math.sqrt(squaredDistance);\n      closestPoint[0] = flatCoordinates[0] + delta * dx;\n      closestPoint[1] = flatCoordinates[1] + delta * dy;\n      for (let i = 2; i < this.stride; ++i) {\n        closestPoint[i] = flatCoordinates[i];\n      }\n    }\n    closestPoint.length = this.stride;\n    return squaredDistance;\n  } else {\n    return minSquaredDistance;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.containsXY = function(x, y) {\n  const flatCoordinates = this.flatCoordinates;\n  const dx = x - flatCoordinates[0];\n  const dy = y - flatCoordinates[1];\n  return dx * dx + dy * dy <= this.getRadiusSquared_();\n};\n\n\n/**\n * Return the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n * @return {module:ol/coordinate~Coordinate} Center.\n * @api\n */\nCircle.prototype.getCenter = function() {\n  return this.flatCoordinates.slice(0, this.stride);\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.computeExtent = function(extent) {\n  const flatCoordinates = this.flatCoordinates;\n  const radius = flatCoordinates[this.stride] - flatCoordinates[0];\n  return createOrUpdate(\n    flatCoordinates[0] - radius, flatCoordinates[1] - radius,\n    flatCoordinates[0] + radius, flatCoordinates[1] + radius,\n    extent);\n};\n\n\n/**\n * Return the radius of the circle.\n * @return {number} Radius.\n * @api\n */\nCircle.prototype.getRadius = function() {\n  return Math.sqrt(this.getRadiusSquared_());\n};\n\n\n/**\n * @private\n * @return {number} Radius squared.\n */\nCircle.prototype.getRadiusSquared_ = function() {\n  const dx = this.flatCoordinates[this.stride] - this.flatCoordinates[0];\n  const dy = this.flatCoordinates[this.stride + 1] - this.flatCoordinates[1];\n  return dx * dx + dy * dy;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nCircle.prototype.getType = function() {\n  return GeometryType.CIRCLE;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nCircle.prototype.intersectsExtent = function(extent) {\n  const circleExtent = this.getExtent();\n  if (intersects(extent, circleExtent)) {\n    const center = this.getCenter();\n\n    if (extent[0] <= center[0] && extent[2] >= center[0]) {\n      return true;\n    }\n    if (extent[1] <= center[1] && extent[3] >= center[1]) {\n      return true;\n    }\n\n    return forEachCorner(extent, this.intersectsCoordinate, this);\n  }\n  return false;\n\n};\n\n\n/**\n * Set the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @api\n */\nCircle.prototype.setCenter = function(center) {\n  const stride = this.stride;\n  const radius = this.flatCoordinates[stride] - this.flatCoordinates[0];\n  const flatCoordinates = center.slice();\n  flatCoordinates[stride] = flatCoordinates[0] + radius;\n  for (let i = 1; i < stride; ++i) {\n    flatCoordinates[stride + i] = center[i];\n  }\n  this.setFlatCoordinates(this.layout, flatCoordinates);\n};\n\n\n/**\n * Set the center (as {@link module:ol/coordinate~Coordinate coordinate}) and the radius (as\n * number) of the circle.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} radius Radius.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nCircle.prototype.setCenterAndRadius = function(center, radius, opt_layout) {\n  if (!center) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, center, 0);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    /** @type {Array.<number>} */\n    const flatCoordinates = this.flatCoordinates;\n    let offset = deflateCoordinate(\n      flatCoordinates, 0, center, this.stride);\n    flatCoordinates[offset++] = flatCoordinates[0] + radius;\n    for (let i = 1, ii = this.stride; i < ii; ++i) {\n      flatCoordinates[offset++] = flatCoordinates[i];\n    }\n    flatCoordinates.length = offset;\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.getCoordinates = function() {};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.setCoordinates = function(coordinates, opt_layout) {};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nCircle.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\n\n\n/**\n * Set the radius of the circle. The radius is in the units of the projection.\n * @param {number} radius Radius.\n * @api\n */\nCircle.prototype.setRadius = function(radius) {\n  this.flatCoordinates[this.stride] = this.flatCoordinates[0] + radius;\n  this.changed();\n};\n\n\n/**\n * Transform each coordinate of the circle from one coordinate reference system\n * to another. The geometry is modified in place.\n * If you do not want the geometry modified in place, first clone() it and\n * then use this function on the clone.\n *\n * Internally a circle is currently represented by two points: the center of\n * the circle `[cx, cy]`, and the point to the right of the circle\n * `[cx + r, cy]`. This `transform` function just transforms these two points.\n * So the resulting geometry is also a circle, and that circle does not\n * correspond to the shape that would be obtained by transforming every point\n * of the original circle.\n *\n * @param {module:ol/proj~ProjectionLike} source The current projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @param {module:ol/proj~ProjectionLike} destination The desired projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @return {module:ol/geom/Circle} This geometry.  Note that original geometry is\n *     modified in place.\n * @function\n * @api\n */\nCircle.prototype.transform;\nexport default Circle;\n","/**\n * @module ol/geom/Geometry\n */\nimport {inherits} from '../index.js';\nimport BaseObject from '../Object.js';\nimport {createEmpty, getHeight, returnOrUpdate} from '../extent.js';\nimport {FALSE} from '../functions.js';\nimport {transform2D} from '../geom/flat/transform.js';\nimport {get as getProjection, getTransform} from '../proj.js';\nimport Units from '../proj/Units.js';\nimport {create as createTransform, compose as composeTransform} from '../transform.js';\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for vector geometries.\n *\n * To get notified of changes to the geometry, register a listener for the\n * generic `change` event on your geometry instance.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/Object}\n * @api\n */\nconst Geometry = function() {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = createEmpty();\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.extentRevision_ = -1;\n\n  /**\n   * @protected\n   * @type {Object.<string, module:ol/geom/Geometry>}\n   */\n  this.simplifiedGeometryCache = {};\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.simplifiedGeometryRevision = 0;\n\n};\n\ninherits(Geometry, BaseObject);\n\n\n/**\n * @type {module:ol/transform~Transform}\n */\nconst tmpTransform = createTransform();\n\n\n/**\n * Make a complete copy of the geometry.\n * @abstract\n * @return {!module:ol/geom/Geometry} Clone.\n */\nGeometry.prototype.clone = function() {};\n\n\n/**\n * @abstract\n * @param {number} x X.\n * @param {number} y Y.\n * @param {module:ol/coordinate~Coordinate} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @return {number} Minimum squared distance.\n */\nGeometry.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {};\n\n\n/**\n * Return the closest point of the geometry to the passed point as\n * {@link module:ol/coordinate~Coordinate coordinate}.\n * @param {module:ol/coordinate~Coordinate} point Point.\n * @param {module:ol/coordinate~Coordinate=} opt_closestPoint Closest point.\n * @return {module:ol/coordinate~Coordinate} Closest point.\n * @api\n */\nGeometry.prototype.getClosestPoint = function(point, opt_closestPoint) {\n  const closestPoint = opt_closestPoint ? opt_closestPoint : [NaN, NaN];\n  this.closestPointXY(point[0], point[1], closestPoint, Infinity);\n  return closestPoint;\n};\n\n\n/**\n * Returns true if this geometry includes the specified coordinate. If the\n * coordinate is on the boundary of the geometry, returns false.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {boolean} Contains coordinate.\n * @api\n */\nGeometry.prototype.intersectsCoordinate = function(coordinate) {\n  return this.containsXY(coordinate[0], coordinate[1]);\n};\n\n\n/**\n * @abstract\n * @param {module:ol/extent~Extent} extent Extent.\n * @protected\n * @return {module:ol/extent~Extent} extent Extent.\n */\nGeometry.prototype.computeExtent = function(extent) {};\n\n\n/**\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nGeometry.prototype.containsXY = FALSE;\n\n\n/**\n * Get the extent of the geometry.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} extent Extent.\n * @api\n */\nGeometry.prototype.getExtent = function(opt_extent) {\n  if (this.extentRevision_ != this.getRevision()) {\n    this.extent_ = this.computeExtent(this.extent_);\n    this.extentRevision_ = this.getRevision();\n  }\n  return returnOrUpdate(this.extent_, opt_extent);\n};\n\n\n/**\n * Rotate the geometry around a given coordinate. This modifies the geometry\n * coordinates in place.\n * @abstract\n * @param {number} angle Rotation angle in radians.\n * @param {module:ol/coordinate~Coordinate} anchor The rotation center.\n * @api\n */\nGeometry.prototype.rotate = function(angle, anchor) {};\n\n\n/**\n * Scale the geometry (with an optional origin).  This modifies the geometry\n * coordinates in place.\n * @abstract\n * @param {number} sx The scaling factor in the x-direction.\n * @param {number=} opt_sy The scaling factor in the y-direction (defaults to\n *     sx).\n * @param {module:ol/coordinate~Coordinate=} opt_anchor The scale origin (defaults to the center\n *     of the geometry extent).\n * @api\n */\nGeometry.prototype.scale = function(sx, opt_sy, opt_anchor) {};\n\n\n/**\n * Create a simplified version of this geometry.  For linestrings, this uses\n * the the {@link\n * https://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm\n * Douglas Peucker} algorithm.  For polygons, a quantization-based\n * simplification is used to preserve topology.\n * @function\n * @param {number} tolerance The tolerance distance for simplification.\n * @return {module:ol/geom/Geometry} A new, simplified version of the original\n *     geometry.\n * @api\n */\nGeometry.prototype.simplify = function(tolerance) {\n  return this.getSimplifiedGeometry(tolerance * tolerance);\n};\n\n\n/**\n * Create a simplified version of this geometry using the Douglas Peucker\n * algorithm.\n * @see https://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm\n * @abstract\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/Geometry} Simplified geometry.\n */\nGeometry.prototype.getSimplifiedGeometry = function(squaredTolerance) {};\n\n\n/**\n * Get the type of this geometry.\n * @abstract\n * @return {module:ol/geom/GeometryType} Geometry type.\n */\nGeometry.prototype.getType = function() {};\n\n\n/**\n * Apply a transform function to each coordinate of the geometry.\n * The geometry is modified in place.\n * If you do not want the geometry modified in place, first `clone()` it and\n * then use this function on the clone.\n * @abstract\n * @param {module:ol/proj~TransformFunction} transformFn Transform.\n */\nGeometry.prototype.applyTransform = function(transformFn) {};\n\n\n/**\n * Test if the geometry and the passed extent intersect.\n * @abstract\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} `true` if the geometry and the extent intersect.\n */\nGeometry.prototype.intersectsExtent = function(extent) {};\n\n\n/**\n * Translate the geometry.  This modifies the geometry coordinates in place.  If\n * instead you want a new geometry, first `clone()` this geometry.\n * @abstract\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n */\nGeometry.prototype.translate = function(deltaX, deltaY) {};\n\n\n/**\n * Transform each coordinate of the geometry from one coordinate reference\n * system to another. The geometry is modified in place.\n * For example, a line will be transformed to a line and a circle to a circle.\n * If you do not want the geometry modified in place, first `clone()` it and\n * then use this function on the clone.\n *\n * @param {module:ol/proj~ProjectionLike} source The current projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @param {module:ol/proj~ProjectionLike} destination The desired projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @return {module:ol/geom/Geometry} This geometry.  Note that original geometry is\n *     modified in place.\n * @api\n */\nGeometry.prototype.transform = function(source, destination) {\n  source = getProjection(source);\n  const transformFn = source.getUnits() == Units.TILE_PIXELS ?\n    function(inCoordinates, outCoordinates, stride) {\n      const pixelExtent = source.getExtent();\n      const projectedExtent = source.getWorldExtent();\n      const scale = getHeight(projectedExtent) / getHeight(pixelExtent);\n      composeTransform(tmpTransform,\n        projectedExtent[0], projectedExtent[3],\n        scale, -scale, 0,\n        0, 0);\n      transform2D(inCoordinates, 0, inCoordinates.length, stride,\n        tmpTransform, outCoordinates);\n      return getTransform(source, destination)(inCoordinates, outCoordinates, stride);\n    } :\n    getTransform(source, destination);\n  this.applyTransform(transformFn);\n  return this;\n};\nexport default Geometry;\n","/**\n * @module ol/geom/GeometryCollection\n */\nimport {inherits} from '../index.js';\nimport {listen, unlisten} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {createOrUpdateEmpty, closestSquaredDistanceXY, extend, getCenter} from '../extent.js';\nimport Geometry from '../geom/Geometry.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport {clear} from '../obj.js';\n\n/**\n * @classdesc\n * An array of {@link module:ol/geom/Geometry} objects.\n *\n * @constructor\n * @extends {module:ol/geom/Geometry}\n * @param {Array.<module:ol/geom/Geometry>=} opt_geometries Geometries.\n * @api\n */\nconst GeometryCollection = function(opt_geometries) {\n\n  Geometry.call(this);\n\n  /**\n   * @private\n   * @type {Array.<module:ol/geom/Geometry>}\n   */\n  this.geometries_ = opt_geometries ? opt_geometries : null;\n\n  this.listenGeometriesChange_();\n};\n\ninherits(GeometryCollection, Geometry);\n\n\n/**\n * @param {Array.<module:ol/geom/Geometry>} geometries Geometries.\n * @return {Array.<module:ol/geom/Geometry>} Cloned geometries.\n */\nfunction cloneGeometries(geometries) {\n  const clonedGeometries = [];\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    clonedGeometries.push(geometries[i].clone());\n  }\n  return clonedGeometries;\n}\n\n\n/**\n * @private\n */\nGeometryCollection.prototype.unlistenGeometriesChange_ = function() {\n  if (!this.geometries_) {\n    return;\n  }\n  for (let i = 0, ii = this.geometries_.length; i < ii; ++i) {\n    unlisten(\n      this.geometries_[i], EventType.CHANGE,\n      this.changed, this);\n  }\n};\n\n\n/**\n * @private\n */\nGeometryCollection.prototype.listenGeometriesChange_ = function() {\n  if (!this.geometries_) {\n    return;\n  }\n  for (let i = 0, ii = this.geometries_.length; i < ii; ++i) {\n    listen(\n      this.geometries_[i], EventType.CHANGE,\n      this.changed, this);\n  }\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/GeometryCollection} Clone.\n * @override\n * @api\n */\nGeometryCollection.prototype.clone = function() {\n  const geometryCollection = new GeometryCollection(null);\n  geometryCollection.setGeometries(this.geometries_);\n  return geometryCollection;\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    minSquaredDistance = geometries[i].closestPointXY(\n      x, y, closestPoint, minSquaredDistance);\n  }\n  return minSquaredDistance;\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.containsXY = function(x, y) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    if (geometries[i].containsXY(x, y)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.computeExtent = function(extent) {\n  createOrUpdateEmpty(extent);\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    extend(extent, geometries[i].getExtent());\n  }\n  return extent;\n};\n\n\n/**\n * Return the geometries that make up this geometry collection.\n * @return {Array.<module:ol/geom/Geometry>} Geometries.\n * @api\n */\nGeometryCollection.prototype.getGeometries = function() {\n  return cloneGeometries(this.geometries_);\n};\n\n\n/**\n * @return {Array.<module:ol/geom/Geometry>} Geometries.\n */\nGeometryCollection.prototype.getGeometriesArray = function() {\n  return this.geometries_;\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.getSimplifiedGeometry = function(squaredTolerance) {\n  if (this.simplifiedGeometryRevision != this.getRevision()) {\n    clear(this.simplifiedGeometryCache);\n    this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n    this.simplifiedGeometryRevision = this.getRevision();\n  }\n  if (squaredTolerance < 0 ||\n      (this.simplifiedGeometryMaxMinSquaredTolerance !== 0 &&\n       squaredTolerance < this.simplifiedGeometryMaxMinSquaredTolerance)) {\n    return this;\n  }\n  const key = squaredTolerance.toString();\n  if (this.simplifiedGeometryCache.hasOwnProperty(key)) {\n    return this.simplifiedGeometryCache[key];\n  } else {\n    const simplifiedGeometries = [];\n    const geometries = this.geometries_;\n    let simplified = false;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      const geometry = geometries[i];\n      const simplifiedGeometry = geometry.getSimplifiedGeometry(squaredTolerance);\n      simplifiedGeometries.push(simplifiedGeometry);\n      if (simplifiedGeometry !== geometry) {\n        simplified = true;\n      }\n    }\n    if (simplified) {\n      const simplifiedGeometryCollection = new GeometryCollection(null);\n      simplifiedGeometryCollection.setGeometriesArray(simplifiedGeometries);\n      this.simplifiedGeometryCache[key] = simplifiedGeometryCollection;\n      return simplifiedGeometryCollection;\n    } else {\n      this.simplifiedGeometryMaxMinSquaredTolerance = squaredTolerance;\n      return this;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.getType = function() {\n  return GeometryType.GEOMETRY_COLLECTION;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.intersectsExtent = function(extent) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    if (geometries[i].intersectsExtent(extent)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * @return {boolean} Is empty.\n */\nGeometryCollection.prototype.isEmpty = function() {\n  return this.geometries_.length === 0;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.rotate = function(angle, anchor) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    geometries[i].rotate(angle, anchor);\n  }\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.scale = function(sx, opt_sy, opt_anchor) {\n  let anchor = opt_anchor;\n  if (!anchor) {\n    anchor = getCenter(this.getExtent());\n  }\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    geometries[i].scale(sx, opt_sy, anchor);\n  }\n  this.changed();\n};\n\n\n/**\n * Set the geometries that make up this geometry collection.\n * @param {Array.<module:ol/geom/Geometry>} geometries Geometries.\n * @api\n */\nGeometryCollection.prototype.setGeometries = function(geometries) {\n  this.setGeometriesArray(cloneGeometries(geometries));\n};\n\n\n/**\n * @param {Array.<module:ol/geom/Geometry>} geometries Geometries.\n */\nGeometryCollection.prototype.setGeometriesArray = function(geometries) {\n  this.unlistenGeometriesChange_();\n  this.geometries_ = geometries;\n  this.listenGeometriesChange_();\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.applyTransform = function(transformFn) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    geometries[i].applyTransform(transformFn);\n  }\n  this.changed();\n};\n\n\n/**\n * Translate the geometry.\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n * @override\n * @api\n */\nGeometryCollection.prototype.translate = function(deltaX, deltaY) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    geometries[i].translate(deltaX, deltaY);\n  }\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.disposeInternal = function() {\n  this.unlistenGeometriesChange_();\n  Geometry.prototype.disposeInternal.call(this);\n};\nexport default GeometryCollection;\n","/**\n * @module ol/geom/GeometryLayout\n */\n\n/**\n * The coordinate layout for geometries, indicating whether a 3rd or 4th z ('Z')\n * or measure ('M') coordinate is available. Supported values are `'XY'`,\n * `'XYZ'`, `'XYM'`, `'XYZM'`.\n * @enum {string}\n */\nexport default {\n  XY: 'XY',\n  XYZ: 'XYZ',\n  XYM: 'XYM',\n  XYZM: 'XYZM'\n};\n","/**\n * @module ol/geom/GeometryType\n */\n\n/**\n * The geometry type. One of `'Point'`, `'LineString'`, `'LinearRing'`,\n * `'Polygon'`, `'MultiPoint'`, `'MultiLineString'`, `'MultiPolygon'`,\n * `'GeometryCollection'`, `'Circle'`.\n * @enum {string}\n */\nexport default {\n  POINT: 'Point',\n  LINE_STRING: 'LineString',\n  LINEAR_RING: 'LinearRing',\n  POLYGON: 'Polygon',\n  MULTI_POINT: 'MultiPoint',\n  MULTI_LINE_STRING: 'MultiLineString',\n  MULTI_POLYGON: 'MultiPolygon',\n  GEOMETRY_COLLECTION: 'GeometryCollection',\n  CIRCLE: 'Circle'\n};\n","/**\n * @module ol/geom/LineString\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {assignClosestPoint, maxSquaredDelta} from '../geom/flat/closest.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {interpolatePoint, lineStringCoordinateAtM} from '../geom/flat/interpolate.js';\nimport {intersectsLineString} from '../geom/flat/intersectsextent.js';\nimport {lineStringLength} from '../geom/flat/length.js';\nimport {forEach as forEachSegment} from '../geom/flat/segments.js';\nimport {douglasPeucker} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Linestring geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst LineString = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.flatMidpoint_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.flatMidpointRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(LineString, SimpleGeometry);\n\n\n/**\n * Append the passed coordinate to the coordinates of the linestring.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @api\n */\nLineString.prototype.appendCoordinate = function(coordinate) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = coordinate.slice();\n  } else {\n    extend(this.flatCoordinates, coordinate);\n  }\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/LineString} Clone.\n * @override\n * @api\n */\nLineString.prototype.clone = function() {\n  const lineString = new LineString(null);\n  lineString.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return lineString;\n};\n\n\n/**\n * @inheritDoc\n */\nLineString.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(maxSquaredDelta(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestPoint(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    this.maxDelta_, false, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * Iterate over each segment, calling the provided callback.\n * If the callback returns a truthy value the function returns that\n * value immediately. Otherwise the function returns `false`.\n *\n * @param {function(this: S, module:ol/coordinate~Coordinate, module:ol/coordinate~Coordinate): T} callback Function\n *     called for each segment.\n * @return {T|boolean} Value.\n * @template T,S\n * @api\n */\nLineString.prototype.forEachSegment = function(callback) {\n  return forEachSegment(this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, callback);\n};\n\n\n/**\n * Returns the coordinate at `m` using linear interpolation, or `null` if no\n * such coordinate exists.\n *\n * `opt_extrapolate` controls extrapolation beyond the range of Ms in the\n * MultiLineString. If `opt_extrapolate` is `true` then Ms less than the first\n * M will return the first coordinate and Ms greater than the last M will\n * return the last coordinate.\n *\n * @param {number} m M.\n * @param {boolean=} opt_extrapolate Extrapolate. Default is `false`.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nLineString.prototype.getCoordinateAtM = function(m, opt_extrapolate) {\n  if (this.layout != GeometryLayout.XYM &&\n      this.layout != GeometryLayout.XYZM) {\n    return null;\n  }\n  const extrapolate = opt_extrapolate !== undefined ? opt_extrapolate : false;\n  return lineStringCoordinateAtM(this.flatCoordinates, 0,\n    this.flatCoordinates.length, this.stride, m, extrapolate);\n};\n\n\n/**\n * Return the coordinates of the linestring.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n * @override\n * @api\n */\nLineString.prototype.getCoordinates = function() {\n  return inflateCoordinates(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * Return the coordinate at the provided fraction along the linestring.\n * The `fraction` is a number between 0 and 1, where 0 is the start of the\n * linestring and 1 is the end.\n * @param {number} fraction Fraction.\n * @param {module:ol/coordinate~Coordinate=} opt_dest Optional coordinate whose values will\n *     be modified. If not provided, a new coordinate will be returned.\n * @return {module:ol/coordinate~Coordinate} Coordinate of the interpolated point.\n * @api\n */\nLineString.prototype.getCoordinateAt = function(fraction, opt_dest) {\n  return interpolatePoint(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    fraction, opt_dest);\n};\n\n\n/**\n * Return the length of the linestring on projected plane.\n * @return {number} Length (on projected plane).\n * @api\n */\nLineString.prototype.getLength = function() {\n  return lineStringLength(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Flat midpoint.\n */\nLineString.prototype.getFlatMidpoint = function() {\n  if (this.flatMidpointRevision_ != this.getRevision()) {\n    this.flatMidpoint_ = this.getCoordinateAt(0.5, this.flatMidpoint_);\n    this.flatMidpointRevision_ = this.getRevision();\n  }\n  return this.flatMidpoint_;\n};\n\n\n/**\n * @inheritDoc\n */\nLineString.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    squaredTolerance, simplifiedFlatCoordinates, 0);\n  const simplifiedLineString = new LineString(null);\n  simplifiedLineString.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates);\n  return simplifiedLineString;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nLineString.prototype.getType = function() {\n  return GeometryType.LINE_STRING;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nLineString.prototype.intersectsExtent = function(extent) {\n  return intersectsLineString(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    extent);\n};\n\n\n/**\n * Set the coordinates of the linestring.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nLineString.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nLineString.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default LineString;\n","/**\n * @module ol/geom/LinearRing\n */\nimport {inherits} from '../index.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {linearRing as linearRingArea} from '../geom/flat/area.js';\nimport {assignClosestPoint, maxSquaredDelta} from '../geom/flat/closest.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {douglasPeucker} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Linear ring geometry. Only used as part of polygon; cannot be rendered\n * on its own.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst LinearRing = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(LinearRing, SimpleGeometry);\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/LinearRing} Clone.\n * @override\n * @api\n */\nLinearRing.prototype.clone = function() {\n  const linearRing = new LinearRing(null);\n  linearRing.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return linearRing;\n};\n\n\n/**\n * @inheritDoc\n */\nLinearRing.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(maxSquaredDelta(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestPoint(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * Return the area of the linear ring on projected plane.\n * @return {number} Area (on projected plane).\n * @api\n */\nLinearRing.prototype.getArea = function() {\n  return linearRingArea(this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * Return the coordinates of the linear ring.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n * @override\n * @api\n */\nLinearRing.prototype.getCoordinates = function() {\n  return inflateCoordinates(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * @inheritDoc\n */\nLinearRing.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    squaredTolerance, simplifiedFlatCoordinates, 0);\n  const simplifiedLinearRing = new LinearRing(null);\n  simplifiedLinearRing.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates);\n  return simplifiedLinearRing;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nLinearRing.prototype.getType = function() {\n  return GeometryType.LINEAR_RING;\n};\n\n\n/**\n * @inheritDoc\n */\nLinearRing.prototype.intersectsExtent = function(extent) {};\n\n\n/**\n * Set the coordinates of the linear ring.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nLinearRing.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nLinearRing.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default LinearRing;\n","/**\n * @module ol/geom/MultiLineString\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {assignClosestArrayPoint, arrayMaxSquaredDelta} from '../geom/flat/closest.js';\nimport {deflateCoordinatesArray} from '../geom/flat/deflate.js';\nimport {inflateCoordinatesArray} from '../geom/flat/inflate.js';\nimport {interpolatePoint, lineStringsCoordinateAtM} from '../geom/flat/interpolate.js';\nimport {intersectsLineStringArray} from '../geom/flat/intersectsextent.js';\nimport {douglasPeuckerArray} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Multi-linestring geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst MultiLineString = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.ends_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(MultiLineString, SimpleGeometry);\n\n\n/**\n * Append the passed linestring to the multilinestring.\n * @param {module:ol/geom/LineString} lineString LineString.\n * @api\n */\nMultiLineString.prototype.appendLineString = function(lineString) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = lineString.getFlatCoordinates().slice();\n  } else {\n    extend(this.flatCoordinates, lineString.getFlatCoordinates().slice());\n  }\n  this.ends_.push(this.flatCoordinates.length);\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/MultiLineString} Clone.\n * @override\n * @api\n */\nMultiLineString.prototype.clone = function() {\n  const multiLineString = new MultiLineString(null);\n  multiLineString.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(), this.ends_.slice());\n  return multiLineString;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiLineString.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(arrayMaxSquaredDelta(\n      this.flatCoordinates, 0, this.ends_, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestArrayPoint(\n    this.flatCoordinates, 0, this.ends_, this.stride,\n    this.maxDelta_, false, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * Returns the coordinate at `m` using linear interpolation, or `null` if no\n * such coordinate exists.\n *\n * `opt_extrapolate` controls extrapolation beyond the range of Ms in the\n * MultiLineString. If `opt_extrapolate` is `true` then Ms less than the first\n * M will return the first coordinate and Ms greater than the last M will\n * return the last coordinate.\n *\n * `opt_interpolate` controls interpolation between consecutive LineStrings\n * within the MultiLineString. If `opt_interpolate` is `true` the coordinates\n * will be linearly interpolated between the last coordinate of one LineString\n * and the first coordinate of the next LineString.  If `opt_interpolate` is\n * `false` then the function will return `null` for Ms falling between\n * LineStrings.\n *\n * @param {number} m M.\n * @param {boolean=} opt_extrapolate Extrapolate. Default is `false`.\n * @param {boolean=} opt_interpolate Interpolate. Default is `false`.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nMultiLineString.prototype.getCoordinateAtM = function(m, opt_extrapolate, opt_interpolate) {\n  if ((this.layout != GeometryLayout.XYM &&\n       this.layout != GeometryLayout.XYZM) ||\n      this.flatCoordinates.length === 0) {\n    return null;\n  }\n  const extrapolate = opt_extrapolate !== undefined ? opt_extrapolate : false;\n  const interpolate = opt_interpolate !== undefined ? opt_interpolate : false;\n  return lineStringsCoordinateAtM(this.flatCoordinates, 0,\n    this.ends_, this.stride, m, extrapolate, interpolate);\n};\n\n\n/**\n * Return the coordinates of the multilinestring.\n * @return {Array.<Array.<module:ol/coordinate~Coordinate>>} Coordinates.\n * @override\n * @api\n */\nMultiLineString.prototype.getCoordinates = function() {\n  return inflateCoordinatesArray(\n    this.flatCoordinates, 0, this.ends_, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Ends.\n */\nMultiLineString.prototype.getEnds = function() {\n  return this.ends_;\n};\n\n\n/**\n * Return the linestring at the specified index.\n * @param {number} index Index.\n * @return {module:ol/geom/LineString} LineString.\n * @api\n */\nMultiLineString.prototype.getLineString = function(index) {\n  if (index < 0 || this.ends_.length <= index) {\n    return null;\n  }\n  const lineString = new LineString(null);\n  lineString.setFlatCoordinates(this.layout, this.flatCoordinates.slice(\n    index === 0 ? 0 : this.ends_[index - 1], this.ends_[index]));\n  return lineString;\n};\n\n\n/**\n * Return the linestrings of this multilinestring.\n * @return {Array.<module:ol/geom/LineString>} LineStrings.\n * @api\n */\nMultiLineString.prototype.getLineStrings = function() {\n  const flatCoordinates = this.flatCoordinates;\n  const ends = this.ends_;\n  const layout = this.layout;\n  /** @type {Array.<module:ol/geom/LineString>} */\n  const lineStrings = [];\n  let offset = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const lineString = new LineString(null);\n    lineString.setFlatCoordinates(layout, flatCoordinates.slice(offset, end));\n    lineStrings.push(lineString);\n    offset = end;\n  }\n  return lineStrings;\n};\n\n\n/**\n * @return {Array.<number>} Flat midpoints.\n */\nMultiLineString.prototype.getFlatMidpoints = function() {\n  const midpoints = [];\n  const flatCoordinates = this.flatCoordinates;\n  let offset = 0;\n  const ends = this.ends_;\n  const stride = this.stride;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const midpoint = interpolatePoint(\n      flatCoordinates, offset, end, stride, 0.5);\n    extend(midpoints, midpoint);\n    offset = end;\n  }\n  return midpoints;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiLineString.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  const simplifiedEnds = [];\n  simplifiedFlatCoordinates.length = douglasPeuckerArray(\n    this.flatCoordinates, 0, this.ends_, this.stride, squaredTolerance,\n    simplifiedFlatCoordinates, 0, simplifiedEnds);\n  const simplifiedMultiLineString = new MultiLineString(null);\n  simplifiedMultiLineString.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates, simplifiedEnds);\n  return simplifiedMultiLineString;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiLineString.prototype.getType = function() {\n  return GeometryType.MULTI_LINE_STRING;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiLineString.prototype.intersectsExtent = function(extent) {\n  return intersectsLineStringArray(\n    this.flatCoordinates, 0, this.ends_, this.stride, extent);\n};\n\n\n/**\n * Set the coordinates of the multilinestring.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nMultiLineString.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null, this.ends_);\n  } else {\n    this.setLayout(opt_layout, coordinates, 2);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const ends = deflateCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.ends_);\n    this.flatCoordinates.length = ends.length === 0 ? 0 : ends[ends.length - 1];\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<number>} ends Ends.\n */\nMultiLineString.prototype.setFlatCoordinates = function(layout, flatCoordinates, ends) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.ends_ = ends;\n  this.changed();\n};\n\n\n/**\n * @param {Array.<module:ol/geom/LineString>} lineStrings LineStrings.\n */\nMultiLineString.prototype.setLineStrings = function(lineStrings) {\n  let layout = this.getLayout();\n  const flatCoordinates = [];\n  const ends = [];\n  for (let i = 0, ii = lineStrings.length; i < ii; ++i) {\n    const lineString = lineStrings[i];\n    if (i === 0) {\n      layout = lineString.getLayout();\n    }\n    extend(flatCoordinates, lineString.getFlatCoordinates());\n    ends.push(flatCoordinates.length);\n  }\n  this.setFlatCoordinates(layout, flatCoordinates, ends);\n};\nexport default MultiLineString;\n","/**\n * @module ol/geom/MultiPoint\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY, containsXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {squaredDistance as squaredDx} from '../math.js';\n\n/**\n * @classdesc\n * Multi-point geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst MultiPoint = function(coordinates, opt_layout) {\n  SimpleGeometry.call(this);\n  this.setCoordinates(coordinates, opt_layout);\n};\n\ninherits(MultiPoint, SimpleGeometry);\n\n\n/**\n * Append the passed point to this multipoint.\n * @param {module:ol/geom/Point} point Point.\n * @api\n */\nMultiPoint.prototype.appendPoint = function(point) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = point.getFlatCoordinates().slice();\n  } else {\n    extend(this.flatCoordinates, point.getFlatCoordinates());\n  }\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/MultiPoint} Clone.\n * @override\n * @api\n */\nMultiPoint.prototype.clone = function() {\n  const multiPoint = new MultiPoint(null);\n  multiPoint.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return multiPoint;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPoint.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  const flatCoordinates = this.flatCoordinates;\n  const stride = this.stride;\n  for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n    const squaredDistance = squaredDx(\n      x, y, flatCoordinates[i], flatCoordinates[i + 1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (let j = 0; j < stride; ++j) {\n        closestPoint[j] = flatCoordinates[i + j];\n      }\n      closestPoint.length = stride;\n    }\n  }\n  return minSquaredDistance;\n};\n\n\n/**\n * Return the coordinates of the multipoint.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n * @override\n * @api\n */\nMultiPoint.prototype.getCoordinates = function() {\n  return inflateCoordinates(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * Return the point at the specified index.\n * @param {number} index Index.\n * @return {module:ol/geom/Point} Point.\n * @api\n */\nMultiPoint.prototype.getPoint = function(index) {\n  const n = !this.flatCoordinates ? 0 : this.flatCoordinates.length / this.stride;\n  if (index < 0 || n <= index) {\n    return null;\n  }\n  const point = new Point(null);\n  point.setFlatCoordinates(this.layout, this.flatCoordinates.slice(\n    index * this.stride, (index + 1) * this.stride));\n  return point;\n};\n\n\n/**\n * Return the points of this multipoint.\n * @return {Array.<module:ol/geom/Point>} Points.\n * @api\n */\nMultiPoint.prototype.getPoints = function() {\n  const flatCoordinates = this.flatCoordinates;\n  const layout = this.layout;\n  const stride = this.stride;\n  /** @type {Array.<module:ol/geom/Point>} */\n  const points = [];\n  for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n    const point = new Point(null);\n    point.setFlatCoordinates(layout, flatCoordinates.slice(i, i + stride));\n    points.push(point);\n  }\n  return points;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPoint.prototype.getType = function() {\n  return GeometryType.MULTI_POINT;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPoint.prototype.intersectsExtent = function(extent) {\n  const flatCoordinates = this.flatCoordinates;\n  const stride = this.stride;\n  for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n    const x = flatCoordinates[i];\n    const y = flatCoordinates[i + 1];\n    if (containsXY(extent, x, y)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Set the coordinates of the multipoint.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nMultiPoint.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nMultiPoint.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default MultiPoint;\n","/**\n * @module ol/geom/MultiPolygon\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport Polygon from '../geom/Polygon.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {linearRingss as linearRingssArea} from '../geom/flat/area.js';\nimport {linearRingss as linearRingssCenter} from '../geom/flat/center.js';\nimport {assignClosestMultiArrayPoint, multiArrayMaxSquaredDelta} from '../geom/flat/closest.js';\nimport {linearRingssContainsXY} from '../geom/flat/contains.js';\nimport {deflateMultiCoordinatesArray} from '../geom/flat/deflate.js';\nimport {inflateMultiCoordinatesArray} from '../geom/flat/inflate.js';\nimport {getInteriorPointsOfMultiArray} from '../geom/flat/interiorpoint.js';\nimport {intersectsLinearRingMultiArray} from '../geom/flat/intersectsextent.js';\nimport {linearRingsAreOriented, orientLinearRingsArray} from '../geom/flat/orient.js';\nimport {quantizeMultiArray} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Multi-polygon geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst MultiPolygon = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @type {Array.<Array.<number>>}\n   * @private\n   */\n  this.endss_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.flatInteriorPointsRevision_ = -1;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.flatInteriorPoints_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.orientedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.orientedFlatCoordinates_ = null;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(MultiPolygon, SimpleGeometry);\n\n\n/**\n * Append the passed polygon to this multipolygon.\n * @param {module:ol/geom/Polygon} polygon Polygon.\n * @api\n */\nMultiPolygon.prototype.appendPolygon = function(polygon) {\n  /** @type {Array.<number>} */\n  let ends;\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = polygon.getFlatCoordinates().slice();\n    ends = polygon.getEnds().slice();\n    this.endss_.push();\n  } else {\n    const offset = this.flatCoordinates.length;\n    extend(this.flatCoordinates, polygon.getFlatCoordinates());\n    ends = polygon.getEnds().slice();\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      ends[i] += offset;\n    }\n  }\n  this.endss_.push(ends);\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/MultiPolygon} Clone.\n * @override\n * @api\n */\nMultiPolygon.prototype.clone = function() {\n  const multiPolygon = new MultiPolygon(null);\n\n  const len = this.endss_.length;\n  const newEndss = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    newEndss[i] = this.endss_[i].slice();\n  }\n\n  multiPolygon.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(), newEndss);\n  return multiPolygon;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPolygon.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(multiArrayMaxSquaredDelta(\n      this.flatCoordinates, 0, this.endss_, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestMultiArrayPoint(\n    this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride,\n    this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPolygon.prototype.containsXY = function(x, y) {\n  return linearRingssContainsXY(this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride, x, y);\n};\n\n\n/**\n * Return the area of the multipolygon on projected plane.\n * @return {number} Area (on projected plane).\n * @api\n */\nMultiPolygon.prototype.getArea = function() {\n  return linearRingssArea(this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride);\n};\n\n\n/**\n * Get the coordinate array for this geometry.  This array has the structure\n * of a GeoJSON coordinate array for multi-polygons.\n *\n * @param {boolean=} opt_right Orient coordinates according to the right-hand\n *     rule (counter-clockwise for exterior and clockwise for interior rings).\n *     If `false`, coordinates will be oriented according to the left-hand rule\n *     (clockwise for exterior and counter-clockwise for interior rings).\n *     By default, coordinate orientation will depend on how the geometry was\n *     constructed.\n * @return {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} Coordinates.\n * @override\n * @api\n */\nMultiPolygon.prototype.getCoordinates = function(opt_right) {\n  let flatCoordinates;\n  if (opt_right !== undefined) {\n    flatCoordinates = this.getOrientedFlatCoordinates().slice();\n    orientLinearRingsArray(\n      flatCoordinates, 0, this.endss_, this.stride, opt_right);\n  } else {\n    flatCoordinates = this.flatCoordinates;\n  }\n\n  return inflateMultiCoordinatesArray(\n    flatCoordinates, 0, this.endss_, this.stride);\n};\n\n\n/**\n * @return {Array.<Array.<number>>} Endss.\n */\nMultiPolygon.prototype.getEndss = function() {\n  return this.endss_;\n};\n\n\n/**\n * @return {Array.<number>} Flat interior points.\n */\nMultiPolygon.prototype.getFlatInteriorPoints = function() {\n  if (this.flatInteriorPointsRevision_ != this.getRevision()) {\n    const flatCenters = linearRingssCenter(\n      this.flatCoordinates, 0, this.endss_, this.stride);\n    this.flatInteriorPoints_ = getInteriorPointsOfMultiArray(\n      this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride,\n      flatCenters);\n    this.flatInteriorPointsRevision_ = this.getRevision();\n  }\n  return this.flatInteriorPoints_;\n};\n\n\n/**\n * Return the interior points as {@link module:ol/geom/MultiPoint multipoint}.\n * @return {module:ol/geom/MultiPoint} Interior points as XYM coordinates, where M is\n * the length of the horizontal intersection that the point belongs to.\n * @api\n */\nMultiPolygon.prototype.getInteriorPoints = function() {\n  const interiorPoints = new MultiPoint(null);\n  interiorPoints.setFlatCoordinates(GeometryLayout.XYM,\n    this.getFlatInteriorPoints().slice());\n  return interiorPoints;\n};\n\n\n/**\n * @return {Array.<number>} Oriented flat coordinates.\n */\nMultiPolygon.prototype.getOrientedFlatCoordinates = function() {\n  if (this.orientedRevision_ != this.getRevision()) {\n    const flatCoordinates = this.flatCoordinates;\n    if (linearRingsAreOriented(\n      flatCoordinates, 0, this.endss_, this.stride)) {\n      this.orientedFlatCoordinates_ = flatCoordinates;\n    } else {\n      this.orientedFlatCoordinates_ = flatCoordinates.slice();\n      this.orientedFlatCoordinates_.length =\n          orientLinearRingsArray(\n            this.orientedFlatCoordinates_, 0, this.endss_, this.stride);\n    }\n    this.orientedRevision_ = this.getRevision();\n  }\n  return this.orientedFlatCoordinates_;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPolygon.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  const simplifiedEndss = [];\n  simplifiedFlatCoordinates.length = quantizeMultiArray(\n    this.flatCoordinates, 0, this.endss_, this.stride,\n    Math.sqrt(squaredTolerance),\n    simplifiedFlatCoordinates, 0, simplifiedEndss);\n  const simplifiedMultiPolygon = new MultiPolygon(null);\n  simplifiedMultiPolygon.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates, simplifiedEndss);\n  return simplifiedMultiPolygon;\n};\n\n\n/**\n * Return the polygon at the specified index.\n * @param {number} index Index.\n * @return {module:ol/geom/Polygon} Polygon.\n * @api\n */\nMultiPolygon.prototype.getPolygon = function(index) {\n  if (index < 0 || this.endss_.length <= index) {\n    return null;\n  }\n  let offset;\n  if (index === 0) {\n    offset = 0;\n  } else {\n    const prevEnds = this.endss_[index - 1];\n    offset = prevEnds[prevEnds.length - 1];\n  }\n  const ends = this.endss_[index].slice();\n  const end = ends[ends.length - 1];\n  if (offset !== 0) {\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      ends[i] -= offset;\n    }\n  }\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(offset, end), ends);\n  return polygon;\n};\n\n\n/**\n * Return the polygons of this multipolygon.\n * @return {Array.<module:ol/geom/Polygon>} Polygons.\n * @api\n */\nMultiPolygon.prototype.getPolygons = function() {\n  const layout = this.layout;\n  const flatCoordinates = this.flatCoordinates;\n  const endss = this.endss_;\n  const polygons = [];\n  let offset = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i].slice();\n    const end = ends[ends.length - 1];\n    if (offset !== 0) {\n      for (let j = 0, jj = ends.length; j < jj; ++j) {\n        ends[j] -= offset;\n      }\n    }\n    const polygon = new Polygon(null);\n    polygon.setFlatCoordinates(\n      layout, flatCoordinates.slice(offset, end), ends);\n    polygons.push(polygon);\n    offset = end;\n  }\n  return polygons;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPolygon.prototype.getType = function() {\n  return GeometryType.MULTI_POLYGON;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPolygon.prototype.intersectsExtent = function(extent) {\n  return intersectsLinearRingMultiArray(\n    this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride, extent);\n};\n\n\n/**\n * Set the coordinates of the multipolygon.\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nMultiPolygon.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null, this.endss_);\n  } else {\n    this.setLayout(opt_layout, coordinates, 3);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const endss = deflateMultiCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.endss_);\n    if (endss.length === 0) {\n      this.flatCoordinates.length = 0;\n    } else {\n      const lastEnds = endss[endss.length - 1];\n      this.flatCoordinates.length = lastEnds.length === 0 ?\n        0 : lastEnds[lastEnds.length - 1];\n    }\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<Array.<number>>} endss Endss.\n */\nMultiPolygon.prototype.setFlatCoordinates = function(layout, flatCoordinates, endss) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.endss_ = endss;\n  this.changed();\n};\n\n\n/**\n * @param {Array.<module:ol/geom/Polygon>} polygons Polygons.\n */\nMultiPolygon.prototype.setPolygons = function(polygons) {\n  let layout = this.getLayout();\n  const flatCoordinates = [];\n  const endss = [];\n  for (let i = 0, ii = polygons.length; i < ii; ++i) {\n    const polygon = polygons[i];\n    if (i === 0) {\n      layout = polygon.getLayout();\n    }\n    const offset = flatCoordinates.length;\n    const ends = polygon.getEnds();\n    for (let j = 0, jj = ends.length; j < jj; ++j) {\n      ends[j] += offset;\n    }\n    extend(flatCoordinates, polygon.getFlatCoordinates());\n    endss.push(ends);\n  }\n  this.setFlatCoordinates(layout, flatCoordinates, endss);\n};\n\nexport default MultiPolygon;\n","/**\n * @module ol/geom/Point\n */\nimport {inherits} from '../index.js';\nimport {createOrUpdateFromCoordinate, containsXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {deflateCoordinate} from '../geom/flat/deflate.js';\nimport {squaredDistance as squaredDx} from '../math.js';\n\n/**\n * @classdesc\n * Point geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {module:ol/coordinate~Coordinate} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst Point = function(coordinates, opt_layout) {\n  SimpleGeometry.call(this);\n  this.setCoordinates(coordinates, opt_layout);\n};\n\ninherits(Point, SimpleGeometry);\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/Point} Clone.\n * @override\n * @api\n */\nPoint.prototype.clone = function() {\n  const point = new Point(null);\n  point.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return point;\n};\n\n\n/**\n * @inheritDoc\n */\nPoint.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  const flatCoordinates = this.flatCoordinates;\n  const squaredDistance = squaredDx(x, y, flatCoordinates[0], flatCoordinates[1]);\n  if (squaredDistance < minSquaredDistance) {\n    const stride = this.stride;\n    for (let i = 0; i < stride; ++i) {\n      closestPoint[i] = flatCoordinates[i];\n    }\n    closestPoint.length = stride;\n    return squaredDistance;\n  } else {\n    return minSquaredDistance;\n  }\n};\n\n\n/**\n * Return the coordinate of the point.\n * @return {module:ol/coordinate~Coordinate} Coordinates.\n * @override\n * @api\n */\nPoint.prototype.getCoordinates = function() {\n  return !this.flatCoordinates ? [] : this.flatCoordinates.slice();\n};\n\n\n/**\n * @inheritDoc\n */\nPoint.prototype.computeExtent = function(extent) {\n  return createOrUpdateFromCoordinate(this.flatCoordinates, extent);\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPoint.prototype.getType = function() {\n  return GeometryType.POINT;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPoint.prototype.intersectsExtent = function(extent) {\n  return containsXY(extent, this.flatCoordinates[0], this.flatCoordinates[1]);\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPoint.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 0);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinate(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nPoint.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default Point;\n","/**\n * @module ol/geom/Polygon\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY, getCenter} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LinearRing from '../geom/LinearRing.js';\nimport Point from '../geom/Point.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {offset as sphereOffset} from '../sphere.js';\nimport {linearRings as linearRingsArea} from '../geom/flat/area.js';\nimport {assignClosestArrayPoint, arrayMaxSquaredDelta} from '../geom/flat/closest.js';\nimport {linearRingsContainsXY} from '../geom/flat/contains.js';\nimport {deflateCoordinatesArray} from '../geom/flat/deflate.js';\nimport {inflateCoordinatesArray} from '../geom/flat/inflate.js';\nimport {getInteriorPointOfArray} from '../geom/flat/interiorpoint.js';\nimport {intersectsLinearRingArray} from '../geom/flat/intersectsextent.js';\nimport {linearRingIsOriented, orientLinearRings} from '../geom/flat/orient.js';\nimport {quantizeArray} from '../geom/flat/simplify.js';\nimport {modulo} from '../math.js';\n\n/**\n * @classdesc\n * Polygon geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Array of linear\n *     rings that define the polygon. The first linear ring of the array\n *     defines the outer-boundary or surface of the polygon. Each subsequent\n *     linear ring defines a hole in the surface of the polygon. A linear ring\n *     is an array of vertices' coordinates where the first coordinate and the\n *     last are equivalent.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst Polygon = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.ends_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.flatInteriorPointRevision_ = -1;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.flatInteriorPoint_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.orientedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.orientedFlatCoordinates_ = null;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(Polygon, SimpleGeometry);\n\n\n/**\n * Append the passed linear ring to this polygon.\n * @param {module:ol/geom/LinearRing} linearRing Linear ring.\n * @api\n */\nPolygon.prototype.appendLinearRing = function(linearRing) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = linearRing.getFlatCoordinates().slice();\n  } else {\n    extend(this.flatCoordinates, linearRing.getFlatCoordinates());\n  }\n  this.ends_.push(this.flatCoordinates.length);\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/Polygon} Clone.\n * @override\n * @api\n */\nPolygon.prototype.clone = function() {\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(), this.ends_.slice());\n  return polygon;\n};\n\n\n/**\n * @inheritDoc\n */\nPolygon.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(arrayMaxSquaredDelta(\n      this.flatCoordinates, 0, this.ends_, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestArrayPoint(\n    this.flatCoordinates, 0, this.ends_, this.stride,\n    this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * @inheritDoc\n */\nPolygon.prototype.containsXY = function(x, y) {\n  return linearRingsContainsXY(this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride, x, y);\n};\n\n\n/**\n * Return the area of the polygon on projected plane.\n * @return {number} Area (on projected plane).\n * @api\n */\nPolygon.prototype.getArea = function() {\n  return linearRingsArea(this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride);\n};\n\n\n/**\n * Get the coordinate array for this geometry.  This array has the structure\n * of a GeoJSON coordinate array for polygons.\n *\n * @param {boolean=} opt_right Orient coordinates according to the right-hand\n *     rule (counter-clockwise for exterior and clockwise for interior rings).\n *     If `false`, coordinates will be oriented according to the left-hand rule\n *     (clockwise for exterior and counter-clockwise for interior rings).\n *     By default, coordinate orientation will depend on how the geometry was\n *     constructed.\n * @return {Array.<Array.<module:ol/coordinate~Coordinate>>} Coordinates.\n * @override\n * @api\n */\nPolygon.prototype.getCoordinates = function(opt_right) {\n  let flatCoordinates;\n  if (opt_right !== undefined) {\n    flatCoordinates = this.getOrientedFlatCoordinates().slice();\n    orientLinearRings(\n      flatCoordinates, 0, this.ends_, this.stride, opt_right);\n  } else {\n    flatCoordinates = this.flatCoordinates;\n  }\n\n  return inflateCoordinatesArray(\n    flatCoordinates, 0, this.ends_, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Ends.\n */\nPolygon.prototype.getEnds = function() {\n  return this.ends_;\n};\n\n\n/**\n * @return {Array.<number>} Interior point.\n */\nPolygon.prototype.getFlatInteriorPoint = function() {\n  if (this.flatInteriorPointRevision_ != this.getRevision()) {\n    const flatCenter = getCenter(this.getExtent());\n    this.flatInteriorPoint_ = getInteriorPointOfArray(\n      this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride,\n      flatCenter, 0);\n    this.flatInteriorPointRevision_ = this.getRevision();\n  }\n  return this.flatInteriorPoint_;\n};\n\n\n/**\n * Return an interior point of the polygon.\n * @return {module:ol/geom/Point} Interior point as XYM coordinate, where M is the\n * length of the horizontal intersection that the point belongs to.\n * @api\n */\nPolygon.prototype.getInteriorPoint = function() {\n  return new Point(this.getFlatInteriorPoint(), GeometryLayout.XYM);\n};\n\n\n/**\n * Return the number of rings of the polygon,  this includes the exterior\n * ring and any interior rings.\n *\n * @return {number} Number of rings.\n * @api\n */\nPolygon.prototype.getLinearRingCount = function() {\n  return this.ends_.length;\n};\n\n\n/**\n * Return the Nth linear ring of the polygon geometry. Return `null` if the\n * given index is out of range.\n * The exterior linear ring is available at index `0` and the interior rings\n * at index `1` and beyond.\n *\n * @param {number} index Index.\n * @return {module:ol/geom/LinearRing} Linear ring.\n * @api\n */\nPolygon.prototype.getLinearRing = function(index) {\n  if (index < 0 || this.ends_.length <= index) {\n    return null;\n  }\n  const linearRing = new LinearRing(null);\n  linearRing.setFlatCoordinates(this.layout, this.flatCoordinates.slice(\n    index === 0 ? 0 : this.ends_[index - 1], this.ends_[index]));\n  return linearRing;\n};\n\n\n/**\n * Return the linear rings of the polygon.\n * @return {Array.<module:ol/geom/LinearRing>} Linear rings.\n * @api\n */\nPolygon.prototype.getLinearRings = function() {\n  const layout = this.layout;\n  const flatCoordinates = this.flatCoordinates;\n  const ends = this.ends_;\n  const linearRings = [];\n  let offset = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const linearRing = new LinearRing(null);\n    linearRing.setFlatCoordinates(layout, flatCoordinates.slice(offset, end));\n    linearRings.push(linearRing);\n    offset = end;\n  }\n  return linearRings;\n};\n\n\n/**\n * @return {Array.<number>} Oriented flat coordinates.\n */\nPolygon.prototype.getOrientedFlatCoordinates = function() {\n  if (this.orientedRevision_ != this.getRevision()) {\n    const flatCoordinates = this.flatCoordinates;\n    if (linearRingIsOriented(\n      flatCoordinates, 0, this.ends_, this.stride)) {\n      this.orientedFlatCoordinates_ = flatCoordinates;\n    } else {\n      this.orientedFlatCoordinates_ = flatCoordinates.slice();\n      this.orientedFlatCoordinates_.length =\n          orientLinearRings(\n            this.orientedFlatCoordinates_, 0, this.ends_, this.stride);\n    }\n    this.orientedRevision_ = this.getRevision();\n  }\n  return this.orientedFlatCoordinates_;\n};\n\n\n/**\n * @inheritDoc\n */\nPolygon.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  const simplifiedEnds = [];\n  simplifiedFlatCoordinates.length = quantizeArray(\n    this.flatCoordinates, 0, this.ends_, this.stride,\n    Math.sqrt(squaredTolerance),\n    simplifiedFlatCoordinates, 0, simplifiedEnds);\n  const simplifiedPolygon = new Polygon(null);\n  simplifiedPolygon.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates, simplifiedEnds);\n  return simplifiedPolygon;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPolygon.prototype.getType = function() {\n  return GeometryType.POLYGON;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPolygon.prototype.intersectsExtent = function(extent) {\n  return intersectsLinearRingArray(\n    this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride, extent);\n};\n\n\n/**\n * Set the coordinates of the polygon.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nPolygon.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null, this.ends_);\n  } else {\n    this.setLayout(opt_layout, coordinates, 2);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const ends = deflateCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.ends_);\n    this.flatCoordinates.length = ends.length === 0 ? 0 : ends[ends.length - 1];\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<number>} ends Ends.\n */\nPolygon.prototype.setFlatCoordinates = function(layout, flatCoordinates, ends) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.ends_ = ends;\n  this.changed();\n};\n\nexport default Polygon;\n\n\n/**\n * Create an approximation of a circle on the surface of a sphere.\n * @param {module:ol/coordinate~Coordinate} center Center (`[lon, lat]` in degrees).\n * @param {number} radius The great-circle distance from the center to\n *     the polygon vertices.\n * @param {number=} opt_n Optional number of vertices for the resulting\n *     polygon. Default is `32`.\n * @param {number=} opt_sphereRadius Optional radius for the sphere (defaults to\n *     the Earth's mean radius using the WGS84 ellipsoid).\n * @return {module:ol/geom/Polygon} The \"circular\" polygon.\n * @api\n */\nexport function circular(center, radius, opt_n, opt_sphereRadius) {\n  const n = opt_n ? opt_n : 32;\n  /** @type {Array.<number>} */\n  const flatCoordinates = [];\n  for (let i = 0; i < n; ++i) {\n    extend(flatCoordinates, sphereOffset(center, radius, 2 * Math.PI * i / n, opt_sphereRadius));\n  }\n  flatCoordinates.push(flatCoordinates[0], flatCoordinates[1]);\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(GeometryLayout.XY, flatCoordinates, [flatCoordinates.length]);\n  return polygon;\n}\n\n\n/**\n * Create a polygon from an extent. The layout used is `XY`.\n * @param {module:ol/extent~Extent} extent The extent.\n * @return {module:ol/geom/Polygon} The polygon.\n * @api\n */\nexport function fromExtent(extent) {\n  const minX = extent[0];\n  const minY = extent[1];\n  const maxX = extent[2];\n  const maxY = extent[3];\n  const flatCoordinates =\n      [minX, minY, minX, maxY, maxX, maxY, maxX, minY, minX, minY];\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(\n    GeometryLayout.XY, flatCoordinates, [flatCoordinates.length]);\n  return polygon;\n}\n\n\n/**\n * Create a regular polygon from a circle.\n * @param {module:ol/geom/Circle} circle Circle geometry.\n * @param {number=} opt_sides Number of sides of the polygon. Default is 32.\n * @param {number=} opt_angle Start angle for the first vertex of the polygon in\n *     radians. Default is 0.\n * @return {module:ol/geom/Polygon} Polygon geometry.\n * @api\n */\nexport function fromCircle(circle, opt_sides, opt_angle) {\n  const sides = opt_sides ? opt_sides : 32;\n  const stride = circle.getStride();\n  const layout = circle.getLayout();\n  const polygon = new Polygon(null, layout);\n  const arrayLength = stride * (sides + 1);\n  const flatCoordinates = new Array(arrayLength);\n  for (let i = 0; i < arrayLength; i++) {\n    flatCoordinates[i] = 0;\n  }\n  const ends = [flatCoordinates.length];\n  polygon.setFlatCoordinates(layout, flatCoordinates, ends);\n  makeRegular(polygon, circle.getCenter(), circle.getRadius(), opt_angle);\n  return polygon;\n}\n\n\n/**\n * Modify the coordinates of a polygon to make it a regular polygon.\n * @param {module:ol/geom/Polygon} polygon Polygon geometry.\n * @param {module:ol/coordinate~Coordinate} center Center of the regular polygon.\n * @param {number} radius Radius of the regular polygon.\n * @param {number=} opt_angle Start angle for the first vertex of the polygon in\n *     radians. Default is 0.\n */\nexport function makeRegular(polygon, center, radius, opt_angle) {\n  const flatCoordinates = polygon.getFlatCoordinates();\n  const layout = polygon.getLayout();\n  const stride = polygon.getStride();\n  const ends = polygon.getEnds();\n  const sides = flatCoordinates.length / stride - 1;\n  const startAngle = opt_angle ? opt_angle : 0;\n  for (let i = 0; i <= sides; ++i) {\n    const offset = i * stride;\n    const angle = startAngle + (modulo(i, sides) * 2 * Math.PI / sides);\n    flatCoordinates[offset] = center[0] + (radius * Math.cos(angle));\n    flatCoordinates[offset + 1] = center[1] + (radius * Math.sin(angle));\n  }\n  polygon.setFlatCoordinates(layout, flatCoordinates, ends);\n}\n","/**\n * @module ol/geom/SimpleGeometry\n */\nimport {inherits} from '../index.js';\nimport {FALSE} from '../functions.js';\nimport {createOrUpdateFromFlatCoordinates, getCenter} from '../extent.js';\nimport Geometry from '../geom/Geometry.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport {rotate, scale, translate, transform2D} from '../geom/flat/transform.js';\nimport {clear} from '../obj.js';\n\n/**\n * @classdesc\n * Abstract base class; only used for creating subclasses; do not instantiate\n * in apps, as cannot be rendered.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/geom/Geometry}\n * @api\n */\nconst SimpleGeometry = function() {\n\n  Geometry.call(this);\n\n  /**\n   * @protected\n   * @type {module:ol/geom/GeometryLayout}\n   */\n  this.layout = GeometryLayout.XY;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.stride = 2;\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.flatCoordinates = null;\n\n};\n\ninherits(SimpleGeometry, Geometry);\n\n\n/**\n * @param {number} stride Stride.\n * @return {module:ol/geom/GeometryLayout} layout Layout.\n */\nfunction getLayoutForStride(stride) {\n  let layout;\n  if (stride == 2) {\n    layout = GeometryLayout.XY;\n  } else if (stride == 3) {\n    layout = GeometryLayout.XYZ;\n  } else if (stride == 4) {\n    layout = GeometryLayout.XYZM;\n  }\n  return (\n    /** @type {module:ol/geom/GeometryLayout} */ (layout)\n  );\n}\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @return {number} Stride.\n */\nexport function getStrideForLayout(layout) {\n  let stride;\n  if (layout == GeometryLayout.XY) {\n    stride = 2;\n  } else if (layout == GeometryLayout.XYZ || layout == GeometryLayout.XYM) {\n    stride = 3;\n  } else if (layout == GeometryLayout.XYZM) {\n    stride = 4;\n  }\n  return /** @type {number} */ (stride);\n}\n\n\n/**\n * @inheritDoc\n */\nSimpleGeometry.prototype.containsXY = FALSE;\n\n\n/**\n * @inheritDoc\n */\nSimpleGeometry.prototype.computeExtent = function(extent) {\n  return createOrUpdateFromFlatCoordinates(this.flatCoordinates,\n    0, this.flatCoordinates.length, this.stride, extent);\n};\n\n\n/**\n * @abstract\n * @return {Array} Coordinates.\n */\nSimpleGeometry.prototype.getCoordinates = function() {};\n\n\n/**\n * Return the first coordinate of the geometry.\n * @return {module:ol/coordinate~Coordinate} First coordinate.\n * @api\n */\nSimpleGeometry.prototype.getFirstCoordinate = function() {\n  return this.flatCoordinates.slice(0, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Flat coordinates.\n */\nSimpleGeometry.prototype.getFlatCoordinates = function() {\n  return this.flatCoordinates;\n};\n\n\n/**\n * Return the last coordinate of the geometry.\n * @return {module:ol/coordinate~Coordinate} Last point.\n * @api\n */\nSimpleGeometry.prototype.getLastCoordinate = function() {\n  return this.flatCoordinates.slice(this.flatCoordinates.length - this.stride);\n};\n\n\n/**\n * Return the {@link module:ol/geom/GeometryLayout~GeometryLayout layout} of the geometry.\n * @return {module:ol/geom/GeometryLayout} Layout.\n * @api\n */\nSimpleGeometry.prototype.getLayout = function() {\n  return this.layout;\n};\n\n\n/**\n * @inheritDoc\n */\nSimpleGeometry.prototype.getSimplifiedGeometry = function(squaredTolerance) {\n  if (this.simplifiedGeometryRevision != this.getRevision()) {\n    clear(this.simplifiedGeometryCache);\n    this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n    this.simplifiedGeometryRevision = this.getRevision();\n  }\n  // If squaredTolerance is negative or if we know that simplification will not\n  // have any effect then just return this.\n  if (squaredTolerance < 0 ||\n      (this.simplifiedGeometryMaxMinSquaredTolerance !== 0 &&\n       squaredTolerance <= this.simplifiedGeometryMaxMinSquaredTolerance)) {\n    return this;\n  }\n  const key = squaredTolerance.toString();\n  if (this.simplifiedGeometryCache.hasOwnProperty(key)) {\n    return this.simplifiedGeometryCache[key];\n  } else {\n    const simplifiedGeometry =\n        this.getSimplifiedGeometryInternal(squaredTolerance);\n    const simplifiedFlatCoordinates = simplifiedGeometry.getFlatCoordinates();\n    if (simplifiedFlatCoordinates.length < this.flatCoordinates.length) {\n      this.simplifiedGeometryCache[key] = simplifiedGeometry;\n      return simplifiedGeometry;\n    } else {\n      // Simplification did not actually remove any coordinates.  We now know\n      // that any calls to getSimplifiedGeometry with a squaredTolerance less\n      // than or equal to the current squaredTolerance will also not have any\n      // effect.  This allows us to short circuit simplification (saving CPU\n      // cycles) and prevents the cache of simplified geometries from filling\n      // up with useless identical copies of this geometry (saving memory).\n      this.simplifiedGeometryMaxMinSquaredTolerance = squaredTolerance;\n      return this;\n    }\n  }\n};\n\n\n/**\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/SimpleGeometry} Simplified geometry.\n * @protected\n */\nSimpleGeometry.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  return this;\n};\n\n\n/**\n * @return {number} Stride.\n */\nSimpleGeometry.prototype.getStride = function() {\n  return this.stride;\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @protected\n */\nSimpleGeometry.prototype.setFlatCoordinatesInternal = function(layout, flatCoordinates) {\n  this.stride = getStrideForLayout(layout);\n  this.layout = layout;\n  this.flatCoordinates = flatCoordinates;\n};\n\n\n/**\n * @abstract\n * @param {Array} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n */\nSimpleGeometry.prototype.setCoordinates = function(coordinates, opt_layout) {};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout|undefined} layout Layout.\n * @param {Array} coordinates Coordinates.\n * @param {number} nesting Nesting.\n * @protected\n */\nSimpleGeometry.prototype.setLayout = function(layout, coordinates, nesting) {\n  /** @type {number} */\n  let stride;\n  if (layout) {\n    stride = getStrideForLayout(layout);\n  } else {\n    for (let i = 0; i < nesting; ++i) {\n      if (coordinates.length === 0) {\n        this.layout = GeometryLayout.XY;\n        this.stride = 2;\n        return;\n      } else {\n        coordinates = /** @type {Array} */ (coordinates[0]);\n      }\n    }\n    stride = coordinates.length;\n    layout = getLayoutForStride(stride);\n  }\n  this.layout = layout;\n  this.stride = stride;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.applyTransform = function(transformFn) {\n  if (this.flatCoordinates) {\n    transformFn(this.flatCoordinates, this.flatCoordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.rotate = function(angle, anchor) {\n  const flatCoordinates = this.getFlatCoordinates();\n  if (flatCoordinates) {\n    const stride = this.getStride();\n    rotate(\n      flatCoordinates, 0, flatCoordinates.length,\n      stride, angle, anchor, flatCoordinates);\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.scale = function(sx, opt_sy, opt_anchor) {\n  let sy = opt_sy;\n  if (sy === undefined) {\n    sy = sx;\n  }\n  let anchor = opt_anchor;\n  if (!anchor) {\n    anchor = getCenter(this.getExtent());\n  }\n  const flatCoordinates = this.getFlatCoordinates();\n  if (flatCoordinates) {\n    const stride = this.getStride();\n    scale(\n      flatCoordinates, 0, flatCoordinates.length,\n      stride, sx, sy, anchor, flatCoordinates);\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.translate = function(deltaX, deltaY) {\n  const flatCoordinates = this.getFlatCoordinates();\n  if (flatCoordinates) {\n    const stride = this.getStride();\n    translate(\n      flatCoordinates, 0, flatCoordinates.length, stride,\n      deltaX, deltaY, flatCoordinates);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} simpleGeometry Simple geometry.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed flat coordinates.\n */\nexport function transformGeom2D(simpleGeometry, transform, opt_dest) {\n  const flatCoordinates = simpleGeometry.getFlatCoordinates();\n  if (!flatCoordinates) {\n    return null;\n  } else {\n    const stride = simpleGeometry.getStride();\n    return transform2D(\n      flatCoordinates, 0, flatCoordinates.length, stride,\n      transform, opt_dest);\n  }\n}\n\nexport default SimpleGeometry;\n","/**\n * @module ol/geom/flat/area\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRing(flatCoordinates, offset, end, stride) {\n  let twiceArea = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    twiceArea += y1 * x2 - x1 * y2;\n    x1 = x2;\n    y1 = y2;\n  }\n  return twiceArea / 2;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRings(flatCoordinates, offset, ends, stride) {\n  let area = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    area += linearRing(flatCoordinates, offset, end, stride);\n    offset = end;\n  }\n  return area;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRingss(flatCoordinates, offset, endss, stride) {\n  let area = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    area += linearRings(flatCoordinates, offset, ends, stride);\n    offset = ends[ends.length - 1];\n  }\n  return area;\n}\n","/**\n * @module ol/geom/flat/center\n */\nimport {createEmpty, createOrUpdateFromFlatCoordinates} from '../../extent.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @return {Array.<number>} Flat centers.\n */\nexport function linearRingss(flatCoordinates, offset, endss, stride) {\n  const flatCenters = [];\n  let extent = createEmpty();\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    extent = createOrUpdateFromFlatCoordinates(flatCoordinates, offset, ends[0], stride);\n    flatCenters.push((extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2);\n    offset = ends[ends.length - 1];\n  }\n  return flatCenters;\n}\n","/**\n * @module ol/geom/flat/closest\n */\nimport {lerp, squaredDistance as squaredDx} from '../../math.js';\n\n\n/**\n * Returns the point on the 2D line segment flatCoordinates[offset1] to\n * flatCoordinates[offset2] that is closest to the point (x, y).  Extra\n * dimensions are linearly interpolated.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset1 Offset 1.\n * @param {number} offset2 Offset 2.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n */\nfunction assignClosest(flatCoordinates, offset1, offset2, stride, x, y, closestPoint) {\n  const x1 = flatCoordinates[offset1];\n  const y1 = flatCoordinates[offset1 + 1];\n  const dx = flatCoordinates[offset2] - x1;\n  const dy = flatCoordinates[offset2 + 1] - y1;\n  let offset;\n  if (dx === 0 && dy === 0) {\n    offset = offset1;\n  } else {\n    const t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      offset = offset2;\n    } else if (t > 0) {\n      for (let i = 0; i < stride; ++i) {\n        closestPoint[i] = lerp(flatCoordinates[offset1 + i],\n          flatCoordinates[offset2 + i], t);\n      }\n      closestPoint.length = stride;\n      return;\n    } else {\n      offset = offset1;\n    }\n  }\n  for (let i = 0; i < stride; ++i) {\n    closestPoint[i] = flatCoordinates[offset + i];\n  }\n  closestPoint.length = stride;\n}\n\n\n/**\n * Return the squared of the largest distance between any pair of consecutive\n * coordinates.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function maxSquaredDelta(flatCoordinates, offset, end, stride, max) {\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  for (offset += stride; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    const squaredDelta = squaredDx(x1, y1, x2, y2);\n    if (squaredDelta > max) {\n      max = squaredDelta;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  return max;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function arrayMaxSquaredDelta(flatCoordinates, offset, ends, stride, max) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    max = maxSquaredDelta(\n      flatCoordinates, offset, end, stride, max);\n    offset = end;\n  }\n  return max;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function multiArrayMaxSquaredDelta(flatCoordinates, offset, endss, stride, max) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    max = arrayMaxSquaredDelta(\n      flatCoordinates, offset, ends, stride, max);\n    offset = ends[ends.length - 1];\n  }\n  return max;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array.<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestPoint(flatCoordinates, offset, end,\n  stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  if (offset == end) {\n    return minSquaredDistance;\n  }\n  let i, squaredDistance;\n  if (maxDelta === 0) {\n    // All points are identical, so just test the first point.\n    squaredDistance = squaredDx(\n      x, y, flatCoordinates[offset], flatCoordinates[offset + 1]);\n    if (squaredDistance < minSquaredDistance) {\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = flatCoordinates[offset + i];\n      }\n      closestPoint.length = stride;\n      return squaredDistance;\n    } else {\n      return minSquaredDistance;\n    }\n  }\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  let index = offset + stride;\n  while (index < end) {\n    assignClosest(\n      flatCoordinates, index - stride, index, stride, x, y, tmpPoint);\n    squaredDistance = squaredDx(x, y, tmpPoint[0], tmpPoint[1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = tmpPoint[i];\n      }\n      closestPoint.length = stride;\n      index += stride;\n    } else {\n      // Skip ahead multiple points, because we know that all the skipped\n      // points cannot be any closer than the closest point we have found so\n      // far.  We know this because we know how close the current point is, how\n      // close the closest point we have found so far is, and the maximum\n      // distance between consecutive points.  For example, if we're currently\n      // at distance 10, the best we've found so far is 3, and that the maximum\n      // distance between consecutive points is 2, then we'll need to skip at\n      // least (10 - 3) / 2 == 3 (rounded down) points to have any chance of\n      // finding a closer point.  We use Math.max(..., 1) to ensure that we\n      // always advance at least one point, to avoid an infinite loop.\n      index += stride * Math.max(\n        ((Math.sqrt(squaredDistance) -\n            Math.sqrt(minSquaredDistance)) / maxDelta) | 0, 1);\n    }\n  }\n  if (isRing) {\n    // Check the closing segment.\n    assignClosest(\n      flatCoordinates, end - stride, offset, stride, x, y, tmpPoint);\n    squaredDistance = squaredDx(x, y, tmpPoint[0], tmpPoint[1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = tmpPoint[i];\n      }\n      closestPoint.length = stride;\n    }\n  }\n  return minSquaredDistance;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array.<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestArrayPoint(flatCoordinates, offset, ends,\n  stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    minSquaredDistance = assignClosestPoint(\n      flatCoordinates, offset, end, stride,\n      maxDelta, isRing, x, y, closestPoint, minSquaredDistance, tmpPoint);\n    offset = end;\n  }\n  return minSquaredDistance;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array.<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestMultiArrayPoint(flatCoordinates, offset,\n  endss, stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    minSquaredDistance = assignClosestArrayPoint(\n      flatCoordinates, offset, ends, stride,\n      maxDelta, isRing, x, y, closestPoint, minSquaredDistance, tmpPoint);\n    offset = ends[ends.length - 1];\n  }\n  return minSquaredDistance;\n}\n","/**\n * @module ol/geom/flat/contains\n */\nimport {forEachCorner} from '../../extent.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} Contains extent.\n */\nexport function linearRingContainsExtent(flatCoordinates, offset, end, stride, extent) {\n  const outside = forEachCorner(extent,\n    /**\n     * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n     * @return {boolean} Contains (x, y).\n     */\n    function(coordinate) {\n      return !linearRingContainsXY(flatCoordinates, offset, end, stride, coordinate[0], coordinate[1]);\n    });\n  return !outside;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingContainsXY(flatCoordinates, offset, end, stride, x, y) {\n  // http://geomalgorithms.com/a03-_inclusion.html\n  // Copyright 2000 softSurfer, 2012 Dan Sunday\n  // This code may be freely used and modified for any purpose\n  // providing that this copyright notice is included with it.\n  // SoftSurfer makes no warranty for this code, and cannot be held\n  // liable for any real or imagined damage resulting from its use.\n  // Users of this code must verify correctness for their application.\n  let wn = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    if (y1 <= y) {\n      if (y2 > y && ((x2 - x1) * (y - y1)) - ((x - x1) * (y2 - y1)) > 0) {\n        wn++;\n      }\n    } else if (y2 <= y && ((x2 - x1) * (y - y1)) - ((x - x1) * (y2 - y1)) < 0) {\n      wn--;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  return wn !== 0;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y) {\n  if (ends.length === 0) {\n    return false;\n  }\n  if (!linearRingContainsXY(flatCoordinates, offset, ends[0], stride, x, y)) {\n    return false;\n  }\n  for (let i = 1, ii = ends.length; i < ii; ++i) {\n    if (linearRingContainsXY(flatCoordinates, ends[i - 1], ends[i], stride, x, y)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingssContainsXY(flatCoordinates, offset, endss, stride, x, y) {\n  if (endss.length === 0) {\n    return false;\n  }\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n      return true;\n    }\n    offset = ends[ends.length - 1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/deflate\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} stride Stride.\n * @return {number} offset Offset.\n */\nexport function deflateCoordinate(flatCoordinates, offset, coordinate, stride) {\n  for (let i = 0, ii = coordinate.length; i < ii; ++i) {\n    flatCoordinates[offset++] = coordinate[i];\n  }\n  return offset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {number} stride Stride.\n * @return {number} offset Offset.\n */\nexport function deflateCoordinates(flatCoordinates, offset, coordinates, stride) {\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    const coordinate = coordinates[i];\n    for (let j = 0; j < stride; ++j) {\n      flatCoordinates[offset++] = coordinate[j];\n    }\n  }\n  return offset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinatess Coordinatess.\n * @param {number} stride Stride.\n * @param {Array.<number>=} opt_ends Ends.\n * @return {Array.<number>} Ends.\n */\nexport function deflateCoordinatesArray(flatCoordinates, offset, coordinatess, stride, opt_ends) {\n  const ends = opt_ends ? opt_ends : [];\n  let i = 0;\n  for (let j = 0, jj = coordinatess.length; j < jj; ++j) {\n    const end = deflateCoordinates(\n      flatCoordinates, offset, coordinatess[j], stride);\n    ends[i++] = end;\n    offset = end;\n  }\n  ends.length = i;\n  return ends;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} coordinatesss Coordinatesss.\n * @param {number} stride Stride.\n * @param {Array.<Array.<number>>=} opt_endss Endss.\n * @return {Array.<Array.<number>>} Endss.\n */\nexport function deflateMultiCoordinatesArray(flatCoordinates, offset, coordinatesss, stride, opt_endss) {\n  const endss = opt_endss ? opt_endss : [];\n  let i = 0;\n  for (let j = 0, jj = coordinatesss.length; j < jj; ++j) {\n    const ends = deflateCoordinatesArray(\n      flatCoordinates, offset, coordinatesss[j], stride, endss[i]);\n    endss[i++] = ends;\n    offset = ends[ends.length - 1];\n  }\n  endss.length = i;\n  return endss;\n}\n","/**\n * @module ol/geom/flat/inflate\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {Array.<module:ol/coordinate~Coordinate>=} opt_coordinates Coordinates.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n */\nexport function inflateCoordinates(flatCoordinates, offset, end, stride, opt_coordinates) {\n  const coordinates = opt_coordinates !== undefined ? opt_coordinates : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    coordinates[i++] = flatCoordinates.slice(j, j + stride);\n  }\n  coordinates.length = i;\n  return coordinates;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>=} opt_coordinatess Coordinatess.\n * @return {Array.<Array.<module:ol/coordinate~Coordinate>>} Coordinatess.\n */\nexport function inflateCoordinatesArray(flatCoordinates, offset, ends, stride, opt_coordinatess) {\n  const coordinatess = opt_coordinatess !== undefined ? opt_coordinatess : [];\n  let i = 0;\n  for (let j = 0, jj = ends.length; j < jj; ++j) {\n    const end = ends[j];\n    coordinatess[i++] = inflateCoordinates(\n      flatCoordinates, offset, end, stride, coordinatess[i]);\n    offset = end;\n  }\n  coordinatess.length = i;\n  return coordinatess;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>=} opt_coordinatesss\n *     Coordinatesss.\n * @return {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} Coordinatesss.\n */\nexport function inflateMultiCoordinatesArray(flatCoordinates, offset, endss, stride, opt_coordinatesss) {\n  const coordinatesss = opt_coordinatesss !== undefined ? opt_coordinatesss : [];\n  let i = 0;\n  for (let j = 0, jj = endss.length; j < jj; ++j) {\n    const ends = endss[j];\n    coordinatesss[i++] = inflateCoordinatesArray(\n      flatCoordinates, offset, ends, stride, coordinatesss[i]);\n    offset = ends[ends.length - 1];\n  }\n  coordinatesss.length = i;\n  return coordinatesss;\n}\n","/**\n * @module ol/geom/flat/interiorpoint\n */\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {linearRingsContainsXY} from '../flat/contains.js';\n\n\n/**\n * Calculates a point that is likely to lie in the interior of the linear rings.\n * Inspired by JTS's com.vividsolutions.jts.geom.Geometry#getInteriorPoint.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array.<number>} flatCenters Flat centers.\n * @param {number} flatCentersOffset Flat center offset.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Destination point as XYM coordinate, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointOfArray(flatCoordinates, offset,\n  ends, stride, flatCenters, flatCentersOffset, opt_dest) {\n  let i, ii, x, x1, x2, y1, y2;\n  const y = flatCenters[flatCentersOffset + 1];\n  /** @type {Array.<number>} */\n  const intersections = [];\n  // Calculate intersections with the horizontal line\n  for (let r = 0, rr = ends.length; r < rr; ++r) {\n    const end = ends[r];\n    x1 = flatCoordinates[end - stride];\n    y1 = flatCoordinates[end - stride + 1];\n    for (i = offset; i < end; i += stride) {\n      x2 = flatCoordinates[i];\n      y2 = flatCoordinates[i + 1];\n      if ((y <= y1 && y2 <= y) || (y1 <= y && y <= y2)) {\n        x = (y - y1) / (y2 - y1) * (x2 - x1) + x1;\n        intersections.push(x);\n      }\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  // Find the longest segment of the horizontal line that has its center point\n  // inside the linear ring.\n  let pointX = NaN;\n  let maxSegmentLength = -Infinity;\n  intersections.sort(numberSafeCompareFunction);\n  x1 = intersections[0];\n  for (i = 1, ii = intersections.length; i < ii; ++i) {\n    x2 = intersections[i];\n    const segmentLength = Math.abs(x2 - x1);\n    if (segmentLength > maxSegmentLength) {\n      x = (x1 + x2) / 2;\n      if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n        pointX = x;\n        maxSegmentLength = segmentLength;\n      }\n    }\n    x1 = x2;\n  }\n  if (isNaN(pointX)) {\n    // There is no horizontal line that has its center point inside the linear\n    // ring.  Use the center of the the linear ring's extent.\n    pointX = flatCenters[flatCentersOffset];\n  }\n  if (opt_dest) {\n    opt_dest.push(pointX, y, maxSegmentLength);\n    return opt_dest;\n  } else {\n    return [pointX, y, maxSegmentLength];\n  }\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {Array.<number>} flatCenters Flat centers.\n * @return {Array.<number>} Interior points as XYM coordinates, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointsOfMultiArray(flatCoordinates, offset, endss, stride, flatCenters) {\n  let interiorPoints = [];\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    interiorPoints = getInteriorPointOfArray(flatCoordinates,\n      offset, ends, stride, flatCenters, 2 * i, interiorPoints);\n    offset = ends[ends.length - 1];\n  }\n  return interiorPoints;\n}\n","/**\n * @module ol/geom/flat/interpolate\n */\nimport {binarySearch} from '../../array.js';\nimport {lerp} from '../../math.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} fraction Fraction.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Destination.\n */\nexport function interpolatePoint(flatCoordinates, offset, end, stride, fraction, opt_dest) {\n  let pointX = NaN;\n  let pointY = NaN;\n  const n = (end - offset) / stride;\n  if (n === 1) {\n    pointX = flatCoordinates[offset];\n    pointY = flatCoordinates[offset + 1];\n  } else if (n == 2) {\n    pointX = (1 - fraction) * flatCoordinates[offset] +\n        fraction * flatCoordinates[offset + stride];\n    pointY = (1 - fraction) * flatCoordinates[offset + 1] +\n        fraction * flatCoordinates[offset + stride + 1];\n  } else if (n !== 0) {\n    let x1 = flatCoordinates[offset];\n    let y1 = flatCoordinates[offset + 1];\n    let length = 0;\n    const cumulativeLengths = [0];\n    for (let i = offset + stride; i < end; i += stride) {\n      const x2 = flatCoordinates[i];\n      const y2 = flatCoordinates[i + 1];\n      length += Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      cumulativeLengths.push(length);\n      x1 = x2;\n      y1 = y2;\n    }\n    const target = fraction * length;\n    const index = binarySearch(cumulativeLengths, target);\n    if (index < 0) {\n      const t = (target - cumulativeLengths[-index - 2]) /\n          (cumulativeLengths[-index - 1] - cumulativeLengths[-index - 2]);\n      const o = offset + (-index - 2) * stride;\n      pointX = lerp(\n        flatCoordinates[o], flatCoordinates[o + stride], t);\n      pointY = lerp(\n        flatCoordinates[o + 1], flatCoordinates[o + stride + 1], t);\n    } else {\n      pointX = flatCoordinates[offset + index * stride];\n      pointY = flatCoordinates[offset + index * stride + 1];\n    }\n  }\n  if (opt_dest) {\n    opt_dest[0] = pointX;\n    opt_dest[1] = pointY;\n    return opt_dest;\n  } else {\n    return [pointX, pointY];\n  }\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n */\nexport function lineStringCoordinateAtM(flatCoordinates, offset, end, stride, m, extrapolate) {\n  if (end == offset) {\n    return null;\n  }\n  let coordinate;\n  if (m < flatCoordinates[offset + stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(offset, offset + stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  } else if (flatCoordinates[end - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(end - stride, end);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  // FIXME use O(1) search\n  if (m == flatCoordinates[offset + stride - 1]) {\n    return flatCoordinates.slice(offset, offset + stride);\n  }\n  let lo = offset / stride;\n  let hi = end / stride;\n  while (lo < hi) {\n    const mid = (lo + hi) >> 1;\n    if (m < flatCoordinates[(mid + 1) * stride - 1]) {\n      hi = mid;\n    } else {\n      lo = mid + 1;\n    }\n  }\n  const m0 = flatCoordinates[lo * stride - 1];\n  if (m == m0) {\n    return flatCoordinates.slice((lo - 1) * stride, (lo - 1) * stride + stride);\n  }\n  const m1 = flatCoordinates[(lo + 1) * stride - 1];\n  const t = (m - m0) / (m1 - m0);\n  coordinate = [];\n  for (let i = 0; i < stride - 1; ++i) {\n    coordinate.push(lerp(flatCoordinates[(lo - 1) * stride + i],\n      flatCoordinates[lo * stride + i], t));\n  }\n  coordinate.push(m);\n  return coordinate;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @param {boolean} interpolate Interpolate.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n */\nexport function lineStringsCoordinateAtM(\n  flatCoordinates, offset, ends, stride, m, extrapolate, interpolate) {\n  if (interpolate) {\n    return lineStringCoordinateAtM(\n      flatCoordinates, offset, ends[ends.length - 1], stride, m, extrapolate);\n  }\n  let coordinate;\n  if (m < flatCoordinates[stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(0, stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  if (flatCoordinates[flatCoordinates.length - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(flatCoordinates.length - stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    if (offset == end) {\n      continue;\n    }\n    if (m < flatCoordinates[offset + stride - 1]) {\n      return null;\n    } else if (m <= flatCoordinates[end - 1]) {\n      return lineStringCoordinateAtM(\n        flatCoordinates, offset, end, stride, m, false);\n    }\n    offset = end;\n  }\n  return null;\n}\n","/**\n * @module ol/geom/flat/intersectsextent\n */\nimport {containsExtent, createEmpty, extendFlatCoordinates, intersects, intersectsSegment} from '../../extent.js';\nimport {linearRingContainsXY, linearRingContainsExtent} from '../flat/contains.js';\nimport {forEach as forEachSegment} from '../flat/segments.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLineString(flatCoordinates, offset, end, stride, extent) {\n  const coordinatesExtent = extendFlatCoordinates(\n    createEmpty(), flatCoordinates, offset, end, stride);\n  if (!intersects(extent, coordinatesExtent)) {\n    return false;\n  }\n  if (containsExtent(extent, coordinatesExtent)) {\n    return true;\n  }\n  if (coordinatesExtent[0] >= extent[0] &&\n      coordinatesExtent[2] <= extent[2]) {\n    return true;\n  }\n  if (coordinatesExtent[1] >= extent[1] &&\n      coordinatesExtent[3] <= extent[3]) {\n    return true;\n  }\n  return forEachSegment(flatCoordinates, offset, end, stride,\n    /**\n     * @param {module:ol/coordinate~Coordinate} point1 Start point.\n     * @param {module:ol/coordinate~Coordinate} point2 End point.\n     * @return {boolean} `true` if the segment and the extent intersect,\n     *     `false` otherwise.\n     */\n    function(point1, point2) {\n      return intersectsSegment(extent, point1, point2);\n    });\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLineStringArray(flatCoordinates, offset, ends, stride, extent) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    if (intersectsLineString(\n      flatCoordinates, offset, ends[i], stride, extent)) {\n      return true;\n    }\n    offset = ends[i];\n  }\n  return false;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRing(flatCoordinates, offset, end, stride, extent) {\n  if (intersectsLineString(\n    flatCoordinates, offset, end, stride, extent)) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[0], extent[1])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[0], extent[3])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[2], extent[1])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[2], extent[3])) {\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRingArray(flatCoordinates, offset, ends, stride, extent) {\n  if (!intersectsLinearRing(\n    flatCoordinates, offset, ends[0], stride, extent)) {\n    return false;\n  }\n  if (ends.length === 1) {\n    return true;\n  }\n  for (let i = 1, ii = ends.length; i < ii; ++i) {\n    if (linearRingContainsExtent(flatCoordinates, ends[i - 1], ends[i], stride, extent)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRingMultiArray(flatCoordinates, offset, endss, stride, extent) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (intersectsLinearRingArray(\n      flatCoordinates, offset, ends, stride, extent)) {\n      return true;\n    }\n    offset = ends[ends.length - 1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/length\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Length.\n */\nexport function lineStringLength(flatCoordinates, offset, end, stride) {\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  let length = 0;\n  for (let i = offset + stride; i < end; i += stride) {\n    const x2 = flatCoordinates[i];\n    const y2 = flatCoordinates[i + 1];\n    length += Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n    x1 = x2;\n    y1 = y2;\n  }\n  return length;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Perimeter.\n */\nexport function linearRingLength(flatCoordinates, offset, end, stride) {\n  let perimeter = lineStringLength(flatCoordinates, offset, end, stride);\n  const dx = flatCoordinates[end - stride] - flatCoordinates[offset];\n  const dy = flatCoordinates[end - stride + 1] - flatCoordinates[offset + 1];\n  perimeter += Math.sqrt(dx * dx + dy * dy);\n  return perimeter;\n}\n","/**\n * @module ol/geom/flat/orient\n */\nimport {coordinates as reverseCoordinates} from '../flat/reverse.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {boolean} Is clockwise.\n */\nexport function linearRingIsClockwise(flatCoordinates, offset, end, stride) {\n  // http://tinyurl.com/clockwise-method\n  // https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogrlinearring.cpp\n  let edge = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    edge += (x2 - x1) * (y2 + y1);\n    x1 = x2;\n    y1 = y2;\n  }\n  return edge > 0;\n}\n\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingIsOriented(flatCoordinates, offset, ends, stride, opt_right) {\n  const right = opt_right !== undefined ? opt_right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates, offset, end, stride);\n    if (i === 0) {\n      if ((right && isClockwise) || (!right && !isClockwise)) {\n        return false;\n      }\n    } else {\n      if ((right && !isClockwise) || (!right && isClockwise)) {\n        return false;\n      }\n    }\n    offset = end;\n  }\n  return true;\n}\n\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingsAreOriented(flatCoordinates, offset, endss, stride, opt_right) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    if (!linearRingIsOriented(\n      flatCoordinates, offset, endss[i], stride, opt_right)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRings(flatCoordinates, offset, ends, stride, opt_right) {\n  const right = opt_right !== undefined ? opt_right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates, offset, end, stride);\n    const reverse = i === 0 ?\n      (right && isClockwise) || (!right && !isClockwise) :\n      (right && !isClockwise) || (!right && isClockwise);\n    if (reverse) {\n      reverseCoordinates(flatCoordinates, offset, end, stride);\n    }\n    offset = end;\n  }\n  return offset;\n}\n\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRingsArray(flatCoordinates, offset, endss, stride, opt_right) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    offset = orientLinearRings(\n      flatCoordinates, offset, endss[i], stride, opt_right);\n  }\n  return offset;\n}\n","/**\n * @module ol/geom/flat/reverse\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nexport function coordinates(flatCoordinates, offset, end, stride) {\n  while (offset < end - stride) {\n    for (let i = 0; i < stride; ++i) {\n      const tmp = flatCoordinates[offset + i];\n      flatCoordinates[offset + i] = flatCoordinates[end - stride + i];\n      flatCoordinates[end - stride + i] = tmp;\n    }\n    offset += stride;\n    end -= stride;\n  }\n}\n","/**\n * @module ol/geom/flat/segments\n */\n\n\n/**\n * This function calls `callback` for each segment of the flat coordinates\n * array. If the callback returns a truthy value the function returns that\n * value immediately. Otherwise the function returns `false`.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {function(this: S, module:ol/coordinate~Coordinate, module:ol/coordinate~Coordinate): T} callback Function\n *     called for each segment.\n * @param {S=} opt_this The object to be used as the value of 'this'\n *     within callback.\n * @return {T|boolean} Value.\n * @template T,S\n */\nexport function forEach(flatCoordinates, offset, end, stride, callback, opt_this) {\n  const point1 = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n  const point2 = [];\n  let ret;\n  for (; (offset + stride) < end; offset += stride) {\n    point2[0] = flatCoordinates[offset + stride];\n    point2[1] = flatCoordinates[offset + stride + 1];\n    ret = callback.call(opt_this, point1, point2);\n    if (ret) {\n      return ret;\n    }\n    point1[0] = point2[0];\n    point1[1] = point2[1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/simplify\n */\n// Based on simplify-js https://github.com/mourner/simplify-js\n// Copyright (c) 2012, Vladimir Agafonkin\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n//    1. Redistributions of source code must retain the above copyright notice,\n//       this list of conditions and the following disclaimer.\n//\n//    2. Redistributions in binary form must reproduce the above copyright\n//       notice, this list of conditions and the following disclaimer in the\n//       documentation and/or other materials provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n// POSSIBILITY OF SUCH DAMAGE.\n\nimport {squaredSegmentDistance, squaredDistance} from '../../math.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {boolean} highQuality Highest quality.\n * @param {Array.<number>=} opt_simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @return {Array.<number>} Simplified line string.\n */\nexport function simplifyLineString(flatCoordinates, offset, end,\n  stride, squaredTolerance, highQuality, opt_simplifiedFlatCoordinates) {\n  const simplifiedFlatCoordinates = opt_simplifiedFlatCoordinates !== undefined ?\n    opt_simplifiedFlatCoordinates : [];\n  if (!highQuality) {\n    end = radialDistance(flatCoordinates, offset, end,\n      stride, squaredTolerance,\n      simplifiedFlatCoordinates, 0);\n    flatCoordinates = simplifiedFlatCoordinates;\n    offset = 0;\n    stride = 2;\n  }\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    flatCoordinates, offset, end, stride, squaredTolerance,\n    simplifiedFlatCoordinates, 0);\n  return simplifiedFlatCoordinates;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function douglasPeucker(flatCoordinates, offset, end,\n  stride, squaredTolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  const n = (end - offset) / stride;\n  if (n < 3) {\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  /** @type {Array.<number>} */\n  const markers = new Array(n);\n  markers[0] = 1;\n  markers[n - 1] = 1;\n  /** @type {Array.<number>} */\n  const stack = [offset, end - stride];\n  let index = 0;\n  while (stack.length > 0) {\n    const last = stack.pop();\n    const first = stack.pop();\n    let maxSquaredDistance = 0;\n    const x1 = flatCoordinates[first];\n    const y1 = flatCoordinates[first + 1];\n    const x2 = flatCoordinates[last];\n    const y2 = flatCoordinates[last + 1];\n    for (let i = first + stride; i < last; i += stride) {\n      const x = flatCoordinates[i];\n      const y = flatCoordinates[i + 1];\n      const squaredDistance = squaredSegmentDistance(\n        x, y, x1, y1, x2, y2);\n      if (squaredDistance > maxSquaredDistance) {\n        index = i;\n        maxSquaredDistance = squaredDistance;\n      }\n    }\n    if (maxSquaredDistance > squaredTolerance) {\n      markers[(index - offset) / stride] = 1;\n      if (first + stride < index) {\n        stack.push(first, index);\n      }\n      if (index + stride < last) {\n        stack.push(index, last);\n      }\n    }\n  }\n  for (let i = 0; i < n; ++i) {\n    if (markers[i]) {\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + i * stride];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + i * stride + 1];\n    }\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerArray(flatCoordinates, offset,\n  ends, stride, squaredTolerance, simplifiedFlatCoordinates,\n  simplifiedOffset, simplifiedEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = douglasPeucker(\n      flatCoordinates, offset, end, stride, squaredTolerance,\n      simplifiedFlatCoordinates, simplifiedOffset);\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<Array.<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerMultiArray(\n  flatCoordinates, offset, endss, stride, squaredTolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEndss) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    const simplifiedEnds = [];\n    simplifiedOffset = douglasPeuckerArray(\n      flatCoordinates, offset, ends, stride, squaredTolerance,\n      simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds);\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function radialDistance(flatCoordinates, offset, end,\n  stride, squaredTolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  if (end <= offset + stride) {\n    // zero or one point, no simplification possible, so copy and return\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  // copy first point\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  let x2 = x1;\n  let y2 = y1;\n  for (offset += stride; offset < end; offset += stride) {\n    x2 = flatCoordinates[offset];\n    y2 = flatCoordinates[offset + 1];\n    if (squaredDistance(x1, y1, x2, y2) > squaredTolerance) {\n      // copy point at offset\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  if (x2 != x1 || y2 != y1) {\n    // copy last point\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {number} value Value.\n * @param {number} tolerance Tolerance.\n * @return {number} Rounded value.\n */\nexport function snap(value, tolerance) {\n  return tolerance * Math.round(value / tolerance);\n}\n\n\n/**\n * Simplifies a line string using an algorithm designed by Tim Schaub.\n * Coordinates are snapped to the nearest value in a virtual grid and\n * consecutive duplicate coordinates are discarded.  This effectively preserves\n * topology as the simplification of any subsection of a line string is\n * independent of the rest of the line string.  This means that, for examples,\n * the common edge between two polygons will be simplified to the same line\n * string independently in both polygons.  This implementation uses a single\n * pass over the coordinates and eliminates intermediate collinear points.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function quantize(flatCoordinates, offset, end, stride,\n  tolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  // do nothing if the line is empty\n  if (offset == end) {\n    return simplifiedOffset;\n  }\n  // snap the first coordinate (P1)\n  let x1 = snap(flatCoordinates[offset], tolerance);\n  let y1 = snap(flatCoordinates[offset + 1], tolerance);\n  offset += stride;\n  // add the first coordinate to the output\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  // find the next coordinate that does not snap to the same value as the first\n  // coordinate (P2)\n  let x2, y2;\n  do {\n    x2 = snap(flatCoordinates[offset], tolerance);\n    y2 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    if (offset == end) {\n      // all coordinates snap to the same value, the line collapses to a point\n      // push the last snapped value anyway to ensure that the output contains\n      // at least two points\n      // FIXME should we really return at least two points anyway?\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      return simplifiedOffset;\n    }\n  } while (x2 == x1 && y2 == y1);\n  while (offset < end) {\n    // snap the next coordinate (P3)\n    const x3 = snap(flatCoordinates[offset], tolerance);\n    const y3 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    // skip P3 if it is equal to P2\n    if (x3 == x2 && y3 == y2) {\n      continue;\n    }\n    // calculate the delta between P1 and P2\n    const dx1 = x2 - x1;\n    const dy1 = y2 - y1;\n    // calculate the delta between P3 and P1\n    const dx2 = x3 - x1;\n    const dy2 = y3 - y1;\n    // if P1, P2, and P3 are colinear and P3 is further from P1 than P2 is from\n    // P1 in the same direction then P2 is on the straight line between P1 and\n    // P3\n    if ((dx1 * dy2 == dy1 * dx2) &&\n        ((dx1 < 0 && dx2 < dx1) || dx1 == dx2 || (dx1 > 0 && dx2 > dx1)) &&\n        ((dy1 < 0 && dy2 < dy1) || dy1 == dy2 || (dy1 > 0 && dy2 > dy1))) {\n      // discard P2 and set P2 = P3\n      x2 = x3;\n      y2 = y3;\n      continue;\n    }\n    // either P1, P2, and P3 are not colinear, or they are colinear but P3 is\n    // between P3 and P1 or on the opposite half of the line to P2.  add P2,\n    // and continue with P1 = P2 and P2 = P3\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n    x1 = x2;\n    y1 = y2;\n    x2 = x3;\n    y2 = y3;\n  }\n  // add the last point (P2)\n  simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function quantizeArray(\n  flatCoordinates, offset, ends, stride,\n  tolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = quantize(\n      flatCoordinates, offset, end, stride,\n      tolerance,\n      simplifiedFlatCoordinates, simplifiedOffset);\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<Array.<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function quantizeMultiArray(\n  flatCoordinates, offset, endss, stride,\n  tolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEndss) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    const simplifiedEnds = [];\n    simplifiedOffset = quantizeArray(\n      flatCoordinates, offset, ends, stride,\n      tolerance,\n      simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds);\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n","/**\n * @module ol/geom/flat/straightchunk\n */\n\n\n/**\n * @param {number} maxAngle Maximum acceptable angle delta between segments.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {Array.<number>} Start and end of the first suitable chunk of the\n * given `flatCoordinates`.\n */\nexport function matchingChunk(maxAngle, flatCoordinates, offset, end, stride) {\n  let chunkStart = offset;\n  let chunkEnd = offset;\n  let chunkM = 0;\n  let m = 0;\n  let start = offset;\n  let acos, i, m12, m23, x1, y1, x12, y12, x23, y23;\n  for (i = offset; i < end; i += stride) {\n    const x2 = flatCoordinates[i];\n    const y2 = flatCoordinates[i + 1];\n    if (x1 !== undefined) {\n      x23 = x2 - x1;\n      y23 = y2 - y1;\n      m23 = Math.sqrt(x23 * x23 + y23 * y23);\n      if (x12 !== undefined) {\n        m += m12;\n        acos = Math.acos((x12 * x23 + y12 * y23) / (m12 * m23));\n        if (acos > maxAngle) {\n          if (m > chunkM) {\n            chunkM = m;\n            chunkStart = start;\n            chunkEnd = i;\n          }\n          m = 0;\n          start = i - stride;\n        }\n      }\n      m12 = m23;\n      x12 = x23;\n      y12 = y23;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  m += m23;\n  return m > chunkM ? [start, i] : [chunkStart, chunkEnd];\n}\n","/**\n * @module ol/geom/flat/textpath\n */\nimport {lerp} from '../../math.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Path to put text on.\n * @param {number} offset Start offset of the `flatCoordinates`.\n * @param {number} end End offset of the `flatCoordinates`.\n * @param {number} stride Stride.\n * @param {string} text Text to place on the path.\n * @param {function(string):number} measure Measure function returning the\n * width of the character passed as 1st argument.\n * @param {number} startM m along the path where the text starts.\n * @param {number} maxAngle Max angle between adjacent chars in radians.\n * @return {Array.<Array.<*>>} The result array of null if `maxAngle` was\n * exceeded. Entries of the array are x, y, anchorX, angle, chunk.\n */\nexport function drawTextOnPath(\n  flatCoordinates, offset, end, stride, text, measure, startM, maxAngle) {\n  const result = [];\n\n  // Keep text upright\n  const reverse = flatCoordinates[offset] > flatCoordinates[end - stride];\n\n  const numChars = text.length;\n\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  offset += stride;\n  let x2 = flatCoordinates[offset];\n  let y2 = flatCoordinates[offset + 1];\n  let segmentM = 0;\n  let segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n\n  let chunk = '';\n  let chunkLength = 0;\n  let data, index, previousAngle;\n  for (let i = 0; i < numChars; ++i) {\n    index = reverse ? numChars - i - 1 : i;\n    const char = text.charAt(index);\n    chunk = reverse ? char + chunk : chunk + char;\n    const charLength = measure(chunk) - chunkLength;\n    chunkLength += charLength;\n    const charM = startM + charLength / 2;\n    while (offset < end - stride && segmentM + segmentLength < charM) {\n      x1 = x2;\n      y1 = y2;\n      offset += stride;\n      x2 = flatCoordinates[offset];\n      y2 = flatCoordinates[offset + 1];\n      segmentM += segmentLength;\n      segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    }\n    const segmentPos = charM - segmentM;\n    let angle = Math.atan2(y2 - y1, x2 - x1);\n    if (reverse) {\n      angle += angle > 0 ? -Math.PI : Math.PI;\n    }\n    if (previousAngle !== undefined) {\n      let delta = angle - previousAngle;\n      delta += (delta > Math.PI) ? -2 * Math.PI : (delta < -Math.PI) ? 2 * Math.PI : 0;\n      if (Math.abs(delta) > maxAngle) {\n        return null;\n      }\n    }\n    const interpolate = segmentPos / segmentLength;\n    const x = lerp(x1, x2, interpolate);\n    const y = lerp(y1, y2, interpolate);\n    if (previousAngle == angle) {\n      if (reverse) {\n        data[0] = x;\n        data[1] = y;\n        data[2] = charLength / 2;\n      }\n      data[4] = chunk;\n    } else {\n      chunk = char;\n      chunkLength = charLength;\n      data = [x, y, charLength / 2, angle, chunk];\n      if (reverse) {\n        result.unshift(data);\n      } else {\n        result.push(data);\n      }\n      previousAngle = angle;\n    }\n    startM += charLength;\n  }\n  return result;\n}\n","/**\n * @module ol/geom/flat/transform\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function transform2D(flatCoordinates, offset, end, stride, transform, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const x = flatCoordinates[j];\n    const y = flatCoordinates[j + 1];\n    dest[i++] = transform[0] * x + transform[2] * y + transform[4];\n    dest[i++] = transform[1] * x + transform[3] * y + transform[5];\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} angle Angle.\n * @param {Array.<number>} anchor Rotation anchor point.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function rotate(flatCoordinates, offset, end, stride, angle, anchor, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + deltaX * cos - deltaY * sin;\n    dest[i++] = anchorY + deltaX * sin + deltaY * cos;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * Scale the coordinates.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} sx Scale factor in the x-direction.\n * @param {number} sy Scale factor in the y-direction.\n * @param {Array.<number>} anchor Scale anchor point.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function scale(flatCoordinates, offset, end, stride, sx, sy, anchor, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + sx * deltaX;\n    dest[i++] = anchorY + sy * deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function translate(flatCoordinates, offset, end, stride, deltaX, deltaY, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    dest[i++] = flatCoordinates[j] + deltaX;\n    dest[i++] = flatCoordinates[j + 1] + deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n","/**\n * @module ol/has\n */\nimport {HAS_WEBGL} from './index.js';\n\nconst ua = typeof navigator !== 'undefined' ?\n  navigator.userAgent.toLowerCase() : '';\n\n/**\n * User agent string says we are dealing with Firefox as browser.\n * @type {boolean}\n */\nexport const FIREFOX = ua.indexOf('firefox') !== -1;\n\n/**\n * User agent string says we are dealing with Safari as browser.\n * @type {boolean}\n */\nexport const SAFARI = ua.indexOf('safari') !== -1 && ua.indexOf('chrom') == -1;\n\n/**\n * User agent string says we are dealing with a WebKit engine.\n * @type {boolean}\n */\nexport const WEBKIT = ua.indexOf('webkit') !== -1 && ua.indexOf('edge') == -1;\n\n/**\n * User agent string says we are dealing with a Mac as platform.\n * @type {boolean}\n */\nexport const MAC = ua.indexOf('macintosh') !== -1;\n\n\n/**\n * The ratio between physical pixels and device-independent pixels\n * (dips) on the device (`window.devicePixelRatio`).\n * @const\n * @type {number}\n * @api\n */\nexport const DEVICE_PIXEL_RATIO = window.devicePixelRatio || 1;\n\n\n/**\n * True if the browser's Canvas implementation implements {get,set}LineDash.\n * @type {boolean}\n */\nexport const CANVAS_LINE_DASH = function() {\n  let has = false;\n  try {\n    has = !!document.createElement('CANVAS').getContext('2d').setLineDash;\n  } catch (e) {\n    // pass\n  }\n  return has;\n}();\n\n\n/**\n * Is HTML5 geolocation supported in the current browser?\n * @const\n * @type {boolean}\n * @api\n */\nexport const GEOLOCATION = 'geolocation' in navigator;\n\n\n/**\n * True if browser supports touch events.\n * @const\n * @type {boolean}\n * @api\n */\nexport const TOUCH = 'ontouchstart' in window;\n\n\n/**\n * True if browser supports pointer events.\n * @const\n * @type {boolean}\n */\nexport const POINTER = 'PointerEvent' in window;\n\n\n/**\n * True if browser supports ms pointer events (IE 10).\n * @const\n * @type {boolean}\n */\nexport const MSPOINTER = !!(navigator.msPointerEnabled);\n\n\n/**\n * True if both OpenLayers and browser support WebGL.\n * @const\n * @type {boolean}\n * @api\n */\nexport const WEBGL = HAS_WEBGL;\n","/**\n * @module ol\n */\n\nimport {getContext} from './webgl.js';\n\n\n/**\n * An array with two elements, representing a pixel. The first element is the\n * x-coordinate, the second the y-coordinate of the pixel.\n * @typedef {Array.<number>} Pixel\n * @api\n */\n\n\n/**\n * Include debuggable shader sources.  Default is `true`. This should be set to\n * `false` for production builds.\n * TODO: move to a separate ol-webgl package\n * @type {boolean}\n */\nexport const DEBUG_WEBGL = true;\n\n\n/**\n * TODO: move to a separate ol-webgl package\n * The maximum supported WebGL texture size in pixels. If WebGL is not\n * supported, the value is set to `undefined`.\n * @type {number|undefined}\n */\nlet WEBGL_MAX_TEXTURE_SIZE; // value is set below\n\n\n/**\n * TODO: move to a separate ol-webgl package\n * List of supported WebGL extensions.\n * @type {Array.<string>}\n */\nlet WEBGL_EXTENSIONS; // value is set below\n\n\n/**\n * TODO: move to a separate ol-webgl package\n * WebGL is available.\n * @type {boolean}\n */\nlet HAS_WEBGL = false;\n\n\nif (typeof window !== 'undefined' && 'WebGLRenderingContext' in window) {\n  try {\n    const canvas = /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS'));\n    const gl = getContext(canvas, {failIfMajorPerformanceCaveat: true});\n    if (gl) {\n      HAS_WEBGL = true;\n      WEBGL_MAX_TEXTURE_SIZE = /** @type {number} */ (gl.getParameter(gl.MAX_TEXTURE_SIZE));\n      WEBGL_EXTENSIONS = gl.getSupportedExtensions();\n    }\n  } catch (e) {\n    // pass\n  }\n}\n\nexport {HAS_WEBGL, WEBGL_MAX_TEXTURE_SIZE, WEBGL_EXTENSIONS};\n\n\n/**\n * OpenLayers version.\n * @type {string}\n */\nexport const VERSION = 'v4.6.4';\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * Usage:\n *\n *     function ParentClass(a, b) { }\n *     ParentClass.prototype.foo = function(a) { }\n *\n *     function ChildClass(a, b, c) {\n *       // Call parent constructor\n *       ParentClass.call(this, a, b);\n *     }\n *     inherits(ChildClass, ParentClass);\n *\n *     var child = new ChildClass('a', 'b', 'see');\n *     child.foo(); // This works.\n *\n * @param {!Function} childCtor Child constructor.\n * @param {!Function} parentCtor Parent constructor.\n * @function\n * @api\n */\nexport function inherits(childCtor, parentCtor) {\n  childCtor.prototype = Object.create(parentCtor.prototype);\n  childCtor.prototype.constructor = childCtor;\n}\n\n\n/**\n * Counter for getUid.\n * @type {number}\n * @private\n */\nlet uidCounter_ = 0;\n\n/**\n * Gets a unique ID for an object. This mutates the object so that further calls\n * with the same object as a parameter returns the same value. Unique IDs are generated\n * as a strictly increasing sequence. Adapted from goog.getUid.\n *\n * @param {Object} obj The object to get the unique ID for.\n * @return {number} The unique ID for the object.\n */\nexport function getUid(obj) {\n  return obj.ol_uid || (obj.ol_uid = ++uidCounter_);\n}\n","/**\n * @module ol/interaction\n */\nimport Collection from './Collection.js';\nimport Kinetic from './Kinetic.js';\nimport DoubleClickZoom from './interaction/DoubleClickZoom.js';\nimport DragPan from './interaction/DragPan.js';\nimport DragRotate from './interaction/DragRotate.js';\nimport DragZoom from './interaction/DragZoom.js';\nimport KeyboardPan from './interaction/KeyboardPan.js';\nimport KeyboardZoom from './interaction/KeyboardZoom.js';\nimport MouseWheelZoom from './interaction/MouseWheelZoom.js';\nimport PinchRotate from './interaction/PinchRotate.js';\nimport PinchZoom from './interaction/PinchZoom.js';\n\nexport {default as DoubleClickZoom} from './interaction/DoubleClickZoom.js';\nexport {default as DragAndDrop} from './interaction/DragAndDrop.js';\nexport {default as DragBox} from './interaction/DragBox.js';\nexport {default as DragPan} from './interaction/DragPan.js';\nexport {default as DragRotate} from './interaction/DragRotate.js';\nexport {default as DragRotateAndZoom} from './interaction/DragRotateAndZoom.js';\nexport {default as DragZoom} from './interaction/DragZoom.js';\nexport {default as Draw} from './interaction/Draw.js';\nexport {default as Extent} from './interaction/Extent.js';\nexport {default as Interaction} from './interaction/Interaction.js';\nexport {default as KeyboardPan} from './interaction/KeyboardPan.js';\nexport {default as KeyboardZoom} from './interaction/KeyboardZoom.js';\nexport {default as Modify} from './interaction/Modify.js';\nexport {default as MouseWheelZoom} from './interaction/MouseWheelZoom.js';\nexport {default as PinchRotate} from './interaction/PinchRotate.js';\nexport {default as PinchZoom} from './interaction/PinchZoom.js';\nexport {default as Pointer} from './interaction/Pointer.js';\nexport {default as Select} from './interaction/Select.js';\nexport {default as Snap} from './interaction/Snap.js';\nexport {default as Translate} from './interaction/Translate.js';\n\n\n/**\n * @typedef {Object} DefaultsOptions\n * @property {boolean} [altShiftDragRotate=true] Whether Alt-Shift-drag rotate is\n * desired.\n * @property {boolean} [constrainResolution=false] Zoom to the closest integer\n * zoom level after the wheel/trackpad or pinch gesture ends.\n * @property {boolean} [doubleClickZoom=true] Whether double click zoom is\n * desired.\n * @property {boolean} [keyboard=true] Whether keyboard interaction is desired.\n * @property {boolean} [mouseWheelZoom=true] Whether mousewheel zoom is desired.\n * @property {boolean} [shiftDragZoom=true] Whether Shift-drag zoom is desired.\n * @property {boolean} [dragPan=true] Whether drag pan is desired.\n * @property {boolean} [pinchRotate=true] Whether pinch rotate is desired.\n * @property {boolean} [pinchZoom=true] Whether pinch zoom is desired.\n * @property {number} [zoomDelta] Zoom level delta when using keyboard or\n * mousewheel zoom.\n * @property {number} [zoomDuration] Duration of the zoom animation in\n * milliseconds.\n */\n\n\n/**\n * Set of interactions included in maps by default. Specific interactions can be\n * excluded by setting the appropriate option to false in the constructor\n * options, but the order of the interactions is fixed.  If you want to specify\n * a different order for interactions, you will need to create your own\n * {@link module:ol/interaction/Interaction} instances and insert\n * them into a {@link module:ol/Collection} in the order you want\n * before creating your {@link module:ol/Map~Map} instance. The default set of\n * interactions, in sequence, is:\n * * {@link module:ol/interaction/DragRotate~DragRotate}\n * * {@link module:ol/interaction/DoubleClickZoom~DoubleClickZoom}\n * * {@link module:ol/interaction/DragPan~DragPan}\n * * {@link module:ol/interaction/PinchRotate~PinchRotate}\n * * {@link module:ol/interaction/PinchZoom~PinchZoom}\n * * {@link module:ol/interaction/KeyboardPan~KeyboardPan}\n * * {@link module:ol/interaction/KeyboardZoom~KeyboardZoom}\n * * {@link module:ol/interaction/MouseWheelZoom~MouseWheelZoom}\n * * {@link module:ol/interaction/DragZoom~DragZoom}\n *\n * @param {module:ol/interaction/Interaction~DefaultsOptions=} opt_options\n * Defaults options.\n * @return {module:ol/Collection.<module:ol/interaction/Interaction>}\n * A collection of interactions to be used with the {@link module:ol/Map~Map}\n * constructor's `interactions` option.\n * @api\n */\nexport function defaults(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const interactions = new Collection();\n\n  const kinetic = new Kinetic(-0.005, 0.05, 100);\n\n  const altShiftDragRotate = options.altShiftDragRotate !== undefined ?\n    options.altShiftDragRotate : true;\n  if (altShiftDragRotate) {\n    interactions.push(new DragRotate());\n  }\n\n  const doubleClickZoom = options.doubleClickZoom !== undefined ?\n    options.doubleClickZoom : true;\n  if (doubleClickZoom) {\n    interactions.push(new DoubleClickZoom({\n      delta: options.zoomDelta,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const dragPan = options.dragPan !== undefined ? options.dragPan : true;\n  if (dragPan) {\n    interactions.push(new DragPan({\n      kinetic: kinetic\n    }));\n  }\n\n  const pinchRotate = options.pinchRotate !== undefined ? options.pinchRotate :\n    true;\n  if (pinchRotate) {\n    interactions.push(new PinchRotate());\n  }\n\n  const pinchZoom = options.pinchZoom !== undefined ? options.pinchZoom : true;\n  if (pinchZoom) {\n    interactions.push(new PinchZoom({\n      constrainResolution: options.constrainResolution,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const keyboard = options.keyboard !== undefined ? options.keyboard : true;\n  if (keyboard) {\n    interactions.push(new KeyboardPan());\n    interactions.push(new KeyboardZoom({\n      delta: options.zoomDelta,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const mouseWheelZoom = options.mouseWheelZoom !== undefined ?\n    options.mouseWheelZoom : true;\n  if (mouseWheelZoom) {\n    interactions.push(new MouseWheelZoom({\n      constrainResolution: options.constrainResolution,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const shiftDragZoom = options.shiftDragZoom !== undefined ?\n    options.shiftDragZoom : true;\n  if (shiftDragZoom) {\n    interactions.push(new DragZoom({\n      duration: options.zoomDuration\n    }));\n  }\n\n  return interactions;\n\n}\n","/**\n * @module ol/interaction/DoubleClickZoom\n */\nimport {inherits} from '../index.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport Interaction, {zoomByDelta} from '../interaction/Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {number} [delta=1] The zoom delta applied on each double click.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom by double-clicking on the map.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/DoubleClickZoom~Options=} opt_options Options.\n * @api\n */\nconst DoubleClickZoom = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delta_ = options.delta ? options.delta : 1;\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n};\n\ninherits(DoubleClickZoom, Interaction);\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} (if it was a\n * doubleclick) and eventually zooms the map.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/DoubleClickZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  const browserEvent = mapBrowserEvent.originalEvent;\n  if (mapBrowserEvent.type == MapBrowserEventType.DBLCLICK) {\n    const map = mapBrowserEvent.map;\n    const anchor = mapBrowserEvent.coordinate;\n    const delta = browserEvent.shiftKey ? -this.delta_ : this.delta_;\n    const view = map.getView();\n    zoomByDelta(view, delta, anchor, this.duration_);\n    mapBrowserEvent.preventDefault();\n    stopEvent = true;\n  }\n  return !stopEvent;\n}\n\nexport default DoubleClickZoom;\n","/**\n * @module ol/interaction/DragAndDrop\n */\n// FIXME should handle all geo-referenced data, not just vector data\n\nimport {inherits} from '../index.js';\nimport {TRUE} from '../functions.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport Interaction from '../interaction/Interaction.js';\nimport {get as getProjection} from '../proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Array.<function(new: module:ol/format/Feature)>} [formatConstructors] Format constructors.\n * @property {module:ol/source/Vector} [source] Optional vector source where features will be added.  If a source is provided\n * all existing features will be removed and new features will be added when\n * they are dropped on the target.  If you want to add features to a vector\n * source without removing the existing features (append only), instead of\n * providing the source option listen for the \"addfeatures\" event.\n * @property {module:ol/proj~ProjectionLike} [projection] Target projection. By default, the map's view's projection is used.\n * @property {Element} [target] The element that is used as the drop target, default is the viewport element.\n */\n\n\n/**\n * @enum {string}\n */\nconst DragAndDropEventType = {\n  /**\n   * Triggered when features are added\n   * @event module:ol/interaction/DragAndDrop~DragAndDropEvent#addfeatures\n   * @api\n   */\n  ADD_FEATURES: 'addfeatures'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragAndDrop~DragAndDrop} instances are instances\n * of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/interaction/DragAndDrop~DragAndDropEventType} type Type.\n * @param {File} file File.\n * @param {Array.<module:ol/Feature>=} opt_features Features.\n * @param {module:ol/proj/Projection=} opt_projection Projection.\n */\nconst DragAndDropEvent = function(type, file, opt_features, opt_projection) {\n\n  Event.call(this, type);\n\n  /**\n   * The features parsed from dropped data.\n   * @type {Array.<module:ol/Feature>|undefined}\n   * @api\n   */\n  this.features = opt_features;\n\n  /**\n   * The dropped file.\n   * @type {File}\n   * @api\n   */\n  this.file = file;\n\n  /**\n   * The feature projection.\n   * @type {module:ol/proj/Projection|undefined}\n   * @api\n   */\n  this.projection = opt_projection;\n\n};\ninherits(DragAndDropEvent, Event);\n\n\n/**\n * @classdesc\n * Handles input of vector data by drag and drop.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @fires module:ol/interaction/DragAndDrop~DragAndDropEvent\n * @param {module:ol/interaction/DragAndDrop~Options=} opt_options Options.\n * @api\n */\nconst DragAndDrop = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  Interaction.call(this, {\n    handleEvent: TRUE\n  });\n\n  /**\n   * @private\n   * @type {Array.<function(new: module:ol/format/Feature)>}\n   */\n  this.formatConstructors_ = options.formatConstructors ?\n    options.formatConstructors : [];\n\n  /**\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = options.projection ?\n    getProjection(options.projection) : null;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.dropListenKeys_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/source/Vector}\n   */\n  this.source_ = options.source || null;\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.target = options.target ? options.target : null;\n\n};\n\ninherits(DragAndDrop, Interaction);\n\n\n/**\n * @param {DragEvent} event Event.\n * @this {module:ol/interaction/DragAndDrop}\n */\nfunction handleDrop(event) {\n  const files = event.dataTransfer.files;\n  for (let i = 0, ii = files.length; i < ii; ++i) {\n    const file = files.item(i);\n    const reader = new FileReader();\n    reader.addEventListener(EventType.LOAD, this.handleResult_.bind(this, file));\n    reader.readAsText(file);\n  }\n}\n\n\n/**\n * @param {DragEvent} event Event.\n */\nfunction handleStop(event) {\n  event.stopPropagation();\n  event.preventDefault();\n  event.dataTransfer.dropEffect = 'copy';\n}\n\n\n/**\n * @param {File} file File.\n * @param {Event} event Load event.\n * @private\n */\nDragAndDrop.prototype.handleResult_ = function(file, event) {\n  const result = event.target.result;\n  const map = this.getMap();\n  let projection = this.projection_;\n  if (!projection) {\n    const view = map.getView();\n    projection = view.getProjection();\n  }\n\n  const formatConstructors = this.formatConstructors_;\n  let features = [];\n  for (let i = 0, ii = formatConstructors.length; i < ii; ++i) {\n    /**\n     * Avoid \"cannot instantiate abstract class\" error.\n     * @type {Function}\n     */\n    const formatConstructor = formatConstructors[i];\n    /**\n     * @type {module:ol/format/Feature}\n     */\n    const format = new formatConstructor();\n    features = this.tryReadFeatures_(format, result, {\n      featureProjection: projection\n    });\n    if (features && features.length > 0) {\n      break;\n    }\n  }\n  if (this.source_) {\n    this.source_.clear();\n    this.source_.addFeatures(features);\n  }\n  this.dispatchEvent(\n    new DragAndDropEvent(\n      DragAndDropEventType.ADD_FEATURES, file,\n      features, projection));\n};\n\n\n/**\n * @private\n */\nDragAndDrop.prototype.registerListeners_ = function() {\n  const map = this.getMap();\n  if (map) {\n    const dropArea = this.target ? this.target : map.getViewport();\n    this.dropListenKeys_ = [\n      listen(dropArea, EventType.DROP, handleDrop, this),\n      listen(dropArea, EventType.DRAGENTER, handleStop, this),\n      listen(dropArea, EventType.DRAGOVER, handleStop, this),\n      listen(dropArea, EventType.DROP, handleStop, this)\n    ];\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nDragAndDrop.prototype.setActive = function(active) {\n  Interaction.prototype.setActive.call(this, active);\n  if (active) {\n    this.registerListeners_();\n  } else {\n    this.unregisterListeners_();\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nDragAndDrop.prototype.setMap = function(map) {\n  this.unregisterListeners_();\n  Interaction.prototype.setMap.call(this, map);\n  if (this.getActive()) {\n    this.registerListeners_();\n  }\n};\n\n\n/**\n * @param {module:ol/format/Feature} format Format.\n * @param {string} text Text.\n * @param {module:ol/format/Feature~ReadOptions} options Read options.\n * @private\n * @return {Array.<module:ol/Feature>} Features.\n */\nDragAndDrop.prototype.tryReadFeatures_ = function(format, text, options) {\n  try {\n    return format.readFeatures(text, options);\n  } catch (e) {\n    return null;\n  }\n};\n\n\n/**\n * @private\n */\nDragAndDrop.prototype.unregisterListeners_ = function() {\n  if (this.dropListenKeys_) {\n    this.dropListenKeys_.forEach(unlistenByKey);\n    this.dropListenKeys_ = null;\n  }\n};\n\n\nexport default DragAndDrop;\n","/**\n * @module ol/interaction/DragBox\n */\n// FIXME draw drag box\nimport Event from '../events/Event.js';\nimport {inherits} from '../index.js';\nimport {always, mouseOnly, mouseActionButton} from '../events/condition.js';\nimport {UNDEFINED} from '../functions.js';\nimport PointerInteraction from '../interaction/Pointer.js';\nimport RenderBox from '../render/Box.js';\n\n\n/**\n * A function that takes a {@link module:ol/MapBrowserEvent} and two\n * {@link module:ol~Pixel}s and returns a `{boolean}`. If the condition is met,\n * true should be returned.\n * @typedef {function(this: ?, module:ol/MapBrowserEvent, module:ol~Pixel, module:ol~Pixel):boolean} EndCondition\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-dragbox'] CSS class name for styling the box.\n * @property {module:ol/events/condition~Condition} [condition] A function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link ol/events/condition~always}.\n * @property {number} [minArea=64] The minimum area of the box in pixel, this value is used by the default\n * `boxEndCondition` function.\n * @property {module:ol/interaction/DragBox~EndCondition} [boxEndCondition] A function that takes a {@link module:ol/MapBrowserEvent~MapBrowserEvent} and two\n * {@link module:ol~Pixel}s to indicate whether a `boxend` event should be fired.\n * Default is `true` if the area of the box is bigger than the `minArea` option.\n */\n\n\n/**\n * @enum {string}\n */\nconst DragBoxEventType = {\n  /**\n   * Triggered upon drag box start.\n   * @event module:ol/interaction/DragBox~DragBoxEvent#boxstart\n   * @api\n   */\n  BOXSTART: 'boxstart',\n\n  /**\n   * Triggered on drag when box is active.\n   * @event module:ol/interaction/DragBox~DragBoxEvent#boxdrag\n   * @api\n   */\n  BOXDRAG: 'boxdrag',\n\n  /**\n   * Triggered upon drag box end.\n   * @event module:ol/interaction/DragBox~DragBoxEvent#boxend\n   * @api\n   */\n  BOXEND: 'boxend'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragBox~DragBox} instances are instances of\n * this type.\n *\n * @param {string} type The event type.\n * @param {module:ol/coordinate~Coordinate} coordinate The event coordinate.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Originating event.\n * @extends {module:ol/events/Event}\n * @constructor\n */\nconst DragBoxEvent = function(type, coordinate, mapBrowserEvent) {\n  Event.call(this, type);\n\n  /**\n   * The coordinate of the drag event.\n   * @const\n   * @type {module:ol/coordinate~Coordinate}\n   * @api\n   */\n  this.coordinate = coordinate;\n\n  /**\n   * @const\n   * @type {module:ol/MapBrowserEvent}\n   * @api\n   */\n  this.mapBrowserEvent = mapBrowserEvent;\n\n};\n\ninherits(DragBoxEvent, Event);\n\n\n/**\n * @classdesc\n * Allows the user to draw a vector box by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when the shift or other key is held down. This is used, for example,\n * for zooming to a specific area of the map\n * (see {@link module:ol/interaction/DragZoom~DragZoom} and\n * {@link module:ol/interaction/DragRotateAndZoom}).\n *\n * This interaction is only supported for mouse devices.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/DragBox~DragBoxEvent\n * @param {module:ol/interaction/DragBox~Options=} opt_options Options.\n * @api\n */\nconst DragBox = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/render/Box}\n   * @private\n   */\n  this.box_ = new RenderBox(options.className || 'ol-dragbox');\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minArea_ = options.minArea !== undefined ? options.minArea : 64;\n\n  /**\n   * @type {module:ol~Pixel}\n   * @private\n   */\n  this.startPixel_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : always;\n\n  /**\n   * @private\n   * @type {module:ol/interaction/DragBox~EndCondition}\n   */\n  this.boxEndCondition_ = options.boxEndCondition ?\n    options.boxEndCondition : defaultBoxEndCondition;\n};\n\ninherits(DragBox, PointerInteraction);\n\n\n/**\n * The default condition for determining whether the boxend event\n * should fire.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent The originating MapBrowserEvent\n *     leading to the box end.\n * @param {module:ol~Pixel} startPixel The starting pixel of the box.\n * @param {module:ol~Pixel} endPixel The end pixel of the box.\n * @return {boolean} Whether or not the boxend condition should be fired.\n * @this {module:ol/interaction/DragBox}\n */\nfunction defaultBoxEndCondition(mapBrowserEvent, startPixel, endPixel) {\n  const width = endPixel[0] - startPixel[0];\n  const height = endPixel[1] - startPixel[1];\n  return width * width + height * height >= this.minArea_;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragBox}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return;\n  }\n\n  this.box_.setPixels(this.startPixel_, mapBrowserEvent.pixel);\n\n  this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXDRAG,\n    mapBrowserEvent.coordinate, mapBrowserEvent));\n}\n\n\n/**\n * Returns geometry of last drawn box.\n * @return {module:ol/geom/Polygon} Geometry.\n * @api\n */\nDragBox.prototype.getGeometry = function() {\n  return this.box_.getGeometry();\n};\n\n\n/**\n * To be overridden by child classes.\n * FIXME: use constructor option instead of relying on overriding.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @protected\n */\nDragBox.prototype.onBoxEnd = UNDEFINED;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragBox}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return true;\n  }\n\n  this.box_.setMap(null);\n\n  if (this.boxEndCondition_(mapBrowserEvent,\n    this.startPixel_, mapBrowserEvent.pixel)) {\n    this.onBoxEnd(mapBrowserEvent);\n    this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXEND,\n      mapBrowserEvent.coordinate, mapBrowserEvent));\n  }\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragBox}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return false;\n  }\n\n  if (mouseActionButton(mapBrowserEvent) &&\n      this.condition_(mapBrowserEvent)) {\n    this.startPixel_ = mapBrowserEvent.pixel;\n    this.box_.setMap(mapBrowserEvent.map);\n    this.box_.setPixels(this.startPixel_, this.startPixel_);\n    this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXSTART,\n      mapBrowserEvent.coordinate, mapBrowserEvent));\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\nexport default DragBox;\n","/**\n * @module ol/interaction/DragPan\n */\nimport {inherits} from '../index.js';\nimport ViewHint from '../ViewHint.js';\nimport {scale as scaleCoordinate, rotate as rotateCoordinate, add as addCoordinate} from '../coordinate.js';\nimport {easeOut} from '../easing.js';\nimport {noModifierKeys} from '../events/condition.js';\nimport {FALSE} from '../functions.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~noModifierKeys}.\n * @property {module:ol/Kinetic} [kinetic] Kinetic inertia to apply to the pan.\n */\n\n\n/**\n * @classdesc\n * Allows the user to pan the map by dragging the map.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/DragPan~Options=} opt_options Options.\n * @api\n */\nconst DragPan = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {module:ol/Kinetic|undefined}\n   */\n  this.kinetic_ = options.kinetic;\n\n  /**\n   * @type {module:ol~Pixel}\n   */\n  this.lastCentroid = null;\n\n  /**\n   * @type {number}\n   */\n  this.lastPointersCount_;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : noModifierKeys;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.noKinetic_ = false;\n\n};\n\ninherits(DragPan, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragPan}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  const targetPointers = this.targetPointers;\n  const centroid = centroidFromPointers(targetPointers);\n  if (targetPointers.length == this.lastPointersCount_) {\n    if (this.kinetic_) {\n      this.kinetic_.update(centroid[0], centroid[1]);\n    }\n    if (this.lastCentroid) {\n      const deltaX = this.lastCentroid[0] - centroid[0];\n      const deltaY = centroid[1] - this.lastCentroid[1];\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      let center = [deltaX, deltaY];\n      scaleCoordinate(center, view.getResolution());\n      rotateCoordinate(center, view.getRotation());\n      addCoordinate(center, view.getCenter());\n      center = view.constrainCenter(center);\n      view.setCenter(center);\n    }\n  } else if (this.kinetic_) {\n    // reset so we don't overestimate the kinetic energy after\n    // after one finger down, tiny drag, second finger down\n    this.kinetic_.begin();\n  }\n  this.lastCentroid = centroid;\n  this.lastPointersCount_ = targetPointers.length;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragPan}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  if (this.targetPointers.length === 0) {\n    if (!this.noKinetic_ && this.kinetic_ && this.kinetic_.end()) {\n      const distance = this.kinetic_.getDistance();\n      const angle = this.kinetic_.getAngle();\n      const center = /** @type {!module:ol/coordinate~Coordinate} */ (view.getCenter());\n      const centerpx = map.getPixelFromCoordinate(center);\n      const dest = map.getCoordinateFromPixel([\n        centerpx[0] - distance * Math.cos(angle),\n        centerpx[1] - distance * Math.sin(angle)\n      ]);\n      view.animate({\n        center: view.constrainCenter(dest),\n        duration: 500,\n        easing: easeOut\n      });\n    }\n    view.setHint(ViewHint.INTERACTING, -1);\n    return false;\n  } else {\n    if (this.kinetic_) {\n      // reset so we don't overestimate the kinetic energy after\n      // after one finger up, tiny drag, second finger up\n      this.kinetic_.begin();\n    }\n    this.lastCentroid = null;\n    return true;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragPan}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (this.targetPointers.length > 0 && this.condition_(mapBrowserEvent)) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    this.lastCentroid = null;\n    if (!this.handlingDownUpSequence) {\n      view.setHint(ViewHint.INTERACTING, 1);\n    }\n    // stop any current animation\n    if (view.getAnimating()) {\n      view.setCenter(mapBrowserEvent.frameState.viewState.center);\n    }\n    if (this.kinetic_) {\n      this.kinetic_.begin();\n    }\n    // No kinetic as soon as more than one pointer on the screen is\n    // detected. This is to prevent nasty pans after pinch.\n    this.noKinetic_ = this.targetPointers.length > 1;\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nDragPan.prototype.shouldStopEvent = FALSE;\nexport default DragPan;\n","/**\n * @module ol/interaction/DragRotate\n */\nimport {inherits} from '../index.js';\nimport {disable} from '../rotationconstraint.js';\nimport ViewHint from '../ViewHint.js';\nimport {altShiftKeysOnly, mouseOnly, mouseActionButton} from '../events/condition.js';\nimport {FALSE} from '../functions.js';\nimport {rotate, rotateWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that takes an\n * {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~altShiftKeysOnly}.\n * @property {number} [duration=250] Animation duration in milliseconds.\n */\n\n\n/**\n * @classdesc\n * Allows the user to rotate the map by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when the alt and shift keys are held down.\n *\n * This interaction is only supported for mouse devices.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/DragRotate~Options=} opt_options Options.\n * @api\n */\nconst DragRotate = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : altShiftKeysOnly;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastAngle_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n};\n\ninherits(DragRotate, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragRotate}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return;\n  }\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  if (view.getConstraints().rotation === disable) {\n    return;\n  }\n  const size = map.getSize();\n  const offset = mapBrowserEvent.pixel;\n  const theta =\n      Math.atan2(size[1] / 2 - offset[1], offset[0] - size[0] / 2);\n  if (this.lastAngle_ !== undefined) {\n    const delta = theta - this.lastAngle_;\n    const rotation = view.getRotation();\n    rotateWithoutConstraints(view, rotation - delta);\n  }\n  this.lastAngle_ = theta;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragRotate}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return true;\n  }\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  view.setHint(ViewHint.INTERACTING, -1);\n  const rotation = view.getRotation();\n  rotate(view, rotation, undefined, this.duration_);\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragRotate}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return false;\n  }\n\n  if (mouseActionButton(mapBrowserEvent) && this.condition_(mapBrowserEvent)) {\n    const map = mapBrowserEvent.map;\n    map.getView().setHint(ViewHint.INTERACTING, 1);\n    this.lastAngle_ = undefined;\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nDragRotate.prototype.shouldStopEvent = FALSE;\nexport default DragRotate;\n","/**\n * @module ol/interaction/DragRotateAndZoom\n */\nimport {inherits} from '../index.js';\nimport {disable} from '../rotationconstraint.js';\nimport ViewHint from '../ViewHint.js';\nimport {shiftKeyOnly, mouseOnly} from '../events/condition.js';\nimport {rotate, rotateWithoutConstraints, zoom, zoomWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\n * @property {number} [duration=400] Animation duration in milliseconds.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom and rotate the map by clicking and dragging\n * on the map.  By default, this interaction is limited to when the shift\n * key is held down.\n *\n * This interaction is only supported for mouse devices.\n *\n * And this interaction is not included in the default interactions.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/DragRotateAndZoom~Options=} opt_options Options.\n * @api\n */\nconst DragRotateAndZoom = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : shiftKeyOnly;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastAngle_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastMagnitude_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.lastScaleDelta_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 400;\n\n};\n\ninherits(DragRotateAndZoom, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragRotateAndZoom}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return;\n  }\n\n  const map = mapBrowserEvent.map;\n  const size = map.getSize();\n  const offset = mapBrowserEvent.pixel;\n  const deltaX = offset[0] - size[0] / 2;\n  const deltaY = size[1] / 2 - offset[1];\n  const theta = Math.atan2(deltaY, deltaX);\n  const magnitude = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n  const view = map.getView();\n  if (view.getConstraints().rotation !== disable && this.lastAngle_ !== undefined) {\n    const angleDelta = theta - this.lastAngle_;\n    rotateWithoutConstraints(view, view.getRotation() - angleDelta);\n  }\n  this.lastAngle_ = theta;\n  if (this.lastMagnitude_ !== undefined) {\n    const resolution = this.lastMagnitude_ * (view.getResolution() / magnitude);\n    zoomWithoutConstraints(view, resolution);\n  }\n  if (this.lastMagnitude_ !== undefined) {\n    this.lastScaleDelta_ = this.lastMagnitude_ / magnitude;\n  }\n  this.lastMagnitude_ = magnitude;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragRotateAndZoom}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return true;\n  }\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  view.setHint(ViewHint.INTERACTING, -1);\n  const direction = this.lastScaleDelta_ - 1;\n  rotate(view, view.getRotation());\n  zoom(view, view.getResolution(), undefined, this.duration_, direction);\n  this.lastScaleDelta_ = 0;\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragRotateAndZoom}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return false;\n  }\n\n  if (this.condition_(mapBrowserEvent)) {\n    mapBrowserEvent.map.getView().setHint(ViewHint.INTERACTING, 1);\n    this.lastAngle_ = undefined;\n    this.lastMagnitude_ = undefined;\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport default DragRotateAndZoom;\n","/**\n * @module ol/interaction/DragZoom\n */\nimport {inherits} from '../index.js';\nimport {easeOut} from '../easing.js';\nimport {shiftKeyOnly} from '../events/condition.js';\nimport {createOrUpdateFromCoordinates, getBottomLeft, getCenter, getTopRight, scaleFromCenter} from '../extent.js';\nimport DragBox from '../interaction/DragBox.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-dragzoom'] CSS class name for styling the\n * box.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\n * @property {number} [duration=200] Animation duration in milliseconds.\n * @property {boolean} [out=false] Use interaction for zooming out.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when a key, shift by default, is held down.\n *\n * To change the style of the box, use CSS and the `.ol-dragzoom` selector, or\n * your custom one configured with `className`.\n *\n * @constructor\n * @extends {module:ol/interaction/DragBox}\n * @param {module:ol/interaction/DragZoom~Options=} opt_options Options.\n * @api\n */\nconst DragZoom = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  const condition = options.condition ? options.condition : shiftKeyOnly;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 200;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.out_ = options.out !== undefined ? options.out : false;\n\n  DragBox.call(this, {\n    condition: condition,\n    className: options.className || 'ol-dragzoom'\n  });\n\n};\n\ninherits(DragZoom, DragBox);\n\n\n/**\n * @inheritDoc\n */\nDragZoom.prototype.onBoxEnd = function() {\n  const map = this.getMap();\n\n  const view = /** @type {!module:ol/View} */ (map.getView());\n\n  const size = /** @type {!module:ol/size~Size} */ (map.getSize());\n\n  let extent = this.getGeometry().getExtent();\n\n  if (this.out_) {\n    const mapExtent = view.calculateExtent(size);\n    const boxPixelExtent = createOrUpdateFromCoordinates([\n      map.getPixelFromCoordinate(getBottomLeft(extent)),\n      map.getPixelFromCoordinate(getTopRight(extent))]);\n    const factor = view.getResolutionForExtent(boxPixelExtent, size);\n\n    scaleFromCenter(mapExtent, 1 / factor);\n    extent = mapExtent;\n  }\n\n  const resolution = view.constrainResolution(\n    view.getResolutionForExtent(extent, size));\n\n  let center = getCenter(extent);\n  center = view.constrainCenter(center);\n\n  view.animate({\n    resolution: resolution,\n    center: center,\n    duration: this.duration_,\n    easing: easeOut\n  });\n\n};\nexport default DragZoom;\n","/**\n * @module ol/interaction/Draw\n */\nimport {inherits} from '../index.js';\nimport EventType from '../events/EventType.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {getChangeEventType} from '../Object.js';\nimport {squaredDistance as squaredCoordinateDistance} from '../coordinate.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport {noModifierKeys, always, shiftKeyOnly} from '../events/condition.js';\nimport {boundingExtent, getBottomLeft, getBottomRight, getTopLeft, getTopRight} from '../extent.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport Circle from '../geom/Circle.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport {POINTER_TYPE} from '../pointer/MouseSource.js';\nimport Point from '../geom/Point.js';\nimport Polygon, {fromCircle, makeRegular} from '../geom/Polygon.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport InteractionProperty from '../interaction/Property.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/geom/GeometryType} type Geometry type of\n * the geometries being drawn with this instance.\n * @property {number} [clickTolerance=6] The maximum distance in pixels between\n * \"down\" and \"up\" for a \"up\" event to be considered a \"click\" event and\n * actually add a point/vertex to the geometry being drawn.  The default of `6`\n * was chosen for the draw interaction to behave correctly on mouse as well as\n * on touch devices.\n * @property {module:ol/Collection.<module:ol/Feature>} [features]\n * Destination collection for the drawn features.\n * @property {module:ol/source/Vector} [source] Destination source for\n * the drawn features.\n * @property {number} [dragVertexDelay=500] Delay in milliseconds after pointerdown\n * before the current vertex can be dragged to its exact position.\n * @property {number} [snapTolerance=12] Pixel distance for snapping to the\n * drawing finish.\n * @property {boolean} [stopClick=false] Stop click, singleclick, and\n * doubleclick events from firing during drawing.\n * @property {number} [maxPoints] The number of points that can be drawn before\n * a polygon ring or line string is finished. By default there is no\n * restriction.\n * @property {number} [minPoints] The number of points that must be drawn\n * before a polygon ring or line string can be finished. Default is `3` for\n * polygon rings and `2` for line strings.\n * @property {module:ol/events/condition~Condition} [finishCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether the drawing can be finished.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style]\n * Style for sketch features.\n * @property {module:ol/interaction/Draw~GeometryFunction} [geometryFunction]\n * Function that is called when a geometry's coordinates are updated.\n * @property {string} [geometryName] Geometry name to use for features created\n * by the draw interaction.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default {@link module:ol/events/condition~noModifierKeys}, i.e. a click,\n * adds a vertex or deactivates freehand drawing.\n * @property {boolean} [freehand=false] Operate in freehand mode for lines,\n * polygons, and circles.  This makes the interaction always operate in freehand\n * mode and takes precedence over any `freehandCondition` option.\n * @property {module:ol/events/condition~Condition} [freehandCondition]\n * Condition that activates freehand drawing for lines and polygons. This\n * function takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and\n * returns a boolean to indicate whether that event should be handled. The\n * default is {@link module:ol/events/condition~shiftKeyOnly}, meaning that the\n * Shift key activates freehand drawing.\n * @property {boolean} [wrapX=false] Wrap the world horizontally on the sketch\n * overlay.\n */\n\n\n/**\n * Function that takes an array of coordinates and an optional existing geometry as\n * arguments, and returns a geometry. The optional existing geometry is the\n * geometry that is returned when the function is called without a second\n * argument.\n * @typedef {function(!Array.<module:ol/coordinate~Coordinate>, module:ol/geom/SimpleGeometry=):\n *     module:ol/geom/SimpleGeometry} GeometryFunction\n */\n\n\n/**\n * Draw mode.  This collapses multi-part geometry types with their single-part\n * cousins.\n * @enum {string}\n */\nconst Mode = {\n  POINT: 'Point',\n  LINE_STRING: 'LineString',\n  POLYGON: 'Polygon',\n  CIRCLE: 'Circle'\n};\n\n\n/**\n * @enum {string}\n */\nconst DrawEventType = {\n  /**\n   * Triggered upon feature draw start\n   * @event module:ol/interaction/Draw~DrawEvent#drawstart\n   * @api\n   */\n  DRAWSTART: 'drawstart',\n  /**\n   * Triggered upon feature draw end\n   * @event module:ol/interaction/Draw~DrawEvent#drawend\n   * @api\n   */\n  DRAWEND: 'drawend'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Draw~Draw} instances are\n * instances of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/interaction/Draw~DrawEventType} type Type.\n * @param {module:ol/Feature} feature The feature drawn.\n */\nconst DrawEvent = function(type, feature) {\n\n  Event.call(this, type);\n\n  /**\n   * The feature being drawn.\n   * @type {module:ol/Feature}\n   * @api\n   */\n  this.feature = feature;\n\n};\n\ninherits(DrawEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for drawing feature geometries.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/Draw~DrawEvent\n * @param {module:ol/interaction/Draw~Options} options Options.\n * @api\n */\nconst Draw = function(options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleEvent: handleEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.shouldHandle_ = false;\n\n  /**\n   * @type {module:ol~Pixel}\n   * @private\n   */\n  this.downPx_ = null;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.downTimeout_;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.lastDragTime_;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.freehand_ = false;\n\n  /**\n   * Target source for drawn features.\n   * @type {module:ol/source/Vector}\n   * @private\n   */\n  this.source_ = options.source ? options.source : null;\n\n  /**\n   * Target collection for drawn features.\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = options.features ? options.features : null;\n\n  /**\n   * Pixel distance for snapping.\n   * @type {number}\n   * @private\n   */\n  this.snapTolerance_ = options.snapTolerance ? options.snapTolerance : 12;\n\n  /**\n   * Geometry type.\n   * @type {module:ol/geom/GeometryType}\n   * @private\n   */\n  this.type_ = /** @type {module:ol/geom/GeometryType} */ (options.type);\n\n  /**\n   * Drawing mode (derived from geometry type.\n   * @type {module:ol/interaction/Draw~Mode}\n   * @private\n   */\n  this.mode_ = getMode(this.type_);\n\n  /**\n   * Stop click, singleclick, and doubleclick events from firing during drawing.\n   * Default is `false`.\n   * @type {boolean}\n   * @private\n   */\n  this.stopClick_ = !!options.stopClick;\n\n  /**\n   * The number of points that must be drawn before a polygon ring or line\n   * string can be finished.  The default is 3 for polygon rings and 2 for\n   * line strings.\n   * @type {number}\n   * @private\n   */\n  this.minPoints_ = options.minPoints ?\n    options.minPoints :\n    (this.mode_ === Mode.POLYGON ? 3 : 2);\n\n  /**\n   * The number of points that can be drawn before a polygon ring or line string\n   * is finished. The default is no restriction.\n   * @type {number}\n   * @private\n   */\n  this.maxPoints_ = options.maxPoints ? options.maxPoints : Infinity;\n\n  /**\n   * A function to decide if a potential finish coordinate is permissible\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.finishCondition_ = options.finishCondition ? options.finishCondition : TRUE;\n\n  let geometryFunction = options.geometryFunction;\n  if (!geometryFunction) {\n    if (this.type_ === GeometryType.CIRCLE) {\n      /**\n       * @param {!Array.<module:ol/coordinate~Coordinate>} coordinates\n       *     The coordinates.\n       * @param {module:ol/geom/SimpleGeometry=} opt_geometry Optional geometry.\n       * @return {module:ol/geom/SimpleGeometry} A geometry.\n       */\n      geometryFunction = function(coordinates, opt_geometry) {\n        const circle = opt_geometry ? /** @type {module:ol/geom/Circle} */ (opt_geometry) :\n          new Circle([NaN, NaN]);\n        const squaredLength = squaredCoordinateDistance(\n          coordinates[0], coordinates[1]);\n        circle.setCenterAndRadius(coordinates[0], Math.sqrt(squaredLength));\n        return circle;\n      };\n    } else {\n      let Constructor;\n      const mode = this.mode_;\n      if (mode === Mode.POINT) {\n        Constructor = Point;\n      } else if (mode === Mode.LINE_STRING) {\n        Constructor = LineString;\n      } else if (mode === Mode.POLYGON) {\n        Constructor = Polygon;\n      }\n      /**\n       * @param {!Array.<module:ol/coordinate~Coordinate>} coordinates\n       *     The coordinates.\n       * @param {module:ol/geom/SimpleGeometry=} opt_geometry Optional geometry.\n       * @return {module:ol/geom/SimpleGeometry} A geometry.\n       */\n      geometryFunction = function(coordinates, opt_geometry) {\n        let geometry = opt_geometry;\n        if (geometry) {\n          if (mode === Mode.POLYGON) {\n            if (coordinates[0].length) {\n              // Add a closing coordinate to match the first\n              geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n            } else {\n              geometry.setCoordinates([]);\n            }\n          } else {\n            geometry.setCoordinates(coordinates);\n          }\n        } else {\n          geometry = new Constructor(coordinates);\n        }\n        return geometry;\n      };\n    }\n  }\n\n  /**\n   * @type {module:ol/interaction/Draw~GeometryFunction}\n   * @private\n   */\n  this.geometryFunction_ = geometryFunction;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.dragVertexDelay_ = options.dragVertexDelay !== undefined ? options.dragVertexDelay : 500;\n\n  /**\n   * Finish coordinate for the feature (first point for polygons, last point for\n   * linestrings).\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.finishCoordinate_ = null;\n\n  /**\n   * Sketch feature.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.sketchFeature_ = null;\n\n  /**\n   * Sketch point.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.sketchPoint_ = null;\n\n  /**\n   * Sketch coordinates. Used when drawing a line or polygon.\n   * @type {module:ol/coordinate~Coordinate|Array.<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>}\n   * @private\n   */\n  this.sketchCoords_ = null;\n\n  /**\n   * Sketch line. Used when drawing polygon.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.sketchLine_ = null;\n\n  /**\n   * Sketch line coordinates. Used when drawing a polygon or circle.\n   * @type {Array.<module:ol/coordinate~Coordinate>}\n   * @private\n   */\n  this.sketchLineCoords_ = null;\n\n  /**\n   * Squared tolerance for handling up events.  If the squared distance\n   * between a down and up event is greater than this tolerance, up events\n   * will not be handled.\n   * @type {number}\n   * @private\n   */\n  this.squaredClickTolerance_ = options.clickTolerance ?\n    options.clickTolerance * options.clickTolerance : 36;\n\n  /**\n   * Draw overlay where our sketch features are drawn.\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.overlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: options.wrapX ? options.wrapX : false\n    }),\n    style: options.style ? options.style :\n      getDefaultStyleFunction(),\n    updateWhileInteracting: true\n  });\n\n  /**\n   * Name of the geometry attribute for newly created features.\n   * @type {string|undefined}\n   * @private\n   */\n  this.geometryName_ = options.geometryName;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : noModifierKeys;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.freehandCondition_;\n  if (options.freehand) {\n    this.freehandCondition_ = always;\n  } else {\n    this.freehandCondition_ = options.freehandCondition ?\n      options.freehandCondition : shiftKeyOnly;\n  }\n\n  listen(this,\n    getChangeEventType(InteractionProperty.ACTIVE),\n    this.updateState_, this);\n\n};\n\ninherits(Draw, PointerInteraction);\n\n\n/**\n * @return {module:ol/style/Style~StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const styles = createEditingStyle();\n  return function(feature, resolution) {\n    return styles[feature.getGeometry().getType()];\n  };\n}\n\n\n/**\n * @inheritDoc\n */\nDraw.prototype.setMap = function(map) {\n  PointerInteraction.prototype.setMap.call(this, map);\n  this.updateState_();\n};\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may actually\n * draw or finish the drawing.\n * @param {module:ol/MapBrowserEvent} event Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Draw}\n * @api\n */\nexport function handleEvent(event) {\n  if (event.originalEvent.type === EventType.CONTEXTMENU) {\n    // Avoid context menu for long taps when drawing on mobile\n    event.preventDefault();\n  }\n  this.freehand_ = this.mode_ !== Mode.POINT && this.freehandCondition_(event);\n  let move = event.type === MapBrowserEventType.POINTERMOVE;\n  let pass = true;\n  if (this.lastDragTime_ && event.type === MapBrowserEventType.POINTERDRAG) {\n    const now = Date.now();\n    if (now - this.lastDragTime_ >= this.dragVertexDelay_) {\n      this.downPx_ = event.pixel;\n      this.shouldHandle_ = !this.freehand_;\n      move = true;\n    } else {\n      this.lastDragTime_ = undefined;\n    }\n    if (this.shouldHandle_ && this.downTimeout_) {\n      clearTimeout(this.downTimeout_);\n      this.downTimeout_ = undefined;\n    }\n  }\n  if (this.freehand_ &&\n      event.type === MapBrowserEventType.POINTERDRAG &&\n      this.sketchFeature_ !== null) {\n    this.addToDrawing_(event);\n    pass = false;\n  } else if (this.freehand_ &&\n      event.type === MapBrowserEventType.POINTERDOWN) {\n    pass = false;\n  } else if (move) {\n    pass = event.type === MapBrowserEventType.POINTERMOVE;\n    if (pass && this.freehand_) {\n      pass = this.handlePointerMove_(event);\n    } else if (event.pointerEvent.pointerType == POINTER_TYPE ||\n        (event.type === MapBrowserEventType.POINTERDRAG && !this.downTimeout_)) {\n      this.handlePointerMove_(event);\n    }\n  } else if (event.type === MapBrowserEventType.DBLCLICK) {\n    pass = false;\n  }\n\n  return handlePointerEvent.call(this, event) && pass;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/Draw}\n */\nfunction handleDownEvent(event) {\n  this.shouldHandle_ = !this.freehand_;\n\n  if (this.freehand_) {\n    this.downPx_ = event.pixel;\n    if (!this.finishCoordinate_) {\n      this.startDrawing_(event);\n    }\n    return true;\n  } else if (this.condition_(event)) {\n    this.lastDragTime_ = Date.now();\n    this.downTimeout_ = setTimeout(function() {\n      this.handlePointerMove_(new MapBrowserPointerEvent(\n        MapBrowserEventType.POINTERMOVE, event.map, event.pointerEvent, event.frameState));\n    }.bind(this), this.dragVertexDelay_);\n    this.downPx_ = event.pixel;\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Draw}\n */\nfunction handleUpEvent(event) {\n  let pass = true;\n\n  if (this.downTimeout_) {\n    clearTimeout(this.downTimeout_);\n    this.downTimeout_ = undefined;\n  }\n\n  this.handlePointerMove_(event);\n\n  const circleMode = this.mode_ === Mode.CIRCLE;\n\n  if (this.shouldHandle_) {\n    if (!this.finishCoordinate_) {\n      this.startDrawing_(event);\n      if (this.mode_ === Mode.POINT) {\n        this.finishDrawing();\n      }\n    } else if (this.freehand_ || circleMode) {\n      this.finishDrawing();\n    } else if (this.atFinish_(event)) {\n      if (this.finishCondition_(event)) {\n        this.finishDrawing();\n      }\n    } else {\n      this.addToDrawing_(event);\n    }\n    pass = false;\n  } else if (this.freehand_) {\n    this.finishCoordinate_ = null;\n    this.abortDrawing_();\n  }\n  if (!pass && this.stopClick_) {\n    event.stopPropagation();\n  }\n  return pass;\n}\n\n\n/**\n * Handle move events.\n * @param {module:ol/MapBrowserEvent} event A move event.\n * @return {boolean} Pass the event to other interactions.\n * @private\n */\nDraw.prototype.handlePointerMove_ = function(event) {\n  if (this.downPx_ &&\n      ((!this.freehand_ && this.shouldHandle_) ||\n      (this.freehand_ && !this.shouldHandle_))) {\n    const downPx = this.downPx_;\n    const clickPx = event.pixel;\n    const dx = downPx[0] - clickPx[0];\n    const dy = downPx[1] - clickPx[1];\n    const squaredDistance = dx * dx + dy * dy;\n    this.shouldHandle_ = this.freehand_ ?\n      squaredDistance > this.squaredClickTolerance_ :\n      squaredDistance <= this.squaredClickTolerance_;\n    if (!this.shouldHandle_) {\n      return true;\n    }\n  }\n\n  if (this.finishCoordinate_) {\n    this.modifyDrawing_(event);\n  } else {\n    this.createOrUpdateSketchPoint_(event);\n  }\n  return true;\n};\n\n\n/**\n * Determine if an event is within the snapping tolerance of the start coord.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @return {boolean} The event is within the snapping tolerance of the start.\n * @private\n */\nDraw.prototype.atFinish_ = function(event) {\n  let at = false;\n  if (this.sketchFeature_) {\n    let potentiallyDone = false;\n    let potentiallyFinishCoordinates = [this.finishCoordinate_];\n    if (this.mode_ === Mode.LINE_STRING) {\n      potentiallyDone = this.sketchCoords_.length > this.minPoints_;\n    } else if (this.mode_ === Mode.POLYGON) {\n      potentiallyDone = this.sketchCoords_[0].length >\n          this.minPoints_;\n      potentiallyFinishCoordinates = [this.sketchCoords_[0][0],\n        this.sketchCoords_[0][this.sketchCoords_[0].length - 2]];\n    }\n    if (potentiallyDone) {\n      const map = event.map;\n      for (let i = 0, ii = potentiallyFinishCoordinates.length; i < ii; i++) {\n        const finishCoordinate = potentiallyFinishCoordinates[i];\n        const finishPixel = map.getPixelFromCoordinate(finishCoordinate);\n        const pixel = event.pixel;\n        const dx = pixel[0] - finishPixel[0];\n        const dy = pixel[1] - finishPixel[1];\n        const snapTolerance = this.freehand_ ? 1 : this.snapTolerance_;\n        at = Math.sqrt(dx * dx + dy * dy) <= snapTolerance;\n        if (at) {\n          this.finishCoordinate_ = finishCoordinate;\n          break;\n        }\n      }\n    }\n  }\n  return at;\n};\n\n\n/**\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.createOrUpdateSketchPoint_ = function(event) {\n  const coordinates = event.coordinate.slice();\n  if (!this.sketchPoint_) {\n    this.sketchPoint_ = new Feature(new Point(coordinates));\n    this.updateSketchFeatures_();\n  } else {\n    const sketchPointGeom = /** @type {module:ol/geom/Point} */ (this.sketchPoint_.getGeometry());\n    sketchPointGeom.setCoordinates(coordinates);\n  }\n};\n\n\n/**\n * Start the drawing.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.startDrawing_ = function(event) {\n  const start = event.coordinate;\n  this.finishCoordinate_ = start;\n  if (this.mode_ === Mode.POINT) {\n    this.sketchCoords_ = start.slice();\n  } else if (this.mode_ === Mode.POLYGON) {\n    this.sketchCoords_ = [[start.slice(), start.slice()]];\n    this.sketchLineCoords_ = this.sketchCoords_[0];\n  } else {\n    this.sketchCoords_ = [start.slice(), start.slice()];\n  }\n  if (this.sketchLineCoords_) {\n    this.sketchLine_ = new Feature(\n      new LineString(this.sketchLineCoords_));\n  }\n  const geometry = this.geometryFunction_(this.sketchCoords_);\n  this.sketchFeature_ = new Feature();\n  if (this.geometryName_) {\n    this.sketchFeature_.setGeometryName(this.geometryName_);\n  }\n  this.sketchFeature_.setGeometry(geometry);\n  this.updateSketchFeatures_();\n  this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART, this.sketchFeature_));\n};\n\n\n/**\n * Modify the drawing.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.modifyDrawing_ = function(event) {\n  let coordinate = event.coordinate;\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (this.sketchFeature_.getGeometry());\n  let coordinates, last;\n  if (this.mode_ === Mode.POINT) {\n    last = this.sketchCoords_;\n  } else if (this.mode_ === Mode.POLYGON) {\n    coordinates = this.sketchCoords_[0];\n    last = coordinates[coordinates.length - 1];\n    if (this.atFinish_(event)) {\n      // snap to finish\n      coordinate = this.finishCoordinate_.slice();\n    }\n  } else {\n    coordinates = this.sketchCoords_;\n    last = coordinates[coordinates.length - 1];\n  }\n  last[0] = coordinate[0];\n  last[1] = coordinate[1];\n  this.geometryFunction_(/** @type {!Array.<module:ol/coordinate~Coordinate>} */ (this.sketchCoords_), geometry);\n  if (this.sketchPoint_) {\n    const sketchPointGeom = /** @type {module:ol/geom/Point} */ (this.sketchPoint_.getGeometry());\n    sketchPointGeom.setCoordinates(coordinate);\n  }\n  let sketchLineGeom;\n  if (geometry instanceof Polygon &&\n      this.mode_ !== Mode.POLYGON) {\n    if (!this.sketchLine_) {\n      this.sketchLine_ = new Feature(new LineString(null));\n    }\n    const ring = geometry.getLinearRing(0);\n    sketchLineGeom = /** @type {module:ol/geom/LineString} */ (this.sketchLine_.getGeometry());\n    sketchLineGeom.setFlatCoordinates(\n      ring.getLayout(), ring.getFlatCoordinates());\n  } else if (this.sketchLineCoords_) {\n    sketchLineGeom = /** @type {module:ol/geom/LineString} */ (this.sketchLine_.getGeometry());\n    sketchLineGeom.setCoordinates(this.sketchLineCoords_);\n  }\n  this.updateSketchFeatures_();\n};\n\n\n/**\n * Add a new coordinate to the drawing.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.addToDrawing_ = function(event) {\n  const coordinate = event.coordinate;\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (this.sketchFeature_.getGeometry());\n  let done;\n  let coordinates;\n  if (this.mode_ === Mode.LINE_STRING) {\n    this.finishCoordinate_ = coordinate.slice();\n    coordinates = this.sketchCoords_;\n    if (coordinates.length >= this.maxPoints_) {\n      if (this.freehand_) {\n        coordinates.pop();\n      } else {\n        done = true;\n      }\n    }\n    coordinates.push(coordinate.slice());\n    this.geometryFunction_(coordinates, geometry);\n  } else if (this.mode_ === Mode.POLYGON) {\n    coordinates = this.sketchCoords_[0];\n    if (coordinates.length >= this.maxPoints_) {\n      if (this.freehand_) {\n        coordinates.pop();\n      } else {\n        done = true;\n      }\n    }\n    coordinates.push(coordinate.slice());\n    if (done) {\n      this.finishCoordinate_ = coordinates[0];\n    }\n    this.geometryFunction_(this.sketchCoords_, geometry);\n  }\n  this.updateSketchFeatures_();\n  if (done) {\n    this.finishDrawing();\n  }\n};\n\n\n/**\n * Remove last point of the feature currently being drawn.\n * @api\n */\nDraw.prototype.removeLastPoint = function() {\n  if (!this.sketchFeature_) {\n    return;\n  }\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (this.sketchFeature_.getGeometry());\n  let coordinates, sketchLineGeom;\n  if (this.mode_ === Mode.LINE_STRING) {\n    coordinates = this.sketchCoords_;\n    coordinates.splice(-2, 1);\n    this.geometryFunction_(coordinates, geometry);\n    if (coordinates.length >= 2) {\n      this.finishCoordinate_ = coordinates[coordinates.length - 2].slice();\n    }\n  } else if (this.mode_ === Mode.POLYGON) {\n    coordinates = this.sketchCoords_[0];\n    coordinates.splice(-2, 1);\n    sketchLineGeom = /** @type {module:ol/geom/LineString} */ (this.sketchLine_.getGeometry());\n    sketchLineGeom.setCoordinates(coordinates);\n    this.geometryFunction_(this.sketchCoords_, geometry);\n  }\n\n  if (coordinates.length === 0) {\n    this.finishCoordinate_ = null;\n  }\n\n  this.updateSketchFeatures_();\n};\n\n\n/**\n * Stop drawing and add the sketch feature to the target layer.\n * The {@link module:ol/interaction/Draw~DrawEventType.DRAWEND} event is\n * dispatched before inserting the feature.\n * @api\n */\nDraw.prototype.finishDrawing = function() {\n  const sketchFeature = this.abortDrawing_();\n  if (!sketchFeature) {\n    return;\n  }\n  let coordinates = this.sketchCoords_;\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (sketchFeature.getGeometry());\n  if (this.mode_ === Mode.LINE_STRING) {\n    // remove the redundant last point\n    coordinates.pop();\n    this.geometryFunction_(coordinates, geometry);\n  } else if (this.mode_ === Mode.POLYGON) {\n    // remove the redundant last point in ring\n    coordinates[0].pop();\n    this.geometryFunction_(coordinates, geometry);\n    coordinates = geometry.getCoordinates();\n  }\n\n  // cast multi-part geometries\n  if (this.type_ === GeometryType.MULTI_POINT) {\n    sketchFeature.setGeometry(new MultiPoint([coordinates]));\n  } else if (this.type_ === GeometryType.MULTI_LINE_STRING) {\n    sketchFeature.setGeometry(new MultiLineString([coordinates]));\n  } else if (this.type_ === GeometryType.MULTI_POLYGON) {\n    sketchFeature.setGeometry(new MultiPolygon([coordinates]));\n  }\n\n  // First dispatch event to allow full set up of feature\n  this.dispatchEvent(new DrawEvent(DrawEventType.DRAWEND, sketchFeature));\n\n  // Then insert feature\n  if (this.features_) {\n    this.features_.push(sketchFeature);\n  }\n  if (this.source_) {\n    this.source_.addFeature(sketchFeature);\n  }\n};\n\n\n/**\n * Stop drawing without adding the sketch feature to the target layer.\n * @return {module:ol/Feature} The sketch feature (or null if none).\n * @private\n */\nDraw.prototype.abortDrawing_ = function() {\n  this.finishCoordinate_ = null;\n  const sketchFeature = this.sketchFeature_;\n  if (sketchFeature) {\n    this.sketchFeature_ = null;\n    this.sketchPoint_ = null;\n    this.sketchLine_ = null;\n    this.overlay_.getSource().clear(true);\n  }\n  return sketchFeature;\n};\n\n\n/**\n * Extend an existing geometry by adding additional points. This only works\n * on features with `LineString` geometries, where the interaction will\n * extend lines by adding points to the end of the coordinates array.\n * @param {!module:ol/Feature} feature Feature to be extended.\n * @api\n */\nDraw.prototype.extend = function(feature) {\n  const geometry = feature.getGeometry();\n  const lineString = /** @type {module:ol/geom/LineString} */ (geometry);\n  this.sketchFeature_ = feature;\n  this.sketchCoords_ = lineString.getCoordinates();\n  const last = this.sketchCoords_[this.sketchCoords_.length - 1];\n  this.finishCoordinate_ = last.slice();\n  this.sketchCoords_.push(last.slice());\n  this.updateSketchFeatures_();\n  this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART, this.sketchFeature_));\n};\n\n\n/**\n * @inheritDoc\n */\nDraw.prototype.shouldStopEvent = FALSE;\n\n\n/**\n * Redraw the sketch features.\n * @private\n */\nDraw.prototype.updateSketchFeatures_ = function() {\n  const sketchFeatures = [];\n  if (this.sketchFeature_) {\n    sketchFeatures.push(this.sketchFeature_);\n  }\n  if (this.sketchLine_) {\n    sketchFeatures.push(this.sketchLine_);\n  }\n  if (this.sketchPoint_) {\n    sketchFeatures.push(this.sketchPoint_);\n  }\n  const overlaySource = this.overlay_.getSource();\n  overlaySource.clear(true);\n  overlaySource.addFeatures(sketchFeatures);\n};\n\n\n/**\n * @private\n */\nDraw.prototype.updateState_ = function() {\n  const map = this.getMap();\n  const active = this.getActive();\n  if (!map || !active) {\n    this.abortDrawing_();\n  }\n  this.overlay_.setMap(active ? map : null);\n};\n\n\n/**\n * Create a `geometryFunction` for `type: 'Circle'` that will create a regular\n * polygon with a user specified number of sides and start angle instead of an\n * `module:ol/geom/Circle~Circle` geometry.\n * @param {number=} opt_sides Number of sides of the regular polygon. Default is\n *     32.\n * @param {number=} opt_angle Angle of the first point in radians. 0 means East.\n *     Default is the angle defined by the heading from the center of the\n *     regular polygon to the current pointer position.\n * @return {module:ol/interaction/Draw~GeometryFunction} Function that draws a\n *     polygon.\n * @api\n */\nexport function createRegularPolygon(opt_sides, opt_angle) {\n  return function(coordinates, opt_geometry) {\n    const center = coordinates[0];\n    const end = coordinates[1];\n    const radius = Math.sqrt(\n      squaredCoordinateDistance(center, end));\n    const geometry = opt_geometry ? /** @type {module:ol/geom/Polygon} */ (opt_geometry) :\n      fromCircle(new Circle(center), opt_sides);\n    const angle = opt_angle ? opt_angle :\n      Math.atan((end[1] - center[1]) / (end[0] - center[0]));\n    makeRegular(geometry, center, radius, angle);\n    return geometry;\n  };\n}\n\n\n/**\n * Create a `geometryFunction` that will create a box-shaped polygon (aligned\n * with the coordinate system axes).  Use this with the draw interaction and\n * `type: 'Circle'` to return a box instead of a circle geometry.\n * @return {module:ol/interaction/Draw~GeometryFunction} Function that draws a box-shaped polygon.\n * @api\n */\nexport function createBox() {\n  return (\n    function(coordinates, opt_geometry) {\n      const extent = boundingExtent(coordinates);\n      const geometry = opt_geometry || new Polygon(null);\n      geometry.setCoordinates([[\n        getBottomLeft(extent),\n        getBottomRight(extent),\n        getTopRight(extent),\n        getTopLeft(extent),\n        getBottomLeft(extent)\n      ]]);\n      return geometry;\n    }\n  );\n}\n\n\n/**\n * Get the drawing mode.  The mode for mult-part geometries is the same as for\n * their single-part cousins.\n * @param {module:ol/geom/GeometryType} type Geometry type.\n * @return {module:ol/interaction/Draw~Mode} Drawing mode.\n */\nfunction getMode(type) {\n  let mode;\n  if (type === GeometryType.POINT ||\n      type === GeometryType.MULTI_POINT) {\n    mode = Mode.POINT;\n  } else if (type === GeometryType.LINE_STRING ||\n      type === GeometryType.MULTI_LINE_STRING) {\n    mode = Mode.LINE_STRING;\n  } else if (type === GeometryType.POLYGON ||\n      type === GeometryType.MULTI_POLYGON) {\n    mode = Mode.POLYGON;\n  } else if (type === GeometryType.CIRCLE) {\n    mode = Mode.CIRCLE;\n  }\n  return (\n    /** @type {!module:ol/interaction/Draw~Mode} */ (mode)\n  );\n}\n\n\nexport default Draw;\n","/**\n * @module ol/interaction/Extent\n */\nimport {inherits} from '../index.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {squaredDistanceToSegment, closestOnSegment, distance as coordinateDistance, squaredDistance as squaredCoordinateDistance} from '../coordinate.js';\nimport Event from '../events/Event.js';\nimport {boundingExtent, getArea} from '../extent.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport {fromExtent as polygonFromExtent} from '../geom/Polygon.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/extent~Extent} [extent] Initial extent. Defaults to no\n * initial extent.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [boxStyle]\n * Style for the drawn extent box. Defaults to\n * {@link module:ol/style/Style~createEditing()['Polygon']}\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the\n * pointer close enough to a segment or vertex for editing.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [pointerStyle]\n * Style for the cursor used to draw the extent. Defaults to\n * {@link module:ol/style/Style~createEditing()['Point']}\n * @property {boolean} [wrapX=false] Wrap the drawn extent across multiple maps\n * in the X direction? Only affects visuals, not functionality.\n */\n\n\n/**\n * @enum {string}\n */\nconst ExtentEventType = {\n  /**\n   * Triggered after the extent is changed\n   * @event module:ol/interaction/Extent~ExtentEventType#extentchanged\n   * @api\n   */\n  EXTENTCHANGED: 'extentchanged'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Extent~Extent} instances are\n * instances of this type.\n *\n * @constructor\n * @param {module:ol/extent~Extent} extent the new extent\n * @extends {module:ol/events/Event}\n */\nconst ExtentInteractionEvent = function(extent) {\n  Event.call(this, ExtentEventType.EXTENTCHANGED);\n\n  /**\n   * The current extent.\n   * @type {module:ol/extent~Extent}\n   * @api\n   */\n  this.extent = extent;\n\n};\ninherits(ExtentInteractionEvent, Event);\n\n\n/**\n * @classdesc\n * Allows the user to draw a vector box by clicking and dragging on the map.\n * Once drawn, the vector box can be modified by dragging its vertices or edges.\n * This interaction is only supported for mouse devices.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/Extent~Event\n * @param {module:ol/interaction/Extent~Options=} opt_options Options.\n * @api\n */\nconst ExtentInteraction = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * Extent of the drawn box\n   * @type {module:ol/extent~Extent}\n   * @private\n   */\n  this.extent_ = null;\n\n  /**\n   * Handler for pointer move events\n   * @type {function (module:ol/coordinate~Coordinate): module:ol/extent~Extent|null}\n   * @private\n   */\n  this.pointerHandler_ = null;\n\n  /**\n   * Pixel threshold to snap to extent\n   * @type {number}\n   * @private\n   */\n  this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n    options.pixelTolerance : 10;\n\n  /**\n   * Is the pointer snapped to an extent vertex\n   * @type {boolean}\n   * @private\n   */\n  this.snappedToVertex_ = false;\n\n  /**\n   * Feature for displaying the visible extent\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.extentFeature_ = null;\n\n  /**\n   * Feature for displaying the visible pointer\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.vertexFeature_ = null;\n\n  if (!opt_options) {\n    opt_options = {};\n  }\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleEvent: handleEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * Layer for the extentFeature\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.extentOverlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: !!opt_options.wrapX\n    }),\n    style: opt_options.boxStyle ? opt_options.boxStyle : getDefaultExtentStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  /**\n   * Layer for the vertexFeature\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.vertexOverlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: !!opt_options.wrapX\n    }),\n    style: opt_options.pointerStyle ? opt_options.pointerStyle : getDefaultPointerStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  if (opt_options.extent) {\n    this.setExtent(opt_options.extent);\n  }\n};\n\ninherits(ExtentInteraction, PointerInteraction);\n\n/**\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Event.\n * @return {boolean} Propagate event?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!(mapBrowserEvent instanceof MapBrowserPointerEvent)) {\n    return true;\n  }\n  //display pointer (if not dragging)\n  if (mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE && !this.handlingDownUpSequence) {\n    this.handlePointerMove_(mapBrowserEvent);\n  }\n  //call pointer to determine up/down/drag\n  handlePointerEvent.call(this, mapBrowserEvent);\n  //return false to stop propagation\n  return false;\n}\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Event handled?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  const pixel = mapBrowserEvent.pixel;\n  const map = mapBrowserEvent.map;\n\n  const extent = this.getExtent();\n  let vertex = this.snapToVertex_(pixel, map);\n\n  //find the extent corner opposite the passed corner\n  const getOpposingPoint = function(point) {\n    let x_ = null;\n    let y_ = null;\n    if (point[0] == extent[0]) {\n      x_ = extent[2];\n    } else if (point[0] == extent[2]) {\n      x_ = extent[0];\n    }\n    if (point[1] == extent[1]) {\n      y_ = extent[3];\n    } else if (point[1] == extent[3]) {\n      y_ = extent[1];\n    }\n    if (x_ !== null && y_ !== null) {\n      return [x_, y_];\n    }\n    return null;\n  };\n  if (vertex && extent) {\n    const x = (vertex[0] == extent[0] || vertex[0] == extent[2]) ? vertex[0] : null;\n    const y = (vertex[1] == extent[1] || vertex[1] == extent[3]) ? vertex[1] : null;\n\n    //snap to point\n    if (x !== null && y !== null) {\n      this.pointerHandler_ = getPointHandler(getOpposingPoint(vertex));\n    //snap to edge\n    } else if (x !== null) {\n      this.pointerHandler_ = getEdgeHandler(\n        getOpposingPoint([x, extent[1]]),\n        getOpposingPoint([x, extent[3]])\n      );\n    } else if (y !== null) {\n      this.pointerHandler_ = getEdgeHandler(\n        getOpposingPoint([extent[0], y]),\n        getOpposingPoint([extent[2], y])\n      );\n    }\n  //no snap - new bbox\n  } else {\n    vertex = map.getCoordinateFromPixel(pixel);\n    this.setExtent([vertex[0], vertex[1], vertex[0], vertex[1]]);\n    this.pointerHandler_ = getPointHandler(vertex);\n  }\n  return true; //event handled; start downup sequence\n}\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Event handled?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (this.pointerHandler_) {\n    const pixelCoordinate = mapBrowserEvent.coordinate;\n    this.setExtent(this.pointerHandler_(pixelCoordinate));\n    this.createOrUpdatePointerFeature_(pixelCoordinate);\n  }\n  return true;\n}\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  this.pointerHandler_ = null;\n  //If bbox is zero area, set to null;\n  const extent = this.getExtent();\n  if (!extent || getArea(extent) === 0) {\n    this.setExtent(null);\n  }\n  return false; //Stop handling downup sequence\n}\n\n/**\n * Returns the default style for the drawn bbox\n *\n * @return {module:ol/style/Style~StyleFunction} Default Extent style\n */\nfunction getDefaultExtentStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POLYGON];\n  };\n}\n\n/**\n * Returns the default style for the pointer\n *\n * @return {module:ol/style/Style~StyleFunction} Default pointer style\n */\nfunction getDefaultPointerStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POINT];\n  };\n}\n\n/**\n * @param {module:ol/coordinate~Coordinate} fixedPoint corner that will be unchanged in the new extent\n * @returns {function (module:ol/coordinate~Coordinate): module:ol/extent~Extent} event handler\n */\nfunction getPointHandler(fixedPoint) {\n  return function(point) {\n    return boundingExtent([fixedPoint, point]);\n  };\n}\n\n/**\n * @param {module:ol/coordinate~Coordinate} fixedP1 first corner that will be unchanged in the new extent\n * @param {module:ol/coordinate~Coordinate} fixedP2 second corner that will be unchanged in the new extent\n * @returns {function (module:ol/coordinate~Coordinate): module:ol/extent~Extent|null} event handler\n */\nfunction getEdgeHandler(fixedP1, fixedP2) {\n  if (fixedP1[0] == fixedP2[0]) {\n    return function(point) {\n      return boundingExtent([fixedP1, [point[0], fixedP2[1]]]);\n    };\n  } else if (fixedP1[1] == fixedP2[1]) {\n    return function(point) {\n      return boundingExtent([fixedP1, [fixedP2[0], point[1]]]);\n    };\n  } else {\n    return null;\n  }\n}\n\n/**\n * @param {module:ol/extent~Extent} extent extent\n * @returns {Array<Array<module:ol/coordinate~Coordinate>>} extent line segments\n */\nfunction getSegments(extent) {\n  return [\n    [[extent[0], extent[1]], [extent[0], extent[3]]],\n    [[extent[0], extent[3]], [extent[2], extent[3]]],\n    [[extent[2], extent[3]], [extent[2], extent[1]]],\n    [[extent[2], extent[1]], [extent[0], extent[1]]]\n  ];\n}\n\n/**\n * @param {module:ol~Pixel} pixel cursor location\n * @param {module:ol/PluggableMap} map map\n * @returns {module:ol/coordinate~Coordinate|null} snapped vertex on extent\n * @private\n */\nExtentInteraction.prototype.snapToVertex_ = function(pixel, map) {\n  const pixelCoordinate = map.getCoordinateFromPixel(pixel);\n  const sortByDistance = function(a, b) {\n    return squaredDistanceToSegment(pixelCoordinate, a) -\n        squaredDistanceToSegment(pixelCoordinate, b);\n  };\n  const extent = this.getExtent();\n  if (extent) {\n    //convert extents to line segments and find the segment closest to pixelCoordinate\n    const segments = getSegments(extent);\n    segments.sort(sortByDistance);\n    const closestSegment = segments[0];\n\n    let vertex = (closestOnSegment(pixelCoordinate,\n      closestSegment));\n    const vertexPixel = map.getPixelFromCoordinate(vertex);\n\n    //if the distance is within tolerance, snap to the segment\n    if (coordinateDistance(pixel, vertexPixel) <= this.pixelTolerance_) {\n      //test if we should further snap to a vertex\n      const pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n      const pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n      const squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n      const squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n      const dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n      this.snappedToVertex_ = dist <= this.pixelTolerance_;\n      if (this.snappedToVertex_) {\n        vertex = squaredDist1 > squaredDist2 ?\n          closestSegment[1] : closestSegment[0];\n      }\n      return vertex;\n    }\n  }\n  return null;\n};\n\n/**\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent pointer move event\n * @private\n */\nExtentInteraction.prototype.handlePointerMove_ = function(mapBrowserEvent) {\n  const pixel = mapBrowserEvent.pixel;\n  const map = mapBrowserEvent.map;\n\n  let vertex = this.snapToVertex_(pixel, map);\n  if (!vertex) {\n    vertex = map.getCoordinateFromPixel(pixel);\n  }\n  this.createOrUpdatePointerFeature_(vertex);\n};\n\n/**\n * @param {module:ol/extent~Extent} extent extent\n * @returns {module:ol/Feature} extent as featrue\n * @private\n */\nExtentInteraction.prototype.createOrUpdateExtentFeature_ = function(extent) {\n  let extentFeature = this.extentFeature_;\n\n  if (!extentFeature) {\n    if (!extent) {\n      extentFeature = new Feature({});\n    } else {\n      extentFeature = new Feature(polygonFromExtent(extent));\n    }\n    this.extentFeature_ = extentFeature;\n    this.extentOverlay_.getSource().addFeature(extentFeature);\n  } else {\n    if (!extent) {\n      extentFeature.setGeometry(undefined);\n    } else {\n      extentFeature.setGeometry(polygonFromExtent(extent));\n    }\n  }\n  return extentFeature;\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} vertex location of feature\n * @returns {module:ol/Feature} vertex as feature\n * @private\n */\nExtentInteraction.prototype.createOrUpdatePointerFeature_ = function(vertex) {\n  let vertexFeature = this.vertexFeature_;\n  if (!vertexFeature) {\n    vertexFeature = new Feature(new Point(vertex));\n    this.vertexFeature_ = vertexFeature;\n    this.vertexOverlay_.getSource().addFeature(vertexFeature);\n  } else {\n    const geometry = /** @type {module:ol/geom/Point} */ (vertexFeature.getGeometry());\n    geometry.setCoordinates(vertex);\n  }\n  return vertexFeature;\n};\n\n\n/**\n * @inheritDoc\n */\nExtentInteraction.prototype.setMap = function(map) {\n  this.extentOverlay_.setMap(map);\n  this.vertexOverlay_.setMap(map);\n  PointerInteraction.prototype.setMap.call(this, map);\n};\n\n/**\n * Returns the current drawn extent in the view projection\n *\n * @return {module:ol/extent~Extent} Drawn extent in the view projection.\n * @api\n */\nExtentInteraction.prototype.getExtent = function() {\n  return this.extent_;\n};\n\n/**\n * Manually sets the drawn extent, using the view projection.\n *\n * @param {module:ol/extent~Extent} extent Extent\n * @api\n */\nExtentInteraction.prototype.setExtent = function(extent) {\n  //Null extent means no bbox\n  this.extent_ = extent ? extent : null;\n  this.createOrUpdateExtentFeature_(extent);\n  this.dispatchEvent(new ExtentInteractionEvent(this.extent_));\n};\n\n\nexport default ExtentInteraction;\n","/**\n * @module ol/interaction/Interaction\n */\nimport {inherits} from '../index.js';\nimport BaseObject from '../Object.js';\nimport {easeOut, linear} from '../easing.js';\nimport InteractionProperty from '../interaction/Property.js';\nimport {clamp} from '../math.js';\n\n\n/**\n * Object literal with config options for interactions.\n * @typedef {Object} InteractionOptions\n * @property {function(module:ol/MapBrowserEvent):boolean} handleEvent\n * Method called by the map to notify the interaction that a browser event was\n * dispatched to the map. If the function returns a falsy value, propagation of\n * the event to other interactions in the map's interactions chain will be\n * prevented (this includes functions with no explicit return).\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * User actions that change the state of the map. Some are similar to controls,\n * but are not associated with a DOM element.\n * For example, {@link module:ol/interaction/KeyboardZoom~KeyboardZoom} is\n * functionally the same as {@link module:ol/control/Zoom~Zoom}, but triggered\n * by a keyboard event not a button element event.\n * Although interactions do not have a DOM element, some of them do render\n * vectors and so are visible on the screen.\n *\n * @constructor\n * @param {module:ol/interaction/Interaction~InteractionOptions} options Options.\n * @extends {module:ol/Object}\n * @api\n */\nconst Interaction = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = null;\n\n  this.setActive(true);\n\n  /**\n   * @type {function(module:ol/MapBrowserEvent):boolean}\n   */\n  this.handleEvent = options.handleEvent;\n\n};\n\ninherits(Interaction, BaseObject);\n\n\n/**\n * Return whether the interaction is currently active.\n * @return {boolean} `true` if the interaction is active, `false` otherwise.\n * @observable\n * @api\n */\nInteraction.prototype.getActive = function() {\n  return /** @type {boolean} */ (this.get(InteractionProperty.ACTIVE));\n};\n\n\n/**\n * Get the map associated with this interaction.\n * @return {module:ol/PluggableMap} Map.\n * @api\n */\nInteraction.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nInteraction.prototype.setActive = function(active) {\n  this.set(InteractionProperty.ACTIVE, active);\n};\n\n\n/**\n * Remove the interaction from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {module:ol/PluggableMap} map Map.\n */\nInteraction.prototype.setMap = function(map) {\n  this.map_ = map;\n};\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {module:ol/coordinate~Coordinate} delta Delta.\n * @param {number=} opt_duration Duration.\n */\nexport function pan(view, delta, opt_duration) {\n  const currentCenter = view.getCenter();\n  if (currentCenter) {\n    const center = view.constrainCenter(\n      [currentCenter[0] + delta[0], currentCenter[1] + delta[1]]);\n    if (opt_duration) {\n      view.animate({\n        duration: opt_duration,\n        easing: linear,\n        center: center\n      });\n    } else {\n      view.setCenter(center);\n    }\n  }\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} rotation Rotation.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function rotate(view, rotation, opt_anchor, opt_duration) {\n  rotation = view.constrainRotation(rotation, 0);\n  rotateWithoutConstraints(view, rotation, opt_anchor, opt_duration);\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} rotation Rotation.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function rotateWithoutConstraints(view, rotation, opt_anchor, opt_duration) {\n  if (rotation !== undefined) {\n    const currentRotation = view.getRotation();\n    const currentCenter = view.getCenter();\n    if (currentRotation !== undefined && currentCenter && opt_duration > 0) {\n      view.animate({\n        rotation: rotation,\n        anchor: opt_anchor,\n        duration: opt_duration,\n        easing: easeOut\n      });\n    } else {\n      view.rotate(rotation, opt_anchor);\n    }\n  }\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} resolution Resolution to go to.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n * @param {number=} opt_direction Zooming direction; > 0 indicates\n *     zooming out, in which case the constraints system will select\n *     the largest nearest resolution; < 0 indicates zooming in, in\n *     which case the constraints system will select the smallest\n *     nearest resolution; == 0 indicates that the zooming direction\n *     is unknown/not relevant, in which case the constraints system\n *     will select the nearest resolution. If not defined 0 is\n *     assumed.\n */\nexport function zoom(view, resolution, opt_anchor, opt_duration, opt_direction) {\n  resolution = view.constrainResolution(resolution, 0, opt_direction);\n  zoomWithoutConstraints(view, resolution, opt_anchor, opt_duration);\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number} delta Delta from previous zoom level.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function zoomByDelta(view, delta, opt_anchor, opt_duration) {\n  const currentResolution = view.getResolution();\n  let resolution = view.constrainResolution(currentResolution, delta, 0);\n\n  if (resolution !== undefined) {\n    const resolutions = view.getResolutions();\n    resolution = clamp(\n      resolution,\n      view.getMinResolution() || resolutions[resolutions.length - 1],\n      view.getMaxResolution() || resolutions[0]);\n  }\n\n  // If we have a constraint on center, we need to change the anchor so that the\n  // new center is within the extent. We first calculate the new center, apply\n  // the constraint to it, and then calculate back the anchor\n  if (opt_anchor && resolution !== undefined && resolution !== currentResolution) {\n    const currentCenter = view.getCenter();\n    let center = view.calculateCenterZoom(resolution, opt_anchor);\n    center = view.constrainCenter(center);\n\n    opt_anchor = [\n      (resolution * currentCenter[0] - currentResolution * center[0]) /\n          (resolution - currentResolution),\n      (resolution * currentCenter[1] - currentResolution * center[1]) /\n          (resolution - currentResolution)\n    ];\n  }\n\n  zoomWithoutConstraints(view, resolution, opt_anchor, opt_duration);\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} resolution Resolution to go to.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function zoomWithoutConstraints(view, resolution, opt_anchor, opt_duration) {\n  if (resolution) {\n    const currentResolution = view.getResolution();\n    const currentCenter = view.getCenter();\n    if (currentResolution !== undefined && currentCenter &&\n        resolution !== currentResolution && opt_duration) {\n      view.animate({\n        resolution: resolution,\n        anchor: opt_anchor,\n        duration: opt_duration,\n        easing: easeOut\n      });\n    } else {\n      if (opt_anchor) {\n        const center = view.calculateCenterZoom(resolution, opt_anchor);\n        view.setCenter(center);\n      }\n      view.setResolution(resolution);\n    }\n  }\n}\n\nexport default Interaction;\n","/**\n * @module ol/interaction/KeyboardPan\n */\nimport {inherits} from '../index.js';\nimport {rotate as rotateCoordinate} from '../coordinate.js';\nimport EventType from '../events/EventType.js';\nimport KeyCode from '../events/KeyCode.js';\nimport {noModifierKeys, targetNotEditable} from '../events/condition.js';\nimport Interaction, {pan} from '../interaction/Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~noModifierKeys} and\n * {@link module:ol/events/condition~targetNotEditable}.\n * @property {number} [duration=100] Animation duration in milliseconds.\n * @property {number} [pixelDelta=128] The amount of pixels to pan on each key\n * press.\n */\n\n\n/**\n * @classdesc\n * Allows the user to pan the map using keyboard arrows.\n * Note that, although this interaction is by default included in maps,\n * the keys can only be used when browser focus is on the element to which\n * the keyboard events are attached. By default, this is the map div,\n * though you can change this with the `keyboardEventTarget` in\n * {@link module:ol/Map~Map}. `document` never loses focus but, for any other\n * element, focus will have to be on, and returned to, this element if the keys\n * are to function.\n * See also {@link module:ol/interaction/KeyboardZoom~KeyboardZoom}.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/KeyboardPan~Options=} opt_options Options.\n * @api\n */\nconst KeyboardPan = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @param {module:ol/MapBrowserEvent} mapBrowserEvent Browser event.\n   * @return {boolean} Combined condition result.\n   */\n  this.defaultCondition_ = function(mapBrowserEvent) {\n    return noModifierKeys(mapBrowserEvent) &&\n      targetNotEditable(mapBrowserEvent);\n  };\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition !== undefined ?\n    options.condition : this.defaultCondition_;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 100;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelDelta_ = options.pixelDelta !== undefined ?\n    options.pixelDelta : 128;\n\n};\n\ninherits(KeyboardPan, Interaction);\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} if it was a\n * `KeyEvent`, and decides the direction to pan to (if an arrow key was\n * pressed).\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/KeyboardPan}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  if (mapBrowserEvent.type == EventType.KEYDOWN) {\n    const keyEvent = mapBrowserEvent.originalEvent;\n    const keyCode = keyEvent.keyCode;\n    if (this.condition_(mapBrowserEvent) &&\n        (keyCode == KeyCode.DOWN ||\n        keyCode == KeyCode.LEFT ||\n        keyCode == KeyCode.RIGHT ||\n        keyCode == KeyCode.UP)) {\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      const mapUnitsDelta = view.getResolution() * this.pixelDelta_;\n      let deltaX = 0, deltaY = 0;\n      if (keyCode == KeyCode.DOWN) {\n        deltaY = -mapUnitsDelta;\n      } else if (keyCode == KeyCode.LEFT) {\n        deltaX = -mapUnitsDelta;\n      } else if (keyCode == KeyCode.RIGHT) {\n        deltaX = mapUnitsDelta;\n      } else {\n        deltaY = mapUnitsDelta;\n      }\n      const delta = [deltaX, deltaY];\n      rotateCoordinate(delta, view.getRotation());\n      pan(view, delta, this.duration_);\n      mapBrowserEvent.preventDefault();\n      stopEvent = true;\n    }\n  }\n  return !stopEvent;\n}\n\nexport default KeyboardPan;\n","/**\n * @module ol/interaction/KeyboardZoom\n */\nimport {inherits} from '../index.js';\nimport EventType from '../events/EventType.js';\nimport {targetNotEditable} from '../events/condition.js';\nimport Interaction, {zoomByDelta} from '../interaction/Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=100] Animation duration in milliseconds.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~targetNotEditable}.\n * @property {number} [delta=1] The zoom level delta on each key press.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map using keyboard + and -.\n * Note that, although this interaction is by default included in maps,\n * the keys can only be used when browser focus is on the element to which\n * the keyboard events are attached. By default, this is the map div,\n * though you can change this with the `keyboardEventTarget` in\n * {@link module:ol/Map~Map}. `document` never loses focus but, for any other\n * element, focus will have to be on, and returned to, this element if the keys\n * are to function.\n * See also {@link moudle:ol/interaction/KeyboardPan~KeyboardPan}.\n *\n * @constructor\n * @param {module:ol/interaction/KeyboardZoom~Options=} opt_options Options.\n * @extends {module:ol/interaction/Interaction}\n * @api\n */\nconst KeyboardZoom = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : targetNotEditable;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delta_ = options.delta ? options.delta : 1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 100;\n\n};\n\ninherits(KeyboardZoom, Interaction);\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} if it was a\n * `KeyEvent`, and decides whether to zoom in or out (depending on whether the\n * key pressed was '+' or '-').\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/KeyboardZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  if (mapBrowserEvent.type == EventType.KEYDOWN ||\n      mapBrowserEvent.type == EventType.KEYPRESS) {\n    const keyEvent = mapBrowserEvent.originalEvent;\n    const charCode = keyEvent.charCode;\n    if (this.condition_(mapBrowserEvent) &&\n        (charCode == '+'.charCodeAt(0) || charCode == '-'.charCodeAt(0))) {\n      const map = mapBrowserEvent.map;\n      const delta = (charCode == '+'.charCodeAt(0)) ? this.delta_ : -this.delta_;\n      const view = map.getView();\n      zoomByDelta(view, delta, undefined, this.duration_);\n      mapBrowserEvent.preventDefault();\n      stopEvent = true;\n    }\n  }\n  return !stopEvent;\n}\n\nexport default KeyboardZoom;\n","/**\n * @module ol/interaction/Modify\n */\nimport {getUid, inherits} from '../index.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {equals} from '../array.js';\nimport {equals as coordinatesEqual, distance as coordinateDistance, squaredDistance as squaredCoordinateDistance, squaredDistanceToSegment, closestOnSegment} from '../coordinate.js';\nimport {listen, unlisten} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {always, primaryAction, altKeyOnly, singleClick} from '../events/condition.js';\nimport {boundingExtent, buffer, createOrUpdateFromCoordinate} from '../extent.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @enum {string}\n */\nconst ModifyEventType = {\n  /**\n   * Triggered upon feature modification start\n   * @event ModifyEvent#modifystart\n   * @api\n   */\n  MODIFYSTART: 'modifystart',\n  /**\n   * Triggered upon feature modification end\n   * @event ModifyEvent#modifyend\n   * @api\n   */\n  MODIFYEND: 'modifyend'\n};\n\n\n/**\n * @typedef {Object} SegmentData\n * @property {Array.<number>} [depth]\n * @property {module:ol/Feature} feature\n * @property {module:ol/geom/SimpleGeometry} geometry\n * @property {number} index\n * @property {Array.<module:ol/extent~Extent>} segment\n * @property {Array.<module:ol/interaction/Modify~SegmentData>} [featureSegments]\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event will be considered to add or move a\n * vertex to the sketch. Default is\n * {@link module:ol/events/condition~primaryAction}.\n * @property {module:ol/events/condition~Condition} [deleteCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. By default,\n * {@link module:ol/events/condition~singleClick} with\n * {@link module:ol/events/condition~altKeyOnly} results in a vertex deletion.\n * @property {module:ol/events/condition~Condition} [insertVertexCondition] A\n * function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and\n * returns a boolean to indicate whether a new vertex can be added to the sketch\n * features. Default is {@link module:ol/events/condition~always}.\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the\n * pointer close enough to a segment or vertex for editing.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style]\n * Style used for the features being modified. By default the default edit\n * style is used (see {@link module:ol/style}).\n * @property {module:ol/source/Vector} [source] The vector source with\n * features to modify.  If a vector source is not provided, a feature collection\n * must be provided with the features option.\n * @property {module:ol/Collection.<module:ol/Feature>} [features]\n * The features the interaction works on.  If a feature collection is not\n * provided, a vector source must be provided with the source option.\n * @property {boolean} [wrapX=false] Wrap the world horizontally on the sketch\n * overlay.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Modify~Modify} instances are\n * instances of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {ModifyEventType} type Type.\n * @param {module:ol/Collection.<module:ol/Feature>} features\n * The features modified.\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserPointerEvent\n * Associated {@link module:ol/MapBrowserPointerEvent}.\n */\nexport const ModifyEvent = function(type, features, mapBrowserPointerEvent) {\n\n  Event.call(this, type);\n\n  /**\n   * The features being modified.\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @api\n   */\n  this.features = features;\n\n  /**\n   * Associated {@link module:ol/MapBrowserEvent}.\n   * @type {module:ol/MapBrowserEvent}\n   * @api\n   */\n  this.mapBrowserEvent = mapBrowserPointerEvent;\n};\n\ninherits(ModifyEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for modifying feature geometries.  To modify features that have\n * been added to an existing source, construct the modify interaction with the\n * `source` option.  If you want to modify features in a collection (for example,\n * the collection used by a select interaction), construct the interaction with\n * the `features` option.  The interaction must be constructed with either a\n * `source` or `features` option.\n *\n * By default, the interaction will allow deletion of vertices when the `alt`\n * key is pressed.  To configure the interaction with a different condition\n * for deletion, use the `deleteCondition` option.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/Modify~Options} options Options.\n * @fires module:ol/interaction/Modify~ModifyEvent\n * @api\n */\nconst Modify = function(options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleEvent: handleEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : primaryAction;\n\n\n  /**\n   * @private\n   * @param {module:ol/MapBrowserEvent} mapBrowserEvent Browser event.\n   * @return {boolean} Combined condition result.\n   */\n  this.defaultDeleteCondition_ = function(mapBrowserEvent) {\n    return altKeyOnly(mapBrowserEvent) && singleClick(mapBrowserEvent);\n  };\n\n  /**\n   * @type {module:ol/events/condition~Condition}\n   * @private\n   */\n  this.deleteCondition_ = options.deleteCondition ?\n    options.deleteCondition : this.defaultDeleteCondition_;\n\n  /**\n   * @type {module:ol/events/condition~Condition}\n   * @private\n   */\n  this.insertVertexCondition_ = options.insertVertexCondition ?\n    options.insertVertexCondition : always;\n\n  /**\n   * Editing vertex.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.vertexFeature_ = null;\n\n  /**\n   * Segments intersecting {@link this.vertexFeature_} by segment uid.\n   * @type {Object.<string, boolean>}\n   * @private\n   */\n  this.vertexSegments_ = null;\n\n  /**\n   * @type {module:ol~Pixel}\n   * @private\n   */\n  this.lastPixel_ = [0, 0];\n\n  /**\n   * Tracks if the next `singleclick` event should be ignored to prevent\n   * accidental deletion right after vertex creation.\n   * @type {boolean}\n   * @private\n   */\n  this.ignoreNextSingleClick_ = false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.modified_ = false;\n\n  /**\n   * Segment RTree for each layer\n   * @type {module:ol/structs/RBush.<module:ol/interaction/Modify~SegmentData>}\n   * @private\n   */\n  this.rBush_ = new RBush();\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n    options.pixelTolerance : 10;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.snappedToVertex_ = false;\n\n  /**\n   * Indicate whether the interaction is currently changing a feature's\n   * coordinates.\n   * @type {boolean}\n   * @private\n   */\n  this.changingFeature_ = false;\n\n  /**\n   * @type {Array}\n   * @private\n   */\n  this.dragSegments_ = [];\n\n  /**\n   * Draw overlay where sketch features are drawn.\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.overlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: !!options.wrapX\n    }),\n    style: options.style ? options.style :\n      getDefaultStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  /**\n   * @const\n   * @private\n   * @type {!Object.<string, function(module:ol/Feature, module:ol/geom/Geometry)>}\n   */\n  this.SEGMENT_WRITERS_ = {\n    'Point': this.writePointGeometry_,\n    'LineString': this.writeLineStringGeometry_,\n    'LinearRing': this.writeLineStringGeometry_,\n    'Polygon': this.writePolygonGeometry_,\n    'MultiPoint': this.writeMultiPointGeometry_,\n    'MultiLineString': this.writeMultiLineStringGeometry_,\n    'MultiPolygon': this.writeMultiPolygonGeometry_,\n    'Circle': this.writeCircleGeometry_,\n    'GeometryCollection': this.writeGeometryCollectionGeometry_\n  };\n\n\n  /**\n   * @type {module:ol/source/Vector}\n   * @private\n   */\n  this.source_ = null;\n\n  let features;\n  if (options.source) {\n    this.source_ = options.source;\n    features = new Collection(this.source_.getFeatures());\n    listen(this.source_, VectorEventType.ADDFEATURE,\n      this.handleSourceAdd_, this);\n    listen(this.source_, VectorEventType.REMOVEFEATURE,\n      this.handleSourceRemove_, this);\n  } else {\n    features = options.features;\n  }\n  if (!features) {\n    throw new Error('The modify interaction requires features or a source');\n  }\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = features;\n\n  this.features_.forEach(this.addFeature_.bind(this));\n  listen(this.features_, CollectionEventType.ADD,\n    this.handleFeatureAdd_, this);\n  listen(this.features_, CollectionEventType.REMOVE,\n    this.handleFeatureRemove_, this);\n\n  /**\n   * @type {module:ol/MapBrowserPointerEvent}\n   * @private\n   */\n  this.lastPointerEvent_ = null;\n\n};\n\ninherits(Modify, PointerInteraction);\n\n\n/**\n * The segment index assigned to a circle's center when\n * breaking up a circle into ModifySegmentDataType segments.\n * @type {number}\n */\nconst CIRCLE_CENTER_INDEX = 0;\n\n/**\n * The segment index assigned to a circle's circumference when\n * breaking up a circle into ModifySegmentDataType segments.\n * @type {number}\n */\nconst CIRCLE_CIRCUMFERENCE_INDEX = 1;\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nModify.prototype.addFeature_ = function(feature) {\n  const geometry = feature.getGeometry();\n  if (geometry && geometry.getType() in this.SEGMENT_WRITERS_) {\n    this.SEGMENT_WRITERS_[geometry.getType()].call(this, feature, geometry);\n  }\n  const map = this.getMap();\n  if (map && map.isRendered() && this.getActive()) {\n    this.handlePointerAtPixel_(this.lastPixel_, map);\n  }\n  listen(feature, EventType.CHANGE,\n    this.handleFeatureChange_, this);\n};\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Map browser event\n * @private\n */\nModify.prototype.willModifyFeatures_ = function(evt) {\n  if (!this.modified_) {\n    this.modified_ = true;\n    this.dispatchEvent(new ModifyEvent(\n      ModifyEventType.MODIFYSTART, this.features_, evt));\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nModify.prototype.removeFeature_ = function(feature) {\n  this.removeFeatureSegmentData_(feature);\n  // Remove the vertex feature if the collection of canditate features\n  // is empty.\n  if (this.vertexFeature_ && this.features_.getLength() === 0) {\n    this.overlay_.getSource().removeFeature(this.vertexFeature_);\n    this.vertexFeature_ = null;\n  }\n  unlisten(feature, EventType.CHANGE,\n    this.handleFeatureChange_, this);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nModify.prototype.removeFeatureSegmentData_ = function(feature) {\n  const rBush = this.rBush_;\n  const /** @type {Array.<module:ol/interaction/Modify~SegmentData>} */ nodesToRemove = [];\n  rBush.forEach(\n    /**\n     * @param {module:ol/interaction/Modify~SegmentData} node RTree node.\n     */\n    function(node) {\n      if (feature === node.feature) {\n        nodesToRemove.push(node);\n      }\n    });\n  for (let i = nodesToRemove.length - 1; i >= 0; --i) {\n    rBush.remove(nodesToRemove[i]);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nModify.prototype.setActive = function(active) {\n  if (this.vertexFeature_ && !active) {\n    this.overlay_.getSource().removeFeature(this.vertexFeature_);\n    this.vertexFeature_ = null;\n  }\n  PointerInteraction.prototype.setActive.call(this, active);\n};\n\n\n/**\n * @inheritDoc\n */\nModify.prototype.setMap = function(map) {\n  this.overlay_.setMap(map);\n  PointerInteraction.prototype.setMap.call(this, map);\n};\n\n\n/**\n * @param {module:ol/source/Vector~VectorSourceEvent} event Event.\n * @private\n */\nModify.prototype.handleSourceAdd_ = function(event) {\n  if (event.feature) {\n    this.features_.push(event.feature);\n  }\n};\n\n\n/**\n * @param {module:ol/source/Vector~VectorSourceEvent} event Event.\n * @private\n */\nModify.prototype.handleSourceRemove_ = function(event) {\n  if (event.feature) {\n    this.features_.remove(event.feature);\n  }\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nModify.prototype.handleFeatureAdd_ = function(evt) {\n  this.addFeature_(/** @type {module:ol/Feature} */ (evt.element));\n};\n\n\n/**\n * @param {module:ol/events/Event} evt Event.\n * @private\n */\nModify.prototype.handleFeatureChange_ = function(evt) {\n  if (!this.changingFeature_) {\n    const feature = /** @type {module:ol/Feature} */ (evt.target);\n    this.removeFeature_(feature);\n    this.addFeature_(feature);\n  }\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nModify.prototype.handleFeatureRemove_ = function(evt) {\n  const feature = /** @type {module:ol/Feature} */ (evt.element);\n  this.removeFeature_(feature);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Point} geometry Geometry.\n * @private\n */\nModify.prototype.writePointGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    feature: feature,\n    geometry: geometry,\n    segment: [coordinates, coordinates]\n  });\n  this.rBush_.insert(geometry.getExtent(), segmentData);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPoint} geometry Geometry.\n * @private\n */\nModify.prototype.writeMultiPointGeometry_ = function(feature, geometry) {\n  const points = geometry.getCoordinates();\n  for (let i = 0, ii = points.length; i < ii; ++i) {\n    const coordinates = points[i];\n    const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n      feature: feature,\n      geometry: geometry,\n      depth: [i],\n      index: i,\n      segment: [coordinates, coordinates]\n    });\n    this.rBush_.insert(geometry.getExtent(), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/LineString} geometry Geometry.\n * @private\n */\nModify.prototype.writeLineStringGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n    const segment = coordinates.slice(i, i + 2);\n    const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n      feature: feature,\n      geometry: geometry,\n      index: i,\n      segment: segment\n    });\n    this.rBush_.insert(boundingExtent(segment), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiLineString} geometry Geometry.\n * @private\n */\nModify.prototype.writeMultiLineStringGeometry_ = function(feature, geometry) {\n  const lines = geometry.getCoordinates();\n  for (let j = 0, jj = lines.length; j < jj; ++j) {\n    const coordinates = lines[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n        feature: feature,\n        geometry: geometry,\n        depth: [j],\n        index: i,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Polygon} geometry Geometry.\n * @private\n */\nModify.prototype.writePolygonGeometry_ = function(feature, geometry) {\n  const rings = geometry.getCoordinates();\n  for (let j = 0, jj = rings.length; j < jj; ++j) {\n    const coordinates = rings[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n        feature: feature,\n        geometry: geometry,\n        depth: [j],\n        index: i,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @private\n */\nModify.prototype.writeMultiPolygonGeometry_ = function(feature, geometry) {\n  const polygons = geometry.getCoordinates();\n  for (let k = 0, kk = polygons.length; k < kk; ++k) {\n    const rings = polygons[k];\n    for (let j = 0, jj = rings.length; j < jj; ++j) {\n      const coordinates = rings[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n        const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n          feature: feature,\n          geometry: geometry,\n          depth: [j, k],\n          index: i,\n          segment: segment\n        });\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n};\n\n\n/**\n * We convert a circle into two segments.  The segment at index\n * {@link CIRCLE_CENTER_INDEX} is the\n * circle's center (a point).  The segment at index\n * {@link CIRCLE_CIRCUMFERENCE_INDEX} is\n * the circumference, and is not a line segment.\n *\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/geom/Circle} geometry Geometry.\n * @private\n */\nModify.prototype.writeCircleGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCenter();\n  const centerSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    feature: feature,\n    geometry: geometry,\n    index: CIRCLE_CENTER_INDEX,\n    segment: [coordinates, coordinates]\n  });\n  const circumferenceSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    feature: feature,\n    geometry: geometry,\n    index: CIRCLE_CIRCUMFERENCE_INDEX,\n    segment: [coordinates, coordinates]\n  });\n  const featureSegments = [centerSegmentData, circumferenceSegmentData];\n  centerSegmentData.featureSegments = circumferenceSegmentData.featureSegments = featureSegments;\n  this.rBush_.insert(createOrUpdateFromCoordinate(coordinates), centerSegmentData);\n  this.rBush_.insert(geometry.getExtent(), circumferenceSegmentData);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @private\n */\nModify.prototype.writeGeometryCollectionGeometry_ = function(feature, geometry) {\n  const geometries = geometry.getGeometriesArray();\n  for (let i = 0; i < geometries.length; ++i) {\n    this.SEGMENT_WRITERS_[geometries[i].getType()].call(this, feature, geometries[i]);\n  }\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinates Coordinates.\n * @return {module:ol/Feature} Vertex feature.\n * @private\n */\nModify.prototype.createOrUpdateVertexFeature_ = function(coordinates) {\n  let vertexFeature = this.vertexFeature_;\n  if (!vertexFeature) {\n    vertexFeature = new Feature(new Point(coordinates));\n    this.vertexFeature_ = vertexFeature;\n    this.overlay_.getSource().addFeature(vertexFeature);\n  } else {\n    const geometry = /** @type {module:ol/geom/Point} */ (vertexFeature.getGeometry());\n    geometry.setCoordinates(coordinates);\n  }\n  return vertexFeature;\n};\n\n\n/**\n * @param {module:ol/interaction/Modify~SegmentData} a The first segment data.\n * @param {module:ol/interaction/Modify~SegmentData} b The second segment data.\n * @return {number} The difference in indexes.\n */\nfunction compareIndexes(a, b) {\n  return a.index - b.index;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/Modify}\n */\nfunction handleDownEvent(evt) {\n  if (!this.condition_(evt)) {\n    return false;\n  }\n  this.handlePointerAtPixel_(evt.pixel, evt.map);\n  const pixelCoordinate = evt.map.getCoordinateFromPixel(evt.pixel);\n  this.dragSegments_.length = 0;\n  this.modified_ = false;\n  const vertexFeature = this.vertexFeature_;\n  if (vertexFeature) {\n    const insertVertices = [];\n    const geometry = /** @type {module:ol/geom/Point} */ (vertexFeature.getGeometry());\n    const vertex = geometry.getCoordinates();\n    const vertexExtent = boundingExtent([vertex]);\n    const segmentDataMatches = this.rBush_.getInExtent(vertexExtent);\n    const componentSegments = {};\n    segmentDataMatches.sort(compareIndexes);\n    for (let i = 0, ii = segmentDataMatches.length; i < ii; ++i) {\n      const segmentDataMatch = segmentDataMatches[i];\n      const segment = segmentDataMatch.segment;\n      let uid = getUid(segmentDataMatch.feature);\n      const depth = segmentDataMatch.depth;\n      if (depth) {\n        uid += '-' + depth.join('-'); // separate feature components\n      }\n      if (!componentSegments[uid]) {\n        componentSegments[uid] = new Array(2);\n      }\n      if (segmentDataMatch.geometry.getType() === GeometryType.CIRCLE &&\n      segmentDataMatch.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n\n        const closestVertex = closestOnSegmentData(pixelCoordinate, segmentDataMatch);\n        if (coordinatesEqual(closestVertex, vertex) && !componentSegments[uid][0]) {\n          this.dragSegments_.push([segmentDataMatch, 0]);\n          componentSegments[uid][0] = segmentDataMatch;\n        }\n      } else if (coordinatesEqual(segment[0], vertex) &&\n          !componentSegments[uid][0]) {\n        this.dragSegments_.push([segmentDataMatch, 0]);\n        componentSegments[uid][0] = segmentDataMatch;\n      } else if (coordinatesEqual(segment[1], vertex) &&\n          !componentSegments[uid][1]) {\n\n        // prevent dragging closed linestrings by the connecting node\n        if ((segmentDataMatch.geometry.getType() ===\n            GeometryType.LINE_STRING ||\n            segmentDataMatch.geometry.getType() ===\n            GeometryType.MULTI_LINE_STRING) &&\n            componentSegments[uid][0] &&\n            componentSegments[uid][0].index === 0) {\n          continue;\n        }\n\n        this.dragSegments_.push([segmentDataMatch, 1]);\n        componentSegments[uid][1] = segmentDataMatch;\n      } else if (this.insertVertexCondition_(evt) && getUid(segment) in this.vertexSegments_ &&\n          (!componentSegments[uid][0] && !componentSegments[uid][1])) {\n        insertVertices.push([segmentDataMatch, vertex]);\n      }\n    }\n    if (insertVertices.length) {\n      this.willModifyFeatures_(evt);\n    }\n    for (let j = insertVertices.length - 1; j >= 0; --j) {\n      this.insertVertex_.apply(this, insertVertices[j]);\n    }\n  }\n  return !!this.vertexFeature_;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @this {module:ol/interaction/Modify}\n */\nfunction handleDragEvent(evt) {\n  this.ignoreNextSingleClick_ = false;\n  this.willModifyFeatures_(evt);\n\n  const vertex = evt.coordinate;\n  for (let i = 0, ii = this.dragSegments_.length; i < ii; ++i) {\n    const dragSegment = this.dragSegments_[i];\n    const segmentData = dragSegment[0];\n    const depth = segmentData.depth;\n    const geometry = segmentData.geometry;\n    let coordinates;\n    const segment = segmentData.segment;\n    const index = dragSegment[1];\n\n    while (vertex.length < geometry.getStride()) {\n      vertex.push(segment[index][vertex.length]);\n    }\n\n    switch (geometry.getType()) {\n      case GeometryType.POINT:\n        coordinates = vertex;\n        segment[0] = segment[1] = vertex;\n        break;\n      case GeometryType.MULTI_POINT:\n        coordinates = geometry.getCoordinates();\n        coordinates[segmentData.index] = vertex;\n        segment[0] = segment[1] = vertex;\n        break;\n      case GeometryType.LINE_STRING:\n        coordinates = geometry.getCoordinates();\n        coordinates[segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[0]][segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.POLYGON:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[0]][segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.MULTI_POLYGON:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[1]][depth[0]][segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.CIRCLE:\n        segment[0] = segment[1] = vertex;\n        if (segmentData.index === CIRCLE_CENTER_INDEX) {\n          this.changingFeature_ = true;\n          geometry.setCenter(vertex);\n          this.changingFeature_ = false;\n        } else { // We're dragging the circle's circumference:\n          this.changingFeature_ = true;\n          geometry.setRadius(coordinateDistance(geometry.getCenter(), vertex));\n          this.changingFeature_ = false;\n        }\n        break;\n      default:\n        // pass\n    }\n\n    if (coordinates) {\n      this.setGeometryCoordinates_(geometry, coordinates);\n    }\n  }\n  this.createOrUpdateVertexFeature_(vertex);\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Modify}\n */\nfunction handleUpEvent(evt) {\n  for (let i = this.dragSegments_.length - 1; i >= 0; --i) {\n    const segmentData = this.dragSegments_[i][0];\n    const geometry = segmentData.geometry;\n    if (geometry.getType() === GeometryType.CIRCLE) {\n      // Update a circle object in the R* bush:\n      const coordinates = geometry.getCenter();\n      const centerSegmentData = segmentData.featureSegments[0];\n      const circumferenceSegmentData = segmentData.featureSegments[1];\n      centerSegmentData.segment[0] = centerSegmentData.segment[1] = coordinates;\n      circumferenceSegmentData.segment[0] = circumferenceSegmentData.segment[1] = coordinates;\n      this.rBush_.update(createOrUpdateFromCoordinate(coordinates), centerSegmentData);\n      this.rBush_.update(geometry.getExtent(), circumferenceSegmentData);\n    } else {\n      this.rBush_.update(boundingExtent(segmentData.segment), segmentData);\n    }\n  }\n  if (this.modified_) {\n    this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND, this.features_, evt));\n    this.modified_ = false;\n  }\n  return false;\n}\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may modify the\n * geometry.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Modify}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!(mapBrowserEvent instanceof MapBrowserPointerEvent)) {\n    return true;\n  }\n  this.lastPointerEvent_ = mapBrowserEvent;\n\n  let handled;\n  if (!mapBrowserEvent.map.getView().getInteracting() &&\n      mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE &&\n      !this.handlingDownUpSequence) {\n    this.handlePointerMove_(mapBrowserEvent);\n  }\n  if (this.vertexFeature_ && this.deleteCondition_(mapBrowserEvent)) {\n    if (mapBrowserEvent.type != MapBrowserEventType.SINGLECLICK || !this.ignoreNextSingleClick_) {\n      handled = this.removePoint();\n    } else {\n      handled = true;\n    }\n  }\n\n  if (mapBrowserEvent.type == MapBrowserEventType.SINGLECLICK) {\n    this.ignoreNextSingleClick_ = false;\n  }\n\n  return handlePointerEvent.call(this, mapBrowserEvent) && !handled;\n}\n\n\n/**\n * @param {module:ol/MapBrowserEvent} evt Event.\n * @private\n */\nModify.prototype.handlePointerMove_ = function(evt) {\n  this.lastPixel_ = evt.pixel;\n  this.handlePointerAtPixel_(evt.pixel, evt.map);\n};\n\n\n/**\n * @param {module:ol~Pixel} pixel Pixel\n * @param {module:ol/PluggableMap} map Map.\n * @private\n */\nModify.prototype.handlePointerAtPixel_ = function(pixel, map) {\n  const pixelCoordinate = map.getCoordinateFromPixel(pixel);\n  const sortByDistance = function(a, b) {\n    return pointDistanceToSegmentDataSquared(pixelCoordinate, a) -\n        pointDistanceToSegmentDataSquared(pixelCoordinate, b);\n  };\n\n  const box = buffer(createOrUpdateFromCoordinate(pixelCoordinate),\n    map.getView().getResolution() * this.pixelTolerance_);\n\n  const rBush = this.rBush_;\n  const nodes = rBush.getInExtent(box);\n  if (nodes.length > 0) {\n    nodes.sort(sortByDistance);\n    const node = nodes[0];\n    const closestSegment = node.segment;\n    let vertex = closestOnSegmentData(pixelCoordinate, node);\n    const vertexPixel = map.getPixelFromCoordinate(vertex);\n    let dist = coordinateDistance(pixel, vertexPixel);\n    if (dist <= this.pixelTolerance_) {\n      const vertexSegments = {};\n\n      if (node.geometry.getType() === GeometryType.CIRCLE &&\n      node.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n\n        this.snappedToVertex_ = true;\n        this.createOrUpdateVertexFeature_(vertex);\n      } else {\n        const pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n        const pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n        const squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n        const squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n        dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n        this.snappedToVertex_ = dist <= this.pixelTolerance_;\n        if (this.snappedToVertex_) {\n          vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n        }\n        this.createOrUpdateVertexFeature_(vertex);\n        for (let i = 1, ii = nodes.length; i < ii; ++i) {\n          const segment = nodes[i].segment;\n          if ((coordinatesEqual(closestSegment[0], segment[0]) &&\n              coordinatesEqual(closestSegment[1], segment[1]) ||\n              (coordinatesEqual(closestSegment[0], segment[1]) &&\n              coordinatesEqual(closestSegment[1], segment[0])))) {\n            vertexSegments[getUid(segment)] = true;\n          } else {\n            break;\n          }\n        }\n      }\n\n      vertexSegments[getUid(closestSegment)] = true;\n      this.vertexSegments_ = vertexSegments;\n      return;\n    }\n  }\n  if (this.vertexFeature_) {\n    this.overlay_.getSource().removeFeature(this.vertexFeature_);\n    this.vertexFeature_ = null;\n  }\n};\n\n\n/**\n * Returns the distance from a point to a line segment.\n *\n * @param {module:ol/coordinate~Coordinate} pointCoordinates The coordinates of the point from\n *        which to calculate the distance.\n * @param {module:ol/interaction/Modify~SegmentData} segmentData The object describing the line\n *        segment we are calculating the distance to.\n * @return {number} The square of the distance between a point and a line segment.\n */\nfunction pointDistanceToSegmentDataSquared(pointCoordinates, segmentData) {\n  const geometry = segmentData.geometry;\n\n  if (geometry.getType() === GeometryType.CIRCLE) {\n    const circleGeometry = /** @type {module:ol/geom/Circle} */ (geometry);\n\n    if (segmentData.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n      const distanceToCenterSquared =\n            squaredCoordinateDistance(circleGeometry.getCenter(), pointCoordinates);\n      const distanceToCircumference =\n            Math.sqrt(distanceToCenterSquared) - circleGeometry.getRadius();\n      return distanceToCircumference * distanceToCircumference;\n    }\n  }\n  return squaredDistanceToSegment(pointCoordinates, segmentData.segment);\n}\n\n/**\n * Returns the point closest to a given line segment.\n *\n * @param {module:ol/coordinate~Coordinate} pointCoordinates The point to which a closest point\n *        should be found.\n * @param {module:ol/interaction/Modify~SegmentData} segmentData The object describing the line\n *        segment which should contain the closest point.\n * @return {module:ol/coordinate~Coordinate} The point closest to the specified line segment.\n */\nfunction closestOnSegmentData(pointCoordinates, segmentData) {\n  const geometry = segmentData.geometry;\n\n  if (geometry.getType() === GeometryType.CIRCLE &&\n  segmentData.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n    return geometry.getClosestPoint(pointCoordinates);\n  }\n  return closestOnSegment(pointCoordinates, segmentData.segment);\n}\n\n\n/**\n * @param {module:ol/interaction/Modify~SegmentData} segmentData Segment data.\n * @param {module:ol/coordinate~Coordinate} vertex Vertex.\n * @private\n */\nModify.prototype.insertVertex_ = function(segmentData, vertex) {\n  const segment = segmentData.segment;\n  const feature = segmentData.feature;\n  const geometry = segmentData.geometry;\n  const depth = segmentData.depth;\n  const index = /** @type {number} */ (segmentData.index);\n  let coordinates;\n\n  while (vertex.length < geometry.getStride()) {\n    vertex.push(0);\n  }\n\n  switch (geometry.getType()) {\n    case GeometryType.MULTI_LINE_STRING:\n      coordinates = geometry.getCoordinates();\n      coordinates[depth[0]].splice(index + 1, 0, vertex);\n      break;\n    case GeometryType.POLYGON:\n      coordinates = geometry.getCoordinates();\n      coordinates[depth[0]].splice(index + 1, 0, vertex);\n      break;\n    case GeometryType.MULTI_POLYGON:\n      coordinates = geometry.getCoordinates();\n      coordinates[depth[1]][depth[0]].splice(index + 1, 0, vertex);\n      break;\n    case GeometryType.LINE_STRING:\n      coordinates = geometry.getCoordinates();\n      coordinates.splice(index + 1, 0, vertex);\n      break;\n    default:\n      return;\n  }\n\n  this.setGeometryCoordinates_(geometry, coordinates);\n  const rTree = this.rBush_;\n  rTree.remove(segmentData);\n  this.updateSegmentIndices_(geometry, index, depth, 1);\n  const newSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    segment: [segment[0], vertex],\n    feature: feature,\n    geometry: geometry,\n    depth: depth,\n    index: index\n  });\n  rTree.insert(boundingExtent(newSegmentData.segment),\n    newSegmentData);\n  this.dragSegments_.push([newSegmentData, 1]);\n\n  const newSegmentData2 = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    segment: [vertex, segment[1]],\n    feature: feature,\n    geometry: geometry,\n    depth: depth,\n    index: index + 1\n  });\n  rTree.insert(boundingExtent(newSegmentData2.segment), newSegmentData2);\n  this.dragSegments_.push([newSegmentData2, 0]);\n  this.ignoreNextSingleClick_ = true;\n};\n\n/**\n * Removes the vertex currently being pointed.\n * @return {boolean} True when a vertex was removed.\n * @api\n */\nModify.prototype.removePoint = function() {\n  if (this.lastPointerEvent_ && this.lastPointerEvent_.type != MapBrowserEventType.POINTERDRAG) {\n    const evt = this.lastPointerEvent_;\n    this.willModifyFeatures_(evt);\n    this.removeVertex_();\n    this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND, this.features_, evt));\n    this.modified_ = false;\n    return true;\n  }\n  return false;\n};\n\n/**\n * Removes a vertex from all matching features.\n * @return {boolean} True when a vertex was removed.\n * @private\n */\nModify.prototype.removeVertex_ = function() {\n  const dragSegments = this.dragSegments_;\n  const segmentsByFeature = {};\n  let deleted = false;\n  let component, coordinates, dragSegment, geometry, i, index, left;\n  let newIndex, right, segmentData, uid;\n  for (i = dragSegments.length - 1; i >= 0; --i) {\n    dragSegment = dragSegments[i];\n    segmentData = dragSegment[0];\n    uid = getUid(segmentData.feature);\n    if (segmentData.depth) {\n      // separate feature components\n      uid += '-' + segmentData.depth.join('-');\n    }\n    if (!(uid in segmentsByFeature)) {\n      segmentsByFeature[uid] = {};\n    }\n    if (dragSegment[1] === 0) {\n      segmentsByFeature[uid].right = segmentData;\n      segmentsByFeature[uid].index = segmentData.index;\n    } else if (dragSegment[1] == 1) {\n      segmentsByFeature[uid].left = segmentData;\n      segmentsByFeature[uid].index = segmentData.index + 1;\n    }\n\n  }\n  for (uid in segmentsByFeature) {\n    right = segmentsByFeature[uid].right;\n    left = segmentsByFeature[uid].left;\n    index = segmentsByFeature[uid].index;\n    newIndex = index - 1;\n    if (left !== undefined) {\n      segmentData = left;\n    } else {\n      segmentData = right;\n    }\n    if (newIndex < 0) {\n      newIndex = 0;\n    }\n    geometry = segmentData.geometry;\n    coordinates = geometry.getCoordinates();\n    component = coordinates;\n    deleted = false;\n    switch (geometry.getType()) {\n      case GeometryType.MULTI_LINE_STRING:\n        if (coordinates[segmentData.depth[0]].length > 2) {\n          coordinates[segmentData.depth[0]].splice(index, 1);\n          deleted = true;\n        }\n        break;\n      case GeometryType.LINE_STRING:\n        if (coordinates.length > 2) {\n          coordinates.splice(index, 1);\n          deleted = true;\n        }\n        break;\n      case GeometryType.MULTI_POLYGON:\n        component = component[segmentData.depth[1]];\n        /* falls through */\n      case GeometryType.POLYGON:\n        component = component[segmentData.depth[0]];\n        if (component.length > 4) {\n          if (index == component.length - 1) {\n            index = 0;\n          }\n          component.splice(index, 1);\n          deleted = true;\n          if (index === 0) {\n            // close the ring again\n            component.pop();\n            component.push(component[0]);\n            newIndex = component.length - 1;\n          }\n        }\n        break;\n      default:\n        // pass\n    }\n\n    if (deleted) {\n      this.setGeometryCoordinates_(geometry, coordinates);\n      const segments = [];\n      if (left !== undefined) {\n        this.rBush_.remove(left);\n        segments.push(left.segment[0]);\n      }\n      if (right !== undefined) {\n        this.rBush_.remove(right);\n        segments.push(right.segment[1]);\n      }\n      if (left !== undefined && right !== undefined) {\n        const newSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n          depth: segmentData.depth,\n          feature: segmentData.feature,\n          geometry: segmentData.geometry,\n          index: newIndex,\n          segment: segments\n        });\n        this.rBush_.insert(boundingExtent(newSegmentData.segment),\n          newSegmentData);\n      }\n      this.updateSegmentIndices_(geometry, index, segmentData.depth, -1);\n      if (this.vertexFeature_) {\n        this.overlay_.getSource().removeFeature(this.vertexFeature_);\n        this.vertexFeature_ = null;\n      }\n      dragSegments.length = 0;\n    }\n\n  }\n  return deleted;\n};\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {Array} coordinates Coordinates.\n * @private\n */\nModify.prototype.setGeometryCoordinates_ = function(geometry, coordinates) {\n  this.changingFeature_ = true;\n  geometry.setCoordinates(coordinates);\n  this.changingFeature_ = false;\n};\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {number} index Index.\n * @param {Array.<number>|undefined} depth Depth.\n * @param {number} delta Delta (1 or -1).\n * @private\n */\nModify.prototype.updateSegmentIndices_ = function(\n  geometry, index, depth, delta) {\n  this.rBush_.forEachInExtent(geometry.getExtent(), function(segmentDataMatch) {\n    if (segmentDataMatch.geometry === geometry &&\n        (depth === undefined || segmentDataMatch.depth === undefined ||\n        equals(segmentDataMatch.depth, depth)) &&\n        segmentDataMatch.index > index) {\n      segmentDataMatch.index += delta;\n    }\n  });\n};\n\n\n/**\n * @return {module:ol/style/Style~StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POINT];\n  };\n}\n\n\nexport default Modify;\n","/**\n * @module ol/interaction/MouseWheelZoom\n */\nimport {inherits} from '../index.js';\nimport ViewHint from '../ViewHint.js';\nimport {always} from '../events/condition.js';\nimport {easeOut} from '../easing.js';\nimport EventType from '../events/EventType.js';\nimport {DEVICE_PIXEL_RATIO, FIREFOX, SAFARI} from '../has.js';\nimport Interaction, {zoomByDelta} from '../interaction/Interaction.js';\nimport {clamp} from '../math.js';\n\n\n/**\n * Maximum mouse wheel delta.\n * @type {number}\n */\nconst MAX_DELTA = 1;\n\n\n/**\n * @enum {string}\n */\nexport const Mode = {\n  TRACKPAD: 'trackpad',\n  WHEEL: 'wheel'\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~always}.\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {number} [timeout=80] Mouse wheel timeout duration in milliseconds.\n * @property {boolean} [constrainResolution=false] When using a trackpad or\n * magic mouse, zoom to the closest integer zoom level after the scroll gesture\n * ends.\n * @property {boolean} [useAnchor=true] Enable zooming using the mouse's\n * location as the anchor. When set to `false`, zooming in and out will zoom to\n * the center of the screen instead of zooming on the mouse's location.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by scrolling the mouse wheel.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/MouseWheelZoom~Options=} opt_options Options.\n * @api\n */\nconst MouseWheelZoom = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delta_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.timeout_ = options.timeout !== undefined ? options.timeout : 80;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.useAnchor_ = options.useAnchor !== undefined ? options.useAnchor : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.constrainResolution_ = options.constrainResolution || false;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : always;\n\n  /**\n   * @private\n   * @type {?module:ol/coordinate~Coordinate}\n   */\n  this.lastAnchor_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.startTime_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.timeoutId_ = undefined;\n\n  /**\n   * @private\n   * @type {module:ol/interaction/MouseWheelZoom~Mode|undefined}\n   */\n  this.mode_ = undefined;\n\n  /**\n   * Trackpad events separated by this delay will be considered separate\n   * interactions.\n   * @type {number}\n   */\n  this.trackpadEventGap_ = 400;\n\n  /**\n   * @type {number|undefined}\n   */\n  this.trackpadTimeoutId_ = undefined;\n\n  /**\n   * The number of delta values per zoom level\n   * @private\n   * @type {number}\n   */\n  this.trackpadDeltaPerZoom_ = 300;\n\n  /**\n   * The zoom factor by which scroll zooming is allowed to exceed the limits.\n   * @private\n   * @type {number}\n   */\n  this.trackpadZoomBuffer_ = 1.5;\n\n};\n\ninherits(MouseWheelZoom, Interaction);\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} (if it was a\n * mousewheel-event) and eventually zooms the map.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} Allow event propagation.\n * @this {module:ol/interaction/MouseWheelZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!this.condition_(mapBrowserEvent)) {\n    return true;\n  }\n  const type = mapBrowserEvent.type;\n  if (type !== EventType.WHEEL && type !== EventType.MOUSEWHEEL) {\n    return true;\n  }\n\n  mapBrowserEvent.preventDefault();\n\n  const map = mapBrowserEvent.map;\n  const wheelEvent = /** @type {WheelEvent} */ (mapBrowserEvent.originalEvent);\n\n  if (this.useAnchor_) {\n    this.lastAnchor_ = mapBrowserEvent.coordinate;\n  }\n\n  // Delta normalisation inspired by\n  // https://github.com/mapbox/mapbox-gl-js/blob/001c7b9/js/ui/handler/scroll_zoom.js\n  let delta;\n  if (mapBrowserEvent.type == EventType.WHEEL) {\n    delta = wheelEvent.deltaY;\n    if (FIREFOX &&\n        wheelEvent.deltaMode === WheelEvent.DOM_DELTA_PIXEL) {\n      delta /= DEVICE_PIXEL_RATIO;\n    }\n    if (wheelEvent.deltaMode === WheelEvent.DOM_DELTA_LINE) {\n      delta *= 40;\n    }\n  } else if (mapBrowserEvent.type == EventType.MOUSEWHEEL) {\n    delta = -wheelEvent.wheelDeltaY;\n    if (SAFARI) {\n      delta /= 3;\n    }\n  }\n\n  if (delta === 0) {\n    return false;\n  }\n\n  const now = Date.now();\n\n  if (this.startTime_ === undefined) {\n    this.startTime_ = now;\n  }\n\n  if (!this.mode_ || now - this.startTime_ > this.trackpadEventGap_) {\n    this.mode_ = Math.abs(delta) < 4 ?\n      Mode.TRACKPAD :\n      Mode.WHEEL;\n  }\n\n  if (this.mode_ === Mode.TRACKPAD) {\n    const view = map.getView();\n    if (this.trackpadTimeoutId_) {\n      clearTimeout(this.trackpadTimeoutId_);\n    } else {\n      view.setHint(ViewHint.INTERACTING, 1);\n    }\n    this.trackpadTimeoutId_ = setTimeout(this.decrementInteractingHint_.bind(this), this.trackpadEventGap_);\n    let resolution = view.getResolution() * Math.pow(2, delta / this.trackpadDeltaPerZoom_);\n    const minResolution = view.getMinResolution();\n    const maxResolution = view.getMaxResolution();\n    let rebound = 0;\n    if (resolution < minResolution) {\n      resolution = Math.max(resolution, minResolution / this.trackpadZoomBuffer_);\n      rebound = 1;\n    } else if (resolution > maxResolution) {\n      resolution = Math.min(resolution, maxResolution * this.trackpadZoomBuffer_);\n      rebound = -1;\n    }\n    if (this.lastAnchor_) {\n      const center = view.calculateCenterZoom(resolution, this.lastAnchor_);\n      view.setCenter(view.constrainCenter(center));\n    }\n    view.setResolution(resolution);\n\n    if (rebound === 0 && this.constrainResolution_) {\n      view.animate({\n        resolution: view.constrainResolution(resolution, delta > 0 ? -1 : 1),\n        easing: easeOut,\n        anchor: this.lastAnchor_,\n        duration: this.duration_\n      });\n    }\n\n    if (rebound > 0) {\n      view.animate({\n        resolution: minResolution,\n        easing: easeOut,\n        anchor: this.lastAnchor_,\n        duration: 500\n      });\n    } else if (rebound < 0) {\n      view.animate({\n        resolution: maxResolution,\n        easing: easeOut,\n        anchor: this.lastAnchor_,\n        duration: 500\n      });\n    }\n    this.startTime_ = now;\n    return false;\n  }\n\n  this.delta_ += delta;\n\n  const timeLeft = Math.max(this.timeout_ - (now - this.startTime_), 0);\n\n  clearTimeout(this.timeoutId_);\n  this.timeoutId_ = setTimeout(this.handleWheelZoom_.bind(this, map), timeLeft);\n\n  return false;\n}\n\n\n/**\n * @private\n */\nMouseWheelZoom.prototype.decrementInteractingHint_ = function() {\n  this.trackpadTimeoutId_ = undefined;\n  const view = this.getMap().getView();\n  view.setHint(ViewHint.INTERACTING, -1);\n};\n\n\n/**\n * @private\n * @param {module:ol/PluggableMap} map Map.\n */\nMouseWheelZoom.prototype.handleWheelZoom_ = function(map) {\n  const view = map.getView();\n  if (view.getAnimating()) {\n    view.cancelAnimations();\n  }\n  const maxDelta = MAX_DELTA;\n  const delta = clamp(this.delta_, -maxDelta, maxDelta);\n  zoomByDelta(view, -delta, this.lastAnchor_, this.duration_);\n  this.mode_ = undefined;\n  this.delta_ = 0;\n  this.lastAnchor_ = null;\n  this.startTime_ = undefined;\n  this.timeoutId_ = undefined;\n};\n\n\n/**\n * Enable or disable using the mouse's location as an anchor when zooming\n * @param {boolean} useAnchor true to zoom to the mouse's location, false\n * to zoom to the center of the map\n * @api\n */\nMouseWheelZoom.prototype.setMouseAnchor = function(useAnchor) {\n  this.useAnchor_ = useAnchor;\n  if (!useAnchor) {\n    this.lastAnchor_ = null;\n  }\n};\n\n\nexport default MouseWheelZoom;\n","/**\n * @module ol/interaction/PinchRotate\n */\nimport {inherits} from '../index.js';\nimport ViewHint from '../ViewHint.js';\nimport {FALSE} from '../functions.js';\nimport {rotate, rotateWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from '../interaction/Pointer.js';\nimport {disable} from '../rotationconstraint.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] The duration of the animation in\n * milliseconds.\n * @property {number} [threshold=0.3] Minimal angle in radians to start a rotation.\n */\n\n\n/**\n * @classdesc\n * Allows the user to rotate the map by twisting with two fingers\n * on a touch screen.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/PinchRotate~Options=} opt_options Options.\n * @api\n */\nconst PinchRotate = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.anchor_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastAngle_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.rotating_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.rotationDelta_ = 0.0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.threshold_ = options.threshold !== undefined ? options.threshold : 0.3;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n};\n\ninherits(PinchRotate, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/PinchRotate}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  let rotationDelta = 0.0;\n\n  const touch0 = this.targetPointers[0];\n  const touch1 = this.targetPointers[1];\n\n  // angle between touches\n  const angle = Math.atan2(\n    touch1.clientY - touch0.clientY,\n    touch1.clientX - touch0.clientX);\n\n  if (this.lastAngle_ !== undefined) {\n    const delta = angle - this.lastAngle_;\n    this.rotationDelta_ += delta;\n    if (!this.rotating_ &&\n        Math.abs(this.rotationDelta_) > this.threshold_) {\n      this.rotating_ = true;\n    }\n    rotationDelta = delta;\n  }\n  this.lastAngle_ = angle;\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  if (view.getConstraints().rotation === disable) {\n    return;\n  }\n\n  // rotate anchor point.\n  // FIXME: should be the intersection point between the lines:\n  //     touch0,touch1 and previousTouch0,previousTouch1\n  const viewportPosition = map.getViewport().getBoundingClientRect();\n  const centroid = centroidFromPointers(this.targetPointers);\n  centroid[0] -= viewportPosition.left;\n  centroid[1] -= viewportPosition.top;\n  this.anchor_ = map.getCoordinateFromPixel(centroid);\n\n  // rotate\n  if (this.rotating_) {\n    const rotation = view.getRotation();\n    map.render();\n    rotateWithoutConstraints(view, rotation + rotationDelta, this.anchor_);\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/PinchRotate}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (this.targetPointers.length < 2) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    view.setHint(ViewHint.INTERACTING, -1);\n    if (this.rotating_) {\n      const rotation = view.getRotation();\n      rotate(view, rotation, this.anchor_, this.duration_);\n    }\n    return false;\n  } else {\n    return true;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/PinchRotate}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (this.targetPointers.length >= 2) {\n    const map = mapBrowserEvent.map;\n    this.anchor_ = null;\n    this.lastAngle_ = undefined;\n    this.rotating_ = false;\n    this.rotationDelta_ = 0.0;\n    if (!this.handlingDownUpSequence) {\n      map.getView().setHint(ViewHint.INTERACTING, 1);\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nPinchRotate.prototype.shouldStopEvent = FALSE;\n\nexport default PinchRotate;\n","/**\n * @module ol/interaction/PinchZoom\n */\nimport {inherits} from '../index.js';\nimport ViewHint from '../ViewHint.js';\nimport {FALSE} from '../functions.js';\nimport {zoom, zoomWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=400] Animation duration in milliseconds.\n * @property {boolean} [constrainResolution=false] Zoom to the closest integer\n * zoom level after the pinch gesture ends.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by pinching with two fingers\n * on a touch screen.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/PinchZoom~Options=} opt_options Options.\n * @api\n */\nconst PinchZoom = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.constrainResolution_ = options.constrainResolution || false;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.anchor_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 400;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastDistance_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.lastScaleDelta_ = 1;\n\n};\n\ninherits(PinchZoom, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/PinchZoom}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  let scaleDelta = 1.0;\n\n  const touch0 = this.targetPointers[0];\n  const touch1 = this.targetPointers[1];\n  const dx = touch0.clientX - touch1.clientX;\n  const dy = touch0.clientY - touch1.clientY;\n\n  // distance between touches\n  const distance = Math.sqrt(dx * dx + dy * dy);\n\n  if (this.lastDistance_ !== undefined) {\n    scaleDelta = this.lastDistance_ / distance;\n  }\n  this.lastDistance_ = distance;\n\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  const resolution = view.getResolution();\n  const maxResolution = view.getMaxResolution();\n  const minResolution = view.getMinResolution();\n  let newResolution = resolution * scaleDelta;\n  if (newResolution > maxResolution) {\n    scaleDelta = maxResolution / resolution;\n    newResolution = maxResolution;\n  } else if (newResolution < minResolution) {\n    scaleDelta = minResolution / resolution;\n    newResolution = minResolution;\n  }\n\n  if (scaleDelta != 1.0) {\n    this.lastScaleDelta_ = scaleDelta;\n  }\n\n  // scale anchor point.\n  const viewportPosition = map.getViewport().getBoundingClientRect();\n  const centroid = centroidFromPointers(this.targetPointers);\n  centroid[0] -= viewportPosition.left;\n  centroid[1] -= viewportPosition.top;\n  this.anchor_ = map.getCoordinateFromPixel(centroid);\n\n  // scale, bypass the resolution constraint\n  map.render();\n  zoomWithoutConstraints(view, newResolution, this.anchor_);\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/PinchZoom}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (this.targetPointers.length < 2) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    view.setHint(ViewHint.INTERACTING, -1);\n    const resolution = view.getResolution();\n    if (this.constrainResolution_ ||\n        resolution < view.getMinResolution() ||\n        resolution > view.getMaxResolution()) {\n      // Zoom to final resolution, with an animation, and provide a\n      // direction not to zoom out/in if user was pinching in/out.\n      // Direction is > 0 if pinching out, and < 0 if pinching in.\n      const direction = this.lastScaleDelta_ - 1;\n      zoom(view, resolution, this.anchor_, this.duration_, direction);\n    }\n    return false;\n  } else {\n    return true;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/PinchZoom}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (this.targetPointers.length >= 2) {\n    const map = mapBrowserEvent.map;\n    this.anchor_ = null;\n    this.lastDistance_ = undefined;\n    this.lastScaleDelta_ = 1;\n    if (!this.handlingDownUpSequence) {\n      map.getView().setHint(ViewHint.INTERACTING, 1);\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nPinchZoom.prototype.shouldStopEvent = FALSE;\nexport default PinchZoom;\n","/**\n * @module ol/interaction/Pointer\n */\nimport {inherits} from '../index.js';\nimport {FALSE, UNDEFINED} from '../functions.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport Interaction from '../interaction/Interaction.js';\nimport {getValues} from '../obj.js';\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleDragEvent = UNDEFINED;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Capture dragging.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleUpEvent = FALSE;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Capture dragging.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleDownEvent = FALSE;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleMoveEvent = UNDEFINED;\n\n\n/**\n * @typedef {Object} Options\n * @property {(function(module:ol/MapBrowserPointerEvent):boolean)} [handleDownEvent]\n * Function handling \"down\" events. If the function returns `true` then a drag\n * sequence is started.\n * @property {(function(module:ol/MapBrowserPointerEvent))} [handleDragEvent]\n * Function handling \"drag\" events. This function is called on \"move\" events\n * during a drag sequence.\n * @property {(function(module:ol/MapBrowserEvent):boolean)} [handleEvent]\n * Method called by the map to notify the interaction that a browser event was\n * dispatched to the map. The function may return `false` to prevent the\n * propagation of the event to other interactions in the map's interactions\n * chain.\n * @property {(function(module:ol/MapBrowserPointerEvent))} [handleMoveEvent]\n * Function handling \"move\" events. This function is called on \"move\" events,\n * also during a drag sequence (so during a drag sequence both the\n * `handleDragEvent` function and this function are called).\n * @property {(function(module:ol/MapBrowserPointerEvent):boolean)} [handleUpEvent]\n *  Function handling \"up\" events. If the function returns `false` then the\n * current drag sequence is stopped.\n */\n\n\n/**\n * @classdesc\n * Base class that calls user-defined functions on `down`, `move` and `up`\n * events. This class also manages \"drag sequences\".\n *\n * When the `handleDownEvent` user function returns `true` a drag sequence is\n * started. During a drag sequence the `handleDragEvent` user function is\n * called on `move` events. The drag sequence ends when the `handleUpEvent`\n * user function is called and returns `false`.\n *\n * @constructor\n * @param {module:ol/interaction/Pointer~Options=} opt_options Options.\n * @extends {module:ol/interaction/Interaction}\n * @api\n */\nconst PointerInteraction = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  Interaction.call(this, {\n    handleEvent: options.handleEvent || handleEvent\n  });\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent):boolean}\n   * @private\n   */\n  this.handleDownEvent_ = options.handleDownEvent ?\n    options.handleDownEvent : handleDownEvent;\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent)}\n   * @private\n   */\n  this.handleDragEvent_ = options.handleDragEvent ?\n    options.handleDragEvent : handleDragEvent;\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent)}\n   * @private\n   */\n  this.handleMoveEvent_ = options.handleMoveEvent ?\n    options.handleMoveEvent : handleMoveEvent;\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent):boolean}\n   * @private\n   */\n  this.handleUpEvent_ = options.handleUpEvent ?\n    options.handleUpEvent : handleUpEvent;\n\n  /**\n   * @type {boolean}\n   * @protected\n   */\n  this.handlingDownUpSequence = false;\n\n  /**\n   * @type {!Object.<string, module:ol/pointer/PointerEvent>}\n   * @private\n   */\n  this.trackedPointers_ = {};\n\n  /**\n   * @type {Array.<module:ol/pointer/PointerEvent>}\n   * @protected\n   */\n  this.targetPointers = [];\n\n};\n\ninherits(PointerInteraction, Interaction);\n\n\n/**\n * @param {Array.<module:ol/pointer/PointerEvent>} pointerEvents List of events.\n * @return {module:ol~Pixel} Centroid pixel.\n */\nexport function centroid(pointerEvents) {\n  const length = pointerEvents.length;\n  let clientX = 0;\n  let clientY = 0;\n  for (let i = 0; i < length; i++) {\n    clientX += pointerEvents[i].clientX;\n    clientY += pointerEvents[i].clientY;\n  }\n  return [clientX / length, clientY / length];\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Whether the event is a pointerdown, pointerdrag\n *     or pointerup event.\n */\nfunction isPointerDraggingEvent(mapBrowserEvent) {\n  const type = mapBrowserEvent.type;\n  return type === MapBrowserEventType.POINTERDOWN ||\n    type === MapBrowserEventType.POINTERDRAG ||\n    type === MapBrowserEventType.POINTERUP;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @private\n */\nPointerInteraction.prototype.updateTrackedPointers_ = function(mapBrowserEvent) {\n  if (isPointerDraggingEvent(mapBrowserEvent)) {\n    const event = mapBrowserEvent.pointerEvent;\n\n    const id = event.pointerId.toString();\n    if (mapBrowserEvent.type == MapBrowserEventType.POINTERUP) {\n      delete this.trackedPointers_[id];\n    } else if (mapBrowserEvent.type ==\n        MapBrowserEventType.POINTERDOWN) {\n      this.trackedPointers_[id] = event;\n    } else if (id in this.trackedPointers_) {\n      // update only when there was a pointerdown event for this pointer\n      this.trackedPointers_[id] = event;\n    }\n    this.targetPointers = getValues(this.trackedPointers_);\n  }\n};\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may call into\n * other functions, if event sequences like e.g. 'drag' or 'down-up' etc. are\n * detected.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Pointer}\n * @api\n */\nexport function handleEvent(mapBrowserEvent) {\n  if (!(mapBrowserEvent instanceof MapBrowserPointerEvent)) {\n    return true;\n  }\n\n  let stopEvent = false;\n  this.updateTrackedPointers_(mapBrowserEvent);\n  if (this.handlingDownUpSequence) {\n    if (mapBrowserEvent.type == MapBrowserEventType.POINTERDRAG) {\n      this.handleDragEvent_(mapBrowserEvent);\n    } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERUP) {\n      const handledUp = this.handleUpEvent_(mapBrowserEvent);\n      this.handlingDownUpSequence = handledUp && this.targetPointers.length > 0;\n    }\n  } else {\n    if (mapBrowserEvent.type == MapBrowserEventType.POINTERDOWN) {\n      const handled = this.handleDownEvent_(mapBrowserEvent);\n      this.handlingDownUpSequence = handled;\n      stopEvent = this.shouldStopEvent(handled);\n    } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE) {\n      this.handleMoveEvent_(mapBrowserEvent);\n    }\n  }\n  return !stopEvent;\n}\n\n\n/**\n * This method is used to determine if \"down\" events should be propagated to\n * other interactions or should be stopped.\n *\n * The method receives the return code of the \"handleDownEvent\" function.\n *\n * By default this function is the \"identity\" function. It's overridden in\n * child classes.\n *\n * @param {boolean} handled Was the event handled by the interaction?\n * @return {boolean} Should the event be stopped?\n * @protected\n */\nPointerInteraction.prototype.shouldStopEvent = function(handled) {\n  return handled;\n};\n\nexport default PointerInteraction;\n","/**\n * @module ol/interaction/Property\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ACTIVE: 'active'\n};\n","/**\n * @module ol/interaction/Select\n */\nimport {getUid, inherits} from '../index.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {extend, includes} from '../array.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport {singleClick, never, shiftKeyOnly, pointerMove} from '../events/condition.js';\nimport {TRUE} from '../functions.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Interaction from '../interaction/Interaction.js';\nimport VectorLayer from '../layer/Vector.js';\nimport {clear} from '../obj.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @enum {string}\n */\nconst SelectEventType = {\n  /**\n   * Triggered when feature(s) has been (de)selected.\n   * @event SelectEvent#select\n   * @api\n   */\n  SELECT: 'select'\n};\n\n\n/**\n * A function that takes an {@link module:ol/Feature} or\n * {@link module:ol/render/Feature} and an\n * {@link module:ol/layer/Layer} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @typedef {function((module:ol/Feature|module:ol/render/Feature), module:ol/layer/Layer):\n *     boolean} FilterFunction\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [addCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition~never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is the event\n * for the selected features as a whole. By default, this is\n * {@link module:ol/events/condition~singleClick}. Clicking on a feature selects that\n * feature and removes any that were in the selection. Clicking outside any\n * feature removes all from the selection.\n * See `toggle`, `add`, `remove` options for adding/removing extra features to/\n * from the selection.\n * @property {Array.<module:ol/layer/Layer>|function(module:ol/layer/Layer): boolean} [layers]\n * A list of layers from which features should be selected. Alternatively, a\n * filter function can be provided. The function will be called for each layer\n * in the map and should return `true` for layers that you want to be\n * selectable. If the option is absent, all visible layers will be considered\n * selectable.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style]\n * Style for the selected features. By default the default edit style is used\n * (see {@link module:ol/style}).\n * @property {module:ol/events/condition~Condition} [removeCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition~never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {module:ol/events/condition~Condition} [toggleCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is in addition\n * to the `condition` event. By default,\n * {@link module:ol/events/condition~shiftKeyOnly}, i.e. pressing `shift` as\n * well as the `condition` event, adds that feature to the current selection if\n * it is not currently selected, and removes it if it is. See `add` and `remove`\n * if you want to use different events instead of a toggle.\n * @property {boolean} [multi=false] A boolean that determines if the default\n * behaviour should select only single features or all (overlapping) features at\n * the clicked map position. The default of `false` means single select.\n * @property {module:ol/Collection.<module:ol/Feature>} [features]\n * Collection where the interaction will place selected features. Optional. If\n * not set the interaction will create a collection. In any case the collection\n * used by the interaction is returned by\n * {@link module:ol/interaction/Select~Select#getFeatures}.\n * @property {module:ol/interaction/Select~FilterFunction} [filter] A function\n * that takes an {@link module:ol/Feature} and an\n * {@link module:ol/layer/Layer} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @property {boolean} [wrapX=true] Wrap the world horizontally on the selection\n * overlay.\n * @property {number} [hitTolerance=0] Hit-detection tolerance. Pixels inside\n * the radius around the given position will be checked for features. This only\n * works for the canvas renderer and not for WebGL.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Select~Select} instances are instances of\n * this type.\n *\n * @param {SelectEventType} type The event type.\n * @param {Array.<module:ol/Feature>} selected Selected features.\n * @param {Array.<module:ol/Feature>} deselected Deselected features.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Associated\n *     {@link module:ol/MapBrowserEvent}.\n * @extends {module:ol/events/Event}\n * @constructor\n */\nconst SelectEvent = function(type, selected, deselected, mapBrowserEvent) {\n  Event.call(this, type);\n\n  /**\n   * Selected features array.\n   * @type {Array.<module:ol/Feature>}\n   * @api\n   */\n  this.selected = selected;\n\n  /**\n   * Deselected features array.\n   * @type {Array.<module:ol/Feature>}\n   * @api\n   */\n  this.deselected = deselected;\n\n  /**\n   * Associated {@link module:ol/MapBrowserEvent}.\n   * @type {module:ol/MapBrowserEvent}\n   * @api\n   */\n  this.mapBrowserEvent = mapBrowserEvent;\n};\n\ninherits(SelectEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for selecting vector features. By default, selected features are\n * styled differently, so this interaction can be used for visual highlighting,\n * as well as selecting features for other actions, such as modification or\n * output. There are three ways of controlling which features are selected:\n * using the browser event as defined by the `condition` and optionally the\n * `toggle`, `add`/`remove`, and `multi` options; a `layers` filter; and a\n * further feature filter using the `filter` option.\n *\n * Selected features are added to an internal unmanaged layer.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/Select~Options=} opt_options Options.\n * @fires SelectEvent\n * @api\n */\nconst Select = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : singleClick;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.addCondition_ = options.addCondition ? options.addCondition : never;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.removeCondition_ = options.removeCondition ? options.removeCondition : never;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.toggleCondition_ = options.toggleCondition ? options.toggleCondition : shiftKeyOnly;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.multi_ = options.multi ? options.multi : false;\n\n  /**\n   * @private\n   * @type {module:ol/interaction/Select~FilterFunction}\n   */\n  this.filter_ = options.filter ? options.filter : TRUE;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.hitTolerance_ = options.hitTolerance ? options.hitTolerance : 0;\n\n  const featureOverlay = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      features: options.features,\n      wrapX: options.wrapX\n    }),\n    style: options.style ? options.style :\n      getDefaultStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  /**\n   * @private\n   * @type {module:ol/layer/Vector}\n   */\n  this.featureOverlay_ = featureOverlay;\n\n  /** @type {function(module:ol/layer/Layer): boolean} */\n  let layerFilter;\n  if (options.layers) {\n    if (typeof options.layers === 'function') {\n      layerFilter = options.layers;\n    } else {\n      const layers = options.layers;\n      layerFilter = function(layer) {\n        return includes(layers, layer);\n      };\n    }\n  } else {\n    layerFilter = TRUE;\n  }\n\n  /**\n   * @private\n   * @type {function(module:ol/layer/Layer): boolean}\n   */\n  this.layerFilter_ = layerFilter;\n\n  /**\n   * An association between selected feature (key)\n   * and layer (value)\n   * @private\n   * @type {Object.<number, module:ol/layer/Layer>}\n   */\n  this.featureLayerAssociation_ = {};\n\n  const features = this.featureOverlay_.getSource().getFeaturesCollection();\n  listen(features, CollectionEventType.ADD,\n    this.addFeature_, this);\n  listen(features, CollectionEventType.REMOVE,\n    this.removeFeature_, this);\n\n};\n\ninherits(Select, Interaction);\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {module:ol/layer/Layer} layer Layer.\n * @private\n */\nSelect.prototype.addFeatureLayerAssociation_ = function(feature, layer) {\n  const key = getUid(feature);\n  this.featureLayerAssociation_[key] = layer;\n};\n\n\n/**\n * Get the selected features.\n * @return {module:ol/Collection.<module:ol/Feature>} Features collection.\n * @api\n */\nSelect.prototype.getFeatures = function() {\n  return this.featureOverlay_.getSource().getFeaturesCollection();\n};\n\n\n/**\n * Returns the Hit-detection tolerance.\n * @returns {number} Hit tolerance in pixels.\n * @api\n */\nSelect.prototype.getHitTolerance = function() {\n  return this.hitTolerance_;\n};\n\n\n/**\n * Returns the associated {@link module:ol/layer/Vector~Vector vectorlayer} of\n * the (last) selected feature. Note that this will not work with any\n * programmatic method like pushing features to\n * {@link module:ol/interaction/Select~Select#getFeatures collection}.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature\n * @return {module:ol/layer/Vector} Layer.\n * @api\n */\nSelect.prototype.getLayer = function(feature) {\n  const key = getUid(feature);\n  return (\n    /** @type {module:ol/layer/Vector} */ (this.featureLayerAssociation_[key])\n  );\n};\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may change the\n * selected state of features.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Select}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!this.condition_(mapBrowserEvent)) {\n    return true;\n  }\n  const add = this.addCondition_(mapBrowserEvent);\n  const remove = this.removeCondition_(mapBrowserEvent);\n  const toggle = this.toggleCondition_(mapBrowserEvent);\n  const set = !add && !remove && !toggle;\n  const map = mapBrowserEvent.map;\n  const features = this.featureOverlay_.getSource().getFeaturesCollection();\n  const deselected = [];\n  const selected = [];\n  if (set) {\n    // Replace the currently selected feature(s) with the feature(s) at the\n    // pixel, or clear the selected feature(s) if there is no feature at\n    // the pixel.\n    clear(this.featureLayerAssociation_);\n    map.forEachFeatureAtPixel(mapBrowserEvent.pixel,\n      (\n        /**\n         * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n         * @param {module:ol/layer/Layer} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        function(feature, layer) {\n          if (this.filter_(feature, layer)) {\n            selected.push(feature);\n            this.addFeatureLayerAssociation_(feature, layer);\n            return !this.multi_;\n          }\n        }).bind(this), {\n        layerFilter: this.layerFilter_,\n        hitTolerance: this.hitTolerance_\n      });\n    for (let i = features.getLength() - 1; i >= 0; --i) {\n      const feature = features.item(i);\n      const index = selected.indexOf(feature);\n      if (index > -1) {\n        // feature is already selected\n        selected.splice(index, 1);\n      } else {\n        features.remove(feature);\n        deselected.push(feature);\n      }\n    }\n    if (selected.length !== 0) {\n      features.extend(selected);\n    }\n  } else {\n    // Modify the currently selected feature(s).\n    map.forEachFeatureAtPixel(mapBrowserEvent.pixel,\n      (\n        /**\n         * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n         * @param {module:ol/layer/Layer} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        function(feature, layer) {\n          if (this.filter_(feature, layer)) {\n            if ((add || toggle) && !includes(features.getArray(), feature)) {\n              selected.push(feature);\n              this.addFeatureLayerAssociation_(feature, layer);\n            } else if ((remove || toggle) && includes(features.getArray(), feature)) {\n              deselected.push(feature);\n              this.removeFeatureLayerAssociation_(feature);\n            }\n            return !this.multi_;\n          }\n        }).bind(this), {\n        layerFilter: this.layerFilter_,\n        hitTolerance: this.hitTolerance_\n      });\n    for (let j = deselected.length - 1; j >= 0; --j) {\n      features.remove(deselected[j]);\n    }\n    features.extend(selected);\n  }\n  if (selected.length > 0 || deselected.length > 0) {\n    this.dispatchEvent(\n      new SelectEvent(SelectEventType.SELECT,\n        selected, deselected, mapBrowserEvent));\n  }\n  return pointerMove(mapBrowserEvent);\n}\n\n\n/**\n * Hit-detection tolerance. Pixels inside the radius around the given position\n * will be checked for features. This only works for the canvas renderer and\n * not for WebGL.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @api\n */\nSelect.prototype.setHitTolerance = function(hitTolerance) {\n  this.hitTolerance_ = hitTolerance;\n};\n\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {module:ol/PluggableMap} map Map.\n * @override\n * @api\n */\nSelect.prototype.setMap = function(map) {\n  const currentMap = this.getMap();\n  const selectedFeatures =\n      this.featureOverlay_.getSource().getFeaturesCollection();\n  if (currentMap) {\n    selectedFeatures.forEach(currentMap.unskipFeature.bind(currentMap));\n  }\n  Interaction.prototype.setMap.call(this, map);\n  this.featureOverlay_.setMap(map);\n  if (map) {\n    selectedFeatures.forEach(map.skipFeature.bind(map));\n  }\n};\n\n\n/**\n * @return {module:ol/style/Style~StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const styles = createEditingStyle();\n  extend(styles[GeometryType.POLYGON], styles[GeometryType.LINE_STRING]);\n  extend(styles[GeometryType.GEOMETRY_COLLECTION], styles[GeometryType.LINE_STRING]);\n\n  return function(feature, resolution) {\n    if (!feature.getGeometry()) {\n      return null;\n    }\n    return styles[feature.getGeometry().getType()];\n  };\n}\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSelect.prototype.addFeature_ = function(evt) {\n  const map = this.getMap();\n  if (map) {\n    map.skipFeature(/** @type {module:ol/Feature} */ (evt.element));\n  }\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSelect.prototype.removeFeature_ = function(evt) {\n  const map = this.getMap();\n  if (map) {\n    map.unskipFeature(/** @type {module:ol/Feature} */ (evt.element));\n  }\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @private\n */\nSelect.prototype.removeFeatureLayerAssociation_ = function(feature) {\n  const key = getUid(feature);\n  delete this.featureLayerAssociation_[key];\n};\n\n\nexport default Select;\n","/**\n * @module ol/interaction/Snap\n */\nimport {getUid, inherits} from '../index.js';\nimport {CollectionEvent} from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {distance as coordinateDistance, squaredDistance as squaredCoordinateDistance, closestOnCircle, closestOnSegment, squaredDistanceToSegment} from '../coordinate.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {boundingExtent, createEmpty} from '../extent.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport {fromCircle} from '../geom/Polygon.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport {getValues} from '../obj.js';\nimport {VectorSourceEvent} from '../source/Vector.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\n\n\n/**\n * @typedef {Object} Result\n * @property {boolean} snapped\n * @property {module:ol/coordinate~Coordinate|null} vertex\n * @property {module:ol~Pixel|null} vertexPixel\n */\n\n\n/**\n * @typedef {Object} SegmentData\n * @property {module:ol/Feature} feature\n * @property {Array.<module:ol/coordinate~Coordinate>} segment\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/Collection.<module:ol/Feature>} [features] Snap to these features. Either this option or source should be provided.\n * @property {boolean} [edge=true] Snap to edges.\n * @property {boolean} [vertex=true] Snap to vertices.\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the pointer close enough to a segment or\n * vertex for snapping.\n * @property {module:ol/source/Vector} [source] Snap to features from this source. Either this option or features should be provided\n */\n\n\n/**\n * @classdesc\n * Handles snapping of vector features while modifying or drawing them.  The\n * features can come from a {@link module:ol/source/Vector} or {@link module:ol/Collection~Collection}\n * Any interaction object that allows the user to interact\n * with the features using the mouse can benefit from the snapping, as long\n * as it is added before.\n *\n * The snap interaction modifies map browser event `coordinate` and `pixel`\n * properties to force the snap to occur to any interaction that them.\n *\n * Example:\n *\n *     import Snap from 'ol/interaction/Snap';\n *\n *     var snap = new Snap({\n *       source: source\n *     });\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/Snap~Options=} opt_options Options.\n * @api\n */\nconst Snap = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleEvent: handleEvent,\n    handleDownEvent: TRUE,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/source/Vector}\n   * @private\n   */\n  this.source_ = options.source ? options.source : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.vertex_ = options.vertex !== undefined ? options.vertex : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.edge_ = options.edge !== undefined ? options.edge : true;\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = options.features ? options.features : null;\n\n  /**\n   * @type {Array.<module:ol/events~EventsKey>}\n   * @private\n   */\n  this.featuresListenerKeys_ = [];\n\n  /**\n   * @type {Object.<number, module:ol/events~EventsKey>}\n   * @private\n   */\n  this.featureChangeListenerKeys_ = {};\n\n  /**\n   * Extents are preserved so indexed segment can be quickly removed\n   * when its feature geometry changes\n   * @type {Object.<number, module:ol/extent~Extent>}\n   * @private\n   */\n  this.indexedFeaturesExtents_ = {};\n\n  /**\n   * If a feature geometry changes while a pointer drag|move event occurs, the\n   * feature doesn't get updated right away.  It will be at the next 'pointerup'\n   * event fired.\n   * @type {!Object.<number, module:ol/Feature>}\n   * @private\n   */\n  this.pendingFeatures_ = {};\n\n  /**\n   * Used for distance sorting in sortByDistance_\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.pixelCoordinate_ = null;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n    options.pixelTolerance : 10;\n\n  /**\n   * @type {function(module:ol/interaction/Snap~SegmentData, module:ol/interaction/Snap~SegmentData): number}\n   * @private\n   */\n  this.sortByDistance_ = sortByDistance.bind(this);\n\n\n  /**\n  * Segment RTree for each layer\n  * @type {module:ol/structs/RBush.<module:ol/interaction/Snap~SegmentData>}\n  * @private\n  */\n  this.rBush_ = new RBush();\n\n\n  /**\n  * @const\n  * @private\n  * @type {Object.<string, function(module:ol/Feature, module:ol/geom/Geometry)>}\n  */\n  this.SEGMENT_WRITERS_ = {\n    'Point': this.writePointGeometry_,\n    'LineString': this.writeLineStringGeometry_,\n    'LinearRing': this.writeLineStringGeometry_,\n    'Polygon': this.writePolygonGeometry_,\n    'MultiPoint': this.writeMultiPointGeometry_,\n    'MultiLineString': this.writeMultiLineStringGeometry_,\n    'MultiPolygon': this.writeMultiPolygonGeometry_,\n    'GeometryCollection': this.writeGeometryCollectionGeometry_,\n    'Circle': this.writeCircleGeometry_\n  };\n};\n\ninherits(Snap, PointerInteraction);\n\n\n/**\n * Add a feature to the collection of features that we may snap to.\n * @param {module:ol/Feature} feature Feature.\n * @param {boolean=} opt_listen Whether to listen to the feature change or not\n *     Defaults to `true`.\n * @api\n */\nSnap.prototype.addFeature = function(feature, opt_listen) {\n  const register = opt_listen !== undefined ? opt_listen : true;\n  const feature_uid = getUid(feature);\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    const segmentWriter = this.SEGMENT_WRITERS_[geometry.getType()];\n    if (segmentWriter) {\n      this.indexedFeaturesExtents_[feature_uid] = geometry.getExtent(createEmpty());\n      segmentWriter.call(this, feature, geometry);\n    }\n  }\n\n  if (register) {\n    this.featureChangeListenerKeys_[feature_uid] = listen(\n      feature,\n      EventType.CHANGE,\n      this.handleFeatureChange_, this);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nSnap.prototype.forEachFeatureAdd_ = function(feature) {\n  this.addFeature(feature);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nSnap.prototype.forEachFeatureRemove_ = function(feature) {\n  this.removeFeature(feature);\n};\n\n\n/**\n * @return {module:ol/Collection.<module:ol/Feature>|Array.<module:ol/Feature>} Features.\n * @private\n */\nSnap.prototype.getFeatures_ = function() {\n  let features;\n  if (this.features_) {\n    features = this.features_;\n  } else if (this.source_) {\n    features = this.source_.getFeatures();\n  }\n  return (\n    /** @type {!Array.<module:ol/Feature>|!module:ol/Collection.<module:ol/Feature>} */ (features)\n  );\n};\n\n\n/**\n * @param {module:ol/source/Vector|module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSnap.prototype.handleFeatureAdd_ = function(evt) {\n  let feature;\n  if (evt instanceof VectorSourceEvent) {\n    feature = evt.feature;\n  } else if (evt instanceof CollectionEvent) {\n    feature = evt.element;\n  }\n  this.addFeature(/** @type {module:ol/Feature} */ (feature));\n};\n\n\n/**\n * @param {module:ol/source/Vector|module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSnap.prototype.handleFeatureRemove_ = function(evt) {\n  let feature;\n  if (evt instanceof VectorSourceEvent) {\n    feature = evt.feature;\n  } else if (evt instanceof CollectionEvent) {\n    feature = evt.element;\n  }\n  this.removeFeature(/** @type {module:ol/Feature} */ (feature));\n};\n\n\n/**\n * @param {module:ol/events/Event} evt Event.\n * @private\n */\nSnap.prototype.handleFeatureChange_ = function(evt) {\n  const feature = /** @type {module:ol/Feature} */ (evt.target);\n  if (this.handlingDownUpSequence) {\n    const uid = getUid(feature);\n    if (!(uid in this.pendingFeatures_)) {\n      this.pendingFeatures_[uid] = feature;\n    }\n  } else {\n    this.updateFeature_(feature);\n  }\n};\n\n\n/**\n * Remove a feature from the collection of features that we may snap to.\n * @param {module:ol/Feature} feature Feature\n * @param {boolean=} opt_unlisten Whether to unlisten to the feature change\n *     or not. Defaults to `true`.\n * @api\n */\nSnap.prototype.removeFeature = function(feature, opt_unlisten) {\n  const unregister = opt_unlisten !== undefined ? opt_unlisten : true;\n  const feature_uid = getUid(feature);\n  const extent = this.indexedFeaturesExtents_[feature_uid];\n  if (extent) {\n    const rBush = this.rBush_;\n    const nodesToRemove = [];\n    rBush.forEachInExtent(extent, function(node) {\n      if (feature === node.feature) {\n        nodesToRemove.push(node);\n      }\n    });\n    for (let i = nodesToRemove.length - 1; i >= 0; --i) {\n      rBush.remove(nodesToRemove[i]);\n    }\n  }\n\n  if (unregister) {\n    unlistenByKey(this.featureChangeListenerKeys_[feature_uid]);\n    delete this.featureChangeListenerKeys_[feature_uid];\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nSnap.prototype.setMap = function(map) {\n  const currentMap = this.getMap();\n  const keys = this.featuresListenerKeys_;\n  const features = this.getFeatures_();\n\n  if (currentMap) {\n    keys.forEach(unlistenByKey);\n    keys.length = 0;\n    features.forEach(this.forEachFeatureRemove_.bind(this));\n  }\n  PointerInteraction.prototype.setMap.call(this, map);\n\n  if (map) {\n    if (this.features_) {\n      keys.push(\n        listen(this.features_, CollectionEventType.ADD,\n          this.handleFeatureAdd_, this),\n        listen(this.features_, CollectionEventType.REMOVE,\n          this.handleFeatureRemove_, this)\n      );\n    } else if (this.source_) {\n      keys.push(\n        listen(this.source_, VectorEventType.ADDFEATURE,\n          this.handleFeatureAdd_, this),\n        listen(this.source_, VectorEventType.REMOVEFEATURE,\n          this.handleFeatureRemove_, this)\n      );\n    }\n    features.forEach(this.forEachFeatureAdd_.bind(this));\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nSnap.prototype.shouldStopEvent = FALSE;\n\n\n/**\n * @param {module:ol~Pixel} pixel Pixel\n * @param {module:ol/coordinate~Coordinate} pixelCoordinate Coordinate\n * @param {module:ol/PluggableMap} map Map.\n * @return {module:ol/interaction/Snap~Result} Snap result\n */\nSnap.prototype.snapTo = function(pixel, pixelCoordinate, map) {\n\n  const lowerLeft = map.getCoordinateFromPixel(\n    [pixel[0] - this.pixelTolerance_, pixel[1] + this.pixelTolerance_]);\n  const upperRight = map.getCoordinateFromPixel(\n    [pixel[0] + this.pixelTolerance_, pixel[1] - this.pixelTolerance_]);\n  const box = boundingExtent([lowerLeft, upperRight]);\n\n  let segments = this.rBush_.getInExtent(box);\n\n  // If snapping on vertices only, don't consider circles\n  if (this.vertex_ && !this.edge_) {\n    segments = segments.filter(function(segment) {\n      return segment.feature.getGeometry().getType() !==\n          GeometryType.CIRCLE;\n    });\n  }\n\n  let snappedToVertex = false;\n  let snapped = false;\n  let vertex = null;\n  let vertexPixel = null;\n  let dist, pixel1, pixel2, squaredDist1, squaredDist2;\n  if (segments.length > 0) {\n    this.pixelCoordinate_ = pixelCoordinate;\n    segments.sort(this.sortByDistance_);\n    const closestSegment = segments[0].segment;\n    const isCircle = segments[0].feature.getGeometry().getType() ===\n        GeometryType.CIRCLE;\n    if (this.vertex_ && !this.edge_) {\n      pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n      pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n      squaredDist1 = squaredCoordinateDistance(pixel, pixel1);\n      squaredDist2 = squaredCoordinateDistance(pixel, pixel2);\n      dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n      snappedToVertex = dist <= this.pixelTolerance_;\n      if (snappedToVertex) {\n        snapped = true;\n        vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n        vertexPixel = map.getPixelFromCoordinate(vertex);\n      }\n    } else if (this.edge_) {\n      if (isCircle) {\n        vertex = closestOnCircle(pixelCoordinate,\n          /** @type {module:ol/geom/Circle} */ (segments[0].feature.getGeometry()));\n      } else {\n        vertex = closestOnSegment(pixelCoordinate, closestSegment);\n      }\n      vertexPixel = map.getPixelFromCoordinate(vertex);\n      if (coordinateDistance(pixel, vertexPixel) <= this.pixelTolerance_) {\n        snapped = true;\n        if (this.vertex_ && !isCircle) {\n          pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n          pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n          squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n          squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n          dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n          snappedToVertex = dist <= this.pixelTolerance_;\n          if (snappedToVertex) {\n            vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n            vertexPixel = map.getPixelFromCoordinate(vertex);\n          }\n        }\n      }\n    }\n    if (snapped) {\n      vertexPixel = [Math.round(vertexPixel[0]), Math.round(vertexPixel[1])];\n    }\n  }\n  return (\n    /** @type {module:ol/interaction/Snap~Result} */ ({\n      snapped: snapped,\n      vertex: vertex,\n      vertexPixel: vertexPixel\n    })\n  );\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @private\n */\nSnap.prototype.updateFeature_ = function(feature) {\n  this.removeFeature(feature, false);\n  this.addFeature(feature, false);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Circle} geometry Geometry.\n * @private\n */\nSnap.prototype.writeCircleGeometry_ = function(feature, geometry) {\n  const polygon = fromCircle(geometry);\n  const coordinates = polygon.getCoordinates()[0];\n  for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n    const segment = coordinates.slice(i, i + 2);\n    const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n      feature: feature,\n      segment: segment\n    });\n    this.rBush_.insert(boundingExtent(segment), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @private\n */\nSnap.prototype.writeGeometryCollectionGeometry_ = function(feature, geometry) {\n  const geometries = geometry.getGeometriesArray();\n  for (let i = 0; i < geometries.length; ++i) {\n    const segmentWriter = this.SEGMENT_WRITERS_[geometries[i].getType()];\n    if (segmentWriter) {\n      segmentWriter.call(this, feature, geometries[i]);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/LineString} geometry Geometry.\n * @private\n */\nSnap.prototype.writeLineStringGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n    const segment = coordinates.slice(i, i + 2);\n    const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n      feature: feature,\n      segment: segment\n    });\n    this.rBush_.insert(boundingExtent(segment), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiLineString} geometry Geometry.\n * @private\n */\nSnap.prototype.writeMultiLineStringGeometry_ = function(feature, geometry) {\n  const lines = geometry.getCoordinates();\n  for (let j = 0, jj = lines.length; j < jj; ++j) {\n    const coordinates = lines[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n        feature: feature,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPoint} geometry Geometry.\n * @private\n */\nSnap.prototype.writeMultiPointGeometry_ = function(feature, geometry) {\n  const points = geometry.getCoordinates();\n  for (let i = 0, ii = points.length; i < ii; ++i) {\n    const coordinates = points[i];\n    const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n      feature: feature,\n      segment: [coordinates, coordinates]\n    });\n    this.rBush_.insert(geometry.getExtent(), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @private\n */\nSnap.prototype.writeMultiPolygonGeometry_ = function(feature, geometry) {\n  const polygons = geometry.getCoordinates();\n  for (let k = 0, kk = polygons.length; k < kk; ++k) {\n    const rings = polygons[k];\n    for (let j = 0, jj = rings.length; j < jj; ++j) {\n      const coordinates = rings[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n        const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n          feature: feature,\n          segment: segment\n        });\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Point} geometry Geometry.\n * @private\n */\nSnap.prototype.writePointGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n    feature: feature,\n    segment: [coordinates, coordinates]\n  });\n  this.rBush_.insert(geometry.getExtent(), segmentData);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Polygon} geometry Geometry.\n * @private\n */\nSnap.prototype.writePolygonGeometry_ = function(feature, geometry) {\n  const rings = geometry.getCoordinates();\n  for (let j = 0, jj = rings.length; j < jj; ++j) {\n    const coordinates = rings[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n        feature: feature,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * Handle all pointer events events.\n * @param {module:ol/MapBrowserEvent} evt A move event.\n * @return {boolean} Pass the event to other interactions.\n * @this {module:ol/interaction/Snap}\n */\nexport function handleEvent(evt) {\n  const result = this.snapTo(evt.pixel, evt.coordinate, evt.map);\n  if (result.snapped) {\n    evt.coordinate = result.vertex.slice(0, 2);\n    evt.pixel = result.vertexPixel;\n  }\n  return handlePointerEvent.call(this, evt);\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Snap}\n */\nfunction handleUpEvent(evt) {\n  const featuresToUpdate = getValues(this.pendingFeatures_);\n  if (featuresToUpdate.length) {\n    featuresToUpdate.forEach(this.updateFeature_.bind(this));\n    this.pendingFeatures_ = {};\n  }\n  return false;\n}\n\n\n/**\n * Sort segments by distance, helper function\n * @param {module:ol/interaction/Snap~SegmentData} a The first segment data.\n * @param {module:ol/interaction/Snap~SegmentData} b The second segment data.\n * @return {number} The difference in distance.\n * @this {module:ol/interaction/Snap}\n */\nfunction sortByDistance(a, b) {\n  const deltaA = squaredDistanceToSegment(this.pixelCoordinate_, a.segment);\n  const deltaB = squaredDistanceToSegment(this.pixelCoordinate_, b.segment);\n  return deltaA - deltaB;\n}\n\nexport default Snap;\n","/**\n * @module ol/interaction/Translate\n */\nimport {inherits} from '../index.js';\nimport Collection from '../Collection.js';\nimport {getChangeEventType} from '../Object.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport {TRUE} from '../functions.js';\nimport {includes} from '../array.js';\nimport PointerInteraction from '../interaction/Pointer.js';\nimport InteractionProperty from '../interaction/Property.js';\n\n\n/**\n * @enum {string}\n */\nconst TranslateEventType = {\n  /**\n   * Triggered upon feature translation start.\n   * @event TranslateEvent#translatestart\n   * @api\n   */\n  TRANSLATESTART: 'translatestart',\n  /**\n   * Triggered upon feature translation.\n   * @event TranslateEvent#translating\n   * @api\n   */\n  TRANSLATING: 'translating',\n  /**\n   * Triggered upon feature translation end.\n   * @event TranslateEvent#translateend\n   * @api\n   */\n  TRANSLATEEND: 'translateend'\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/Collection.<module:ol/Feature>} [features] Only features contained in this collection will be able to be translated. If\n * not specified, all features on the map will be able to be translated.\n * @property {Array.<module:ol/layer/Layer>|function(module:ol/layer/Layer): boolean} [layers] A list of layers from which features should be\n * translated. Alternatively, a filter function can be provided. The\n * function will be called for each layer in the map and should return\n * `true` for layers that you want to be translatable. If the option is\n * absent, all visible layers will be considered translatable.\n * @property {number} [hitTolerance=0] Hit-detection tolerance. Pixels inside the radius around the given position\n * will be checked for features. This only works for the canvas renderer and\n * not for WebGL.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Translate~Translate} instances\n * are instances of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/interaction/Translate~TranslateEventType} type Type.\n * @param {module:ol/Collection.<module:ol/Feature>} features The features translated.\n * @param {module:ol/coordinate~Coordinate} coordinate The event coordinate.\n */\nexport const TranslateEvent = function(type, features, coordinate) {\n\n  Event.call(this, type);\n\n  /**\n   * The features being translated.\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @api\n   */\n  this.features = features;\n\n  /**\n   * The coordinate of the drag event.\n   * @const\n   * @type {module:ol/coordinate~Coordinate}\n   * @api\n   */\n  this.coordinate = coordinate;\n};\n\ninherits(TranslateEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for translating (moving) features.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/Translate~TranslateEvent\n * @param {module:ol/interaction/Translate~Options=} opt_options Options.\n * @api\n */\nconst Translate = function(opt_options) {\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleMoveEvent: handleMoveEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * The last position we translated to.\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.lastCoordinate_ = null;\n\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = options.features !== undefined ? options.features : null;\n\n  /** @type {function(module:ol/layer/Layer): boolean} */\n  let layerFilter;\n  if (options.layers) {\n    if (typeof options.layers === 'function') {\n      layerFilter = options.layers;\n    } else {\n      const layers = options.layers;\n      layerFilter = function(layer) {\n        return includes(layers, layer);\n      };\n    }\n  } else {\n    layerFilter = TRUE;\n  }\n\n  /**\n   * @private\n   * @type {function(module:ol/layer/Layer): boolean}\n   */\n  this.layerFilter_ = layerFilter;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.hitTolerance_ = options.hitTolerance ? options.hitTolerance : 0;\n\n  /**\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.lastFeature_ = null;\n\n  listen(this,\n    getChangeEventType(InteractionProperty.ACTIVE),\n    this.handleActiveChanged_, this);\n\n};\n\ninherits(Translate, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/Translate}\n */\nfunction handleDownEvent(event) {\n  this.lastFeature_ = this.featuresAtPixel_(event.pixel, event.map);\n  if (!this.lastCoordinate_ && this.lastFeature_) {\n    this.lastCoordinate_ = event.coordinate;\n    handleMoveEvent.call(this, event);\n\n    const features = this.features_ || new Collection([this.lastFeature_]);\n\n    this.dispatchEvent(\n      new TranslateEvent(\n        TranslateEventType.TRANSLATESTART, features,\n        event.coordinate));\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Translate}\n */\nfunction handleUpEvent(event) {\n  if (this.lastCoordinate_) {\n    this.lastCoordinate_ = null;\n    handleMoveEvent.call(this, event);\n\n    const features = this.features_ || new Collection([this.lastFeature_]);\n\n    this.dispatchEvent(\n      new TranslateEvent(\n        TranslateEventType.TRANSLATEEND, features,\n        event.coordinate));\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @this {module:ol/interaction/Translate}\n */\nfunction handleDragEvent(event) {\n  if (this.lastCoordinate_) {\n    const newCoordinate = event.coordinate;\n    const deltaX = newCoordinate[0] - this.lastCoordinate_[0];\n    const deltaY = newCoordinate[1] - this.lastCoordinate_[1];\n\n    const features = this.features_ || new Collection([this.lastFeature_]);\n\n    features.forEach(function(feature) {\n      const geom = feature.getGeometry();\n      geom.translate(deltaX, deltaY);\n      feature.setGeometry(geom);\n    });\n\n    this.lastCoordinate_ = newCoordinate;\n    this.dispatchEvent(\n      new TranslateEvent(\n        TranslateEventType.TRANSLATING, features,\n        newCoordinate));\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserEvent} event Event.\n * @this {module:ol/interaction/Translate}\n */\nfunction handleMoveEvent(event) {\n  const elem = event.map.getViewport();\n\n  // Change the cursor to grab/grabbing if hovering any of the features managed\n  // by the interaction\n  if (this.featuresAtPixel_(event.pixel, event.map)) {\n    elem.classList.remove(this.lastCoordinate_ ? 'ol-grab' : 'ol-grabbing');\n    elem.classList.add(this.lastCoordinate_ ? 'ol-grabbing' : 'ol-grab');\n  } else {\n    elem.classList.remove('ol-grab', 'ol-grabbing');\n  }\n}\n\n\n/**\n * Tests to see if the given coordinates intersects any of our selected\n * features.\n * @param {module:ol~Pixel} pixel Pixel coordinate to test for intersection.\n * @param {module:ol/PluggableMap} map Map to test the intersection on.\n * @return {module:ol/Feature} Returns the feature found at the specified pixel\n * coordinates.\n * @private\n */\nTranslate.prototype.featuresAtPixel_ = function(pixel, map) {\n  return map.forEachFeatureAtPixel(pixel,\n    function(feature) {\n      if (!this.features_ || includes(this.features_.getArray(), feature)) {\n        return feature;\n      }\n    }.bind(this), {\n      layerFilter: this.layerFilter_,\n      hitTolerance: this.hitTolerance_\n    });\n};\n\n\n/**\n * Returns the Hit-detection tolerance.\n * @returns {number} Hit tolerance in pixels.\n * @api\n */\nTranslate.prototype.getHitTolerance = function() {\n  return this.hitTolerance_;\n};\n\n\n/**\n * Hit-detection tolerance. Pixels inside the radius around the given position\n * will be checked for features. This only works for the canvas renderer and\n * not for WebGL.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @api\n */\nTranslate.prototype.setHitTolerance = function(hitTolerance) {\n  this.hitTolerance_ = hitTolerance;\n};\n\n\n/**\n * @inheritDoc\n */\nTranslate.prototype.setMap = function(map) {\n  const oldMap = this.getMap();\n  PointerInteraction.prototype.setMap.call(this, map);\n  this.updateState_(oldMap);\n};\n\n\n/**\n * @private\n */\nTranslate.prototype.handleActiveChanged_ = function() {\n  this.updateState_(null);\n};\n\n\n/**\n * @param {module:ol/PluggableMap} oldMap Old map.\n * @private\n */\nTranslate.prototype.updateState_ = function(oldMap) {\n  let map = this.getMap();\n  const active = this.getActive();\n  if (!map || !active) {\n    map = map || oldMap;\n    if (map) {\n      const elem = map.getViewport();\n      elem.classList.remove('ol-grab', 'ol-grabbing');\n    }\n  }\n};\n\n\nexport default Translate;\n","/**\n * @module ol/layer/Base\n */\nimport {inherits} from '../index.js';\nimport BaseObject from '../Object.js';\nimport LayerProperty from '../layer/Property.js';\nimport {clamp} from '../math.js';\nimport {assign} from '../obj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Note that with {@link module:ol/layer/Base} and all its subclasses, any property set in\n * the options is set as a {@link module:ol/Object} property on the layer object, so\n * is observable, and has get/set accessors.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/Object}\n * @param {module:ol/layer/Base~Options} options Layer options.\n * @api\n */\nconst BaseLayer = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @type {Object.<string, *>}\n   */\n  const properties = assign({}, options);\n  properties[LayerProperty.OPACITY] =\n      options.opacity !== undefined ? options.opacity : 1;\n  properties[LayerProperty.VISIBLE] =\n      options.visible !== undefined ? options.visible : true;\n  properties[LayerProperty.Z_INDEX] =\n      options.zIndex !== undefined ? options.zIndex : 0;\n  properties[LayerProperty.MAX_RESOLUTION] =\n      options.maxResolution !== undefined ? options.maxResolution : Infinity;\n  properties[LayerProperty.MIN_RESOLUTION] =\n      options.minResolution !== undefined ? options.minResolution : 0;\n\n  this.setProperties(properties);\n\n  /**\n   * @type {module:ol/layer/Layer~State}\n   * @private\n   */\n  this.state_ = /** @type {module:ol/layer/Layer~State} */ ({\n    layer: /** @type {module:ol/layer/Layer} */ (this),\n    managed: true\n  });\n\n  /**\n   * The layer type.\n   * @type {module:ol/LayerType}\n   * @protected;\n   */\n  this.type;\n\n};\n\ninherits(BaseLayer, BaseObject);\n\n\n/**\n * Get the layer type (used when creating a layer renderer).\n * @return {module:ol/LayerType} The layer type.\n */\nBaseLayer.prototype.getType = function() {\n  return this.type;\n};\n\n\n/**\n * @return {module:ol/layer/Layer~State} Layer state.\n */\nBaseLayer.prototype.getLayerState = function() {\n  this.state_.opacity = clamp(this.getOpacity(), 0, 1);\n  this.state_.sourceState = this.getSourceState();\n  this.state_.visible = this.getVisible();\n  this.state_.extent = this.getExtent();\n  this.state_.zIndex = this.getZIndex();\n  this.state_.maxResolution = this.getMaxResolution();\n  this.state_.minResolution = Math.max(this.getMinResolution(), 0);\n\n  return this.state_;\n};\n\n\n/**\n * @abstract\n * @param {Array.<module:ol/layer/Layer>=} opt_array Array of layers (to be\n *     modified in place).\n * @return {Array.<module:ol/layer/Layer>} Array of layers.\n */\nBaseLayer.prototype.getLayersArray = function(opt_array) {};\n\n\n/**\n * @abstract\n * @param {Array.<module:ol/layer/Layer~State>=} opt_states Optional list of layer\n *     states (to be modified in place).\n * @return {Array.<module:ol/layer/Layer~State>} List of layer states.\n */\nBaseLayer.prototype.getLayerStatesArray = function(opt_states) {};\n\n\n/**\n * Return the {@link module:ol/extent~Extent extent} of the layer or `undefined` if it\n * will be visible regardless of extent.\n * @return {module:ol/extent~Extent|undefined} The layer extent.\n * @observable\n * @api\n */\nBaseLayer.prototype.getExtent = function() {\n  return (\n    /** @type {module:ol/extent~Extent|undefined} */ (this.get(LayerProperty.EXTENT))\n  );\n};\n\n\n/**\n * Return the maximum resolution of the layer.\n * @return {number} The maximum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getMaxResolution = function() {\n  return /** @type {number} */ (this.get(LayerProperty.MAX_RESOLUTION));\n};\n\n\n/**\n * Return the minimum resolution of the layer.\n * @return {number} The minimum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getMinResolution = function() {\n  return /** @type {number} */ (this.get(LayerProperty.MIN_RESOLUTION));\n};\n\n\n/**\n * Return the opacity of the layer (between 0 and 1).\n * @return {number} The opacity of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getOpacity = function() {\n  return /** @type {number} */ (this.get(LayerProperty.OPACITY));\n};\n\n\n/**\n * @abstract\n * @return {module:ol/source/State} Source state.\n */\nBaseLayer.prototype.getSourceState = function() {};\n\n\n/**\n * Return the visibility of the layer (`true` or `false`).\n * @return {boolean} The visibility of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getVisible = function() {\n  return /** @type {boolean} */ (this.get(LayerProperty.VISIBLE));\n};\n\n\n/**\n * Return the Z-index of the layer, which is used to order layers before\n * rendering. The default Z-index is 0.\n * @return {number} The Z-index of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getZIndex = function() {\n  return /** @type {number} */ (this.get(LayerProperty.Z_INDEX));\n};\n\n\n/**\n * Set the extent at which the layer is visible.  If `undefined`, the layer\n * will be visible at all extents.\n * @param {module:ol/extent~Extent|undefined} extent The extent of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setExtent = function(extent) {\n  this.set(LayerProperty.EXTENT, extent);\n};\n\n\n/**\n * Set the maximum resolution at which the layer is visible.\n * @param {number} maxResolution The maximum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setMaxResolution = function(maxResolution) {\n  this.set(LayerProperty.MAX_RESOLUTION, maxResolution);\n};\n\n\n/**\n * Set the minimum resolution at which the layer is visible.\n * @param {number} minResolution The minimum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setMinResolution = function(minResolution) {\n  this.set(LayerProperty.MIN_RESOLUTION, minResolution);\n};\n\n\n/**\n * Set the opacity of the layer, allowed values range from 0 to 1.\n * @param {number} opacity The opacity of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setOpacity = function(opacity) {\n  this.set(LayerProperty.OPACITY, opacity);\n};\n\n\n/**\n * Set the visibility of the layer (`true` or `false`).\n * @param {boolean} visible The visibility of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setVisible = function(visible) {\n  this.set(LayerProperty.VISIBLE, visible);\n};\n\n\n/**\n * Set Z-index of the layer, which is used to order layers before rendering.\n * The default Z-index is 0.\n * @param {number} zindex The z-index of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setZIndex = function(zindex) {\n  this.set(LayerProperty.Z_INDEX, zindex);\n};\nexport default BaseLayer;\n","/**\n * @module ol/layer/Group\n */\nimport {getUid, inherits} from '../index.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {getChangeEventType} from '../Object.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport {assert} from '../asserts.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getIntersection} from '../extent.js';\nimport BaseLayer from '../layer/Base.js';\nimport {assign, clear} from '../obj.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {(Array.<module:ol/layer/Base>|module:ol/Collection.<module:ol/layer/Base>)} [layers] Child layers.\n */\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LAYERS: 'layers'\n};\n\n\n/**\n * @classdesc\n * A {@link module:ol/Collection~Collection} of layers that are handled together.\n *\n * A generic `change` event is triggered when the group/Collection changes.\n *\n * @constructor\n * @extends {module:ol/layer/Base}\n * @param {module:ol/layer/Group~Options=} opt_options Layer options.\n * @api\n */\nconst LayerGroup = function(opt_options) {\n\n  const options = opt_options || {};\n  const baseOptions = /** @type {module:ol/layer/Group~Options} */ (assign({}, options));\n  delete baseOptions.layers;\n\n  let layers = options.layers;\n\n  BaseLayer.call(this, baseOptions);\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.layersListenerKeys_ = [];\n\n  /**\n   * @private\n   * @type {Object.<string, Array.<module:ol/events~EventsKey>>}\n   */\n  this.listenerKeys_ = {};\n\n  listen(this,\n    getChangeEventType(Property.LAYERS),\n    this.handleLayersChanged_, this);\n\n  if (layers) {\n    if (Array.isArray(layers)) {\n      layers = new Collection(layers.slice(), {unique: true});\n    } else {\n      assert(layers instanceof Collection,\n        43); // Expected `layers` to be an array or a `Collection`\n      layers = layers;\n    }\n  } else {\n    layers = new Collection(undefined, {unique: true});\n  }\n\n  this.setLayers(layers);\n\n};\n\ninherits(LayerGroup, BaseLayer);\n\n\n/**\n * @private\n */\nLayerGroup.prototype.handleLayerChange_ = function() {\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @private\n */\nLayerGroup.prototype.handleLayersChanged_ = function(event) {\n  this.layersListenerKeys_.forEach(unlistenByKey);\n  this.layersListenerKeys_.length = 0;\n\n  const layers = this.getLayers();\n  this.layersListenerKeys_.push(\n    listen(layers, CollectionEventType.ADD, this.handleLayersAdd_, this),\n    listen(layers, CollectionEventType.REMOVE, this.handleLayersRemove_, this)\n  );\n\n  for (const id in this.listenerKeys_) {\n    this.listenerKeys_[id].forEach(unlistenByKey);\n  }\n  clear(this.listenerKeys_);\n\n  const layersArray = layers.getArray();\n  for (let i = 0, ii = layersArray.length; i < ii; i++) {\n    const layer = layersArray[i];\n    this.listenerKeys_[getUid(layer).toString()] = [\n      listen(layer, ObjectEventType.PROPERTYCHANGE, this.handleLayerChange_, this),\n      listen(layer, EventType.CHANGE, this.handleLayerChange_, this)\n    ];\n  }\n\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} collectionEvent CollectionEvent.\n * @private\n */\nLayerGroup.prototype.handleLayersAdd_ = function(collectionEvent) {\n  const layer = /** @type {module:ol/layer/Base} */ (collectionEvent.element);\n  const key = getUid(layer).toString();\n  this.listenerKeys_[key] = [\n    listen(layer, ObjectEventType.PROPERTYCHANGE, this.handleLayerChange_, this),\n    listen(layer, EventType.CHANGE, this.handleLayerChange_, this)\n  ];\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} collectionEvent CollectionEvent.\n * @private\n */\nLayerGroup.prototype.handleLayersRemove_ = function(collectionEvent) {\n  const layer = /** @type {module:ol/layer/Base} */ (collectionEvent.element);\n  const key = getUid(layer).toString();\n  this.listenerKeys_[key].forEach(unlistenByKey);\n  delete this.listenerKeys_[key];\n  this.changed();\n};\n\n\n/**\n * Returns the {@link module:ol/Collection collection} of {@link module:ol/layer/Layer~Layer layers}\n * in this group.\n * @return {!module:ol/Collection.<module:ol/layer/Base>} Collection of\n *   {@link module:ol/layer/Base layers} that are part of this group.\n * @observable\n * @api\n */\nLayerGroup.prototype.getLayers = function() {\n  return (\n    /** @type {!module:ol/Collection.<module:ol/layer/Base>} */ (this.get(Property.LAYERS))\n  );\n};\n\n\n/**\n * Set the {@link module:ol/Collection collection} of {@link module:ol/layer/Layer~Layer layers}\n * in this group.\n * @param {!module:ol/Collection.<module:ol/layer/Base>} layers Collection of\n *   {@link module:ol/layer/Base layers} that are part of this group.\n * @observable\n * @api\n */\nLayerGroup.prototype.setLayers = function(layers) {\n  this.set(Property.LAYERS, layers);\n};\n\n\n/**\n * @inheritDoc\n */\nLayerGroup.prototype.getLayersArray = function(opt_array) {\n  const array = opt_array !== undefined ? opt_array : [];\n  this.getLayers().forEach(function(layer) {\n    layer.getLayersArray(array);\n  });\n  return array;\n};\n\n\n/**\n * @inheritDoc\n */\nLayerGroup.prototype.getLayerStatesArray = function(opt_states) {\n  const states = opt_states !== undefined ? opt_states : [];\n\n  const pos = states.length;\n\n  this.getLayers().forEach(function(layer) {\n    layer.getLayerStatesArray(states);\n  });\n\n  const ownLayerState = this.getLayerState();\n  for (let i = pos, ii = states.length; i < ii; i++) {\n    const layerState = states[i];\n    layerState.opacity *= ownLayerState.opacity;\n    layerState.visible = layerState.visible && ownLayerState.visible;\n    layerState.maxResolution = Math.min(\n      layerState.maxResolution, ownLayerState.maxResolution);\n    layerState.minResolution = Math.max(\n      layerState.minResolution, ownLayerState.minResolution);\n    if (ownLayerState.extent !== undefined) {\n      if (layerState.extent !== undefined) {\n        layerState.extent = getIntersection(layerState.extent, ownLayerState.extent);\n      } else {\n        layerState.extent = ownLayerState.extent;\n      }\n    }\n  }\n\n  return states;\n};\n\n\n/**\n * @inheritDoc\n */\nLayerGroup.prototype.getSourceState = function() {\n  return SourceState.READY;\n};\n\nexport default LayerGroup;\n","/**\n * @module ol/layer/Layer\n */\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getUid, inherits} from '../index.js';\nimport {getChangeEventType} from '../Object.js';\nimport BaseLayer from '../layer/Base.js';\nimport LayerProperty from '../layer/Property.js';\nimport {assign} from '../obj.js';\nimport RenderEventType from '../render/EventType.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {module:ol/source/Source} [source] Source for this layer.  If not provided to the constructor,\n * the source can be set by calling {@link module:ol/layer/Layer#setSource layer.setSource(source)} after\n * construction.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {module:ol/layer/Layer} layer\n * @property {number} opacity\n * @property {module:ol/source/Source~State} sourceState\n * @property {boolean} visible\n * @property {boolean} managed\n * @property {module:ol/extent~Extent} [extent]\n * @property {number} zIndex\n * @property {number} maxResolution\n * @property {number} minResolution\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * A visual representation of raster or vector map data.\n * Layers group together those properties that pertain to how the data is to be\n * displayed, irrespective of the source of that data.\n *\n * Layers are usually added to a map with {@link module:ol/Map#addLayer}. Components\n * like {@link module:ol/interaction/Select~Select} use unmanaged layers\n * internally. These unmanaged layers are associated with the map using\n * {@link module:ol/layer/Layer~Layer#setMap} instead.\n *\n * A generic `change` event is fired when the state of the source changes.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/layer/Base}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Layer~Options} options Layer options.\n * @api\n */\nconst Layer = function(options) {\n\n  const baseOptions = assign({}, options);\n  delete baseOptions.source;\n\n  BaseLayer.call(this, /** @type {module:ol/layer/Base~Options} */ (baseOptions));\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.mapPrecomposeKey_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.mapRenderKey_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.sourceChangeKey_ = null;\n\n  if (options.map) {\n    this.setMap(options.map);\n  }\n\n  listen(this,\n    getChangeEventType(LayerProperty.SOURCE),\n    this.handleSourcePropertyChange_, this);\n\n  const source = options.source ? options.source : null;\n  this.setSource(source);\n};\n\ninherits(Layer, BaseLayer);\n\n\n/**\n * Return `true` if the layer is visible, and if the passed resolution is\n * between the layer's minResolution and maxResolution. The comparison is\n * inclusive for `minResolution` and exclusive for `maxResolution`.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {number} resolution Resolution.\n * @return {boolean} The layer is visible at the given resolution.\n */\nexport function visibleAtResolution(layerState, resolution) {\n  return layerState.visible && resolution >= layerState.minResolution &&\n      resolution < layerState.maxResolution;\n}\n\n\n/**\n * @inheritDoc\n */\nLayer.prototype.getLayersArray = function(opt_array) {\n  const array = opt_array ? opt_array : [];\n  array.push(this);\n  return array;\n};\n\n\n/**\n * @inheritDoc\n */\nLayer.prototype.getLayerStatesArray = function(opt_states) {\n  const states = opt_states ? opt_states : [];\n  states.push(this.getLayerState());\n  return states;\n};\n\n\n/**\n * Get the layer source.\n * @return {module:ol/source/Source} The layer source (or `null` if not yet set).\n * @observable\n * @api\n */\nLayer.prototype.getSource = function() {\n  const source = this.get(LayerProperty.SOURCE);\n  return (\n    /** @type {module:ol/source/Source} */ (source) || null\n  );\n};\n\n\n/**\n  * @inheritDoc\n  */\nLayer.prototype.getSourceState = function() {\n  const source = this.getSource();\n  return !source ? SourceState.UNDEFINED : source.getState();\n};\n\n\n/**\n * @private\n */\nLayer.prototype.handleSourceChange_ = function() {\n  this.changed();\n};\n\n\n/**\n * @private\n */\nLayer.prototype.handleSourcePropertyChange_ = function() {\n  if (this.sourceChangeKey_) {\n    unlistenByKey(this.sourceChangeKey_);\n    this.sourceChangeKey_ = null;\n  }\n  const source = this.getSource();\n  if (source) {\n    this.sourceChangeKey_ = listen(source,\n      EventType.CHANGE, this.handleSourceChange_, this);\n  }\n  this.changed();\n};\n\n\n/**\n * Sets the layer to be rendered on top of other layers on a map. The map will\n * not manage this layer in its layers collection, and the callback in\n * {@link module:ol/Map#forEachLayerAtPixel} will receive `null` as layer. This\n * is useful for temporary layers. To remove an unmanaged layer from the map,\n * use `#setMap(null)`.\n *\n * To add the layer to a map and have it managed by the map, use\n * {@link module:ol/Map#addLayer} instead.\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nLayer.prototype.setMap = function(map) {\n  if (this.mapPrecomposeKey_) {\n    unlistenByKey(this.mapPrecomposeKey_);\n    this.mapPrecomposeKey_ = null;\n  }\n  if (!map) {\n    this.changed();\n  }\n  if (this.mapRenderKey_) {\n    unlistenByKey(this.mapRenderKey_);\n    this.mapRenderKey_ = null;\n  }\n  if (map) {\n    this.mapPrecomposeKey_ = listen(map, RenderEventType.PRECOMPOSE, function(evt) {\n      const layerState = this.getLayerState();\n      layerState.managed = false;\n      layerState.zIndex = Infinity;\n      evt.frameState.layerStatesArray.push(layerState);\n      evt.frameState.layerStates[getUid(this)] = layerState;\n    }, this);\n    this.mapRenderKey_ = listen(this, EventType.CHANGE, map.render, map);\n    this.changed();\n  }\n};\n\n\n/**\n * Set the layer source.\n * @param {module:ol/source/Source} source The layer source.\n * @observable\n * @api\n */\nLayer.prototype.setSource = function(source) {\n  this.set(LayerProperty.SOURCE, source);\n};\nexport default Layer;\n","/**\n * @module ol/layer/Property\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  OPACITY: 'opacity',\n  VISIBLE: 'visible',\n  EXTENT: 'extent',\n  Z_INDEX: 'zIndex',\n  MAX_RESOLUTION: 'maxResolution',\n  MIN_RESOLUTION: 'minResolution',\n  SOURCE: 'source'\n};\n","/**\n * @module ol/layer/Vector\n */\nimport {inherits} from '../index.js';\nimport LayerType from '../LayerType.js';\nimport Layer from '../layer/Layer.js';\nimport VectorRenderType from '../layer/VectorRenderType.js';\nimport {assign} from '../obj.js';\nimport {createDefaultStyle, toFunction as toStyleFunction} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {module:ol/render~OrderFunction} [renderOrder] Render order. Function to be used when sorting\n * features before rendering. By default features are drawn in the order that they are created. Use\n * `null` to avoid the sort, but get an undefined draw order.\n * @property {number} [renderBuffer=100] The buffer in pixels around the viewport extent used by the\n * renderer when getting features from the vector source for the rendering or hit-detection.\n * Recommended value: the size of the largest symbol, line width or label.\n * @property {module:ol/layer/VectorRenderType|string} [renderMode='vector'] Render mode for vector layers:\n *  * `'image'`: Vector layers are rendered as images. Great performance, but point symbols and\n *    texts are always rotated with the view and pixels are scaled during zoom animations.\n *  * `'vector'`: Vector layers are rendered as vectors. Most accurate rendering even during\n *    animations, but slower performance.\n * @property {module:ol/source/Vector} [source] Source.\n * @property {module:ol/PluggableMap} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [declutter=false] Declutter images and text. Decluttering is applied to all\n * image and text styles, and the priority is defined by the z-index of the style. Lower z-index\n * means higher priority.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style] Layer style. See\n * {@link module:ol/style} for default style which will be used if this is not defined.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load simultaneously.\n * @property {boolean} [updateWhileAnimating=false] When set to `true` and `renderMode`\n * is `vector`, feature batches will be recreated during animations. This means that no\n * vectors will be shown clipped, but the setting will have a performance impact for large\n * amounts of vector data. When set to `false`, batches will be recreated when no animation\n * is active.\n * @property {boolean} [updateWhileInteracting=false] When set to `true` and `renderMode`\n * is `vector`, feature batches will be recreated during interactions. See also\n * `updateWhileAnimating`.\n */\n\n\n/**\n * @enum {string}\n * Render mode for vector layers:\n *  * `'image'`: Vector layers are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'vector'`: Vector layers are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance.\n * @api\n */\nexport const RenderType = {\n  IMAGE: 'image',\n  VECTOR: 'vector'\n};\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  RENDER_ORDER: 'renderOrder'\n};\n\n\n/**\n * @classdesc\n * Vector data that is rendered client-side.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @constructor\n * @extends {module:ol/layer/Layer}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Vector~Options=} opt_options Options.\n * @api\n */\nconst VectorLayer = function(opt_options) {\n  const options = opt_options ?\n    opt_options : /** @type {module:ol/layer/Vector~Options} */ ({});\n\n  const baseOptions = assign({}, options);\n\n  delete baseOptions.style;\n  delete baseOptions.renderBuffer;\n  delete baseOptions.updateWhileAnimating;\n  delete baseOptions.updateWhileInteracting;\n  Layer.call(this, /** @type {module:ol/layer/Layer~Options} */ (baseOptions));\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.declutter_ = options.declutter !== undefined ? options.declutter : false;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.renderBuffer_ = options.renderBuffer !== undefined ?\n    options.renderBuffer : 100;\n\n  /**\n   * User provided style.\n   * @type {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction}\n   * @private\n   */\n  this.style_ = null;\n\n  /**\n   * Style function for use within the library.\n   * @type {module:ol/style/Style~StyleFunction|undefined}\n   * @private\n   */\n  this.styleFunction_ = undefined;\n\n  this.setStyle(options.style);\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.updateWhileAnimating_ = options.updateWhileAnimating !== undefined ?\n    options.updateWhileAnimating : false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.updateWhileInteracting_ = options.updateWhileInteracting !== undefined ?\n    options.updateWhileInteracting : false;\n\n  /**\n   * @private\n   * @type {module:ol/layer/VectorTileRenderType|string}\n   */\n  this.renderMode_ = options.renderMode || VectorRenderType.VECTOR;\n\n  /**\n   * The layer type.\n   * @protected\n   * @type {module:ol/LayerType}\n   */\n  this.type = LayerType.VECTOR;\n\n};\n\ninherits(VectorLayer, Layer);\n\n\n/**\n * @return {boolean} Declutter.\n */\nVectorLayer.prototype.getDeclutter = function() {\n  return this.declutter_;\n};\n\n\n/**\n * @param {boolean} declutter Declutter.\n */\nVectorLayer.prototype.setDeclutter = function(declutter) {\n  this.declutter_ = declutter;\n};\n\n\n/**\n * @return {number|undefined} Render buffer.\n */\nVectorLayer.prototype.getRenderBuffer = function() {\n  return this.renderBuffer_;\n};\n\n\n/**\n * @return {function(module:ol/Feature, module:ol/Feature): number|null|undefined} Render\n *     order.\n */\nVectorLayer.prototype.getRenderOrder = function() {\n  return (\n    /** @type {module:ol/render~OrderFunction|null|undefined} */ (this.get(Property.RENDER_ORDER))\n  );\n};\n\n\n/**\n * Return the associated {@link module:ol/source/Vector vectorsource} of the layer.\n * @function\n * @return {module:ol/source/Vector} Source.\n * @api\n */\nVectorLayer.prototype.getSource;\n\n\n/**\n * Get the style for features.  This returns whatever was passed to the `style`\n * option at construction or to the `setStyle` method.\n * @return {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction}\n *     Layer style.\n * @api\n */\nVectorLayer.prototype.getStyle = function() {\n  return this.style_;\n};\n\n\n/**\n * Get the style function.\n * @return {module:ol/style/Style~StyleFunction|undefined} Layer style function.\n * @api\n */\nVectorLayer.prototype.getStyleFunction = function() {\n  return this.styleFunction_;\n};\n\n\n/**\n * @return {boolean} Whether the rendered layer should be updated while\n *     animating.\n */\nVectorLayer.prototype.getUpdateWhileAnimating = function() {\n  return this.updateWhileAnimating_;\n};\n\n\n/**\n * @return {boolean} Whether the rendered layer should be updated while\n *     interacting.\n */\nVectorLayer.prototype.getUpdateWhileInteracting = function() {\n  return this.updateWhileInteracting_;\n};\n\n\n/**\n * @param {module:ol/render~OrderFunction|null|undefined} renderOrder\n *     Render order.\n */\nVectorLayer.prototype.setRenderOrder = function(renderOrder) {\n  this.set(Property.RENDER_ORDER, renderOrder);\n};\n\n\n/**\n * Set the style for features.  This can be a single style object, an array\n * of styles, or a function that takes a feature and resolution and returns\n * an array of styles. If it is `undefined` the default style is used. If\n * it is `null` the layer has no style (a `null` style), so only features\n * that have their own styles will be rendered in the layer. See\n * {@link module:ol/style} for information on the default style.\n * @param {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction|null|undefined}\n *     style Layer style.\n * @api\n */\nVectorLayer.prototype.setStyle = function(style) {\n  this.style_ = style !== undefined ? style : createDefaultStyle;\n  this.styleFunction_ = style === null ?\n    undefined : toStyleFunction(this.style_);\n  this.changed();\n};\n\n\n/**\n * @return {module:ol/layer/VectorRenderType|string} The render mode.\n */\nVectorLayer.prototype.getRenderMode = function() {\n  return this.renderMode_;\n};\n\n\nexport default VectorLayer;\n","/**\n * @module ol/layer/VectorRenderType\n */\n\n/**\n * @enum {string}\n * Render mode for vector layers:\n *  * `'image'`: Vector layers are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'vector'`: Vector layers are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance.\n * @api\n */\nexport default {\n  IMAGE: 'image',\n  VECTOR: 'vector'\n};\n","/**\n * @module ol/layer/VectorTileRenderType\n */\n\n/**\n * @enum {string}\n * Render mode for vector tiles:\n *  * `'image'`: Vector tiles are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'hybrid'`: Polygon and line elements are rendered as images, so pixels\n *    are scaled during zoom animations. Point symbols and texts are accurately\n *    rendered as vectors and can stay upright on rotated views.\n *  * `'vector'`: Vector tiles are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance than the other options.\n * @api\n */\nexport default {\n  IMAGE: 'image',\n  HYBRID: 'hybrid',\n  VECTOR: 'vector'\n};\n","/**\n * @module ol/loadingstrategy\n */\n\n\n/**\n * Strategy function for loading all features with a single request.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @return {Array.<module:ol/extent~Extent>} Extents.\n * @api\n */\nexport function all(extent, resolution) {\n  return [[-Infinity, -Infinity, Infinity, Infinity]];\n}\n\n\n/**\n * Strategy function for loading features based on the view's extent and\n * resolution.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @return {Array.<module:ol/extent~Extent>} Extents.\n * @api\n */\nexport function bbox(extent, resolution) {\n  return [extent];\n}\n\n\n/**\n * Creates a strategy function for loading features based on a tile grid.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @return {function(module:ol/extent~Extent, number): Array.<module:ol/extent~Extent>} Loading strategy.\n * @api\n */\nexport function tile(tileGrid) {\n  return (\n    /**\n     * @param {module:ol/extent~Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @return {Array.<module:ol/extent~Extent>} Extents.\n     */\n    function(extent, resolution) {\n      const z = tileGrid.getZForResolution(resolution);\n      const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n      /** @type {Array.<module:ol/extent~Extent>} */\n      const extents = [];\n      /** @type {module:ol/tilecoord~TileCoord} */\n      const tileCoord = [z, 0, 0];\n      for (tileCoord[1] = tileRange.minX; tileCoord[1] <= tileRange.maxX; ++tileCoord[1]) {\n        for (tileCoord[2] = tileRange.minY; tileCoord[2] <= tileRange.maxY; ++tileCoord[2]) {\n          extents.push(tileGrid.getTileCoordExtent(tileCoord));\n        }\n      }\n      return extents;\n    }\n  );\n}\n","/**\n * @module ol/math\n */\nimport {assert} from './asserts.js';\n\n/**\n * Takes a number and clamps it to within the provided bounds.\n * @param {number} value The input number.\n * @param {number} min The minimum value to return.\n * @param {number} max The maximum value to return.\n * @return {number} The input number if it is within bounds, or the nearest\n *     number within the bounds.\n */\nexport function clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\n\n/**\n * Return the hyperbolic cosine of a given number. The method will use the\n * native `Math.cosh` function if it is available, otherwise the hyperbolic\n * cosine will be calculated via the reference implementation of the Mozilla\n * developer network.\n *\n * @param {number} x X.\n * @return {number} Hyperbolic cosine of x.\n */\nexport const cosh  = (function() {\n  // Wrapped in a iife, to save the overhead of checking for the native\n  // implementation on every invocation.\n  let cosh;\n  if ('cosh' in Math) {\n    // The environment supports the native Math.cosh function, use it\n    cosh = Math.cosh;\n  } else {\n    //  else, use the reference implementation of MDN:\n    cosh = function(x) {\n      const y = Math.exp(x);\n      return (y + 1 / y) / 2;\n    };\n  }\n  return cosh;\n}());\n\n\n/**\n * @param {number} x X.\n * @return {number} The smallest power of two greater than or equal to x.\n */\nexport function roundUpToPowerOfTwo(x) {\n  assert(0 < x, 29); // `x` must be greater than `0`\n  return Math.pow(2, Math.ceil(Math.log(x) / Math.LN2));\n}\n\n\n/**\n * Returns the square of the closest distance between the point (x, y) and the\n * line segment (x1, y1) to (x2, y2).\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredSegmentDistance(x, y, x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  if (dx !== 0 || dy !== 0) {\n    const t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      x1 = x2;\n      y1 = y2;\n    } else if (t > 0) {\n      x1 += dx * t;\n      y1 += dy * t;\n    }\n  }\n  return squaredDistance(x, y, x1, y1);\n}\n\n\n/**\n * Returns the square of the distance between the points (x1, y1) and (x2, y2).\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredDistance(x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * Solves system of linear equations using Gaussian elimination method.\n *\n * @param {Array.<Array.<number>>} mat Augmented matrix (n x n + 1 column)\n *                                     in row-major order.\n * @return {Array.<number>} The resulting vector.\n */\nexport function solveLinearSystem(mat) {\n  const n = mat.length;\n\n  for (let i = 0; i < n; i++) {\n    // Find max in the i-th column (ignoring i - 1 first rows)\n    let maxRow = i;\n    let maxEl = Math.abs(mat[i][i]);\n    for (let r = i + 1; r < n; r++) {\n      const absValue = Math.abs(mat[r][i]);\n      if (absValue > maxEl) {\n        maxEl = absValue;\n        maxRow = r;\n      }\n    }\n\n    if (maxEl === 0) {\n      return null; // matrix is singular\n    }\n\n    // Swap max row with i-th (current) row\n    const tmp = mat[maxRow];\n    mat[maxRow] = mat[i];\n    mat[i] = tmp;\n\n    // Subtract the i-th row to make all the remaining rows 0 in the i-th column\n    for (let j = i + 1; j < n; j++) {\n      const coef = -mat[j][i] / mat[i][i];\n      for (let k = i; k < n + 1; k++) {\n        if (i == k) {\n          mat[j][k] = 0;\n        } else {\n          mat[j][k] += coef * mat[i][k];\n        }\n      }\n    }\n  }\n\n  // Solve Ax=b for upper triangular matrix A (mat)\n  const x = new Array(n);\n  for (let l = n - 1; l >= 0; l--) {\n    x[l] = mat[l][n] / mat[l][l];\n    for (let m = l - 1; m >= 0; m--) {\n      mat[m][n] -= mat[m][l] * x[l];\n    }\n  }\n  return x;\n}\n\n\n/**\n * Converts radians to to degrees.\n *\n * @param {number} angleInRadians Angle in radians.\n * @return {number} Angle in degrees.\n */\nexport function toDegrees(angleInRadians) {\n  return angleInRadians * 180 / Math.PI;\n}\n\n\n/**\n * Converts degrees to radians.\n *\n * @param {number} angleInDegrees Angle in degrees.\n * @return {number} Angle in radians.\n */\nexport function toRadians(angleInDegrees) {\n  return angleInDegrees * Math.PI / 180;\n}\n\n/**\n * Returns the modulo of a / b, depending on the sign of b.\n *\n * @param {number} a Dividend.\n * @param {number} b Divisor.\n * @return {number} Modulo.\n */\nexport function modulo(a, b) {\n  const r = a % b;\n  return r * b < 0 ? r + b : r;\n}\n\n/**\n * Calculates the linearly interpolated value of x between a and b.\n *\n * @param {number} a Number\n * @param {number} b Number\n * @param {number} x Value to be interpolated.\n * @return {number} Interpolated value.\n */\nexport function lerp(a, b, x) {\n  return a + x * (b - a);\n}\n","/**\n * @module ol/obj\n */\n\n\n/**\n * Polyfill for Object.assign().  Assigns enumerable and own properties from\n * one or more source objects to a target object.\n *\n * @see https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n * @param {!Object} target The target object.\n * @param {...Object} var_sources The source object(s).\n * @return {!Object} The modified target object.\n */\nexport const assign = (typeof Object.assign === 'function') ? Object.assign : function(target, var_sources) {\n  if (target === undefined || target === null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1, ii = arguments.length; i < ii; ++i) {\n    const source = arguments[i];\n    if (source !== undefined && source !== null) {\n      for (const key in source) {\n        if (source.hasOwnProperty(key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n};\n\n\n/**\n * Removes all properties from an object.\n * @param {Object} object The object to clear.\n */\nexport function clear(object) {\n  for (const property in object) {\n    delete object[property];\n  }\n}\n\n\n/**\n * Get an array of property values from an object.\n * @param {Object<K,V>} object The object from which to get the values.\n * @return {!Array<V>} The property values.\n * @template K,V\n */\nexport function getValues(object) {\n  const values = [];\n  for (const property in object) {\n    values.push(object[property]);\n  }\n  return values;\n}\n\n\n/**\n * Determine if an object has any properties.\n * @param {Object} object The object to check.\n * @return {boolean} The object is empty.\n */\nexport function isEmpty(object) {\n  let property;\n  for (property in object) {\n    return false;\n  }\n  return !property;\n}\n","\nvar content = require(\"!!../css-loader/index.js!./ol.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../css-loader/index.js!./ol.css\", function() {\n\t\tvar newContent = require(\"!!../css-loader/index.js!./ol.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","/**\n * @module ol/pointer/EventSource\n */\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @param {!Object.<string, function(Event)>} mapping Event mapping.\n * @constructor\n */\nconst EventSource = function(dispatcher, mapping) {\n  /**\n   * @type {module:ol/pointer/PointerEventHandler}\n   */\n  this.dispatcher = dispatcher;\n\n  /**\n   * @private\n   * @const\n   * @type {!Object.<string, function(Event)>}\n   */\n  this.mapping_ = mapping;\n};\n\n\n/**\n * List of events supported by this source.\n * @return {Array.<string>} Event names\n */\nEventSource.prototype.getEvents = function() {\n  return Object.keys(this.mapping_);\n};\n\n\n/**\n * Returns the handler that should handle a given event type.\n * @param {string} eventType The event type.\n * @return {function(Event)} Handler\n */\nEventSource.prototype.getHandlerForEvent = function(eventType) {\n  return this.mapping_[eventType];\n};\nexport default EventSource;\n","/**\n * @module ol/pointer/EventType\n */\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n  POINTERMOVE: 'pointermove',\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n","/**\n * @module ol/pointer/MouseSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport EventSource from '../pointer/EventSource.js';\n\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @constructor\n * @extends {module:ol/pointer/EventSource}\n */\nconst MouseSource = function(dispatcher) {\n  const mapping = {\n    'mousedown': this.mousedown,\n    'mousemove': this.mousemove,\n    'mouseup': this.mouseup,\n    'mouseover': this.mouseover,\n    'mouseout': this.mouseout\n  };\n  EventSource.call(this, dispatcher, mapping);\n\n  /**\n   * @const\n   * @type {!Object.<string, Event|Object>}\n   */\n  this.pointerMap = dispatcher.pointerMap;\n\n  /**\n   * @const\n   * @type {Array.<module:ol~Pixel>}\n   */\n  this.lastTouches = [];\n};\n\ninherits(MouseSource, EventSource);\n\n\n/**\n * @type {number}\n */\nexport const POINTER_ID = 1;\n\n\n/**\n * @type {string}\n */\nexport const POINTER_TYPE = 'mouse';\n\n\n/**\n * Radius around touchend that swallows mouse events.\n *\n * @type {number}\n */\nconst DEDUP_DIST = 25;\n\n\n/**\n * Detect if a mouse event was simulated from a touch by\n * checking if previously there was a touch event at the\n * same position.\n *\n * FIXME - Known problem with the native Android browser on\n * Samsung GT-I9100 (Android 4.1.2):\n * In case the page is scrolled, this function does not work\n * correctly when a canvas is used (WebGL or canvas renderer).\n * Mouse listeners on canvas elements (for this browser), create\n * two mouse events: One 'good' and one 'bad' one (on other browsers or\n * when a div is used, there is only one event). For the 'bad' one,\n * clientX/clientY and also pageX/pageY are wrong when the page\n * is scrolled. Because of that, this function can not detect if\n * the events were simulated from a touch event. As result, a\n * pointer event at a wrong position is dispatched, which confuses\n * the map interactions.\n * It is unclear, how one can get the correct position for the event\n * or detect that the positions are invalid.\n *\n * @private\n * @param {Event} inEvent The in event.\n * @return {boolean} True, if the event was generated by a touch.\n */\nMouseSource.prototype.isEventSimulatedFromTouch_ = function(inEvent) {\n  const lts = this.lastTouches;\n  const x = inEvent.clientX;\n  const y = inEvent.clientY;\n  for (let i = 0, l = lts.length, t; i < l && (t = lts[i]); i++) {\n    // simulated mouse events will be swallowed near a primary touchend\n    const dx = Math.abs(x - t[0]);\n    const dy = Math.abs(y - t[1]);\n    if (dx <= DEDUP_DIST && dy <= DEDUP_DIST) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Creates a copy of the original event that will be used\n * for the fake pointer event.\n *\n * @param {Event} inEvent The in event.\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @return {Object} The copied event.\n */\nfunction prepareEvent(inEvent, dispatcher) {\n  const e = dispatcher.cloneEvent(inEvent, inEvent);\n\n  // forward mouse preventDefault\n  const pd = e.preventDefault;\n  e.preventDefault = function() {\n    inEvent.preventDefault();\n    pd();\n  };\n\n  e.pointerId = POINTER_ID;\n  e.isPrimary = true;\n  e.pointerType = POINTER_TYPE;\n\n  return e;\n}\n\n\n/**\n * Handler for `mousedown`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mousedown = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    // TODO(dfreedman) workaround for some elements not sending mouseup\n    // http://crbug/149091\n    if (POINTER_ID.toString() in this.pointerMap) {\n      this.cancel(inEvent);\n    }\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.pointerMap[POINTER_ID.toString()] = inEvent;\n    this.dispatcher.down(e, inEvent);\n  }\n};\n\n\n/**\n * Handler for `mousemove`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mousemove = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.move(e, inEvent);\n  }\n};\n\n\n/**\n * Handler for `mouseup`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mouseup = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const p = this.pointerMap[POINTER_ID.toString()];\n\n    if (p && p.button === inEvent.button) {\n      const e = prepareEvent(inEvent, this.dispatcher);\n      this.dispatcher.up(e, inEvent);\n      this.cleanupMouse();\n    }\n  }\n};\n\n\n/**\n * Handler for `mouseover`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mouseover = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.enterOver(e, inEvent);\n  }\n};\n\n\n/**\n * Handler for `mouseout`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mouseout = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.leaveOut(e, inEvent);\n  }\n};\n\n\n/**\n * Dispatches a `pointercancel` event.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.cancel = function(inEvent) {\n  const e = prepareEvent(inEvent, this.dispatcher);\n  this.dispatcher.cancel(e, inEvent);\n  this.cleanupMouse();\n};\n\n\n/**\n * Remove the mouse from the list of active pointers.\n */\nMouseSource.prototype.cleanupMouse = function() {\n  delete this.pointerMap[POINTER_ID.toString()];\n};\nexport default MouseSource;\n","/**\n * @module ol/pointer/MsSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport EventSource from '../pointer/EventSource.js';\n\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @constructor\n * @extends {module:ol/pointer/EventSource}\n */\nconst MsSource = function(dispatcher) {\n  const mapping = {\n    'MSPointerDown': this.msPointerDown,\n    'MSPointerMove': this.msPointerMove,\n    'MSPointerUp': this.msPointerUp,\n    'MSPointerOut': this.msPointerOut,\n    'MSPointerOver': this.msPointerOver,\n    'MSPointerCancel': this.msPointerCancel,\n    'MSGotPointerCapture': this.msGotPointerCapture,\n    'MSLostPointerCapture': this.msLostPointerCapture\n  };\n  EventSource.call(this, dispatcher, mapping);\n\n  /**\n   * @const\n   * @type {!Object.<string, MSPointerEvent|Object>}\n   */\n  this.pointerMap = dispatcher.pointerMap;\n};\n\ninherits(MsSource, EventSource);\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst POINTER_TYPES = [\n  '',\n  'unavailable',\n  'touch',\n  'pen',\n  'mouse'\n];\n\n\n/**\n * Creates a copy of the original event that will be used\n * for the fake pointer event.\n *\n * @private\n * @param {MSPointerEvent} inEvent The in event.\n * @return {Object} The copied event.\n */\nMsSource.prototype.prepareEvent_ = function(inEvent) {\n  let e = inEvent;\n  if (typeof inEvent.pointerType === 'number') {\n    e = this.dispatcher.cloneEvent(inEvent, inEvent);\n    e.pointerType = POINTER_TYPES[inEvent.pointerType];\n  }\n\n  return e;\n};\n\n\n/**\n * Remove this pointer from the list of active pointers.\n * @param {number} pointerId Pointer identifier.\n */\nMsSource.prototype.cleanup = function(pointerId) {\n  delete this.pointerMap[pointerId.toString()];\n};\n\n\n/**\n * Handler for `msPointerDown`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerDown = function(inEvent) {\n  this.pointerMap[inEvent.pointerId.toString()] = inEvent;\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.down(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerMove`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerMove = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.move(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerUp`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerUp = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.up(e, inEvent);\n  this.cleanup(inEvent.pointerId);\n};\n\n\n/**\n * Handler for `msPointerOut`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerOut = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.leaveOut(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerOver`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerOver = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.enterOver(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerCancel`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerCancel = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.cancel(e, inEvent);\n  this.cleanup(inEvent.pointerId);\n};\n\n\n/**\n * Handler for `msLostPointerCapture`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msLostPointerCapture = function(inEvent) {\n  const e = this.dispatcher.makeEvent('lostpointercapture', inEvent, inEvent);\n  this.dispatcher.dispatchEvent(e);\n};\n\n\n/**\n * Handler for `msGotPointerCapture`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msGotPointerCapture = function(inEvent) {\n  const e = this.dispatcher.makeEvent('gotpointercapture', inEvent, inEvent);\n  this.dispatcher.dispatchEvent(e);\n};\nexport default MsSource;\n","/**\n * @module ol/pointer/NativeSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport EventSource from '../pointer/EventSource.js';\n\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @constructor\n * @extends {module:ol/pointer/EventSource}\n */\nconst NativeSource = function(dispatcher) {\n  const mapping = {\n    'pointerdown': this.pointerDown,\n    'pointermove': this.pointerMove,\n    'pointerup': this.pointerUp,\n    'pointerout': this.pointerOut,\n    'pointerover': this.pointerOver,\n    'pointercancel': this.pointerCancel,\n    'gotpointercapture': this.gotPointerCapture,\n    'lostpointercapture': this.lostPointerCapture\n  };\n  EventSource.call(this, dispatcher, mapping);\n};\n\ninherits(NativeSource, EventSource);\n\n\n/**\n * Handler for `pointerdown`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerDown = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointermove`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerMove = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointerup`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerUp = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointerout`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerOut = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointerover`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerOver = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointercancel`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerCancel = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `lostpointercapture`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.lostPointerCapture = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `gotpointercapture`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.gotPointerCapture = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\nexport default NativeSource;\n","/**\n * @module ol/pointer/PointerEvent\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport Event from '../events/Event.js';\n\n/**\n * A class for pointer events.\n *\n * This class is used as an abstraction for mouse events,\n * touch events and even native pointer events.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type The type of the event to create.\n * @param {Event} originalEvent The event.\n * @param {Object.<string, ?>=} opt_eventDict An optional dictionary of\n *    initial event properties.\n */\nconst PointerEvent = function(type, originalEvent, opt_eventDict) {\n  Event.call(this, type);\n\n  /**\n   * @const\n   * @type {Event}\n   */\n  this.originalEvent = originalEvent;\n\n  const eventDict = opt_eventDict ? opt_eventDict : {};\n\n  /**\n   * @type {number}\n   */\n  this.buttons = this.getButtons_(eventDict);\n\n  /**\n   * @type {number}\n   */\n  this.pressure = this.getPressure_(eventDict, this.buttons);\n\n  // MouseEvent related properties\n\n  /**\n   * @type {boolean}\n   */\n  this.bubbles = 'bubbles' in eventDict ? eventDict['bubbles'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.cancelable = 'cancelable' in eventDict ? eventDict['cancelable'] : false;\n\n  /**\n   * @type {Object}\n   */\n  this.view = 'view' in eventDict ? eventDict['view'] : null;\n\n  /**\n   * @type {number}\n   */\n  this.detail = 'detail' in eventDict ? eventDict['detail'] : null;\n\n  /**\n   * @type {number}\n   */\n  this.screenX = 'screenX' in eventDict ? eventDict['screenX'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.screenY = 'screenY' in eventDict ? eventDict['screenY'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.clientX = 'clientX' in eventDict ? eventDict['clientX'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.clientY = 'clientY' in eventDict ? eventDict['clientY'] : 0;\n\n  /**\n   * @type {boolean}\n   */\n  this.ctrlKey = 'ctrlKey' in eventDict ? eventDict['ctrlKey'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.altKey = 'altKey' in eventDict ? eventDict['altKey'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.shiftKey = 'shiftKey' in eventDict ? eventDict['shiftKey'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.metaKey = 'metaKey' in eventDict ? eventDict['metaKey'] : false;\n\n  /**\n   * @type {number}\n   */\n  this.button = 'button' in eventDict ? eventDict['button'] : 0;\n\n  /**\n   * @type {Node}\n   */\n  this.relatedTarget = 'relatedTarget' in eventDict ?\n    eventDict['relatedTarget'] : null;\n\n  // PointerEvent related properties\n\n  /**\n   * @const\n   * @type {number}\n   */\n  this.pointerId = 'pointerId' in eventDict ? eventDict['pointerId'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.width = 'width' in eventDict ? eventDict['width'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.height = 'height' in eventDict ? eventDict['height'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.tiltX = 'tiltX' in eventDict ? eventDict['tiltX'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.tiltY = 'tiltY' in eventDict ? eventDict['tiltY'] : 0;\n\n  /**\n   * @type {string}\n   */\n  this.pointerType = 'pointerType' in eventDict ? eventDict['pointerType'] : '';\n\n  /**\n   * @type {number}\n   */\n  this.hwTimestamp = 'hwTimestamp' in eventDict ? eventDict['hwTimestamp'] : 0;\n\n  /**\n   * @type {boolean}\n   */\n  this.isPrimary = 'isPrimary' in eventDict ? eventDict['isPrimary'] : false;\n\n  // keep the semantics of preventDefault\n  if (originalEvent.preventDefault) {\n    this.preventDefault = function() {\n      originalEvent.preventDefault();\n    };\n  }\n};\n\ninherits(PointerEvent, Event);\n\n\n/**\n * Is the `buttons` property supported?\n * @type {boolean}\n */\nlet HAS_BUTTONS = false;\n\n\n/**\n * @private\n * @param {Object.<string, ?>} eventDict The event dictionary.\n * @return {number} Button indicator.\n */\nPointerEvent.prototype.getButtons_ = function(eventDict) {\n  // According to the w3c spec,\n  // http://www.w3.org/TR/DOM-Level-3-Events/#events-MouseEvent-button\n  // MouseEvent.button == 0 can mean either no mouse button depressed, or the\n  // left mouse button depressed.\n  //\n  // As of now, the only way to distinguish between the two states of\n  // MouseEvent.button is by using the deprecated MouseEvent.which property, as\n  // this maps mouse buttons to positive integers > 0, and uses 0 to mean that\n  // no mouse button is held.\n  //\n  // MouseEvent.which is derived from MouseEvent.button at MouseEvent creation,\n  // but initMouseEvent does not expose an argument with which to set\n  // MouseEvent.which. Calling initMouseEvent with a buttonArg of 0 will set\n  // MouseEvent.button == 0 and MouseEvent.which == 1, breaking the expectations\n  // of app developers.\n  //\n  // The only way to propagate the correct state of MouseEvent.which and\n  // MouseEvent.button to a new MouseEvent.button == 0 and MouseEvent.which == 0\n  // is to call initMouseEvent with a buttonArg value of -1.\n  //\n  // This is fixed with DOM Level 4's use of buttons\n  let buttons;\n  if (eventDict.buttons || HAS_BUTTONS) {\n    buttons = eventDict.buttons;\n  } else {\n    switch (eventDict.which) {\n      case 1: buttons = 1; break;\n      case 2: buttons = 4; break;\n      case 3: buttons = 2; break;\n      default: buttons = 0;\n    }\n  }\n  return buttons;\n};\n\n\n/**\n * @private\n * @param {Object.<string, ?>} eventDict The event dictionary.\n * @param {number} buttons Button indicator.\n * @return {number} The pressure.\n */\nPointerEvent.prototype.getPressure_ = function(eventDict, buttons) {\n  // Spec requires that pointers without pressure specified use 0.5 for down\n  // state and 0 for up state.\n  let pressure = 0;\n  if (eventDict.pressure) {\n    pressure = eventDict.pressure;\n  } else {\n    pressure = buttons ? 0.5 : 0;\n  }\n  return pressure;\n};\n\n\n/**\n * Checks if the `buttons` property is supported.\n */\n(function() {\n  try {\n    const ev = new MouseEvent('click', {buttons: 1});\n    HAS_BUTTONS = ev.buttons === 1;\n  } catch (e) {\n    // pass\n  }\n})();\nexport default PointerEvent;\n","/**\n * @module ol/pointer/PointerEventHandler\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport {listen, unlisten} from '../events.js';\nimport EventTarget from '../events/EventTarget.js';\nimport {POINTER, MSPOINTER, TOUCH} from '../has.js';\nimport PointerEventType from '../pointer/EventType.js';\nimport MouseSource from '../pointer/MouseSource.js';\nimport MsSource from '../pointer/MsSource.js';\nimport NativeSource from '../pointer/NativeSource.js';\nimport PointerEvent from '../pointer/PointerEvent.js';\nimport TouchSource from '../pointer/TouchSource.js';\n\n/**\n * @constructor\n * @extends {module:ol/events/EventTarget}\n * @param {Element|HTMLDocument} element Viewport element.\n */\nconst PointerEventHandler = function(element) {\n  EventTarget.call(this);\n\n  /**\n   * @const\n   * @private\n   * @type {Element|HTMLDocument}\n   */\n  this.element_ = element;\n\n  /**\n   * @const\n   * @type {!Object.<string, Event|Object>}\n   */\n  this.pointerMap = {};\n\n  /**\n   * @type {Object.<string, function(Event)>}\n   * @private\n   */\n  this.eventMap_ = {};\n\n  /**\n   * @type {Array.<module:ol/pointer/EventSource>}\n   * @private\n   */\n  this.eventSourceList_ = [];\n\n  this.registerSources();\n};\n\ninherits(PointerEventHandler, EventTarget);\n\n/**\n * Properties to copy when cloning an event, with default values.\n * @type {Array.<Array>}\n */\nconst CLONE_PROPS = [\n  // MouseEvent\n  ['bubbles', false],\n  ['cancelable', false],\n  ['view', null],\n  ['detail', null],\n  ['screenX', 0],\n  ['screenY', 0],\n  ['clientX', 0],\n  ['clientY', 0],\n  ['ctrlKey', false],\n  ['altKey', false],\n  ['shiftKey', false],\n  ['metaKey', false],\n  ['button', 0],\n  ['relatedTarget', null],\n  // DOM Level 3\n  ['buttons', 0],\n  // PointerEvent\n  ['pointerId', 0],\n  ['width', 0],\n  ['height', 0],\n  ['pressure', 0],\n  ['tiltX', 0],\n  ['tiltY', 0],\n  ['pointerType', ''],\n  ['hwTimestamp', 0],\n  ['isPrimary', false],\n  // event instance\n  ['type', ''],\n  ['target', null],\n  ['currentTarget', null],\n  ['which', 0]\n];\n\n\n/**\n * Set up the event sources (mouse, touch and native pointers)\n * that generate pointer events.\n */\nPointerEventHandler.prototype.registerSources = function() {\n  if (POINTER) {\n    this.registerSource('native', new NativeSource(this));\n  } else if (MSPOINTER) {\n    this.registerSource('ms', new MsSource(this));\n  } else {\n    const mouseSource = new MouseSource(this);\n    this.registerSource('mouse', mouseSource);\n\n    if (TOUCH) {\n      this.registerSource('touch', new TouchSource(this, mouseSource));\n    }\n  }\n\n  // register events on the viewport element\n  this.register_();\n};\n\n\n/**\n * Add a new event source that will generate pointer events.\n *\n * @param {string} name A name for the event source\n * @param {module:ol/pointer/EventSource} source The source event.\n */\nPointerEventHandler.prototype.registerSource = function(name, source) {\n  const s = source;\n  const newEvents = s.getEvents();\n\n  if (newEvents) {\n    newEvents.forEach(function(e) {\n      const handler = s.getHandlerForEvent(e);\n\n      if (handler) {\n        this.eventMap_[e] = handler.bind(s);\n      }\n    }.bind(this));\n    this.eventSourceList_.push(s);\n  }\n};\n\n\n/**\n * Set up the events for all registered event sources.\n * @private\n */\nPointerEventHandler.prototype.register_ = function() {\n  const l = this.eventSourceList_.length;\n  for (let i = 0; i < l; i++) {\n    const eventSource = this.eventSourceList_[i];\n    this.addEvents_(eventSource.getEvents());\n  }\n};\n\n\n/**\n * Remove all registered events.\n * @private\n */\nPointerEventHandler.prototype.unregister_ = function() {\n  const l = this.eventSourceList_.length;\n  for (let i = 0; i < l; i++) {\n    const eventSource = this.eventSourceList_[i];\n    this.removeEvents_(eventSource.getEvents());\n  }\n};\n\n\n/**\n * Calls the right handler for a new event.\n * @private\n * @param {Event} inEvent Browser event.\n */\nPointerEventHandler.prototype.eventHandler_ = function(inEvent) {\n  const type = inEvent.type;\n  const handler = this.eventMap_[type];\n  if (handler) {\n    handler(inEvent);\n  }\n};\n\n\n/**\n * Setup listeners for the given events.\n * @private\n * @param {Array.<string>} events List of events.\n */\nPointerEventHandler.prototype.addEvents_ = function(events) {\n  events.forEach(function(eventName) {\n    listen(this.element_, eventName, this.eventHandler_, this);\n  }.bind(this));\n};\n\n\n/**\n * Unregister listeners for the given events.\n * @private\n * @param {Array.<string>} events List of events.\n */\nPointerEventHandler.prototype.removeEvents_ = function(events) {\n  events.forEach(function(e) {\n    unlisten(this.element_, e, this.eventHandler_, this);\n  }.bind(this));\n};\n\n\n/**\n * Returns a snapshot of inEvent, with writable properties.\n *\n * @param {Event} event Browser event.\n * @param {Event|Touch} inEvent An event that contains\n *    properties to copy.\n * @return {Object} An object containing shallow copies of\n *    `inEvent`'s properties.\n */\nPointerEventHandler.prototype.cloneEvent = function(event, inEvent) {\n  const eventCopy = {};\n  for (let i = 0, ii = CLONE_PROPS.length; i < ii; i++) {\n    const p = CLONE_PROPS[i][0];\n    eventCopy[p] = event[p] || inEvent[p] || CLONE_PROPS[i][1];\n  }\n\n  return eventCopy;\n};\n\n\n// EVENTS\n\n\n/**\n * Triggers a 'pointerdown' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.down = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERDOWN, data, event);\n};\n\n\n/**\n * Triggers a 'pointermove' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.move = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERMOVE, data, event);\n};\n\n\n/**\n * Triggers a 'pointerup' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.up = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERUP, data, event);\n};\n\n\n/**\n * Triggers a 'pointerenter' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.enter = function(data, event) {\n  data.bubbles = false;\n  this.fireEvent(PointerEventType.POINTERENTER, data, event);\n};\n\n\n/**\n * Triggers a 'pointerleave' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.leave = function(data, event) {\n  data.bubbles = false;\n  this.fireEvent(PointerEventType.POINTERLEAVE, data, event);\n};\n\n\n/**\n * Triggers a 'pointerover' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.over = function(data, event) {\n  data.bubbles = true;\n  this.fireEvent(PointerEventType.POINTEROVER, data, event);\n};\n\n\n/**\n * Triggers a 'pointerout' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.out = function(data, event) {\n  data.bubbles = true;\n  this.fireEvent(PointerEventType.POINTEROUT, data, event);\n};\n\n\n/**\n * Triggers a 'pointercancel' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.cancel = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERCANCEL, data, event);\n};\n\n\n/**\n * Triggers a combination of 'pointerout' and 'pointerleave' events.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.leaveOut = function(data, event) {\n  this.out(data, event);\n  if (!this.contains_(data.target, data.relatedTarget)) {\n    this.leave(data, event);\n  }\n};\n\n\n/**\n * Triggers a combination of 'pointerover' and 'pointerevents' events.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.enterOver = function(data, event) {\n  this.over(data, event);\n  if (!this.contains_(data.target, data.relatedTarget)) {\n    this.enter(data, event);\n  }\n};\n\n\n/**\n * @private\n * @param {Element} container The container element.\n * @param {Element} contained The contained element.\n * @return {boolean} Returns true if the container element\n *   contains the other element.\n */\nPointerEventHandler.prototype.contains_ = function(container, contained) {\n  if (!container || !contained) {\n    return false;\n  }\n  return container.contains(contained);\n};\n\n\n// EVENT CREATION AND TRACKING\n/**\n * Creates a new Event of type `inType`, based on the information in\n * `data`.\n *\n * @param {string} inType A string representing the type of event to create.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n * @return {module:ol/pointer/PointerEvent} A PointerEvent of type `inType`.\n */\nPointerEventHandler.prototype.makeEvent = function(inType, data, event) {\n  return new PointerEvent(inType, event, data);\n};\n\n\n/**\n * Make and dispatch an event in one call.\n * @param {string} inType A string representing the type of event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.fireEvent = function(inType, data, event) {\n  const e = this.makeEvent(inType, data, event);\n  this.dispatchEvent(e);\n};\n\n\n/**\n * Creates a pointer event from a native pointer event\n * and dispatches this event.\n * @param {Event} event A platform event with a target.\n */\nPointerEventHandler.prototype.fireNativeEvent = function(event) {\n  const e = this.makeEvent(event.type, event, event);\n  this.dispatchEvent(e);\n};\n\n\n/**\n * Wrap a native mouse event into a pointer event.\n * This proxy method is required for the legacy IE support.\n * @param {string} eventType The pointer event type.\n * @param {Event} event The event.\n * @return {module:ol/pointer/PointerEvent} The wrapped event.\n */\nPointerEventHandler.prototype.wrapMouseEvent = function(eventType, event) {\n  const pointerEvent = this.makeEvent(\n    eventType, MouseSource.prepareEvent(event, this), event);\n  return pointerEvent;\n};\n\n\n/**\n * @inheritDoc\n */\nPointerEventHandler.prototype.disposeInternal = function() {\n  this.unregister_();\n  EventTarget.prototype.disposeInternal.call(this);\n};\n\n\nexport default PointerEventHandler;\n","/**\n * @module ol/pointer/TouchSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport {remove} from '../array.js';\nimport EventSource from '../pointer/EventSource.js';\nimport {POINTER_ID} from '../pointer/MouseSource.js';\n\n\n/**\n * @constructor\n * @param {module:ol/pointer/PointerEventHandler} dispatcher The event handler.\n * @param {module:ol/pointer/MouseSource} mouseSource Mouse source.\n * @extends {module:ol/pointer/EventSource}\n */\nconst TouchSource = function(dispatcher, mouseSource) {\n  const mapping = {\n    'touchstart': this.touchstart,\n    'touchmove': this.touchmove,\n    'touchend': this.touchend,\n    'touchcancel': this.touchcancel\n  };\n  EventSource.call(this, dispatcher, mapping);\n\n  /**\n   * @const\n   * @type {!Object.<string, Event|Object>}\n   */\n  this.pointerMap = dispatcher.pointerMap;\n\n  /**\n   * @const\n   * @type {module:ol/pointer/MouseSource}\n   */\n  this.mouseSource = mouseSource;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.firstTouchId_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.clickCount_ = 0;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.resetId_ = undefined;\n\n  /**\n   * Mouse event timeout: This should be long enough to\n   * ignore compat mouse events made by touch.\n   * @private\n   * @type {number}\n   */\n  this.dedupTimeout_ = 2500;\n};\n\ninherits(TouchSource, EventSource);\n\n\n/**\n * @type {number}\n */\nconst CLICK_COUNT_TIMEOUT = 200;\n\n\n/**\n * @type {string}\n */\nconst POINTER_TYPE = 'touch';\n\n/**\n * @private\n * @param {Touch} inTouch The in touch.\n * @return {boolean} True, if this is the primary touch.\n */\nTouchSource.prototype.isPrimaryTouch_ = function(inTouch) {\n  return this.firstTouchId_ === inTouch.identifier;\n};\n\n\n/**\n * Set primary touch if there are no pointers, or the only pointer is the mouse.\n * @param {Touch} inTouch The in touch.\n * @private\n */\nTouchSource.prototype.setPrimaryTouch_ = function(inTouch) {\n  const count = Object.keys(this.pointerMap).length;\n  if (count === 0 || (count === 1 && POINTER_ID.toString() in this.pointerMap)) {\n    this.firstTouchId_ = inTouch.identifier;\n    this.cancelResetClickCount_();\n  }\n};\n\n\n/**\n * @private\n * @param {Object} inPointer The in pointer object.\n */\nTouchSource.prototype.removePrimaryPointer_ = function(inPointer) {\n  if (inPointer.isPrimary) {\n    this.firstTouchId_ = undefined;\n    this.resetClickCount_();\n  }\n};\n\n\n/**\n * @private\n */\nTouchSource.prototype.resetClickCount_ = function() {\n  this.resetId_ = setTimeout(\n    this.resetClickCountHandler_.bind(this),\n    CLICK_COUNT_TIMEOUT);\n};\n\n\n/**\n * @private\n */\nTouchSource.prototype.resetClickCountHandler_ = function() {\n  this.clickCount_ = 0;\n  this.resetId_ = undefined;\n};\n\n\n/**\n * @private\n */\nTouchSource.prototype.cancelResetClickCount_ = function() {\n  if (this.resetId_ !== undefined) {\n    clearTimeout(this.resetId_);\n  }\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent Browser event\n * @param {Touch} inTouch Touch event\n * @return {Object} A pointer object.\n */\nTouchSource.prototype.touchToPointer_ = function(browserEvent, inTouch) {\n  const e = this.dispatcher.cloneEvent(browserEvent, inTouch);\n  // Spec specifies that pointerId 1 is reserved for Mouse.\n  // Touch identifiers can start at 0.\n  // Add 2 to the touch identifier for compatibility.\n  e.pointerId = inTouch.identifier + 2;\n  // TODO: check if this is necessary?\n  //e.target = findTarget(e);\n  e.bubbles = true;\n  e.cancelable = true;\n  e.detail = this.clickCount_;\n  e.button = 0;\n  e.buttons = 1;\n  e.width = inTouch.webkitRadiusX || inTouch.radiusX || 0;\n  e.height = inTouch.webkitRadiusY || inTouch.radiusY || 0;\n  e.pressure = inTouch.webkitForce || inTouch.force || 0.5;\n  e.isPrimary = this.isPrimaryTouch_(inTouch);\n  e.pointerType = POINTER_TYPE;\n\n  // make sure that the properties that are different for\n  // each `Touch` object are not copied from the BrowserEvent object\n  e.clientX = inTouch.clientX;\n  e.clientY = inTouch.clientY;\n  e.screenX = inTouch.screenX;\n  e.screenY = inTouch.screenY;\n\n  return e;\n};\n\n\n/**\n * @private\n * @param {Event} inEvent Touch event\n * @param {function(Event, Object)} inFunction In function.\n */\nTouchSource.prototype.processTouches_ = function(inEvent, inFunction) {\n  const touches = Array.prototype.slice.call(inEvent.changedTouches);\n  const count = touches.length;\n  function preventDefault() {\n    inEvent.preventDefault();\n  }\n  for (let i = 0; i < count; ++i) {\n    const pointer = this.touchToPointer_(inEvent, touches[i]);\n    // forward touch preventDefaults\n    pointer.preventDefault = preventDefault;\n    inFunction.call(this, inEvent, pointer);\n  }\n};\n\n\n/**\n * @private\n * @param {TouchList} touchList The touch list.\n * @param {number} searchId Search identifier.\n * @return {boolean} True, if the `Touch` with the given id is in the list.\n */\nTouchSource.prototype.findTouch_ = function(touchList, searchId) {\n  const l = touchList.length;\n  for (let i = 0; i < l; i++) {\n    const touch = touchList[i];\n    if (touch.identifier === searchId) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * In some instances, a touchstart can happen without a touchend. This\n * leaves the pointermap in a broken state.\n * Therefore, on every touchstart, we remove the touches that did not fire a\n * touchend event.\n * To keep state globally consistent, we fire a pointercancel for\n * this \"abandoned\" touch\n *\n * @private\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.vacuumTouches_ = function(inEvent) {\n  const touchList = inEvent.touches;\n  // pointerMap.getCount() should be < touchList.length here,\n  // as the touchstart has not been processed yet.\n  const keys = Object.keys(this.pointerMap);\n  const count = keys.length;\n  if (count >= touchList.length) {\n    const d = [];\n    for (let i = 0; i < count; ++i) {\n      const key = keys[i];\n      const value = this.pointerMap[key];\n      // Never remove pointerId == 1, which is mouse.\n      // Touch identifiers are 2 smaller than their pointerId, which is the\n      // index in pointermap.\n      if (key != POINTER_ID && !this.findTouch_(touchList, key - 2)) {\n        d.push(value.out);\n      }\n    }\n    for (let i = 0; i < d.length; ++i) {\n      this.cancelOut_(inEvent, d[i]);\n    }\n  }\n};\n\n\n/**\n * Handler for `touchstart`, triggers `pointerover`,\n * `pointerenter` and `pointerdown` events.\n *\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.touchstart = function(inEvent) {\n  this.vacuumTouches_(inEvent);\n  this.setPrimaryTouch_(inEvent.changedTouches[0]);\n  this.dedupSynthMouse_(inEvent);\n  this.clickCount_++;\n  this.processTouches_(inEvent, this.overDown_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent The event.\n * @param {Object} inPointer The in pointer object.\n */\nTouchSource.prototype.overDown_ = function(browserEvent, inPointer) {\n  this.pointerMap[inPointer.pointerId] = {\n    target: inPointer.target,\n    out: inPointer,\n    outTarget: inPointer.target\n  };\n  this.dispatcher.over(inPointer, browserEvent);\n  this.dispatcher.enter(inPointer, browserEvent);\n  this.dispatcher.down(inPointer, browserEvent);\n};\n\n\n/**\n * Handler for `touchmove`.\n *\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.touchmove = function(inEvent) {\n  inEvent.preventDefault();\n  this.processTouches_(inEvent, this.moveOverOut_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent The event.\n * @param {Object} inPointer The in pointer.\n */\nTouchSource.prototype.moveOverOut_ = function(browserEvent, inPointer) {\n  const event = inPointer;\n  const pointer = this.pointerMap[event.pointerId];\n  // a finger drifted off the screen, ignore it\n  if (!pointer) {\n    return;\n  }\n  const outEvent = pointer.out;\n  const outTarget = pointer.outTarget;\n  this.dispatcher.move(event, browserEvent);\n  if (outEvent && outTarget !== event.target) {\n    outEvent.relatedTarget = event.target;\n    event.relatedTarget = outTarget;\n    // recover from retargeting by shadow\n    outEvent.target = outTarget;\n    if (event.target) {\n      this.dispatcher.leaveOut(outEvent, browserEvent);\n      this.dispatcher.enterOver(event, browserEvent);\n    } else {\n      // clean up case when finger leaves the screen\n      event.target = outTarget;\n      event.relatedTarget = null;\n      this.cancelOut_(browserEvent, event);\n    }\n  }\n  pointer.out = event;\n  pointer.outTarget = event.target;\n};\n\n\n/**\n * Handler for `touchend`, triggers `pointerup`,\n * `pointerout` and `pointerleave` events.\n *\n * @param {Event} inEvent The event.\n */\nTouchSource.prototype.touchend = function(inEvent) {\n  this.dedupSynthMouse_(inEvent);\n  this.processTouches_(inEvent, this.upOut_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent An event.\n * @param {Object} inPointer The inPointer object.\n */\nTouchSource.prototype.upOut_ = function(browserEvent, inPointer) {\n  this.dispatcher.up(inPointer, browserEvent);\n  this.dispatcher.out(inPointer, browserEvent);\n  this.dispatcher.leave(inPointer, browserEvent);\n  this.cleanUpPointer_(inPointer);\n};\n\n\n/**\n * Handler for `touchcancel`, triggers `pointercancel`,\n * `pointerout` and `pointerleave` events.\n *\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.touchcancel = function(inEvent) {\n  this.processTouches_(inEvent, this.cancelOut_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent The event.\n * @param {Object} inPointer The in pointer.\n */\nTouchSource.prototype.cancelOut_ = function(browserEvent, inPointer) {\n  this.dispatcher.cancel(inPointer, browserEvent);\n  this.dispatcher.out(inPointer, browserEvent);\n  this.dispatcher.leave(inPointer, browserEvent);\n  this.cleanUpPointer_(inPointer);\n};\n\n\n/**\n * @private\n * @param {Object} inPointer The inPointer object.\n */\nTouchSource.prototype.cleanUpPointer_ = function(inPointer) {\n  delete this.pointerMap[inPointer.pointerId];\n  this.removePrimaryPointer_(inPointer);\n};\n\n\n/**\n * Prevent synth mouse events from creating pointer events.\n *\n * @private\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.dedupSynthMouse_ = function(inEvent) {\n  const lts = this.mouseSource.lastTouches;\n  const t = inEvent.changedTouches[0];\n  // only the primary finger will synth mouse events\n  if (this.isPrimaryTouch_(t)) {\n    // remember x/y of last touch\n    const lt = [t.clientX, t.clientY];\n    lts.push(lt);\n\n    setTimeout(function() {\n      // remove touch after timeout\n      remove(lts, lt);\n    }, this.dedupTimeout_);\n  }\n};\nexport default TouchSource;\n","/**\n * @module ol/proj\n */\n\n/**\n * The ol/proj module stores:\n * * a list of {@link module:ol/proj/Projection}\n * objects, one for each projection supported by the application\n * * a list of transform functions needed to convert coordinates in one projection\n * into another.\n *\n * The static functions are the methods used to maintain these.\n * Each transform function can handle not only simple coordinate pairs, but also\n * large arrays of coordinates such as vector geometries.\n *\n * When loaded, the library adds projection objects for EPSG:4326 (WGS84\n * geographic coordinates) and EPSG:3857 (Web or Spherical Mercator, as used\n * for example by Bing Maps or OpenStreetMap), together with the relevant\n * transform functions.\n *\n * Additional transforms may be added by using the {@link http://proj4js.org/}\n * library (version 2.2 or later). You can use the full build supplied by\n * Proj4js, or create a custom build to support those projections you need; see\n * the Proj4js website for how to do this. You also need the Proj4js definitions\n * for the required projections. These definitions can be obtained from\n * {@link https://epsg.io/}, and are a JS function, so can be loaded in a script\n * tag (as in the examples) or pasted into your application.\n *\n * After all required projection definitions are added to proj4's registry (by\n * using `proj4.defs()`), simply call `register(proj4)` from the `ol/proj/proj4`\n * package. Existing transforms are not changed by this function. See\n * examples/wms-image-custom-proj for an example of this.\n *\n * Additional projection definitions can be registered with `proj4.defs()` any\n * time. Just make sure to call `register(proj4)` again; for example, with user-supplied data where you don't\n * know in advance what projections are needed, you can initially load minimal\n * support and then load whichever are requested.\n *\n * Note that Proj4js does not support projection extents. If you want to add\n * one for creating default tile grids, you can add it after the Projection\n * object has been created with `setExtent`, for example,\n * `get('EPSG:1234').setExtent(extent)`.\n *\n * In addition to Proj4js support, any transform functions can be added with\n * {@link module:ol/proj~addCoordinateTransforms}. To use this, you must first create\n * a {@link module:ol/proj/Projection} object for the new projection and add it with\n * {@link module:ol/proj~addProjection}. You can then add the forward and inverse\n * functions with {@link module:ol/proj~addCoordinateTransforms}. See\n * examples/wms-custom-proj for an example of this.\n *\n * Note that if no transforms are needed and you only need to define the\n * projection, just add a {@link module:ol/proj/Projection} with\n * {@link module:ol/proj~addProjection}. See examples/wms-no-proj for an example of\n * this.\n */\nimport {getDistance} from './sphere.js';\nimport {applyTransform} from './extent.js';\nimport {modulo} from './math.js';\nimport {toEPSG4326, fromEPSG4326, PROJECTIONS as EPSG3857_PROJECTIONS} from './proj/epsg3857.js';\nimport {PROJECTIONS as EPSG4326_PROJECTIONS} from './proj/epsg4326.js';\nimport Projection from './proj/Projection.js';\nimport Units, {METERS_PER_UNIT} from './proj/Units.js';\nimport * as projections from './proj/projections.js';\nimport {add as addTransformFunc, clear as clearTransformFuncs, get as getTransformFunc} from './proj/transforms.js';\n\n\n/**\n * A projection as {@link module:ol/proj/Projection}, SRS identifier\n * string or undefined.\n * @typedef {module:ol/proj/Projection|string|undefined} ProjectionLike\n * @api\n */\n\n\n/**\n * A transform function accepts an array of input coordinate values, an optional\n * output array, and an optional dimension (default should be 2).  The function\n * transforms the input coordinate values, populates the output array, and\n * returns the output array.\n *\n * @typedef {function(Array.<number>, Array.<number>=, number=): Array.<number>} TransformFunction\n * @api\n */\n\n\nexport {METERS_PER_UNIT};\n\n\n/**\n * @param {Array.<number>} input Input coordinate array.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array.<number>} Output coordinate array (new array, same coordinate\n *     values).\n */\nexport function cloneTransform(input, opt_output, opt_dimension) {\n  let output;\n  if (opt_output !== undefined) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    output = opt_output;\n  } else {\n    output = input.slice();\n  }\n  return output;\n}\n\n\n/**\n * @param {Array.<number>} input Input coordinate array.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array.<number>} Input coordinate array (same array as input).\n */\nexport function identityTransform(input, opt_output, opt_dimension) {\n  if (opt_output !== undefined && input !== opt_output) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    input = opt_output;\n  }\n  return input;\n}\n\n\n/**\n * Add a Projection object to the list of supported projections that can be\n * looked up by their code.\n *\n * @param {module:ol/proj/Projection} projection Projection instance.\n * @api\n */\nexport function addProjection(projection) {\n  projections.add(projection.getCode(), projection);\n  addTransformFunc(projection, projection, cloneTransform);\n}\n\n\n/**\n * @param {Array.<module:ol/proj/Projection>} projections Projections.\n */\nexport function addProjections(projections) {\n  projections.forEach(addProjection);\n}\n\n\n/**\n * Fetches a Projection object for the code specified.\n *\n * @param {module:ol/proj~ProjectionLike} projectionLike Either a code string which is\n *     a combination of authority and identifier such as \"EPSG:4326\", or an\n *     existing projection object, or undefined.\n * @return {module:ol/proj/Projection} Projection object, or null if not in list.\n * @api\n */\nexport function get(projectionLike) {\n  let projection = null;\n  if (projectionLike instanceof Projection) {\n    projection = projectionLike;\n  } else if (typeof projectionLike === 'string') {\n    const code = projectionLike;\n    projection = projections.get(code);\n  }\n  return projection;\n}\n\n\n/**\n * Get the resolution of the point in degrees or distance units.\n * For projections with degrees as the unit this will simply return the\n * provided resolution. For other projections the point resolution is\n * by default estimated by transforming the 'point' pixel to EPSG:4326,\n * measuring its width and height on the normal sphere,\n * and taking the average of the width and height.\n * A custom function can be provided for a specific projection, either\n * by setting the `getPointResolution` option in the\n * {@link module:ol/proj/Projection~Projection} constructor or by using\n * {@link module:ol/proj/Projection~Projection#setGetPointResolution} to change an existing\n * projection object.\n * @param {module:ol/proj~ProjectionLike} projection The projection.\n * @param {number} resolution Nominal resolution in projection units.\n * @param {module:ol/coordinate~Coordinate} point Point to find adjusted resolution at.\n * @param {module:ol/proj/Units=} opt_units Units to get the point resolution in.\n * Default is the projection's units.\n * @return {number} Point resolution.\n * @api\n */\nexport function getPointResolution(projection, resolution, point, opt_units) {\n  projection = get(projection);\n  let pointResolution;\n  const getter = projection.getPointResolutionFunc();\n  if (getter) {\n    pointResolution = getter(resolution, point);\n  } else {\n    const units = projection.getUnits();\n    if (units == Units.DEGREES && !opt_units || opt_units == Units.DEGREES) {\n      pointResolution = resolution;\n    } else {\n      // Estimate point resolution by transforming the center pixel to EPSG:4326,\n      // measuring its width and height on the normal sphere, and taking the\n      // average of the width and height.\n      const toEPSG4326 = getTransformFromProjections(projection, get('EPSG:4326'));\n      let vertices = [\n        point[0] - resolution / 2, point[1],\n        point[0] + resolution / 2, point[1],\n        point[0], point[1] - resolution / 2,\n        point[0], point[1] + resolution / 2\n      ];\n      vertices = toEPSG4326(vertices, vertices, 2);\n      const width = getDistance(vertices.slice(0, 2), vertices.slice(2, 4));\n      const height = getDistance(vertices.slice(4, 6), vertices.slice(6, 8));\n      pointResolution = (width + height) / 2;\n      const metersPerUnit = opt_units ?\n        METERS_PER_UNIT[opt_units] :\n        projection.getMetersPerUnit();\n      if (metersPerUnit !== undefined) {\n        pointResolution /= metersPerUnit;\n      }\n    }\n  }\n  return pointResolution;\n}\n\n\n/**\n * Registers transformation functions that don't alter coordinates. Those allow\n * to transform between projections with equal meaning.\n *\n * @param {Array.<module:ol/proj/Projection>} projections Projections.\n * @api\n */\nexport function addEquivalentProjections(projections) {\n  addProjections(projections);\n  projections.forEach(function(source) {\n    projections.forEach(function(destination) {\n      if (source !== destination) {\n        addTransformFunc(source, destination, cloneTransform);\n      }\n    });\n  });\n}\n\n\n/**\n * Registers transformation functions to convert coordinates in any projection\n * in projection1 to any projection in projection2.\n *\n * @param {Array.<module:ol/proj/Projection>} projections1 Projections with equal\n *     meaning.\n * @param {Array.<module:ol/proj/Projection>} projections2 Projections with equal\n *     meaning.\n * @param {module:ol/proj~TransformFunction} forwardTransform Transformation from any\n *   projection in projection1 to any projection in projection2.\n * @param {module:ol/proj~TransformFunction} inverseTransform Transform from any projection\n *   in projection2 to any projection in projection1..\n */\nexport function addEquivalentTransforms(projections1, projections2, forwardTransform, inverseTransform) {\n  projections1.forEach(function(projection1) {\n    projections2.forEach(function(projection2) {\n      addTransformFunc(projection1, projection2, forwardTransform);\n      addTransformFunc(projection2, projection1, inverseTransform);\n    });\n  });\n}\n\n\n/**\n * Clear all cached projections and transforms.\n */\nexport function clearAllProjections() {\n  projections.clear();\n  clearTransformFuncs();\n}\n\n\n/**\n * @param {module:ol/proj/Projection|string|undefined} projection Projection.\n * @param {string} defaultCode Default code.\n * @return {module:ol/proj/Projection} Projection.\n */\nexport function createProjection(projection, defaultCode) {\n  if (!projection) {\n    return get(defaultCode);\n  } else if (typeof projection === 'string') {\n    return get(projection);\n  } else {\n    return (\n      /** @type {module:ol/proj/Projection} */ (projection)\n    );\n  }\n}\n\n\n/**\n * Creates a {@link module:ol/proj~TransformFunction} from a simple 2D coordinate transform\n * function.\n * @param {function(module:ol/coordinate~Coordinate): module:ol/coordinate~Coordinate} coordTransform Coordinate\n *     transform.\n * @return {module:ol/proj~TransformFunction} Transform function.\n */\nexport function createTransformFromCoordinateTransform(coordTransform) {\n  return (\n    /**\n     * @param {Array.<number>} input Input.\n     * @param {Array.<number>=} opt_output Output.\n     * @param {number=} opt_dimension Dimension.\n     * @return {Array.<number>} Output.\n     */\n    function(input, opt_output, opt_dimension) {\n      const length = input.length;\n      const dimension = opt_dimension !== undefined ? opt_dimension : 2;\n      const output = opt_output !== undefined ? opt_output : new Array(length);\n      for (let i = 0; i < length; i += dimension) {\n        const point = coordTransform([input[i], input[i + 1]]);\n        output[i] = point[0];\n        output[i + 1] = point[1];\n        for (let j = dimension - 1; j >= 2; --j) {\n          output[i + j] = input[i + j];\n        }\n      }\n      return output;\n    });\n}\n\n\n/**\n * Registers coordinate transform functions to convert coordinates between the\n * source projection and the destination projection.\n * The forward and inverse functions convert coordinate pairs; this function\n * converts these into the functions used internally which also handle\n * extents and coordinate arrays.\n *\n * @param {module:ol/proj~ProjectionLike} source Source projection.\n * @param {module:ol/proj~ProjectionLike} destination Destination projection.\n * @param {function(module:ol/coordinate~Coordinate): module:ol/coordinate~Coordinate} forward The forward transform\n *     function (that is, from the source projection to the destination\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @param {function(module:ol/coordinate~Coordinate): module:ol/coordinate~Coordinate} inverse The inverse transform\n *     function (that is, from the destination projection to the source\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @api\n */\nexport function addCoordinateTransforms(source, destination, forward, inverse) {\n  const sourceProj = get(source);\n  const destProj = get(destination);\n  addTransformFunc(sourceProj, destProj, createTransformFromCoordinateTransform(forward));\n  addTransformFunc(destProj, sourceProj, createTransformFromCoordinateTransform(inverse));\n}\n\n\n/**\n * Transforms a coordinate from longitude/latitude to a different projection.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate as longitude and latitude, i.e.\n *     an array with longitude as 1st and latitude as 2nd element.\n * @param {module:ol/proj~ProjectionLike=} opt_projection Target projection. The\n *     default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {module:ol/coordinate~Coordinate} Coordinate projected to the target projection.\n * @api\n */\nexport function fromLonLat(coordinate, opt_projection) {\n  return transform(coordinate, 'EPSG:4326',\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857');\n}\n\n\n/**\n * Transforms a coordinate to longitude/latitude.\n * @param {module:ol/coordinate~Coordinate} coordinate Projected coordinate.\n * @param {module:ol/proj~ProjectionLike=} opt_projection Projection of the coordinate.\n *     The default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {module:ol/coordinate~Coordinate} Coordinate as longitude and latitude, i.e. an array\n *     with longitude as 1st and latitude as 2nd element.\n * @api\n */\nexport function toLonLat(coordinate, opt_projection) {\n  const lonLat = transform(coordinate,\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857', 'EPSG:4326');\n  const lon = lonLat[0];\n  if (lon < -180 || lon > 180) {\n    lonLat[0] = modulo(lon + 180, 360) - 180;\n  }\n  return lonLat;\n}\n\n\n/**\n * Checks if two projections are the same, that is every coordinate in one\n * projection does represent the same geographic point as the same coordinate in\n * the other projection.\n *\n * @param {module:ol/proj/Projection} projection1 Projection 1.\n * @param {module:ol/proj/Projection} projection2 Projection 2.\n * @return {boolean} Equivalent.\n * @api\n */\nexport function equivalent(projection1, projection2) {\n  if (projection1 === projection2) {\n    return true;\n  }\n  const equalUnits = projection1.getUnits() === projection2.getUnits();\n  if (projection1.getCode() === projection2.getCode()) {\n    return equalUnits;\n  } else {\n    const transformFunc = getTransformFromProjections(projection1, projection2);\n    return transformFunc === cloneTransform && equalUnits;\n  }\n}\n\n\n/**\n * Searches in the list of transform functions for the function for converting\n * coordinates from the source projection to the destination projection.\n *\n * @param {module:ol/proj/Projection} sourceProjection Source Projection object.\n * @param {module:ol/proj/Projection} destinationProjection Destination Projection\n *     object.\n * @return {module:ol/proj~TransformFunction} Transform function.\n */\nexport function getTransformFromProjections(sourceProjection, destinationProjection) {\n  const sourceCode = sourceProjection.getCode();\n  const destinationCode = destinationProjection.getCode();\n  let transformFunc = getTransformFunc(sourceCode, destinationCode);\n  if (!transformFunc) {\n    transformFunc = identityTransform;\n  }\n  return transformFunc;\n}\n\n\n/**\n * Given the projection-like objects, searches for a transformation\n * function to convert a coordinates array from the source projection to the\n * destination projection.\n *\n * @param {module:ol/proj~ProjectionLike} source Source.\n * @param {module:ol/proj~ProjectionLike} destination Destination.\n * @return {module:ol/proj~TransformFunction} Transform function.\n * @api\n */\nexport function getTransform(source, destination) {\n  const sourceProjection = get(source);\n  const destinationProjection = get(destination);\n  return getTransformFromProjections(sourceProjection, destinationProjection);\n}\n\n\n/**\n * Transforms a coordinate from source projection to destination projection.\n * This returns a new coordinate (and does not modify the original).\n *\n * See {@link module:ol/proj~transformExtent} for extent transformation.\n * See the transform method of {@link module:ol/geom/Geometry~Geometry} and its\n * subclasses for geometry transforms.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/proj~ProjectionLike} source Source projection-like.\n * @param {module:ol/proj~ProjectionLike} destination Destination projection-like.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nexport function transform(coordinate, source, destination) {\n  const transformFunc = getTransform(source, destination);\n  return transformFunc(coordinate, undefined, coordinate.length);\n}\n\n\n/**\n * Transforms an extent from source projection to destination projection.  This\n * returns a new extent (and does not modify the original).\n *\n * @param {module:ol/extent~Extent} extent The extent to transform.\n * @param {module:ol/proj~ProjectionLike} source Source projection-like.\n * @param {module:ol/proj~ProjectionLike} destination Destination projection-like.\n * @return {module:ol/extent~Extent} The transformed extent.\n * @api\n */\nexport function transformExtent(extent, source, destination) {\n  const transformFunc = getTransform(source, destination);\n  return applyTransform(extent, transformFunc);\n}\n\n\n/**\n * Transforms the given point to the destination projection.\n *\n * @param {module:ol/coordinate~Coordinate} point Point.\n * @param {module:ol/proj/Projection} sourceProjection Source projection.\n * @param {module:ol/proj/Projection} destinationProjection Destination projection.\n * @return {module:ol/coordinate~Coordinate} Point.\n */\nexport function transformWithProjections(point, sourceProjection, destinationProjection) {\n  const transformFunc = getTransformFromProjections(sourceProjection, destinationProjection);\n  return transformFunc(point);\n}\n\n/**\n * Add transforms to and from EPSG:4326 and EPSG:3857.  This function is called\n * by when this module is executed and should only need to be called again after\n * `clearAllProjections()` is called (e.g. in tests).\n */\nexport function addCommon() {\n  // Add transformations that don't alter coordinates to convert within set of\n  // projections with equal meaning.\n  addEquivalentProjections(EPSG3857_PROJECTIONS);\n  addEquivalentProjections(EPSG4326_PROJECTIONS);\n  // Add transformations to convert EPSG:4326 like coordinates to EPSG:3857 like\n  // coordinates and back.\n  addEquivalentTransforms(EPSG4326_PROJECTIONS, EPSG3857_PROJECTIONS, fromEPSG4326, toEPSG4326);\n}\n\naddCommon();\n","/**\n * @module ol/proj/Projection\n */\nimport {METERS_PER_UNIT} from '../proj/Units.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} code The SRS identifier code, e.g. `EPSG:4326`.\n * @property {module:ol/proj/Units|string} [units] Units. Required unless a\n * proj4 projection is defined for `code`.\n * @property {module:ol/extent~Extent} [extent] The validity extent for the SRS.\n * @property {string} [axisOrientation='enu'] The axis orientation as specified in Proj4.\n * @property {boolean} [global=false] Whether the projection is valid for the whole globe.\n * @property {number} [metersPerUnit] The meters per unit for the SRS.\n * If not provided, the `units` are used to get the meters per unit from the {@link module:ol/proj/Units~METERS_PER_UNIT}\n * lookup table.\n * @property {module:ol/extent~Extent} [worldExtent] The world extent for the SRS.\n * @property {function(number, module:ol/coordinate~Coordinate):number} [getPointResolution]\n * Function to determine resolution at a point. The function is called with a\n * `{number}` view resolution and an `{module:ol/coordinate~Coordinate}` as arguments, and returns\n * the `{number}` resolution at the passed coordinate. If this is `undefined`,\n * the default {@link module:ol/proj#getPointResolution} function will be used.\n */\n\n\n/**\n * @classdesc\n * Projection definition class. One of these is created for each projection\n * supported in the application and stored in the {@link module:ol/proj} namespace.\n * You can use these in applications, but this is not required, as API params\n * and options use {@link module:ol/proj~ProjectionLike} which means the simple string\n * code will suffice.\n *\n * You can use {@link module:ol/proj~get} to retrieve the object for a particular\n * projection.\n *\n * The library includes definitions for `EPSG:4326` and `EPSG:3857`, together\n * with the following aliases:\n * * `EPSG:4326`: CRS:84, urn:ogc:def:crs:EPSG:6.6:4326,\n *     urn:ogc:def:crs:OGC:1.3:CRS84, urn:ogc:def:crs:OGC:2:84,\n *     http://www.opengis.net/gml/srs/epsg.xml#4326,\n *     urn:x-ogc:def:crs:EPSG:4326\n * * `EPSG:3857`: EPSG:102100, EPSG:102113, EPSG:900913,\n *     urn:ogc:def:crs:EPSG:6.18:3:3857,\n *     http://www.opengis.net/gml/srs/epsg.xml#3857\n *\n * If you use proj4js, aliases can be added using `proj4.defs()`; see\n * [documentation](https://github.com/proj4js/proj4js). To set an alternative\n * namespace for proj4, use {@link module:ol/proj~setProj4}.\n *\n * @constructor\n * @param {module:ol/proj/Projection~Options} options Projection options.\n * @struct\n * @api\n */\nconst Projection = function(options) {\n  /**\n   * @private\n   * @type {string}\n   */\n  this.code_ = options.code;\n\n  /**\n   * Units of projected coordinates. When set to `TILE_PIXELS`, a\n   * `this.extent_` and `this.worldExtent_` must be configured properly for each\n   * tile.\n   * @private\n   * @type {module:ol/proj/Units}\n   */\n  this.units_ = /** @type {module:ol/proj/Units} */ (options.units);\n\n  /**\n   * Validity extent of the projection in projected coordinates. For projections\n   * with `TILE_PIXELS` units, this is the extent of the tile in\n   * tile pixel space.\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = options.extent !== undefined ? options.extent : null;\n\n  /**\n   * Extent of the world in EPSG:4326. For projections with\n   * `TILE_PIXELS` units, this is the extent of the tile in\n   * projected coordinate space.\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.worldExtent_ = options.worldExtent !== undefined ?\n    options.worldExtent : null;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.axisOrientation_ = options.axisOrientation !== undefined ?\n    options.axisOrientation : 'enu';\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.global_ = options.global !== undefined ? options.global : false;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.canWrapX_ = !!(this.global_ && this.extent_);\n\n  /**\n   * @private\n   * @type {function(number, module:ol/coordinate~Coordinate):number|undefined}\n   */\n  this.getPointResolutionFunc_ = options.getPointResolution;\n\n  /**\n   * @private\n   * @type {module:ol/tilegrid/TileGrid}\n   */\n  this.defaultTileGrid_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.metersPerUnit_ = options.metersPerUnit;\n};\n\n\n/**\n * @return {boolean} The projection is suitable for wrapping the x-axis\n */\nProjection.prototype.canWrapX = function() {\n  return this.canWrapX_;\n};\n\n\n/**\n * Get the code for this projection, e.g. 'EPSG:4326'.\n * @return {string} Code.\n * @api\n */\nProjection.prototype.getCode = function() {\n  return this.code_;\n};\n\n\n/**\n * Get the validity extent for this projection.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nProjection.prototype.getExtent = function() {\n  return this.extent_;\n};\n\n\n/**\n * Get the units of this projection.\n * @return {module:ol/proj/Units} Units.\n * @api\n */\nProjection.prototype.getUnits = function() {\n  return this.units_;\n};\n\n\n/**\n * Get the amount of meters per unit of this projection.  If the projection is\n * not configured with `metersPerUnit` or a units identifier, the return is\n * `undefined`.\n * @return {number|undefined} Meters.\n * @api\n */\nProjection.prototype.getMetersPerUnit = function() {\n  return this.metersPerUnit_ || METERS_PER_UNIT[this.units_];\n};\n\n\n/**\n * Get the world extent for this projection.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nProjection.prototype.getWorldExtent = function() {\n  return this.worldExtent_;\n};\n\n\n/**\n * Get the axis orientation of this projection.\n * Example values are:\n * enu - the default easting, northing, elevation.\n * neu - northing, easting, up - useful for \"lat/long\" geographic coordinates,\n *     or south orientated transverse mercator.\n * wnu - westing, northing, up - some planetary coordinate systems have\n *     \"west positive\" coordinate systems\n * @return {string} Axis orientation.\n * @api\n */\nProjection.prototype.getAxisOrientation = function() {\n  return this.axisOrientation_;\n};\n\n\n/**\n * Is this projection a global projection which spans the whole world?\n * @return {boolean} Whether the projection is global.\n * @api\n */\nProjection.prototype.isGlobal = function() {\n  return this.global_;\n};\n\n\n/**\n* Set if the projection is a global projection which spans the whole world\n* @param {boolean} global Whether the projection is global.\n* @api\n*/\nProjection.prototype.setGlobal = function(global) {\n  this.global_ = global;\n  this.canWrapX_ = !!(global && this.extent_);\n};\n\n\n/**\n * @return {module:ol/tilegrid/TileGrid} The default tile grid.\n */\nProjection.prototype.getDefaultTileGrid = function() {\n  return this.defaultTileGrid_;\n};\n\n\n/**\n * @param {module:ol/tilegrid/TileGrid} tileGrid The default tile grid.\n */\nProjection.prototype.setDefaultTileGrid = function(tileGrid) {\n  this.defaultTileGrid_ = tileGrid;\n};\n\n\n/**\n * Set the validity extent for this projection.\n * @param {module:ol/extent~Extent} extent Extent.\n * @api\n */\nProjection.prototype.setExtent = function(extent) {\n  this.extent_ = extent;\n  this.canWrapX_ = !!(this.global_ && extent);\n};\n\n\n/**\n * Set the world extent for this projection.\n * @param {module:ol/extent~Extent} worldExtent World extent\n *     [minlon, minlat, maxlon, maxlat].\n * @api\n */\nProjection.prototype.setWorldExtent = function(worldExtent) {\n  this.worldExtent_ = worldExtent;\n};\n\n\n/**\n * Set the getPointResolution function (see {@link module:ol/proj~getPointResolution}\n * for this projection.\n * @param {function(number, module:ol/coordinate~Coordinate):number} func Function\n * @api\n */\nProjection.prototype.setGetPointResolution = function(func) {\n  this.getPointResolutionFunc_ = func;\n};\n\n\n/**\n * Get the custom point resolution function for this projection (if set).\n * @return {function(number, module:ol/coordinate~Coordinate):number|undefined} The custom point\n * resolution function (if set).\n */\nProjection.prototype.getPointResolutionFunc = function() {\n  return this.getPointResolutionFunc_;\n};\nexport default Projection;\n","/**\n * @module ol/proj/Units\n */\n\n/**\n * Projection units: `'degrees'`, `'ft'`, `'m'`, `'pixels'`, `'tile-pixels'` or\n * `'us-ft'`.\n * @enum {string}\n */\nconst Units = {\n  DEGREES: 'degrees',\n  FEET: 'ft',\n  METERS: 'm',\n  PIXELS: 'pixels',\n  TILE_PIXELS: 'tile-pixels',\n  USFEET: 'us-ft'\n};\n\n\n/**\n * Meters per unit lookup table.\n * @const\n * @type {Object.<module:ol/proj/Units, number>}\n * @api\n */\nexport const METERS_PER_UNIT = {};\n// use the radius of the Normal sphere\nMETERS_PER_UNIT[Units.DEGREES] = 2 * Math.PI * 6370997 / 360;\nMETERS_PER_UNIT[Units.FEET] = 0.3048;\nMETERS_PER_UNIT[Units.METERS] = 1;\nMETERS_PER_UNIT[Units.USFEET] = 1200 / 3937;\n\nexport default Units;\n","/**\n * @module ol/proj/epsg3857\n */\nimport {inherits} from '../index.js';\nimport {cosh} from '../math.js';\nimport Projection from '../proj/Projection.js';\nimport Units from '../proj/Units.js';\n\n\n/**\n * Radius of WGS84 sphere\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const HALF_SIZE = Math.PI * RADIUS;\n\n\n/**\n * @const\n * @type {module:ol/extent~Extent}\n */\nexport const EXTENT = [\n  -HALF_SIZE, -HALF_SIZE,\n  HALF_SIZE, HALF_SIZE\n];\n\n\n/**\n * @const\n * @type {module:ol/extent~Extent}\n */\nexport const WORLD_EXTENT = [-180, -85, 180, 85];\n\n\n/**\n * @classdesc\n * Projection object for web/spherical Mercator (EPSG:3857).\n *\n * @constructor\n * @extends {module:ol/proj/Projection}\n * @param {string} code Code.\n */\nfunction EPSG3857Projection(code) {\n  Projection.call(this, {\n    code: code,\n    units: Units.METERS,\n    extent: EXTENT,\n    global: true,\n    worldExtent: WORLD_EXTENT,\n    getPointResolution: function(resolution, point) {\n      return resolution / cosh(point[1] / RADIUS);\n    }\n  });\n}\ninherits(EPSG3857Projection, Projection);\n\n\n/**\n * Projections equal to EPSG:3857.\n *\n * @const\n * @type {Array.<module:ol/proj/Projection>}\n */\nexport const PROJECTIONS = [\n  new EPSG3857Projection('EPSG:3857'),\n  new EPSG3857Projection('EPSG:102100'),\n  new EPSG3857Projection('EPSG:102113'),\n  new EPSG3857Projection('EPSG:900913'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG:6.18:3:3857'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG::3857'),\n  new EPSG3857Projection('http://www.opengis.net/gml/srs/epsg.xml#3857')\n];\n\n\n/**\n * Transformation from EPSG:4326 to EPSG:3857.\n *\n * @param {Array.<number>} input Input array of coordinate values.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array.<number>} Output array of coordinate values.\n */\nexport function fromEPSG4326(input, opt_output, opt_dimension) {\n  const length = input.length;\n  const dimension = opt_dimension > 1 ? opt_dimension : 2;\n  let output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  const halfSize = HALF_SIZE;\n  for (let i = 0; i < length; i += dimension) {\n    output[i] = halfSize * input[i] / 180;\n    let y = RADIUS *\n        Math.log(Math.tan(Math.PI * (input[i + 1] + 90) / 360));\n    if (y > halfSize) {\n      y = halfSize;\n    } else if (y < -halfSize) {\n      y = -halfSize;\n    }\n    output[i + 1] = y;\n  }\n  return output;\n}\n\n\n/**\n * Transformation from EPSG:3857 to EPSG:4326.\n *\n * @param {Array.<number>} input Input array of coordinate values.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array.<number>} Output array of coordinate values.\n */\nexport function toEPSG4326(input, opt_output, opt_dimension) {\n  const length = input.length;\n  const dimension = opt_dimension > 1 ? opt_dimension : 2;\n  let output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  for (let i = 0; i < length; i += dimension) {\n    output[i] = 180 * input[i] / HALF_SIZE;\n    output[i + 1] = 360 * Math.atan(\n      Math.exp(input[i + 1] / RADIUS)) / Math.PI - 90;\n  }\n  return output;\n}\n","/**\n * @module ol/proj/epsg4326\n */\nimport {inherits} from '../index.js';\nimport Projection from '../proj/Projection.js';\nimport Units from '../proj/Units.js';\n\n\n/**\n * Semi-major radius of the WGS84 ellipsoid.\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n\n/**\n * Extent of the EPSG:4326 projection which is the whole world.\n *\n * @const\n * @type {module:ol/extent~Extent}\n */\nexport const EXTENT = [-180, -90, 180, 90];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const METERS_PER_UNIT = Math.PI * RADIUS / 180;\n\n\n/**\n * @classdesc\n * Projection object for WGS84 geographic coordinates (EPSG:4326).\n *\n * Note that OpenLayers does not strictly comply with the EPSG definition.\n * The EPSG registry defines 4326 as a CRS for Latitude,Longitude (y,x).\n * OpenLayers treats EPSG:4326 as a pseudo-projection, with x,y coordinates.\n *\n * @constructor\n * @extends {module:ol/proj/Projection}\n * @param {string} code Code.\n * @param {string=} opt_axisOrientation Axis orientation.\n */\nfunction EPSG4326Projection(code, opt_axisOrientation) {\n  Projection.call(this, {\n    code: code,\n    units: Units.DEGREES,\n    extent: EXTENT,\n    axisOrientation: opt_axisOrientation,\n    global: true,\n    metersPerUnit: METERS_PER_UNIT,\n    worldExtent: EXTENT\n  });\n}\ninherits(EPSG4326Projection, Projection);\n\n\n/**\n * Projections equal to EPSG:4326.\n *\n * @const\n * @type {Array.<module:ol/proj/Projection>}\n */\nexport const PROJECTIONS = [\n  new EPSG4326Projection('CRS:84'),\n  new EPSG4326Projection('EPSG:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG::4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG:6.6:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:1.3:CRS84'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:2:84'),\n  new EPSG4326Projection('http://www.opengis.net/gml/srs/epsg.xml#4326', 'neu'),\n  new EPSG4326Projection('urn:x-ogc:def:crs:EPSG:4326', 'neu')\n];\n","/**\n * @module ol/proj/projections\n */\n\n\n/**\n * @type {Object.<string, module:ol/proj/Projection>}\n */\nlet cache = {};\n\n\n/**\n * Clear the projections cache.\n */\nexport function clear() {\n  cache = {};\n}\n\n\n/**\n * Get a cached projection by code.\n * @param {string} code The code for the projection.\n * @return {module:ol/proj/Projection} The projection (if cached).\n */\nexport function get(code) {\n  return cache[code] || null;\n}\n\n\n/**\n * Add a projection to the cache.\n * @param {string} code The projection code.\n * @param {module:ol/proj/Projection} projection The projection to cache.\n */\nexport function add(code, projection) {\n  cache[code] = projection;\n}\n","/**\n * @module ol/proj/transforms\n */\nimport {isEmpty} from '../obj.js';\n\n\n/**\n * @private\n * @type {!Object.<string, Object.<string, module:ol/proj~TransformFunction>>}\n */\nlet transforms = {};\n\n\n/**\n * Clear the transform cache.\n */\nexport function clear() {\n  transforms = {};\n}\n\n\n/**\n * Registers a conversion function to convert coordinates from the source\n * projection to the destination projection.\n *\n * @param {module:ol/proj/Projection} source Source.\n * @param {module:ol/proj/Projection} destination Destination.\n * @param {module:ol/proj~TransformFunction} transformFn Transform.\n */\nexport function add(source, destination, transformFn) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  if (!(sourceCode in transforms)) {\n    transforms[sourceCode] = {};\n  }\n  transforms[sourceCode][destinationCode] = transformFn;\n}\n\n\n/**\n * Unregisters the conversion function to convert coordinates from the source\n * projection to the destination projection.  This method is used to clean up\n * cached transforms during testing.\n *\n * @param {module:ol/proj/Projection} source Source projection.\n * @param {module:ol/proj/Projection} destination Destination projection.\n * @return {module:ol/proj~TransformFunction} transformFn The unregistered transform.\n */\nexport function remove(source, destination) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  const transform = transforms[sourceCode][destinationCode];\n  delete transforms[sourceCode][destinationCode];\n  if (isEmpty(transforms[sourceCode])) {\n    delete transforms[sourceCode];\n  }\n  return transform;\n}\n\n\n/**\n * Get a transform given a source code and a destination code.\n * @param {string} sourceCode The code for the source projection.\n * @param {string} destinationCode The code for the destination projection.\n * @return {module:ol/proj~TransformFunction|undefined} The transform function (if found).\n */\nexport function get(sourceCode, destinationCode) {\n  let transform;\n  if (sourceCode in transforms && destinationCode in transforms[sourceCode]) {\n    transform = transforms[sourceCode][destinationCode];\n  }\n  return transform;\n}\n","/**\n * @module ol/render/Box\n */\n// FIXME add rotation\n\nimport {inherits} from '../index.js';\nimport Disposable from '../Disposable.js';\nimport Polygon from '../geom/Polygon.js';\n\n/**\n * @constructor\n * @extends {module:ol/Disposable}\n * @param {string} className CSS class name.\n */\nconst RenderBox = function(className) {\n\n  /**\n   * @type {module:ol/geom/Polygon}\n   * @private\n   */\n  this.geometry_ = null;\n\n  /**\n   * @type {HTMLDivElement}\n   * @private\n   */\n  this.element_ = /** @type {HTMLDivElement} */ (document.createElement('div'));\n  this.element_.style.position = 'absolute';\n  this.element_.className = 'ol-box ' + className;\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = null;\n\n  /**\n   * @private\n   * @type {module:ol~Pixel}\n   */\n  this.startPixel_ = null;\n\n  /**\n   * @private\n   * @type {module:ol~Pixel}\n   */\n  this.endPixel_ = null;\n\n};\n\ninherits(RenderBox, Disposable);\n\n\n/**\n * @inheritDoc\n */\nRenderBox.prototype.disposeInternal = function() {\n  this.setMap(null);\n};\n\n\n/**\n * @private\n */\nRenderBox.prototype.render_ = function() {\n  const startPixel = this.startPixel_;\n  const endPixel = this.endPixel_;\n  const px = 'px';\n  const style = this.element_.style;\n  style.left = Math.min(startPixel[0], endPixel[0]) + px;\n  style.top = Math.min(startPixel[1], endPixel[1]) + px;\n  style.width = Math.abs(endPixel[0] - startPixel[0]) + px;\n  style.height = Math.abs(endPixel[1] - startPixel[1]) + px;\n};\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n */\nRenderBox.prototype.setMap = function(map) {\n  if (this.map_) {\n    this.map_.getOverlayContainer().removeChild(this.element_);\n    const style = this.element_.style;\n    style.left = style.top = style.width = style.height = 'inherit';\n  }\n  this.map_ = map;\n  if (this.map_) {\n    this.map_.getOverlayContainer().appendChild(this.element_);\n  }\n};\n\n\n/**\n * @param {module:ol~Pixel} startPixel Start pixel.\n * @param {module:ol~Pixel} endPixel End pixel.\n */\nRenderBox.prototype.setPixels = function(startPixel, endPixel) {\n  this.startPixel_ = startPixel;\n  this.endPixel_ = endPixel;\n  this.createOrUpdateGeometry();\n  this.render_();\n};\n\n\n/**\n * Creates or updates the cached geometry.\n */\nRenderBox.prototype.createOrUpdateGeometry = function() {\n  const startPixel = this.startPixel_;\n  const endPixel = this.endPixel_;\n  const pixels = [\n    startPixel,\n    [startPixel[0], endPixel[1]],\n    endPixel,\n    [endPixel[0], startPixel[1]]\n  ];\n  const coordinates = pixels.map(this.map_.getCoordinateFromPixel, this.map_);\n  // close the polygon\n  coordinates[4] = coordinates[0].slice();\n  if (!this.geometry_) {\n    this.geometry_ = new Polygon([coordinates]);\n  } else {\n    this.geometry_.setCoordinates([coordinates]);\n  }\n};\n\n\n/**\n * @return {module:ol/geom/Polygon} Geometry.\n */\nRenderBox.prototype.getGeometry = function() {\n  return this.geometry_;\n};\nexport default RenderBox;\n","/**\n * @module ol/render/Event\n */\nimport {inherits} from '../index.js';\nimport Event from '../events/Event.js';\n\n/**\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/render/EventType} type Type.\n * @param {module:ol/render/VectorContext=} opt_vectorContext Vector context.\n * @param {module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n * @param {?CanvasRenderingContext2D=} opt_context Context.\n * @param {?module:ol/webgl/Context=} opt_glContext WebGL Context.\n */\nconst RenderEvent = function(\n  type, opt_vectorContext, opt_frameState, opt_context,\n  opt_glContext) {\n\n  Event.call(this, type);\n\n  /**\n   * For canvas, this is an instance of {@link module:ol/render/canvas/Immediate}.\n   * @type {module:ol/render/VectorContext|undefined}\n   * @api\n   */\n  this.vectorContext = opt_vectorContext;\n\n  /**\n   * An object representing the current render frame state.\n   * @type {module:ol/PluggableMap~FrameState|undefined}\n   * @api\n   */\n  this.frameState = opt_frameState;\n\n  /**\n   * Canvas context. Only available when a Canvas renderer is used, null\n   * otherwise.\n   * @type {CanvasRenderingContext2D|null|undefined}\n   * @api\n   */\n  this.context = opt_context;\n\n  /**\n   * WebGL context. Only available when a WebGL renderer is used, null\n   * otherwise.\n   * @type {module:ol/webgl/Context|null|undefined}\n   * @api\n   */\n  this.glContext = opt_glContext;\n\n};\n\ninherits(RenderEvent, Event);\nexport default RenderEvent;\n","/**\n * @module ol/render/EventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * @event module:ol/render/Event~RenderEvent#postcompose\n   * @api\n   */\n  POSTCOMPOSE: 'postcompose',\n  /**\n   * @event module:ol/render/Event~RenderEvent#precompose\n   * @api\n   */\n  PRECOMPOSE: 'precompose',\n  /**\n   * @event module:ol/render/Event~RenderEvent#render\n   * @api\n   */\n  RENDER: 'render'\n};\n","/**\n * @module ol/render/ReplayGroup\n */\n/**\n * Base class for replay groups.\n * @constructor\n * @abstract\n */\nconst ReplayGroup = function() {};\n\n\n/**\n * @abstract\n * @param {number|undefined} zIndex Z index.\n * @param {module:ol/render/ReplayType} replayType Replay type.\n * @return {module:ol/render/VectorContext} Replay.\n */\nReplayGroup.prototype.getReplay = function(zIndex, replayType) {};\n\n\n/**\n * @abstract\n * @return {boolean} Is empty.\n */\nReplayGroup.prototype.isEmpty = function() {};\nexport default ReplayGroup;\n","/**\n * @module ol/render/ReplayType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CIRCLE: 'Circle',\n  DEFAULT: 'Default',\n  IMAGE: 'Image',\n  LINE_STRING: 'LineString',\n  POLYGON: 'Polygon',\n  TEXT: 'Text'\n};\n","/**\n * @module ol/render/VectorContext\n */\n/**\n * Context for drawing geometries.  A vector context is available on render\n * events and does not need to be constructed directly.\n * @constructor\n * @abstract\n * @struct\n * @api\n */\nconst VectorContext = function() {\n};\n\n\n/**\n * Render a geometry with a custom renderer.\n *\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {Function} renderer Renderer.\n */\nVectorContext.prototype.drawCustom = function(geometry, feature, renderer) {};\n\n\n/**\n * Render a geometry.\n *\n * @param {module:ol/geom/Geometry} geometry The geometry to render.\n */\nVectorContext.prototype.drawGeometry = function(geometry) {};\n\n\n/**\n * Set the rendering style.\n *\n * @param {module:ol/style/Style} style The rendering style.\n */\nVectorContext.prototype.setStyle = function(style) {};\n\n\n/**\n * @param {module:ol/geom/Circle} circleGeometry Circle geometry.\n * @param {module:ol/Feature} feature Feature.\n */\nVectorContext.prototype.drawCircle = function(circleGeometry, feature) {};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n */\nVectorContext.prototype.drawFeature = function(feature, style) {};\n\n\n/**\n * @param {module:ol/geom/GeometryCollection} geometryCollectionGeometry Geometry\n *     collection.\n * @param {module:ol/Feature} feature Feature.\n */\nVectorContext.prototype.drawGeometryCollection = function(geometryCollectionGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/LineString|module:ol/render/Feature} lineStringGeometry Line string geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawLineString = function(lineStringGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/MultiLineString|module:ol/render/Feature} multiLineStringGeometry MultiLineString geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawMultiLineString = function(multiLineStringGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/MultiPoint|module:ol/render/Feature} multiPointGeometry MultiPoint geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawMultiPoint = function(multiPointGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/MultiPolygon} multiPolygonGeometry MultiPolygon geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawMultiPolygon = function(multiPolygonGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/Point|module:ol/render/Feature} pointGeometry Point geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawPoint = function(pointGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/Polygon|module:ol/render/Feature} polygonGeometry Polygon geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawPolygon = function(polygonGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawText = function(geometry, feature) {};\n\n\n/**\n * @param {module:ol/style/Fill} fillStyle Fill style.\n * @param {module:ol/style/Stroke} strokeStyle Stroke style.\n */\nVectorContext.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {};\n\n\n/**\n * @param {module:ol/style/Image} imageStyle Image style.\n * @param {module:ol/render/canvas~DeclutterGroup=} opt_declutterGroup Declutter.\n */\nVectorContext.prototype.setImageStyle = function(imageStyle, opt_declutterGroup) {};\n\n\n/**\n * @param {module:ol/style/Text} textStyle Text style.\n * @param {module:ol/render/canvas~DeclutterGroup=} opt_declutterGroup Declutter.\n */\nVectorContext.prototype.setTextStyle = function(textStyle, opt_declutterGroup) {};\nexport default VectorContext;\n","/**\n * @module ol/render/canvas\n */\nimport {getFontFamilies} from '../css.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {clear} from '../obj.js';\nimport LRUCache from '../structs/LRUCache.js';\nimport {create as createTransform} from '../transform.js';\n\n\n/**\n * @typedef {Object} FillState\n * @property {module:ol/colorlike~ColorLike} fillStyle\n */\n\n\n/**\n * @typedef {Object} FillStrokeState\n * @property {module:ol/colorlike~ColorLike} [currentFillStyle]\n * @property {module:ol/colorlike~ColorLike} [currentStrokeStyle]\n * @property {string} [currentLineCap]\n * @property {Array.<number>} currentLineDash\n * @property {number} [currentLineDashOffset]\n * @property {string} [currentLineJoin]\n * @property {number} [currentLineWidth]\n * @property {number} [currentMiterLimit]\n * @property {number} [lastStroke]\n * @property {module:ol/colorlike~ColorLike} [fillStyle]\n * @property {module:ol/colorlike~ColorLike} [strokeStyle]\n * @property {string} [lineCap]\n * @property {Array.<number>} lineDash\n * @property {number} [lineDashOffset]\n * @property {string} [lineJoin]\n * @property {number} [lineWidth]\n * @property {number} [miterLimit]\n */\n\n\n/**\n * @typedef {Object} StrokeState\n * @property {string} lineCap\n * @property {Array.<number>} lineDash\n * @property {number} lineDashOffset\n * @property {string} lineJoin\n * @property {number} lineWidth\n * @property {number} miterLimit\n * @property {module:ol/colorlike~ColorLike} strokeStyle\n */\n\n\n/**\n * @typedef {Object} TextState\n * @property {string} font\n * @property {string} [textAlign]\n * @property {string} textBaseline\n */\n\n\n/**\n * Container for decluttered replay instructions that need to be rendered or\n * omitted together, i.e. when styles render both an image and text, or for the\n * characters that form text along lines. The basic elements of this array are\n * `[minX, minY, maxX, maxY, count]`, where the first four entries are the\n * rendered extent of the group in pixel space. `count` is the number of styles\n * in the group, i.e. 2 when an image and a text are grouped, or 1 otherwise.\n * In addition to these four elements, declutter instruction arrays (i.e. the\n * arguments to {@link module:ol/render/canvas~drawImage} are appended to the array.\n * @typedef {Array.<*>} DeclutterGroup\n */\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultFont = '10px sans-serif';\n\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const defaultFillStyle = [0, 0, 0, 1];\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultLineCap = 'round';\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nexport const defaultLineDash = [];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultLineDashOffset = 0;\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultLineJoin = 'round';\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultMiterLimit = 10;\n\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const defaultStrokeStyle = [0, 0, 0, 1];\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultTextAlign = 'center';\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultTextBaseline = 'middle';\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nexport const defaultPadding = [0, 0, 0, 0];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultLineWidth = 1;\n\n\n/**\n * The label cache for text rendering. To change the default cache size of 2048\n * entries, use {@link module:ol/structs/LRUCache#setSize}.\n * @type {module:ol/structs/LRUCache.<HTMLCanvasElement>}\n * @api\n */\nexport const labelCache = new LRUCache();\n\n\n/**\n * @type {!Object.<string, number>}\n */\nexport const checkedFonts = {};\n\n\n/**\n * @type {CanvasRenderingContext2D}\n */\nlet measureContext = null;\n\n\n/**\n * @type {!Object.<string, number>}\n */\nexport const textHeights = {};\n\n\n/**\n * Clears the label cache when a font becomes available.\n * @param {string} fontSpec CSS font spec.\n */\nexport const checkFont = (function() {\n  const retries = 60;\n  const checked = checkedFonts;\n  const size = '32px ';\n  const referenceFonts = ['monospace', 'serif'];\n  const len = referenceFonts.length;\n  const text = 'wmytzilWMYTZIL@#/&?$%10\\uF013';\n  let interval, referenceWidth;\n\n  function isAvailable(font) {\n    const context = getMeasureContext();\n    let available = true;\n    for (let i = 0; i < len; ++i) {\n      const referenceFont = referenceFonts[i];\n      context.font = size + referenceFont;\n      referenceWidth = context.measureText(text).width;\n      if (font != referenceFont) {\n        context.font = size + font + ',' + referenceFont;\n        const width = context.measureText(text).width;\n        // If width and referenceWidth are the same, then the fallback was used\n        // instead of the font we wanted, so the font is not available.\n        available = available && width != referenceWidth;\n      }\n    }\n    return available;\n  }\n\n  function check() {\n    let done = true;\n    for (const font in checked) {\n      if (checked[font] < retries) {\n        if (isAvailable(font)) {\n          checked[font] = retries;\n          clear(textHeights);\n          // Make sure that loaded fonts are picked up by Safari\n          measureContext = null;\n          labelCache.clear();\n        } else {\n          ++checked[font];\n          done = false;\n        }\n      }\n    }\n    if (done) {\n      clearInterval(interval);\n      interval = undefined;\n    }\n  }\n\n  return function(fontSpec) {\n    const fontFamilies = getFontFamilies(fontSpec);\n    if (!fontFamilies) {\n      return;\n    }\n    for (let i = 0, ii = fontFamilies.length; i < ii; ++i) {\n      const fontFamily = fontFamilies[i];\n      if (!(fontFamily in checked)) {\n        checked[fontFamily] = retries;\n        if (!isAvailable(fontFamily)) {\n          checked[fontFamily] = 0;\n          if (interval === undefined) {\n            interval = setInterval(check, 32);\n          }\n        }\n      }\n    }\n  };\n})();\n\n\n/**\n * @return {CanvasRenderingContext2D} Measure context.\n */\nfunction getMeasureContext() {\n  if (!measureContext) {\n    measureContext = createCanvasContext2D(1, 1);\n  }\n  return measureContext;\n}\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @return {module:ol/size~Size} Measurement.\n */\nexport const measureTextHeight = (function() {\n  let span;\n  const heights = textHeights;\n  return function(font) {\n    let height = heights[font];\n    if (height == undefined) {\n      if (!span) {\n        span = document.createElement('span');\n        span.textContent = 'M';\n        span.style.margin = span.style.padding = '0 !important';\n        span.style.position = 'absolute !important';\n        span.style.left = '-99999px !important';\n      }\n      span.style.font = font;\n      document.body.appendChild(span);\n      height = heights[font] = span.offsetHeight;\n      document.body.removeChild(span);\n    }\n    return height;\n  };\n})();\n\n\n/**\n * @param {string} font Font.\n * @param {string} text Text.\n * @return {number} Width.\n */\nexport function measureTextWidth(font, text) {\n  const measureContext = getMeasureContext();\n  if (font != measureContext.font) {\n    measureContext.font = font;\n  }\n  return measureContext.measureText(text).width;\n}\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n * @param {number} offsetX X offset.\n * @param {number} offsetY Y offset.\n */\nexport function rotateAtOffset(context, rotation, offsetX, offsetY) {\n  if (rotation !== 0) {\n    context.translate(offsetX, offsetY);\n    context.rotate(rotation);\n    context.translate(-offsetX, -offsetY);\n  }\n}\n\n\nexport const resetTransform = createTransform();\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform|null} transform Transform.\n * @param {number} opacity Opacity.\n * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n * @param {number} originX Origin X.\n * @param {number} originY Origin Y.\n * @param {number} w Width.\n * @param {number} h Height.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} scale Scale.\n */\nexport function drawImage(context,\n  transform, opacity, image, originX, originY, w, h, x, y, scale) {\n  let alpha;\n  if (opacity != 1) {\n    alpha = context.globalAlpha;\n    context.globalAlpha = alpha * opacity;\n  }\n  if (transform) {\n    context.setTransform.apply(context, transform);\n  }\n\n  context.drawImage(image, originX, originY, w, h, x, y, w * scale, h * scale);\n\n  if (alpha) {\n    context.globalAlpha = alpha;\n  }\n  if (transform) {\n    context.setTransform.apply(context, resetTransform);\n  }\n}\n","/**\n * @module ol/render/canvas/ImageReplay\n */\nimport {inherits} from '../../index.js';\nimport CanvasInstruction from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasImageReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas~DeclutterGroup}\n   */\n  this.declutterGroup_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLVideoElement|Image}\n   */\n  this.hitDetectionImage_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLVideoElement|Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.anchorX_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.anchorY_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.height_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.opacity_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.originX_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.originY_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.rotateWithView_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.scale_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.snapToPixel_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.width_ = undefined;\n\n};\n\ninherits(CanvasImageReplay, CanvasReplay);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n * @return {number} My end.\n */\nCanvasImageReplay.prototype.drawCoordinates_ = function(flatCoordinates, offset, end, stride) {\n  return this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.drawPoint = function(pointGeometry, feature) {\n  if (!this.image_) {\n    return;\n  }\n  this.beginGeometry(pointGeometry, feature);\n  const flatCoordinates = pointGeometry.getFlatCoordinates();\n  const stride = pointGeometry.getStride();\n  const myBegin = this.coordinates.length;\n  const myEnd = this.drawCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n  this.instructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_ * this.pixelRatio, this.snapToPixel_, this.width_\n  ]);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_, this.snapToPixel_, this.width_\n  ]);\n  this.endGeometry(pointGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.drawMultiPoint = function(multiPointGeometry, feature) {\n  if (!this.image_) {\n    return;\n  }\n  this.beginGeometry(multiPointGeometry, feature);\n  const flatCoordinates = multiPointGeometry.getFlatCoordinates();\n  const stride = multiPointGeometry.getStride();\n  const myBegin = this.coordinates.length;\n  const myEnd = this.drawCoordinates_(\n    flatCoordinates, 0, flatCoordinates.length, stride);\n  this.instructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_ * this.pixelRatio, this.snapToPixel_, this.width_\n  ]);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_, this.snapToPixel_, this.width_\n  ]);\n  this.endGeometry(multiPointGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.finish = function() {\n  this.reverseHitDetectionInstructions();\n  // FIXME this doesn't really protect us against further calls to draw*Geometry\n  this.anchorX_ = undefined;\n  this.anchorY_ = undefined;\n  this.hitDetectionImage_ = null;\n  this.image_ = null;\n  this.height_ = undefined;\n  this.scale_ = undefined;\n  this.opacity_ = undefined;\n  this.originX_ = undefined;\n  this.originY_ = undefined;\n  this.rotateWithView_ = undefined;\n  this.rotation_ = undefined;\n  this.snapToPixel_ = undefined;\n  this.width_ = undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.setImageStyle = function(imageStyle, declutterGroup) {\n  const anchor = imageStyle.getAnchor();\n  const size = imageStyle.getSize();\n  const hitDetectionImage = imageStyle.getHitDetectionImage(1);\n  const image = imageStyle.getImage(1);\n  const origin = imageStyle.getOrigin();\n  this.anchorX_ = anchor[0];\n  this.anchorY_ = anchor[1];\n  this.declutterGroup_ = /** @type {module:ol/render/canvas~DeclutterGroup} */ (declutterGroup);\n  this.hitDetectionImage_ = hitDetectionImage;\n  this.image_ = image;\n  this.height_ = size[1];\n  this.opacity_ = imageStyle.getOpacity();\n  this.originX_ = origin[0];\n  this.originY_ = origin[1];\n  this.rotateWithView_ = imageStyle.getRotateWithView();\n  this.rotation_ = imageStyle.getRotation();\n  this.scale_ = imageStyle.getScale();\n  this.snapToPixel_ = imageStyle.getSnapToPixel();\n  this.width_ = size[0];\n};\nexport default CanvasImageReplay;\n","/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\n\nimport {inherits} from '../../index.js';\nimport {equals} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {intersects} from '../../extent.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {transformGeom2D} from '../../geom/SimpleGeometry.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport VectorContext from '../VectorContext.js';\nimport {defaultTextAlign, defaultFillStyle, defaultLineCap, defaultLineDash, defaultLineDashOffset, defaultLineJoin, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline, defaultFont} from '../canvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n *\n * @constructor\n * @extends {module:ol/render/VectorContext}\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @struct\n */\nconst CanvasImmediateRenderer = function(context, pixelRatio, extent, transform, viewRotation) {\n  VectorContext.call(this);\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context_ = context;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = extent;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.transform_ = transform;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.viewRotation_ = viewRotation;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.contextFillState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.contextStrokeState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~TextState}\n   */\n  this.contextTextState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.fillState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.strokeState_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLVideoElement|Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageAnchorX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageAnchorY_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageHeight_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageOpacity_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageOriginX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageOriginY_ = 0;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.imageRotateWithView_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageRotation_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageScale_ = 0;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.imageSnapToPixel_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageWidth_ = 0;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.text_ = '';\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetY_ = 0;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.textRotateWithView_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textRotation_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textScale_ = 0;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.textFillState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.textStrokeState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~TextState}\n   */\n  this.textState_ = null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.pixelCoordinates_ = [];\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.tmpLocalTransform_ = createTransform();\n\n};\n\ninherits(CanvasImmediateRenderer, VectorContext);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n */\nCanvasImmediateRenderer.prototype.drawImages_ = function(flatCoordinates, offset, end, stride) {\n  if (!this.image_) {\n    return;\n  }\n  const pixelCoordinates = transform2D(\n    flatCoordinates, offset, end, 2, this.transform_,\n    this.pixelCoordinates_);\n  const context = this.context_;\n  const localTransform = this.tmpLocalTransform_;\n  const alpha = context.globalAlpha;\n  if (this.imageOpacity_ != 1) {\n    context.globalAlpha = alpha * this.imageOpacity_;\n  }\n  let rotation = this.imageRotation_;\n  if (this.imageRotateWithView_) {\n    rotation += this.viewRotation_;\n  }\n  for (let i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n    let x = pixelCoordinates[i] - this.imageAnchorX_;\n    let y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n    if (this.imageSnapToPixel_) {\n      x = Math.round(x);\n      y = Math.round(y);\n    }\n    if (rotation !== 0 || this.imageScale_ != 1) {\n      const centerX = x + this.imageAnchorX_;\n      const centerY = y + this.imageAnchorY_;\n      composeTransform(localTransform,\n        centerX, centerY,\n        this.imageScale_, this.imageScale_,\n        rotation,\n        -centerX, -centerY);\n      context.setTransform.apply(context, localTransform);\n    }\n    context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_,\n      this.imageWidth_, this.imageHeight_, x, y,\n      this.imageWidth_, this.imageHeight_);\n  }\n  if (rotation !== 0 || this.imageScale_ != 1) {\n    context.setTransform(1, 0, 0, 1, 0, 0);\n  }\n  if (this.imageOpacity_ != 1) {\n    context.globalAlpha = alpha;\n  }\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n */\nCanvasImmediateRenderer.prototype.drawText_ = function(flatCoordinates, offset, end, stride) {\n  if (!this.textState_ || this.text_ === '') {\n    return;\n  }\n  if (this.textFillState_) {\n    this.setContextFillState_(this.textFillState_);\n  }\n  if (this.textStrokeState_) {\n    this.setContextStrokeState_(this.textStrokeState_);\n  }\n  this.setContextTextState_(this.textState_);\n  const pixelCoordinates = transform2D(\n    flatCoordinates, offset, end, stride, this.transform_,\n    this.pixelCoordinates_);\n  const context = this.context_;\n  let rotation = this.textRotation_;\n  if (this.textRotateWithView_) {\n    rotation += this.viewRotation_;\n  }\n  for (; offset < end; offset += stride) {\n    const x = pixelCoordinates[offset] + this.textOffsetX_;\n    const y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n    if (rotation !== 0 || this.textScale_ != 1) {\n      const localTransform = composeTransform(this.tmpLocalTransform_,\n        x, y,\n        this.textScale_, this.textScale_,\n        rotation,\n        -x, -y);\n      context.setTransform.apply(context, localTransform);\n    }\n    if (this.textStrokeState_) {\n      context.strokeText(this.text_, x, y);\n    }\n    if (this.textFillState_) {\n      context.fillText(this.text_, x, y);\n    }\n  }\n  if (rotation !== 0 || this.textScale_ != 1) {\n    context.setTransform(1, 0, 0, 1, 0, 0);\n  }\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {boolean} close Close.\n * @private\n * @return {number} end End.\n */\nCanvasImmediateRenderer.prototype.moveToLineTo_ = function(flatCoordinates, offset, end, stride, close) {\n  const context = this.context_;\n  const pixelCoordinates = transform2D(\n    flatCoordinates, offset, end, stride, this.transform_,\n    this.pixelCoordinates_);\n  context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n  let length = pixelCoordinates.length;\n  if (close) {\n    length -= 2;\n  }\n  for (let i = 2; i < length; i += 2) {\n    context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n  }\n  if (close) {\n    context.closePath();\n  }\n  return end;\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @private\n * @return {number} End.\n */\nCanvasImmediateRenderer.prototype.drawRings_ = function(flatCoordinates, offset, ends, stride) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, true);\n  }\n  return offset;\n};\n\n\n/**\n * Render a circle geometry into the canvas.  Rendering is immediate and uses\n * the current fill and stroke styles.\n *\n * @param {module:ol/geom/Circle} geometry Circle geometry.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.drawCircle = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.fillState_ || this.strokeState_) {\n    if (this.fillState_) {\n      this.setContextFillState_(this.fillState_);\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n    }\n    const pixelCoordinates = transformGeom2D(\n      geometry, this.transform_, this.pixelCoordinates_);\n    const dx = pixelCoordinates[2] - pixelCoordinates[0];\n    const dy = pixelCoordinates[3] - pixelCoordinates[1];\n    const radius = Math.sqrt(dx * dx + dy * dy);\n    const context = this.context_;\n    context.beginPath();\n    context.arc(\n      pixelCoordinates[0], pixelCoordinates[1], radius, 0, 2 * Math.PI);\n    if (this.fillState_) {\n      context.fill();\n    }\n    if (this.strokeState_) {\n      context.stroke();\n    }\n  }\n  if (this.text_ !== '') {\n    this.drawText_(geometry.getCenter(), 0, 2, 2);\n  }\n};\n\n\n/**\n * Set the rendering style.  Note that since this is an immediate rendering API,\n * any `zIndex` on the provided style will be ignored.\n *\n * @param {module:ol/style/Style} style The rendering style.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.setStyle = function(style) {\n  this.setFillStrokeStyle(style.getFill(), style.getStroke());\n  this.setImageStyle(style.getImage());\n  this.setTextStyle(style.getText());\n};\n\n\n/**\n * Render a geometry into the canvas.  Call\n * {@link module:ol/render/canvas/Immediate#setStyle} first to set the rendering style.\n *\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry The geometry to render.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.drawGeometry = function(geometry) {\n  const type = geometry.getType();\n  switch (type) {\n    case GeometryType.POINT:\n      this.drawPoint(/** @type {module:ol/geom/Point} */ (geometry));\n      break;\n    case GeometryType.LINE_STRING:\n      this.drawLineString(/** @type {module:ol/geom/LineString} */ (geometry));\n      break;\n    case GeometryType.POLYGON:\n      this.drawPolygon(/** @type {module:ol/geom/Polygon} */ (geometry));\n      break;\n    case GeometryType.MULTI_POINT:\n      this.drawMultiPoint(/** @type {module:ol/geom/MultiPoint} */ (geometry));\n      break;\n    case GeometryType.MULTI_LINE_STRING:\n      this.drawMultiLineString(/** @type {module:ol/geom/MultiLineString} */ (geometry));\n      break;\n    case GeometryType.MULTI_POLYGON:\n      this.drawMultiPolygon(/** @type {module:ol/geom/MultiPolygon} */ (geometry));\n      break;\n    case GeometryType.GEOMETRY_COLLECTION:\n      this.drawGeometryCollection(/** @type {module:ol/geom/GeometryCollection} */ (geometry));\n      break;\n    case GeometryType.CIRCLE:\n      this.drawCircle(/** @type {module:ol/geom/Circle} */ (geometry));\n      break;\n    default:\n  }\n};\n\n\n/**\n * Render a feature into the canvas.  Note that any `zIndex` on the provided\n * style will be ignored - features are rendered immediately in the order that\n * this method is called.  If you need `zIndex` support, you should be using an\n * {@link module:ol/layer/Vector~VectorLayer} instead.\n *\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.drawFeature = function(feature, style) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  this.setStyle(style);\n  this.drawGeometry(geometry);\n};\n\n\n/**\n * Render a GeometryCollection to the canvas.  Rendering is immediate and\n * uses the current styles appropriate for each geometry in the collection.\n *\n * @param {module:ol/geom/GeometryCollection} geometry Geometry collection.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawGeometryCollection = function(geometry) {\n  const geometries = geometry.getGeometriesArray();\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    this.drawGeometry(geometries[i]);\n  }\n};\n\n\n/**\n * Render a Point geometry into the canvas.  Rendering is immediate and uses\n * the current style.\n *\n * @param {module:ol/geom/Point|module:ol/render/Feature} geometry Point geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawPoint = function(geometry) {\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const stride = geometry.getStride();\n  if (this.image_) {\n    this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n  if (this.text_ !== '') {\n    this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n};\n\n\n/**\n * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n * uses the current style.\n *\n * @param {module:ol/geom/MultiPoint|module:ol/render/Feature} geometry MultiPoint geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawMultiPoint = function(geometry) {\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const stride = geometry.getStride();\n  if (this.image_) {\n    this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n  if (this.text_ !== '') {\n    this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n};\n\n\n/**\n * Render a LineString into the canvas.  Rendering is immediate and uses\n * the current style.\n *\n * @param {module:ol/geom/LineString|module:ol/render/Feature} geometry LineString geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawLineString = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.strokeState_) {\n    this.setContextStrokeState_(this.strokeState_);\n    const context = this.context_;\n    const flatCoordinates = geometry.getFlatCoordinates();\n    context.beginPath();\n    this.moveToLineTo_(flatCoordinates, 0, flatCoordinates.length,\n      geometry.getStride(), false);\n    context.stroke();\n  }\n  if (this.text_ !== '') {\n    const flatMidpoint = geometry.getFlatMidpoint();\n    this.drawText_(flatMidpoint, 0, 2, 2);\n  }\n};\n\n\n/**\n * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n * and uses the current style.\n *\n * @param {module:ol/geom/MultiLineString|module:ol/render/Feature} geometry MultiLineString geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawMultiLineString = function(geometry) {\n  const geometryExtent = geometry.getExtent();\n  if (!intersects(this.extent_, geometryExtent)) {\n    return;\n  }\n  if (this.strokeState_) {\n    this.setContextStrokeState_(this.strokeState_);\n    const context = this.context_;\n    const flatCoordinates = geometry.getFlatCoordinates();\n    let offset = 0;\n    const ends = geometry.getEnds();\n    const stride = geometry.getStride();\n    context.beginPath();\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, false);\n    }\n    context.stroke();\n  }\n  if (this.text_ !== '') {\n    const flatMidpoints = geometry.getFlatMidpoints();\n    this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n  }\n};\n\n\n/**\n * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n * the current style.\n *\n * @param {module:ol/geom/Polygon|module:ol/render/Feature} geometry Polygon geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawPolygon = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.strokeState_ || this.fillState_) {\n    if (this.fillState_) {\n      this.setContextFillState_(this.fillState_);\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n    }\n    const context = this.context_;\n    context.beginPath();\n    this.drawRings_(geometry.getOrientedFlatCoordinates(),\n      0, geometry.getEnds(), geometry.getStride());\n    if (this.fillState_) {\n      context.fill();\n    }\n    if (this.strokeState_) {\n      context.stroke();\n    }\n  }\n  if (this.text_ !== '') {\n    const flatInteriorPoint = geometry.getFlatInteriorPoint();\n    this.drawText_(flatInteriorPoint, 0, 2, 2);\n  }\n};\n\n\n/**\n * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n * uses the current style.\n * @param {module:ol/geom/MultiPolygon} geometry MultiPolygon geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawMultiPolygon = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.strokeState_ || this.fillState_) {\n    if (this.fillState_) {\n      this.setContextFillState_(this.fillState_);\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n    }\n    const context = this.context_;\n    const flatCoordinates = geometry.getOrientedFlatCoordinates();\n    let offset = 0;\n    const endss = geometry.getEndss();\n    const stride = geometry.getStride();\n    context.beginPath();\n    for (let i = 0, ii = endss.length; i < ii; ++i) {\n      const ends = endss[i];\n      offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n    }\n    if (this.fillState_) {\n      context.fill();\n    }\n    if (this.strokeState_) {\n      context.stroke();\n    }\n  }\n  if (this.text_ !== '') {\n    const flatInteriorPoints = geometry.getFlatInteriorPoints();\n    this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillState} fillState Fill state.\n * @private\n */\nCanvasImmediateRenderer.prototype.setContextFillState_ = function(fillState) {\n  const context = this.context_;\n  const contextFillState = this.contextFillState_;\n  if (!contextFillState) {\n    context.fillStyle = fillState.fillStyle;\n    this.contextFillState_ = {\n      fillStyle: fillState.fillStyle\n    };\n  } else {\n    if (contextFillState.fillStyle != fillState.fillStyle) {\n      contextFillState.fillStyle = context.fillStyle = fillState.fillStyle;\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~StrokeState} strokeState Stroke state.\n * @private\n */\nCanvasImmediateRenderer.prototype.setContextStrokeState_ = function(strokeState) {\n  const context = this.context_;\n  const contextStrokeState = this.contextStrokeState_;\n  if (!contextStrokeState) {\n    context.lineCap = strokeState.lineCap;\n    if (CANVAS_LINE_DASH) {\n      context.setLineDash(strokeState.lineDash);\n      context.lineDashOffset = strokeState.lineDashOffset;\n    }\n    context.lineJoin = strokeState.lineJoin;\n    context.lineWidth = strokeState.lineWidth;\n    context.miterLimit = strokeState.miterLimit;\n    context.strokeStyle = strokeState.strokeStyle;\n    this.contextStrokeState_ = {\n      lineCap: strokeState.lineCap,\n      lineDash: strokeState.lineDash,\n      lineDashOffset: strokeState.lineDashOffset,\n      lineJoin: strokeState.lineJoin,\n      lineWidth: strokeState.lineWidth,\n      miterLimit: strokeState.miterLimit,\n      strokeStyle: strokeState.strokeStyle\n    };\n  } else {\n    if (contextStrokeState.lineCap != strokeState.lineCap) {\n      contextStrokeState.lineCap = context.lineCap = strokeState.lineCap;\n    }\n    if (CANVAS_LINE_DASH) {\n      if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n        context.setLineDash(contextStrokeState.lineDash = strokeState.lineDash);\n      }\n      if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n        contextStrokeState.lineDashOffset = context.lineDashOffset =\n            strokeState.lineDashOffset;\n      }\n    }\n    if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n      contextStrokeState.lineJoin = context.lineJoin = strokeState.lineJoin;\n    }\n    if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n      contextStrokeState.lineWidth = context.lineWidth = strokeState.lineWidth;\n    }\n    if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n      contextStrokeState.miterLimit = context.miterLimit =\n          strokeState.miterLimit;\n    }\n    if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n      contextStrokeState.strokeStyle = context.strokeStyle =\n          strokeState.strokeStyle;\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~TextState} textState Text state.\n * @private\n */\nCanvasImmediateRenderer.prototype.setContextTextState_ = function(textState) {\n  const context = this.context_;\n  const contextTextState = this.contextTextState_;\n  const textAlign = textState.textAlign ?\n    textState.textAlign : defaultTextAlign;\n  if (!contextTextState) {\n    context.font = textState.font;\n    context.textAlign = textAlign;\n    context.textBaseline = textState.textBaseline;\n    this.contextTextState_ = {\n      font: textState.font,\n      textAlign: textAlign,\n      textBaseline: textState.textBaseline\n    };\n  } else {\n    if (contextTextState.font != textState.font) {\n      contextTextState.font = context.font = textState.font;\n    }\n    if (contextTextState.textAlign != textAlign) {\n      contextTextState.textAlign = context.textAlign = textAlign;\n    }\n    if (contextTextState.textBaseline != textState.textBaseline) {\n      contextTextState.textBaseline = context.textBaseline =\n          textState.textBaseline;\n    }\n  }\n};\n\n\n/**\n * Set the fill and stroke style for subsequent draw operations.  To clear\n * either fill or stroke styles, pass null for the appropriate parameter.\n *\n * @param {module:ol/style/Fill} fillStyle Fill style.\n * @param {module:ol/style/Stroke} strokeStyle Stroke style.\n * @override\n */\nCanvasImmediateRenderer.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  if (!fillStyle) {\n    this.fillState_ = null;\n  } else {\n    const fillStyleColor = fillStyle.getColor();\n    this.fillState_ = {\n      fillStyle: asColorLike(fillStyleColor ?\n        fillStyleColor : defaultFillStyle)\n    };\n  }\n  if (!strokeStyle) {\n    this.strokeState_ = null;\n  } else {\n    const strokeStyleColor = strokeStyle.getColor();\n    const strokeStyleLineCap = strokeStyle.getLineCap();\n    const strokeStyleLineDash = strokeStyle.getLineDash();\n    const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    const strokeStyleLineJoin = strokeStyle.getLineJoin();\n    const strokeStyleWidth = strokeStyle.getWidth();\n    const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n    this.strokeState_ = {\n      lineCap: strokeStyleLineCap !== undefined ?\n        strokeStyleLineCap : defaultLineCap,\n      lineDash: strokeStyleLineDash ?\n        strokeStyleLineDash : defaultLineDash,\n      lineDashOffset: strokeStyleLineDashOffset ?\n        strokeStyleLineDashOffset : defaultLineDashOffset,\n      lineJoin: strokeStyleLineJoin !== undefined ?\n        strokeStyleLineJoin : defaultLineJoin,\n      lineWidth: this.pixelRatio_ * (strokeStyleWidth !== undefined ?\n        strokeStyleWidth : defaultLineWidth),\n      miterLimit: strokeStyleMiterLimit !== undefined ?\n        strokeStyleMiterLimit : defaultMiterLimit,\n      strokeStyle: asColorLike(strokeStyleColor ?\n        strokeStyleColor : defaultStrokeStyle)\n    };\n  }\n};\n\n\n/**\n * Set the image style for subsequent draw operations.  Pass null to remove\n * the image style.\n *\n * @param {module:ol/style/Image} imageStyle Image style.\n * @override\n */\nCanvasImmediateRenderer.prototype.setImageStyle = function(imageStyle) {\n  if (!imageStyle) {\n    this.image_ = null;\n  } else {\n    const imageAnchor = imageStyle.getAnchor();\n    // FIXME pixel ratio\n    const imageImage = imageStyle.getImage(1);\n    const imageOrigin = imageStyle.getOrigin();\n    const imageSize = imageStyle.getSize();\n    this.imageAnchorX_ = imageAnchor[0];\n    this.imageAnchorY_ = imageAnchor[1];\n    this.imageHeight_ = imageSize[1];\n    this.image_ = imageImage;\n    this.imageOpacity_ = imageStyle.getOpacity();\n    this.imageOriginX_ = imageOrigin[0];\n    this.imageOriginY_ = imageOrigin[1];\n    this.imageRotateWithView_ = imageStyle.getRotateWithView();\n    this.imageRotation_ = imageStyle.getRotation();\n    this.imageScale_ = imageStyle.getScale() * this.pixelRatio_;\n    this.imageSnapToPixel_ = imageStyle.getSnapToPixel();\n    this.imageWidth_ = imageSize[0];\n  }\n};\n\n\n/**\n * Set the text style for subsequent draw operations.  Pass null to\n * remove the text style.\n *\n * @param {module:ol/style/Text} textStyle Text style.\n * @override\n */\nCanvasImmediateRenderer.prototype.setTextStyle = function(textStyle) {\n  if (!textStyle) {\n    this.text_ = '';\n  } else {\n    const textFillStyle = textStyle.getFill();\n    if (!textFillStyle) {\n      this.textFillState_ = null;\n    } else {\n      const textFillStyleColor = textFillStyle.getColor();\n      this.textFillState_ = {\n        fillStyle: asColorLike(textFillStyleColor ?\n          textFillStyleColor : defaultFillStyle)\n      };\n    }\n    const textStrokeStyle = textStyle.getStroke();\n    if (!textStrokeStyle) {\n      this.textStrokeState_ = null;\n    } else {\n      const textStrokeStyleColor = textStrokeStyle.getColor();\n      const textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n      const textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n      const textStrokeStyleLineDashOffset = textStrokeStyle.getLineDashOffset();\n      const textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n      const textStrokeStyleWidth = textStrokeStyle.getWidth();\n      const textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n      this.textStrokeState_ = {\n        lineCap: textStrokeStyleLineCap !== undefined ?\n          textStrokeStyleLineCap : defaultLineCap,\n        lineDash: textStrokeStyleLineDash ?\n          textStrokeStyleLineDash : defaultLineDash,\n        lineDashOffset: textStrokeStyleLineDashOffset ?\n          textStrokeStyleLineDashOffset : defaultLineDashOffset,\n        lineJoin: textStrokeStyleLineJoin !== undefined ?\n          textStrokeStyleLineJoin : defaultLineJoin,\n        lineWidth: textStrokeStyleWidth !== undefined ?\n          textStrokeStyleWidth : defaultLineWidth,\n        miterLimit: textStrokeStyleMiterLimit !== undefined ?\n          textStrokeStyleMiterLimit : defaultMiterLimit,\n        strokeStyle: asColorLike(textStrokeStyleColor ?\n          textStrokeStyleColor : defaultStrokeStyle)\n      };\n    }\n    const textFont = textStyle.getFont();\n    const textOffsetX = textStyle.getOffsetX();\n    const textOffsetY = textStyle.getOffsetY();\n    const textRotateWithView = textStyle.getRotateWithView();\n    const textRotation = textStyle.getRotation();\n    const textScale = textStyle.getScale();\n    const textText = textStyle.getText();\n    const textTextAlign = textStyle.getTextAlign();\n    const textTextBaseline = textStyle.getTextBaseline();\n    this.textState_ = {\n      font: textFont !== undefined ?\n        textFont : defaultFont,\n      textAlign: textTextAlign !== undefined ?\n        textTextAlign : defaultTextAlign,\n      textBaseline: textTextBaseline !== undefined ?\n        textTextBaseline : defaultTextBaseline\n    };\n    this.text_ = textText !== undefined ? textText : '';\n    this.textOffsetX_ =\n        textOffsetX !== undefined ? (this.pixelRatio_ * textOffsetX) : 0;\n    this.textOffsetY_ =\n        textOffsetY !== undefined ? (this.pixelRatio_ * textOffsetY) : 0;\n    this.textRotateWithView_ = textRotateWithView !== undefined ? textRotateWithView : false;\n    this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n    this.textScale_ = this.pixelRatio_ * (textScale !== undefined ?\n      textScale : 1);\n  }\n};\nexport default CanvasImmediateRenderer;\n","/**\n * @module ol/render/canvas/Instruction\n */\n\n/**\n * @enum {number}\n */\nconst Instruction = {\n  BEGIN_GEOMETRY: 0,\n  BEGIN_PATH: 1,\n  CIRCLE: 2,\n  CLOSE_PATH: 3,\n  CUSTOM: 4,\n  DRAW_CHARS: 5,\n  DRAW_IMAGE: 6,\n  END_GEOMETRY: 7,\n  FILL: 8,\n  MOVE_TO_LINE_TO: 9,\n  SET_FILL_STYLE: 10,\n  SET_STROKE_STYLE: 11,\n  STROKE: 12\n};\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const fillInstruction = [Instruction.FILL];\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const strokeInstruction = [Instruction.STROKE];\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const beginPathInstruction = [Instruction.BEGIN_PATH];\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const closePathInstruction = [Instruction.CLOSE_PATH];\n\n\nexport default Instruction;\n","/**\n * @module ol/render/canvas/LineStringReplay\n */\nimport {inherits} from '../../index.js';\nimport CanvasInstruction, {strokeInstruction, beginPathInstruction} from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasLineStringReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n};\n\ninherits(CanvasLineStringReplay, CanvasReplay);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n * @return {number} end.\n */\nCanvasLineStringReplay.prototype.drawFlatCoordinates_ = function(flatCoordinates, offset, end, stride) {\n  const myBegin = this.coordinates.length;\n  const myEnd = this.appendFlatCoordinates(\n    flatCoordinates, offset, end, stride, false, false);\n  const moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n  this.instructions.push(moveToLineToInstruction);\n  this.hitDetectionInstructions.push(moveToLineToInstruction);\n  return end;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasLineStringReplay.prototype.drawLineString = function(lineStringGeometry, feature) {\n  const state = this.state;\n  const strokeStyle = state.strokeStyle;\n  const lineWidth = state.lineWidth;\n  if (strokeStyle === undefined || lineWidth === undefined) {\n    return;\n  }\n  this.updateStrokeStyle(state, this.applyStroke);\n  this.beginGeometry(lineStringGeometry, feature);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_STROKE_STYLE,\n    state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n    state.miterLimit, state.lineDash, state.lineDashOffset\n  ], beginPathInstruction);\n  const flatCoordinates = lineStringGeometry.getFlatCoordinates();\n  const stride = lineStringGeometry.getStride();\n  this.drawFlatCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n  this.hitDetectionInstructions.push(strokeInstruction);\n  this.endGeometry(lineStringGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasLineStringReplay.prototype.drawMultiLineString = function(multiLineStringGeometry, feature) {\n  const state = this.state;\n  const strokeStyle = state.strokeStyle;\n  const lineWidth = state.lineWidth;\n  if (strokeStyle === undefined || lineWidth === undefined) {\n    return;\n  }\n  this.updateStrokeStyle(state, this.applyStroke);\n  this.beginGeometry(multiLineStringGeometry, feature);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_STROKE_STYLE,\n    state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n    state.miterLimit, state.lineDash, state.lineDashOffset\n  ], beginPathInstruction);\n  const ends = multiLineStringGeometry.getEnds();\n  const flatCoordinates = multiLineStringGeometry.getFlatCoordinates();\n  const stride = multiLineStringGeometry.getStride();\n  let offset = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    offset = this.drawFlatCoordinates_(flatCoordinates, offset, ends[i], stride);\n  }\n  this.hitDetectionInstructions.push(strokeInstruction);\n  this.endGeometry(multiLineStringGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasLineStringReplay.prototype.finish = function() {\n  const state = this.state;\n  if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n    this.instructions.push(strokeInstruction);\n  }\n  this.reverseHitDetectionInstructions();\n  this.state = null;\n};\n\n\n/**\n * @inheritDoc.\n */\nCanvasLineStringReplay.prototype.applyStroke = function(state) {\n  if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n    this.instructions.push(strokeInstruction);\n    state.lastStroke = this.coordinates.length;\n  }\n  state.lastStroke = 0;\n  CanvasReplay.prototype.applyStroke.call(this, state);\n  this.instructions.push(beginPathInstruction);\n};\nexport default CanvasLineStringReplay;\n","/**\n * @module ol/render/canvas/PolygonReplay\n */\nimport {inherits} from '../../index.js';\nimport {asString} from '../../color.js';\nimport {snap} from '../../geom/flat/simplify.js';\nimport {defaultFillStyle} from '../canvas.js';\nimport CanvasInstruction, {\n  fillInstruction, strokeInstruction, beginPathInstruction, closePathInstruction\n} from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\n\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasPolygonReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n};\n\ninherits(CanvasPolygonReplay, CanvasReplay);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @private\n * @return {number} End.\n */\nCanvasPolygonReplay.prototype.drawFlatCoordinatess_ = function(flatCoordinates, offset, ends, stride) {\n  const state = this.state;\n  const fill = state.fillStyle !== undefined;\n  const stroke = state.strokeStyle != undefined;\n  const numEnds = ends.length;\n  this.instructions.push(beginPathInstruction);\n  this.hitDetectionInstructions.push(beginPathInstruction);\n  for (let i = 0; i < numEnds; ++i) {\n    const end = ends[i];\n    const myBegin = this.coordinates.length;\n    const myEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, true, !stroke);\n    const moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n    this.instructions.push(moveToLineToInstruction);\n    this.hitDetectionInstructions.push(moveToLineToInstruction);\n    if (stroke) {\n      // Performance optimization: only call closePath() when we have a stroke.\n      // Otherwise the ring is closed already (see appendFlatCoordinates above).\n      this.instructions.push(closePathInstruction);\n      this.hitDetectionInstructions.push(closePathInstruction);\n    }\n    offset = end;\n  }\n  this.hitDetectionInstructions.push(fillInstruction);\n  if (fill) {\n    this.instructions.push(fillInstruction);\n  }\n  if (stroke) {\n    this.instructions.push(strokeInstruction);\n    this.hitDetectionInstructions.push(strokeInstruction);\n  }\n  return offset;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.drawCircle = function(circleGeometry, feature) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  const strokeStyle = state.strokeStyle;\n  if (fillStyle === undefined && strokeStyle === undefined) {\n    return;\n  }\n  this.setFillStrokeStyles_(circleGeometry);\n  this.beginGeometry(circleGeometry, feature);\n  // always fill the circle for hit detection\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_FILL_STYLE,\n    asString(defaultFillStyle)\n  ]);\n  if (state.strokeStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ]);\n  }\n  const flatCoordinates = circleGeometry.getFlatCoordinates();\n  const stride = circleGeometry.getStride();\n  const myBegin = this.coordinates.length;\n  this.appendFlatCoordinates(\n    flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n  const circleInstruction = [CanvasInstruction.CIRCLE, myBegin];\n  this.instructions.push(beginPathInstruction, circleInstruction);\n  this.hitDetectionInstructions.push(beginPathInstruction, circleInstruction);\n  this.hitDetectionInstructions.push(fillInstruction);\n  if (state.fillStyle !== undefined) {\n    this.instructions.push(fillInstruction);\n  }\n  if (state.strokeStyle !== undefined) {\n    this.instructions.push(strokeInstruction);\n    this.hitDetectionInstructions.push(strokeInstruction);\n  }\n  this.endGeometry(circleGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.drawPolygon = function(polygonGeometry, feature) {\n  const state = this.state;\n  this.setFillStrokeStyles_(polygonGeometry);\n  this.beginGeometry(polygonGeometry, feature);\n  // always fill the polygon for hit detection\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_FILL_STYLE,\n    asString(defaultFillStyle)]\n  );\n  if (state.strokeStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ]);\n  }\n  const ends = polygonGeometry.getEnds();\n  const flatCoordinates = polygonGeometry.getOrientedFlatCoordinates();\n  const stride = polygonGeometry.getStride();\n  this.drawFlatCoordinatess_(flatCoordinates, 0, ends, stride);\n  this.endGeometry(polygonGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.drawMultiPolygon = function(multiPolygonGeometry, feature) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  const strokeStyle = state.strokeStyle;\n  if (fillStyle === undefined && strokeStyle === undefined) {\n    return;\n  }\n  this.setFillStrokeStyles_(multiPolygonGeometry);\n  this.beginGeometry(multiPolygonGeometry, feature);\n  // always fill the multi-polygon for hit detection\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_FILL_STYLE,\n    asString(defaultFillStyle)\n  ]);\n  if (state.strokeStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ]);\n  }\n  const endss = multiPolygonGeometry.getEndss();\n  const flatCoordinates = multiPolygonGeometry.getOrientedFlatCoordinates();\n  const stride = multiPolygonGeometry.getStride();\n  let offset = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    offset = this.drawFlatCoordinatess_(flatCoordinates, offset, endss[i], stride);\n  }\n  this.endGeometry(multiPolygonGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.finish = function() {\n  this.reverseHitDetectionInstructions();\n  this.state = null;\n  // We want to preserve topology when drawing polygons.  Polygons are\n  // simplified using quantization and point elimination. However, we might\n  // have received a mix of quantized and non-quantized geometries, so ensure\n  // that all are quantized by quantizing all coordinates in the batch.\n  const tolerance = this.tolerance;\n  if (tolerance !== 0) {\n    const coordinates = this.coordinates;\n    for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n      coordinates[i] = snap(coordinates[i], tolerance);\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n */\nCanvasPolygonReplay.prototype.setFillStrokeStyles_ = function(geometry) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  if (fillStyle !== undefined) {\n    this.updateFillStyle(state, this.createFill, geometry);\n  }\n  if (state.strokeStyle !== undefined) {\n    this.updateStrokeStyle(state, this.applyStroke);\n  }\n};\nexport default CanvasPolygonReplay;\n","/**\n * @module ol/render/canvas/Replay\n */\nimport {getUid, inherits} from '../../index.js';\nimport {UNDEFINED} from '../../functions.js';\nimport {equals, reverseSubArray} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {buffer, clone, coordinateRelationship, createEmpty, createOrUpdate,\n  createOrUpdateEmpty, extend, extendCoordinate, intersects} from '../../extent.js';\nimport Relationship from '../../extent/Relationship.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {inflateCoordinates, inflateCoordinatesArray, inflateMultiCoordinatesArray} from '../../geom/flat/inflate.js';\nimport {lineStringLength} from '../../geom/flat/length.js';\nimport {drawTextOnPath} from '../../geom/flat/textpath.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {isEmpty} from '../../obj.js';\nimport VectorContext from '../VectorContext.js';\nimport {drawImage, resetTransform, defaultPadding, defaultFillStyle, defaultStrokeStyle,\n  defaultMiterLimit, defaultLineWidth, defaultLineJoin, defaultLineDashOffset,\n  defaultLineDash, defaultLineCap} from '../canvas.js';\nimport CanvasInstruction from '../canvas/Instruction.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport {\n  create as createTransform,\n  compose as composeTransform,\n  apply as applyTransform,\n  setFromArray as transformSetFromArray\n} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/VectorContext}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasReplay = function(tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  VectorContext.call(this);\n\n  /**\n   * @type {?}\n   */\n  this.declutterTree = declutterTree;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.tolerance = tolerance;\n\n  /**\n   * @protected\n   * @const\n   * @type {module:ol/extent~Extent}\n   */\n  this.maxExtent = maxExtent;\n\n  /**\n   * @protected\n   * @type {boolean}\n   */\n  this.overlaps = overlaps;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.pixelRatio = pixelRatio;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.maxLineWidth = 0;\n\n  /**\n   * @protected\n   * @const\n   * @type {number}\n   */\n  this.resolution = resolution;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.alignFill_;\n\n  /**\n   * @private\n   * @type {Array.<*>}\n   */\n  this.beginGeometryInstruction1_ = null;\n\n  /**\n   * @private\n   * @type {Array.<*>}\n   */\n  this.beginGeometryInstruction2_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.bufferedMaxExtent_ = null;\n\n  /**\n   * @protected\n   * @type {Array.<*>}\n   */\n  this.instructions = [];\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.coordinates = [];\n\n  /**\n   * @private\n   * @type {!Object.<number,module:ol/coordinate~Coordinate|Array.<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>>}\n   */\n  this.coordinateCache_ = {};\n\n  /**\n   * @private\n   * @type {!module:ol/transform~Transform}\n   */\n  this.renderedTransform_ = createTransform();\n\n  /**\n   * @protected\n   * @type {Array.<*>}\n   */\n  this.hitDetectionInstructions = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.pixelCoordinates_ = null;\n\n  /**\n   * @protected\n   * @type {module:ol/render/canvas~FillStrokeState}\n   */\n  this.state = /** @type {module:ol/render/canvas~FillStrokeState} */ ({});\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.viewRotation_ = 0;\n\n};\n\ninherits(CanvasReplay, VectorContext);\n\n\n/**\n * @type {module:ol/extent~Extent}\n */\nconst tmpExtent = createEmpty();\n\n\n/**\n * @type {!module:ol/transform~Transform}\n */\nconst tmpTransform = createTransform();\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/coordinate~Coordinate} p1 1st point of the background box.\n * @param {module:ol/coordinate~Coordinate} p2 2nd point of the background box.\n * @param {module:ol/coordinate~Coordinate} p3 3rd point of the background box.\n * @param {module:ol/coordinate~Coordinate} p4 4th point of the background box.\n * @param {Array.<*>} fillInstruction Fill instruction.\n * @param {Array.<*>} strokeInstruction Stroke instruction.\n */\nCanvasReplay.prototype.replayTextBackground_ = function(context, p1, p2, p3, p4,\n  fillInstruction, strokeInstruction) {\n  context.beginPath();\n  context.moveTo.apply(context, p1);\n  context.lineTo.apply(context, p2);\n  context.lineTo.apply(context, p3);\n  context.lineTo.apply(context, p4);\n  context.lineTo.apply(context, p1);\n  if (fillInstruction) {\n    this.alignFill_ = /** @type {boolean} */ (fillInstruction[2]);\n    this.fill_(context);\n  }\n  if (strokeInstruction) {\n    this.setStrokeStyle_(context, /** @type {Array.<*>} */ (strokeInstruction));\n    context.stroke();\n  }\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n * @param {number} anchorX Anchor X.\n * @param {number} anchorY Anchor Y.\n * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\n * @param {number} height Height.\n * @param {number} opacity Opacity.\n * @param {number} originX Origin X.\n * @param {number} originY Origin Y.\n * @param {number} rotation Rotation.\n * @param {number} scale Scale.\n * @param {boolean} snapToPixel Snap to pixel.\n * @param {number} width Width.\n * @param {Array.<number>} padding Padding.\n * @param {Array.<*>} fillInstruction Fill instruction.\n * @param {Array.<*>} strokeInstruction Stroke instruction.\n */\nCanvasReplay.prototype.replayImage_ = function(context, x, y, image,\n  anchorX, anchorY, declutterGroup, height, opacity, originX, originY,\n  rotation, scale, snapToPixel, width, padding, fillInstruction, strokeInstruction) {\n  const fillStroke = fillInstruction || strokeInstruction;\n  anchorX *= scale;\n  anchorY *= scale;\n  x -= anchorX;\n  y -= anchorY;\n\n  const w = (width + originX > image.width) ? image.width - originX : width;\n  const h = (height + originY > image.height) ? image.height - originY : height;\n  const boxW = padding[3] + w * scale + padding[1];\n  const boxH = padding[0] + h * scale + padding[2];\n  const boxX = x - padding[3];\n  const boxY = y - padding[0];\n\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p1;\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p2;\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p3;\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p4;\n  if (fillStroke || rotation !== 0) {\n    p1 = [boxX, boxY];\n    p2 = [boxX + boxW, boxY];\n    p3 = [boxX + boxW, boxY + boxH];\n    p4 = [boxX, boxY + boxH];\n  }\n\n  let transform = null;\n  if (rotation !== 0) {\n    const centerX = x + anchorX;\n    const centerY = y + anchorY;\n    transform = composeTransform(tmpTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\n\n    createOrUpdateEmpty(tmpExtent);\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p1));\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p2));\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p3));\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p4));\n  } else {\n    createOrUpdate(boxX, boxY, boxX + boxW, boxY + boxH, tmpExtent);\n  }\n  const canvas = context.canvas;\n  const strokePadding = strokeInstruction ? (strokeInstruction[2] * scale / 2) : 0;\n  const intersects =\n      tmpExtent[0] - strokePadding <= canvas.width && tmpExtent[2] + strokePadding >= 0 &&\n      tmpExtent[1] - strokePadding <= canvas.height && tmpExtent[3] + strokePadding >= 0;\n\n  if (snapToPixel) {\n    x = Math.round(x);\n    y = Math.round(y);\n  }\n\n  if (declutterGroup) {\n    if (!intersects && declutterGroup[4] == 1) {\n      return;\n    }\n    extend(declutterGroup, tmpExtent);\n    const declutterArgs = intersects ?\n      [context, transform ? transform.slice(0) : null, opacity, image, originX, originY, w, h, x, y, scale] :\n      null;\n    if (declutterArgs && fillStroke) {\n      declutterArgs.push(fillInstruction, strokeInstruction, p1, p2, p3, p4);\n    }\n    declutterGroup.push(declutterArgs);\n  } else if (intersects) {\n    if (fillStroke) {\n      this.replayTextBackground_(context, p1, p2, p3, p4,\n        /** @type {Array.<*>} */ (fillInstruction),\n        /** @type {Array.<*>} */ (strokeInstruction));\n    }\n    drawImage(context, transform, opacity, image, originX, originY, w, h, x, y, scale);\n  }\n};\n\n\n/**\n * @protected\n * @param {Array.<number>} dashArray Dash array.\n * @return {Array.<number>} Dash array with pixel ratio applied\n */\nCanvasReplay.prototype.applyPixelRatio = function(dashArray) {\n  const pixelRatio = this.pixelRatio;\n  return pixelRatio == 1 ? dashArray : dashArray.map(function(dash) {\n    return dash * pixelRatio;\n  });\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {boolean} closed Last input coordinate equals first.\n * @param {boolean} skipFirst Skip first coordinate.\n * @protected\n * @return {number} My end.\n */\nCanvasReplay.prototype.appendFlatCoordinates = function(flatCoordinates, offset, end, stride, closed, skipFirst) {\n\n  let myEnd = this.coordinates.length;\n  const extent = this.getBufferedMaxExtent();\n  if (skipFirst) {\n    offset += stride;\n  }\n  const lastCoord = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n  const nextCoord = [NaN, NaN];\n  let skipped = true;\n\n  let i, lastRel, nextRel;\n  for (i = offset + stride; i < end; i += stride) {\n    nextCoord[0] = flatCoordinates[i];\n    nextCoord[1] = flatCoordinates[i + 1];\n    nextRel = coordinateRelationship(extent, nextCoord);\n    if (nextRel !== lastRel) {\n      if (skipped) {\n        this.coordinates[myEnd++] = lastCoord[0];\n        this.coordinates[myEnd++] = lastCoord[1];\n      }\n      this.coordinates[myEnd++] = nextCoord[0];\n      this.coordinates[myEnd++] = nextCoord[1];\n      skipped = false;\n    } else if (nextRel === Relationship.INTERSECTING) {\n      this.coordinates[myEnd++] = nextCoord[0];\n      this.coordinates[myEnd++] = nextCoord[1];\n      skipped = false;\n    } else {\n      skipped = true;\n    }\n    lastCoord[0] = nextCoord[0];\n    lastCoord[1] = nextCoord[1];\n    lastRel = nextRel;\n  }\n\n  // Last coordinate equals first or only one point to append:\n  if ((closed && skipped) || i === offset + stride) {\n    this.coordinates[myEnd++] = lastCoord[0];\n    this.coordinates[myEnd++] = lastCoord[1];\n  }\n  return myEnd;\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array.<number>} replayEnds Replay ends.\n * @return {number} Offset.\n */\nCanvasReplay.prototype.drawCustomCoordinates_ = function(flatCoordinates, offset, ends, stride, replayEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const replayEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n    replayEnds.push(replayEnd);\n    offset = end;\n  }\n  return offset;\n};\n\n\n/**\n * @inheritDoc.\n */\nCanvasReplay.prototype.drawCustom = function(geometry, feature, renderer) {\n  this.beginGeometry(geometry, feature);\n  const type = geometry.getType();\n  const stride = geometry.getStride();\n  const replayBegin = this.coordinates.length;\n  let flatCoordinates, replayEnd, replayEnds, replayEndss;\n  let offset;\n  if (type == GeometryType.MULTI_POLYGON) {\n    geometry = /** @type {module:ol/geom/MultiPolygon} */ (geometry);\n    flatCoordinates = geometry.getOrientedFlatCoordinates();\n    replayEndss = [];\n    const endss = geometry.getEndss();\n    offset = 0;\n    for (let i = 0, ii = endss.length; i < ii; ++i) {\n      const myEnds = [];\n      offset = this.drawCustomCoordinates_(flatCoordinates, offset, endss[i], stride, myEnds);\n      replayEndss.push(myEnds);\n    }\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEndss, geometry, renderer, inflateMultiCoordinatesArray]);\n  } else if (type == GeometryType.POLYGON || type == GeometryType.MULTI_LINE_STRING) {\n    replayEnds = [];\n    flatCoordinates = (type == GeometryType.POLYGON) ?\n      /** @type {module:ol/geom/Polygon} */ (geometry).getOrientedFlatCoordinates() :\n      geometry.getFlatCoordinates();\n    offset = this.drawCustomCoordinates_(flatCoordinates, 0,\n      /** @type {module:ol/geom/Polygon|module:ol/geom/MultiLineString} */ (geometry).getEnds(),\n      stride, replayEnds);\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEnds, geometry, renderer, inflateCoordinatesArray]);\n  } else if (type == GeometryType.LINE_STRING || type == GeometryType.MULTI_POINT) {\n    flatCoordinates = geometry.getFlatCoordinates();\n    replayEnd = this.appendFlatCoordinates(\n      flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEnd, geometry, renderer, inflateCoordinates]);\n  } else if (type == GeometryType.POINT) {\n    flatCoordinates = geometry.getFlatCoordinates();\n    this.coordinates.push(flatCoordinates[0], flatCoordinates[1]);\n    replayEnd = this.coordinates.length;\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEnd, geometry, renderer]);\n  }\n  this.endGeometry(geometry, feature);\n};\n\n\n/**\n * @protected\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nCanvasReplay.prototype.beginGeometry = function(geometry, feature) {\n  this.beginGeometryInstruction1_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\n  this.instructions.push(this.beginGeometryInstruction1_);\n  this.beginGeometryInstruction2_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\n  this.hitDetectionInstructions.push(this.beginGeometryInstruction2_);\n};\n\n\n/**\n * @private\n * @param {CanvasRenderingContext2D} context Context.\n */\nCanvasReplay.prototype.fill_ = function(context) {\n  if (this.alignFill_) {\n    const origin = applyTransform(this.renderedTransform_, [0, 0]);\n    const repeatSize = 512 * this.pixelRatio;\n    context.translate(origin[0] % repeatSize, origin[1] % repeatSize);\n    context.rotate(this.viewRotation_);\n  }\n  context.fill();\n  if (this.alignFill_) {\n    context.setTransform.apply(context, resetTransform);\n  }\n};\n\n\n/**\n * @private\n * @param {CanvasRenderingContext2D} context Context.\n * @param {Array.<*>} instruction Instruction.\n */\nCanvasReplay.prototype.setStrokeStyle_ = function(context, instruction) {\n  context.strokeStyle = /** @type {module:ol/colorlike~ColorLike} */ (instruction[1]);\n  context.lineWidth = /** @type {number} */ (instruction[2]);\n  context.lineCap = /** @type {string} */ (instruction[3]);\n  context.lineJoin = /** @type {string} */ (instruction[4]);\n  context.miterLimit = /** @type {number} */ (instruction[5]);\n  if (CANVAS_LINE_DASH) {\n    context.lineDashOffset = /** @type {number} */ (instruction[7]);\n    context.setLineDash(/** @type {Array.<number>} */ (instruction[6]));\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nCanvasReplay.prototype.renderDeclutter_ = function(declutterGroup, feature) {\n  if (declutterGroup && declutterGroup.length > 5) {\n    const groupCount = declutterGroup[4];\n    if (groupCount == 1 || groupCount == declutterGroup.length - 5) {\n      /** @type {module:ol/structs/RBush~Entry} */\n      const box = {\n        minX: /** @type {number} */ (declutterGroup[0]),\n        minY: /** @type {number} */ (declutterGroup[1]),\n        maxX: /** @type {number} */ (declutterGroup[2]),\n        maxY: /** @type {number} */ (declutterGroup[3]),\n        value: feature\n      };\n      if (!this.declutterTree.collides(box)) {\n        this.declutterTree.insert(box);\n        for (let j = 5, jj = declutterGroup.length; j < jj; ++j) {\n          const declutterData = /** @type {Array} */ (declutterGroup[j]);\n          if (declutterData) {\n            if (declutterData.length > 11) {\n              this.replayTextBackground_(declutterData[0],\n                declutterData[13], declutterData[14], declutterData[15], declutterData[16],\n                declutterData[11], declutterData[12]);\n            }\n            drawImage.apply(undefined, declutterData);\n          }\n        }\n      }\n      declutterGroup.length = 5;\n      createOrUpdateEmpty(declutterGroup);\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *     to skip.\n * @param {Array.<*>} instructions Instructions array.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined}\n *     featureCallback Feature callback.\n * @param {module:ol/extent~Extent=} opt_hitExtent Only check features that intersect this\n *     extent.\n * @return {T|undefined} Callback result.\n * @template T\n */\nCanvasReplay.prototype.replay_ = function(\n  context, transform, skippedFeaturesHash,\n  instructions, featureCallback, opt_hitExtent) {\n  /** @type {Array.<number>} */\n  let pixelCoordinates;\n  if (this.pixelCoordinates_ && equals(transform, this.renderedTransform_)) {\n    pixelCoordinates = this.pixelCoordinates_;\n  } else {\n    if (!this.pixelCoordinates_) {\n      this.pixelCoordinates_ = [];\n    }\n    pixelCoordinates = transform2D(\n      this.coordinates, 0, this.coordinates.length, 2,\n      transform, this.pixelCoordinates_);\n    transformSetFromArray(this.renderedTransform_, transform);\n  }\n  const skipFeatures = !isEmpty(skippedFeaturesHash);\n  let i = 0; // instruction index\n  const ii = instructions.length; // end of instructions\n  let d = 0; // data index\n  let dd; // end of per-instruction data\n  let anchorX, anchorY, prevX, prevY, roundX, roundY, declutterGroup, image;\n  let pendingFill = 0;\n  let pendingStroke = 0;\n  let lastFillInstruction = null;\n  let lastStrokeInstruction = null;\n  const coordinateCache = this.coordinateCache_;\n  const viewRotation = this.viewRotation_;\n\n  const state = /** @type {module:ol/render~State} */ ({\n    context: context,\n    pixelRatio: this.pixelRatio,\n    resolution: this.resolution,\n    rotation: viewRotation\n  });\n\n  // When the batch size gets too big, performance decreases. 200 is a good\n  // balance between batch size and number of fill/stroke instructions.\n  const batchSize = this.instructions != instructions || this.overlaps ? 0 : 200;\n  let /** @type {module:ol/Feature|module:ol/render/Feature} */ feature;\n  let x, y;\n  while (i < ii) {\n    const instruction = instructions[i];\n    const type = /** @type {module:ol/render/canvas/Instruction} */ (instruction[0]);\n    switch (type) {\n      case CanvasInstruction.BEGIN_GEOMETRY:\n        feature = /** @type {module:ol/Feature|module:ol/render/Feature} */ (instruction[1]);\n        if ((skipFeatures &&\n            skippedFeaturesHash[getUid(feature).toString()]) ||\n            !feature.getGeometry()) {\n          i = /** @type {number} */ (instruction[2]);\n        } else if (opt_hitExtent !== undefined && !intersects(\n          opt_hitExtent, feature.getGeometry().getExtent())) {\n          i = /** @type {number} */ (instruction[2]) + 1;\n        } else {\n          ++i;\n        }\n        break;\n      case CanvasInstruction.BEGIN_PATH:\n        if (pendingFill > batchSize) {\n          this.fill_(context);\n          pendingFill = 0;\n        }\n        if (pendingStroke > batchSize) {\n          context.stroke();\n          pendingStroke = 0;\n        }\n        if (!pendingFill && !pendingStroke) {\n          context.beginPath();\n          prevX = prevY = NaN;\n        }\n        ++i;\n        break;\n      case CanvasInstruction.CIRCLE:\n        d = /** @type {number} */ (instruction[1]);\n        const x1 = pixelCoordinates[d];\n        const y1 = pixelCoordinates[d + 1];\n        const x2 = pixelCoordinates[d + 2];\n        const y2 = pixelCoordinates[d + 3];\n        const dx = x2 - x1;\n        const dy = y2 - y1;\n        const r = Math.sqrt(dx * dx + dy * dy);\n        context.moveTo(x1 + r, y1);\n        context.arc(x1, y1, r, 0, 2 * Math.PI, true);\n        ++i;\n        break;\n      case CanvasInstruction.CLOSE_PATH:\n        context.closePath();\n        ++i;\n        break;\n      case CanvasInstruction.CUSTOM:\n        d = /** @type {number} */ (instruction[1]);\n        dd = instruction[2];\n        const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (instruction[3]);\n        const renderer = instruction[4];\n        const fn = instruction.length == 6 ? instruction[5] : undefined;\n        state.geometry = geometry;\n        state.feature = feature;\n        if (!(i in coordinateCache)) {\n          coordinateCache[i] = [];\n        }\n        const coords = coordinateCache[i];\n        if (fn) {\n          fn(pixelCoordinates, d, dd, 2, coords);\n        } else {\n          coords[0] = pixelCoordinates[d];\n          coords[1] = pixelCoordinates[d + 1];\n          coords.length = 2;\n        }\n        renderer(coords, state);\n        ++i;\n        break;\n      case CanvasInstruction.DRAW_IMAGE:\n        d = /** @type {number} */ (instruction[1]);\n        dd = /** @type {number} */ (instruction[2]);\n        image =  /** @type {HTMLCanvasElement|HTMLVideoElement|Image} */\n            (instruction[3]);\n        // Remaining arguments in DRAW_IMAGE are in alphabetical order\n        anchorX = /** @type {number} */ (instruction[4]);\n        anchorY = /** @type {number} */ (instruction[5]);\n        declutterGroup = featureCallback ? null : /** @type {module:ol/render/canvas~DeclutterGroup} */ (instruction[6]);\n        const height = /** @type {number} */ (instruction[7]);\n        const opacity = /** @type {number} */ (instruction[8]);\n        const originX = /** @type {number} */ (instruction[9]);\n        const originY = /** @type {number} */ (instruction[10]);\n        const rotateWithView = /** @type {boolean} */ (instruction[11]);\n        let rotation = /** @type {number} */ (instruction[12]);\n        const scale = /** @type {number} */ (instruction[13]);\n        const snapToPixel = /** @type {boolean} */ (instruction[14]);\n        const width = /** @type {number} */ (instruction[15]);\n\n        let padding, backgroundFill, backgroundStroke;\n        if (instruction.length > 16) {\n          padding = /** @type {Array.<number>} */ (instruction[16]);\n          backgroundFill = /** @type {boolean} */ (instruction[17]);\n          backgroundStroke = /** @type {boolean} */ (instruction[18]);\n        } else {\n          padding = defaultPadding;\n          backgroundFill = backgroundStroke = false;\n        }\n\n        if (rotateWithView) {\n          rotation += viewRotation;\n        }\n        for (; d < dd; d += 2) {\n          this.replayImage_(context,\n            pixelCoordinates[d], pixelCoordinates[d + 1], image, anchorX, anchorY,\n            declutterGroup, height, opacity, originX, originY, rotation, scale,\n            snapToPixel, width, padding,\n            backgroundFill ? /** @type {Array.<*>} */ (lastFillInstruction) : null,\n            backgroundStroke ? /** @type {Array.<*>} */ (lastStrokeInstruction) : null);\n        }\n        this.renderDeclutter_(declutterGroup, feature);\n        ++i;\n        break;\n      case CanvasInstruction.DRAW_CHARS:\n        const begin = /** @type {number} */ (instruction[1]);\n        const end = /** @type {number} */ (instruction[2]);\n        const baseline = /** @type {number} */ (instruction[3]);\n        declutterGroup = featureCallback ? null : /** @type {module:ol/render/canvas~DeclutterGroup} */ (instruction[4]);\n        const overflow = /** @type {number} */ (instruction[5]);\n        const fillKey = /** @type {string} */ (instruction[6]);\n        const maxAngle = /** @type {number} */ (instruction[7]);\n        const measure = /** @type {function(string):number} */ (instruction[8]);\n        const offsetY = /** @type {number} */ (instruction[9]);\n        const strokeKey = /** @type {string} */ (instruction[10]);\n        const strokeWidth =  /** @type {number} */ (instruction[11]);\n        const text = /** @type {string} */ (instruction[12]);\n        const textKey = /** @type {string} */ (instruction[13]);\n        const textScale = /** @type {number} */ (instruction[14]);\n\n        const pathLength = lineStringLength(pixelCoordinates, begin, end, 2);\n        const textLength = measure(text);\n        if (overflow || textLength <= pathLength) {\n          const textAlign = /** @type {module:ol~render} */ (this).textStates[textKey].textAlign;\n          const startM = (pathLength - textLength) * TEXT_ALIGN[textAlign];\n          const parts = drawTextOnPath(\n            pixelCoordinates, begin, end, 2, text, measure, startM, maxAngle);\n          if (parts) {\n            let c, cc, chars, label, part;\n            if (strokeKey) {\n              for (c = 0, cc = parts.length; c < cc; ++c) {\n                part = parts[c]; // x, y, anchorX, rotation, chunk\n                chars = /** @type {string} */ (part[4]);\n                label = /** @type {module:ol~render} */ (this).getImage(chars, textKey, '', strokeKey);\n                anchorX = /** @type {number} */ (part[2]) + strokeWidth;\n                anchorY = baseline * label.height + (0.5 - baseline) * 2 * strokeWidth - offsetY;\n                this.replayImage_(context,\n                  /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                  anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                  /** @type {number} */ (part[3]), textScale, false, label.width,\n                  defaultPadding, null, null);\n              }\n            }\n            if (fillKey) {\n              for (c = 0, cc = parts.length; c < cc; ++c) {\n                part = parts[c]; // x, y, anchorX, rotation, chunk\n                chars = /** @type {string} */ (part[4]);\n                label = /** @type {module:ol~render} */ (this).getImage(chars, textKey, fillKey, '');\n                anchorX = /** @type {number} */ (part[2]);\n                anchorY = baseline * label.height - offsetY;\n                this.replayImage_(context,\n                  /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                  anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                  /** @type {number} */ (part[3]), textScale, false, label.width,\n                  defaultPadding, null, null);\n              }\n            }\n          }\n        }\n        this.renderDeclutter_(declutterGroup, feature);\n        ++i;\n        break;\n      case CanvasInstruction.END_GEOMETRY:\n        if (featureCallback !== undefined) {\n          feature = /** @type {module:ol/Feature|module:ol/render/Feature} */ (instruction[1]);\n          const result = featureCallback(feature);\n          if (result) {\n            return result;\n          }\n        }\n        ++i;\n        break;\n      case CanvasInstruction.FILL:\n        if (batchSize) {\n          pendingFill++;\n        } else {\n          this.fill_(context);\n        }\n        ++i;\n        break;\n      case CanvasInstruction.MOVE_TO_LINE_TO:\n        d = /** @type {number} */ (instruction[1]);\n        dd = /** @type {number} */ (instruction[2]);\n        x = pixelCoordinates[d];\n        y = pixelCoordinates[d + 1];\n        roundX = (x + 0.5) | 0;\n        roundY = (y + 0.5) | 0;\n        if (roundX !== prevX || roundY !== prevY) {\n          context.moveTo(x, y);\n          prevX = roundX;\n          prevY = roundY;\n        }\n        for (d += 2; d < dd; d += 2) {\n          x = pixelCoordinates[d];\n          y = pixelCoordinates[d + 1];\n          roundX = (x + 0.5) | 0;\n          roundY = (y + 0.5) | 0;\n          if (d == dd - 2 || roundX !== prevX || roundY !== prevY) {\n            context.lineTo(x, y);\n            prevX = roundX;\n            prevY = roundY;\n          }\n        }\n        ++i;\n        break;\n      case CanvasInstruction.SET_FILL_STYLE:\n        lastFillInstruction = instruction;\n        this.alignFill_ = instruction[2];\n\n        if (pendingFill) {\n          this.fill_(context);\n          pendingFill = 0;\n          if (pendingStroke) {\n            context.stroke();\n            pendingStroke = 0;\n          }\n        }\n\n        context.fillStyle = /** @type {module:ol/colorlike~ColorLike} */ (instruction[1]);\n        ++i;\n        break;\n      case CanvasInstruction.SET_STROKE_STYLE:\n        lastStrokeInstruction = instruction;\n        if (pendingStroke) {\n          context.stroke();\n          pendingStroke = 0;\n        }\n        this.setStrokeStyle_(context, /** @type {Array.<*>} */ (instruction));\n        ++i;\n        break;\n      case CanvasInstruction.STROKE:\n        if (batchSize) {\n          pendingStroke++;\n        } else {\n          context.stroke();\n        }\n        ++i;\n        break;\n      default:\n        ++i; // consume the instruction anyway, to avoid an infinite loop\n        break;\n    }\n  }\n  if (pendingFill) {\n    this.fill_(context);\n  }\n  if (pendingStroke) {\n    context.stroke();\n  }\n  return undefined;\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *     to skip.\n */\nCanvasReplay.prototype.replay = function(\n  context, transform, viewRotation, skippedFeaturesHash) {\n  this.viewRotation_ = viewRotation;\n  this.replay_(context, transform,\n    skippedFeaturesHash, this.instructions, undefined, undefined);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *     to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T=} opt_featureCallback\n *     Feature callback.\n * @param {module:ol/extent~Extent=} opt_hitExtent Only check features that intersect this\n *     extent.\n * @return {T|undefined} Callback result.\n * @template T\n */\nCanvasReplay.prototype.replayHitDetection = function(\n  context, transform, viewRotation, skippedFeaturesHash,\n  opt_featureCallback, opt_hitExtent) {\n  this.viewRotation_ = viewRotation;\n  return this.replay_(context, transform, skippedFeaturesHash,\n    this.hitDetectionInstructions, opt_featureCallback, opt_hitExtent);\n};\n\n\n/**\n * Reverse the hit detection instructions.\n */\nCanvasReplay.prototype.reverseHitDetectionInstructions = function() {\n  const hitDetectionInstructions = this.hitDetectionInstructions;\n  // step 1 - reverse array\n  hitDetectionInstructions.reverse();\n  // step 2 - reverse instructions within geometry blocks\n  let i;\n  const n = hitDetectionInstructions.length;\n  let instruction;\n  let type;\n  let begin = -1;\n  for (i = 0; i < n; ++i) {\n    instruction = hitDetectionInstructions[i];\n    type = /** @type {module:ol/render/canvas/Instruction} */ (instruction[0]);\n    if (type == CanvasInstruction.END_GEOMETRY) {\n      begin = i;\n    } else if (type == CanvasInstruction.BEGIN_GEOMETRY) {\n      instruction[2] = i;\n      reverseSubArray(this.hitDetectionInstructions, begin, i);\n      begin = -1;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasReplay.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  const state = this.state;\n  if (fillStyle) {\n    const fillStyleColor = fillStyle.getColor();\n    state.fillStyle = asColorLike(fillStyleColor ?\n      fillStyleColor : defaultFillStyle);\n  } else {\n    state.fillStyle = undefined;\n  }\n  if (strokeStyle) {\n    const strokeStyleColor = strokeStyle.getColor();\n    state.strokeStyle = asColorLike(strokeStyleColor ?\n      strokeStyleColor : defaultStrokeStyle);\n    const strokeStyleLineCap = strokeStyle.getLineCap();\n    state.lineCap = strokeStyleLineCap !== undefined ?\n      strokeStyleLineCap : defaultLineCap;\n    const strokeStyleLineDash = strokeStyle.getLineDash();\n    state.lineDash = strokeStyleLineDash ?\n      strokeStyleLineDash.slice() : defaultLineDash;\n    const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    state.lineDashOffset = strokeStyleLineDashOffset ?\n      strokeStyleLineDashOffset : defaultLineDashOffset;\n    const strokeStyleLineJoin = strokeStyle.getLineJoin();\n    state.lineJoin = strokeStyleLineJoin !== undefined ?\n      strokeStyleLineJoin : defaultLineJoin;\n    const strokeStyleWidth = strokeStyle.getWidth();\n    state.lineWidth = strokeStyleWidth !== undefined ?\n      strokeStyleWidth : defaultLineWidth;\n    const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n    state.miterLimit = strokeStyleMiterLimit !== undefined ?\n      strokeStyleMiterLimit : defaultMiterLimit;\n\n    if (state.lineWidth > this.maxLineWidth) {\n      this.maxLineWidth = state.lineWidth;\n      // invalidate the buffered max extent cache\n      this.bufferedMaxExtent_ = null;\n    }\n  } else {\n    state.strokeStyle = undefined;\n    state.lineCap = undefined;\n    state.lineDash = null;\n    state.lineDashOffset = undefined;\n    state.lineJoin = undefined;\n    state.lineWidth = undefined;\n    state.miterLimit = undefined;\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @return {Array.<*>} Fill instruction.\n */\nCanvasReplay.prototype.createFill = function(state, geometry) {\n  const fillStyle = state.fillStyle;\n  const fillInstruction = [CanvasInstruction.SET_FILL_STYLE, fillStyle];\n  if (typeof fillStyle !== 'string') {\n    // Fill is a pattern or gradient - align it!\n    fillInstruction.push(true);\n  }\n  return fillInstruction;\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n */\nCanvasReplay.prototype.applyStroke = function(state) {\n  this.instructions.push(this.createStroke(state));\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @return {Array.<*>} Stroke instruction.\n */\nCanvasReplay.prototype.createStroke = function(state) {\n  return [\n    CanvasInstruction.SET_STROKE_STYLE,\n    state.strokeStyle, state.lineWidth * this.pixelRatio, state.lineCap,\n    state.lineJoin, state.miterLimit,\n    this.applyPixelRatio(state.lineDash), state.lineDashOffset * this.pixelRatio\n  ];\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @param {function(this:module:ol/render/canvas/Replay, module:ol/render/canvas~FillStrokeState, (module:ol/geom/Geometry|module:ol/render/Feature)):Array.<*>} createFill Create fill.\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n */\nCanvasReplay.prototype.updateFillStyle = function(state, createFill, geometry) {\n  const fillStyle = state.fillStyle;\n  if (typeof fillStyle !== 'string' || state.currentFillStyle != fillStyle) {\n    if (fillStyle !== undefined) {\n      this.instructions.push(createFill.call(this, state, geometry));\n    }\n    state.currentFillStyle = fillStyle;\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @param {function(this:module:ol/render/canvas/Replay, module:ol/render/canvas~FillStrokeState)} applyStroke Apply stroke.\n */\nCanvasReplay.prototype.updateStrokeStyle = function(state, applyStroke) {\n  const strokeStyle = state.strokeStyle;\n  const lineCap = state.lineCap;\n  const lineDash = state.lineDash;\n  const lineDashOffset = state.lineDashOffset;\n  const lineJoin = state.lineJoin;\n  const lineWidth = state.lineWidth;\n  const miterLimit = state.miterLimit;\n  if (state.currentStrokeStyle != strokeStyle ||\n      state.currentLineCap != lineCap ||\n      (lineDash != state.currentLineDash && !equals(state.currentLineDash, lineDash)) ||\n      state.currentLineDashOffset != lineDashOffset ||\n      state.currentLineJoin != lineJoin ||\n      state.currentLineWidth != lineWidth ||\n      state.currentMiterLimit != miterLimit) {\n    if (strokeStyle !== undefined) {\n      applyStroke.call(this, state);\n    }\n    state.currentStrokeStyle = strokeStyle;\n    state.currentLineCap = lineCap;\n    state.currentLineDash = lineDash;\n    state.currentLineDashOffset = lineDashOffset;\n    state.currentLineJoin = lineJoin;\n    state.currentLineWidth = lineWidth;\n    state.currentMiterLimit = miterLimit;\n  }\n};\n\n\n/**\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nCanvasReplay.prototype.endGeometry = function(geometry, feature) {\n  this.beginGeometryInstruction1_[2] = this.instructions.length;\n  this.beginGeometryInstruction1_ = null;\n  this.beginGeometryInstruction2_[2] = this.hitDetectionInstructions.length;\n  this.beginGeometryInstruction2_ = null;\n  const endGeometryInstruction = [CanvasInstruction.END_GEOMETRY, feature];\n  this.instructions.push(endGeometryInstruction);\n  this.hitDetectionInstructions.push(endGeometryInstruction);\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nCanvasReplay.prototype.finish = UNDEFINED;\n\n\n/**\n * Get the buffered rendering extent.  Rendering will be clipped to the extent\n * provided to the constructor.  To account for symbolizers that may intersect\n * this extent, we calculate a buffered extent (e.g. based on stroke width).\n * @return {module:ol/extent~Extent} The buffered rendering extent.\n * @protected\n */\nCanvasReplay.prototype.getBufferedMaxExtent = function() {\n  if (!this.bufferedMaxExtent_) {\n    this.bufferedMaxExtent_ = clone(this.maxExtent);\n    if (this.maxLineWidth > 0) {\n      const width = this.resolution * (this.maxLineWidth + 1) / 2;\n      buffer(this.bufferedMaxExtent_, width, this.bufferedMaxExtent_);\n    }\n  }\n  return this.bufferedMaxExtent_;\n};\nexport default CanvasReplay;\n","/**\n * @module ol/render/canvas/ReplayGroup\n */\nimport {inherits} from '../../index.js';\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {buffer, createEmpty, extendCoordinate} from '../../extent.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {isEmpty} from '../../obj.js';\nimport ReplayGroup from '../ReplayGroup.js';\nimport ReplayType from '../ReplayType.js';\nimport CanvasReplay from '../canvas/Replay.js';\nimport CanvasImageReplay from '../canvas/ImageReplay.js';\nimport CanvasLineStringReplay from '../canvas/LineStringReplay.js';\nimport CanvasPolygonReplay from '../canvas/PolygonReplay.js';\nimport CanvasTextReplay from '../canvas/TextReplay.js';\nimport {ORDER} from '../replay.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n\n/**\n * @type {Object.<module:ol/render/ReplayType,\n *                function(new: module:ol/render/canvas/Replay, number, module:ol/extent~Extent,\n *                number, number, boolean, Array.<module:ol/render/canvas~DeclutterGroup>)>}\n */\nconst BATCH_CONSTRUCTORS = {\n  'Circle': CanvasPolygonReplay,\n  'Default': CanvasReplay,\n  'Image': CanvasImageReplay,\n  'LineString': CanvasLineStringReplay,\n  'Polygon': CanvasPolygonReplay,\n  'Text': CanvasTextReplay\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/render/ReplayGroup}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay group can have overlapping geometries.\n * @param {?} declutterTree Declutter tree\n * for declutter processing in postrender.\n * @param {number=} opt_renderBuffer Optional rendering buffer.\n * @struct\n */\nconst CanvasReplayGroup = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree, opt_renderBuffer) {\n  ReplayGroup.call(this);\n\n  /**\n   * Declutter tree.\n   * @private\n   */\n  this.declutterTree_ = declutterTree;\n\n  /**\n   * @type {module:ol/render/canvas~DeclutterGroup}\n   * @private\n   */\n  this.declutterGroup_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.tolerance_ = tolerance;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.maxExtent_ = maxExtent;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overlaps_ = overlaps;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.resolution_ = resolution;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.renderBuffer_ = opt_renderBuffer;\n\n  /**\n   * @private\n   * @type {!Object.<string, !Object.<module:ol/render/ReplayType, module:ol/render/canvas/Replay>>}\n   */\n  this.replaysByZIndex_ = {};\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.hitDetectionContext_ = createCanvasContext2D(1, 1);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.hitDetectionTransform_ = createTransform();\n};\n\ninherits(CanvasReplayGroup, ReplayGroup);\n\n\n/**\n * This cache is used for storing calculated pixel circles for increasing performance.\n * It is a static property to allow each Replaygroup to access it.\n * @type {Object.<number, Array.<Array.<(boolean|undefined)>>>}\n */\nconst circleArrayCache = {\n  0: [[true]]\n};\n\n\n/**\n * This method fills a row in the array from the given coordinate to the\n * middle with `true`.\n * @param {Array.<Array.<(boolean|undefined)>>} array The array that will be altered.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n */\nfunction fillCircleArrayRowToMiddle(array, x, y) {\n  let i;\n  const radius = Math.floor(array.length / 2);\n  if (x >= radius) {\n    for (i = radius; i < x; i++) {\n      array[i][y] = true;\n    }\n  } else if (x < radius) {\n    for (i = x + 1; i < radius; i++) {\n      array[i][y] = true;\n    }\n  }\n}\n\n\n/**\n * This methods creates a circle inside a fitting array. Points inside the\n * circle are marked by true, points on the outside are undefined.\n * It uses the midpoint circle algorithm.\n * A cache is used to increase performance.\n * @param {number} radius Radius.\n * @returns {Array.<Array.<(boolean|undefined)>>} An array with marked circle points.\n */\nexport function getCircleArray(radius) {\n  if (circleArrayCache[radius] !== undefined) {\n    return circleArrayCache[radius];\n  }\n\n  const arraySize = radius * 2 + 1;\n  const arr = new Array(arraySize);\n  for (let i = 0; i < arraySize; i++) {\n    arr[i] = new Array(arraySize);\n  }\n\n  let x = radius;\n  let y = 0;\n  let error = 0;\n\n  while (x >= y) {\n    fillCircleArrayRowToMiddle(arr, radius + x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius - y);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + x, radius - y);\n\n    y++;\n    error += 1 + 2 * y;\n    if (2 * (error - x) + 1 > 0) {\n      x -= 1;\n      error += 1 - 2 * x;\n    }\n  }\n\n  circleArrayCache[radius] = arr;\n  return arr;\n}\n\n\n/**\n * @param {!Object.<string, Array.<*>>} declutterReplays Declutter replays.\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n */\nexport function replayDeclutter(declutterReplays, context, rotation) {\n  const zs = Object.keys(declutterReplays).map(Number).sort(numberSafeCompareFunction);\n  const skippedFeatureUids = {};\n  for (let z = 0, zz = zs.length; z < zz; ++z) {\n    const replayData = declutterReplays[zs[z].toString()];\n    for (let i = 0, ii = replayData.length; i < ii;) {\n      const replay = replayData[i++];\n      const transform = replayData[i++];\n      replay.replay(context, transform, rotation, skippedFeatureUids);\n    }\n  }\n}\n\n\n/**\n * @param {boolean} group Group with previous replay.\n * @return {module:ol/render/canvas~DeclutterGroup} Declutter instruction group.\n */\nCanvasReplayGroup.prototype.addDeclutter = function(group) {\n  let declutter = null;\n  if (this.declutterTree_) {\n    if (group) {\n      declutter = this.declutterGroup_;\n      /** @type {number} */ (declutter[4])++;\n    } else {\n      declutter = this.declutterGroup_ = createEmpty();\n      declutter.push(1);\n    }\n  }\n  return declutter;\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n */\nCanvasReplayGroup.prototype.clip = function(context, transform) {\n  const flatClipCoords = this.getClipCoords(transform);\n  context.beginPath();\n  context.moveTo(flatClipCoords[0], flatClipCoords[1]);\n  context.lineTo(flatClipCoords[2], flatClipCoords[3]);\n  context.lineTo(flatClipCoords[4], flatClipCoords[5]);\n  context.lineTo(flatClipCoords[6], flatClipCoords[7]);\n  context.clip();\n};\n\n\n/**\n * @param {Array.<module:ol/render/ReplayType>} replays Replays.\n * @return {boolean} Has replays of the provided types.\n */\nCanvasReplayGroup.prototype.hasReplays = function(replays) {\n  for (const zIndex in this.replaysByZIndex_) {\n    const candidates = this.replaysByZIndex_[zIndex];\n    for (let i = 0, ii = replays.length; i < ii; ++i) {\n      if (replays[i] in candidates) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nCanvasReplayGroup.prototype.finish = function() {\n  for (const zKey in this.replaysByZIndex_) {\n    const replays = this.replaysByZIndex_[zKey];\n    for (const replayKey in replays) {\n      replays[replayKey].finish();\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T} callback Feature callback.\n * @param {Object.<string, module:ol/render/canvas~DeclutterGroup>} declutterReplays Declutter replays.\n * @return {T|undefined} Callback result.\n * @template T\n */\nCanvasReplayGroup.prototype.forEachFeatureAtCoordinate = function(\n  coordinate, resolution, rotation, hitTolerance, skippedFeaturesHash, callback, declutterReplays) {\n\n  hitTolerance = Math.round(hitTolerance);\n  const contextSize = hitTolerance * 2 + 1;\n  const transform = composeTransform(this.hitDetectionTransform_,\n    hitTolerance + 0.5, hitTolerance + 0.5,\n    1 / resolution, -1 / resolution,\n    -rotation,\n    -coordinate[0], -coordinate[1]);\n  const context = this.hitDetectionContext_;\n\n  if (context.canvas.width !== contextSize || context.canvas.height !== contextSize) {\n    context.canvas.width = contextSize;\n    context.canvas.height = contextSize;\n  } else {\n    context.clearRect(0, 0, contextSize, contextSize);\n  }\n\n  /**\n   * @type {module:ol/extent~Extent}\n   */\n  let hitExtent;\n  if (this.renderBuffer_ !== undefined) {\n    hitExtent = createEmpty();\n    extendCoordinate(hitExtent, coordinate);\n    buffer(hitExtent, resolution * (this.renderBuffer_ + hitTolerance), hitExtent);\n  }\n\n  const mask = getCircleArray(hitTolerance);\n  let declutteredFeatures;\n  if (this.declutterTree_) {\n    declutteredFeatures = this.declutterTree_.all().map(function(entry) {\n      return entry.value;\n    });\n  }\n\n  let replayType;\n\n  /**\n   * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n   * @return {?} Callback result.\n   */\n  function featureCallback(feature) {\n    const imageData = context.getImageData(0, 0, contextSize, contextSize).data;\n    for (let i = 0; i < contextSize; i++) {\n      for (let j = 0; j < contextSize; j++) {\n        if (mask[i][j]) {\n          if (imageData[(j * contextSize + i) * 4 + 3] > 0) {\n            let result;\n            if (!(declutteredFeatures && (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) ||\n                declutteredFeatures.indexOf(feature) !== -1) {\n              result = callback(feature);\n            }\n            if (result) {\n              return result;\n            } else {\n              context.clearRect(0, 0, contextSize, contextSize);\n              return undefined;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(numberSafeCompareFunction);\n\n  let i, j, replays, replay, result;\n  for (i = zs.length - 1; i >= 0; --i) {\n    const zIndexKey = zs[i].toString();\n    replays = this.replaysByZIndex_[zIndexKey];\n    for (j = ORDER.length - 1; j >= 0; --j) {\n      replayType = ORDER[j];\n      replay = replays[replayType];\n      if (replay !== undefined) {\n        if (declutterReplays &&\n            (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) {\n          const declutter = declutterReplays[zIndexKey];\n          if (!declutter) {\n            declutterReplays[zIndexKey] = [replay, transform.slice(0)];\n          } else {\n            declutter.push(replay, transform.slice(0));\n          }\n        } else {\n          result = replay.replayHitDetection(context, transform, rotation,\n            skippedFeaturesHash, featureCallback, hitExtent);\n          if (result) {\n            return result;\n          }\n        }\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @param {module:ol/transform~Transform} transform Transform.\n * @return {Array.<number>} Clip coordinates.\n */\nCanvasReplayGroup.prototype.getClipCoords = function(transform) {\n  const maxExtent = this.maxExtent_;\n  const minX = maxExtent[0];\n  const minY = maxExtent[1];\n  const maxX = maxExtent[2];\n  const maxY = maxExtent[3];\n  const flatClipCoords = [minX, minY, minX, maxY, maxX, maxY, maxX, minY];\n  transform2D(\n    flatClipCoords, 0, 8, 2, transform, flatClipCoords);\n  return flatClipCoords;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasReplayGroup.prototype.getReplay = function(zIndex, replayType) {\n  const zIndexKey = zIndex !== undefined ? zIndex.toString() : '0';\n  let replays = this.replaysByZIndex_[zIndexKey];\n  if (replays === undefined) {\n    replays = {};\n    this.replaysByZIndex_[zIndexKey] = replays;\n  }\n  let replay = replays[replayType];\n  if (replay === undefined) {\n    const Constructor = BATCH_CONSTRUCTORS[replayType];\n    replay = new Constructor(this.tolerance_, this.maxExtent_,\n      this.resolution_, this.pixelRatio_, this.overlaps_, this.declutterTree_);\n    replays[replayType] = replay;\n  }\n  return replay;\n};\n\n\n/**\n * @return {Object.<string, Object.<module:ol/render/ReplayType, module:ol/render/canvas/Replay>>} Replays.\n */\nCanvasReplayGroup.prototype.getReplays = function() {\n  return this.replaysByZIndex_;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasReplayGroup.prototype.isEmpty = function() {\n  return isEmpty(this.replaysByZIndex_);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {Array.<module:ol/render/ReplayType>=} opt_replayTypes Ordered replay types to replay.\n *     Default is {@link module:ol/render/replay~ORDER}\n * @param {Object.<string, module:ol/render/canvas~DeclutterGroup>=} opt_declutterReplays Declutter replays.\n */\nCanvasReplayGroup.prototype.replay = function(context,\n  transform, viewRotation, skippedFeaturesHash, opt_replayTypes, opt_declutterReplays) {\n\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(numberSafeCompareFunction);\n\n  // setup clipping so that the parts of over-simplified geometries are not\n  // visible outside the current extent when panning\n  context.save();\n  this.clip(context, transform);\n\n  const replayTypes = opt_replayTypes ? opt_replayTypes : ORDER;\n  let i, ii, j, jj, replays, replay;\n  for (i = 0, ii = zs.length; i < ii; ++i) {\n    const zIndexKey = zs[i].toString();\n    replays = this.replaysByZIndex_[zIndexKey];\n    for (j = 0, jj = replayTypes.length; j < jj; ++j) {\n      const replayType = replayTypes[j];\n      replay = replays[replayType];\n      if (replay !== undefined) {\n        if (opt_declutterReplays &&\n            (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) {\n          const declutter = opt_declutterReplays[zIndexKey];\n          if (!declutter) {\n            opt_declutterReplays[zIndexKey] = [replay, transform.slice(0)];\n          } else {\n            declutter.push(replay, transform.slice(0));\n          }\n        } else {\n          replay.replay(context, transform, viewRotation, skippedFeaturesHash);\n        }\n      }\n    }\n  }\n\n  context.restore();\n};\n\nexport default CanvasReplayGroup;\n","/**\n * @module ol/render/canvas/TextReplay\n */\nimport {getUid, inherits} from '../../index.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {intersects} from '../../extent.js';\nimport {matchingChunk} from '../../geom/flat/straightchunk.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {labelCache, measureTextWidth, defaultTextAlign, measureTextHeight, defaultPadding, defaultLineCap, defaultLineDashOffset, defaultLineDash, defaultLineJoin, defaultFillStyle, checkFont, defaultFont, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline} from '../canvas.js';\nimport CanvasInstruction from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport TextPlacement from '../../style/TextPlacement.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasTextReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas~DeclutterGroup}\n   */\n  this.declutterGroup_;\n\n  /**\n   * @private\n   * @type {Array.<HTMLCanvasElement>}\n   */\n  this.labels_ = null;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.text_ = '';\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetY_ = 0;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.textRotateWithView_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textRotation_ = 0;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.textFillState_ = null;\n\n  /**\n   * @type {!Object.<string, module:ol/render/canvas~FillState>}\n   */\n  this.fillStates = {};\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.textStrokeState_ = null;\n\n  /**\n   * @type {!Object.<string, module:ol/render/canvas~StrokeState>}\n   */\n  this.strokeStates = {};\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas~TextState}\n   */\n  this.textState_ = /** @type {module:ol/render/canvas~TextState} */ ({});\n\n  /**\n   * @type {!Object.<string, module:ol/render/canvas~TextState>}\n   */\n  this.textStates = {};\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.textKey_ = '';\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.fillKey_ = '';\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.strokeKey_ = '';\n\n  /**\n   * @private\n   * @type {Object.<string, Object.<string, number>>}\n   */\n  this.widths_ = {};\n\n  labelCache.prune();\n\n};\n\ninherits(CanvasTextReplay, CanvasReplay);\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @param {Array.<string>} lines Lines to measure.\n * @param {Array.<number>} widths Array will be populated with the widths of\n * each line.\n * @return {number} Width of the whole text.\n */\nexport function measureTextWidths(font, lines, widths) {\n  const numLines = lines.length;\n  let width = 0;\n  for (let i = 0; i < numLines; ++i) {\n    const currentWidth = measureTextWidth(font, lines[i]);\n    width = Math.max(width, currentWidth);\n    widths.push(currentWidth);\n  }\n  return width;\n}\n\n\n/**\n * @inheritDoc\n */\nCanvasTextReplay.prototype.drawText = function(geometry, feature) {\n  const fillState = this.textFillState_;\n  const strokeState = this.textStrokeState_;\n  const textState = this.textState_;\n  if (this.text_ === '' || !textState || (!fillState && !strokeState)) {\n    return;\n  }\n\n  let begin = this.coordinates.length;\n\n  const geometryType = geometry.getType();\n  let flatCoordinates = null;\n  let end = 2;\n  let stride = 2;\n  let i, ii;\n\n  if (textState.placement === TextPlacement.LINE) {\n    if (!intersects(this.getBufferedMaxExtent(), geometry.getExtent())) {\n      return;\n    }\n    let ends;\n    flatCoordinates = geometry.getFlatCoordinates();\n    stride = geometry.getStride();\n    if (geometryType == GeometryType.LINE_STRING) {\n      ends = [flatCoordinates.length];\n    } else if (geometryType == GeometryType.MULTI_LINE_STRING) {\n      ends = geometry.getEnds();\n    } else if (geometryType == GeometryType.POLYGON) {\n      ends = geometry.getEnds().slice(0, 1);\n    } else if (geometryType == GeometryType.MULTI_POLYGON) {\n      const endss = geometry.getEndss();\n      ends = [];\n      for (i = 0, ii = endss.length; i < ii; ++i) {\n        ends.push(endss[i][0]);\n      }\n    }\n    this.beginGeometry(geometry, feature);\n    const textAlign = textState.textAlign;\n    let flatOffset = 0;\n    let flatEnd;\n    for (let o = 0, oo = ends.length; o < oo; ++o) {\n      if (textAlign == undefined) {\n        const range = matchingChunk(textState.maxAngle, flatCoordinates, flatOffset, ends[o], stride);\n        flatOffset = range[0];\n        flatEnd = range[1];\n      } else {\n        flatEnd = ends[o];\n      }\n      for (i = flatOffset; i < flatEnd; i += stride) {\n        this.coordinates.push(flatCoordinates[i], flatCoordinates[i + 1]);\n      }\n      end = this.coordinates.length;\n      flatOffset = ends[o];\n      this.drawChars_(begin, end, this.declutterGroup_);\n      begin = end;\n    }\n    this.endGeometry(geometry, feature);\n\n  } else {\n    const label = this.getImage(this.text_, this.textKey_, this.fillKey_, this.strokeKey_);\n    const width = label.width / this.pixelRatio;\n    switch (geometryType) {\n      case GeometryType.POINT:\n      case GeometryType.MULTI_POINT:\n        flatCoordinates = geometry.getFlatCoordinates();\n        end = flatCoordinates.length;\n        break;\n      case GeometryType.LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/LineString} */ (geometry).getFlatMidpoint();\n        break;\n      case GeometryType.CIRCLE:\n        flatCoordinates = /** @type {module:ol/geom/Circle} */ (geometry).getCenter();\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/MultiLineString} */ (geometry).getFlatMidpoints();\n        end = flatCoordinates.length;\n        break;\n      case GeometryType.POLYGON:\n        flatCoordinates = /** @type {module:ol/geom/Polygon} */ (geometry).getFlatInteriorPoint();\n        if (!textState.overflow && flatCoordinates[2] / this.resolution < width) {\n          return;\n        }\n        stride = 3;\n        break;\n      case GeometryType.MULTI_POLYGON:\n        const interiorPoints = /** @type {module:ol/geom/MultiPolygon} */ (geometry).getFlatInteriorPoints();\n        flatCoordinates = [];\n        for (i = 0, ii = interiorPoints.length; i < ii; i += 3) {\n          if (textState.overflow || interiorPoints[i + 2] / this.resolution >= width) {\n            flatCoordinates.push(interiorPoints[i], interiorPoints[i + 1]);\n          }\n        }\n        end = flatCoordinates.length;\n        if (end == 0) {\n          return;\n        }\n        break;\n      default:\n    }\n    end = this.appendFlatCoordinates(flatCoordinates, 0, end, stride, false, false);\n    if (textState.backgroundFill || textState.backgroundStroke) {\n      this.setFillStrokeStyle(textState.backgroundFill, textState.backgroundStroke);\n      if (textState.backgroundFill) {\n        this.updateFillStyle(this.state, this.createFill, geometry);\n        this.hitDetectionInstructions.push(this.createFill(this.state, geometry));\n      }\n      if (textState.backgroundStroke) {\n        this.updateStrokeStyle(this.state, this.applyStroke);\n        this.hitDetectionInstructions.push(this.createStroke(this.state));\n      }\n    }\n    this.beginGeometry(geometry, feature);\n    this.drawTextImage_(label, begin, end);\n    this.endGeometry(geometry, feature);\n  }\n};\n\n\n/**\n * @param {string} text Text.\n * @param {string} textKey Text style key.\n * @param {string} fillKey Fill style key.\n * @param {string} strokeKey Stroke style key.\n * @return {HTMLCanvasElement} Image.\n */\nCanvasTextReplay.prototype.getImage = function(text, textKey, fillKey, strokeKey) {\n  let label;\n  const key = strokeKey + textKey + text + fillKey + this.pixelRatio;\n\n  if (!labelCache.containsKey(key)) {\n    const strokeState = strokeKey ? this.strokeStates[strokeKey] || this.textStrokeState_ : null;\n    const fillState = fillKey ? this.fillStates[fillKey] || this.textFillState_ : null;\n    const textState = this.textStates[textKey] || this.textState_;\n    const pixelRatio = this.pixelRatio;\n    const scale = textState.scale * pixelRatio;\n    const align =  TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n    const strokeWidth = strokeKey && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n    const lines = text.split('\\n');\n    const numLines = lines.length;\n    const widths = [];\n    const width = measureTextWidths(textState.font, lines, widths);\n    const lineHeight = measureTextHeight(textState.font);\n    const height = lineHeight * numLines;\n    const renderWidth = (width + strokeWidth);\n    const context = createCanvasContext2D(\n      Math.ceil(renderWidth * scale),\n      Math.ceil((height + strokeWidth) * scale));\n    label = context.canvas;\n    labelCache.set(key, label);\n    if (scale != 1) {\n      context.scale(scale, scale);\n    }\n    context.font = textState.font;\n    if (strokeKey) {\n      context.strokeStyle = strokeState.strokeStyle;\n      context.lineWidth = strokeWidth;\n      context.lineCap = strokeState.lineCap;\n      context.lineJoin = strokeState.lineJoin;\n      context.miterLimit = strokeState.miterLimit;\n      if (CANVAS_LINE_DASH && strokeState.lineDash.length) {\n        context.setLineDash(strokeState.lineDash);\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n    }\n    if (fillKey) {\n      context.fillStyle = fillState.fillStyle;\n    }\n    context.textBaseline = 'middle';\n    context.textAlign = 'center';\n    const leftRight = (0.5 - align);\n    const x = align * label.width / scale + leftRight * strokeWidth;\n    let i;\n    if (strokeKey) {\n      for (i = 0; i < numLines; ++i) {\n        context.strokeText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n      }\n    }\n    if (fillKey) {\n      for (i = 0; i < numLines; ++i) {\n        context.fillText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n      }\n    }\n  }\n  return labelCache.get(key);\n};\n\n\n/**\n * @private\n * @param {HTMLCanvasElement} label Label.\n * @param {number} begin Begin.\n * @param {number} end End.\n */\nCanvasTextReplay.prototype.drawTextImage_ = function(label, begin, end) {\n  const textState = this.textState_;\n  const strokeState = this.textStrokeState_;\n  const pixelRatio = this.pixelRatio;\n  const align = TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n  const baseline = TEXT_ALIGN[textState.textBaseline];\n  const strokeWidth = strokeState && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n  const anchorX = align * label.width / pixelRatio + 2 * (0.5 - align) * strokeWidth;\n  const anchorY = baseline * label.height / pixelRatio + 2 * (0.5 - baseline) * strokeWidth;\n  this.instructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n    label, (anchorX - this.textOffsetX_) * pixelRatio, (anchorY - this.textOffsetY_) * pixelRatio,\n    this.declutterGroup_, label.height, 1, 0, 0, this.textRotateWithView_, this.textRotation_,\n    1, true, label.width,\n    textState.padding == defaultPadding ?\n      defaultPadding : textState.padding.map(function(p) {\n        return p * pixelRatio;\n      }),\n    !!textState.backgroundFill, !!textState.backgroundStroke\n  ]);\n  this.hitDetectionInstructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n    label, (anchorX - this.textOffsetX_) * pixelRatio, (anchorY - this.textOffsetY_) * pixelRatio,\n    this.declutterGroup_, label.height, 1, 0, 0, this.textRotateWithView_, this.textRotation_,\n    1 / pixelRatio, true, label.width, textState.padding,\n    !!textState.backgroundFill, !!textState.backgroundStroke\n  ]);\n};\n\n\n/**\n * @private\n * @param {number} begin Begin.\n * @param {number} end End.\n * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\n */\nCanvasTextReplay.prototype.drawChars_ = function(begin, end, declutterGroup) {\n  const strokeState = this.textStrokeState_;\n  const textState = this.textState_;\n  const fillState = this.textFillState_;\n\n  const strokeKey = this.strokeKey_;\n  if (strokeState) {\n    if (!(strokeKey in this.strokeStates)) {\n      this.strokeStates[strokeKey] = /** @type {module:ol/render/canvas~StrokeState} */ ({\n        strokeStyle: strokeState.strokeStyle,\n        lineCap: strokeState.lineCap,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineWidth: strokeState.lineWidth,\n        lineJoin: strokeState.lineJoin,\n        miterLimit: strokeState.miterLimit,\n        lineDash: strokeState.lineDash\n      });\n    }\n  }\n  const textKey = this.textKey_;\n  if (!(this.textKey_ in this.textStates)) {\n    this.textStates[this.textKey_] = /** @type {module:ol/render/canvas~TextState} */ ({\n      font: textState.font,\n      textAlign: textState.textAlign || defaultTextAlign,\n      scale: textState.scale\n    });\n  }\n  const fillKey = this.fillKey_;\n  if (fillState) {\n    if (!(fillKey in this.fillStates)) {\n      this.fillStates[fillKey] = /** @type {module:ol/render/canvas~FillState} */ ({\n        fillStyle: fillState.fillStyle\n      });\n    }\n  }\n\n  const pixelRatio = this.pixelRatio;\n  const baseline = TEXT_ALIGN[textState.textBaseline];\n\n  const offsetY = this.textOffsetY_ * pixelRatio;\n  const text = this.text_;\n  const font = textState.font;\n  const textScale = textState.scale;\n  const strokeWidth = strokeState ? strokeState.lineWidth * textScale / 2 : 0;\n  let widths = this.widths_[font];\n  if (!widths) {\n    this.widths_[font] = widths = {};\n  }\n  this.instructions.push([CanvasInstruction.DRAW_CHARS,\n    begin, end, baseline, declutterGroup,\n    textState.overflow, fillKey, textState.maxAngle,\n    function(text) {\n      let width = widths[text];\n      if (!width) {\n        width = widths[text] = measureTextWidth(font, text);\n      }\n      return width * textScale * pixelRatio;\n    },\n    offsetY, strokeKey, strokeWidth * pixelRatio, text, textKey, 1\n  ]);\n  this.hitDetectionInstructions.push([CanvasInstruction.DRAW_CHARS,\n    begin, end, baseline, declutterGroup,\n    textState.overflow, fillKey, textState.maxAngle,\n    function(text) {\n      let width = widths[text];\n      if (!width) {\n        width = widths[text] = measureTextWidth(font, text);\n      }\n      return width * textScale;\n    },\n    offsetY, strokeKey, strokeWidth, text, textKey, 1 / pixelRatio\n  ]);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasTextReplay.prototype.setTextStyle = function(textStyle, declutterGroup) {\n  let textState, fillState, strokeState;\n  if (!textStyle) {\n    this.text_ = '';\n  } else {\n    this.declutterGroup_ = /** @type {module:ol/render/canvas~DeclutterGroup} */ (declutterGroup);\n\n    const textFillStyle = textStyle.getFill();\n    if (!textFillStyle) {\n      fillState = this.textFillState_ = null;\n    } else {\n      fillState = this.textFillState_;\n      if (!fillState) {\n        fillState = this.textFillState_ = /** @type {module:ol/render/canvas~FillState} */ ({});\n      }\n      fillState.fillStyle = asColorLike(\n        textFillStyle.getColor() || defaultFillStyle);\n    }\n\n    const textStrokeStyle = textStyle.getStroke();\n    if (!textStrokeStyle) {\n      strokeState = this.textStrokeState_ = null;\n    } else {\n      strokeState = this.textStrokeState_;\n      if (!strokeState) {\n        strokeState = this.textStrokeState_ = /** @type {module:ol/render/canvas~StrokeState} */ ({});\n      }\n      const lineDash = textStrokeStyle.getLineDash();\n      const lineDashOffset = textStrokeStyle.getLineDashOffset();\n      const lineWidth = textStrokeStyle.getWidth();\n      const miterLimit = textStrokeStyle.getMiterLimit();\n      strokeState.lineCap = textStrokeStyle.getLineCap() || defaultLineCap;\n      strokeState.lineDash = lineDash ? lineDash.slice() : defaultLineDash;\n      strokeState.lineDashOffset =\n          lineDashOffset === undefined ? defaultLineDashOffset : lineDashOffset;\n      strokeState.lineJoin = textStrokeStyle.getLineJoin() || defaultLineJoin;\n      strokeState.lineWidth =\n          lineWidth === undefined ? defaultLineWidth : lineWidth;\n      strokeState.miterLimit =\n          miterLimit === undefined ? defaultMiterLimit : miterLimit;\n      strokeState.strokeStyle = asColorLike(\n        textStrokeStyle.getColor() || defaultStrokeStyle);\n    }\n\n    textState = this.textState_;\n    const font = textStyle.getFont() || defaultFont;\n    checkFont(font);\n    const textScale = textStyle.getScale();\n    textState.overflow = textStyle.getOverflow();\n    textState.font = font;\n    textState.maxAngle = textStyle.getMaxAngle();\n    textState.placement = textStyle.getPlacement();\n    textState.textAlign = textStyle.getTextAlign();\n    textState.textBaseline = textStyle.getTextBaseline() || defaultTextBaseline;\n    textState.backgroundFill = textStyle.getBackgroundFill();\n    textState.backgroundStroke = textStyle.getBackgroundStroke();\n    textState.padding = textStyle.getPadding() || defaultPadding;\n    textState.scale = textScale === undefined ? 1 : textScale;\n\n    const textOffsetX = textStyle.getOffsetX();\n    const textOffsetY = textStyle.getOffsetY();\n    const textRotateWithView = textStyle.getRotateWithView();\n    const textRotation = textStyle.getRotation();\n    this.text_ = textStyle.getText() || '';\n    this.textOffsetX_ = textOffsetX === undefined ? 0 : textOffsetX;\n    this.textOffsetY_ = textOffsetY === undefined ? 0 : textOffsetY;\n    this.textRotateWithView_ = textRotateWithView === undefined ? false : textRotateWithView;\n    this.textRotation_ = textRotation === undefined ? 0 : textRotation;\n\n    this.strokeKey_ = strokeState ?\n      (typeof strokeState.strokeStyle == 'string' ? strokeState.strokeStyle : getUid(strokeState.strokeStyle)) +\n      strokeState.lineCap + strokeState.lineDashOffset + '|' + strokeState.lineWidth +\n      strokeState.lineJoin + strokeState.miterLimit + '[' + strokeState.lineDash.join() + ']' :\n      '';\n    this.textKey_ = textState.font + textState.scale + (textState.textAlign || '?');\n    this.fillKey_ = fillState ?\n      (typeof fillState.fillStyle == 'string' ? fillState.fillStyle : ('|' + getUid(fillState.fillStyle))) :\n      '';\n  }\n};\nexport default CanvasTextReplay;\n","/**\n * @module ol/render/replay\n */\nimport ReplayType from '../render/ReplayType.js';\n\n\n/**\n * @const\n * @type {Array.<module:ol/render/ReplayType>}\n */\nexport const ORDER = [\n  ReplayType.POLYGON,\n  ReplayType.CIRCLE,\n  ReplayType.LINE_STRING,\n  ReplayType.IMAGE,\n  ReplayType.TEXT,\n  ReplayType.DEFAULT\n];\n\n/**\n * @const\n * @enum {number}\n */\nexport const TEXT_ALIGN = {};\nTEXT_ALIGN['left'] = 0;\nTEXT_ALIGN['end'] = 0;\nTEXT_ALIGN['center'] = 0.5;\nTEXT_ALIGN['right'] = 1;\nTEXT_ALIGN['start'] = 1;\nTEXT_ALIGN['top'] = 0;\nTEXT_ALIGN['middle'] = 0.5;\nTEXT_ALIGN['hanging'] = 0.2;\nTEXT_ALIGN['alphabetic'] = 0.8;\nTEXT_ALIGN['ideographic'] = 0.8;\nTEXT_ALIGN['bottom'] = 1;\n","/**\n * @module ol/renderer/Layer\n */\nimport {getUid, inherits} from '../index.js';\nimport ImageState from '../ImageState.js';\nimport Observable from '../Observable.js';\nimport TileState from '../TileState.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {FALSE, UNDEFINED} from '../functions.js';\nimport SourceState from '../source/State.js';\n\n/**\n * @constructor\n * @extends {module:ol/Observable}\n * @param {module:ol/layer/Layer} layer Layer.\n * @struct\n */\nconst LayerRenderer = function(layer) {\n\n  Observable.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/layer/Layer}\n   */\n  this.layer_ = layer;\n\n\n};\n\ninherits(LayerRenderer, Observable);\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature), module:ol/layer/Layer): T}\n *     callback Feature callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @return {T|undefined} Callback result.\n * @template S,T\n */\nLayerRenderer.prototype.forEachFeatureAtCoordinate = UNDEFINED;\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @return {boolean} Is there a feature at the given coordinate?\n */\nLayerRenderer.prototype.hasFeatureAtCoordinate = FALSE;\n\n\n/**\n * Create a function that adds loaded tiles to the tile lookup.\n * @param {module:ol/source/Tile} source Tile source.\n * @param {module:ol/proj/Projection} projection Projection of the tiles.\n * @param {Object.<number, Object.<string, module:ol/Tile>>} tiles Lookup of loaded tiles by zoom level.\n * @return {function(number, module:ol/TileRange):boolean} A function that can be\n *     called with a zoom level and a tile range to add loaded tiles to the lookup.\n * @protected\n */\nLayerRenderer.prototype.createLoadedTileFinder = function(source, projection, tiles) {\n  return (\n    /**\n     * @param {number} zoom Zoom level.\n     * @param {module:ol/TileRange} tileRange Tile range.\n     * @return {boolean} The tile range is fully loaded.\n     */\n    function(zoom, tileRange) {\n      function callback(tile) {\n        if (!tiles[zoom]) {\n          tiles[zoom] = {};\n        }\n        tiles[zoom][tile.tileCoord.toString()] = tile;\n      }\n      return source.forEachLoadedTile(projection, zoom, tileRange, callback);\n    }\n  );\n};\n\n\n/**\n * @return {module:ol/layer/Layer} Layer.\n */\nLayerRenderer.prototype.getLayer = function() {\n  return this.layer_;\n};\n\n\n/**\n * Handle changes in image state.\n * @param {module:ol/events/Event} event Image change event.\n * @private\n */\nLayerRenderer.prototype.handleImageChange_ = function(event) {\n  const image = /** @type {module:ol/Image} */ (event.target);\n  if (image.getState() === ImageState.LOADED) {\n    this.renderIfReadyAndVisible();\n  }\n};\n\n\n/**\n * Load the image if not already loaded, and register the image change\n * listener if needed.\n * @param {module:ol/ImageBase} image Image.\n * @return {boolean} `true` if the image is already loaded, `false` otherwise.\n * @protected\n */\nLayerRenderer.prototype.loadImage = function(image) {\n  let imageState = image.getState();\n  if (imageState != ImageState.LOADED && imageState != ImageState.ERROR) {\n    listen(image, EventType.CHANGE, this.handleImageChange_, this);\n  }\n  if (imageState == ImageState.IDLE) {\n    image.load();\n    imageState = image.getState();\n  }\n  return imageState == ImageState.LOADED;\n};\n\n\n/**\n * @protected\n */\nLayerRenderer.prototype.renderIfReadyAndVisible = function() {\n  const layer = this.getLayer();\n  if (layer.getVisible() && layer.getSourceState() == SourceState.READY) {\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/source/Tile} tileSource Tile source.\n * @protected\n */\nLayerRenderer.prototype.scheduleExpireCache = function(frameState, tileSource) {\n  if (tileSource.canExpireCache()) {\n    /**\n     * @param {module:ol/source/Tile} tileSource Tile source.\n     * @param {module:ol/PluggableMap} map Map.\n     * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n     */\n    const postRenderFunction = function(tileSource, map, frameState) {\n      const tileSourceKey = getUid(tileSource).toString();\n      if (tileSourceKey in frameState.usedTiles) {\n        tileSource.expireCache(frameState.viewState.projection,\n          frameState.usedTiles[tileSourceKey]);\n      }\n    }.bind(null, tileSource);\n\n    frameState.postRenderFunctions.push(\n      /** @type {module:ol/PluggableMap~PostRenderFunction} */ (postRenderFunction)\n    );\n  }\n};\n\n\n/**\n * @param {!Object.<string, !Object.<string, module:ol/TileRange>>} usedTiles Used tiles.\n * @param {module:ol/source/Tile} tileSource Tile source.\n * @param {number} z Z.\n * @param {module:ol/TileRange} tileRange Tile range.\n * @protected\n */\nLayerRenderer.prototype.updateUsedTiles = function(usedTiles, tileSource, z, tileRange) {\n  // FIXME should we use tilesToDrawByZ instead?\n  const tileSourceKey = getUid(tileSource).toString();\n  const zKey = z.toString();\n  if (tileSourceKey in usedTiles) {\n    if (zKey in usedTiles[tileSourceKey]) {\n      usedTiles[tileSourceKey][zKey].extend(tileRange);\n    } else {\n      usedTiles[tileSourceKey][zKey] = tileRange;\n    }\n  } else {\n    usedTiles[tileSourceKey] = {};\n    usedTiles[tileSourceKey][zKey] = tileRange;\n  }\n};\n\n\n/**\n * Manage tile pyramid.\n * This function performs a number of functions related to the tiles at the\n * current zoom and lower zoom levels:\n * - registers idle tiles in frameState.wantedTiles so that they are not\n *   discarded by the tile queue\n * - enqueues missing tiles\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/source/Tile} tileSource Tile source.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} currentZ Current Z.\n * @param {number} preload Load low resolution tiles up to 'preload' levels.\n * @param {function(this: T, module:ol/Tile)=} opt_tileCallback Tile callback.\n * @param {T=} opt_this Object to use as `this` in `opt_tileCallback`.\n * @protected\n * @template T\n */\nLayerRenderer.prototype.manageTilePyramid = function(\n  frameState, tileSource, tileGrid, pixelRatio, projection, extent,\n  currentZ, preload, opt_tileCallback, opt_this) {\n  const tileSourceKey = getUid(tileSource).toString();\n  if (!(tileSourceKey in frameState.wantedTiles)) {\n    frameState.wantedTiles[tileSourceKey] = {};\n  }\n  const wantedTiles = frameState.wantedTiles[tileSourceKey];\n  const tileQueue = frameState.tileQueue;\n  const minZoom = tileGrid.getMinZoom();\n  let tile, tileRange, tileResolution, x, y, z;\n  for (z = minZoom; z <= currentZ; ++z) {\n    tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z, tileRange);\n    tileResolution = tileGrid.getResolution(z);\n    for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n        if (currentZ - z <= preload) {\n          tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n          if (tile.getState() == TileState.IDLE) {\n            wantedTiles[tile.getKey()] = true;\n            if (!tileQueue.isKeyQueued(tile.getKey())) {\n              tileQueue.enqueue([tile, tileSourceKey,\n                tileGrid.getTileCoordCenter(tile.tileCoord), tileResolution]);\n            }\n          }\n          if (opt_tileCallback !== undefined) {\n            opt_tileCallback.call(opt_this, tile);\n          }\n        } else {\n          tileSource.useTile(z, x, y, projection);\n        }\n      }\n    }\n  }\n};\nexport default LayerRenderer;\n","/**\n * @module ol/renderer/Map\n */\nimport {getUid, inherits} from '../index.js';\nimport Disposable from '../Disposable.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getWidth} from '../extent.js';\nimport {TRUE, UNDEFINED} from '../functions.js';\nimport {visibleAtResolution} from '../layer/Layer.js';\nimport {shared as iconImageCache} from '../style/IconImageCache.js';\nimport {compose as composeTransform, invert as invertTransform, setFromArray as transformSetFromArray} from '../transform.js';\n\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/Disposable}\n * @param {module:ol/PluggableMap} map Map.\n * @struct\n */\nconst MapRenderer = function(map) {\n  Disposable.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = map;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/renderer/Layer>}\n   */\n  this.layerRenderers_ = {};\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/events~EventsKey>}\n   */\n  this.layerRendererListeners_ = {};\n\n  /**\n   * @private\n   * @type {Array.<module:ol/renderer/Layer>}\n   */\n  this.layerRendererConstructors_ = [];\n\n};\n\ninherits(MapRenderer, Disposable);\n\n\n/**\n * Register layer renderer constructors.\n * @param {Array.<module:ol/renderer/Layer>} constructors Layer renderers.\n */\nMapRenderer.prototype.registerLayerRenderers = function(constructors) {\n  this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_, constructors);\n};\n\n\n/**\n * Get the registered layer renderer constructors.\n * @return {Array.<module:ol/renderer/Layer>} Registered layer renderers.\n */\nMapRenderer.prototype.getLayerRendererConstructors = function() {\n  return this.layerRendererConstructors_;\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @protected\n */\nMapRenderer.prototype.calculateMatrices2D = function(frameState) {\n  const viewState = frameState.viewState;\n  const coordinateToPixelTransform = frameState.coordinateToPixelTransform;\n  const pixelToCoordinateTransform = frameState.pixelToCoordinateTransform;\n\n  composeTransform(coordinateToPixelTransform,\n    frameState.size[0] / 2, frameState.size[1] / 2,\n    1 / viewState.resolution, -1 / viewState.resolution,\n    -viewState.rotation,\n    -viewState.center[0], -viewState.center[1]);\n\n  invertTransform(\n    transformSetFromArray(pixelToCoordinateTransform, coordinateToPixelTransform));\n};\n\n\n/**\n * Removes all layer renderers.\n */\nMapRenderer.prototype.removeLayerRenderers = function() {\n  for (const key in this.layerRenderers_) {\n    this.removeLayerRendererByKey_(key).dispose();\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n */\nfunction expireIconCache(map, frameState) {\n  iconImageCache.expire();\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature),\n *     module:ol/layer/Layer): T} callback Feature callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\n *     function, only layers which are visible and for which this function\n *     returns `true` will be tested for features.  By default, all visible\n *     layers will be tested.\n * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nMapRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg,\n  layerFilter, thisArg2) {\n  let result;\n  const viewState = frameState.viewState;\n  const viewResolution = viewState.resolution;\n\n  /**\n   * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n   * @param {module:ol/layer/Layer} layer Layer.\n   * @return {?} Callback result.\n   */\n  function forEachFeatureAtCoordinate(feature, layer) {\n    const key = getUid(feature).toString();\n    const managed = frameState.layerStates[getUid(layer)].managed;\n    if (!(key in frameState.skippedFeatureUids && !managed)) {\n      return callback.call(thisArg, feature, managed ? layer : null);\n    }\n  }\n\n  const projection = viewState.projection;\n\n  let translatedCoordinate = coordinate;\n  if (projection.canWrapX()) {\n    const projectionExtent = projection.getExtent();\n    const worldWidth = getWidth(projectionExtent);\n    const x = coordinate[0];\n    if (x < projectionExtent[0] || x > projectionExtent[2]) {\n      const worldsAway = Math.ceil((projectionExtent[0] - x) / worldWidth);\n      translatedCoordinate = [x + worldWidth * worldsAway, coordinate[1]];\n    }\n  }\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewResolution) && layerFilter.call(thisArg2, layer)) {\n      const layerRenderer = this.getLayerRenderer(layer);\n      if (layer.getSource()) {\n        result = layerRenderer.forEachFeatureAtCoordinate(\n          layer.getSource().getWrapX() ? translatedCoordinate : coordinate,\n          frameState, hitTolerance, forEachFeatureAtCoordinate, thisArg);\n      }\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @abstract\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n *     callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\n *     function, only layers which are visible and for which this function\n *     returns `true` will be tested for features.  By default, all visible\n *     layers will be tested.\n * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nMapRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg,\n  layerFilter, thisArg2) {};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\n *     function, only layers which are visible and for which this function\n *     returns `true` will be tested for features.  By default, all visible\n *     layers will be tested.\n * @param {U} thisArg Value to use as `this` when executing `layerFilter`.\n * @return {boolean} Is there a feature at the given coordinate?\n * @template U\n */\nMapRenderer.prototype.hasFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, layerFilter, thisArg) {\n  const hasFeature = this.forEachFeatureAtCoordinate(\n    coordinate, frameState, hitTolerance, TRUE, this, layerFilter, thisArg);\n\n  return hasFeature !== undefined;\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @protected\n * @return {module:ol/renderer/Layer} Layer renderer.\n */\nMapRenderer.prototype.getLayerRenderer = function(layer) {\n  const layerKey = getUid(layer).toString();\n  if (layerKey in this.layerRenderers_) {\n    return this.layerRenderers_[layerKey];\n  } else {\n    let renderer;\n    for (let i = 0, ii = this.layerRendererConstructors_.length; i < ii; ++i) {\n      const candidate = this.layerRendererConstructors_[i];\n      if (candidate['handles'](layer)) {\n        renderer = candidate['create'](this, layer);\n        break;\n      }\n    }\n    if (renderer) {\n      this.layerRenderers_[layerKey] = renderer;\n      this.layerRendererListeners_[layerKey] = listen(renderer,\n        EventType.CHANGE, this.handleLayerRendererChange_, this);\n    } else {\n      throw new Error('Unable to create renderer for layer: ' + layer.getType());\n    }\n    return renderer;\n  }\n};\n\n\n/**\n * @param {string} layerKey Layer key.\n * @protected\n * @return {module:ol/renderer/Layer} Layer renderer.\n */\nMapRenderer.prototype.getLayerRendererByKey = function(layerKey) {\n  return this.layerRenderers_[layerKey];\n};\n\n\n/**\n * @protected\n * @return {Object.<string, module:ol/renderer/Layer>} Layer renderers.\n */\nMapRenderer.prototype.getLayerRenderers = function() {\n  return this.layerRenderers_;\n};\n\n\n/**\n * @return {module:ol/PluggableMap} Map.\n */\nMapRenderer.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Handle changes in a layer renderer.\n * @private\n */\nMapRenderer.prototype.handleLayerRendererChange_ = function() {\n  this.map_.render();\n};\n\n\n/**\n * @param {string} layerKey Layer key.\n * @return {module:ol/renderer/Layer} Layer renderer.\n * @private\n */\nMapRenderer.prototype.removeLayerRendererByKey_ = function(layerKey) {\n  const layerRenderer = this.layerRenderers_[layerKey];\n  delete this.layerRenderers_[layerKey];\n\n  unlistenByKey(this.layerRendererListeners_[layerKey]);\n  delete this.layerRendererListeners_[layerKey];\n\n  return layerRenderer;\n};\n\n\n/**\n * Render.\n * @param {?module:ol/PluggableMap~FrameState} frameState Frame state.\n */\nMapRenderer.prototype.renderFrame = UNDEFINED;\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nMapRenderer.prototype.removeUnusedLayerRenderers_ = function(map, frameState) {\n  for (const layerKey in this.layerRenderers_) {\n    if (!frameState || !(layerKey in frameState.layerStates)) {\n      this.removeLayerRendererByKey_(layerKey).dispose();\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @protected\n */\nMapRenderer.prototype.scheduleExpireIconCache = function(frameState) {\n  frameState.postRenderFunctions.push(/** @type {module:ol/PluggableMap~PostRenderFunction} */ (expireIconCache));\n};\n\n\n/**\n * @param {!module:ol/PluggableMap~FrameState} frameState Frame state.\n * @protected\n */\nMapRenderer.prototype.scheduleRemoveUnusedLayerRenderers = function(frameState) {\n  for (const layerKey in this.layerRenderers_) {\n    if (!(layerKey in frameState.layerStates)) {\n      frameState.postRenderFunctions.push(\n        /** @type {module:ol/PluggableMap~PostRenderFunction} */ (this.removeUnusedLayerRenderers_.bind(this))\n      );\n      return;\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/layer/Layer~State} state1 First layer state.\n * @param {module:ol/layer/Layer~State} state2 Second layer state.\n * @return {number} The zIndex difference.\n */\nexport function sortByZIndex(state1, state2) {\n  return state1.zIndex - state2.zIndex;\n}\nexport default MapRenderer;\n","/**\n * @module ol/renderer/canvas/ImageLayer\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../../reproj/common.js';\nimport {inherits} from '../../index.js';\nimport ImageCanvas from '../../ImageCanvas.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {equals} from '../../array.js';\nimport {getHeight, getIntersection, getWidth, isEmpty} from '../../extent.js';\nimport VectorRenderType from '../../layer/VectorRenderType.js';\nimport {assign} from '../../obj.js';\nimport {layerRendererConstructors} from './Map.js';\nimport IntermediateCanvasRenderer from '../canvas/IntermediateCanvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/IntermediateCanvas}\n * @param {module:ol/layer/Image|module:ol/layer/Vector} imageLayer Image or vector layer.\n * @api\n */\nconst CanvasImageLayerRenderer = function(imageLayer) {\n\n  IntermediateCanvasRenderer.call(this, imageLayer);\n\n  /**\n   * @private\n   * @type {?module:ol/ImageBase}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.imageTransform_ = createTransform();\n\n  /**\n   * @type {!Array.<string>}\n   */\n  this.skippedFeatures_ = [];\n\n  /**\n   * @private\n   * @type {module:ol/renderer/canvas/VectorLayer}\n   */\n  this.vectorRenderer_ = null;\n\n  if (imageLayer.getType() === LayerType.VECTOR) {\n    for (let i = 0, ii = layerRendererConstructors.length; i < ii; ++i) {\n      const ctor = layerRendererConstructors[i];\n      if (ctor !== CanvasImageLayerRenderer && ctor['handles'](imageLayer)) {\n        this.vectorRenderer_ = new ctor(imageLayer);\n        break;\n      }\n    }\n  }\n\n};\n\ninherits(CanvasImageLayerRenderer, IntermediateCanvasRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasImageLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.IMAGE ||\n    layer.getType() === LayerType.VECTOR &&\n    /** @type {module:ol/layer/Vector} */ (layer).getRenderMode() === VectorRenderType.IMAGE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/ImageLayer} The layer renderer.\n */\nCanvasImageLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasImageLayerRenderer(/** @type {module:ol/layer/Image} */ (layer));\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.disposeInternal = function() {\n  if (this.vectorRenderer_) {\n    this.vectorRenderer_.dispose();\n  }\n  IntermediateCanvasRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.getImage = function() {\n  return !this.image_ ? null : this.image_.getImage();\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.getImageTransform = function() {\n  return this.imageTransform_;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n\n  const pixelRatio = frameState.pixelRatio;\n  const size = frameState.size;\n  const viewState = frameState.viewState;\n  const viewCenter = viewState.center;\n  const viewResolution = viewState.resolution;\n\n  let image;\n  const imageLayer = /** @type {module:ol/layer/Image} */ (this.getLayer());\n  const imageSource = imageLayer.getSource();\n\n  const hints = frameState.viewHints;\n\n  const vectorRenderer = this.vectorRenderer_;\n  let renderedExtent = frameState.extent;\n  if (!vectorRenderer && layerState.extent !== undefined) {\n    renderedExtent = getIntersection(renderedExtent, layerState.extent);\n  }\n\n  if (!hints[ViewHint.ANIMATING] && !hints[ViewHint.INTERACTING] &&\n      !isEmpty(renderedExtent)) {\n    let projection = viewState.projection;\n    if (!ENABLE_RASTER_REPROJECTION) {\n      const sourceProjection = imageSource.getProjection();\n      if (sourceProjection) {\n        projection = sourceProjection;\n      }\n    }\n    let skippedFeatures = this.skippedFeatures_;\n    if (vectorRenderer) {\n      const context = vectorRenderer.context;\n      const imageFrameState = /** @type {module:ol/PluggableMap~FrameState} */ (assign({}, frameState, {\n        size: [\n          getWidth(renderedExtent) / viewResolution,\n          getHeight(renderedExtent) / viewResolution\n        ],\n        viewState: /** @type {module:ol/View~State} */ (assign({}, frameState.viewState, {\n          rotation: 0\n        }))\n      }));\n      const newSkippedFeatures = Object.keys(imageFrameState.skippedFeatureUids).sort();\n      image = new ImageCanvas(renderedExtent, viewResolution, pixelRatio, context.canvas, function(callback) {\n        if (vectorRenderer.prepareFrame(imageFrameState, layerState) &&\n            (vectorRenderer.replayGroupChanged ||\n            !equals(skippedFeatures, newSkippedFeatures))) {\n          context.canvas.width = imageFrameState.size[0] * pixelRatio;\n          context.canvas.height = imageFrameState.size[1] * pixelRatio;\n          vectorRenderer.compose(context, imageFrameState, layerState);\n          skippedFeatures = newSkippedFeatures;\n          callback();\n        }\n      });\n    } else {\n      image = imageSource.getImage(\n        renderedExtent, viewResolution, pixelRatio, projection);\n    }\n    if (image && this.loadImage(image)) {\n      this.image_ = image;\n      this.skippedFeatures_ = skippedFeatures;\n    }\n  }\n\n  if (this.image_) {\n    image = this.image_;\n    const imageExtent = image.getExtent();\n    const imageResolution = image.getResolution();\n    const imagePixelRatio = image.getPixelRatio();\n    const scale = pixelRatio * imageResolution /\n        (viewResolution * imagePixelRatio);\n    const transform = composeTransform(this.imageTransform_,\n      pixelRatio * size[0] / 2, pixelRatio * size[1] / 2,\n      scale, scale,\n      0,\n      imagePixelRatio * (imageExtent[0] - viewCenter[0]) / imageResolution,\n      imagePixelRatio * (viewCenter[1] - imageExtent[3]) / imageResolution);\n    composeTransform(this.coordinateToCanvasPixelTransform,\n      pixelRatio * size[0] / 2 - transform[4], pixelRatio * size[1] / 2 - transform[5],\n      pixelRatio / viewResolution, -pixelRatio / viewResolution,\n      0,\n      -viewCenter[0], -viewCenter[1]);\n\n    this.renderedResolution = imageResolution * pixelRatio / imagePixelRatio;\n  }\n\n  return !!this.image_;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  if (this.vectorRenderer_) {\n    return this.vectorRenderer_.forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, thisArg);\n  } else {\n    return IntermediateCanvasRenderer.prototype.forEachFeatureAtCoordinate.call(this, coordinate, frameState, hitTolerance, callback, thisArg);\n  }\n};\n\n\nexport default CanvasImageLayerRenderer;\n","/**\n * @module ol/renderer/canvas/IntermediateCanvas\n */\nimport {inherits} from '../../index.js';\nimport {scale as scaleCoordinate} from '../../coordinate.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {containsExtent, intersects} from '../../extent.js';\nimport {UNDEFINED} from '../../functions.js';\nimport CanvasLayerRenderer from '../canvas/Layer.js';\nimport {create as createTransform, apply as applyTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/renderer/canvas/Layer}\n * @param {module:ol/layer/Layer} layer Layer.\n */\nconst IntermediateCanvasRenderer = function(layer) {\n\n  CanvasLayerRenderer.call(this, layer);\n\n  /**\n   * @protected\n   * @type {module:ol/transform~Transform}\n   */\n  this.coordinateToCanvasPixelTransform = createTransform();\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.hitCanvasContext_ = null;\n\n};\n\ninherits(IntermediateCanvasRenderer, CanvasLayerRenderer);\n\n\n/**\n * @inheritDoc\n */\nIntermediateCanvasRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n\n  this.preCompose(context, frameState);\n\n  const image = this.getImage();\n  if (image) {\n\n    // clipped rendering if layer extent is set\n    const extent = layerState.extent;\n    const clipped = extent !== undefined &&\n        !containsExtent(extent, frameState.extent) &&\n        intersects(extent, frameState.extent);\n    if (clipped) {\n      this.clip(context, frameState, /** @type {module:ol/extent~Extent} */ (extent));\n    }\n\n    const imageTransform = this.getImageTransform();\n    // for performance reasons, context.save / context.restore is not used\n    // to save and restore the transformation matrix and the opacity.\n    // see http://jsperf.com/context-save-restore-versus-variable\n    const alpha = context.globalAlpha;\n    context.globalAlpha = layerState.opacity;\n\n    // for performance reasons, context.setTransform is only used\n    // when the view is rotated. see http://jsperf.com/canvas-transform\n    const dx = imageTransform[4];\n    const dy = imageTransform[5];\n    const dw = image.width * imageTransform[0];\n    const dh = image.height * imageTransform[3];\n    context.drawImage(image, 0, 0, +image.width, +image.height,\n      Math.round(dx), Math.round(dy), Math.round(dw), Math.round(dh));\n    context.globalAlpha = alpha;\n\n    if (clipped) {\n      context.restore();\n    }\n  }\n\n  this.postCompose(context, frameState, layerState);\n};\n\n\n/**\n * @abstract\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Canvas.\n */\nIntermediateCanvasRenderer.prototype.getImage = function() {};\n\n\n/**\n * @abstract\n * @return {!module:ol/transform~Transform} Image transform.\n */\nIntermediateCanvasRenderer.prototype.getImageTransform = function() {};\n\n\n/**\n * @inheritDoc\n */\nIntermediateCanvasRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  const layer = this.getLayer();\n  const source = layer.getSource();\n  const resolution = frameState.viewState.resolution;\n  const rotation = frameState.viewState.rotation;\n  const skippedFeatureUids = frameState.skippedFeatureUids;\n  return source.forEachFeatureAtCoordinate(\n    coordinate, resolution, rotation, hitTolerance, skippedFeatureUids,\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @return {?} Callback result.\n     */\n    function(feature) {\n      return callback.call(thisArg, feature, layer);\n    });\n};\n\n\n/**\n * @inheritDoc\n */\nIntermediateCanvasRenderer.prototype.forEachLayerAtCoordinate = function(coordinate, frameState, callback, thisArg) {\n  if (!this.getImage()) {\n    return undefined;\n  }\n\n  if (this.getLayer().getSource().forEachFeatureAtCoordinate !== UNDEFINED) {\n    // for ImageCanvas sources use the original hit-detection logic,\n    // so that for example also transparent polygons are detected\n    return CanvasLayerRenderer.prototype.forEachLayerAtCoordinate.apply(this, arguments);\n  } else {\n    const pixel = applyTransform(this.coordinateToCanvasPixelTransform, coordinate.slice());\n    scaleCoordinate(pixel, frameState.viewState.resolution / this.renderedResolution);\n\n    if (!this.hitCanvasContext_) {\n      this.hitCanvasContext_ = createCanvasContext2D(1, 1);\n    }\n\n    this.hitCanvasContext_.clearRect(0, 0, 1, 1);\n    this.hitCanvasContext_.drawImage(this.getImage(), pixel[0], pixel[1], 1, 1, 0, 0, 1, 1);\n\n    const imageData = this.hitCanvasContext_.getImageData(0, 0, 1, 1).data;\n    if (imageData[3] > 0) {\n      return callback.call(thisArg, this.getLayer(),  imageData);\n    } else {\n      return undefined;\n    }\n  }\n};\nexport default IntermediateCanvasRenderer;\n","/**\n * @module ol/renderer/canvas/Layer\n */\nimport {inherits} from '../../index.js';\nimport {getBottomLeft, getBottomRight, getTopLeft, getTopRight} from '../../extent.js';\nimport {TRUE} from '../../functions.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {rotateAtOffset} from '../../render/canvas.js';\nimport CanvasImmediateRenderer from '../../render/canvas/Immediate.js';\nimport LayerRenderer from '../Layer.js';\nimport {create as createTransform, apply as applyTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/renderer/Layer}\n * @param {module:ol/layer/Layer} layer Layer.\n */\nconst CanvasLayerRenderer = function(layer) {\n\n  LayerRenderer.call(this, layer);\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.renderedResolution;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.transform_ = createTransform();\n\n};\n\ninherits(CanvasLayerRenderer, LayerRenderer);\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/extent~Extent} extent Clip extent.\n * @protected\n */\nCanvasLayerRenderer.prototype.clip = function(context, frameState, extent) {\n  const pixelRatio = frameState.pixelRatio;\n  const width = frameState.size[0] * pixelRatio;\n  const height = frameState.size[1] * pixelRatio;\n  const rotation = frameState.viewState.rotation;\n  const topLeft = getTopLeft(/** @type {module:ol/extent~Extent} */ (extent));\n  const topRight = getTopRight(/** @type {module:ol/extent~Extent} */ (extent));\n  const bottomRight = getBottomRight(/** @type {module:ol/extent~Extent} */ (extent));\n  const bottomLeft = getBottomLeft(/** @type {module:ol/extent~Extent} */ (extent));\n\n  applyTransform(frameState.coordinateToPixelTransform, topLeft);\n  applyTransform(frameState.coordinateToPixelTransform, topRight);\n  applyTransform(frameState.coordinateToPixelTransform, bottomRight);\n  applyTransform(frameState.coordinateToPixelTransform, bottomLeft);\n\n  context.save();\n  rotateAtOffset(context, -rotation, width / 2, height / 2);\n  context.beginPath();\n  context.moveTo(topLeft[0] * pixelRatio, topLeft[1] * pixelRatio);\n  context.lineTo(topRight[0] * pixelRatio, topRight[1] * pixelRatio);\n  context.lineTo(bottomRight[0] * pixelRatio, bottomRight[1] * pixelRatio);\n  context.lineTo(bottomLeft[0] * pixelRatio, bottomLeft[1] * pixelRatio);\n  context.clip();\n  rotateAtOffset(context, rotation, width / 2, height / 2);\n};\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @private\n */\nCanvasLayerRenderer.prototype.dispatchComposeEvent_ = function(type, context, frameState, opt_transform) {\n  const layer = this.getLayer();\n  if (layer.hasListener(type)) {\n    const width = frameState.size[0] * frameState.pixelRatio;\n    const height = frameState.size[1] * frameState.pixelRatio;\n    const rotation = frameState.viewState.rotation;\n    rotateAtOffset(context, -rotation, width / 2, height / 2);\n    const transform = opt_transform !== undefined ?\n      opt_transform : this.getTransform(frameState, 0);\n    const render = new CanvasImmediateRenderer(\n      context, frameState.pixelRatio, frameState.extent, transform,\n      frameState.viewState.rotation);\n    const composeEvent = new RenderEvent(type, render, frameState,\n      context, null);\n    layer.dispatchEvent(composeEvent);\n    rotateAtOffset(context, rotation, width / 2, height / 2);\n  }\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n *     callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nCanvasLayerRenderer.prototype.forEachLayerAtCoordinate = function(coordinate, frameState, callback, thisArg) {\n  const hasFeature = this.forEachFeatureAtCoordinate(coordinate, frameState, 0, TRUE, this);\n\n  if (hasFeature) {\n    return callback.call(thisArg, this.getLayer(), null);\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @protected\n */\nCanvasLayerRenderer.prototype.postCompose = function(context, frameState, layerState, opt_transform) {\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, context, frameState, opt_transform);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @protected\n */\nCanvasLayerRenderer.prototype.preCompose = function(context, frameState, opt_transform) {\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, context, frameState, opt_transform);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @protected\n */\nCanvasLayerRenderer.prototype.dispatchRenderEvent = function(context, frameState, opt_transform) {\n  this.dispatchComposeEvent_(RenderEventType.RENDER, context, frameState, opt_transform);\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {number} offsetX Offset on the x-axis in view coordinates.\n * @protected\n * @return {!module:ol/transform~Transform} Transform.\n */\nCanvasLayerRenderer.prototype.getTransform = function(frameState, offsetX) {\n  const viewState = frameState.viewState;\n  const pixelRatio = frameState.pixelRatio;\n  const dx1 = pixelRatio * frameState.size[0] / 2;\n  const dy1 = pixelRatio * frameState.size[1] / 2;\n  const sx = pixelRatio / viewState.resolution;\n  const sy = -sx;\n  const angle = -viewState.rotation;\n  const dx2 = -viewState.center[0] + offsetX;\n  const dy2 = -viewState.center[1];\n  return composeTransform(this.transform_, dx1, dy1, sx, sy, angle, dx2, dy2);\n};\n\n\n/**\n * @abstract\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {CanvasRenderingContext2D} context Context.\n */\nCanvasLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {};\n\n/**\n * @abstract\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @return {boolean} whether composeFrame should be called.\n */\nCanvasLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {};\nexport default CanvasLayerRenderer;\n","/**\n * @module ol/renderer/canvas/Map\n */\nimport {create as createTransform, apply as applyTransform, compose as composeTransform} from '../../transform.js';\nimport {inherits} from '../../index.js';\nimport {includes, stableSort} from '../../array.js';\nimport {CLASS_UNSELECTABLE} from '../../css.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {visibleAtResolution} from '../../layer/Layer.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {rotateAtOffset} from '../../render/canvas.js';\nimport CanvasImmediateRenderer from '../../render/canvas/Immediate.js';\nimport MapRenderer, {sortByZIndex} from '../Map.js';\nimport SourceState from '../../source/State.js';\n\n\n/**\n * @type {Array.<module:ol/renderer/Layer>}\n */\nexport const layerRendererConstructors = [];\n\n\n/**\n * @constructor\n * @extends {module:ol/renderer/Map}\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nconst CanvasMapRenderer = function(map) {\n  MapRenderer.call(this, map);\n\n  const container = map.getViewport();\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context_ = createCanvasContext2D();\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = this.context_.canvas;\n\n  this.canvas_.style.width = '100%';\n  this.canvas_.style.height = '100%';\n  this.canvas_.style.display = 'block';\n  this.canvas_.className = CLASS_UNSELECTABLE;\n  container.insertBefore(this.canvas_, container.childNodes[0] || null);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = true;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.transform_ = createTransform();\n\n};\n\ninherits(CanvasMapRenderer, MapRenderer);\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nCanvasMapRenderer.prototype.dispatchComposeEvent_ = function(type, frameState) {\n  const map = this.getMap();\n  const context = this.context_;\n  if (map.hasListener(type)) {\n    const extent = frameState.extent;\n    const pixelRatio = frameState.pixelRatio;\n    const viewState = frameState.viewState;\n    const rotation = viewState.rotation;\n\n    const transform = this.getTransform(frameState);\n\n    const vectorContext = new CanvasImmediateRenderer(context, pixelRatio,\n      extent, transform, rotation);\n    const composeEvent = new RenderEvent(type, vectorContext,\n      frameState, context, null);\n    map.dispatchEvent(composeEvent);\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @protected\n * @return {!module:ol/transform~Transform} Transform.\n */\nCanvasMapRenderer.prototype.getTransform = function(frameState) {\n  const viewState = frameState.viewState;\n  const dx1 = this.canvas_.width / 2;\n  const dy1 = this.canvas_.height / 2;\n  const sx = frameState.pixelRatio / viewState.resolution;\n  const sy = -sx;\n  const angle = -viewState.rotation;\n  const dx2 = -viewState.center[0];\n  const dy2 = -viewState.center[1];\n  return composeTransform(this.transform_, dx1, dy1, sx, sy, angle, dx2, dy2);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasMapRenderer.prototype.renderFrame = function(frameState) {\n\n  if (!frameState) {\n    if (this.renderedVisible_) {\n      this.canvas_.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return;\n  }\n\n  const context = this.context_;\n  const pixelRatio = frameState.pixelRatio;\n  const width = Math.round(frameState.size[0] * pixelRatio);\n  const height = Math.round(frameState.size[1] * pixelRatio);\n  if (this.canvas_.width != width || this.canvas_.height != height) {\n    this.canvas_.width = width;\n    this.canvas_.height = height;\n  } else {\n    context.clearRect(0, 0, width, height);\n  }\n\n  const rotation = frameState.viewState.rotation;\n\n  this.calculateMatrices2D(frameState);\n\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, frameState);\n\n  const layerStatesArray = frameState.layerStatesArray;\n  stableSort(layerStatesArray, sortByZIndex);\n\n  if (rotation) {\n    context.save();\n    rotateAtOffset(context, rotation, width / 2, height / 2);\n  }\n\n  const viewResolution = frameState.viewState.resolution;\n  let i, ii, layer, layerRenderer, layerState;\n  for (i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n    layerState = layerStatesArray[i];\n    layer = layerState.layer;\n    layerRenderer = /** @type {module:ol/renderer/canvas/Layer} */ (this.getLayerRenderer(layer));\n    if (!visibleAtResolution(layerState, viewResolution) ||\n        layerState.sourceState != SourceState.READY) {\n      continue;\n    }\n    if (layerRenderer.prepareFrame(frameState, layerState)) {\n      layerRenderer.composeFrame(frameState, layerState, context);\n    }\n  }\n\n  if (rotation) {\n    context.restore();\n  }\n\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, frameState);\n\n  if (!this.renderedVisible_) {\n    this.canvas_.style.display = '';\n    this.renderedVisible_ = true;\n  }\n\n  this.scheduleRemoveUnusedLayerRenderers(frameState);\n  this.scheduleExpireIconCache(frameState);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasMapRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg,\n  layerFilter, thisArg2) {\n  let result;\n  const viewState = frameState.viewState;\n  const viewResolution = viewState.resolution;\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n\n  const coordinate = applyTransform(\n    frameState.pixelToCoordinateTransform, pixel.slice());\n\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewResolution) && layerFilter.call(thisArg2, layer)) {\n      const layerRenderer = /** @type {module:ol/renderer/canvas/Layer} */ (this.getLayerRenderer(layer));\n      result = layerRenderer.forEachLayerAtCoordinate(\n        coordinate, frameState, callback, thisArg);\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasMapRenderer.prototype.registerLayerRenderers = function(constructors) {\n  MapRenderer.prototype.registerLayerRenderers.call(this, constructors);\n  for (let i = 0, ii = constructors.length; i < ii; ++i) {\n    const ctor = constructors[i];\n    if (!includes(layerRendererConstructors, ctor)) {\n      layerRendererConstructors.push(ctor);\n    }\n  }\n};\n\nexport default CanvasMapRenderer;\n","/**\n * @module ol/renderer/canvas/TileLayer\n */\nimport {getUid, inherits} from '../../index.js';\nimport LayerType from '../../LayerType.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {containsExtent, createEmpty, equals, getIntersection, isEmpty} from '../../extent.js';\nimport IntermediateCanvasRenderer from '../canvas/IntermediateCanvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/IntermediateCanvas}\n * @param {module:ol/layer/Tile|module:ol/layer/VectorTile} tileLayer Tile layer.\n * @api\n */\nconst CanvasTileLayerRenderer = function(tileLayer) {\n\n  IntermediateCanvasRenderer.call(this, tileLayer);\n\n  /**\n   * @protected\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context = this.context === null ? null : createCanvasContext2D();\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.oversampling_;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedExtent_ = null;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.renderedRevision;\n\n  /**\n   * @protected\n   * @type {!Array.<module:ol/Tile>}\n   */\n  this.renderedTiles = [];\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.newTiles_ = false;\n\n  /**\n   * @protected\n   * @type {module:ol/extent~Extent}\n   */\n  this.tmpExtent = createEmpty();\n\n  /**\n   * @private\n   * @type {module:ol/TileRange}\n   */\n  this.tmpTileRange_ = new TileRange(0, 0, 0, 0);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.imageTransform_ = createTransform();\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.zDirection = 0;\n\n};\n\ninherits(CanvasTileLayerRenderer, IntermediateCanvasRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/TileLayer} The layer renderer.\n */\nCanvasTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasTileLayerRenderer(/** @type {module:ol/layer/Tile} */ (layer));\n};\n\n\n/**\n * @private\n * @param {module:ol/Tile} tile Tile.\n * @return {boolean} Tile is drawable.\n */\nCanvasTileLayerRenderer.prototype.isDrawableTile_ = function(tile) {\n  const tileState = tile.getState();\n  const useInterimTilesOnError = this.getLayer().getUseInterimTilesOnError();\n  return tileState == TileState.LOADED ||\n      tileState == TileState.EMPTY ||\n      tileState == TileState.ERROR && !useInterimTilesOnError;\n};\n\n\n/**\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/Tile} Tile.\n */\nCanvasTileLayerRenderer.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const layer = this.getLayer();\n  const source = /** @type {module:ol/source/Tile} */ (layer.getSource());\n  let tile = source.getTile(z, x, y, pixelRatio, projection);\n  if (tile.getState() == TileState.ERROR) {\n    if (!layer.getUseInterimTilesOnError()) {\n      // When useInterimTilesOnError is false, we consider the error tile as loaded.\n      tile.setState(TileState.LOADED);\n    } else if (layer.getPreload() > 0) {\n      // Preloaded tiles for lower resolutions might have finished loading.\n      this.newTiles_ = true;\n    }\n  }\n  if (!this.isDrawableTile_(tile)) {\n    tile = tile.getInterimTile();\n  }\n  return tile;\n};\n\n/**\n * @inheritDoc\n */\nCanvasTileLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n\n  const pixelRatio = frameState.pixelRatio;\n  const size = frameState.size;\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const viewResolution = viewState.resolution;\n  const viewCenter = viewState.center;\n\n  const tileLayer = this.getLayer();\n  const tileSource = /** @type {module:ol/source/Tile} */ (tileLayer.getSource());\n  const sourceRevision = tileSource.getRevision();\n  const tileGrid = tileSource.getTileGridForProjection(projection);\n  const z = tileGrid.getZForResolution(viewResolution, this.zDirection);\n  const tileResolution = tileGrid.getResolution(z);\n  let oversampling = Math.round(viewResolution / tileResolution) || 1;\n  let extent = frameState.extent;\n\n  if (layerState.extent !== undefined) {\n    extent = getIntersection(extent, layerState.extent);\n  }\n  if (isEmpty(extent)) {\n    // Return false to prevent the rendering of the layer.\n    return false;\n  }\n\n  const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n  const imageExtent = tileGrid.getTileRangeExtent(z, tileRange);\n\n  const tilePixelRatio = tileSource.getTilePixelRatio(pixelRatio);\n\n  /**\n   * @type {Object.<number, Object.<string, module:ol/Tile>>}\n   */\n  const tilesToDrawByZ = {};\n  tilesToDrawByZ[z] = {};\n\n  const findLoadedTiles = this.createLoadedTileFinder(\n    tileSource, projection, tilesToDrawByZ);\n\n  const hints = frameState.viewHints;\n  const animatingOrInteracting = hints[ViewHint.ANIMATING] || hints[ViewHint.INTERACTING];\n\n  const tmpExtent = this.tmpExtent;\n  const tmpTileRange = this.tmpTileRange_;\n  this.newTiles_ = false;\n  let tile, x, y;\n  for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n    for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n      if (Date.now() - frameState.time > 16 && animatingOrInteracting) {\n        continue;\n      }\n      tile = this.getTile(z, x, y, pixelRatio, projection);\n      if (this.isDrawableTile_(tile)) {\n        const uid = getUid(this);\n        if (tile.getState() == TileState.LOADED) {\n          tilesToDrawByZ[z][tile.tileCoord.toString()] = tile;\n          const inTransition = tile.inTransition(uid);\n          if (!this.newTiles_ && (inTransition || this.renderedTiles.indexOf(tile) === -1)) {\n            this.newTiles_ = true;\n          }\n        }\n        if (tile.getAlpha(uid, frameState.time) === 1) {\n          // don't look for alt tiles if alpha is 1\n          continue;\n        }\n      }\n\n      const childTileRange = tileGrid.getTileCoordChildTileRange(\n        tile.tileCoord, tmpTileRange, tmpExtent);\n      let covered = false;\n      if (childTileRange) {\n        covered = findLoadedTiles(z + 1, childTileRange);\n      }\n      if (!covered) {\n        tileGrid.forEachTileCoordParentTileRange(\n          tile.tileCoord, findLoadedTiles, null, tmpTileRange, tmpExtent);\n      }\n\n    }\n  }\n\n  const renderedResolution = tileResolution * pixelRatio / tilePixelRatio * oversampling;\n  if (!(this.renderedResolution && Date.now() - frameState.time > 16 && animatingOrInteracting) && (\n    this.newTiles_ ||\n        !(this.renderedExtent_ && containsExtent(this.renderedExtent_, extent)) ||\n        this.renderedRevision != sourceRevision ||\n        oversampling != this.oversampling_ ||\n        !animatingOrInteracting && renderedResolution != this.renderedResolution\n  )) {\n\n    const context = this.context;\n    if (context) {\n      const tilePixelSize = tileSource.getTilePixelSize(z, pixelRatio, projection);\n      const width = Math.round(tileRange.getWidth() * tilePixelSize[0] / oversampling);\n      const height = Math.round(tileRange.getHeight() * tilePixelSize[1] / oversampling);\n      const canvas = context.canvas;\n      if (canvas.width != width || canvas.height != height) {\n        this.oversampling_ = oversampling;\n        canvas.width = width;\n        canvas.height = height;\n      } else {\n        if (this.renderedExtent_ && !equals(imageExtent, this.renderedExtent_)) {\n          context.clearRect(0, 0, width, height);\n        }\n        oversampling = this.oversampling_;\n      }\n    }\n\n    this.renderedTiles.length = 0;\n    /** @type {Array.<number>} */\n    const zs = Object.keys(tilesToDrawByZ).map(Number);\n    zs.sort(function(a, b) {\n      if (a === z) {\n        return 1;\n      } else if (b === z) {\n        return -1;\n      } else {\n        return a > b ? 1 : a < b ? -1 : 0;\n      }\n    });\n    let currentResolution, currentScale, currentTilePixelSize, currentZ, i, ii;\n    let tileExtent, tileGutter, tilesToDraw, w, h;\n    for (i = 0, ii = zs.length; i < ii; ++i) {\n      currentZ = zs[i];\n      currentTilePixelSize = tileSource.getTilePixelSize(currentZ, pixelRatio, projection);\n      currentResolution = tileGrid.getResolution(currentZ);\n      currentScale = currentResolution / tileResolution;\n      tileGutter = tilePixelRatio * tileSource.getGutter(projection);\n      tilesToDraw = tilesToDrawByZ[currentZ];\n      for (const tileCoordKey in tilesToDraw) {\n        tile = tilesToDraw[tileCoordKey];\n        tileExtent = tileGrid.getTileCoordExtent(tile.getTileCoord(), tmpExtent);\n        x = (tileExtent[0] - imageExtent[0]) / tileResolution * tilePixelRatio / oversampling;\n        y = (imageExtent[3] - tileExtent[3]) / tileResolution * tilePixelRatio / oversampling;\n        w = currentTilePixelSize[0] * currentScale / oversampling;\n        h = currentTilePixelSize[1] * currentScale / oversampling;\n        this.drawTileImage(tile, frameState, layerState, x, y, w, h, tileGutter, z === currentZ);\n        this.renderedTiles.push(tile);\n      }\n    }\n\n    this.renderedRevision = sourceRevision;\n    this.renderedResolution = tileResolution * pixelRatio / tilePixelRatio * oversampling;\n    this.renderedExtent_ = imageExtent;\n  }\n\n  const scale = this.renderedResolution / viewResolution;\n  const transform = composeTransform(this.imageTransform_,\n    pixelRatio * size[0] / 2, pixelRatio * size[1] / 2,\n    scale, scale,\n    0,\n    (this.renderedExtent_[0] - viewCenter[0]) / this.renderedResolution * pixelRatio,\n    (viewCenter[1] - this.renderedExtent_[3]) / this.renderedResolution * pixelRatio);\n  composeTransform(this.coordinateToCanvasPixelTransform,\n    pixelRatio * size[0] / 2 - transform[4], pixelRatio * size[1] / 2 - transform[5],\n    pixelRatio / viewResolution, -pixelRatio / viewResolution,\n    0,\n    -viewCenter[0], -viewCenter[1]);\n\n\n  this.updateUsedTiles(frameState.usedTiles, tileSource, z, tileRange);\n  this.manageTilePyramid(frameState, tileSource, tileGrid, pixelRatio,\n    projection, extent, z, tileLayer.getPreload());\n  this.scheduleExpireCache(frameState, tileSource);\n\n  return this.renderedTiles.length > 0;\n};\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {number} x Left of the tile.\n * @param {number} y Top of the tile.\n * @param {number} w Width of the tile.\n * @param {number} h Height of the tile.\n * @param {number} gutter Tile gutter.\n * @param {boolean} transition Apply an alpha transition.\n */\nCanvasTileLayerRenderer.prototype.drawTileImage = function(tile, frameState, layerState, x, y, w, h, gutter, transition) {\n  const image = tile.getImage(this.getLayer());\n  if (!image) {\n    return;\n  }\n  const uid = getUid(this);\n  const alpha = transition ? tile.getAlpha(uid, frameState.time) : 1;\n  if (alpha === 1 && !this.getLayer().getSource().getOpaque(frameState.viewState.projection)) {\n    this.context.clearRect(x, y, w, h);\n  }\n  const alphaChanged = alpha !== this.context.globalAlpha;\n  if (alphaChanged) {\n    this.context.save();\n    this.context.globalAlpha = alpha;\n  }\n  this.context.drawImage(image, gutter, gutter,\n    image.width - 2 * gutter, image.height - 2 * gutter, x, y, w, h);\n\n  if (alphaChanged) {\n    this.context.restore();\n  }\n  if (alpha !== 1) {\n    frameState.animate = true;\n  } else if (transition) {\n    tile.endTransition(uid);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasTileLayerRenderer.prototype.getImage = function() {\n  const context = this.context;\n  return context ? context.canvas : null;\n};\n\n\n/**\n * @function\n * @return {module:ol/layer/Tile|module:ol/layer/VectorTile}\n */\nCanvasTileLayerRenderer.prototype.getLayer;\n\n\n/**\n * @inheritDoc\n */\nCanvasTileLayerRenderer.prototype.getImageTransform = function() {\n  return this.imageTransform_;\n};\nexport default CanvasTileLayerRenderer;\n","/**\n * @module ol/renderer/canvas/VectorLayer\n */\nimport {getUid, inherits} from '../../index.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen, unlisten} from '../../events.js';\nimport EventType from '../../events/EventType.js';\nimport rbush from 'rbush';\nimport {buffer, createEmpty, containsExtent, getWidth} from '../../extent.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {labelCache, rotateAtOffset} from '../../render/canvas.js';\nimport CanvasReplayGroup from '../../render/canvas/ReplayGroup.js';\nimport CanvasLayerRenderer from '../canvas/Layer.js';\nimport {defaultOrder as defaultRenderOrder, getTolerance as getRenderTolerance, getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/Layer}\n * @param {module:ol/layer/Vector} vectorLayer Vector layer.\n * @api\n */\nconst CanvasVectorLayerRenderer = function(vectorLayer) {\n\n  CanvasLayerRenderer.call(this, vectorLayer);\n\n  /**\n   * Declutter tree.\n   * @private\n   */\n  this.declutterTree_ = vectorLayer.getDeclutter() ? rbush(9, undefined) : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.dirty_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedResolution_ = NaN;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedExtent_ = createEmpty();\n\n  /**\n   * @private\n   * @type {function(module:ol/Feature, module:ol/Feature): number|null}\n   */\n  this.renderedRenderOrder_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas/ReplayGroup}\n   */\n  this.replayGroup_ = null;\n\n  /**\n   * A new replay group had to be created by `prepareFrame()`\n   * @type {boolean}\n   */\n  this.replayGroupChanged = true;\n\n  /**\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context = createCanvasContext2D();\n\n  listen(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n\n};\n\ninherits(CanvasVectorLayerRenderer, CanvasLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasVectorLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/VectorLayer} The layer renderer.\n */\nCanvasVectorLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasVectorLayerRenderer(/** @type {module:ol/layer/Vector} */ (layer));\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.disposeInternal = function() {\n  unlisten(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n  CanvasLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n */\nCanvasVectorLayerRenderer.prototype.compose = function(context, frameState, layerState) {\n  const extent = frameState.extent;\n  const pixelRatio = frameState.pixelRatio;\n  const skippedFeatureUids = layerState.managed ?\n    frameState.skippedFeatureUids : {};\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const rotation = viewState.rotation;\n  const projectionExtent = projection.getExtent();\n  const vectorSource = /** @type {module:ol/source/Vector} */ (this.getLayer().getSource());\n\n  let transform = this.getTransform(frameState, 0);\n\n  // clipped rendering if layer extent is set\n  const clipExtent = layerState.extent;\n  const clipped = clipExtent !== undefined;\n  if (clipped) {\n    this.clip(context, frameState,  /** @type {module:ol/extent~Extent} */ (clipExtent));\n  }\n  const replayGroup = this.replayGroup_;\n  if (replayGroup && !replayGroup.isEmpty()) {\n    if (this.declutterTree_) {\n      this.declutterTree_.clear();\n    }\n    const layer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n    let drawOffsetX = 0;\n    let drawOffsetY = 0;\n    let replayContext;\n    const transparentLayer = layerState.opacity !== 1;\n    const hasRenderListeners = layer.hasListener(RenderEventType.RENDER);\n    if (transparentLayer || hasRenderListeners) {\n      let drawWidth = context.canvas.width;\n      let drawHeight = context.canvas.height;\n      if (rotation) {\n        const drawSize = Math.round(Math.sqrt(drawWidth * drawWidth + drawHeight * drawHeight));\n        drawOffsetX = (drawSize - drawWidth) / 2;\n        drawOffsetY = (drawSize - drawHeight) / 2;\n        drawWidth = drawHeight = drawSize;\n      }\n      // resize and clear\n      this.context.canvas.width = drawWidth;\n      this.context.canvas.height = drawHeight;\n      replayContext = this.context;\n    } else {\n      replayContext = context;\n    }\n\n    const alpha = replayContext.globalAlpha;\n    if (!transparentLayer) {\n      // for performance reasons, context.save / context.restore is not used\n      // to save and restore the transformation matrix and the opacity.\n      // see http://jsperf.com/context-save-restore-versus-variable\n      replayContext.globalAlpha = layerState.opacity;\n    }\n\n    if (replayContext != context) {\n      replayContext.translate(drawOffsetX, drawOffsetY);\n    }\n\n    const width = frameState.size[0] * pixelRatio;\n    const height = frameState.size[1] * pixelRatio;\n    rotateAtOffset(replayContext, -rotation,\n      width / 2, height / 2);\n    replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids);\n    if (vectorSource.getWrapX() && projection.canWrapX() &&\n        !containsExtent(projectionExtent, extent)) {\n      let startX = extent[0];\n      const worldWidth = getWidth(projectionExtent);\n      let world = 0;\n      let offsetX;\n      while (startX < projectionExtent[0]) {\n        --world;\n        offsetX = worldWidth * world;\n        transform = this.getTransform(frameState, offsetX);\n        replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids);\n        startX += worldWidth;\n      }\n      world = 0;\n      startX = extent[2];\n      while (startX > projectionExtent[2]) {\n        ++world;\n        offsetX = worldWidth * world;\n        transform = this.getTransform(frameState, offsetX);\n        replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids);\n        startX -= worldWidth;\n      }\n    }\n    rotateAtOffset(replayContext, rotation,\n      width / 2, height / 2);\n\n    if (replayContext != context) {\n      if (hasRenderListeners) {\n        this.dispatchRenderEvent(replayContext, frameState, transform);\n      }\n      if (transparentLayer) {\n        const mainContextAlpha = context.globalAlpha;\n        context.globalAlpha = layerState.opacity;\n        context.drawImage(replayContext.canvas, -drawOffsetX, -drawOffsetY);\n        context.globalAlpha = mainContextAlpha;\n      } else {\n        context.drawImage(replayContext.canvas, -drawOffsetX, -drawOffsetY);\n      }\n      replayContext.translate(-drawOffsetX, -drawOffsetY);\n    }\n\n    if (!transparentLayer) {\n      replayContext.globalAlpha = alpha;\n    }\n  }\n\n  if (clipped) {\n    context.restore();\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n  const transform = this.getTransform(frameState, 0);\n  this.preCompose(context, frameState, transform);\n  this.compose(context, frameState, layerState);\n  this.postCompose(context, frameState, layerState, transform);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  if (!this.replayGroup_) {\n    return undefined;\n  } else {\n    const resolution = frameState.viewState.resolution;\n    const rotation = frameState.viewState.rotation;\n    const layer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n    /** @type {!Object.<string, boolean>} */\n    const features = {};\n    const result = this.replayGroup_.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, {},\n      /**\n       * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n       * @return {?} Callback result.\n       */\n      function(feature) {\n        const key = getUid(feature).toString();\n        if (!(key in features)) {\n          features[key] = true;\n          return callback.call(thisArg, feature, layer);\n        }\n      }, null);\n    return result;\n  }\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n */\nCanvasVectorLayerRenderer.prototype.handleFontsChanged_ = function(event) {\n  const layer = this.getLayer();\n  if (layer.getVisible() && this.replayGroup_) {\n    layer.changed();\n  }\n};\n\n\n/**\n * Handle changes in image style state.\n * @param {module:ol/events/Event} event Image style change event.\n * @private\n */\nCanvasVectorLayerRenderer.prototype.handleStyleImageChange_ = function(event) {\n  this.renderIfReadyAndVisible();\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n  const vectorLayer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n  const vectorSource = vectorLayer.getSource();\n\n  const animating = frameState.viewHints[ViewHint.ANIMATING];\n  const interacting = frameState.viewHints[ViewHint.INTERACTING];\n  const updateWhileAnimating = vectorLayer.getUpdateWhileAnimating();\n  const updateWhileInteracting = vectorLayer.getUpdateWhileInteracting();\n\n  if (!this.dirty_ && (!updateWhileAnimating && animating) ||\n      (!updateWhileInteracting && interacting)) {\n    return true;\n  }\n\n  const frameStateExtent = frameState.extent;\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const resolution = viewState.resolution;\n  const pixelRatio = frameState.pixelRatio;\n  const vectorLayerRevision = vectorLayer.getRevision();\n  const vectorLayerRenderBuffer = vectorLayer.getRenderBuffer();\n  let vectorLayerRenderOrder = vectorLayer.getRenderOrder();\n\n  if (vectorLayerRenderOrder === undefined) {\n    vectorLayerRenderOrder = defaultRenderOrder;\n  }\n\n  const extent = buffer(frameStateExtent,\n    vectorLayerRenderBuffer * resolution);\n  const projectionExtent = viewState.projection.getExtent();\n\n  if (vectorSource.getWrapX() && viewState.projection.canWrapX() &&\n      !containsExtent(projectionExtent, frameState.extent)) {\n    // For the replay group, we need an extent that intersects the real world\n    // (-180 to +180). To support geometries in a coordinate range from -540\n    // to +540, we add at least 1 world width on each side of the projection\n    // extent. If the viewport is wider than the world, we need to add half of\n    // the viewport width to make sure we cover the whole viewport.\n    const worldWidth = getWidth(projectionExtent);\n    const gutter = Math.max(getWidth(extent) / 2, worldWidth);\n    extent[0] = projectionExtent[0] - gutter;\n    extent[2] = projectionExtent[2] + gutter;\n  }\n\n  if (!this.dirty_ &&\n      this.renderedResolution_ == resolution &&\n      this.renderedRevision_ == vectorLayerRevision &&\n      this.renderedRenderOrder_ == vectorLayerRenderOrder &&\n      containsExtent(this.renderedExtent_, extent)) {\n    this.replayGroupChanged = false;\n    return true;\n  }\n\n  this.replayGroup_ = null;\n\n  this.dirty_ = false;\n\n  const replayGroup = new CanvasReplayGroup(\n    getRenderTolerance(resolution, pixelRatio), extent, resolution,\n    pixelRatio, vectorSource.getOverlaps(), this.declutterTree_, vectorLayer.getRenderBuffer());\n  vectorSource.loadFeatures(extent, resolution, projection);\n  /**\n   * @param {module:ol/Feature} feature Feature.\n   * @this {module:ol/renderer/canvas/VectorLayer}\n   */\n  const render = function(feature) {\n    let styles;\n    const styleFunction = feature.getStyleFunction() || vectorLayer.getStyleFunction();\n    if (styleFunction) {\n      styles = styleFunction(feature, resolution);\n    }\n    if (styles) {\n      const dirty = this.renderFeature(\n        feature, resolution, pixelRatio, styles, replayGroup);\n      this.dirty_ = this.dirty_ || dirty;\n    }\n  }.bind(this);\n  if (vectorLayerRenderOrder) {\n    /** @type {Array.<module:ol/Feature>} */\n    const features = [];\n    vectorSource.forEachFeatureInExtent(extent,\n      /**\n       * @param {module:ol/Feature} feature Feature.\n       */\n      function(feature) {\n        features.push(feature);\n      }, this);\n    features.sort(vectorLayerRenderOrder);\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      render(features[i]);\n    }\n  } else {\n    vectorSource.forEachFeatureInExtent(extent, render, this);\n  }\n  replayGroup.finish();\n\n  this.renderedResolution_ = resolution;\n  this.renderedRevision_ = vectorLayerRevision;\n  this.renderedRenderOrder_ = vectorLayerRenderOrder;\n  this.renderedExtent_ = extent;\n  this.replayGroup_ = replayGroup;\n\n  this.replayGroupChanged = true;\n  return true;\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {(module:ol/style/Style|Array.<module:ol/style/Style>)} styles The style or array of styles.\n * @param {module:ol/render/canvas/ReplayGroup} replayGroup Replay group.\n * @return {boolean} `true` if an image is loading.\n */\nCanvasVectorLayerRenderer.prototype.renderFeature = function(feature, resolution, pixelRatio, styles, replayGroup) {\n  if (!styles) {\n    return false;\n  }\n  let loading = false;\n  if (Array.isArray(styles)) {\n    for (let i = 0, ii = styles.length; i < ii; ++i) {\n      loading = renderFeature(\n        replayGroup, feature, styles[i],\n        getSquaredRenderTolerance(resolution, pixelRatio),\n        this.handleStyleImageChange_, this) || loading;\n    }\n  } else {\n    loading = renderFeature(\n      replayGroup, feature, styles,\n      getSquaredRenderTolerance(resolution, pixelRatio),\n      this.handleStyleImageChange_, this);\n  }\n  return loading;\n};\nexport default CanvasVectorLayerRenderer;\n","/**\n * @module ol/renderer/canvas/VectorTileLayer\n */\nimport {getUid, inherits} from '../../index.js';\nimport LayerType from '../../LayerType.js';\nimport TileState from '../../TileState.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen, unlisten} from '../../events.js';\nimport EventType from '../../events/EventType.js';\nimport rbush from 'rbush';\nimport {buffer, containsCoordinate, equals, getIntersection, getTopLeft, intersects} from '../../extent.js';\nimport VectorTileRenderType from '../../layer/VectorTileRenderType.js';\nimport {equivalent as equivalentProjection} from '../../proj.js';\nimport Units from '../../proj/Units.js';\nimport ReplayType from '../../render/ReplayType.js';\nimport {labelCache, rotateAtOffset} from '../../render/canvas.js';\nimport CanvasReplayGroup, {replayDeclutter} from '../../render/canvas/ReplayGroup.js';\nimport {ORDER} from '../../render/replay.js';\nimport CanvasTileLayerRenderer from '../canvas/TileLayer.js';\nimport {getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\nimport {\n  create as createTransform,\n  compose as composeTransform,\n  reset as resetTransform,\n  scale as scaleTransform,\n  translate as translateTransform\n} from '../../transform.js';\n\n\n/**\n * @type {!Object.<string, Array.<module:ol/render/ReplayType>>}\n */\nconst IMAGE_REPLAYS = {\n  'image': [ReplayType.POLYGON, ReplayType.CIRCLE,\n    ReplayType.LINE_STRING, ReplayType.IMAGE, ReplayType.TEXT],\n  'hybrid': [ReplayType.POLYGON, ReplayType.LINE_STRING]\n};\n\n\n/**\n * @type {!Object.<string, Array.<module:ol/render/ReplayType>>}\n */\nconst VECTOR_REPLAYS = {\n  'image': [ReplayType.DEFAULT],\n  'hybrid': [ReplayType.IMAGE, ReplayType.TEXT, ReplayType.DEFAULT],\n  'vector': ORDER\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/TileLayer}\n * @param {module:ol/layer/VectorTile} layer VectorTile layer.\n * @api\n */\nconst CanvasVectorTileLayerRenderer = function(layer) {\n\n  /**\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context = null;\n\n  CanvasTileLayerRenderer.call(this, layer);\n\n  /**\n   * Declutter tree.\n   * @private\n   */\n  this.declutterTree_ = layer.getDeclutter() ? rbush(9, undefined) : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.dirty_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedLayerRevision_;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.tmpTransform_ = createTransform();\n\n  // Use lower resolution for pure vector rendering. Closest resolution otherwise.\n  this.zDirection = layer.getRenderMode() == VectorTileRenderType.VECTOR ? 1 : 0;\n\n  listen(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n\n};\n\ninherits(CanvasVectorTileLayerRenderer, CanvasTileLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasVectorTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR_TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/VectorTileLayer} The layer renderer.\n */\nCanvasVectorTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasVectorTileLayerRenderer(/** @type {module:ol/layer/VectorTile} */ (layer));\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.disposeInternal = function() {\n  unlisten(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n  CanvasTileLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const tile = CanvasTileLayerRenderer.prototype.getTile.call(this, z, x, y, pixelRatio, projection);\n  if (tile.getState() === TileState.LOADED) {\n    this.createReplayGroup_(tile, pixelRatio, projection);\n    if (this.context) {\n      this.renderTileImage_(tile, pixelRatio, projection);\n    }\n  }\n  return tile;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n  const layer = this.getLayer();\n  const layerRevision = layer.getRevision();\n  if (this.renderedLayerRevision_ != layerRevision) {\n    this.renderedTiles.length = 0;\n    const renderMode = layer.getRenderMode();\n    if (!this.context && renderMode != VectorTileRenderType.VECTOR) {\n      this.context = createCanvasContext2D();\n    }\n    if (this.context && renderMode == VectorTileRenderType.VECTOR) {\n      this.context = null;\n    }\n  }\n  this.renderedLayerRevision_ = layerRevision;\n  return CanvasTileLayerRenderer.prototype.prepareFrame.apply(this, arguments);\n};\n\n\n/**\n * @param {module:ol/VectorImageTile} tile Tile.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.createReplayGroup_ = function(tile, pixelRatio, projection) {\n  const layer = this.getLayer();\n  const revision = layer.getRevision();\n  const renderOrder = /** @type {module:ol/render~OrderFunction} */ (layer.getRenderOrder()) || null;\n\n  const replayState = tile.getReplayState(layer);\n  if (!replayState.dirty && replayState.renderedRevision == revision &&\n      replayState.renderedRenderOrder == renderOrder) {\n    return;\n  }\n\n  const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n  const sourceTileGrid = source.getTileGrid();\n  const tileGrid = source.getTileGridForProjection(projection);\n  const resolution = tileGrid.getResolution(tile.tileCoord[0]);\n  const tileExtent = tile.extent;\n\n  const zIndexKeys = {};\n  for (let t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n    const sourceTile = tile.getTile(tile.tileKeys[t]);\n    if (sourceTile.getState() != TileState.LOADED) {\n      continue;\n    }\n\n    const sourceTileCoord = sourceTile.tileCoord;\n    const sourceTileExtent = sourceTileGrid.getTileCoordExtent(sourceTileCoord);\n    const sharedExtent = getIntersection(tileExtent, sourceTileExtent);\n    const bufferedExtent = equals(sourceTileExtent, sharedExtent) ? null :\n      buffer(sharedExtent, layer.getRenderBuffer() * resolution, this.tmpExtent);\n    const tileProjection = sourceTile.getProjection();\n    let reproject = false;\n    if (!equivalentProjection(projection, tileProjection)) {\n      reproject = true;\n      sourceTile.setProjection(projection);\n    }\n    replayState.dirty = false;\n    const replayGroup = new CanvasReplayGroup(0, sharedExtent, resolution,\n      pixelRatio, source.getOverlaps(), this.declutterTree_, layer.getRenderBuffer());\n    const squaredTolerance = getSquaredRenderTolerance(resolution, pixelRatio);\n\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @this {module:ol/renderer/canvas/VectorTileLayer}\n     */\n    const render = function(feature) {\n      let styles;\n      const styleFunction = feature.getStyleFunction() || layer.getStyleFunction();\n      if (styleFunction) {\n        styles = styleFunction(feature, resolution);\n      }\n      if (styles) {\n        const dirty = this.renderFeature(feature, squaredTolerance, styles, replayGroup);\n        this.dirty_ = this.dirty_ || dirty;\n        replayState.dirty = replayState.dirty || dirty;\n      }\n    };\n\n    const features = sourceTile.getFeatures();\n    if (renderOrder && renderOrder !== replayState.renderedRenderOrder) {\n      features.sort(renderOrder);\n    }\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      const feature = features[i];\n      if (reproject) {\n        if (tileProjection.getUnits() == Units.TILE_PIXELS) {\n          // projected tile extent\n          tileProjection.setWorldExtent(sourceTileExtent);\n          // tile extent in tile pixel space\n          tileProjection.setExtent(sourceTile.getExtent());\n        }\n        feature.getGeometry().transform(tileProjection, projection);\n      }\n      if (!bufferedExtent || intersects(bufferedExtent, feature.getGeometry().getExtent())) {\n        render.call(this, feature);\n      }\n    }\n    replayGroup.finish();\n    for (const r in replayGroup.getReplays()) {\n      zIndexKeys[r] = true;\n    }\n    sourceTile.setReplayGroup(layer, tile.tileCoord.toString(), replayGroup);\n  }\n  replayState.renderedRevision = revision;\n  replayState.renderedRenderOrder = renderOrder;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  const resolution = frameState.viewState.resolution;\n  const rotation = frameState.viewState.rotation;\n  hitTolerance = hitTolerance == undefined ? 0 : hitTolerance;\n  const layer = this.getLayer();\n  /** @type {!Object.<string, boolean>} */\n  const features = {};\n\n  /** @type {Array.<module:ol/VectorImageTile>} */\n  const renderedTiles = this.renderedTiles;\n\n  let bufferedExtent, found;\n  let i, ii, replayGroup;\n  for (i = 0, ii = renderedTiles.length; i < ii; ++i) {\n    const tile = renderedTiles[i];\n    bufferedExtent = buffer(tile.extent, hitTolerance * resolution, bufferedExtent);\n    if (!containsCoordinate(bufferedExtent, coordinate)) {\n      continue;\n    }\n    for (let t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n      const sourceTile = tile.getTile(tile.tileKeys[t]);\n      if (sourceTile.getState() != TileState.LOADED) {\n        continue;\n      }\n      replayGroup = sourceTile.getReplayGroup(layer, tile.tileCoord.toString());\n      found = found || replayGroup.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, {},\n        /**\n         * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n         * @return {?} Callback result.\n         */\n        function(feature) {\n          const key = getUid(feature).toString();\n          if (!(key in features)) {\n            features[key] = true;\n            return callback.call(thisArg, feature, layer);\n          }\n        }, null);\n    }\n  }\n  return found;\n};\n\n\n/**\n * @param {module:ol/VectorTile} tile Tile.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @return {module:ol/transform~Transform} transform Transform.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.getReplayTransform_ = function(tile, frameState) {\n  const layer = this.getLayer();\n  const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n  const tileGrid = source.getTileGrid();\n  const tileCoord = tile.tileCoord;\n  const tileResolution = tileGrid.getResolution(tileCoord[0]);\n  const viewState = frameState.viewState;\n  const pixelRatio = frameState.pixelRatio;\n  const renderResolution = viewState.resolution / pixelRatio;\n  const tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n  const center = viewState.center;\n  const origin = getTopLeft(tileExtent);\n  const size = frameState.size;\n  const offsetX = Math.round(pixelRatio * size[0] / 2);\n  const offsetY = Math.round(pixelRatio * size[1] / 2);\n  return composeTransform(this.tmpTransform_,\n    offsetX, offsetY,\n    tileResolution / renderResolution, tileResolution / renderResolution,\n    viewState.rotation,\n    (origin[0] - center[0]) / tileResolution,\n    (center[1] - origin[1]) / tileResolution);\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n */\nCanvasVectorTileLayerRenderer.prototype.handleFontsChanged_ = function(event) {\n  const layer = this.getLayer();\n  if (layer.getVisible() && this.renderedLayerRevision_ !== undefined) {\n    layer.changed();\n  }\n};\n\n\n/**\n * Handle changes in image style state.\n * @param {module:ol/events/Event} event Image style change event.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.handleStyleImageChange_ = function(event) {\n  this.renderIfReadyAndVisible();\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.postCompose = function(context, frameState, layerState) {\n  const layer = this.getLayer();\n  const declutterReplays = layer.getDeclutter() ? {} : null;\n  const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n  const renderMode = layer.getRenderMode();\n  const replayTypes = VECTOR_REPLAYS[renderMode];\n  const pixelRatio = frameState.pixelRatio;\n  const rotation = frameState.viewState.rotation;\n  const size = frameState.size;\n  let offsetX, offsetY;\n  if (rotation) {\n    offsetX = Math.round(pixelRatio * size[0] / 2);\n    offsetY = Math.round(pixelRatio * size[1] / 2);\n    rotateAtOffset(context, -rotation, offsetX, offsetY);\n  }\n  if (declutterReplays) {\n    this.declutterTree_.clear();\n  }\n  const tiles = this.renderedTiles;\n  const tileGrid = source.getTileGridForProjection(frameState.viewState.projection);\n  const clips = [];\n  const zs = [];\n  for (let i = tiles.length - 1; i >= 0; --i) {\n    const tile = /** @type {module:ol/VectorImageTile} */ (tiles[i]);\n    if (tile.getState() == TileState.ABORT) {\n      continue;\n    }\n    const tileCoord = tile.tileCoord;\n    const worldOffset = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent)[0] - tile.extent[0];\n    let transform = undefined;\n    for (let t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n      const sourceTile = tile.getTile(tile.tileKeys[t]);\n      if (sourceTile.getState() != TileState.LOADED) {\n        continue;\n      }\n      const replayGroup = sourceTile.getReplayGroup(layer, tileCoord.toString());\n      if (renderMode != VectorTileRenderType.VECTOR && !replayGroup.hasReplays(replayTypes)) {\n        continue;\n      }\n      if (!transform) {\n        transform = this.getTransform(frameState, worldOffset);\n      }\n      const currentZ = sourceTile.tileCoord[0];\n      const currentClip = replayGroup.getClipCoords(transform);\n      context.save();\n      context.globalAlpha = layerState.opacity;\n      // Create a clip mask for regions in this low resolution tile that are\n      // already filled by a higher resolution tile\n      for (let j = 0, jj = clips.length; j < jj; ++j) {\n        const clip = clips[j];\n        if (currentZ < zs[j]) {\n          context.beginPath();\n          // counter-clockwise (outer ring) for current tile\n          context.moveTo(currentClip[0], currentClip[1]);\n          context.lineTo(currentClip[2], currentClip[3]);\n          context.lineTo(currentClip[4], currentClip[5]);\n          context.lineTo(currentClip[6], currentClip[7]);\n          // clockwise (inner ring) for higher resolution tile\n          context.moveTo(clip[6], clip[7]);\n          context.lineTo(clip[4], clip[5]);\n          context.lineTo(clip[2], clip[3]);\n          context.lineTo(clip[0], clip[1]);\n          context.clip();\n        }\n      }\n      replayGroup.replay(context, transform, rotation, {}, replayTypes, declutterReplays);\n      context.restore();\n      clips.push(currentClip);\n      zs.push(currentZ);\n    }\n  }\n  if (declutterReplays) {\n    replayDeclutter(declutterReplays, context, rotation);\n  }\n  if (rotation) {\n    rotateAtOffset(context, rotation,\n      /** @type {number} */ (offsetX), /** @type {number} */ (offsetY));\n  }\n  CanvasTileLayerRenderer.prototype.postCompose.apply(this, arguments);\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {(module:ol/style/Style|Array.<module:ol/style/Style>)} styles The style or array of styles.\n * @param {module:ol/render/canvas/ReplayGroup} replayGroup Replay group.\n * @return {boolean} `true` if an image is loading.\n */\nCanvasVectorTileLayerRenderer.prototype.renderFeature = function(feature, squaredTolerance, styles, replayGroup) {\n  if (!styles) {\n    return false;\n  }\n  let loading = false;\n  if (Array.isArray(styles)) {\n    for (let i = 0, ii = styles.length; i < ii; ++i) {\n      loading = renderFeature(\n        replayGroup, feature, styles[i], squaredTolerance,\n        this.handleStyleImageChange_, this) || loading;\n    }\n  } else {\n    loading = renderFeature(\n      replayGroup, feature, styles, squaredTolerance,\n      this.handleStyleImageChange_, this);\n  }\n  return loading;\n};\n\n\n/**\n * @param {module:ol/VectorImageTile} tile Tile.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.renderTileImage_ = function(\n  tile, pixelRatio, projection) {\n  const layer = this.getLayer();\n  const replayState = tile.getReplayState(layer);\n  const revision = layer.getRevision();\n  const replays = IMAGE_REPLAYS[layer.getRenderMode()];\n  if (replays && replayState.renderedTileRevision !== revision) {\n    replayState.renderedTileRevision = revision;\n    const tileCoord = tile.wrappedTileCoord;\n    const z = tileCoord[0];\n    const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n    const tileGrid = source.getTileGridForProjection(projection);\n    const resolution = tileGrid.getResolution(z);\n    const context = tile.getContext(layer);\n    const size = source.getTilePixelSize(z, pixelRatio, projection);\n    context.canvas.width = size[0];\n    context.canvas.height = size[1];\n    const tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n    for (let i = 0, ii = tile.tileKeys.length; i < ii; ++i) {\n      const sourceTile = tile.getTile(tile.tileKeys[i]);\n      if (sourceTile.getState() != TileState.LOADED) {\n        continue;\n      }\n      const pixelScale = pixelRatio / resolution;\n      const transform = resetTransform(this.tmpTransform_);\n      scaleTransform(transform, pixelScale, -pixelScale);\n      translateTransform(transform, -tileExtent[0], -tileExtent[3]);\n      const replayGroup = sourceTile.getReplayGroup(layer, tile.tileCoord.toString());\n      replayGroup.replay(context, transform, 0, {}, replays);\n    }\n  }\n};\n\nexport default CanvasVectorTileLayerRenderer;\n","/**\n * @module ol/renderer/vector\n */\nimport {getUid} from '../index.js';\nimport ImageState from '../ImageState.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport ReplayType from '../render/ReplayType.js';\n\n\n/**\n * Tolerance for geometry simplification in device pixels.\n * @type {number}\n */\nconst SIMPLIFY_TOLERANCE = 0.5;\n\n\n/**\n * @const\n * @type {Object.<module:ol/geom/GeometryType,\n *                function(module:ol/render/ReplayGroup, module:ol/geom/Geometry,\n *                         module:ol/style/Style, Object)>}\n */\nconst GEOMETRY_RENDERERS = {\n  'Point': renderPointGeometry,\n  'LineString': renderLineStringGeometry,\n  'Polygon': renderPolygonGeometry,\n  'MultiPoint': renderMultiPointGeometry,\n  'MultiLineString': renderMultiLineStringGeometry,\n  'MultiPolygon': renderMultiPolygonGeometry,\n  'GeometryCollection': renderGeometryCollectionGeometry,\n  'Circle': renderCircleGeometry\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature1 Feature 1.\n * @param {module:ol/Feature|module:ol/render/Feature} feature2 Feature 2.\n * @return {number} Order.\n */\nexport function defaultOrder(feature1, feature2) {\n  return getUid(feature1) - getUid(feature2);\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Squared pixel tolerance.\n */\nexport function getSquaredTolerance(resolution, pixelRatio) {\n  const tolerance = getTolerance(resolution, pixelRatio);\n  return tolerance * tolerance;\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Pixel tolerance.\n */\nexport function getTolerance(resolution, pixelRatio) {\n  return SIMPLIFY_TOLERANCE * resolution / pixelRatio;\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Circle} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature} feature Feature.\n */\nfunction renderCircleGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const circleReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.CIRCLE);\n    circleReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    circleReplay.drawCircle(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {function(this: T, module:ol/events/Event)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @return {boolean} `true` if style is loading.\n * @template T\n */\nexport function renderFeature(replayGroup, feature, style, squaredTolerance, listener, thisArg) {\n  let loading = false;\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    let imageState = imageStyle.getImageState();\n    if (imageState == ImageState.LOADED || imageState == ImageState.ERROR) {\n      imageStyle.unlistenImageChange(listener, thisArg);\n    } else {\n      if (imageState == ImageState.IDLE) {\n        imageStyle.load();\n      }\n      imageState = imageStyle.getImageState();\n      imageStyle.listenImageChange(listener, thisArg);\n      loading = true;\n    }\n  }\n  renderFeatureInternal(replayGroup, feature, style, squaredTolerance);\n\n  return loading;\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n */\nfunction renderFeatureInternal(replayGroup, feature, style, squaredTolerance) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry) {\n    return;\n  }\n  const simplifiedGeometry = geometry.getSimplifiedGeometry(squaredTolerance);\n  const renderer = style.getRenderer();\n  if (renderer) {\n    renderGeometry(replayGroup, simplifiedGeometry, style, feature);\n  } else {\n    const geometryRenderer = GEOMETRY_RENDERERS[simplifiedGeometry.getType()];\n    geometryRenderer(replayGroup, simplifiedGeometry, style, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderGeometry(replayGroup, geometry, style, feature) {\n  if (geometry.getType() == GeometryType.GEOMETRY_COLLECTION) {\n    const geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      renderGeometry(replayGroup, geometries[i], style, feature);\n    }\n    return;\n  }\n  const replay = replayGroup.getReplay(style.getZIndex(), ReplayType.DEFAULT);\n  replay.drawCustom(/** @type {module:ol/geom/SimpleGeometry} */ (geometry), feature, style.getRenderer());\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature} feature Feature.\n */\nfunction renderGeometryCollectionGeometry(replayGroup, geometry, style, feature) {\n  const geometries = geometry.getGeometriesArray();\n  let i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    const geometryRenderer =\n        GEOMETRY_RENDERERS[geometries[i].getType()];\n    geometryRenderer(replayGroup, geometries[i], style, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/LineString|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderLineStringGeometry(replayGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/MultiLineString|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderMultiLineStringGeometry(replayGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawMultiLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature} feature Feature.\n */\nfunction renderMultiPolygonGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (strokeStyle || fillStyle) {\n    const polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawMultiPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Point|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderPointGeometry(replayGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/MultiPoint|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderMultiPointGeometry(replayGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawMultiPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Polygon|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderPolygonGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n","/**\n * Default maximum allowed threshold  (in pixels) for reprojection\n * triangulation.\n * @type {number}\n */\nexport const ERROR_THRESHOLD = 0.5;\n\n/**\n * Enable automatic reprojection of raster sources. Default is `true`.\n * TODO: decide if we want to expose this as a build flag or remove it\n * @type {boolean}\n */\nexport const ENABLE_RASTER_REPROJECTION = true;\n","/**\n * @module ol/resolutionconstraint\n */\nimport {linearFindNearest} from './array.js';\nimport {clamp} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), number, number): (number|undefined)} Type\n */\n\n\n/**\n * @param {Array.<number>} resolutions Resolutions.\n * @return {module:ol/resolutionconstraint~Type} Zoom function.\n */\nexport function createSnapToResolutions(resolutions) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} delta Delta.\n     * @param {number} direction Direction.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, delta, direction) {\n      if (resolution !== undefined) {\n        let z = linearFindNearest(resolutions, resolution, direction);\n        z = clamp(z + delta, 0, resolutions.length - 1);\n        const index = Math.floor(z);\n        if (z != index && index < resolutions.length - 1) {\n          const power = resolutions[index] / resolutions[index + 1];\n          return resolutions[index] / Math.pow(power, z - index);\n        } else {\n          return resolutions[index];\n        }\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n\n\n/**\n * @param {number} power Power.\n * @param {number} maxResolution Maximum resolution.\n * @param {number=} opt_maxLevel Maximum level.\n * @return {module:ol/resolutionconstraint~Type} Zoom function.\n */\nexport function createSnapToPower(power, maxResolution, opt_maxLevel) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} delta Delta.\n     * @param {number} direction Direction.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, delta, direction) {\n      if (resolution !== undefined) {\n        const offset = -direction / 2 + 0.5;\n        const oldLevel = Math.floor(\n          Math.log(maxResolution / resolution) / Math.log(power) + offset);\n        let newLevel = Math.max(oldLevel + delta, 0);\n        if (opt_maxLevel !== undefined) {\n          newLevel = Math.min(newLevel, opt_maxLevel);\n        }\n        return maxResolution / Math.pow(power, newLevel);\n      } else {\n        return undefined;\n      }\n    });\n}\n","/**\n * @module ol/rotationconstraint\n */\nimport {toRadians} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), number): (number|undefined)} Type\n */\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @param {number} delta Delta.\n * @return {number|undefined} Rotation.\n */\nexport function disable(rotation, delta) {\n  if (rotation !== undefined) {\n    return 0;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @param {number} delta Delta.\n * @return {number|undefined} Rotation.\n */\nexport function none(rotation, delta) {\n  if (rotation !== undefined) {\n    return rotation + delta;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number} n N.\n * @return {module:ol/rotationconstraint~Type} Rotation constraint.\n */\nexport function createSnapToN(n) {\n  const theta = 2 * Math.PI / n;\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {number} delta Delta.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, delta) {\n      if (rotation !== undefined) {\n        rotation = Math.floor((rotation + delta) / theta + 0.5) * theta;\n        return rotation;\n      } else {\n        return undefined;\n      }\n    });\n}\n\n\n/**\n * @param {number=} opt_tolerance Tolerance.\n * @return {module:ol/rotationconstraint~Type} Rotation constraint.\n */\nexport function createSnapToZero(opt_tolerance) {\n  const tolerance = opt_tolerance || toRadians(5);\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {number} delta Delta.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, delta) {\n      if (rotation !== undefined) {\n        if (Math.abs(rotation + delta) <= tolerance) {\n          return 0;\n        } else {\n          return rotation + delta;\n        }\n      } else {\n        return undefined;\n      }\n    });\n}\n","/**\n * @module ol/size\n */\n\n\n/**\n * An array of numbers representing a size: `[width, height]`.\n * @typedef {Array.<number>} Size\n * @api\n */\n\n\n/**\n * Returns a buffered size.\n * @param {module:ol/size~Size} size Size.\n * @param {number} num The amount by which to buffer.\n * @param {module:ol/size~Size=} opt_size Optional reusable size array.\n * @return {module:ol/size~Size} The buffered size.\n */\nexport function buffer(size, num, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = size[0] + 2 * num;\n  opt_size[1] = size[1] + 2 * num;\n  return opt_size;\n}\n\n\n/**\n * Determines if a size has a positive area.\n * @param {module:ol/size~Size} size The size to test.\n * @return {boolean} The size has a positive area.\n */\nexport function hasArea(size) {\n  return size[0] > 0 && size[1] > 0;\n}\n\n\n/**\n * Returns a size scaled by a ratio. The result will be an array of integers.\n * @param {module:ol/size~Size} size Size.\n * @param {number} ratio Ratio.\n * @param {module:ol/size~Size=} opt_size Optional reusable size array.\n * @return {module:ol/size~Size} The scaled size.\n */\nexport function scale(size, ratio, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = (size[0] * ratio + 0.5) | 0;\n  opt_size[1] = (size[1] * ratio + 0.5) | 0;\n  return opt_size;\n}\n\n\n/**\n * Returns an `module:ol/size~Size` array for the passed in number (meaning: square) or\n * `module:ol/size~Size` array.\n * (meaning: non-square),\n * @param {number|module:ol/size~Size} size Width and height.\n * @param {module:ol/size~Size=} opt_size Optional reusable size array.\n * @return {module:ol/size~Size} Size.\n * @api\n */\nexport function toSize(size, opt_size) {\n  if (Array.isArray(size)) {\n    return size;\n  } else {\n    if (opt_size === undefined) {\n      opt_size = [size, size];\n    } else {\n      opt_size[0] = opt_size[1] = /** @type {number} */ (size);\n    }\n    return opt_size;\n  }\n}\n","/**\n * @module ol/source/Source\n */\nimport {inherits} from '../index.js';\nimport {UNDEFINED} from '../functions.js';\nimport BaseObject from '../Object.js';\nimport {get as getProjection} from '../proj.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * A function that returns a string or an array of strings representing source\n * attributions.\n *\n * @typedef {function(module:ol/PluggableMap~FrameState): (string|Array.<string>)} Attribution\n */\n\n\n/**\n * A type that can be used to provide attribution information for data sources.\n *\n * It represents either\n * * a simple string (e.g. `' Acme Inc.'`)\n * * an array of simple strings (e.g. `[' Acme Inc.', ' Bacme Inc.']`)\n * * a function that returns a string or array of strings (`{@link module:ol/source/Source~Attribution}`)\n *\n * @typedef {string|Array.<string>|module:ol/source/Source~Attribution} AttributionLike\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions]\n * @property {module:ol/proj~ProjectionLike} projection\n * @property {module:ol/source/State} [state]\n * @property {boolean} [wrapX]\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for {@link module:ol/layer/Layer~Layer} sources.\n *\n * A generic `change` event is triggered when the state of the source changes.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/Object}\n * @param {module:ol/source/Source~Options} options Source options.\n * @api\n */\nconst Source = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = getProjection(options.projection);\n\n  /**\n   * @private\n   * @type {?module:ol/source/Source~Attribution}\n   */\n  this.attributions_ = this.adaptAttributions_(options.attributions);\n\n  /**\n   * @private\n   * @type {module:ol/source/State}\n   */\n  this.state_ = options.state !== undefined ?\n    options.state : SourceState.READY;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.wrapX_ = options.wrapX !== undefined ? options.wrapX : false;\n\n};\n\ninherits(Source, BaseObject);\n\n/**\n * Turns the attributions option into an attributions function.\n * @param {module:ol/source/Source~AttributionLike|undefined} attributionLike The attribution option.\n * @return {?module:ol/source/Source~Attribution} An attribution function (or null).\n */\nSource.prototype.adaptAttributions_ = function(attributionLike) {\n  if (!attributionLike) {\n    return null;\n  }\n  if (Array.isArray(attributionLike)) {\n    return function(frameState) {\n      return attributionLike;\n    };\n  }\n\n  if (typeof attributionLike === 'function') {\n    return attributionLike;\n  }\n\n  return function(frameState) {\n    return [attributionLike];\n  };\n};\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {Object.<string, boolean>} skippedFeatureUids Skipped feature uids.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T} callback Feature callback.\n * @return {T|undefined} Callback result.\n * @template T\n */\nSource.prototype.forEachFeatureAtCoordinate = UNDEFINED;\n\n\n/**\n * Get the attribution function for the source.\n * @return {?module:ol/source/Source~Attribution} Attribution function.\n */\nSource.prototype.getAttributions = function() {\n  return this.attributions_;\n};\n\n\n/**\n * Get the projection of the source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nSource.prototype.getProjection = function() {\n  return this.projection_;\n};\n\n\n/**\n * @abstract\n * @return {Array.<number>|undefined} Resolutions.\n */\nSource.prototype.getResolutions = function() {};\n\n\n/**\n * Get the state of the source, see {@link module:ol/source/State~State} for possible states.\n * @return {module:ol/source/State} State.\n * @api\n */\nSource.prototype.getState = function() {\n  return this.state_;\n};\n\n\n/**\n * @return {boolean|undefined} Wrap X.\n */\nSource.prototype.getWrapX = function() {\n  return this.wrapX_;\n};\n\n\n/**\n * Refreshes the source and finally dispatches a 'change' event.\n * @api\n */\nSource.prototype.refresh = function() {\n  this.changed();\n};\n\n\n/**\n * Set the attributions of the source.\n * @param {module:ol/source/Source~AttributionLike|undefined} attributions Attributions.\n *     Can be passed as `string`, `Array<string>`, `{@link module:ol/source/Source~Attribution}`,\n *     or `undefined`.\n * @api\n */\nSource.prototype.setAttributions = function(attributions) {\n  this.attributions_ = this.adaptAttributions_(attributions);\n  this.changed();\n};\n\n\n/**\n * Set the state of the source.\n * @param {module:ol/source/State} state State.\n * @protected\n */\nSource.prototype.setState = function(state) {\n  this.state_ = state;\n  this.changed();\n};\nexport default Source;\n","/**\n * @module ol/source/State\n */\n\n/**\n * State of the source, one of 'undefined', 'loading', 'ready' or 'error'.\n * @enum {string}\n */\nexport default {\n  UNDEFINED: 'undefined',\n  LOADING: 'loading',\n  READY: 'ready',\n  ERROR: 'error'\n};\n","/**\n * @module ol/source/Vector\n */\n\nimport {getUid, inherits} from '../index.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport {extend} from '../array.js';\nimport {assert} from '../asserts.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, equals} from '../extent.js';\nimport {xhr} from '../featureloader.js';\nimport {TRUE, UNDEFINED} from '../functions.js';\nimport {all as allStrategy} from '../loadingstrategy.js';\nimport {isEmpty, getValues} from '../obj.js';\nimport Source from '../source/Source.js';\nimport SourceState from '../source/State.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\n\n/**\n * A function that takes an {@link module:ol/extent~Extent} and a resolution as arguments, and\n * returns an array of {@link module:ol/extent~Extent} with the extents to load. Usually this\n * is one of the standard {@link module:ol/loadingstrategy} strategies.\n *\n * @typedef {function(module:ol/extent~Extent, number): Array.<module:ol/extent~Extent>} LoadingStrategy\n * @api\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Vector} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Type.\n * @param {module:ol/Feature=} opt_feature Feature.\n */\nexport const VectorSourceEvent = function(type, opt_feature) {\n\n  Event.call(this, type);\n\n  /**\n   * The feature being added or removed.\n   * @type {module:ol/Feature|undefined}\n   * @api\n   */\n  this.feature = opt_feature;\n\n};\ninherits(VectorSourceEvent, Event);\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {Array.<module:ol/Feature>|module:ol/Collection.<module:ol/Feature>} [features]\n * Features. If provided as {@link module:ol/Collection}, the features in the source\n * and the collection will stay in sync.\n * @property {module:ol/format/Feature} [format] The feature format used by the XHR\n * feature loader when `url` is set. Required if `url` is set, otherwise ignored.\n * @property {module:ol/featureloader~FeatureLoader} [loader]\n * The loader function used to load features, from a remote source for example.\n * If this is not set and `url` is set, the source will create and use an XHR\n * feature loader.\n *\n * Example:\n *\n * ```js\n * import {Vector} from 'ol/source';\n * import {GeoJSON} from 'ol/format';\n * import {bbox} from 'ol/loadingstrategy';\n *\n * var vectorSource = new Vector({\n *   format: new GeoJSON(),\n *   loader: function(extent, resolution, projection) {\n *      var proj = projection.getCode();\n *      var url = 'https://ahocevar.com/geoserver/wfs?service=WFS&' +\n *          'version=1.1.0&request=GetFeature&typename=osm:water_areas&' +\n *          'outputFormat=application/json&srsname=' + proj + '&' +\n *          'bbox=' + extent.join(',') + ',' + proj;\n *      var xhr = new XMLHttpRequest();\n *      xhr.open('GET', url);\n *      var onError = function() {\n *        vectorSource.removeLoadedExtent(extent);\n *      }\n *      xhr.onerror = onError;\n *      xhr.onload = function() {\n *        if (xhr.status == 200) {\n *          vectorSource.addFeatures(\n *              vectorSource.getFormat().readFeatures(xhr.responseText));\n *        } else {\n *          onError();\n *        }\n *      }\n *      xhr.send();\n *    },\n *    strategy: bbox\n *  });\n * ```\n * @property {boolean} [overlaps=true] This source may have overlapping geometries.\n * Setting this to `false` (e.g. for sources with polygons that represent administrative\n * boundaries or TopoJSON sources) allows the renderer to optimise fill and\n * stroke operations.\n * @property {module:ol/source/Vector~LoadingStrategy} [strategy] The loading strategy to use.\n * By default an {@link module:ol/loadingstrategy~all}\n * strategy is used, a one-off strategy which loads all features at once.\n * @property {string|module:ol/featureloader~FeatureUrlfunction} [url]\n * Setting this option instructs the source to load features using an XHR loader\n * (see {@link module:ol/featureloader~xhr}). Use a `string` and an\n * {@link module:ol/loadingstrategy~all} for a one-off download of all features from\n * the given URL. Use a {@link module:ol/featureloader~FeatureUrlfunction} to generate the url with\n * other loading strategies.\n * Requires `format` to be set as well.\n * When default XHR feature loader is provided, the features will\n * be transformed from the data projection to the view projection\n * during parsing. If your remote data source does not advertise its projection\n * properly, this transformation will be incorrect. For some formats, the\n * default projection (usually EPSG:4326) can be overridden by setting the\n * defaultDataProjection constructor option on the format.\n * Note that if a source contains non-feature data, such as a GeoJSON geometry\n * or a KML NetworkLink, these will be ignored. Use a custom loader to load these.\n * @property {boolean} [useSpatialIndex=true]\n * By default, an RTree is used as spatial index. When features are removed and\n * added frequently, and the total number of features is low, setting this to\n * `false` may improve performance.\n *\n * Note that\n * {@link module:ol/source/Vector~VectorSource#getFeaturesInExtent},\n * {@link module:ol/source/Vector~VectorSource#getClosestFeatureToCoordinate} and\n * {@link module:ol/source/Vector~VectorSource#getExtent} cannot be used when `useSpatialIndex` is\n * set to `false`, and {@link module:ol/source/Vector~VectorSource#forEachFeatureInExtent} will loop\n * through all features.\n *\n * When set to `false`, the features will be maintained in an\n * {@link module:ol/Collection}, which can be retrieved through\n * {@link module:ol/source/Vector~VectorSource#getFeaturesCollection}.\n * @property {boolean} [wrapX=true] Wrap the world horizontally. For vector editing across the\n * -180 and 180 meridians to work properly, this should be set to `false`. The\n * resulting geometry coordinates will then exceed the world bounds.\n */\n\n\n/**\n * @classdesc\n * Provides a source of features for vector layers. Vector features provided\n * by this source are suitable for editing. See {@link module:ol/source/VectorTile~VectorTile} for\n * vector data that is optimized for rendering.\n *\n * @constructor\n * @extends {module:ol/source/Source}\n * @fires ol/source/Vector~VectorSourceEvent\n * @param {module:ol/source/Vector~Options=} opt_options Vector source options.\n * @api\n */\nconst VectorSource = function(opt_options) {\n\n  const options = opt_options || {};\n\n  Source.call(this, {\n    attributions: options.attributions,\n    projection: undefined,\n    state: SourceState.READY,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true\n  });\n\n  /**\n   * @private\n   * @type {module:ol/featureloader~FeatureLoader}\n   */\n  this.loader_ = UNDEFINED;\n\n  /**\n   * @private\n   * @type {module:ol/format/Feature|undefined}\n   */\n  this.format_ = options.format;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overlaps_ = options.overlaps == undefined ? true : options.overlaps;\n\n  /**\n   * @private\n   * @type {string|module:ol/featureloader~FeatureUrlFunction|undefined}\n   */\n  this.url_ = options.url;\n\n  if (options.loader !== undefined) {\n    this.loader_ = options.loader;\n  } else if (this.url_ !== undefined) {\n    assert(this.format_, 7); // `format` must be set when `url` is set\n    // create a XHR feature loader for \"url\" and \"format\"\n    this.loader_ = xhr(this.url_, /** @type {module:ol/format/Feature} */ (this.format_));\n  }\n\n  /**\n   * @private\n   * @type {module:ol/source/Vector~LoadingStrategy}\n   */\n  this.strategy_ = options.strategy !== undefined ? options.strategy : allStrategy;\n\n  const useSpatialIndex =\n      options.useSpatialIndex !== undefined ? options.useSpatialIndex : true;\n\n  /**\n   * @private\n   * @type {module:ol/structs/RBush.<module:ol/Feature>}\n   */\n  this.featuresRtree_ = useSpatialIndex ? new RBush() : null;\n\n  /**\n   * @private\n   * @type {module:ol/structs/RBush.<{extent: module:ol/extent~Extent}>}\n   */\n  this.loadedExtentsRtree_ = new RBush();\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/Feature>}\n   */\n  this.nullGeometryFeatures_ = {};\n\n  /**\n   * A lookup of features by id (the return from feature.getId()).\n   * @private\n   * @type {!Object.<string, module:ol/Feature>}\n   */\n  this.idIndex_ = {};\n\n  /**\n   * A lookup of features without id (keyed by getUid(feature)).\n   * @private\n   * @type {!Object.<string, module:ol/Feature>}\n   */\n  this.undefIdIndex_ = {};\n\n  /**\n   * @private\n   * @type {Object.<string, Array.<module:ol/events~EventsKey>>}\n   */\n  this.featureChangeKeys_ = {};\n\n  /**\n   * @private\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   */\n  this.featuresCollection_ = null;\n\n  let collection, features;\n  if (options.features instanceof Collection) {\n    collection = options.features;\n    features = collection.getArray();\n  } else if (Array.isArray(options.features)) {\n    features = options.features;\n  }\n  if (!useSpatialIndex && collection === undefined) {\n    collection = new Collection(features);\n  }\n  if (features !== undefined) {\n    this.addFeaturesInternal(features);\n  }\n  if (collection !== undefined) {\n    this.bindFeaturesCollection_(collection);\n  }\n\n};\n\ninherits(VectorSource, Source);\n\n\n/**\n * Add a single feature to the source.  If you want to add a batch of features\n * at once, call {@link module:ol/source/Vector~VectorSource#addFeatures #addFeatures()}\n * instead. A feature will not be added to the source if feature with\n * the same id is already there. The reason for this behavior is to avoid\n * feature duplication when using bbox or tile loading strategies.\n * @param {module:ol/Feature} feature Feature to add.\n * @api\n */\nVectorSource.prototype.addFeature = function(feature) {\n  this.addFeatureInternal(feature);\n  this.changed();\n};\n\n\n/**\n * Add a feature without firing a `change` event.\n * @param {module:ol/Feature} feature Feature.\n * @protected\n */\nVectorSource.prototype.addFeatureInternal = function(feature) {\n  const featureKey = getUid(feature).toString();\n\n  if (!this.addToIndex_(featureKey, feature)) {\n    return;\n  }\n\n  this.setupChangeEvents_(featureKey, feature);\n\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    const extent = geometry.getExtent();\n    if (this.featuresRtree_) {\n      this.featuresRtree_.insert(extent, feature);\n    }\n  } else {\n    this.nullGeometryFeatures_[featureKey] = feature;\n  }\n\n  this.dispatchEvent(\n    new VectorSourceEvent(VectorEventType.ADDFEATURE, feature));\n};\n\n\n/**\n * @param {string} featureKey Unique identifier for the feature.\n * @param {module:ol/Feature} feature The feature.\n * @private\n */\nVectorSource.prototype.setupChangeEvents_ = function(featureKey, feature) {\n  this.featureChangeKeys_[featureKey] = [\n    listen(feature, EventType.CHANGE,\n      this.handleFeatureChange_, this),\n    listen(feature, ObjectEventType.PROPERTYCHANGE,\n      this.handleFeatureChange_, this)\n  ];\n};\n\n\n/**\n * @param {string} featureKey Unique identifier for the feature.\n * @param {module:ol/Feature} feature The feature.\n * @return {boolean} The feature is \"valid\", in the sense that it is also a\n *     candidate for insertion into the Rtree.\n * @private\n */\nVectorSource.prototype.addToIndex_ = function(featureKey, feature) {\n  let valid = true;\n  const id = feature.getId();\n  if (id !== undefined) {\n    if (!(id.toString() in this.idIndex_)) {\n      this.idIndex_[id.toString()] = feature;\n    } else {\n      valid = false;\n    }\n  } else {\n    assert(!(featureKey in this.undefIdIndex_),\n      30); // The passed `feature` was already added to the source\n    this.undefIdIndex_[featureKey] = feature;\n  }\n  return valid;\n};\n\n\n/**\n * Add a batch of features to the source.\n * @param {Array.<module:ol/Feature>} features Features to add.\n * @api\n */\nVectorSource.prototype.addFeatures = function(features) {\n  this.addFeaturesInternal(features);\n  this.changed();\n};\n\n\n/**\n * Add features without firing a `change` event.\n * @param {Array.<module:ol/Feature>} features Features.\n * @protected\n */\nVectorSource.prototype.addFeaturesInternal = function(features) {\n  const extents = [];\n  const newFeatures = [];\n  const geometryFeatures = [];\n\n  for (let i = 0, length = features.length; i < length; i++) {\n    const feature = features[i];\n    const featureKey = getUid(feature).toString();\n    if (this.addToIndex_(featureKey, feature)) {\n      newFeatures.push(feature);\n    }\n  }\n\n  for (let i = 0, length = newFeatures.length; i < length; i++) {\n    const feature = newFeatures[i];\n    const featureKey = getUid(feature).toString();\n    this.setupChangeEvents_(featureKey, feature);\n\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      const extent = geometry.getExtent();\n      extents.push(extent);\n      geometryFeatures.push(feature);\n    } else {\n      this.nullGeometryFeatures_[featureKey] = feature;\n    }\n  }\n  if (this.featuresRtree_) {\n    this.featuresRtree_.load(extents, geometryFeatures);\n  }\n\n  for (let i = 0, length = newFeatures.length; i < length; i++) {\n    this.dispatchEvent(new VectorSourceEvent(VectorEventType.ADDFEATURE, newFeatures[i]));\n  }\n};\n\n\n/**\n * @param {!module:ol/Collection.<module:ol/Feature>} collection Collection.\n * @private\n */\nVectorSource.prototype.bindFeaturesCollection_ = function(collection) {\n  let modifyingCollection = false;\n  listen(this, VectorEventType.ADDFEATURE,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        collection.push(evt.feature);\n        modifyingCollection = false;\n      }\n    });\n  listen(this, VectorEventType.REMOVEFEATURE,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        collection.remove(evt.feature);\n        modifyingCollection = false;\n      }\n    });\n  listen(collection, CollectionEventType.ADD,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        this.addFeature(/** @type {module:ol/Feature} */ (evt.element));\n        modifyingCollection = false;\n      }\n    }, this);\n  listen(collection, CollectionEventType.REMOVE,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        this.removeFeature(/** @type {module:ol/Feature} */ (evt.element));\n        modifyingCollection = false;\n      }\n    }, this);\n  this.featuresCollection_ = collection;\n};\n\n\n/**\n * Remove all features from the source.\n * @param {boolean=} opt_fast Skip dispatching of {@link module:ol/source/Vector~VectorSourceEvent#removefeature} events.\n * @api\n */\nVectorSource.prototype.clear = function(opt_fast) {\n  if (opt_fast) {\n    for (const featureId in this.featureChangeKeys_) {\n      const keys = this.featureChangeKeys_[featureId];\n      keys.forEach(unlistenByKey);\n    }\n    if (!this.featuresCollection_) {\n      this.featureChangeKeys_ = {};\n      this.idIndex_ = {};\n      this.undefIdIndex_ = {};\n    }\n  } else {\n    if (this.featuresRtree_) {\n      this.featuresRtree_.forEach(this.removeFeatureInternal, this);\n      for (const id in this.nullGeometryFeatures_) {\n        this.removeFeatureInternal(this.nullGeometryFeatures_[id]);\n      }\n    }\n  }\n  if (this.featuresCollection_) {\n    this.featuresCollection_.clear();\n  }\n\n  if (this.featuresRtree_) {\n    this.featuresRtree_.clear();\n  }\n  this.loadedExtentsRtree_.clear();\n  this.nullGeometryFeatures_ = {};\n\n  const clearEvent = new VectorSourceEvent(VectorEventType.CLEAR);\n  this.dispatchEvent(clearEvent);\n  this.changed();\n};\n\n\n/**\n * Iterate through all features on the source, calling the provided callback\n * with each one.  If the callback returns any \"truthy\" value, iteration will\n * stop and the function will return the same value.\n * Note: this function only iterate through the feature that have a defined geometry.\n *\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     on the source.  Return a truthy value to stop iteration.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n * @api\n */\nVectorSource.prototype.forEachFeature = function(callback) {\n  if (this.featuresRtree_) {\n    return this.featuresRtree_.forEach(callback);\n  } else if (this.featuresCollection_) {\n    return this.featuresCollection_.forEach(callback);\n  }\n};\n\n\n/**\n * Iterate through all features whose geometries contain the provided\n * coordinate, calling the callback with each feature.  If the callback returns\n * a \"truthy\" value, iteration will stop and the function will return the same\n * value.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     whose goemetry contains the provided coordinate.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n */\nVectorSource.prototype.forEachFeatureAtCoordinateDirect = function(coordinate, callback) {\n  const extent = [coordinate[0], coordinate[1], coordinate[0], coordinate[1]];\n  return this.forEachFeatureInExtent(extent, function(feature) {\n    const geometry = feature.getGeometry();\n    if (geometry.intersectsCoordinate(coordinate)) {\n      return callback(feature);\n    } else {\n      return undefined;\n    }\n  });\n};\n\n\n/**\n * Iterate through all features whose bounding box intersects the provided\n * extent (note that the feature's geometry may not intersect the extent),\n * calling the callback with each feature.  If the callback returns a \"truthy\"\n * value, iteration will stop and the function will return the same value.\n *\n * If you are interested in features whose geometry intersects an extent, call\n * the {@link module:ol/source/Vector~VectorSource#forEachFeatureIntersectingExtent #forEachFeatureIntersectingExtent()} method instead.\n *\n * When `useSpatialIndex` is set to false, this method will loop through all\n * features, equivalent to {@link module:ol/source/Vector~VectorSource#forEachFeature #forEachFeature()}.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     whose bounding box intersects the provided extent.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n * @api\n */\nVectorSource.prototype.forEachFeatureInExtent = function(extent, callback) {\n  if (this.featuresRtree_) {\n    return this.featuresRtree_.forEachInExtent(extent, callback);\n  } else if (this.featuresCollection_) {\n    return this.featuresCollection_.forEach(callback);\n  }\n};\n\n\n/**\n * Iterate through all features whose geometry intersects the provided extent,\n * calling the callback with each feature.  If the callback returns a \"truthy\"\n * value, iteration will stop and the function will return the same value.\n *\n * If you only want to test for bounding box intersection, call the\n * {@link module:ol/source/Vector~VectorSource#forEachFeatureInExtent #forEachFeatureInExtent()} method instead.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     whose geometry intersects the provided extent.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n * @api\n */\nVectorSource.prototype.forEachFeatureIntersectingExtent = function(extent, callback) {\n  return this.forEachFeatureInExtent(extent,\n    /**\n     * @param {module:ol/Feature} feature Feature.\n     * @return {T|undefined} The return value from the last call to the callback.\n     * @template T\n     */\n    function(feature) {\n      const geometry = feature.getGeometry();\n      if (geometry.intersectsExtent(extent)) {\n        const result = callback(feature);\n        if (result) {\n          return result;\n        }\n      }\n    });\n};\n\n\n/**\n * Get the features collection associated with this source. Will be `null`\n * unless the source was configured with `useSpatialIndex` set to `false`, or\n * with an {@link module:ol/Collection} as `features`.\n * @return {module:ol/Collection.<module:ol/Feature>} The collection of features.\n * @api\n */\nVectorSource.prototype.getFeaturesCollection = function() {\n  return this.featuresCollection_;\n};\n\n\n/**\n * Get all features on the source in random order.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nVectorSource.prototype.getFeatures = function() {\n  let features;\n  if (this.featuresCollection_) {\n    features = this.featuresCollection_.getArray();\n  } else if (this.featuresRtree_) {\n    features = this.featuresRtree_.getAll();\n    if (!isEmpty(this.nullGeometryFeatures_)) {\n      extend(features, getValues(this.nullGeometryFeatures_));\n    }\n  }\n  return (\n    /** @type {Array.<module:ol/Feature>} */ (features)\n  );\n};\n\n\n/**\n * Get all features whose geometry intersects the provided coordinate.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nVectorSource.prototype.getFeaturesAtCoordinate = function(coordinate) {\n  const features = [];\n  this.forEachFeatureAtCoordinateDirect(coordinate, function(feature) {\n    features.push(feature);\n  });\n  return features;\n};\n\n\n/**\n * Get all features in the provided extent.  Note that this returns an array of\n * all features intersecting the given extent in random order (so it may include\n * features whose geometries do not intersect the extent).\n *\n * This method is not available when the source is configured with\n * `useSpatialIndex` set to `false`.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nVectorSource.prototype.getFeaturesInExtent = function(extent) {\n  return this.featuresRtree_.getInExtent(extent);\n};\n\n\n/**\n * Get the closest feature to the provided coordinate.\n *\n * This method is not available when the source is configured with\n * `useSpatialIndex` set to `false`.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {function(module:ol/Feature):boolean=} opt_filter Feature filter function.\n *     The filter function will receive one argument, the {@link module:ol/Feature feature}\n *     and it should return a boolean value. By default, no filtering is made.\n * @return {module:ol/Feature} Closest feature.\n * @api\n */\nVectorSource.prototype.getClosestFeatureToCoordinate = function(coordinate, opt_filter) {\n  // Find the closest feature using branch and bound.  We start searching an\n  // infinite extent, and find the distance from the first feature found.  This\n  // becomes the closest feature.  We then compute a smaller extent which any\n  // closer feature must intersect.  We continue searching with this smaller\n  // extent, trying to find a closer feature.  Every time we find a closer\n  // feature, we update the extent being searched so that any even closer\n  // feature must intersect it.  We continue until we run out of features.\n  const x = coordinate[0];\n  const y = coordinate[1];\n  let closestFeature = null;\n  const closestPoint = [NaN, NaN];\n  let minSquaredDistance = Infinity;\n  const extent = [-Infinity, -Infinity, Infinity, Infinity];\n  const filter = opt_filter ? opt_filter : TRUE;\n  this.featuresRtree_.forEachInExtent(extent,\n    /**\n     * @param {module:ol/Feature} feature Feature.\n     */\n    function(feature) {\n      if (filter(feature)) {\n        const geometry = feature.getGeometry();\n        const previousMinSquaredDistance = minSquaredDistance;\n        minSquaredDistance = geometry.closestPointXY(\n          x, y, closestPoint, minSquaredDistance);\n        if (minSquaredDistance < previousMinSquaredDistance) {\n          closestFeature = feature;\n          // This is sneaky.  Reduce the extent that it is currently being\n          // searched while the R-Tree traversal using this same extent object\n          // is still in progress.  This is safe because the new extent is\n          // strictly contained by the old extent.\n          const minDistance = Math.sqrt(minSquaredDistance);\n          extent[0] = x - minDistance;\n          extent[1] = y - minDistance;\n          extent[2] = x + minDistance;\n          extent[3] = y + minDistance;\n        }\n      }\n    });\n  return closestFeature;\n};\n\n\n/**\n * Get the extent of the features currently in the source.\n *\n * This method is not available when the source is configured with\n * `useSpatialIndex` set to `false`.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent. If provided, no new extent\n *     will be created. Instead, that extent's coordinates will be overwritten.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nVectorSource.prototype.getExtent = function(opt_extent) {\n  return this.featuresRtree_.getExtent(opt_extent);\n};\n\n\n/**\n * Get a feature by its identifier (the value returned by feature.getId()).\n * Note that the index treats string and numeric identifiers as the same.  So\n * `source.getFeatureById(2)` will return a feature with id `'2'` or `2`.\n *\n * @param {string|number} id Feature identifier.\n * @return {module:ol/Feature} The feature (or `null` if not found).\n * @api\n */\nVectorSource.prototype.getFeatureById = function(id) {\n  const feature = this.idIndex_[id.toString()];\n  return feature !== undefined ? feature : null;\n};\n\n\n/**\n * Get the format associated with this source.\n *\n * @return {module:ol/format/Feature|undefined} The feature format.\n * @api\n */\nVectorSource.prototype.getFormat = function() {\n  return this.format_;\n};\n\n\n/**\n * @return {boolean} The source can have overlapping geometries.\n */\nVectorSource.prototype.getOverlaps = function() {\n  return this.overlaps_;\n};\n\n\n/**\n * @override\n */\nVectorSource.prototype.getResolutions = function() {};\n\n\n/**\n * Get the url associated with this source.\n *\n * @return {string|module:ol/featureloader~FeatureUrlFunction|undefined} The url.\n * @api\n */\nVectorSource.prototype.getUrl = function() {\n  return this.url_;\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @private\n */\nVectorSource.prototype.handleFeatureChange_ = function(event) {\n  const feature = /** @type {module:ol/Feature} */ (event.target);\n  const featureKey = getUid(feature).toString();\n  const geometry = feature.getGeometry();\n  if (!geometry) {\n    if (!(featureKey in this.nullGeometryFeatures_)) {\n      if (this.featuresRtree_) {\n        this.featuresRtree_.remove(feature);\n      }\n      this.nullGeometryFeatures_[featureKey] = feature;\n    }\n  } else {\n    const extent = geometry.getExtent();\n    if (featureKey in this.nullGeometryFeatures_) {\n      delete this.nullGeometryFeatures_[featureKey];\n      if (this.featuresRtree_) {\n        this.featuresRtree_.insert(extent, feature);\n      }\n    } else {\n      if (this.featuresRtree_) {\n        this.featuresRtree_.update(extent, feature);\n      }\n    }\n  }\n  const id = feature.getId();\n  if (id !== undefined) {\n    const sid = id.toString();\n    if (featureKey in this.undefIdIndex_) {\n      delete this.undefIdIndex_[featureKey];\n      this.idIndex_[sid] = feature;\n    } else {\n      if (this.idIndex_[sid] !== feature) {\n        this.removeFromIdIndex_(feature);\n        this.idIndex_[sid] = feature;\n      }\n    }\n  } else {\n    if (!(featureKey in this.undefIdIndex_)) {\n      this.removeFromIdIndex_(feature);\n      this.undefIdIndex_[featureKey] = feature;\n    }\n  }\n  this.changed();\n  this.dispatchEvent(new VectorSourceEvent(\n    VectorEventType.CHANGEFEATURE, feature));\n};\n\n/**\n * Returns true if the feature is contained within the source.\n * @param {module:ol/Feature} feature Feature.\n * @return {boolean} Has feature.\n * @api\n */\nVectorSource.prototype.hasFeature = function(feature) {\n  const id = feature.getId();\n  if (id !== undefined) {\n    return id in this.idIndex_;\n  } else {\n    const featureKey = getUid(feature).toString();\n    return featureKey in this.undefIdIndex_;\n  }\n};\n\n/**\n * @return {boolean} Is empty.\n */\nVectorSource.prototype.isEmpty = function() {\n  return this.featuresRtree_.isEmpty() && isEmpty(this.nullGeometryFeatures_);\n};\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {module:ol/proj/Projection} projection Projection.\n */\nVectorSource.prototype.loadFeatures = function(extent, resolution, projection) {\n  const loadedExtentsRtree = this.loadedExtentsRtree_;\n  const extentsToLoad = this.strategy_(extent, resolution);\n  for (let i = 0, ii = extentsToLoad.length; i < ii; ++i) {\n    const extentToLoad = extentsToLoad[i];\n    const alreadyLoaded = loadedExtentsRtree.forEachInExtent(extentToLoad,\n      /**\n       * @param {{extent: module:ol/extent~Extent}} object Object.\n       * @return {boolean} Contains.\n       */\n      function(object) {\n        return containsExtent(object.extent, extentToLoad);\n      });\n    if (!alreadyLoaded) {\n      this.loader_.call(this, extentToLoad, resolution, projection);\n      loadedExtentsRtree.insert(extentToLoad, {extent: extentToLoad.slice()});\n    }\n  }\n};\n\n\n/**\n * Remove an extent from the list of loaded extents.\n * @param {module:ol/extent~Extent} extent Extent.\n * @api\n */\nVectorSource.prototype.removeLoadedExtent = function(extent) {\n  const loadedExtentsRtree = this.loadedExtentsRtree_;\n  let obj;\n  loadedExtentsRtree.forEachInExtent(extent, function(object) {\n    if (equals(object.extent, extent)) {\n      obj = object;\n      return true;\n    }\n  });\n  if (obj) {\n    loadedExtentsRtree.remove(obj);\n  }\n};\n\n\n/**\n * Remove a single feature from the source.  If you want to remove all features\n * at once, use the {@link module:ol/source/Vector~VectorSource#clear #clear()} method\n * instead.\n * @param {module:ol/Feature} feature Feature to remove.\n * @api\n */\nVectorSource.prototype.removeFeature = function(feature) {\n  const featureKey = getUid(feature).toString();\n  if (featureKey in this.nullGeometryFeatures_) {\n    delete this.nullGeometryFeatures_[featureKey];\n  } else {\n    if (this.featuresRtree_) {\n      this.featuresRtree_.remove(feature);\n    }\n  }\n  this.removeFeatureInternal(feature);\n  this.changed();\n};\n\n\n/**\n * Remove feature without firing a `change` event.\n * @param {module:ol/Feature} feature Feature.\n * @protected\n */\nVectorSource.prototype.removeFeatureInternal = function(feature) {\n  const featureKey = getUid(feature).toString();\n  this.featureChangeKeys_[featureKey].forEach(unlistenByKey);\n  delete this.featureChangeKeys_[featureKey];\n  const id = feature.getId();\n  if (id !== undefined) {\n    delete this.idIndex_[id.toString()];\n  } else {\n    delete this.undefIdIndex_[featureKey];\n  }\n  this.dispatchEvent(new VectorSourceEvent(\n    VectorEventType.REMOVEFEATURE, feature));\n};\n\n\n/**\n * Remove a feature from the id index.  Called internally when the feature id\n * may have changed.\n * @param {module:ol/Feature} feature The feature.\n * @return {boolean} Removed the feature from the index.\n * @private\n */\nVectorSource.prototype.removeFromIdIndex_ = function(feature) {\n  let removed = false;\n  for (const id in this.idIndex_) {\n    if (this.idIndex_[id] === feature) {\n      delete this.idIndex_[id];\n      removed = true;\n      break;\n    }\n  }\n  return removed;\n};\n\n\n/**\n * Set the new loader of the source. The next loadFeatures call will use the\n * new loader.\n * @param {module:ol/featureloader~FeatureLoader} loader The loader to set.\n * @api\n */\nVectorSource.prototype.setLoader = function(loader) {\n  this.loader_ = loader;\n};\n\nexport default VectorSource;\n","/**\n * @module ol/source/VectorEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a feature is added to the source.\n   * @event ol/source/Vector~VectorSourceEvent#addfeature\n   * @api\n   */\n  ADDFEATURE: 'addfeature',\n\n  /**\n   * Triggered when a feature is updated.\n   * @event ol/source/Vector~VectorSourceEvent#changefeature\n   * @api\n   */\n  CHANGEFEATURE: 'changefeature',\n\n  /**\n   * Triggered when the clear method is called on the source.\n   * @event ol/source/Vector~VectorSourceEvent#clear\n   * @api\n   */\n  CLEAR: 'clear',\n\n  /**\n   * Triggered when a feature is removed from the source.\n   * See {@link module:ol/source/Vector#clear source.clear()} for exceptions.\n   * @event ol/source/Vector~VectorSourceEvent#removefeature\n   * @api\n   */\n  REMOVEFEATURE: 'removefeature'\n};\n","/**\n * @license\n * Latitude/longitude spherical geodesy formulae taken from\n * http://www.movable-type.co.uk/scripts/latlong.html\n * Licensed under CC-BY-3.0.\n */\n\n/**\n * @module ol/sphere\n */\nimport {toRadians, toDegrees} from './math.js';\nimport GeometryType from './geom/GeometryType.js';\n\n\n/**\n * Object literal with options for the {@link getLength} or {@link getArea}\n * functions.\n * @typedef {Object} SphereMetricOptions\n * @property {module:ol/proj~ProjectionLike} [projection='EPSG:3857']\n * Projection of the  geometry.  By default, the geometry is assumed to be in\n * Web Mercator.\n * @property {number} [radius=6371008.8] Sphere radius.  By default, the radius of the\n * earth is used (Clarke 1866 Authalic Sphere).\n */\n\n\n/**\n * The mean Earth radius (1/3 * (2a + b)) for the WGS84 ellipsoid.\n * https://en.wikipedia.org/wiki/Earth_radius#Mean_radius\n * @type {number}\n */\nexport const DEFAULT_RADIUS = 6371008.8;\n\n\n/**\n * Get the great circle distance (in meters) between two geographic coordinates.\n * @param {Array} c1 Starting coordinate.\n * @param {Array} c2 Ending coordinate.\n * @param {number=} opt_radius The sphere radius to use.  Defaults to the Earth's\n *     mean radius using the WGS84 ellipsoid.\n * @return {number} The great circle distance between the points (in meters).\n * @api\n */\nexport function getDistance(c1, c2, opt_radius) {\n  const radius = opt_radius || DEFAULT_RADIUS;\n  const lat1 = toRadians(c1[1]);\n  const lat2 = toRadians(c2[1]);\n  const deltaLatBy2 = (lat2 - lat1) / 2;\n  const deltaLonBy2 = toRadians(c2[0] - c1[0]) / 2;\n  const a = Math.sin(deltaLatBy2) * Math.sin(deltaLatBy2) +\n      Math.sin(deltaLonBy2) * Math.sin(deltaLonBy2) *\n      Math.cos(lat1) * Math.cos(lat2);\n  return 2 * radius * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n}\n\n\n/**\n * Get the cumulative great circle length of linestring coordinates (geographic).\n * @param {Array} coordinates Linestring coordinates.\n * @param {number} radius The sphere radius to use.\n * @return {number} The length (in meters).\n */\nfunction getLengthInternal(coordinates, radius) {\n  let length = 0;\n  for (let i = 0, ii = coordinates.length; i < ii - 1; ++i) {\n    length += getDistance(coordinates[i], coordinates[i + 1], radius);\n  }\n  return length;\n}\n\n\n/**\n * Get the spherical length of a geometry.  This length is the sum of the\n * great circle distances between coordinates.  For polygons, the length is\n * the sum of all rings.  For points, the length is zero.  For multi-part\n * geometries, the length is the sum of the length of each part.\n * @param {module:ol/geom/Geometry} geometry A geometry.\n * @param {module:ol/sphere~SphereMetricOptions=} opt_options Options for the\n * length calculation.  By default, geometries are assumed to be in 'EPSG:3857'.\n * You can change this by providing a `projection` option.\n * @return {number} The spherical length (in meters).\n * @api\n */\nexport function getLength(geometry, opt_options) {\n  const options = opt_options || {};\n  const radius = options.radius || DEFAULT_RADIUS;\n  const projection = options.projection || 'EPSG:3857';\n  const type = geometry.getType();\n  if (type !== GeometryType.GEOMETRY_COLLECTION) {\n    geometry = geometry.clone().transform(projection, 'EPSG:4326');\n  }\n  let length = 0;\n  let coordinates, coords, i, ii, j, jj;\n  switch (type) {\n    case GeometryType.POINT:\n    case GeometryType.MULTI_POINT: {\n      break;\n    }\n    case GeometryType.LINE_STRING:\n    case GeometryType.LINEAR_RING: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      length = getLengthInternal(coordinates, radius);\n      break;\n    }\n    case GeometryType.MULTI_LINE_STRING:\n    case GeometryType.POLYGON: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        length += getLengthInternal(coordinates[i], radius);\n      }\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        coords = coordinates[i];\n        for (j = 0, jj = coords.length; j < jj; ++j) {\n          length += getLengthInternal(coords[j], radius);\n        }\n      }\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      const geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n      for (i = 0, ii = geometries.length; i < ii; ++i) {\n        length += getLength(geometries[i], opt_options);\n      }\n      break;\n    }\n    default: {\n      throw new Error('Unsupported geometry type: ' + type);\n    }\n  }\n  return length;\n}\n\n\n/**\n * Returns the spherical area for a list of coordinates.\n *\n * [Reference](https://trs-new.jpl.nasa.gov/handle/2014/40409)\n * Robert. G. Chamberlain and William H. Duquette, \"Some Algorithms for\n * Polygons on a Sphere\", JPL Publication 07-03, Jet Propulsion\n * Laboratory, Pasadena, CA, June 2007\n *\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates List of coordinates of a linear\n * ring. If the ring is oriented clockwise, the area will be positive,\n * otherwise it will be negative.\n * @param {number} radius The sphere radius.\n * @return {number} Area (in square meters).\n */\nfunction getAreaInternal(coordinates, radius) {\n  let area = 0;\n  const len = coordinates.length;\n  let x1 = coordinates[len - 1][0];\n  let y1 = coordinates[len - 1][1];\n  for (let i = 0; i < len; i++) {\n    const x2 = coordinates[i][0];\n    const y2 = coordinates[i][1];\n    area += toRadians(x2 - x1) *\n        (2 + Math.sin(toRadians(y1)) +\n        Math.sin(toRadians(y2)));\n    x1 = x2;\n    y1 = y2;\n  }\n  return area * radius * radius / 2.0;\n}\n\n\n/**\n * Get the spherical area of a geometry.  This is the area (in meters) assuming\n * that polygon edges are segments of great circles on a sphere.\n * @param {module:ol/geom/Geometry} geometry A geometry.\n * @param {module:ol/sphere~SphereMetricOptions=} opt_options Options for the area\n *     calculation.  By default, geometries are assumed to be in 'EPSG:3857'.\n *     You can change this by providing a `projection` option.\n * @return {number} The spherical area (in square meters).\n * @api\n */\nexport function getArea(geometry, opt_options) {\n  const options = opt_options || {};\n  const radius = options.radius || DEFAULT_RADIUS;\n  const projection = options.projection || 'EPSG:3857';\n  const type = geometry.getType();\n  if (type !== GeometryType.GEOMETRY_COLLECTION) {\n    geometry = geometry.clone().transform(projection, 'EPSG:4326');\n  }\n  let area = 0;\n  let coordinates, coords, i, ii, j, jj;\n  switch (type) {\n    case GeometryType.POINT:\n    case GeometryType.MULTI_POINT:\n    case GeometryType.LINE_STRING:\n    case GeometryType.MULTI_LINE_STRING:\n    case GeometryType.LINEAR_RING: {\n      break;\n    }\n    case GeometryType.POLYGON: {\n      coordinates = /** @type {module:ol/geom/Polygon} */ (geometry).getCoordinates();\n      area = Math.abs(getAreaInternal(coordinates[0], radius));\n      for (i = 1, ii = coordinates.length; i < ii; ++i) {\n        area -= Math.abs(getAreaInternal(coordinates[i], radius));\n      }\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        coords = coordinates[i];\n        area += Math.abs(getAreaInternal(coords[0], radius));\n        for (j = 1, jj = coords.length; j < jj; ++j) {\n          area -= Math.abs(getAreaInternal(coords[j], radius));\n        }\n      }\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      const geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n      for (i = 0, ii = geometries.length; i < ii; ++i) {\n        area += getArea(geometries[i], opt_options);\n      }\n      break;\n    }\n    default: {\n      throw new Error('Unsupported geometry type: ' + type);\n    }\n  }\n  return area;\n}\n\n\n/**\n * Returns the coordinate at the given distance and bearing from `c1`.\n *\n * @param {module:ol/coordinate~Coordinate} c1 The origin point (`[lon, lat]` in degrees).\n * @param {number} distance The great-circle distance between the origin\n *     point and the target point.\n * @param {number} bearing The bearing (in radians).\n * @param {number=} opt_radius The sphere radius to use.  Defaults to the Earth's\n *     mean radius using the WGS84 ellipsoid.\n * @return {module:ol/coordinate~Coordinate} The target point.\n */\nexport function offset(c1, distance, bearing, opt_radius) {\n  const radius = opt_radius || DEFAULT_RADIUS;\n  const lat1 = toRadians(c1[1]);\n  const lon1 = toRadians(c1[0]);\n  const dByR = distance / radius;\n  const lat = Math.asin(\n    Math.sin(lat1) * Math.cos(dByR) +\n      Math.cos(lat1) * Math.sin(dByR) * Math.cos(bearing));\n  const lon = lon1 + Math.atan2(\n    Math.sin(bearing) * Math.sin(dByR) * Math.cos(lat1),\n    Math.cos(dByR) - Math.sin(lat1) * Math.sin(lat));\n  return [toDegrees(lon), toDegrees(lat)];\n}\n","/**\n * @module ol/string\n */\n\n/**\n * @param {number} number Number to be formatted\n * @param {number} width The desired width\n * @param {number=} opt_precision Precision of the output string (i.e. number of decimal places)\n * @returns {string} Formatted string\n */\nexport function padNumber(number, width, opt_precision) {\n  const numberString = opt_precision !== undefined ? number.toFixed(opt_precision) : '' + number;\n  let decimal = numberString.indexOf('.');\n  decimal = decimal === -1 ? numberString.length : decimal;\n  return decimal > width ? numberString : new Array(1 + width - decimal).join('0') + numberString;\n}\n\n\n/**\n * Adapted from https://github.com/omichelsen/compare-versions/blob/master/index.js\n * @param {string|number} v1 First version\n * @param {string|number} v2 Second version\n * @returns {number} Value\n */\nexport function compareVersions(v1, v2) {\n  const s1 = ('' + v1).split('.');\n  const s2 = ('' + v2).split('.');\n\n  for (let i = 0; i < Math.max(s1.length, s2.length); i++) {\n    const n1 = parseInt(s1[i] || '0', 10);\n    const n2 = parseInt(s2[i] || '0', 10);\n\n    if (n1 > n2) {\n      return 1;\n    }\n    if (n2 > n1) {\n      return -1;\n    }\n  }\n\n  return 0;\n}\n","/**\n * @module ol/structs/LRUCache\n */\nimport {inherits} from '../index.js';\nimport {assert} from '../asserts.js';\nimport EventTarget from '../events/EventTarget.js';\nimport EventType from '../events/EventType.js';\n\n\n/**\n * @typedef {Object} Entry\n * @property {string} key_\n * @property {Object} newer\n * @property {Object} older\n * @property {*} value_\n */\n\n\n/**\n * Implements a Least-Recently-Used cache where the keys do not conflict with\n * Object's properties (e.g. 'hasOwnProperty' is not allowed as a key). Expiring\n * items from the cache is the responsibility of the user.\n * @constructor\n * @extends {module:ol/events/EventTarget}\n * @fires module:ol/events/Event~Event\n * @struct\n * @template T\n * @param {number=} opt_highWaterMark High water mark.\n */\nconst LRUCache = function(opt_highWaterMark) {\n\n  EventTarget.call(this);\n\n  /**\n   * @type {number}\n   */\n  this.highWaterMark = opt_highWaterMark !== undefined ? opt_highWaterMark : 2048;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.count_ = 0;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/structs/LRUCache~Entry>}\n   */\n  this.entries_ = {};\n\n  /**\n   * @private\n   * @type {?module:ol/structs/LRUCache~Entry}\n   */\n  this.oldest_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/structs/LRUCache~Entry}\n   */\n  this.newest_ = null;\n\n};\n\ninherits(LRUCache, EventTarget);\n\n\n/**\n * @return {boolean} Can expire cache.\n */\nLRUCache.prototype.canExpireCache = function() {\n  return this.getCount() > this.highWaterMark;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nLRUCache.prototype.clear = function() {\n  this.count_ = 0;\n  this.entries_ = {};\n  this.oldest_ = null;\n  this.newest_ = null;\n  this.dispatchEvent(EventType.CLEAR);\n};\n\n\n/**\n * @param {string} key Key.\n * @return {boolean} Contains key.\n */\nLRUCache.prototype.containsKey = function(key) {\n  return this.entries_.hasOwnProperty(key);\n};\n\n\n/**\n * @param {function(this: S, T, string, module:ol/structs/LRUCache): ?} f The function\n *     to call for every entry from the oldest to the newer. This function takes\n *     3 arguments (the entry value, the entry key and the LRUCache object).\n *     The return value is ignored.\n * @param {S=} opt_this The object to use as `this` in `f`.\n * @template S\n */\nLRUCache.prototype.forEach = function(f, opt_this) {\n  let entry = this.oldest_;\n  while (entry) {\n    f.call(opt_this, entry.value_, entry.key_, this);\n    entry = entry.newer;\n  }\n};\n\n\n/**\n * @param {string} key Key.\n * @return {T} Value.\n */\nLRUCache.prototype.get = function(key) {\n  const entry = this.entries_[key];\n  assert(entry !== undefined,\n    15); // Tried to get a value for a key that does not exist in the cache\n  if (entry === this.newest_) {\n    return entry.value_;\n  } else if (entry === this.oldest_) {\n    this.oldest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (this.oldest_.newer);\n    this.oldest_.older = null;\n  } else {\n    entry.newer.older = entry.older;\n    entry.older.newer = entry.newer;\n  }\n  entry.newer = null;\n  entry.older = this.newest_;\n  this.newest_.newer = entry;\n  this.newest_ = entry;\n  return entry.value_;\n};\n\n\n/**\n * Remove an entry from the cache.\n * @param {string} key The entry key.\n * @return {T} The removed entry.\n */\nLRUCache.prototype.remove = function(key) {\n  const entry = this.entries_[key];\n  assert(entry !== undefined, 15); // Tried to get a value for a key that does not exist in the cache\n  if (entry === this.newest_) {\n    this.newest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (entry.older);\n    if (this.newest_) {\n      this.newest_.newer = null;\n    }\n  } else if (entry === this.oldest_) {\n    this.oldest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (entry.newer);\n    if (this.oldest_) {\n      this.oldest_.older = null;\n    }\n  } else {\n    entry.newer.older = entry.older;\n    entry.older.newer = entry.newer;\n  }\n  delete this.entries_[key];\n  --this.count_;\n  return entry.value_;\n};\n\n\n/**\n * @return {number} Count.\n */\nLRUCache.prototype.getCount = function() {\n  return this.count_;\n};\n\n\n/**\n * @return {Array.<string>} Keys.\n */\nLRUCache.prototype.getKeys = function() {\n  const keys = new Array(this.count_);\n  let i = 0;\n  let entry;\n  for (entry = this.newest_; entry; entry = entry.older) {\n    keys[i++] = entry.key_;\n  }\n  return keys;\n};\n\n\n/**\n * @return {Array.<T>} Values.\n */\nLRUCache.prototype.getValues = function() {\n  const values = new Array(this.count_);\n  let i = 0;\n  let entry;\n  for (entry = this.newest_; entry; entry = entry.older) {\n    values[i++] = entry.value_;\n  }\n  return values;\n};\n\n\n/**\n * @return {T} Last value.\n */\nLRUCache.prototype.peekLast = function() {\n  return this.oldest_.value_;\n};\n\n\n/**\n * @return {string} Last key.\n */\nLRUCache.prototype.peekLastKey = function() {\n  return this.oldest_.key_;\n};\n\n\n/**\n * Get the key of the newest item in the cache.  Throws if the cache is empty.\n * @return {string} The newest key.\n */\nLRUCache.prototype.peekFirstKey = function() {\n  return this.newest_.key_;\n};\n\n\n/**\n * @return {T} value Value.\n */\nLRUCache.prototype.pop = function() {\n  const entry = this.oldest_;\n  delete this.entries_[entry.key_];\n  if (entry.newer) {\n    entry.newer.older = null;\n  }\n  this.oldest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (entry.newer);\n  if (!this.oldest_) {\n    this.newest_ = null;\n  }\n  --this.count_;\n  return entry.value_;\n};\n\n\n/**\n * @param {string} key Key.\n * @param {T} value Value.\n */\nLRUCache.prototype.replace = function(key, value) {\n  this.get(key);  // update `newest_`\n  this.entries_[key].value_ = value;\n};\n\n\n/**\n * @param {string} key Key.\n * @param {T} value Value.\n */\nLRUCache.prototype.set = function(key, value) {\n  assert(!(key in this.entries_),\n    16); // Tried to set a value for a key that is used already\n  const entry = /** @type {module:ol/structs/LRUCache~Entry} */ ({\n    key_: key,\n    newer: null,\n    older: this.newest_,\n    value_: value\n  });\n  if (!this.newest_) {\n    this.oldest_ = entry;\n  } else {\n    this.newest_.newer = entry;\n  }\n  this.newest_ = entry;\n  this.entries_[key] = entry;\n  ++this.count_;\n};\n\n\n/**\n * Set a maximum number of entries for the cache.\n * @param {number} size Cache size.\n * @api\n */\nLRUCache.prototype.setSize = function(size) {\n  this.highWaterMark = size;\n};\n\n\n/**\n * Prune the cache.\n */\nLRUCache.prototype.prune = function() {\n  while (this.canExpireCache()) {\n    this.pop();\n  }\n};\nexport default LRUCache;\n","/**\n * @module ol/structs/PriorityQueue\n */\nimport {assert} from '../asserts.js';\nimport {clear} from '../obj.js';\n\n/**\n * Priority queue.\n *\n * The implementation is inspired from the Closure Library's Heap class and\n * Python's heapq module.\n *\n * @see http://closure-library.googlecode.com/svn/docs/closure_goog_structs_heap.js.source.html\n * @see http://hg.python.org/cpython/file/2.7/Lib/heapq.py\n *\n * @constructor\n * @param {function(T): number} priorityFunction Priority function.\n * @param {function(T): string} keyFunction Key function.\n * @struct\n * @template T\n */\nconst PriorityQueue = function(priorityFunction, keyFunction) {\n\n  /**\n   * @type {function(T): number}\n   * @private\n   */\n  this.priorityFunction_ = priorityFunction;\n\n  /**\n   * @type {function(T): string}\n   * @private\n   */\n  this.keyFunction_ = keyFunction;\n\n  /**\n   * @type {Array.<T>}\n   * @private\n   */\n  this.elements_ = [];\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.priorities_ = [];\n\n  /**\n   * @type {!Object.<string, boolean>}\n   * @private\n   */\n  this.queuedElements_ = {};\n\n};\n\n\n/**\n * @type {number}\n */\nexport const DROP = Infinity;\n\n\n/**\n * FIXME empty description for jsdoc\n */\nPriorityQueue.prototype.clear = function() {\n  this.elements_.length = 0;\n  this.priorities_.length = 0;\n  clear(this.queuedElements_);\n};\n\n\n/**\n * Remove and return the highest-priority element. O(log N).\n * @return {T} Element.\n */\nPriorityQueue.prototype.dequeue = function() {\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  const element = elements[0];\n  if (elements.length == 1) {\n    elements.length = 0;\n    priorities.length = 0;\n  } else {\n    elements[0] = elements.pop();\n    priorities[0] = priorities.pop();\n    this.siftUp_(0);\n  }\n  const elementKey = this.keyFunction_(element);\n  delete this.queuedElements_[elementKey];\n  return element;\n};\n\n\n/**\n * Enqueue an element. O(log N).\n * @param {T} element Element.\n * @return {boolean} The element was added to the queue.\n */\nPriorityQueue.prototype.enqueue = function(element) {\n  assert(!(this.keyFunction_(element) in this.queuedElements_),\n    31); // Tried to enqueue an `element` that was already added to the queue\n  const priority = this.priorityFunction_(element);\n  if (priority != DROP) {\n    this.elements_.push(element);\n    this.priorities_.push(priority);\n    this.queuedElements_[this.keyFunction_(element)] = true;\n    this.siftDown_(0, this.elements_.length - 1);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * @return {number} Count.\n */\nPriorityQueue.prototype.getCount = function() {\n  return this.elements_.length;\n};\n\n\n/**\n * Gets the index of the left child of the node at the given index.\n * @param {number} index The index of the node to get the left child for.\n * @return {number} The index of the left child.\n * @private\n */\nPriorityQueue.prototype.getLeftChildIndex_ = function(index) {\n  return index * 2 + 1;\n};\n\n\n/**\n * Gets the index of the right child of the node at the given index.\n * @param {number} index The index of the node to get the right child for.\n * @return {number} The index of the right child.\n * @private\n */\nPriorityQueue.prototype.getRightChildIndex_ = function(index) {\n  return index * 2 + 2;\n};\n\n\n/**\n * Gets the index of the parent of the node at the given index.\n * @param {number} index The index of the node to get the parent for.\n * @return {number} The index of the parent.\n * @private\n */\nPriorityQueue.prototype.getParentIndex_ = function(index) {\n  return (index - 1) >> 1;\n};\n\n\n/**\n * Make this a heap. O(N).\n * @private\n */\nPriorityQueue.prototype.heapify_ = function() {\n  let i;\n  for (i = (this.elements_.length >> 1) - 1; i >= 0; i--) {\n    this.siftUp_(i);\n  }\n};\n\n\n/**\n * @return {boolean} Is empty.\n */\nPriorityQueue.prototype.isEmpty = function() {\n  return this.elements_.length === 0;\n};\n\n\n/**\n * @param {string} key Key.\n * @return {boolean} Is key queued.\n */\nPriorityQueue.prototype.isKeyQueued = function(key) {\n  return key in this.queuedElements_;\n};\n\n\n/**\n * @param {T} element Element.\n * @return {boolean} Is queued.\n */\nPriorityQueue.prototype.isQueued = function(element) {\n  return this.isKeyQueued(this.keyFunction_(element));\n};\n\n\n/**\n * @param {number} index The index of the node to move down.\n * @private\n */\nPriorityQueue.prototype.siftUp_ = function(index) {\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  const count = elements.length;\n  const element = elements[index];\n  const priority = priorities[index];\n  const startIndex = index;\n\n  while (index < (count >> 1)) {\n    const lIndex = this.getLeftChildIndex_(index);\n    const rIndex = this.getRightChildIndex_(index);\n\n    const smallerChildIndex = rIndex < count &&\n        priorities[rIndex] < priorities[lIndex] ?\n      rIndex : lIndex;\n\n    elements[index] = elements[smallerChildIndex];\n    priorities[index] = priorities[smallerChildIndex];\n    index = smallerChildIndex;\n  }\n\n  elements[index] = element;\n  priorities[index] = priority;\n  this.siftDown_(startIndex, index);\n};\n\n\n/**\n * @param {number} startIndex The index of the root.\n * @param {number} index The index of the node to move up.\n * @private\n */\nPriorityQueue.prototype.siftDown_ = function(startIndex, index) {\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  const element = elements[index];\n  const priority = priorities[index];\n\n  while (index > startIndex) {\n    const parentIndex = this.getParentIndex_(index);\n    if (priorities[parentIndex] > priority) {\n      elements[index] = elements[parentIndex];\n      priorities[index] = priorities[parentIndex];\n      index = parentIndex;\n    } else {\n      break;\n    }\n  }\n  elements[index] = element;\n  priorities[index] = priority;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nPriorityQueue.prototype.reprioritize = function() {\n  const priorityFunction = this.priorityFunction_;\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  let index = 0;\n  const n = elements.length;\n  let element, i, priority;\n  for (i = 0; i < n; ++i) {\n    element = elements[i];\n    priority = priorityFunction(element);\n    if (priority == DROP) {\n      delete this.queuedElements_[this.keyFunction_(element)];\n    } else {\n      priorities[index] = priority;\n      elements[index++] = element;\n    }\n  }\n  elements.length = index;\n  priorities.length = index;\n  this.heapify_();\n};\nexport default PriorityQueue;\n","/**\n * @module ol/structs/RBush\n */\nimport {getUid} from '../index.js';\nimport rbush from 'rbush';\nimport {createOrUpdate, equals} from '../extent.js';\nimport {isEmpty} from '../obj.js';\n\n/**\n * @typedef {Object} Entry\n * @property {number} minX\n * @property {number} minY\n * @property {number} maxX\n * @property {number} maxY\n * @property {Object} [value]\n */\n\n/**\n * Wrapper around the RBush by Vladimir Agafonkin.\n *\n * @constructor\n * @param {number=} opt_maxEntries Max entries.\n * @see https://github.com/mourner/rbush\n * @struct\n * @template T\n */\nconst RBush = function(opt_maxEntries) {\n\n  /**\n   * @private\n   */\n  this.rbush_ = rbush(opt_maxEntries, undefined);\n\n  /**\n   * A mapping between the objects added to this rbush wrapper\n   * and the objects that are actually added to the internal rbush.\n   * @private\n   * @type {Object.<number, module:ol/structs/RBush~Entry>}\n   */\n  this.items_ = {};\n\n};\n\n\n/**\n * Insert a value into the RBush.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {T} value Value.\n */\nRBush.prototype.insert = function(extent, value) {\n  /** @type {module:ol/structs/RBush~Entry} */\n  const item = {\n    minX: extent[0],\n    minY: extent[1],\n    maxX: extent[2],\n    maxY: extent[3],\n    value: value\n  };\n\n  this.rbush_.insert(item);\n  this.items_[getUid(value)] = item;\n};\n\n\n/**\n * Bulk-insert values into the RBush.\n * @param {Array.<module:ol/extent~Extent>} extents Extents.\n * @param {Array.<T>} values Values.\n */\nRBush.prototype.load = function(extents, values) {\n  const items = new Array(values.length);\n  for (let i = 0, l = values.length; i < l; i++) {\n    const extent = extents[i];\n    const value = values[i];\n\n    /** @type {module:ol/structs/RBush~Entry} */\n    const item = {\n      minX: extent[0],\n      minY: extent[1],\n      maxX: extent[2],\n      maxY: extent[3],\n      value: value\n    };\n    items[i] = item;\n    this.items_[getUid(value)] = item;\n  }\n  this.rbush_.load(items);\n};\n\n\n/**\n * Remove a value from the RBush.\n * @param {T} value Value.\n * @return {boolean} Removed.\n */\nRBush.prototype.remove = function(value) {\n  const uid = getUid(value);\n\n  // get the object in which the value was wrapped when adding to the\n  // internal rbush. then use that object to do the removal.\n  const item = this.items_[uid];\n  delete this.items_[uid];\n  return this.rbush_.remove(item) !== null;\n};\n\n\n/**\n * Update the extent of a value in the RBush.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {T} value Value.\n */\nRBush.prototype.update = function(extent, value) {\n  const item = this.items_[getUid(value)];\n  const bbox = [item.minX, item.minY, item.maxX, item.maxY];\n  if (!equals(bbox, extent)) {\n    this.remove(value);\n    this.insert(extent, value);\n  }\n};\n\n\n/**\n * Return all values in the RBush.\n * @return {Array.<T>} All.\n */\nRBush.prototype.getAll = function() {\n  const items = this.rbush_.all();\n  return items.map(function(item) {\n    return item.value;\n  });\n};\n\n\n/**\n * Return all values in the given extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {Array.<T>} All in extent.\n */\nRBush.prototype.getInExtent = function(extent) {\n  /** @type {module:ol/structs/RBush~Entry} */\n  const bbox = {\n    minX: extent[0],\n    minY: extent[1],\n    maxX: extent[2],\n    maxY: extent[3]\n  };\n  const items = this.rbush_.search(bbox);\n  return items.map(function(item) {\n    return item.value;\n  });\n};\n\n\n/**\n * Calls a callback function with each value in the tree.\n * If the callback returns a truthy value, this value is returned without\n * checking the rest of the tree.\n * @param {function(this: S, T): *} callback Callback.\n * @param {S=} opt_this The object to use as `this` in `callback`.\n * @return {*} Callback return value.\n * @template S\n */\nRBush.prototype.forEach = function(callback, opt_this) {\n  return this.forEach_(this.getAll(), callback, opt_this);\n};\n\n\n/**\n * Calls a callback function with each value in the provided extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(this: S, T): *} callback Callback.\n * @param {S=} opt_this The object to use as `this` in `callback`.\n * @return {*} Callback return value.\n * @template S\n */\nRBush.prototype.forEachInExtent = function(extent, callback, opt_this) {\n  return this.forEach_(this.getInExtent(extent), callback, opt_this);\n};\n\n\n/**\n * @param {Array.<T>} values Values.\n * @param {function(this: S, T): *} callback Callback.\n * @param {S=} opt_this The object to use as `this` in `callback`.\n * @private\n * @return {*} Callback return value.\n * @template S\n */\nRBush.prototype.forEach_ = function(values, callback, opt_this) {\n  let result;\n  for (let i = 0, l = values.length; i < l; i++) {\n    result = callback.call(opt_this, values[i]);\n    if (result) {\n      return result;\n    }\n  }\n  return result;\n};\n\n\n/**\n * @return {boolean} Is empty.\n */\nRBush.prototype.isEmpty = function() {\n  return isEmpty(this.items_);\n};\n\n\n/**\n * Remove all values from the RBush.\n */\nRBush.prototype.clear = function() {\n  this.rbush_.clear();\n  this.items_ = {};\n};\n\n\n/**\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nRBush.prototype.getExtent = function(opt_extent) {\n  // FIXME add getExtent() to rbush\n  const data = this.rbush_.data;\n  return createOrUpdate(data.minX, data.minY, data.maxX, data.maxY, opt_extent);\n};\n\n\n/**\n * @param {module:ol/structs/RBush} rbush R-Tree.\n */\nRBush.prototype.concat = function(rbush) {\n  this.rbush_.load(rbush.rbush_.all());\n  for (const i in rbush.items_) {\n    this.items_[i | 0] = rbush.items_[i | 0];\n  }\n};\nexport default RBush;\n","/**\n * @module ol/style/Circle\n */\nimport {inherits} from '../index.js';\nimport RegularShape from '../style/RegularShape.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/style/Fill} [fill] Fill style.\n * @property {number} radius Circle radius.\n * @property {boolean} [snapToPixel=true] If `true` integral numbers of pixels are used as the X and Y pixel coordinate\n * when drawing the circle in the output canvas. If `false` fractional numbers may be used. Using `true` allows for\n * \"sharp\" rendering (no blur), while using `false` allows for \"accurate\" rendering. Note that accuracy is important if\n * the circle's position is animated. Without it, the circle may jitter noticeably.\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {module:ol/style/AtlasManager} [atlasManager] The atlas manager to use for this circle.\n * When using WebGL it is recommended to use an atlas manager to avoid texture switching. If an atlas manager is given,\n * the circle is added to an atlas. By default no atlas manager is used.\n */\n\n\n/**\n * @classdesc\n * Set circle style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Circle~Options=} opt_options Options.\n * @extends {module:ol/style/RegularShape}\n * @api\n */\nconst CircleStyle = function(opt_options) {\n\n  const options = opt_options || {};\n\n  RegularShape.call(this, {\n    points: Infinity,\n    fill: options.fill,\n    radius: options.radius,\n    snapToPixel: options.snapToPixel,\n    stroke: options.stroke,\n    atlasManager: options.atlasManager\n  });\n\n};\n\ninherits(CircleStyle, RegularShape);\n\n\n/**\n * Clones the style.  If an atlasmanager was provided to the original style it will be used in the cloned style, too.\n * @return {module:ol/style/Circle} The cloned style.\n * @override\n * @api\n */\nCircleStyle.prototype.clone = function() {\n  const style = new CircleStyle({\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    radius: this.getRadius(),\n    snapToPixel: this.getSnapToPixel(),\n    atlasManager: this.atlasManager_\n  });\n  style.setOpacity(this.getOpacity());\n  style.setScale(this.getScale());\n  return style;\n};\n\n\n/**\n * Set the circle radius.\n *\n * @param {number} radius Circle radius.\n * @api\n */\nCircleStyle.prototype.setRadius = function(radius) {\n  this.radius_ = radius;\n  this.render_(this.atlasManager_);\n};\nexport default CircleStyle;\n","/**\n * @module ol/style/Fill\n */\nimport {getUid} from '../index.js';\nimport {asString} from '../color.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/color~Color|module:ol/colorlike~ColorLike} [color] A color, gradient or pattern.\n * See {@link module:ol/color~Color} and {@link module:ol/colorlike~ColorLike} for possible formats.\n * Default null; if null, the Canvas/renderer default black will be used.\n */\n\n\n/**\n * @classdesc\n * Set fill style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Fill~Options=} opt_options Options.\n * @api\n */\nconst Fill = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {module:ol/color~Color|module:ol/colorlike~ColorLike}\n   */\n  this.color_ = options.color !== undefined ? options.color : null;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Clones the style. The color is not cloned if it is an {@link module:ol/colorlike~ColorLike}.\n * @return {module:ol/style/Fill} The cloned style.\n * @api\n */\nFill.prototype.clone = function() {\n  const color = this.getColor();\n  return new Fill({\n    color: (color && color.slice) ? color.slice() : color || undefined\n  });\n};\n\n\n/**\n * Get the fill color.\n * @return {module:ol/color~Color|module:ol/colorlike~ColorLike} Color.\n * @api\n */\nFill.prototype.getColor = function() {\n  return this.color_;\n};\n\n\n/**\n * Set the color.\n *\n * @param {module:ol/color~Color|module:ol/colorlike~ColorLike} color Color.\n * @api\n */\nFill.prototype.setColor = function(color) {\n  this.color_ = color;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * @return {string} The checksum.\n */\nFill.prototype.getChecksum = function() {\n  if (this.checksum_ === undefined) {\n    if (\n      this.color_ instanceof CanvasPattern ||\n        this.color_ instanceof CanvasGradient\n    ) {\n      this.checksum_ = getUid(this.color_).toString();\n    } else {\n      this.checksum_ = 'f' + (this.color_ ? asString(this.color_) : '-');\n    }\n  }\n\n  return this.checksum_;\n};\nexport default Fill;\n","/**\n * @module ol/style/Icon\n */\nimport {getUid, inherits} from '../index.js';\nimport ImageState from '../ImageState.js';\nimport {assert} from '../asserts.js';\nimport {asArray} from '../color.js';\nimport {listen, unlisten} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport IconAnchorUnits from '../style/IconAnchorUnits.js';\nimport {get as getIconImage} from '../style/IconImage.js';\nimport IconOrigin from '../style/IconOrigin.js';\nimport ImageStyle from '../style/Image.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Array.<number>} [anchor=[0.5, 0.5]] Anchor. Default value is the icon center.\n * @property {module:ol/style/IconOrigin} [anchorOrigin] Origin of the anchor: `bottom-left`, `bottom-right`,\n * `top-left` or `top-right`. Default is `top-left`.\n * @property {module:ol/style/IconAnchorUnits} [anchorXUnits] Units in which the anchor x value is\n * specified. A value of `'fraction'` indicates the x value is a fraction of the icon. A value of `'pixels'` indicates\n * the x value in pixels. Default is `'fraction'`.\n * @property {module:ol/style/IconAnchorUnits} [anchorYUnits] Units in which the anchor y value is\n * specified. A value of `'fraction'` indicates the y value is a fraction of the icon. A value of `'pixels'` indicates\n * the y value in pixels. Default is `'fraction'`.\n * @property {module:ol/color~Color|string} [color] Color to tint the icon. If not specified,\n * the icon will be left as is.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images. Note that you must provide a\n * `crossOrigin` value if you are using the WebGL renderer or if you want to access pixel data with the Canvas renderer.\n * See {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {Image|HTMLCanvasElement} [img] Image object for the icon. If the `src` option is not provided then the\n * provided image must already be loaded. And in that case, it is required\n * to provide the size of the image, with the `imgSize` option.\n * @property {Array.<number>} [offset=[0, 0]] Offset, which, together with the size and the offset origin, define the\n * sub-rectangle to use from the original icon image.\n * @property {module:ol/style/IconOrigin} [offsetOrigin] Origin of the offset: `bottom-left`, `bottom-right`,\n * `top-left` or `top-right`. Default is `top-left`.\n * @property {number} [opacity=1] Opacity of the icon.\n * @property {number} [scale=1] Scale.\n * @property {boolean} [snapToPixel=true] If `true` integral numbers of pixels are used as the X and Y pixel coordinate\n * when drawing the icon in the output canvas. If `false` fractional numbers may be used. Using `true` allows for\n * \"sharp\" rendering (no blur), while using `false` allows for \"accurate\" rendering. Note that accuracy is important if\n * the icon's position is animated. Without it, the icon may jitter noticeably.\n * @property {boolean} [rotateWithView=false] Whether to rotate the icon with the view.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {module:ol/size~Size} [size] Icon size in pixel. Can be used together with `offset` to define the\n * sub-rectangle to use from the origin (sprite) icon image.\n * @property {module:ol/size~Size} [imgSize] Image size in pixels. Only required if `img` is set and `src` is not, and\n * for SVG images in Internet Explorer 11. The provided `imgSize` needs to match the actual size of the image.\n * @property {string} [src] Image source URI.\n */\n\n\n/**\n * @classdesc\n * Set icon style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Icon~Options=} opt_options Options.\n * @extends {module:ol/style/Image}\n * @api\n */\nconst Icon = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.anchor_ = options.anchor !== undefined ? options.anchor : [0.5, 0.5];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.normalizedAnchor_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/IconOrigin}\n   */\n  this.anchorOrigin_ = options.anchorOrigin !== undefined ?\n    options.anchorOrigin : IconOrigin.TOP_LEFT;\n\n  /**\n   * @private\n   * @type {module:ol/style/IconAnchorUnits}\n   */\n  this.anchorXUnits_ = options.anchorXUnits !== undefined ?\n    options.anchorXUnits : IconAnchorUnits.FRACTION;\n\n  /**\n   * @private\n   * @type {module:ol/style/IconAnchorUnits}\n   */\n  this.anchorYUnits_ = options.anchorYUnits !== undefined ?\n    options.anchorYUnits : IconAnchorUnits.FRACTION;\n\n  /**\n   * @private\n   * @type {?string}\n   */\n  this.crossOrigin_ =\n      options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n  /**\n   * @type {Image|HTMLCanvasElement}\n   */\n  const image = options.img !== undefined ? options.img : null;\n\n  /**\n   * @type {module:ol/size~Size}\n   */\n  const imgSize = options.imgSize !== undefined ? options.imgSize : null;\n\n  /**\n   * @type {string|undefined}\n   */\n  let src = options.src;\n\n  assert(!(src !== undefined && image),\n    4); // `image` and `src` cannot be provided at the same time\n  assert(!image || (image && imgSize),\n    5); // `imgSize` must be set when `image` is provided\n\n  if ((src === undefined || src.length === 0) && image) {\n    src = image.src || getUid(image).toString();\n  }\n  assert(src !== undefined && src.length > 0,\n    6); // A defined and non-empty `src` or `image` must be provided\n\n  /**\n   * @type {module:ol/ImageState}\n   */\n  const imageState = options.src !== undefined ?\n    ImageState.IDLE : ImageState.LOADED;\n\n  /**\n   * @private\n   * @type {module:ol/color~Color}\n   */\n  this.color_ = options.color !== undefined ? asArray(options.color) : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/IconImage}\n   */\n  this.iconImage_ = getIconImage(\n    image, /** @type {string} */ (src), imgSize, this.crossOrigin_, imageState, this.color_);\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.offset_ = options.offset !== undefined ? options.offset : [0, 0];\n\n  /**\n   * @private\n   * @type {module:ol/style/IconOrigin}\n   */\n  this.offsetOrigin_ = options.offsetOrigin !== undefined ?\n    options.offsetOrigin : IconOrigin.TOP_LEFT;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.origin_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.size_ = options.size !== undefined ? options.size : null;\n\n  /**\n   * @type {number}\n   */\n  const opacity = options.opacity !== undefined ? options.opacity : 1;\n\n  /**\n   * @type {boolean}\n   */\n  const rotateWithView = options.rotateWithView !== undefined ?\n    options.rotateWithView : false;\n\n  /**\n   * @type {number}\n   */\n  const rotation = options.rotation !== undefined ? options.rotation : 0;\n\n  /**\n   * @type {number}\n   */\n  const scale = options.scale !== undefined ? options.scale : 1;\n\n  /**\n   * @type {boolean}\n   */\n  const snapToPixel = options.snapToPixel !== undefined ?\n    options.snapToPixel : true;\n\n  ImageStyle.call(this, {\n    opacity: opacity,\n    rotation: rotation,\n    scale: scale,\n    snapToPixel: snapToPixel,\n    rotateWithView: rotateWithView\n  });\n\n};\n\ninherits(Icon, ImageStyle);\n\n\n/**\n * Clones the style. The underlying Image/HTMLCanvasElement is not cloned.\n * @return {module:ol/style/Icon} The cloned style.\n * @api\n */\nIcon.prototype.clone = function() {\n  return new Icon({\n    anchor: this.anchor_.slice(),\n    anchorOrigin: this.anchorOrigin_,\n    anchorXUnits: this.anchorXUnits_,\n    anchorYUnits: this.anchorYUnits_,\n    crossOrigin: this.crossOrigin_,\n    color: (this.color_ && this.color_.slice) ? this.color_.slice() : this.color_ || undefined,\n    src: this.getSrc(),\n    offset: this.offset_.slice(),\n    offsetOrigin: this.offsetOrigin_,\n    size: this.size_ !== null ? this.size_.slice() : undefined,\n    opacity: this.getOpacity(),\n    scale: this.getScale(),\n    snapToPixel: this.getSnapToPixel(),\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView()\n  });\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nIcon.prototype.getAnchor = function() {\n  if (this.normalizedAnchor_) {\n    return this.normalizedAnchor_;\n  }\n  let anchor = this.anchor_;\n  const size = this.getSize();\n  if (this.anchorXUnits_ == IconAnchorUnits.FRACTION ||\n      this.anchorYUnits_ == IconAnchorUnits.FRACTION) {\n    if (!size) {\n      return null;\n    }\n    anchor = this.anchor_.slice();\n    if (this.anchorXUnits_ == IconAnchorUnits.FRACTION) {\n      anchor[0] *= size[0];\n    }\n    if (this.anchorYUnits_ == IconAnchorUnits.FRACTION) {\n      anchor[1] *= size[1];\n    }\n  }\n\n  if (this.anchorOrigin_ != IconOrigin.TOP_LEFT) {\n    if (!size) {\n      return null;\n    }\n    if (anchor === this.anchor_) {\n      anchor = this.anchor_.slice();\n    }\n    if (this.anchorOrigin_ == IconOrigin.TOP_RIGHT ||\n        this.anchorOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n      anchor[0] = -anchor[0] + size[0];\n    }\n    if (this.anchorOrigin_ == IconOrigin.BOTTOM_LEFT ||\n        this.anchorOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n      anchor[1] = -anchor[1] + size[1];\n    }\n  }\n  this.normalizedAnchor_ = anchor;\n  return this.normalizedAnchor_;\n};\n\n\n/**\n * Get the icon color.\n * @return {module:ol/color~Color} Color.\n * @api\n */\nIcon.prototype.getColor = function() {\n  return this.color_;\n};\n\n\n/**\n * Get the image icon.\n * @param {number} pixelRatio Pixel ratio.\n * @return {Image|HTMLCanvasElement} Image or Canvas element.\n * @override\n * @api\n */\nIcon.prototype.getImage = function(pixelRatio) {\n  return this.iconImage_.getImage(pixelRatio);\n};\n\n\n/**\n * @override\n */\nIcon.prototype.getImageSize = function() {\n  return this.iconImage_.getSize();\n};\n\n\n/**\n * @override\n */\nIcon.prototype.getHitDetectionImageSize = function() {\n  return this.getImageSize();\n};\n\n\n/**\n * @override\n */\nIcon.prototype.getImageState = function() {\n  return this.iconImage_.getImageState();\n};\n\n\n/**\n * @override\n */\nIcon.prototype.getHitDetectionImage = function(pixelRatio) {\n  return this.iconImage_.getHitDetectionImage(pixelRatio);\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nIcon.prototype.getOrigin = function() {\n  if (this.origin_) {\n    return this.origin_;\n  }\n  let offset = this.offset_;\n\n  if (this.offsetOrigin_ != IconOrigin.TOP_LEFT) {\n    const size = this.getSize();\n    const iconImageSize = this.iconImage_.getSize();\n    if (!size || !iconImageSize) {\n      return null;\n    }\n    offset = offset.slice();\n    if (this.offsetOrigin_ == IconOrigin.TOP_RIGHT ||\n        this.offsetOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n      offset[0] = iconImageSize[0] - size[0] - offset[0];\n    }\n    if (this.offsetOrigin_ == IconOrigin.BOTTOM_LEFT ||\n        this.offsetOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n      offset[1] = iconImageSize[1] - size[1] - offset[1];\n    }\n  }\n  this.origin_ = offset;\n  return this.origin_;\n};\n\n\n/**\n * Get the image URL.\n * @return {string|undefined} Image src.\n * @api\n */\nIcon.prototype.getSrc = function() {\n  return this.iconImage_.getSrc();\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nIcon.prototype.getSize = function() {\n  return !this.size_ ? this.iconImage_.getSize() : this.size_;\n};\n\n\n/**\n * @override\n */\nIcon.prototype.listenImageChange = function(listener, thisArg) {\n  return listen(this.iconImage_, EventType.CHANGE,\n    listener, thisArg);\n};\n\n\n/**\n * Load not yet loaded URI.\n * When rendering a feature with an icon style, the vector renderer will\n * automatically call this method. However, you might want to call this\n * method yourself for preloading or other purposes.\n * @override\n * @api\n */\nIcon.prototype.load = function() {\n  this.iconImage_.load();\n};\n\n\n/**\n * @override\n */\nIcon.prototype.unlistenImageChange = function(listener, thisArg) {\n  unlisten(this.iconImage_, EventType.CHANGE,\n    listener, thisArg);\n};\nexport default Icon;\n","/**\n * @module ol/style/IconAnchorUnits\n */\n\n/**\n * Icon anchor units. One of 'fraction', 'pixels'.\n * @enum {string}\n */\nexport default {\n  FRACTION: 'fraction',\n  PIXELS: 'pixels'\n};\n","/**\n * @module ol/style/IconImage\n */\nimport {inherits} from '../index.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {listenOnce, unlistenByKey} from '../events.js';\nimport EventTarget from '../events/EventTarget.js';\nimport EventType from '../events/EventType.js';\nimport ImageState from '../ImageState.js';\nimport {shared as iconImageCache} from '../style/IconImageCache.js';\n\n/**\n * @constructor\n * @param {Image|HTMLCanvasElement} image Image.\n * @param {string|undefined} src Src.\n * @param {module:ol/size~Size} size Size.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/ImageState} imageState Image state.\n * @param {module:ol/color~Color} color Color.\n * @extends {module:ol/events/EventTarget}\n */\nconst IconImage = function(image, src, size, crossOrigin, imageState, color) {\n\n  EventTarget.call(this);\n\n  /**\n   * @private\n   * @type {Image|HTMLCanvasElement}\n   */\n  this.hitDetectionImage_ = null;\n\n  /**\n   * @private\n   * @type {Image|HTMLCanvasElement}\n   */\n  this.image_ = !image ? new Image() : image;\n\n  if (crossOrigin !== null) {\n    this.image_.crossOrigin = crossOrigin;\n  }\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = color ?\n    /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS')) :\n    null;\n\n  /**\n   * @private\n   * @type {module:ol/color~Color}\n   */\n  this.color_ = color;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.imageListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/ImageState}\n   */\n  this.imageState_ = imageState;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.size_ = size;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.src_ = src;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.tainting_ = false;\n  if (this.imageState_ == ImageState.LOADED) {\n    this.determineTainting_();\n  }\n\n};\n\ninherits(IconImage, EventTarget);\n\n\n/**\n * @param {Image|HTMLCanvasElement} image Image.\n * @param {string} src Src.\n * @param {module:ol/size~Size} size Size.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/ImageState} imageState Image state.\n * @param {module:ol/color~Color} color Color.\n * @return {module:ol/style/IconImage} Icon image.\n */\nexport function get(image, src, size, crossOrigin, imageState, color) {\n  let iconImage = iconImageCache.get(src, crossOrigin, color);\n  if (!iconImage) {\n    iconImage = new IconImage(image, src, size, crossOrigin, imageState, color);\n    iconImageCache.set(src, crossOrigin, color, iconImage);\n  }\n  return iconImage;\n}\n\n\n/**\n * @private\n */\nIconImage.prototype.determineTainting_ = function() {\n  const context = createCanvasContext2D(1, 1);\n  try {\n    context.drawImage(this.image_, 0, 0);\n    context.getImageData(0, 0, 1, 1);\n  } catch (e) {\n    this.tainting_ = true;\n  }\n};\n\n\n/**\n * @private\n */\nIconImage.prototype.dispatchChangeEvent_ = function() {\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * @private\n */\nIconImage.prototype.handleImageError_ = function() {\n  this.imageState_ = ImageState.ERROR;\n  this.unlistenImage_();\n  this.dispatchChangeEvent_();\n};\n\n\n/**\n * @private\n */\nIconImage.prototype.handleImageLoad_ = function() {\n  this.imageState_ = ImageState.LOADED;\n  if (this.size_) {\n    this.image_.width = this.size_[0];\n    this.image_.height = this.size_[1];\n  }\n  this.size_ = [this.image_.width, this.image_.height];\n  this.unlistenImage_();\n  this.determineTainting_();\n  this.replaceColor_();\n  this.dispatchChangeEvent_();\n};\n\n\n/**\n * @param {number} pixelRatio Pixel ratio.\n * @return {Image|HTMLCanvasElement} Image or Canvas element.\n */\nIconImage.prototype.getImage = function(pixelRatio) {\n  return this.canvas_ ? this.canvas_ : this.image_;\n};\n\n\n/**\n * @return {module:ol/ImageState} Image state.\n */\nIconImage.prototype.getImageState = function() {\n  return this.imageState_;\n};\n\n\n/**\n * @param {number} pixelRatio Pixel ratio.\n * @return {Image|HTMLCanvasElement} Image element.\n */\nIconImage.prototype.getHitDetectionImage = function(pixelRatio) {\n  if (!this.hitDetectionImage_) {\n    if (this.tainting_) {\n      const width = this.size_[0];\n      const height = this.size_[1];\n      const context = createCanvasContext2D(width, height);\n      context.fillRect(0, 0, width, height);\n      this.hitDetectionImage_ = context.canvas;\n    } else {\n      this.hitDetectionImage_ = this.image_;\n    }\n  }\n  return this.hitDetectionImage_;\n};\n\n\n/**\n * @return {module:ol/size~Size} Image size.\n */\nIconImage.prototype.getSize = function() {\n  return this.size_;\n};\n\n\n/**\n * @return {string|undefined} Image src.\n */\nIconImage.prototype.getSrc = function() {\n  return this.src_;\n};\n\n\n/**\n * Load not yet loaded URI.\n */\nIconImage.prototype.load = function() {\n  if (this.imageState_ == ImageState.IDLE) {\n    this.imageState_ = ImageState.LOADING;\n    this.imageListenerKeys_ = [\n      listenOnce(this.image_, EventType.ERROR,\n        this.handleImageError_, this),\n      listenOnce(this.image_, EventType.LOAD,\n        this.handleImageLoad_, this)\n    ];\n    try {\n      this.image_.src = this.src_;\n    } catch (e) {\n      this.handleImageError_();\n    }\n  }\n};\n\n\n/**\n * @private\n */\nIconImage.prototype.replaceColor_ = function() {\n  if (this.tainting_ || this.color_ === null) {\n    return;\n  }\n\n  this.canvas_.width = this.image_.width;\n  this.canvas_.height = this.image_.height;\n\n  const ctx = this.canvas_.getContext('2d');\n  ctx.drawImage(this.image_, 0, 0);\n\n  const imgData = ctx.getImageData(0, 0, this.image_.width, this.image_.height);\n  const data = imgData.data;\n  const r = this.color_[0] / 255.0;\n  const g = this.color_[1] / 255.0;\n  const b = this.color_[2] / 255.0;\n\n  for (let i = 0, ii = data.length; i < ii; i += 4) {\n    data[i] *= r;\n    data[i + 1] *= g;\n    data[i + 2] *= b;\n  }\n  ctx.putImageData(imgData, 0, 0);\n};\n\n\n/**\n * Discards event handlers which listen for load completion or errors.\n *\n * @private\n */\nIconImage.prototype.unlistenImage_ = function() {\n  this.imageListenerKeys_.forEach(unlistenByKey);\n  this.imageListenerKeys_ = null;\n};\nexport default IconImage;\n","/**\n * @module ol/style/IconImageCache\n */\nimport {asString} from '../color.js';\n\n/**\n * Singleton class. Available through {@link module:ol/style/IconImageCache~shared}.\n * @constructor\n */\nconst IconImageCache = function() {\n\n  /**\n   * @type {!Object.<string, module:ol/style/IconImage>}\n   * @private\n   */\n  this.cache_ = {};\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.cacheSize_ = 0;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxCacheSize_ = 32;\n};\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/color~Color} color Color.\n * @return {string} Cache key.\n */\nfunction getKey(src, crossOrigin, color) {\n  const colorString = color ? asString(color) : 'null';\n  return crossOrigin + ':' + src + ':' + colorString;\n}\n\n\n/**\n * FIXME empty description for jsdoc\n */\nIconImageCache.prototype.clear = function() {\n  this.cache_ = {};\n  this.cacheSize_ = 0;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nIconImageCache.prototype.expire = function() {\n  if (this.cacheSize_ > this.maxCacheSize_) {\n    let i = 0;\n    for (const key in this.cache_) {\n      const iconImage = this.cache_[key];\n      if ((i++ & 3) === 0 && !iconImage.hasListener()) {\n        delete this.cache_[key];\n        --this.cacheSize_;\n      }\n    }\n  }\n};\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/color~Color} color Color.\n * @return {module:ol/style/IconImage} Icon image.\n */\nIconImageCache.prototype.get = function(src, crossOrigin, color) {\n  const key = getKey(src, crossOrigin, color);\n  return key in this.cache_ ? this.cache_[key] : null;\n};\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/color~Color} color Color.\n * @param {module:ol/style/IconImage} iconImage Icon image.\n */\nIconImageCache.prototype.set = function(src, crossOrigin, color, iconImage) {\n  const key = getKey(src, crossOrigin, color);\n  this.cache_[key] = iconImage;\n  ++this.cacheSize_;\n};\n\n\n/**\n * Set the cache size of the icon cache. Default is `32`. Change this value when\n * your map uses more than 32 different icon images and you are not caching icon\n * styles on the application level.\n * @param {number} maxCacheSize Cache max size.\n * @api\n */\nIconImageCache.prototype.setSize = function(maxCacheSize) {\n  this.maxCacheSize_ = maxCacheSize;\n  this.expire();\n};\nexport default IconImageCache;\n\n\n/**\n * The {@link module:ol/style/IconImageCache~IconImageCache} for\n * {@link module:ol/style/Icon~Icon} images.\n * @api\n */\nexport const shared = new IconImageCache();\n","/**\n * @module ol/style/IconOrigin\n */\n\n/**\n * Icon origin. One of 'bottom-left', 'bottom-right', 'top-left', 'top-right'.\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_RIGHT: 'bottom-right',\n  TOP_LEFT: 'top-left',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/style/Image\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {number} opacity\n * @property {boolean} rotateWithView\n * @property {number} rotation\n * @property {number} scale\n * @property {boolean} snapToPixel\n */\n\n\n/**\n * @classdesc\n * A base class used for creating subclasses and not instantiated in\n * apps. Base class for {@link module:ol/style/Icon~Icon}, {@link module:ol/style/Circle~CircleStyle} and\n * {@link module:ol/style/RegularShape~RegularShape}.\n *\n * @constructor\n * @abstract\n * @param {module:ol/style/Image~Options} options Options.\n * @api\n */\nconst ImageStyle = function(options) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.opacity_ = options.opacity;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.rotateWithView_ = options.rotateWithView;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.rotation_ = options.rotation;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.scale_ = options.scale;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.snapToPixel_ = options.snapToPixel;\n\n};\n\n\n/**\n * Get the symbolizer opacity.\n * @return {number} Opacity.\n * @api\n */\nImageStyle.prototype.getOpacity = function() {\n  return this.opacity_;\n};\n\n\n/**\n * Determine whether the symbolizer rotates with the map.\n * @return {boolean} Rotate with map.\n * @api\n */\nImageStyle.prototype.getRotateWithView = function() {\n  return this.rotateWithView_;\n};\n\n\n/**\n * Get the symoblizer rotation.\n * @return {number} Rotation.\n * @api\n */\nImageStyle.prototype.getRotation = function() {\n  return this.rotation_;\n};\n\n\n/**\n * Get the symbolizer scale.\n * @return {number} Scale.\n * @api\n */\nImageStyle.prototype.getScale = function() {\n  return this.scale_;\n};\n\n\n/**\n * Determine whether the symbolizer should be snapped to a pixel.\n * @return {boolean} The symbolizer should snap to a pixel.\n * @api\n */\nImageStyle.prototype.getSnapToPixel = function() {\n  return this.snapToPixel_;\n};\n\n\n/**\n * Get the anchor point in pixels. The anchor determines the center point for the\n * symbolizer.\n * @abstract\n * @return {Array.<number>} Anchor.\n */\nImageStyle.prototype.getAnchor = function() {};\n\n\n/**\n * Get the image element for the symbolizer.\n * @abstract\n * @param {number} pixelRatio Pixel ratio.\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Image element.\n */\nImageStyle.prototype.getImage = function(pixelRatio) {};\n\n\n/**\n * @abstract\n * @param {number} pixelRatio Pixel ratio.\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Image element.\n */\nImageStyle.prototype.getHitDetectionImage = function(pixelRatio) {};\n\n\n/**\n * @abstract\n * @return {module:ol/ImageState} Image state.\n */\nImageStyle.prototype.getImageState = function() {};\n\n\n/**\n * @abstract\n * @return {module:ol/size~Size} Image size.\n */\nImageStyle.prototype.getImageSize = function() {};\n\n\n/**\n * @abstract\n * @return {module:ol/size~Size} Size of the hit-detection image.\n */\nImageStyle.prototype.getHitDetectionImageSize = function() {};\n\n\n/**\n * Get the origin of the symbolizer.\n * @abstract\n * @return {Array.<number>} Origin.\n */\nImageStyle.prototype.getOrigin = function() {};\n\n\n/**\n * Get the size of the symbolizer (in pixels).\n * @abstract\n * @return {module:ol/size~Size} Size.\n */\nImageStyle.prototype.getSize = function() {};\n\n\n/**\n * Set the opacity.\n *\n * @param {number} opacity Opacity.\n * @api\n */\nImageStyle.prototype.setOpacity = function(opacity) {\n  this.opacity_ = opacity;\n};\n\n\n/**\n * Set whether to rotate the style with the view.\n *\n * @param {boolean} rotateWithView Rotate with map.\n * @api\n */\nImageStyle.prototype.setRotateWithView = function(rotateWithView) {\n  this.rotateWithView_ = rotateWithView;\n};\n\n\n/**\n * Set the rotation.\n *\n * @param {number} rotation Rotation.\n * @api\n */\nImageStyle.prototype.setRotation = function(rotation) {\n  this.rotation_ = rotation;\n};\n\n\n/**\n * Set the scale.\n *\n * @param {number} scale Scale.\n * @api\n */\nImageStyle.prototype.setScale = function(scale) {\n  this.scale_ = scale;\n};\n\n\n/**\n * Set whether to snap the image to the closest pixel.\n *\n * @param {boolean} snapToPixel Snap to pixel?\n * @api\n */\nImageStyle.prototype.setSnapToPixel = function(snapToPixel) {\n  this.snapToPixel_ = snapToPixel;\n};\n\n\n/**\n * @abstract\n * @param {function(this: T, module:ol/events/Event)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @return {module:ol/events~EventsKey|undefined} Listener key.\n * @template T\n */\nImageStyle.prototype.listenImageChange = function(listener, thisArg) {};\n\n\n/**\n * Load not yet loaded URI.\n * @abstract\n */\nImageStyle.prototype.load = function() {};\n\n\n/**\n * @abstract\n * @param {function(this: T, module:ol/events/Event)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @template T\n */\nImageStyle.prototype.unlistenImageChange = function(listener, thisArg) {};\nexport default ImageStyle;\n","/**\n * @module ol/style/RegularShape\n */\nimport {inherits} from '../index.js';\nimport {asColorLike} from '../colorlike.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {CANVAS_LINE_DASH} from '../has.js';\nimport ImageState from '../ImageState.js';\nimport {defaultStrokeStyle, defaultFillStyle, defaultLineCap, defaultLineWidth, defaultLineJoin, defaultMiterLimit} from '../render/canvas.js';\nimport ImageStyle from '../style/Image.js';\n\n\n/**\n * Specify radius for regular polygons, or radius1 and radius2 for stars.\n * @typedef {Object} Options\n * @property {module:ol/style/Fill} [fill] Fill style.\n * @property {number} points Number of points for stars and regular polygons. In case of a polygon, the number of points\n * is the number of sides.\n * @property {number} [radius] Radius of a regular polygon.\n * @property {number} [radius1] Outer radius of a star.\n * @property {number} [radius2] Inner radius of a star.\n * @property {number} [angle=0] Shape's angle in radians. A value of 0 will have one of the shape's point facing up.\n * @property {boolean} [snapToPixel=true] If `true` integral numbers of pixels are used as the X and Y pixel coordinate\n * when drawing the shape in the output canvas. If `false` fractional numbers may be used. Using `true` allows for\n * \"sharp\" rendering (no blur), while using `false` allows for \"accurate\" rendering. Note that accuracy is important if\n * the shape's position is animated. Without it, the shape may jitter noticeably.\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {boolean} [rotateWithView=false] Whether to rotate the shape with the view.\n * @property {module:ol/style/AtlasManager} [atlasManager] The atlas manager to use for this symbol. When\n * using WebGL it is recommended to use an atlas manager to avoid texture switching. If an atlas manager is given, the\n * symbol is added to an atlas. By default no atlas manager is used.\n */\n\n\n/**\n * @typedef {Object} RenderOptions\n * @property {module:ol/colorlike~ColorLike} [strokeStyle]\n * @property {number} strokeWidth\n * @property {number} size\n * @property {string} lineCap\n * @property {Array.<number>} lineDash\n * @property {number} lineDashOffset\n * @property {string} lineJoin\n * @property {number} miterLimit\n */\n\n\n/**\n * @classdesc\n * Set regular shape style for vector features. The resulting shape will be\n * a regular polygon when `radius` is provided, or a star when `radius1` and\n * `radius2` are provided.\n *\n * @constructor\n * @param {module:ol/style/RegularShape~Options} options Options.\n * @extends {module:ol/style/Image}\n * @api\n */\nconst RegularShape = function(options) {\n  /**\n   * @private\n   * @type {Array.<string>}\n   */\n  this.checksums_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.hitDetectionCanvas_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.origin_ = [0, 0];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.points_ = options.points;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.radius_ = /** @type {number} */ (options.radius !== undefined ?\n    options.radius : options.radius1);\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.radius2_ = options.radius2;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.angle_ = options.angle !== undefined ? options.angle : 0;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.anchor_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.size_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.imageSize_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.hitDetectionImageSize_ = null;\n\n  /**\n   * @protected\n   * @type {module:ol/style/AtlasManager|undefined}\n   */\n  this.atlasManager_ = options.atlasManager;\n\n  this.render_(this.atlasManager_);\n\n  /**\n   * @type {boolean}\n   */\n  const snapToPixel = options.snapToPixel !== undefined ?\n    options.snapToPixel : true;\n\n  /**\n   * @type {boolean}\n   */\n  const rotateWithView = options.rotateWithView !== undefined ?\n    options.rotateWithView : false;\n\n  ImageStyle.call(this, {\n    opacity: 1,\n    rotateWithView: rotateWithView,\n    rotation: options.rotation !== undefined ? options.rotation : 0,\n    scale: 1,\n    snapToPixel: snapToPixel\n  });\n};\n\ninherits(RegularShape, ImageStyle);\n\n\n/**\n * Clones the style. If an atlasmanager was provided to the original style it will be used in the cloned style, too.\n * @return {module:ol/style/RegularShape} The cloned style.\n * @api\n */\nRegularShape.prototype.clone = function() {\n  const style = new RegularShape({\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    points: this.getPoints(),\n    radius: this.getRadius(),\n    radius2: this.getRadius2(),\n    angle: this.getAngle(),\n    snapToPixel: this.getSnapToPixel(),\n    stroke: this.getStroke() ?  this.getStroke().clone() : undefined,\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView(),\n    atlasManager: this.atlasManager_\n  });\n  style.setOpacity(this.getOpacity());\n  style.setScale(this.getScale());\n  return style;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getAnchor = function() {\n  return this.anchor_;\n};\n\n\n/**\n * Get the angle used in generating the shape.\n * @return {number} Shape's rotation in radians.\n * @api\n */\nRegularShape.prototype.getAngle = function() {\n  return this.angle_;\n};\n\n\n/**\n * Get the fill style for the shape.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nRegularShape.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getHitDetectionImage = function(pixelRatio) {\n  return this.hitDetectionCanvas_;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getImage = function(pixelRatio) {\n  return this.canvas_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getImageSize = function() {\n  return this.imageSize_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getHitDetectionImageSize = function() {\n  return this.hitDetectionImageSize_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getImageState = function() {\n  return ImageState.LOADED;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getOrigin = function() {\n  return this.origin_;\n};\n\n\n/**\n * Get the number of points for generating the shape.\n * @return {number} Number of points for stars and regular polygons.\n * @api\n */\nRegularShape.prototype.getPoints = function() {\n  return this.points_;\n};\n\n\n/**\n * Get the (primary) radius for the shape.\n * @return {number} Radius.\n * @api\n */\nRegularShape.prototype.getRadius = function() {\n  return this.radius_;\n};\n\n\n/**\n * Get the secondary radius for the shape.\n * @return {number|undefined} Radius2.\n * @api\n */\nRegularShape.prototype.getRadius2 = function() {\n  return this.radius2_;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getSize = function() {\n  return this.size_;\n};\n\n\n/**\n * Get the stroke style for the shape.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nRegularShape.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.listenImageChange = function(listener, thisArg) {};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.load = function() {};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.unlistenImageChange = function(listener, thisArg) {};\n\n\n/**\n * @protected\n * @param {module:ol/style/AtlasManager|undefined} atlasManager An atlas manager.\n */\nRegularShape.prototype.render_ = function(atlasManager) {\n  let imageSize;\n  let lineCap = '';\n  let lineJoin = '';\n  let miterLimit = 0;\n  let lineDash = null;\n  let lineDashOffset = 0;\n  let strokeStyle;\n  let strokeWidth = 0;\n\n  if (this.stroke_) {\n    strokeStyle = this.stroke_.getColor();\n    if (strokeStyle === null) {\n      strokeStyle = defaultStrokeStyle;\n    }\n    strokeStyle = asColorLike(strokeStyle);\n    strokeWidth = this.stroke_.getWidth();\n    if (strokeWidth === undefined) {\n      strokeWidth = defaultLineWidth;\n    }\n    lineDash = this.stroke_.getLineDash();\n    lineDashOffset = this.stroke_.getLineDashOffset();\n    if (!CANVAS_LINE_DASH) {\n      lineDash = null;\n      lineDashOffset = 0;\n    }\n    lineJoin = this.stroke_.getLineJoin();\n    if (lineJoin === undefined) {\n      lineJoin = defaultLineJoin;\n    }\n    lineCap = this.stroke_.getLineCap();\n    if (lineCap === undefined) {\n      lineCap = defaultLineCap;\n    }\n    miterLimit = this.stroke_.getMiterLimit();\n    if (miterLimit === undefined) {\n      miterLimit = defaultMiterLimit;\n    }\n  }\n\n  let size = 2 * (this.radius_ + strokeWidth) + 1;\n\n  /** @type {module:ol/style/RegularShape~RenderOptions} */\n  const renderOptions = {\n    strokeStyle: strokeStyle,\n    strokeWidth: strokeWidth,\n    size: size,\n    lineCap: lineCap,\n    lineDash: lineDash,\n    lineDashOffset: lineDashOffset,\n    lineJoin: lineJoin,\n    miterLimit: miterLimit\n  };\n\n  if (atlasManager === undefined) {\n    // no atlas manager is used, create a new canvas\n    const context = createCanvasContext2D(size, size);\n    this.canvas_ = context.canvas;\n\n    // canvas.width and height are rounded to the closest integer\n    size = this.canvas_.width;\n    imageSize = size;\n\n    this.draw_(renderOptions, context, 0, 0);\n\n    this.createHitDetectionCanvas_(renderOptions);\n  } else {\n    // an atlas manager is used, add the symbol to an atlas\n    size = Math.round(size);\n\n    const hasCustomHitDetectionImage = !this.fill_;\n    let renderHitDetectionCallback;\n    if (hasCustomHitDetectionImage) {\n      // render the hit-detection image into a separate atlas image\n      renderHitDetectionCallback =\n          this.drawHitDetectionCanvas_.bind(this, renderOptions);\n    }\n\n    const id = this.getChecksum();\n    const info = atlasManager.add(\n      id, size, size, this.draw_.bind(this, renderOptions),\n      renderHitDetectionCallback);\n\n    this.canvas_ = info.image;\n    this.origin_ = [info.offsetX, info.offsetY];\n    imageSize = info.image.width;\n\n    if (hasCustomHitDetectionImage) {\n      this.hitDetectionCanvas_ = info.hitImage;\n      this.hitDetectionImageSize_ =\n          [info.hitImage.width, info.hitImage.height];\n    } else {\n      this.hitDetectionCanvas_ = this.canvas_;\n      this.hitDetectionImageSize_ = [imageSize, imageSize];\n    }\n  }\n\n  this.anchor_ = [size / 2, size / 2];\n  this.size_ = [size, size];\n  this.imageSize_ = [imageSize, imageSize];\n};\n\n\n/**\n * @private\n * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\n * @param {CanvasRenderingContext2D} context The rendering context.\n * @param {number} x The origin for the symbol (x).\n * @param {number} y The origin for the symbol (y).\n */\nRegularShape.prototype.draw_ = function(renderOptions, context, x, y) {\n  let i, angle0, radiusC;\n  // reset transform\n  context.setTransform(1, 0, 0, 1, 0, 0);\n\n  // then move to (x, y)\n  context.translate(x, y);\n\n  context.beginPath();\n\n  let points = this.points_;\n  if (points === Infinity) {\n    context.arc(\n      renderOptions.size / 2, renderOptions.size / 2,\n      this.radius_, 0, 2 * Math.PI, true);\n  } else {\n    const radius2 = (this.radius2_ !== undefined) ? this.radius2_\n      : this.radius_;\n    if (radius2 !== this.radius_) {\n      points = 2 * points;\n    }\n    for (i = 0; i <= points; i++) {\n      angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\n      radiusC = i % 2 === 0 ? this.radius_ : radius2;\n      context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\n        renderOptions.size / 2 + radiusC * Math.sin(angle0));\n    }\n  }\n\n\n  if (this.fill_) {\n    let color = this.fill_.getColor();\n    if (color === null) {\n      color = defaultFillStyle;\n    }\n    context.fillStyle = asColorLike(color);\n    context.fill();\n  }\n  if (this.stroke_) {\n    context.strokeStyle = renderOptions.strokeStyle;\n    context.lineWidth = renderOptions.strokeWidth;\n    if (renderOptions.lineDash) {\n      context.setLineDash(renderOptions.lineDash);\n      context.lineDashOffset = renderOptions.lineDashOffset;\n    }\n    context.lineCap = renderOptions.lineCap;\n    context.lineJoin = renderOptions.lineJoin;\n    context.miterLimit = renderOptions.miterLimit;\n    context.stroke();\n  }\n  context.closePath();\n};\n\n\n/**\n * @private\n * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\n */\nRegularShape.prototype.createHitDetectionCanvas_ = function(renderOptions) {\n  this.hitDetectionImageSize_ = [renderOptions.size, renderOptions.size];\n  if (this.fill_) {\n    this.hitDetectionCanvas_ = this.canvas_;\n    return;\n  }\n\n  // if no fill style is set, create an extra hit-detection image with a\n  // default fill style\n  const context = createCanvasContext2D(renderOptions.size, renderOptions.size);\n  this.hitDetectionCanvas_ = context.canvas;\n\n  this.drawHitDetectionCanvas_(renderOptions, context, 0, 0);\n};\n\n\n/**\n * @private\n * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\n * @param {CanvasRenderingContext2D} context The context.\n * @param {number} x The origin for the symbol (x).\n * @param {number} y The origin for the symbol (y).\n */\nRegularShape.prototype.drawHitDetectionCanvas_ = function(renderOptions, context, x, y) {\n  // reset transform\n  context.setTransform(1, 0, 0, 1, 0, 0);\n\n  // then move to (x, y)\n  context.translate(x, y);\n\n  context.beginPath();\n\n  let points = this.points_;\n  if (points === Infinity) {\n    context.arc(\n      renderOptions.size / 2, renderOptions.size / 2,\n      this.radius_, 0, 2 * Math.PI, true);\n  } else {\n    const radius2 = (this.radius2_ !== undefined) ? this.radius2_\n      : this.radius_;\n    if (radius2 !== this.radius_) {\n      points = 2 * points;\n    }\n    let i, radiusC, angle0;\n    for (i = 0; i <= points; i++) {\n      angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\n      radiusC = i % 2 === 0 ? this.radius_ : radius2;\n      context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\n        renderOptions.size / 2 + radiusC * Math.sin(angle0));\n    }\n  }\n\n  context.fillStyle = defaultFillStyle;\n  context.fill();\n  if (this.stroke_) {\n    context.strokeStyle = renderOptions.strokeStyle;\n    context.lineWidth = renderOptions.strokeWidth;\n    if (renderOptions.lineDash) {\n      context.setLineDash(renderOptions.lineDash);\n      context.lineDashOffset = renderOptions.lineDashOffset;\n    }\n    context.stroke();\n  }\n  context.closePath();\n};\n\n\n/**\n * @return {string} The checksum.\n */\nRegularShape.prototype.getChecksum = function() {\n  const strokeChecksum = this.stroke_ ?\n    this.stroke_.getChecksum() : '-';\n  const fillChecksum = this.fill_ ?\n    this.fill_.getChecksum() : '-';\n\n  const recalculate = !this.checksums_ ||\n      (strokeChecksum != this.checksums_[1] ||\n      fillChecksum != this.checksums_[2] ||\n      this.radius_ != this.checksums_[3] ||\n      this.radius2_ != this.checksums_[4] ||\n      this.angle_ != this.checksums_[5] ||\n      this.points_ != this.checksums_[6]);\n\n  if (recalculate) {\n    const checksum = 'r' + strokeChecksum + fillChecksum +\n        (this.radius_ !== undefined ? this.radius_.toString() : '-') +\n        (this.radius2_ !== undefined ? this.radius2_.toString() : '-') +\n        (this.angle_ !== undefined ? this.angle_.toString() : '-') +\n        (this.points_ !== undefined ? this.points_.toString() : '-');\n    this.checksums_ = [checksum, strokeChecksum, fillChecksum,\n      this.radius_, this.radius2_, this.angle_, this.points_];\n  }\n\n  return this.checksums_[0];\n};\nexport default RegularShape;\n","/**\n * @module ol/style/Stroke\n */\nimport {getUid} from '../index.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/color~Color|module:ol/colorlike~ColorLike} [color] A color, gradient or pattern.\n * See {@link module:ol/color~Color} and {@link module:ol/colorlike~ColorLike} for possible formats.\n * Default null; if null, the Canvas/renderer default black will be used.\n * @property {string} [lineCap='round'] Line cap style: `butt`, `round`, or `square`.\n * @property {string} [lineJoin='round'] Line join style: `bevel`, `round`, or `miter`.\n * @property {Array.<number>} [lineDash] Line dash pattern. Default is `undefined` (no dash).\n * Please note that Internet Explorer 10 and lower do not support the `setLineDash` method on\n * the `CanvasRenderingContext2D` and therefore this option will have no visual effect in these browsers.\n * @property {number} [lineDashOffset=0] Line dash offset.\n * @property {number} [miterLimit=10] Miter limit.\n * @property {number} [width] Width.\n */\n\n\n/**\n * @classdesc\n * Set stroke style for vector features.\n * Note that the defaults given are the Canvas defaults, which will be used if\n * option is not defined. The `get` functions return whatever was entered in\n * the options; they will not return the default.\n *\n * @constructor\n * @param {module:ol/style/Stroke~Options=} opt_options Options.\n * @api\n */\nconst Stroke = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {module:ol/color~Color|module:ol/colorlike~ColorLike}\n   */\n  this.color_ = options.color !== undefined ? options.color : null;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.lineCap_ = options.lineCap;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.lineDash_ = options.lineDash !== undefined ? options.lineDash : null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lineDashOffset_ = options.lineDashOffset;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.lineJoin_ = options.lineJoin;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.miterLimit_ = options.miterLimit;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.width_ = options.width;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Clones the style.\n * @return {module:ol/style/Stroke} The cloned style.\n * @api\n */\nStroke.prototype.clone = function() {\n  const color = this.getColor();\n  return new Stroke({\n    color: (color && color.slice) ? color.slice() : color || undefined,\n    lineCap: this.getLineCap(),\n    lineDash: this.getLineDash() ? this.getLineDash().slice() : undefined,\n    lineDashOffset: this.getLineDashOffset(),\n    lineJoin: this.getLineJoin(),\n    miterLimit: this.getMiterLimit(),\n    width: this.getWidth()\n  });\n};\n\n\n/**\n * Get the stroke color.\n * @return {module:ol/color~Color|module:ol/colorlike~ColorLike} Color.\n * @api\n */\nStroke.prototype.getColor = function() {\n  return this.color_;\n};\n\n\n/**\n * Get the line cap type for the stroke.\n * @return {string|undefined} Line cap.\n * @api\n */\nStroke.prototype.getLineCap = function() {\n  return this.lineCap_;\n};\n\n\n/**\n * Get the line dash style for the stroke.\n * @return {Array.<number>} Line dash.\n * @api\n */\nStroke.prototype.getLineDash = function() {\n  return this.lineDash_;\n};\n\n\n/**\n * Get the line dash offset for the stroke.\n * @return {number|undefined} Line dash offset.\n * @api\n */\nStroke.prototype.getLineDashOffset = function() {\n  return this.lineDashOffset_;\n};\n\n\n/**\n * Get the line join type for the stroke.\n * @return {string|undefined} Line join.\n * @api\n */\nStroke.prototype.getLineJoin = function() {\n  return this.lineJoin_;\n};\n\n\n/**\n * Get the miter limit for the stroke.\n * @return {number|undefined} Miter limit.\n * @api\n */\nStroke.prototype.getMiterLimit = function() {\n  return this.miterLimit_;\n};\n\n\n/**\n * Get the stroke width.\n * @return {number|undefined} Width.\n * @api\n */\nStroke.prototype.getWidth = function() {\n  return this.width_;\n};\n\n\n/**\n * Set the color.\n *\n * @param {module:ol/color~Color|module:ol/colorlike~ColorLike} color Color.\n * @api\n */\nStroke.prototype.setColor = function(color) {\n  this.color_ = color;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line cap.\n *\n * @param {string|undefined} lineCap Line cap.\n * @api\n */\nStroke.prototype.setLineCap = function(lineCap) {\n  this.lineCap_ = lineCap;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line dash.\n *\n * Please note that Internet Explorer 10 and lower [do not support][mdn] the\n * `setLineDash` method on the `CanvasRenderingContext2D` and therefore this\n * property will have no visual effect in these browsers.\n *\n * [mdn]: https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Browser_compatibility\n *\n * @param {Array.<number>} lineDash Line dash.\n * @api\n */\nStroke.prototype.setLineDash = function(lineDash) {\n  this.lineDash_ = lineDash;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line dash offset.\n *\n * @param {number|undefined} lineDashOffset Line dash offset.\n * @api\n */\nStroke.prototype.setLineDashOffset = function(lineDashOffset) {\n  this.lineDashOffset_ = lineDashOffset;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line join.\n *\n * @param {string|undefined} lineJoin Line join.\n * @api\n */\nStroke.prototype.setLineJoin = function(lineJoin) {\n  this.lineJoin_ = lineJoin;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the miter limit.\n *\n * @param {number|undefined} miterLimit Miter limit.\n * @api\n */\nStroke.prototype.setMiterLimit = function(miterLimit) {\n  this.miterLimit_ = miterLimit;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the width.\n *\n * @param {number|undefined} width Width.\n * @api\n */\nStroke.prototype.setWidth = function(width) {\n  this.width_ = width;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * @return {string} The checksum.\n */\nStroke.prototype.getChecksum = function() {\n  if (this.checksum_ === undefined) {\n    this.checksum_ = 's';\n    if (this.color_) {\n      if (typeof this.color_ === 'string') {\n        this.checksum_ += this.color_;\n      } else {\n        this.checksum_ += getUid(this.color_).toString();\n      }\n    } else {\n      this.checksum_ += '-';\n    }\n    this.checksum_ += ',' +\n        (this.lineCap_ !== undefined ?\n          this.lineCap_.toString() : '-') + ',' +\n        (this.lineDash_ ?\n          this.lineDash_.toString() : '-') + ',' +\n        (this.lineDashOffset_ !== undefined ?\n          this.lineDashOffset_ : '-') + ',' +\n        (this.lineJoin_ !== undefined ?\n          this.lineJoin_ : '-') + ',' +\n        (this.miterLimit_ !== undefined ?\n          this.miterLimit_.toString() : '-') + ',' +\n        (this.width_ !== undefined ?\n          this.width_.toString() : '-');\n  }\n\n  return this.checksum_;\n};\nexport default Stroke;\n","/**\n * @module ol/style/Style\n */\n\n/**\n * Feature styles.\n *\n * If no style is defined, the following default style is used:\n * ```js\n *  import {Fill, Stroke, Cirle, Style} from 'ol/style';\n *\n *  var fill = new Fill({\n *    color: 'rgba(255,255,255,0.4)'\n *  });\n *  var stroke = new Stroke({\n *    color: '#3399CC',\n *    width: 1.25\n *  });\n *  var styles = [\n *    new Style({\n *      image: new Circle({\n *        fill: fill,\n *        stroke: stroke,\n *        radius: 5\n *      }),\n *      fill: fill,\n *      stroke: stroke\n *    })\n *  ];\n * ```\n *\n * A separate editing style has the following defaults:\n * ```js\n *  import {Fill, Stroke, Cirle, Style} from 'ol/style';\n *  import GeometryType from 'ol/geom/GeometryType';\n *\n *  var white = [255, 255, 255, 1];\n *  var blue = [0, 153, 255, 1];\n *  var width = 3;\n *  styles[GeometryType.POLYGON] = [\n *    new Style({\n *      fill: new Fill({\n *        color: [255, 255, 255, 0.5]\n *      })\n *    })\n *  ];\n *  styles[GeometryType.MULTI_POLYGON] =\n *      styles[GeometryType.POLYGON];\n *  styles[GeometryType.LINE_STRING] = [\n *    new Style({\n *      stroke: new Stroke({\n *        color: white,\n *        width: width + 2\n *      })\n *    }),\n *    new Style({\n *      stroke: new Stroke({\n *        color: blue,\n *        width: width\n *      })\n *    })\n *  ];\n *  styles[GeometryType.MULTI_LINE_STRING] =\n *      styles[GeometryType.LINE_STRING];\n *  styles[GeometryType.POINT] = [\n *    new Style({\n *      image: new Circle({\n *        radius: width * 2,\n *        fill: new Fill({\n *          color: blue\n *        }),\n *        stroke: new Stroke({\n *          color: white,\n *          width: width / 2\n *        })\n *      }),\n *      zIndex: Infinity\n *    })\n *  ];\n *  styles[GeometryType.MULTI_POINT] =\n *      styles[GeometryType.POINT];\n *  styles[GEOMETRY_COLLECTION] =\n *      styles[GeometryType.POLYGON].concat(\n *          styles[GeometryType.POINT]\n *      );\n * ```\n */\nimport {assert} from '../asserts.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport CircleStyle from '../style/Circle.js';\nimport Fill from '../style/Fill.js';\nimport Stroke from '../style/Stroke.js';\n\n\n/**\n * A function that takes an {@link module:ol/Feature} and a `{number}`\n * representing the view's resolution. The function should return a\n * {@link module:ol/style/Style} or an array of them. This way e.g. a\n * vector layer can be styled.\n *\n * @typedef {function((module:ol/Feature|module:ol/render/Feature), number):\n *     (module:ol/style/Style|Array.<module:ol/style/Style>)} StyleFunction\n */\n\n\n/**\n * A function that takes an {@link module:ol/Feature} as argument and returns an\n * {@link module:ol/geom/Geometry} that will be rendered and styled for the feature.\n *\n * @typedef {function((module:ol/Feature|module:ol/render/Feature)):\n *     (module:ol/geom/Geometry|module:ol/render/Feature|undefined)} GeometryFunction\n */\n\n\n/**\n * Custom renderer function. Takes two arguments:\n *\n * 1. The pixel coordinates of the geometry in GeoJSON notation.\n * 2. The {@link module:ol/render~State} of the layer renderer.\n *\n * @typedef {function((module:ol/coordinate~Coordinate|Array<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>),module:ol/render~State)}\n * RenderFunction\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction} [geometry] Feature property or geometry\n * or function returning a geometry to render for this style.\n * @property {module:ol/style/Fill} [fill] Fill style.\n * @property {module:ol/style/Image} [image] Image style.\n * @property {module:ol/style/Style~RenderFunction} [renderer] Custom renderer. When configured, `fill`, `stroke` and `image` will be\n * ignored, and the provided function will be called with each render frame for each geometry.\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {module:ol/style/Text} [text] Text style.\n * @property {number} [zIndex] Z index.\n */\n\n\n/**\n * @classdesc\n * Container for vector feature rendering styles. Any changes made to the style\n * or its children through `set*()` methods will not take effect until the\n * feature or layer that uses the style is re-rendered.\n *\n * @constructor\n * @struct\n * @param {module:ol/style/Style~Options=} opt_options Style options.\n * @api\n */\nconst Style = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction}\n   */\n  this.geometry_ = null;\n\n  /**\n   * @private\n   * @type {!module:ol/style/Style~GeometryFunction}\n   */\n  this.geometryFunction_ = defaultGeometryFunction;\n\n  if (options.geometry !== undefined) {\n    this.setGeometry(options.geometry);\n  }\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill : null;\n\n  /**\n     * @private\n     * @type {module:ol/style/Image}\n     */\n  this.image_ = options.image !== undefined ? options.image : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Style~RenderFunction|null}\n   */\n  this.renderer_ = options.renderer !== undefined ? options.renderer : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Text}\n   */\n  this.text_ = options.text !== undefined ? options.text : null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.zIndex_ = options.zIndex;\n\n};\n\n\n/**\n * Clones the style.\n * @return {module:ol/style/Style} The cloned style.\n * @api\n */\nStyle.prototype.clone = function() {\n  let geometry = this.getGeometry();\n  if (geometry && geometry.clone) {\n    geometry = geometry.clone();\n  }\n  return new Style({\n    geometry: geometry,\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    image: this.getImage() ? this.getImage().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    text: this.getText() ? this.getText().clone() : undefined,\n    zIndex: this.getZIndex()\n  });\n};\n\n\n/**\n * Get the custom renderer function that was configured with\n * {@link #setRenderer} or the `renderer` constructor option.\n * @return {module:ol/style/Style~RenderFunction|null} Custom renderer function.\n * @api\n */\nStyle.prototype.getRenderer = function() {\n  return this.renderer_;\n};\n\n\n/**\n * Sets a custom renderer function for this style. When set, `fill`, `stroke`\n * and `image` options of the style will be ignored.\n * @param {module:ol/style/Style~RenderFunction|null} renderer Custom renderer function.\n * @api\n */\nStyle.prototype.setRenderer = function(renderer) {\n  this.renderer_ = renderer;\n};\n\n\n/**\n * Get the geometry to be rendered.\n * @return {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction}\n * Feature property or geometry or function that returns the geometry that will\n * be rendered with this style.\n * @api\n */\nStyle.prototype.getGeometry = function() {\n  return this.geometry_;\n};\n\n\n/**\n * Get the function used to generate a geometry for rendering.\n * @return {!module:ol/style/Style~GeometryFunction} Function that is called with a feature\n * and returns the geometry to render instead of the feature's geometry.\n * @api\n */\nStyle.prototype.getGeometryFunction = function() {\n  return this.geometryFunction_;\n};\n\n\n/**\n * Get the fill style.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nStyle.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * Set the fill style.\n * @param {module:ol/style/Fill} fill Fill style.\n * @api\n */\nStyle.prototype.setFill = function(fill) {\n  this.fill_ = fill;\n};\n\n\n/**\n * Get the image style.\n * @return {module:ol/style/Image} Image style.\n * @api\n */\nStyle.prototype.getImage = function() {\n  return this.image_;\n};\n\n\n/**\n * Set the image style.\n * @param {module:ol/style/Image} image Image style.\n * @api\n */\nStyle.prototype.setImage = function(image) {\n  this.image_ = image;\n};\n\n\n/**\n * Get the stroke style.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nStyle.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * Set the stroke style.\n * @param {module:ol/style/Stroke} stroke Stroke style.\n * @api\n */\nStyle.prototype.setStroke = function(stroke) {\n  this.stroke_ = stroke;\n};\n\n\n/**\n * Get the text style.\n * @return {module:ol/style/Text} Text style.\n * @api\n */\nStyle.prototype.getText = function() {\n  return this.text_;\n};\n\n\n/**\n * Set the text style.\n * @param {module:ol/style/Text} text Text style.\n * @api\n */\nStyle.prototype.setText = function(text) {\n  this.text_ = text;\n};\n\n\n/**\n * Get the z-index for the style.\n * @return {number|undefined} ZIndex.\n * @api\n */\nStyle.prototype.getZIndex = function() {\n  return this.zIndex_;\n};\n\n\n/**\n * Set a geometry that is rendered instead of the feature's geometry.\n *\n * @param {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction} geometry\n *     Feature property or geometry or function returning a geometry to render\n *     for this style.\n * @api\n */\nStyle.prototype.setGeometry = function(geometry) {\n  if (typeof geometry === 'function') {\n    this.geometryFunction_ = geometry;\n  } else if (typeof geometry === 'string') {\n    this.geometryFunction_ = function(feature) {\n      return (\n        /** @type {module:ol/geom/Geometry} */ (feature.get(geometry))\n      );\n    };\n  } else if (!geometry) {\n    this.geometryFunction_ = defaultGeometryFunction;\n  } else if (geometry !== undefined) {\n    this.geometryFunction_ = function() {\n      return (\n        /** @type {module:ol/geom/Geometry} */ (geometry)\n      );\n    };\n  }\n  this.geometry_ = geometry;\n};\n\n\n/**\n * Set the z-index.\n *\n * @param {number|undefined} zIndex ZIndex.\n * @api\n */\nStyle.prototype.setZIndex = function(zIndex) {\n  this.zIndex_ = zIndex;\n};\n\n\n/**\n * Convert the provided object into a style function.  Functions passed through\n * unchanged.  Arrays of module:ol/style/Style or single style objects wrapped in a\n * new style function.\n * @param {module:ol/style/Style~StyleFunction|Array.<module:ol/style/Style>|module:ol/style/Style} obj\n *     A style function, a single style, or an array of styles.\n * @return {module:ol/style/Style~StyleFunction} A style function.\n */\nexport function toFunction(obj) {\n  let styleFunction;\n\n  if (typeof obj === 'function') {\n    styleFunction = obj;\n  } else {\n    /**\n     * @type {Array.<module:ol/style/Style>}\n     */\n    let styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(obj instanceof Style,\n        41); // Expected an `module:ol/style/Style~Style` or an array of `module:ol/style/Style~Style`\n      styles = [obj];\n    }\n    styleFunction = function() {\n      return styles;\n    };\n  }\n  return styleFunction;\n}\n\n\n/**\n * @type {Array.<module:ol/style/Style>}\n */\nlet defaultStyles = null;\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {number} resolution Resolution.\n * @return {Array.<module:ol/style/Style>} Style.\n */\nexport function createDefaultStyle(feature, resolution) {\n  // We don't use an immediately-invoked function\n  // and a closure so we don't get an error at script evaluation time in\n  // browsers that do not support Canvas. (module:ol/style/Circle~CircleStyle does\n  // canvas.getContext('2d') at construction time, which will cause an.error\n  // in such browsers.)\n  if (!defaultStyles) {\n    const fill = new Fill({\n      color: 'rgba(255,255,255,0.4)'\n    });\n    const stroke = new Stroke({\n      color: '#3399CC',\n      width: 1.25\n    });\n    defaultStyles = [\n      new Style({\n        image: new CircleStyle({\n          fill: fill,\n          stroke: stroke,\n          radius: 5\n        }),\n        fill: fill,\n        stroke: stroke\n      })\n    ];\n  }\n  return defaultStyles;\n}\n\n\n/**\n * Default styles for editing features.\n * @return {Object.<module:ol/geom/GeometryType, Array.<module:ol/style/Style>>} Styles\n */\nexport function createEditingStyle() {\n  /** @type {Object.<module:ol/geom/GeometryType, Array.<module:ol/style/Style>>} */\n  const styles = {};\n  const white = [255, 255, 255, 1];\n  const blue = [0, 153, 255, 1];\n  const width = 3;\n  styles[GeometryType.POLYGON] = [\n    new Style({\n      fill: new Fill({\n        color: [255, 255, 255, 0.5]\n      })\n    })\n  ];\n  styles[GeometryType.MULTI_POLYGON] =\n      styles[GeometryType.POLYGON];\n\n  styles[GeometryType.LINE_STRING] = [\n    new Style({\n      stroke: new Stroke({\n        color: white,\n        width: width + 2\n      })\n    }),\n    new Style({\n      stroke: new Stroke({\n        color: blue,\n        width: width\n      })\n    })\n  ];\n  styles[GeometryType.MULTI_LINE_STRING] =\n      styles[GeometryType.LINE_STRING];\n\n  styles[GeometryType.CIRCLE] =\n      styles[GeometryType.POLYGON].concat(\n        styles[GeometryType.LINE_STRING]\n      );\n\n\n  styles[GeometryType.POINT] = [\n    new Style({\n      image: new CircleStyle({\n        radius: width * 2,\n        fill: new Fill({\n          color: blue\n        }),\n        stroke: new Stroke({\n          color: white,\n          width: width / 2\n        })\n      }),\n      zIndex: Infinity\n    })\n  ];\n  styles[GeometryType.MULTI_POINT] =\n      styles[GeometryType.POINT];\n\n  styles[GeometryType.GEOMETRY_COLLECTION] =\n      styles[GeometryType.POLYGON].concat(\n        styles[GeometryType.LINE_STRING],\n        styles[GeometryType.POINT]\n      );\n\n  return styles;\n}\n\n\n/**\n * Function that is called with a feature and returns its default geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature to get the geometry for.\n * @return {module:ol/geom/Geometry|module:ol/render/Feature|undefined} Geometry to render.\n */\nfunction defaultGeometryFunction(feature) {\n  return feature.getGeometry();\n}\n\nexport default Style;\n","/**\n * @module ol/style/Text\n */\nimport Fill from '../style/Fill.js';\nimport TextPlacement from '../style/TextPlacement.js';\n\n\n/**\n * The default fill color to use if no fill was set at construction time; a\n * blackish `#333`.\n *\n * @const {string}\n */\nconst DEFAULT_FILL_COLOR = '#333';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [font] Font style as CSS 'font' value, see:\n * {@link https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/font}. Default is '10px sans-serif'\n * @property {number} [maxAngle] When `placement` is set to `'line'`, allow a maximum angle between adjacent characters.\n * The expected value is in radians, and the default is 45 (`Math.PI / 4`).\n * @property {number} [offsetX=0] Horizontal text offset in pixels. A positive will shift the text right.\n * @property {number} [offsetY=0] Vertical text offset in pixels. A positive will shift the text down.\n * @property {boolean} [overflow=false] For polygon labels or when `placement` is set to `'line'`, allow text to exceed\n * the width of the polygon at the label position or the length of the path that it follows.\n * @property {module:ol/style/TextPlacement|string} [placement] Text placement.\n * @property {number} [scale] Scale.\n * @property {boolean} [rotateWithView=false] Whether to rotate the text with the view.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {string} [text] Text content.\n * @property {string} [textAlign] Text alignment. Possible values: 'left', 'right', 'center', 'end' or 'start'.\n * Default is 'center' for `placement: 'point'`. For `placement: 'line'`, the default is to let the renderer choose a\n * placement where `maxAngle` is not exceeded.\n * @property {string} [textBaseline='middle'] Text base line. Possible values: 'bottom', 'top', 'middle', 'alphabetic',\n * 'hanging', 'ideographic'.\n * @property {module:ol/style/Fill} [fill] Fill style. If none is provided, we'll use a dark fill-style (#333).\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {module:ol/style/Fill} [backgroundFill] Fill style for the text background when `placement` is\n * `'point'`. Default is no fill.\n * @property {module:ol/style/Stroke} [backgroundStroke] Stroke style for the text background  when `placement`\n * is `'point'`. Default is no stroke.\n * @property {Array.<number>} [padding=[0, 0, 0, 0]] Padding in pixels around the text for decluttering and background. The order of\n * values in the array is `[top, right, bottom, left]`.\n */\n\n\n/**\n * @classdesc\n * Set text style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Text~Options=} opt_options Options.\n * @api\n */\nconst Text = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.font_ = options.font;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = options.rotation;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.rotateWithView_ = options.rotateWithView;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.scale_ = options.scale;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.text_ = options.text;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.textAlign_ = options.textAlign;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.textBaseline_ = options.textBaseline;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill :\n    new Fill({color: DEFAULT_FILL_COLOR});\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxAngle_ = options.maxAngle !== undefined ? options.maxAngle : Math.PI / 4;\n\n  /**\n   * @private\n   * @type {module:ol/style/TextPlacement|string}\n   */\n  this.placement_ = options.placement !== undefined ? options.placement : TextPlacement.POINT;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overflow_ = !!options.overflow;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.offsetX_ = options.offsetX !== undefined ? options.offsetX : 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.offsetY_ = options.offsetY !== undefined ? options.offsetY : 0;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.backgroundFill_ = options.backgroundFill ? options.backgroundFill : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.backgroundStroke_ = options.backgroundStroke ? options.backgroundStroke : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.padding_ = options.padding === undefined ? null : options.padding;\n};\n\n\n/**\n * Clones the style.\n * @return {module:ol/style/Text} The cloned style.\n * @api\n */\nText.prototype.clone = function() {\n  return new Text({\n    font: this.getFont(),\n    placement: this.getPlacement(),\n    maxAngle: this.getMaxAngle(),\n    overflow: this.getOverflow(),\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView(),\n    scale: this.getScale(),\n    text: this.getText(),\n    textAlign: this.getTextAlign(),\n    textBaseline: this.getTextBaseline(),\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    offsetX: this.getOffsetX(),\n    offsetY: this.getOffsetY(),\n    backgroundFill: this.getBackgroundFill() ? this.getBackgroundFill().clone() : undefined,\n    backgroundStroke: this.getBackgroundStroke() ? this.getBackgroundStroke().clone() : undefined\n  });\n};\n\n\n/**\n * Get the `overflow` configuration.\n * @return {boolean} Let text overflow the length of the path they follow.\n * @api\n */\nText.prototype.getOverflow = function() {\n  return this.overflow_;\n};\n\n\n/**\n * Get the font name.\n * @return {string|undefined} Font.\n * @api\n */\nText.prototype.getFont = function() {\n  return this.font_;\n};\n\n\n/**\n * Get the maximum angle between adjacent characters.\n * @return {number} Angle in radians.\n * @api\n */\nText.prototype.getMaxAngle = function() {\n  return this.maxAngle_;\n};\n\n\n/**\n * Get the label placement.\n * @return {module:ol/style/TextPlacement|string} Text placement.\n * @api\n */\nText.prototype.getPlacement = function() {\n  return this.placement_;\n};\n\n\n/**\n * Get the x-offset for the text.\n * @return {number} Horizontal text offset.\n * @api\n */\nText.prototype.getOffsetX = function() {\n  return this.offsetX_;\n};\n\n\n/**\n * Get the y-offset for the text.\n * @return {number} Vertical text offset.\n * @api\n */\nText.prototype.getOffsetY = function() {\n  return this.offsetY_;\n};\n\n\n/**\n * Get the fill style for the text.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nText.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * Determine whether the text rotates with the map.\n * @return {boolean|undefined} Rotate with map.\n * @api\n */\nText.prototype.getRotateWithView = function() {\n  return this.rotateWithView_;\n};\n\n\n/**\n * Get the text rotation.\n * @return {number|undefined} Rotation.\n * @api\n */\nText.prototype.getRotation = function() {\n  return this.rotation_;\n};\n\n\n/**\n * Get the text scale.\n * @return {number|undefined} Scale.\n * @api\n */\nText.prototype.getScale = function() {\n  return this.scale_;\n};\n\n\n/**\n * Get the stroke style for the text.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nText.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * Get the text to be rendered.\n * @return {string|undefined} Text.\n * @api\n */\nText.prototype.getText = function() {\n  return this.text_;\n};\n\n\n/**\n * Get the text alignment.\n * @return {string|undefined} Text align.\n * @api\n */\nText.prototype.getTextAlign = function() {\n  return this.textAlign_;\n};\n\n\n/**\n * Get the text baseline.\n * @return {string|undefined} Text baseline.\n * @api\n */\nText.prototype.getTextBaseline = function() {\n  return this.textBaseline_;\n};\n\n\n/**\n * Get the background fill style for the text.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nText.prototype.getBackgroundFill = function() {\n  return this.backgroundFill_;\n};\n\n\n/**\n * Get the background stroke style for the text.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nText.prototype.getBackgroundStroke = function() {\n  return this.backgroundStroke_;\n};\n\n\n/**\n * Get the padding for the text.\n * @return {Array.<number>} Padding.\n * @api\n */\nText.prototype.getPadding = function() {\n  return this.padding_;\n};\n\n\n/**\n * Set the `overflow` property.\n *\n * @param {boolean} overflow Let text overflow the path that it follows.\n * @api\n */\nText.prototype.setOverflow = function(overflow) {\n  this.overflow_ = overflow;\n};\n\n\n/**\n * Set the font.\n *\n * @param {string|undefined} font Font.\n * @api\n */\nText.prototype.setFont = function(font) {\n  this.font_ = font;\n};\n\n\n/**\n * Set the maximum angle between adjacent characters.\n *\n * @param {number} maxAngle Angle in radians.\n * @api\n */\nText.prototype.setMaxAngle = function(maxAngle) {\n  this.maxAngle_ = maxAngle;\n};\n\n\n/**\n * Set the x offset.\n *\n * @param {number} offsetX Horizontal text offset.\n * @api\n */\nText.prototype.setOffsetX = function(offsetX) {\n  this.offsetX_ = offsetX;\n};\n\n\n/**\n * Set the y offset.\n *\n * @param {number} offsetY Vertical text offset.\n * @api\n */\nText.prototype.setOffsetY = function(offsetY) {\n  this.offsetY_ = offsetY;\n};\n\n\n/**\n * Set the text placement.\n *\n * @param {module:ol/style/TextPlacement|string} placement Placement.\n * @api\n */\nText.prototype.setPlacement = function(placement) {\n  this.placement_ = placement;\n};\n\n\n/**\n * Set the fill.\n *\n * @param {module:ol/style/Fill} fill Fill style.\n * @api\n */\nText.prototype.setFill = function(fill) {\n  this.fill_ = fill;\n};\n\n\n/**\n * Set the rotation.\n *\n * @param {number|undefined} rotation Rotation.\n * @api\n */\nText.prototype.setRotation = function(rotation) {\n  this.rotation_ = rotation;\n};\n\n\n/**\n * Set the scale.\n *\n * @param {number|undefined} scale Scale.\n * @api\n */\nText.prototype.setScale = function(scale) {\n  this.scale_ = scale;\n};\n\n\n/**\n * Set the stroke.\n *\n * @param {module:ol/style/Stroke} stroke Stroke style.\n * @api\n */\nText.prototype.setStroke = function(stroke) {\n  this.stroke_ = stroke;\n};\n\n\n/**\n * Set the text.\n *\n * @param {string|undefined} text Text.\n * @api\n */\nText.prototype.setText = function(text) {\n  this.text_ = text;\n};\n\n\n/**\n * Set the text alignment.\n *\n * @param {string|undefined} textAlign Text align.\n * @api\n */\nText.prototype.setTextAlign = function(textAlign) {\n  this.textAlign_ = textAlign;\n};\n\n\n/**\n * Set the text baseline.\n *\n * @param {string|undefined} textBaseline Text baseline.\n * @api\n */\nText.prototype.setTextBaseline = function(textBaseline) {\n  this.textBaseline_ = textBaseline;\n};\n\n\n/**\n * Set the background fill.\n *\n * @param {module:ol/style/Fill} fill Fill style.\n * @api\n */\nText.prototype.setBackgroundFill = function(fill) {\n  this.backgroundFill_ = fill;\n};\n\n\n/**\n * Set the background stroke.\n *\n * @param {module:ol/style/Stroke} stroke Stroke style.\n * @api\n */\nText.prototype.setBackgroundStroke = function(stroke) {\n  this.backgroundStroke_ = stroke;\n};\n\n\n/**\n * Set the padding (`[top, right, bottom, left]`).\n *\n * @param {!Array.<number>} padding Padding.\n * @api\n */\nText.prototype.setPadding = function(padding) {\n  this.padding_ = padding;\n};\nexport default Text;\n","/**\n * @module ol/style/TextPlacement\n */\n\n/**\n * Text placement. One of `'point'`, `'line'`. Default is `'point'`. Note that\n * `'line'` requires the underlying geometry to be a {@link module:ol/geom/LineString~LineString},\n * {@link module:ol/geom/Polygon~Polygon}, {@link module:ol/geom/MultiLineString~MultiLineString} or\n * {@link module:ol/geom/MultiPolygon~MultiPolygon}.\n * @enum {string}\n */\nexport default {\n  POINT: 'point',\n  LINE: 'line'\n};\n","/**\n * @module ol/tilegrid/common\n */\n\n/**\n * Default maximum zoom for default tile grids.\n * @type {number}\n */\nexport const DEFAULT_MAX_ZOOM = 42;\n\n/**\n * Default tile size.\n * @type {number}\n */\nexport const DEFAULT_TILE_SIZE = 256;\n","/**\n * @module ol/transform\n */\nimport {assert} from './asserts.js';\n\n\n/**\n * An array representing an affine 2d transformation for use with\n * {@link module:ol/transform} functions. The array has 6 elements.\n * @typedef {!Array.<number>} Transform\n */\n\n\n/**\n * Collection of affine 2d transformation functions. The functions work on an\n * array of 6 elements. The element order is compatible with the [SVGMatrix\n * interface](https://developer.mozilla.org/en-US/docs/Web/API/SVGMatrix) and is\n * a subset (elements a to f) of a 33 matrix:\n * ```\n * [ a c e ]\n * [ b d f ]\n * [ 0 0 1 ]\n * ```\n */\n\n\n/**\n * @private\n * @type {module:ol/transform~Transform}\n */\nconst tmp_ = new Array(6);\n\n\n/**\n * Create an identity transform.\n * @return {!module:ol/transform~Transform} Identity transform.\n */\nexport function create() {\n  return [1, 0, 0, 1, 0, 0];\n}\n\n\n/**\n * Resets the given transform to an identity transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @return {!module:ol/transform~Transform} Transform.\n */\nexport function reset(transform) {\n  return set(transform, 1, 0, 0, 1, 0, 0);\n}\n\n\n/**\n * Multiply the underlying matrices of two transforms and return the result in\n * the first transform.\n * @param {!module:ol/transform~Transform} transform1 Transform parameters of matrix 1.\n * @param {!module:ol/transform~Transform} transform2 Transform parameters of matrix 2.\n * @return {!module:ol/transform~Transform} transform1 multiplied with transform2.\n */\nexport function multiply(transform1, transform2) {\n  const a1 = transform1[0];\n  const b1 = transform1[1];\n  const c1 = transform1[2];\n  const d1 = transform1[3];\n  const e1 = transform1[4];\n  const f1 = transform1[5];\n  const a2 = transform2[0];\n  const b2 = transform2[1];\n  const c2 = transform2[2];\n  const d2 = transform2[3];\n  const e2 = transform2[4];\n  const f2 = transform2[5];\n\n  transform1[0] = a1 * a2 + c1 * b2;\n  transform1[1] = b1 * a2 + d1 * b2;\n  transform1[2] = a1 * c2 + c1 * d2;\n  transform1[3] = b1 * c2 + d1 * d2;\n  transform1[4] = a1 * e2 + c1 * f2 + e1;\n  transform1[5] = b1 * e2 + d1 * f2 + f1;\n\n  return transform1;\n}\n\n/**\n * Set the transform components a-f on a given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} a The a component of the transform.\n * @param {number} b The b component of the transform.\n * @param {number} c The c component of the transform.\n * @param {number} d The d component of the transform.\n * @param {number} e The e component of the transform.\n * @param {number} f The f component of the transform.\n * @return {!module:ol/transform~Transform} Matrix with transform applied.\n */\nexport function set(transform, a, b, c, d, e, f) {\n  transform[0] = a;\n  transform[1] = b;\n  transform[2] = c;\n  transform[3] = d;\n  transform[4] = e;\n  transform[5] = f;\n  return transform;\n}\n\n\n/**\n * Set transform on one matrix from another matrix.\n * @param {!module:ol/transform~Transform} transform1 Matrix to set transform to.\n * @param {!module:ol/transform~Transform} transform2 Matrix to set transform from.\n * @return {!module:ol/transform~Transform} transform1 with transform from transform2 applied.\n */\nexport function setFromArray(transform1, transform2) {\n  transform1[0] = transform2[0];\n  transform1[1] = transform2[1];\n  transform1[2] = transform2[2];\n  transform1[3] = transform2[3];\n  transform1[4] = transform2[4];\n  transform1[5] = transform2[5];\n  return transform1;\n}\n\n\n/**\n * Transforms the given coordinate with the given transform returning the\n * resulting, transformed coordinate. The coordinate will be modified in-place.\n *\n * @param {module:ol/transform~Transform} transform The transformation.\n * @param {module:ol/coordinate~Coordinate|module:ol~Pixel} coordinate The coordinate to transform.\n * @return {module:ol/coordinate~Coordinate|module:ol~Pixel} return coordinate so that operations can be\n *     chained together.\n */\nexport function apply(transform, coordinate) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  coordinate[0] = transform[0] * x + transform[2] * y + transform[4];\n  coordinate[1] = transform[1] * x + transform[3] * y + transform[5];\n  return coordinate;\n}\n\n\n/**\n * Applies rotation to the given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} angle Angle in radians.\n * @return {!module:ol/transform~Transform} The rotated transform.\n */\nexport function rotate(transform, angle) {\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  return multiply(transform, set(tmp_, cos, sin, -sin, cos, 0, 0));\n}\n\n\n/**\n * Applies scale to a given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} x Scale factor x.\n * @param {number} y Scale factor y.\n * @return {!module:ol/transform~Transform} The scaled transform.\n */\nexport function scale(transform, x, y) {\n  return multiply(transform, set(tmp_, x, 0, 0, y, 0, 0));\n}\n\n\n/**\n * Applies translation to the given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} dx Translation x.\n * @param {number} dy Translation y.\n * @return {!module:ol/transform~Transform} The translated transform.\n */\nexport function translate(transform, dx, dy) {\n  return multiply(transform, set(tmp_, 1, 0, 0, 1, dx, dy));\n}\n\n\n/**\n * Creates a composite transform given an initial translation, scale, rotation, and\n * final translation (in that order only, not commutative).\n * @param {!module:ol/transform~Transform} transform The transform (will be modified in place).\n * @param {number} dx1 Initial translation x.\n * @param {number} dy1 Initial translation y.\n * @param {number} sx Scale factor x.\n * @param {number} sy Scale factor y.\n * @param {number} angle Rotation (in counter-clockwise radians).\n * @param {number} dx2 Final translation x.\n * @param {number} dy2 Final translation y.\n * @return {!module:ol/transform~Transform} The composite transform.\n */\nexport function compose(transform, dx1, dy1, sx, sy, angle, dx2, dy2) {\n  const sin = Math.sin(angle);\n  const cos = Math.cos(angle);\n  transform[0] = sx * cos;\n  transform[1] = sy * sin;\n  transform[2] = -sx * sin;\n  transform[3] = sy * cos;\n  transform[4] = dx2 * sx * cos - dy2 * sx * sin + dx1;\n  transform[5] = dx2 * sy * sin + dy2 * sy * cos + dy1;\n  return transform;\n}\n\n\n/**\n * Invert the given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @return {!module:ol/transform~Transform} Inverse of the transform.\n */\nexport function invert(transform) {\n  const det = determinant(transform);\n  assert(det !== 0, 32); // Transformation matrix cannot be inverted\n\n  const a = transform[0];\n  const b = transform[1];\n  const c = transform[2];\n  const d = transform[3];\n  const e = transform[4];\n  const f = transform[5];\n\n  transform[0] = d / det;\n  transform[1] = -b / det;\n  transform[2] = -c / det;\n  transform[3] = a / det;\n  transform[4] = (c * f - d * e) / det;\n  transform[5] = -(a * f - b * e) / det;\n\n  return transform;\n}\n\n\n/**\n * Returns the determinant of the given matrix.\n * @param {!module:ol/transform~Transform} mat Matrix.\n * @return {number} Determinant.\n */\nexport function determinant(mat) {\n  return mat[0] * mat[3] - mat[1] * mat[2];\n}\n","/**\n * @module ol/webgl\n */\n\n/**\n * Constants taken from goog.webgl\n */\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ONE = 1;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const SRC_ALPHA = 0x0302;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const COLOR_ATTACHMENT0 = 0x8CE0;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const COLOR_BUFFER_BIT = 0x00004000;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TRIANGLES = 0x0004;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TRIANGLE_STRIP = 0x0005;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ONE_MINUS_SRC_ALPHA = 0x0303;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ARRAY_BUFFER = 0x8892;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ELEMENT_ARRAY_BUFFER = 0x8893;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const STREAM_DRAW = 0x88E0;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const STATIC_DRAW = 0x88E4;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DYNAMIC_DRAW = 0x88E8;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const CULL_FACE = 0x0B44;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const BLEND = 0x0BE2;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const STENCIL_TEST = 0x0B90;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEPTH_TEST = 0x0B71;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const SCISSOR_TEST = 0x0C11;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_BYTE = 0x1401;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_SHORT = 0x1403;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_INT = 0x1405;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FLOAT = 0x1406;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const RGBA = 0x1908;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FRAGMENT_SHADER = 0x8B30;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const VERTEX_SHADER = 0x8B31;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const LINK_STATUS = 0x8B82;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const LINEAR = 0x2601;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_MAG_FILTER = 0x2800;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_MIN_FILTER = 0x2801;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_WRAP_S = 0x2802;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_WRAP_T = 0x2803;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_2D = 0x0DE1;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE0 = 0x84C0;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const CLAMP_TO_EDGE = 0x812F;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const COMPILE_STATUS = 0x8B81;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FRAMEBUFFER = 0x8D40;\n\n\n/** end of goog.webgl constants\n */\n\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst CONTEXT_IDS = [\n  'experimental-webgl',\n  'webgl',\n  'webkit-3d',\n  'moz-webgl'\n];\n\n\n/**\n * @param {HTMLCanvasElement} canvas Canvas.\n * @param {Object=} opt_attributes Attributes.\n * @return {WebGLRenderingContext} WebGL rendering context.\n */\nexport function getContext(canvas, opt_attributes) {\n  const ii = CONTEXT_IDS.length;\n  for (let i = 0; i < ii; ++i) {\n    try {\n      const context = canvas.getContext(CONTEXT_IDS[i], opt_attributes);\n      if (context) {\n        return /** @type {!WebGLRenderingContext} */ (context);\n      }\n    } catch (e) {\n      // pass\n    }\n  }\n  return null;\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.quickselect = factory());\n}(this, (function () { 'use strict';\n\nfunction quickselect(arr, k, left, right, compare) {\n    quickselectStep(arr, k, left || 0, right || (arr.length - 1), compare || defaultCompare);\n}\n\nfunction quickselectStep(arr, k, left, right, compare) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            var n = right - left + 1;\n            var m = k - left + 1;\n            var z = Math.log(n);\n            var s = 0.5 * Math.exp(2 * z / 3);\n            var sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            var newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            var newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            quickselectStep(arr, k, newLeft, newRight, compare);\n        }\n\n        var t = arr[k];\n        var i = left;\n        var j = right;\n\n        swap(arr, left, k);\n        if (compare(arr[right], t) > 0) swap(arr, left, right);\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (compare(arr[i], t) < 0) i++;\n            while (compare(arr[j], t) > 0) j--;\n        }\n\n        if (compare(arr[left], t) === 0) swap(arr, left, j);\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) left = j + 1;\n        if (k <= j) right = j - 1;\n    }\n}\n\nfunction swap(arr, i, j) {\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nreturn quickselect;\n\n})));\n","'use strict';\n\nmodule.exports = rbush;\nmodule.exports.default = rbush;\n\nvar quickselect = require('quickselect');\n\nfunction rbush(maxEntries, format) {\n    if (!(this instanceof rbush)) return new rbush(maxEntries, format);\n\n    // max entries in a node is 9 by default; min node fill is 40% for best performance\n    this._maxEntries = Math.max(4, maxEntries || 9);\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n\n    if (format) {\n        this._initFormat(format);\n    }\n\n    this.clear();\n}\n\nrbush.prototype = {\n\n    all: function () {\n        return this._all(this.data, []);\n    },\n\n    search: function (bbox) {\n\n        var node = this.data,\n            result = [],\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return result;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf) result.push(child);\n                    else if (contains(bbox, childBBox)) this._all(child, result);\n                    else nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return result;\n    },\n\n    collides: function (bbox) {\n\n        var node = this.data,\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return false;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf || contains(bbox, childBBox)) return true;\n                    nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return false;\n    },\n\n    load: function (data) {\n        if (!(data && data.length)) return this;\n\n        if (data.length < this._minEntries) {\n            for (var i = 0, len = data.length; i < len; i++) {\n                this.insert(data[i]);\n            }\n            return this;\n        }\n\n        // recursively build the tree with the given data from scratch using OMT algorithm\n        var node = this._build(data.slice(), 0, data.length - 1, 0);\n\n        if (!this.data.children.length) {\n            // save as is if tree is empty\n            this.data = node;\n\n        } else if (this.data.height === node.height) {\n            // split root if trees have the same height\n            this._splitRoot(this.data, node);\n\n        } else {\n            if (this.data.height < node.height) {\n                // swap trees if inserted one is bigger\n                var tmpNode = this.data;\n                this.data = node;\n                node = tmpNode;\n            }\n\n            // insert the small tree into the large tree at appropriate level\n            this._insert(node, this.data.height - node.height - 1, true);\n        }\n\n        return this;\n    },\n\n    insert: function (item) {\n        if (item) this._insert(item, this.data.height - 1);\n        return this;\n    },\n\n    clear: function () {\n        this.data = createNode([]);\n        return this;\n    },\n\n    remove: function (item, equalsFn) {\n        if (!item) return this;\n\n        var node = this.data,\n            bbox = this.toBBox(item),\n            path = [],\n            indexes = [],\n            i, parent, index, goingUp;\n\n        // depth-first iterative tree traversal\n        while (node || path.length) {\n\n            if (!node) { // go up\n                node = path.pop();\n                parent = path[path.length - 1];\n                i = indexes.pop();\n                goingUp = true;\n            }\n\n            if (node.leaf) { // check current node\n                index = findItem(item, node.children, equalsFn);\n\n                if (index !== -1) {\n                    // item found, remove the item and condense tree upwards\n                    node.children.splice(index, 1);\n                    path.push(node);\n                    this._condense(path);\n                    return this;\n                }\n            }\n\n            if (!goingUp && !node.leaf && contains(node, bbox)) { // go down\n                path.push(node);\n                indexes.push(i);\n                i = 0;\n                parent = node;\n                node = node.children[0];\n\n            } else if (parent) { // go right\n                i++;\n                node = parent.children[i];\n                goingUp = false;\n\n            } else node = null; // nothing found\n        }\n\n        return this;\n    },\n\n    toBBox: function (item) { return item; },\n\n    compareMinX: compareNodeMinX,\n    compareMinY: compareNodeMinY,\n\n    toJSON: function () { return this.data; },\n\n    fromJSON: function (data) {\n        this.data = data;\n        return this;\n    },\n\n    _all: function (node, result) {\n        var nodesToSearch = [];\n        while (node) {\n            if (node.leaf) result.push.apply(result, node.children);\n            else nodesToSearch.push.apply(nodesToSearch, node.children);\n\n            node = nodesToSearch.pop();\n        }\n        return result;\n    },\n\n    _build: function (items, left, right, height) {\n\n        var N = right - left + 1,\n            M = this._maxEntries,\n            node;\n\n        if (N <= M) {\n            // reached leaf level; return leaf\n            node = createNode(items.slice(left, right + 1));\n            calcBBox(node, this.toBBox);\n            return node;\n        }\n\n        if (!height) {\n            // target height of the bulk-loaded tree\n            height = Math.ceil(Math.log(N) / Math.log(M));\n\n            // target number of root entries to maximize storage utilization\n            M = Math.ceil(N / Math.pow(M, height - 1));\n        }\n\n        node = createNode([]);\n        node.leaf = false;\n        node.height = height;\n\n        // split the items into M mostly square tiles\n\n        var N2 = Math.ceil(N / M),\n            N1 = N2 * Math.ceil(Math.sqrt(M)),\n            i, j, right2, right3;\n\n        multiSelect(items, left, right, N1, this.compareMinX);\n\n        for (i = left; i <= right; i += N1) {\n\n            right2 = Math.min(i + N1 - 1, right);\n\n            multiSelect(items, i, right2, N2, this.compareMinY);\n\n            for (j = i; j <= right2; j += N2) {\n\n                right3 = Math.min(j + N2 - 1, right2);\n\n                // pack each entry recursively\n                node.children.push(this._build(items, j, right3, height - 1));\n            }\n        }\n\n        calcBBox(node, this.toBBox);\n\n        return node;\n    },\n\n    _chooseSubtree: function (bbox, node, level, path) {\n\n        var i, len, child, targetNode, area, enlargement, minArea, minEnlargement;\n\n        while (true) {\n            path.push(node);\n\n            if (node.leaf || path.length - 1 === level) break;\n\n            minArea = minEnlargement = Infinity;\n\n            for (i = 0, len = node.children.length; i < len; i++) {\n                child = node.children[i];\n                area = bboxArea(child);\n                enlargement = enlargedArea(bbox, child) - area;\n\n                // choose entry with the least area enlargement\n                if (enlargement < minEnlargement) {\n                    minEnlargement = enlargement;\n                    minArea = area < minArea ? area : minArea;\n                    targetNode = child;\n\n                } else if (enlargement === minEnlargement) {\n                    // otherwise choose one with the smallest area\n                    if (area < minArea) {\n                        minArea = area;\n                        targetNode = child;\n                    }\n                }\n            }\n\n            node = targetNode || node.children[0];\n        }\n\n        return node;\n    },\n\n    _insert: function (item, level, isNode) {\n\n        var toBBox = this.toBBox,\n            bbox = isNode ? item : toBBox(item),\n            insertPath = [];\n\n        // find the best node for accommodating the item, saving all nodes along the path too\n        var node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n        // put the item into the node\n        node.children.push(item);\n        extend(node, bbox);\n\n        // split on node overflow; propagate upwards if necessary\n        while (level >= 0) {\n            if (insertPath[level].children.length > this._maxEntries) {\n                this._split(insertPath, level);\n                level--;\n            } else break;\n        }\n\n        // adjust bboxes along the insertion path\n        this._adjustParentBBoxes(bbox, insertPath, level);\n    },\n\n    // split overflowed node into two\n    _split: function (insertPath, level) {\n\n        var node = insertPath[level],\n            M = node.children.length,\n            m = this._minEntries;\n\n        this._chooseSplitAxis(node, m, M);\n\n        var splitIndex = this._chooseSplitIndex(node, m, M);\n\n        var newNode = createNode(node.children.splice(splitIndex, node.children.length - splitIndex));\n        newNode.height = node.height;\n        newNode.leaf = node.leaf;\n\n        calcBBox(node, this.toBBox);\n        calcBBox(newNode, this.toBBox);\n\n        if (level) insertPath[level - 1].children.push(newNode);\n        else this._splitRoot(node, newNode);\n    },\n\n    _splitRoot: function (node, newNode) {\n        // split root node\n        this.data = createNode([node, newNode]);\n        this.data.height = node.height + 1;\n        this.data.leaf = false;\n        calcBBox(this.data, this.toBBox);\n    },\n\n    _chooseSplitIndex: function (node, m, M) {\n\n        var i, bbox1, bbox2, overlap, area, minOverlap, minArea, index;\n\n        minOverlap = minArea = Infinity;\n\n        for (i = m; i <= M - m; i++) {\n            bbox1 = distBBox(node, 0, i, this.toBBox);\n            bbox2 = distBBox(node, i, M, this.toBBox);\n\n            overlap = intersectionArea(bbox1, bbox2);\n            area = bboxArea(bbox1) + bboxArea(bbox2);\n\n            // choose distribution with minimum overlap\n            if (overlap < minOverlap) {\n                minOverlap = overlap;\n                index = i;\n\n                minArea = area < minArea ? area : minArea;\n\n            } else if (overlap === minOverlap) {\n                // otherwise choose distribution with minimum area\n                if (area < minArea) {\n                    minArea = area;\n                    index = i;\n                }\n            }\n        }\n\n        return index;\n    },\n\n    // sorts node children by the best axis for split\n    _chooseSplitAxis: function (node, m, M) {\n\n        var compareMinX = node.leaf ? this.compareMinX : compareNodeMinX,\n            compareMinY = node.leaf ? this.compareMinY : compareNodeMinY,\n            xMargin = this._allDistMargin(node, m, M, compareMinX),\n            yMargin = this._allDistMargin(node, m, M, compareMinY);\n\n        // if total distributions margin value is minimal for x, sort by minX,\n        // otherwise it's already sorted by minY\n        if (xMargin < yMargin) node.children.sort(compareMinX);\n    },\n\n    // total margin of all possible split distributions where each node is at least m full\n    _allDistMargin: function (node, m, M, compare) {\n\n        node.children.sort(compare);\n\n        var toBBox = this.toBBox,\n            leftBBox = distBBox(node, 0, m, toBBox),\n            rightBBox = distBBox(node, M - m, M, toBBox),\n            margin = bboxMargin(leftBBox) + bboxMargin(rightBBox),\n            i, child;\n\n        for (i = m; i < M - m; i++) {\n            child = node.children[i];\n            extend(leftBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(leftBBox);\n        }\n\n        for (i = M - m - 1; i >= m; i--) {\n            child = node.children[i];\n            extend(rightBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(rightBBox);\n        }\n\n        return margin;\n    },\n\n    _adjustParentBBoxes: function (bbox, path, level) {\n        // adjust bboxes along the given tree path\n        for (var i = level; i >= 0; i--) {\n            extend(path[i], bbox);\n        }\n    },\n\n    _condense: function (path) {\n        // go through the path, removing empty nodes and updating bboxes\n        for (var i = path.length - 1, siblings; i >= 0; i--) {\n            if (path[i].children.length === 0) {\n                if (i > 0) {\n                    siblings = path[i - 1].children;\n                    siblings.splice(siblings.indexOf(path[i]), 1);\n\n                } else this.clear();\n\n            } else calcBBox(path[i], this.toBBox);\n        }\n    },\n\n    _initFormat: function (format) {\n        // data format (minX, minY, maxX, maxY accessors)\n\n        // uses eval-type function compilation instead of just accepting a toBBox function\n        // because the algorithms are very sensitive to sorting functions performance,\n        // so they should be dead simple and without inner calls\n\n        var compareArr = ['return a', ' - b', ';'];\n\n        this.compareMinX = new Function('a', 'b', compareArr.join(format[0]));\n        this.compareMinY = new Function('a', 'b', compareArr.join(format[1]));\n\n        this.toBBox = new Function('a',\n            'return {minX: a' + format[0] +\n            ', minY: a' + format[1] +\n            ', maxX: a' + format[2] +\n            ', maxY: a' + format[3] + '};');\n    }\n};\n\nfunction findItem(item, items, equalsFn) {\n    if (!equalsFn) return items.indexOf(item);\n\n    for (var i = 0; i < items.length; i++) {\n        if (equalsFn(item, items[i])) return i;\n    }\n    return -1;\n}\n\n// calculate node's bbox from bboxes of its children\nfunction calcBBox(node, toBBox) {\n    distBBox(node, 0, node.children.length, toBBox, node);\n}\n\n// min bounding rectangle of node children from k to p-1\nfunction distBBox(node, k, p, toBBox, destNode) {\n    if (!destNode) destNode = createNode(null);\n    destNode.minX = Infinity;\n    destNode.minY = Infinity;\n    destNode.maxX = -Infinity;\n    destNode.maxY = -Infinity;\n\n    for (var i = k, child; i < p; i++) {\n        child = node.children[i];\n        extend(destNode, node.leaf ? toBBox(child) : child);\n    }\n\n    return destNode;\n}\n\nfunction extend(a, b) {\n    a.minX = Math.min(a.minX, b.minX);\n    a.minY = Math.min(a.minY, b.minY);\n    a.maxX = Math.max(a.maxX, b.maxX);\n    a.maxY = Math.max(a.maxY, b.maxY);\n    return a;\n}\n\nfunction compareNodeMinX(a, b) { return a.minX - b.minX; }\nfunction compareNodeMinY(a, b) { return a.minY - b.minY; }\n\nfunction bboxArea(a)   { return (a.maxX - a.minX) * (a.maxY - a.minY); }\nfunction bboxMargin(a) { return (a.maxX - a.minX) + (a.maxY - a.minY); }\n\nfunction enlargedArea(a, b) {\n    return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) *\n           (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n}\n\nfunction intersectionArea(a, b) {\n    var minX = Math.max(a.minX, b.minX),\n        minY = Math.max(a.minY, b.minY),\n        maxX = Math.min(a.maxX, b.maxX),\n        maxY = Math.min(a.maxY, b.maxY);\n\n    return Math.max(0, maxX - minX) *\n           Math.max(0, maxY - minY);\n}\n\nfunction contains(a, b) {\n    return a.minX <= b.minX &&\n           a.minY <= b.minY &&\n           b.maxX <= a.maxX &&\n           b.maxY <= a.maxY;\n}\n\nfunction intersects(a, b) {\n    return b.minX <= a.maxX &&\n           b.minY <= a.maxY &&\n           b.maxX >= a.minX &&\n           b.maxY >= a.minY;\n}\n\nfunction createNode(children) {\n    return {\n        children: children,\n        height: 1,\n        leaf: true,\n        minX: Infinity,\n        minY: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity\n    };\n}\n\n// sort an array so that items come in groups of n unsorted items, with groups sorted between each other;\n// combines selection algorithm with binary divide & conquer approach\n\nfunction multiSelect(arr, left, right, n, compare) {\n    var stack = [left, right],\n        mid;\n\n    while (stack.length) {\n        right = stack.pop();\n        left = stack.pop();\n\n        if (right - left <= n) continue;\n\n        mid = left + Math.ceil((right - left) / n / 2) * n;\n        quickselect(arr, mid, left, right, compare);\n\n        stack.push(left, mid, mid, right);\n    }\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\toptions.attrs.type = \"text/css\";\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/*\nol-mapbox-style - Use Mapbox Style objects with OpenLayers\nCopyright 2016-present Boundless Spatial, Inc.\nLicense: https://raw.githubusercontent.com/boundlessgeo/ol-mapbox-gl-style/master/LICENSE\n*/\n\nimport Style from 'ol/style/Style';\nimport Fill from 'ol/style/Fill';\nimport Stroke from 'ol/style/Stroke';\nimport Icon from 'ol/style/Icon';\nimport Text from 'ol/style/Text';\nimport Circle from 'ol/style/Circle';\nimport Point from 'ol/geom/Point';\nimport derefLayers from '@mapbox/mapbox-gl-style-spec/deref';\nimport spec from '@mapbox/mapbox-gl-style-spec/reference/latest';\nimport {isFunction} from '@mapbox/mapbox-gl-style-spec/function';\nimport {isExpression} from '@mapbox/mapbox-gl-style-spec/expression';\nimport convertFunction from '@mapbox/mapbox-gl-style-spec/function/convert';\nimport Color from '@mapbox/mapbox-gl-style-spec/util/color';\nimport {createPropertyExpression} from '@mapbox/mapbox-gl-style-spec/expression';\n\nimport createFilter from '@mapbox/mapbox-gl-style-spec/feature_filter';\nimport mb2css from 'mapbox-to-css-font';\nimport {deg2rad, getZoomForResolution} from './util';\n\nconst types = {\n  'Point': 1,\n  'MultiPoint': 1,\n  'LineString': 2,\n  'MultiLineString': 2,\n  'Polygon': 3,\n  'MultiPolygon': 3\n};\n\nconst expressionData = function(rawExpression, propertySpec) {\n  const compiledExpression = createPropertyExpression(rawExpression, propertySpec);\n  if (compiledExpression.result === 'error') {\n    throw new Error(compiledExpression.value.map(err => `${err.key}: ${err.message}`).join(', '));\n  }\n  return compiledExpression.value;\n};\n\nconst emptyObj = {};\nconst zoomObj = {zoom: 0};\nconst functionCache = {};\n\n/**\n * @private\n * @param {Object} layer Gl object layer.\n * @param {string} layoutOrPaint 'layout' or 'paint'.\n * @param {string} property Feature property.\n * @param {number} zoom Zoom.\n * @param {Object} feature Gl feature.\n * @return {?} Value.\n */\nexport function getValue(layer, layoutOrPaint, property, zoom, feature) {\n  const layerId = layer.id;\n  if (!functionCache[layerId]) {\n    functionCache[layerId] = {};\n  }\n  const functions = functionCache[layerId];\n  if (!functions[property]) {\n    let value = (layer[layoutOrPaint] || emptyObj)[property];\n    const propertySpec = spec[`${layoutOrPaint}_${layer.type}`][property];\n    if (value === undefined) {\n      value = propertySpec.default;\n    }\n    let isExpr = isExpression((value));\n    if (!isExpr && isFunction(value)) {\n      value = convertFunction(value, propertySpec);\n      isExpr = true;\n    }\n    if (isExpr) {\n      const compiledExpression = expressionData(value, propertySpec);\n      functions[property] = compiledExpression.evaluate.bind(compiledExpression);\n    } else {\n      if (propertySpec.type == 'color') {\n        value = Color.parse(value);\n      }\n      functions[property] = function() {\n        return value;\n      };\n    }\n  }\n  zoomObj.zoom = zoom;\n  return functions[property](zoomObj, feature);\n}\n\nconst filterCache = {};\nfunction evaluateFilter(layerId, filter, feature, zoom) {\n  if (!(layerId in filterCache)) {\n    filterCache[layerId] = createFilter(filter);\n  }\n  zoomObj.zoom = zoom;\n  return filterCache[layerId](zoomObj, feature);\n}\n\nconst colorCache = {};\nfunction colorWithOpacity(color, opacity) {\n  if (color && opacity !== undefined) {\n    let colorData = colorCache[color];\n    if (!colorData) {\n      colorCache[color] = colorData = {\n        color: color.toArray(),\n        opacity: color.a\n      };\n    }\n    color = colorData.color;\n    color[3] = colorData.opacity * opacity;\n    if (color[3] === 0) {\n      color = undefined;\n    }\n  }\n  return color;\n}\n\nconst templateRegEx = /^([^]*)\\{(.*)\\}([^]*)$/;\nfunction fromTemplate(text, properties) {\n  let parts;\n  do {\n    parts = text.match(templateRegEx);\n    if (parts) {\n      const value = properties[parts[2]] || '';\n      text = parts[1] + value + parts[3];\n    }\n  } while (parts);\n  return text;\n}\n\n/**\n * Creates a style function from the `glStyle` object for all layers that use\n * the specified `source`, which needs to be a `\"type\": \"vector\"` or\n * `\"type\": \"geojson\"` source and applies it to the specified OpenLayers layer.\n *\n * @param {ol.layer.Vector|ol.layer.VectorTile} olLayer OpenLayers layer to\n * apply the style to. In addition to the style, the layer will get two\n * properties: `mapbox-source` will be the `id` of the `glStyle`'s source used\n * for the layer, and `mapbox-layers` will be an array of the `id`s of the\n * `glStyle`'s layers.\n * @param {string|Object} glStyle Mapbox Style object.\n * @param {string|Array<string>} source `source` key or an array of layer `id`s\n * from the Mapbox Style object. When a `source` key is provided, all layers for\n * the specified source will be included in the style function. When layer `id`s\n * are provided, they must be from layers that use the same source.\n * @param {Array<number>} [resolutions=[78271.51696402048, 39135.75848201024,\n * 19567.87924100512, 9783.93962050256, 4891.96981025128, 2445.98490512564,\n * 1222.99245256282, 611.49622628141, 305.748113140705, 152.8740565703525,\n * 76.43702828517625, 38.21851414258813, 19.109257071294063, 9.554628535647032,\n * 4.777314267823516, 2.388657133911758, 1.194328566955879, 0.5971642834779395,\n * 0.29858214173896974, 0.14929107086948487, 0.07464553543474244]]\n * Resolutions for mapping resolution to zoom level.\n * @param {Object} [spriteData=undefined] Sprite data from the url specified in\n * the Mapbox Style object's `sprite` property. Only required if a `sprite`\n * property is specified in the Mapbox Style object.\n * @param {Object} [spriteImageUrl=undefined] Sprite image url for the sprite\n * specified in the Mapbox Style object's `sprite` property. Only required if a\n * `sprite` property is specified in the Mapbox Style object.\n * @param {function(Array<string>):string} [getFonts=undefined] Function that\n * receives a font stack as arguments, and returns a (modified) font stack that\n * is available. Font names are the names used in the Mapbox Style object. If\n * not provided, the font stack will be used as-is. This function can also be\n * used for loading web fonts.\n * @return {ol.style.StyleFunction} Style function for use in\n * `ol.layer.Vector` or `ol.layer.VectorTile`.\n */\nexport default function(olLayer, glStyle, source, resolutions, spriteData, spriteImageUrl, getFonts) {\n  if (!resolutions) {\n    resolutions = [];\n    for (let res = 78271.51696402048; resolutions.length < 21; res /= 2) {\n      resolutions.push(res);\n    }\n  }\n  if (typeof glStyle == 'string') {\n    glStyle = JSON.parse(glStyle);\n  }\n  if (glStyle.version != 8) {\n    throw new Error('glStyle version 8 required.');\n  }\n\n  let spriteImage, spriteImgSize;\n  if (spriteImageUrl) {\n    const img = new Image();\n    img.crossOrigin = 'anonymous';\n    img.onload = function() {\n      spriteImage = img;\n      spriteImgSize = [img.width, img.height];\n      olLayer.changed();\n      img.onload = null;\n    };\n    img.src = spriteImageUrl;\n  }\n\n  const ctx = document.createElement('CANVAS').getContext('2d');\n  const measureCache = {};\n  function wrapText(text, font, em) {\n    const key = em + ',' + font + ',' + text;\n    let wrappedText = measureCache[key];\n    if (!wrappedText) {\n      ctx.font = font;\n      const oneEm = ctx.measureText('M').width;\n      const width = oneEm * em;\n      const words = text.split(' ');\n      let line = '';\n      const lines = [];\n      for (let i = 0, ii = words.length; i < ii; ++i) {\n        const word = words[i];\n        if ((ctx.measureText(line + word).width <= width)) {\n          line += (line ? ' ' : '') + word;\n        } else {\n          if (line) {\n            lines.push(line);\n          }\n          line = word;\n        }\n      }\n      if (line) {\n        lines.push(line);\n      }\n      measureCache[key] = wrappedText = lines.join('\\n');\n    }\n    return wrappedText;\n  }\n\n  const allLayers = derefLayers(glStyle.layers);\n\n  const layersBySourceLayer = {};\n  const mapboxLayers = [];\n  let mapboxSource;\n  for (let i = 0, ii = allLayers.length; i < ii; ++i) {\n    const layer = allLayers[i];\n    const layerId = layer.id;\n    if (typeof source == 'string' && layer.source == source ||\n        source.indexOf(layerId) !== -1) {\n      const sourceLayer = layer['source-layer'];\n      if (!mapboxSource) {\n        mapboxSource = layer.source;\n      }\n      let layers = layersBySourceLayer[sourceLayer];\n      if (!layers) {\n        layers = layersBySourceLayer[sourceLayer] = [];\n      }\n      layers.push({\n        layer: layer,\n        index: i\n      });\n      mapboxLayers.push(layerId);\n    }\n    // TODO revisit when diffing gets added\n    delete functionCache[layerId];\n    delete filterCache[layerId];\n  }\n\n  const textHalo = new Stroke();\n  const textColor = new Fill();\n\n  const iconImageCache = {};\n  const patternCache = {};\n  const styles = [];\n\n  const styleFunction = function(feature, resolution) {\n    const properties = feature.getProperties();\n    const layers = layersBySourceLayer[properties.layer];\n    if (!layers) {\n      return;\n    }\n    let zoom = resolutions.indexOf(resolution);\n    if (zoom == -1) {\n      zoom = getZoomForResolution(resolution, resolutions);\n    }\n    const type = types[feature.getGeometry().getType()];\n    const f = {\n      properties: properties,\n      type: type\n    };\n    let stylesLength = -1;\n    for (let i = 0, ii = layers.length; i < ii; ++i) {\n      const layerData = layers[i];\n      const layer = layerData.layer;\n      const layerId = layer.id;\n\n      const layout = layer.layout || emptyObj;\n      const paint = layer.paint || emptyObj;\n      if (layout.visibility === 'none' || ('minzoom' in layer && zoom < layer.minzoom) ||\n          ('maxzoom' in layer && zoom >= layer.maxzoom)) {\n        continue;\n      }\n      const filter = layer.filter;\n      if (!filter || evaluateFilter(layerId, filter, f, zoom)) {\n        let color, opacity, fill, stroke, strokeColor, style;\n        const index = layerData.index;\n        if (type == 3 && layer.type == 'fill') {\n          opacity = getValue(layer, 'paint', 'fill-opacity', zoom, f);\n          if ('fill-pattern' in paint) {\n            const fillIcon = getValue(layer, 'paint', 'fill-pattern', zoom, f);\n            if (fillIcon) {\n              const icon = fromTemplate(fillIcon, properties);\n              if (spriteImage && spriteData && spriteData[icon]) {\n                ++stylesLength;\n                style = styles[stylesLength];\n                if (!style || !style.getFill() || style.getStroke() || style.getText()) {\n                  style = styles[stylesLength] = new Style({\n                    fill: new Fill()\n                  });\n                }\n                fill = style.getFill();\n                style.setZIndex(index);\n                const icon_cache_key = icon + '.' + opacity;\n                let pattern = patternCache[icon_cache_key];\n                if (!pattern) {\n                  const spriteImageData = spriteData[icon];\n                  const canvas = document.createElement('canvas');\n                  canvas.width = spriteImageData.width;\n                  canvas.height = spriteImageData.height;\n                  const ctx = canvas.getContext('2d');\n                  ctx.globalAlpha = opacity;\n                  ctx.drawImage(\n                    spriteImage,\n                    spriteImageData.x,\n                    spriteImageData.y,\n                    spriteImageData.width,\n                    spriteImageData.height,\n                    0,\n                    0,\n                    spriteImageData.width,\n                    spriteImageData.height\n                  );\n                  pattern = ctx.createPattern(canvas, 'repeat');\n                  patternCache[icon_cache_key] = pattern;\n                }\n                fill.setColor(pattern);\n              }\n            }\n          } else {\n            opacity = getValue(layer, 'paint', 'fill-opacity', zoom, f);\n            color = colorWithOpacity(getValue(layer, 'paint', 'fill-color', zoom, f), opacity);\n            if (color) {\n              ++stylesLength;\n              style = styles[stylesLength];\n              if (!style || !style.getFill() || style.getStroke() || style.getText()) {\n                style = styles[stylesLength] = new Style({\n                  fill: new Fill()\n                });\n              }\n              fill = style.getFill();\n              fill.setColor(color);\n              style.setZIndex(index);\n            }\n            if ('fill-outline-color' in paint) {\n              strokeColor = colorWithOpacity(getValue(layer, 'paint', 'fill-outline-color', zoom, f), opacity);\n            }\n            if (strokeColor) {\n              ++stylesLength;\n              style = styles[stylesLength];\n              if (!style || !style.getStroke() || style.getFill() || style.getText()) {\n                style = styles[stylesLength] = new Style({\n                  stroke: new Stroke()\n                });\n              }\n              stroke = style.getStroke();\n              stroke.setLineCap(spec['layout_line']['line-cap']);\n              stroke.setLineJoin(spec['layout_line']['line-join']);\n              stroke.setMiterLimit(spec['layout_line']['line-miter-limit']);\n              stroke.setColor(strokeColor);\n              stroke.setWidth(1);\n              stroke.setLineDash(null);\n              style.setZIndex(index);\n            }\n          }\n        }\n        if (type != 1) {\n          color = !('line-pattern' in paint) && 'line-color' in paint ?\n            colorWithOpacity(getValue(layer, 'paint', 'line-color', zoom, f), getValue(layer, 'paint', 'line-opacity', zoom, f)) :\n            undefined;\n          const width = layer.type == 'line' ? getValue(layer, 'paint', 'line-width', zoom, f) : 1;\n          if (color && width > 0) {\n            ++stylesLength;\n            style = styles[stylesLength];\n            if (!style || !style.getStroke() || style.getFill() || style.getText()) {\n              style = styles[stylesLength] = new Style({\n                stroke: new Stroke()\n              });\n            }\n            stroke = style.getStroke();\n            stroke.setLineCap(getValue(layer, 'layout', 'line-cap', zoom, f));\n            stroke.setLineJoin(getValue(layer, 'layout', 'line-join', zoom, f));\n            stroke.setMiterLimit(getValue(layer, 'layout', 'line-miter-limit', zoom, f));\n            stroke.setColor(color);\n            stroke.setWidth(width);\n            stroke.setLineDash(paint['line-dasharray'] ?\n              getValue(layer, 'paint', 'line-dasharray', zoom, f).map(function(x) {\n                return x * width;\n              }) : null);\n            style.setZIndex(index);\n          }\n        }\n\n        let hasImage = false;\n        let text = null;\n        let icon, iconImg, skipLabel;\n        if ((type == 1 || type == 2) && 'icon-image' in layout) {\n          const iconImage = getValue(layer, 'layout', 'icon-image', zoom, f);\n          if (iconImage) {\n            icon = fromTemplate(iconImage, properties);\n            let styleGeom = undefined;\n            if (spriteImage && spriteData && spriteData[icon]) {\n              if (type == 2) {\n                const geom = feature.getGeometry();\n                // ol package and ol-debug.js only\n                if (geom.getFlatMidpoint) {\n                  const extent = geom.getExtent();\n                  const size = Math.sqrt(Math.max(\n                    Math.pow((extent[2] - extent[0]) / resolution, 2),\n                    Math.pow((extent[3] - extent[1]) / resolution, 2))\n                  );\n                  if (size > 150) {\n                    //FIXME Do not hard-code a size of 150\n                    styleGeom = new Point(geom.getFlatMidpoint());\n                  }\n                }\n              }\n              if (type !== 2 || styleGeom) {\n                ++stylesLength;\n                style = styles[stylesLength];\n                if (!style || !style.getImage() || style.getFill() || style.getStroke()) {\n                  style = styles[stylesLength] = new Style();\n                }\n                style.setGeometry(styleGeom);\n                const iconSize = getValue(layer, 'layout', 'icon-size', zoom, f);\n                const iconColor = paint['icon-color'] !== undefined ? getValue(layer, 'paint', 'icon-color', zoom, f) : null;\n                let icon_cache_key = icon + '.' + iconSize;\n                if (iconColor !== null) {\n                  icon_cache_key += '.' + iconColor;\n                }\n                iconImg = iconImageCache[icon_cache_key];\n                if (!iconImg) {\n                  const spriteImageData = spriteData[icon];\n                  if (iconColor !== null) {\n                    // cut out the sprite and color it\n                    color = colorWithOpacity(iconColor, 1);\n                    const canvas = document.createElement('canvas');\n                    canvas.width = spriteImageData.width;\n                    canvas.height = spriteImageData.height;\n                    const ctx = canvas.getContext('2d');\n                    ctx.drawImage(\n                      spriteImage,\n                      spriteImageData.x,\n                      spriteImageData.y,\n                      spriteImageData.width,\n                      spriteImageData.height,\n                      0,\n                      0,\n                      spriteImageData.width,\n                      spriteImageData.height\n                    );\n                    const data = ctx.getImageData(0, 0, canvas.width, canvas.height);\n                    for (let c = 0, cc = data.data.length; c < cc; c += 4) {\n                      data.data[c] = color[0];\n                      data.data[c + 1] = color[1];\n                      data.data[c + 2] = color[2];\n                    }\n                    ctx.putImageData(data, 0, 0);\n                    iconImg = iconImageCache[icon_cache_key] = new Icon({\n                      img: canvas,\n                      imgSize: [canvas.width, canvas.height],\n                      scale: iconSize / spriteImageData.pixelRatio\n                    });\n                  } else {\n                    iconImg = iconImageCache[icon_cache_key] = new Icon({\n                      img: spriteImage,\n                      imgSize: spriteImgSize,\n                      size: [spriteImageData.width, spriteImageData.height],\n                      offset: [spriteImageData.x, spriteImageData.y],\n                      scale: iconSize / spriteImageData.pixelRatio\n                    });\n                  }\n                }\n                iconImg.setRotation(deg2rad(getValue(layer, 'layout', 'icon-rotate', zoom, f)));\n                iconImg.setOpacity(getValue(layer, 'paint', 'icon-opacity', zoom, f));\n                style.setImage(iconImg);\n                text = style.getText();\n                style.setText(undefined);\n                style.setZIndex(99999 - index);\n                hasImage = true;\n                skipLabel = false;\n              } else {\n                skipLabel = true;\n              }\n            }\n          }\n        }\n\n        if (type == 1 && 'circle-radius' in paint) {\n          ++stylesLength;\n          style = styles[stylesLength];\n          if (!style || !style.getImage() || style.getFill() || style.getStroke()) {\n            style = styles[stylesLength] = new Style();\n          }\n          const circleRadius = getValue(layer, 'paint', 'circle-radius', zoom, f);\n          const circleStrokeColor = getValue(layer, 'paint', 'circle-stroke-color', zoom, f);\n          const circleColor = getValue(layer, 'paint', 'circle-color', zoom, f);\n          const circleOpacity = getValue(layer, 'paint', 'circle-opacity', zoom, f);\n          const circleStrokeWidth = getValue(layer, 'paint', 'circle-stroke-width', zoom, f);\n          const cache_key = circleRadius + '.' + circleStrokeColor + '.' +\n            circleColor + '.' + circleOpacity + '.' + circleStrokeWidth;\n          iconImg = iconImageCache[cache_key];\n          if (!iconImg) {\n            iconImg = new Circle({\n              radius: circleRadius,\n              stroke: circleStrokeWidth === 0 ? undefined : new Stroke({\n                width: circleStrokeWidth,\n                color: colorWithOpacity(circleStrokeColor, circleOpacity)\n              }),\n              fill: new Fill({\n                color: colorWithOpacity(circleColor, circleOpacity)\n              })\n            });\n          }\n          style.setImage(iconImg);\n          text = style.getText();\n          style.setText(undefined);\n          style.setGeometry(undefined);\n          style.setZIndex(99999 - index);\n          hasImage = true;\n        }\n\n        let label;\n        if ('text-field' in layout) {\n          const textField = getValue(layer, 'layout', 'text-field', zoom, f);\n          label = fromTemplate(textField, properties);\n        }\n        if (label && !skipLabel) {\n          if (!hasImage) {\n            ++stylesLength;\n            style = styles[stylesLength];\n            if (!style || !style.getText() || style.getFill() || style.getStroke()) {\n              style = styles[stylesLength] = new Style();\n            }\n            style.setImage(undefined);\n            style.setGeometry(undefined);\n          }\n          if (!style.getText()) {\n            style.setText(text || new Text());\n          }\n          text = style.getText();\n          const textSize = getValue(layer, 'layout', 'text-size', zoom, f);\n          const fontArray = getValue(layer, 'layout', 'text-font', zoom, f);\n          const font = mb2css(getFonts ? getFonts(fontArray) : fontArray, textSize);\n          const textTransform = layout['text-transform'];\n          if (textTransform == 'uppercase') {\n            label = label.toUpperCase();\n          } else if (textTransform == 'lowercase') {\n            label = label.toLowerCase();\n          }\n          const wrappedLabel = type == 2 ? label : wrapText(label, font, getValue(layer, 'layout', 'text-max-width', zoom, f));\n          text.setText(wrappedLabel);\n          text.setFont(font);\n          text.setRotation(deg2rad(getValue(layer, 'layout', 'text-rotate', zoom, f)));\n          const textAnchor = getValue(layer, 'layout', 'text-anchor', zoom, f);\n          const placement = (hasImage || type == 1) ? 'point' : getValue(layer, 'layout', 'symbol-placement', zoom, f);\n          text.setPlacement(placement);\n          if (placement == 'point') {\n            let textAlign = 'center';\n            if (textAnchor.indexOf('left') !== -1) {\n              textAlign = 'left';\n            } else if (textAnchor.indexOf('right') !== -1) {\n              textAlign = 'right';\n            }\n            text.setTextAlign(textAlign);\n          } else {\n            text.setTextAlign();\n          }\n          let textBaseline = 'middle';\n          if (textAnchor.indexOf('bottom') == 0) {\n            textBaseline = 'bottom';\n          } else if (textAnchor.indexOf('top') == 0) {\n            textBaseline = 'top';\n          }\n          text.setTextBaseline(textBaseline);\n          const textOffset = getValue(layer, 'layout', 'text-offset', zoom, f);\n          text.setOffsetX(textOffset[0] * textSize);\n          text.setOffsetY(textOffset[1] * textSize);\n          opacity = getValue(layer, 'paint', 'text-opacity', zoom, f);\n          textColor.setColor(colorWithOpacity(getValue(layer, 'paint', 'text-color', zoom, f), opacity));\n          text.setFill(textColor);\n          const haloColor = colorWithOpacity(getValue(layer, 'paint', 'text-halo-color', zoom, f), opacity);\n          if (haloColor) {\n            textHalo.setColor(haloColor);\n            textHalo.setWidth(getValue(layer, 'paint', 'text-halo-width', zoom, f));\n            text.setStroke(textHalo);\n          } else {\n            text.setStroke(undefined);\n          }\n          style.setZIndex(99999 - index);\n        }\n      }\n    }\n\n    if (stylesLength > -1) {\n      styles.length = stylesLength + 1;\n      return styles;\n    }\n  };\n\n  olLayer.setStyle(styleFunction);\n  olLayer.set('mapbox-source', mapboxSource);\n  olLayer.set('mapbox-layers', mapboxLayers);\n  return styleFunction;\n}\n","export function deg2rad(degrees) {\n  return degrees * Math.PI / 180;\n}\n\nexport function getZoomForResolution(resolution, resolutions) {\n  let i = 0;\n  const ii = resolutions.length;\n  for (; i < ii; ++i) {\n    const candidate = resolutions[i];\n    if (candidate < resolution && i + 1 < ii) {\n      const zoomFactor = resolutions[i] / resolutions[i + 1];\n      return i + Math.log(resolutions[i] / resolution) / Math.log(zoomFactor);\n    }\n  }\n  return ii - 1;\n}\n"],"sourceRoot":""}