!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("ol/Map.js"),require("ol/coordinate.js"),require("ol/extent.js"),require("ol/functions.js"),require("ol/render/Feature.js"),require("ol/style/Circle.js"),require("ol/style/Fill.js"),require("ol/style/Icon.js"),require("ol/style/Stroke.js"),require("ol/style/Style.js"),require("ol/style/Text.js"),require("ol/color.js"),require("ol/has.js"),require("ol/render/canvas.js"),require("ol"),require("ol/TileState.js"),require("ol/util.js"),require("ol/View.js"),require("ol/format/GeoJSON.js"),require("ol/format/MVT.js"),require("ol/layer/Group.js"),require("ol/layer/Image.js"),require("ol/layer/Layer.js"),require("ol/layer/Tile.js"),require("ol/layer/Vector.js"),require("ol/layer/VectorTile.js"),require("ol/loadingstrategy.js"),require("ol/proj/Units.js"),require("ol/proj.js"),require("ol/source/Raster.js"),require("ol/source/Source.js"),require("ol/source/TileJSON.js"),require("ol/source/Vector.js"),require("ol/source/VectorTile.js"),require("ol/tilegrid/TileGrid.js"),require("ol/tilegrid.js"),require("ol/events/Event.js"),require("ol/events/EventType.js")):"function"==typeof define&&define.amd?define(["exports","ol/Map.js","ol/coordinate.js","ol/extent.js","ol/functions.js","ol/render/Feature.js","ol/style/Circle.js","ol/style/Fill.js","ol/style/Icon.js","ol/style/Stroke.js","ol/style/Style.js","ol/style/Text.js","ol/color.js","ol/has.js","ol/render/canvas.js","ol","ol/TileState.js","ol/util.js","ol/View.js","ol/format/GeoJSON.js","ol/format/MVT.js","ol/layer/Group.js","ol/layer/Image.js","ol/layer/Layer.js","ol/layer/Tile.js","ol/layer/Vector.js","ol/layer/VectorTile.js","ol/loadingstrategy.js","ol/proj/Units.js","ol/proj.js","ol/source/Raster.js","ol/source/Source.js","ol/source/TileJSON.js","ol/source/Vector.js","ol/source/VectorTile.js","ol/tilegrid/TileGrid.js","ol/tilegrid.js","ol/events/Event.js","ol/events/EventType.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).olms={},e.ol.Map,e.ol.coordinate,e.ol.extent,e.ol.functions,e.ol.render.Feature,e.ol.style.Circle,e.ol.style.Fill,e.ol.style.Icon,e.ol.style.Stroke,e.ol.style.Style,e.ol.style.Text,e.ol.color,e.ol.has,e.ol.render.canvas,e.ol,e.ol.TileState,e.ol.util,e.ol.View,e.ol.format.GeoJSON,e.ol.format.MVT,e.ol.layer.Group,e.ol.layer.Image,e.ol.layer.Layer,e.ol.layer.Tile,e.ol.layer.Vector,e.ol.layer.VectorTile,e.ol.loadingstrategy,e.ol.proj.Units,e.ol.proj,e.ol.source.Raster,e.ol.source.Source,e.ol.source.TileJSON,e.ol.source.Vector,e.ol.source.VectorTile,e.ol.tilegrid.TileGrid,e.ol.tilegrid,e.ol.events.Event,e.ol.events.EventType)}(this,function(e,t,r,n,o,i,a,s,l,u,p,c,f,d,m,y,h,g,b,v,x,w,k,S,z,M,j,A,E,$,q,C,_,T,N,O,P,I,R){"use strict";var F={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const L=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function D(e,t){const r={};for(const t in e)"ref"!==t&&(r[t]=e[t]);return L.forEach(e=>{e in t&&(r[e]=t[e])}),r}function U(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=D(e[r],t[e[r].ref]));return e}class G extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class V{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[e,r]of t)this.bindings[e]=r}concat(e){return new V(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const J={kind:"null"},W={kind:"number"},Z={kind:"string"},B={kind:"boolean"},H={kind:"color"},X={kind:"projectionDefinition"},K={kind:"object"},Y={kind:"value"},Q={kind:"collator"},ee={kind:"formatted"},te={kind:"padding"},re={kind:"colorArray"},ne={kind:"numberArray"},oe={kind:"resolvedImage"},ie={kind:"variableAnchorOffsetCollection"};function ae(e,t){return{kind:"array",itemType:e,N:t}}function se(e){if("array"===e.kind){const t=se(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const le=[J,W,Z,B,H,X,ee,K,ae(Y),te,ne,re,oe,ie];function ue(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!ue(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of le)if(!ue(e,t))return null}return`Expected ${se(e)} but found ${se(t)} instead.`}function pe(e,t){return t.some(t=>t.kind===e.kind)}function ce(e,t){return t.some(t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e)}function fe(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}const de=.96422,me=.82521,ye=4/29,he=6/29,ge=3*he*he,be=he*he*he,ve=Math.PI/180,xe=180/Math.PI;function we(e){return(e%=360)<0&&(e+=360),e}function ke([e,t,r,n]){let o,i;const a=ze((.2225045*(e=Se(e))+.7168786*(t=Se(t))+.0606169*(r=Se(r)))/1);e===t&&t===r?o=i=a:(o=ze((.4360747*e+.3850649*t+.1430804*r)/de),i=ze((.0139322*e+.0971045*t+.7141733*r)/me));const s=116*a-16;return[s<0?0:s,500*(o-a),200*(a-i),n]}function Se(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ze(e){return e>be?Math.pow(e,1/3):e/ge+ye}function Me([e,t,r,n]){let o=(e+16)/116,i=isNaN(t)?o:o+t/500,a=isNaN(r)?o:o-r/200;return o=1*Ae(o),i=de*Ae(i),a=me*Ae(a),[je(3.1338561*i-1.6168667*o-.4906146*a),je(-.9787684*i+1.9161415*o+.033454*a),je(.0719453*i-.2289914*o+1.4052427*a),n]}function je(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function Ae(e){return e>he?e*e*e:ge*(e-ye)}const Ee=Object.hasOwn||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function $e(e,t){return Ee(e,t)?e[t]:void 0}function qe(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];const t=$e(Oe,e);if(t){const[e,r,n]=t;return[e/255,r/255,n/255,1]}if(e.startsWith("#")){if(/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){const t=e.length<6?1:2;let r=1;return[Ce(e.slice(r,r+=t)),Ce(e.slice(r,r+=t)),Ce(e.slice(r,r+=t)),Ce(e.slice(r,r+t)||"ff")]}}if(e.startsWith("rgb")){const t=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,r=e.match(t);if(r){const[e,t,n,o,i,a,s,l,u,p,c,f]=r,d=[o||" ",s||" ",p].join("");if("  "===d||"  /"===d||",,"===d||",,,"===d){const e=[n,a,u].join(""),r="%%%"===e?100:""===e?255:0;if(r){const e=[Te(+t/r,0,1),Te(+i/r,0,1),Te(+l/r,0,1),c?_e(+c,f):1];if(Ne(e))return e}}return}}const r=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(r){const[e,t,n,o,i,a,s,l,u]=r,p=[n||" ",i||" ",s].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){const e=[+t,Te(+o,0,100),Te(+a,0,100),l?_e(+l,u):1];if(Ne(e))return function([e,t,r,n]){function o(n){const o=(n+e/30)%12,i=t*Math.min(r,1-r);return r-i*Math.max(-1,Math.min(o-3,9-o,1))}return e=we(e),t/=100,r/=100,[o(0),o(8),o(4),n]}(e)}}}function Ce(e){return parseInt(e.padEnd(2,e),16)/255}function _e(e,t){return Te(t?e/100:e,0,1)}function Te(e,t,r){return Math.min(Math.max(t,e),r)}function Ne(e){return!e.some(Number.isNaN)}const Oe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Pe(e,t,r){return e+r*(t-e)}function Ie(e,t,r){return e.map((e,n)=>Pe(e,t[n],r))}class Re{constructor(e,t,r,n=1,o=!0){this.r=e,this.g=t,this.b=r,this.a=n,o||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,t,r,n]))}static parse(e){if(e instanceof Re)return e;if("string"!=typeof e)return;const t=qe(e);return t?new Re(...t,!1):void 0}get rgb(){const{r:e,g:t,b:r,a:n}=this,o=n||1/0;return this.overwriteGetter("rgb",[e/o,t/o,r/o,n])}get hcl(){return this.overwriteGetter("hcl",function(e){const[t,r,n,o]=ke(e),i=Math.sqrt(r*r+n*n);return[Math.round(1e4*i)?we(Math.atan2(n,r)*xe):NaN,i,t,o]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ke(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,r,n]=this.rgb;return`rgba(${[e,t,r].map(e=>Math.round(255*e)).join(",")},${n})`}static interpolate(e,t,r,n="rgb"){switch(n){case"rgb":{const[n,o,i,a]=Ie(e.rgb,t.rgb,r);return new Re(n,o,i,a,!1)}case"hcl":{const[n,o,i,a]=e.hcl,[s,l,u,p]=t.hcl;let c,f;if(isNaN(n)||isNaN(s))isNaN(n)?isNaN(s)?c=NaN:(c=s,1!==i&&0!==i||(f=l)):(c=n,1!==u&&0!==u||(f=o));else{let e=s-n;s>n&&e>180?e-=360:s<n&&n-s>180&&(e+=360),c=n+r*e}const[d,m,y,h]=function([e,t,r,n]){return e=isNaN(e)?0:e*ve,Me([r,Math.cos(e)*t,Math.sin(e)*t,n])}([c,null!=f?f:Pe(o,l,r),Pe(i,u,r),Pe(a,p,r)]);return new Re(d,m,y,h,!1)}case"lab":{const[n,o,i,a]=Me(Ie(e.lab,t.lab,r));return new Re(n,o,i,a,!1)}}}}Re.black=new Re(0,0,0,1),Re.white=new Re(1,1,1,1),Re.transparent=new Re(0,0,0,0),Re.red=new Re(1,0,0,1);class Fe{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Le=["bottom","center","top"];class De{constructor(e,t,r,n,o,i){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=o,this.verticalAlign=i}}class Ue{constructor(e){this.sections=e}static fromString(e){return new Ue([new De(e,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Ue?e:Ue.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}}class Ge{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ge)return e;if("number"==typeof e)return new Ge([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Ge(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new Ge(Ie(e.values,t.values,r))}}class Ve{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ve)return e;if("number"==typeof e)return new Ve([e]);if(Array.isArray(e)){for(const t of e)if("number"!=typeof t)return;return new Ve(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new Ve(Ie(e.values,t.values,r))}}class Je{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Je)return e;if("string"==typeof e){const t=Re.parse(e);if(!t)return;return new Je([t])}if(!Array.isArray(e))return;const t=[];for(const r of e){if("string"!=typeof r)return;const e=Re.parse(r);if(!e)return;t.push(e)}return new Je(t)}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r,n="rgb"){const o=[];if(e.values.length!=t.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${t.values.length}), cannot interpolate.`);for(let i=0;i<e.values.length;i++)o.push(Re.interpolate(e.values[i],t.values[i],r,n));return new Je(o)}}class We extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const Ze=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Be{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Be)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){const r=e[t],n=e[t+1];if("string"!=typeof r||!Ze.has(r))return;if(!Array.isArray(n)||2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])return}return new Be(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){const n=e.values,o=t.values;if(n.length!==o.length)throw new We(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const i=[];for(let e=0;e<n.length;e+=2){if(n[e]!==o[e])throw new We(`Cannot interpolate values containing mismatched anchors. from[${e}]: ${n[e]}, to[${e}]: ${o[e]}`);i.push(n[e]);const[t,a]=n[e+1],[s,l]=o[e+1];i.push([Pe(t,s,r),Pe(a,l,r)])}return new Be(i)}}class He{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new He({name:e,available:!1}):null}}class Xe{constructor(e,t,r){this.from=e,this.to=t,this.transition=r}static interpolate(e,t,r){return new Xe(e,t,r)}static parse(e){return e instanceof Xe?e:Array.isArray(e)&&3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]&&"number"==typeof e[2]?new Xe(e[0],e[1],e[2]):"object"==typeof e&&"string"==typeof e.from&&"string"==typeof e.to&&"number"==typeof e.transition?new Xe(e.from,e.to,e.transition):"string"==typeof e?new Xe(e,e,1):void 0}}function Ke(e,t,r,n){if(!("number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255)){return`Invalid rgba value [${("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}return void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: 'a' must be between 0 and 1.`}function Ye(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Xe||e instanceof Re||e instanceof Fe||e instanceof Ue||e instanceof Ge||e instanceof Ve||e instanceof Je||e instanceof Be||e instanceof He)return!0;if(Array.isArray(e)){for(const t of e)if(!Ye(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Ye(e[t]))return!1;return!0}return!1}function Qe(e){if(null===e)return J;if("string"==typeof e)return Z;if("boolean"==typeof e)return B;if("number"==typeof e)return W;if(e instanceof Re)return H;if(e instanceof Xe)return X;if(e instanceof Fe)return Q;if(e instanceof Ue)return ee;if(e instanceof Ge)return te;if(e instanceof Ve)return ne;if(e instanceof Je)return re;if(e instanceof Be)return ie;if(e instanceof He)return oe;if(Array.isArray(e)){const t=e.length;let r;for(const t of e){const e=Qe(t);if(r){if(r===e)continue;r=Y;break}r=e}return ae(r||Y,t)}return K}function et(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Re||e instanceof Xe||e instanceof Ue||e instanceof Ge||e instanceof Ve||e instanceof Je||e instanceof Be||e instanceof He?e.toString():JSON.stringify(e)}class tt{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ye(e[1]))return t.error("invalid value");const r=e[1];let n=Qe(r);const o=t.expectedType;return"array"!==n.kind||0!==n.N||!o||"array"!==o.kind||"number"==typeof o.N&&0!==o.N||(n=o),new tt(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const rt={string:Z,number:W,boolean:B,object:K};class nt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;const o=e[0];if("array"===o){let o,i;if(e.length>2){const r=e[1];if("string"!=typeof r||!(r in rt)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);o=rt[r],n++}else o=Y;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);i=e[2],n++}r=ae(o,i)}else{if(!rt[o])throw new Error(`Types doesn't contain name = ${o}`);r=rt[o]}const i=[];for(;n<e.length;n++){const r=t.parse(e[n],n,Y);if(!r)return null;i.push(r)}return new nt(r,i)}evaluate(e){for(let t=0;t<this.args.length;t++){const r=this.args[t].evaluate(e);if(!ue(this.type,Qe(r)))return r;if(t===this.args.length-1)throw new We(`Expected value to be of type ${se(this.type)}, but found ${se(Qe(r))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const ot={"to-boolean":B,"to-color":H,"to-number":W,"to-string":Z};class it{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[0];if(!ot[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");const n=ot[r],o=[];for(let r=1;r<e.length;r++){const n=t.parse(e[r],r,Y);if(!n)return null;o.push(n)}return new it(n,o)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let t,r;for(const n of this.args){if(t=n.evaluate(e),r=null,t instanceof Re)return t;if("string"==typeof t){const r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:Ke(t[0],t[1],t[2],t[3]),!r))return new Re(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new We(r||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const r of this.args){t=r.evaluate(e);const n=Ge.parse(t);if(n)return n}throw new We(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"numberArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=Ve.parse(t);if(n)return n}throw new We(`Could not parse numberArray from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"colorArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=Je.parse(t);if(n)return n}throw new We(`Could not parse colorArray from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const r of this.args){t=r.evaluate(e);const n=Be.parse(t);if(n)return n}throw new We(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const r of this.args){if(t=r.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new We(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Ue.fromString(et(this.args[0].evaluate(e)));case"resolvedImage":return He.fromString(et(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return et(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const at=["Unknown","Point","LineString","Polygon"];class st{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?at[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache.get(e);return t||(t=Re.parse(e),this._parseColorCache.set(e,t)),t}}class lt{constructor(e,t,r=[],n,o=new V,i=[]){this.registry=e,this.path=r,this.key=r.map(e=>`[${e}]`).join(""),this.scope=o,this.errors=i,this.expectedType=n,this._isConstant=t}parse(e,t,r,n,o={}){return t?this.concat(t,r,n)._parse(e,o):this._parse(e,o)}_parse(e,t){function r(e,t,r){return"assert"===r?new nt(t,[e]):"coerce"===r?new it(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const o=this.registry[n];if(o){let n=o.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,o=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==o.kind){if("projectionDefinition"===e.kind&&["string","array"].includes(o.kind)||["color","formatted","resolvedImage"].includes(e.kind)&&["value","string"].includes(o.kind)||["padding","numberArray"].includes(e.kind)&&["value","number","array"].includes(o.kind)||"colorArray"===e.kind&&["value","string","array"].includes(o.kind)||"variableAnchorOffsetCollection"===e.kind&&["value","array"].includes(o.kind))n=r(n,e,t.typeAnnotation||"coerce");else if(this.checkSubtype(e,o))return null}else n=r(n,e,t.typeAnnotation||"assert")}if(!(n instanceof tt)&&"resolvedImage"!==n.type.kind&&this._isConstant(n)){const e=new st;try{n=new tt(n.type,n.evaluate(e))}catch(e){return this.error(e.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return void 0===e?this.error("'undefined' value invalid. Use null instead."):"object"==typeof e?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){const n="number"==typeof e?this.path.concat(e):this.path,o=r?this.scope.concat(r):this.scope;return new lt(this.registry,this._isConstant,n,t||null,o,this.errors)}error(e,...t){const r=`${this.key}${t.map(e=>`[${e}]`).join("")}`;this.errors.push(new G(r,e))}checkSubtype(e,t){const r=ue(e,t);return r&&this.error(r),r}}class ut{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let n=1;n<e.length-1;n+=2){const o=e[n];if("string"!=typeof o)return t.error(`Expected string, but found ${typeof o} instead.`,n);if(/[^a-zA-Z0-9_]/.test(o))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);const i=t.parse(e[n+1],n+1);if(!i)return null;r.push([o,i])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new ut(r,n):null}outputDefined(){return this.result.outputDefined()}}class pt{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const r=e[1];return t.scope.has(r)?new pt(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class ct{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,W),n=t.parse(e[2],2,ae(t.expectedType||Y));if(!r||!n)return null;const o=n.type;return new ct(o.itemType,r,n)}evaluate(e){const t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new We(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new We(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new We(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class ft{constructor(e,t){this.type=B,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,Y),n=t.parse(e[2],2,Y);return r&&n?pe(r.type,[B,Z,W,J,Y])?new ft(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${se(r.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!ce(t,["boolean","string","number","null"]))throw new We(`Expected first argument to be of type boolean, string, number or null, but found ${se(Qe(t))} instead.`);if(!ce(r,["string","array"]))throw new We(`Expected second argument to be of type array or string, but found ${se(Qe(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class dt{constructor(e,t,r){this.type=W,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,Y),n=t.parse(e[2],2,Y);if(!r||!n)return null;if(!pe(r.type,[B,Z,W,J,Y]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${se(r.type)} instead`);if(4===e.length){const o=t.parse(e[3],3,W);return o?new dt(r,n,o):null}return new dt(r,n)}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!ce(t,["boolean","string","number","null"]))throw new We(`Expected first argument to be of type boolean, string, number or null, but found ${se(Qe(t))} instead.`);let n;if(this.fromIndex&&(n=this.fromIndex.evaluate(e)),ce(r,["string"])){const e=r.indexOf(t,n);return-1===e?-1:[...r.slice(0,e)].length}if(ce(r,["array"]))return r.indexOf(t,n);throw new We(`Expected second argument to be of type array or string, but found ${se(Qe(r))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class mt{constructor(e,t,r,n,o,i){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=o,this.otherwise=i}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const o={},i=[];for(let a=2;a<e.length-1;a+=2){let s=e[a];const l=e[a+1];Array.isArray(s)||(s=[s]);const u=t.concat(a);if(0===s.length)return u.error("Expected at least one branch label.");for(const e of s){if("number"!=typeof e&&"string"!=typeof e)return u.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,Qe(e)))return null}else r=Qe(e);if(void 0!==o[String(e)])return u.error("Branch labels must be unique.");o[String(e)]=i.length}const p=t.parse(l,a,n);if(!p)return null;n=n||p.type,i.push(p)}const a=t.parse(e[1],1,Y);if(!a)return null;const s=t.parse(e[e.length-1],e.length-1,n);return s?"value"!==a.type.kind&&t.concat(1).checkSubtype(r,a.type)?null:new mt(r,n,a,o,i,s):null}evaluate(e){const t=this.input.evaluate(e);return(Qe(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class yt{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n=[];for(let o=1;o<e.length-1;o+=2){const i=t.parse(e[o],o,B);if(!i)return null;const a=t.parse(e[o+1],o+1,r);if(!a)return null;n.push([i,a]),r=r||a.type}const o=t.parse(e[e.length-1],e.length-1,r);if(!o)return null;if(!r)throw new Error("Can't infer output type");return new yt(r,n,o)}evaluate(e){for(const[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}}class ht{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,Y),n=t.parse(e[2],2,W);if(!r||!n)return null;if(!pe(r.type,[ae(Y),Z,Y]))return t.error(`Expected first argument to be of type array or string, but found ${se(r.type)} instead`);if(4===e.length){const o=t.parse(e[3],3,W);return o?new ht(r.type,r,n,o):null}return new ht(r.type,r,n)}evaluate(e){const t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);let n;if(this.endIndex&&(n=this.endIndex.evaluate(e)),ce(t,["string"]))return[...t].slice(r,n).join("");if(ce(t,["array"]))return t.slice(r,n);throw new We(`Expected first argument to be of type array or string, but found ${se(Qe(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function gt(e,t){const r=e.length-1;let n,o,i=0,a=r,s=0;for(;i<=a;)if(s=Math.floor((i+a)/2),n=e[s],o=e[s+1],n<=t){if(s===r||t<o)return s;i=s+1}else{if(!(n>t))throw new We("Input is not a number.");a=s-1}return 0}class bt{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[e,t]of r)this.labels.push(e),this.outputs.push(t)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const r=t.parse(e[1],1,W);if(!r)return null;const n=[];let o=null;t.expectedType&&"value"!==t.expectedType.kind&&(o=t.expectedType);for(let r=1;r<e.length;r+=2){const i=1===r?-1/0:e[r],a=e[r+1],s=r,l=r+1;if("number"!=typeof i)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=i)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const u=t.parse(a,l,o);if(!u)return null;o=o||u.type,n.push([i,u])}return new bt(o,r,n)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const o=t.length;if(n>=t[o-1])return r[o-1].evaluate(e);return r[gt(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function vt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xt,wt;var kt=function(){if(wt)return xt;function e(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}return wt=1,xt=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var o=this.sampleCurveX(r)-e;if(Math.abs(o)<t)return r;var i=this.sampleCurveDerivativeX(r);if(Math.abs(i)<1e-6)break;r-=o/i}var a=0,s=1;for(r=e,n=0;n<20&&(o=this.sampleCurveX(r),!(Math.abs(o-e)<t));n++)e>o?a=r:s=r,r=.5*(s-a)+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},xt}(),St=vt(kt);class zt{constructor(e,t,r,n,o){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[e,t]of o)this.labels.push(e),this.outputs.push(t)}static interpolationFactor(e,t,r,n){let o=0;if("exponential"===e.name)o=Mt(t,e.base,r,n);else if("linear"===e.name)o=Mt(t,1,r,n);else if("cubic-bezier"===e.name){const i=e.controlPoints;o=new St(i[0],i[1],i[2],i[3]).solve(Mt(t,1,r,n))}return o}static parse(e,t){let[r,n,o,...i]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const e=n.slice(1);if(4!==e.length||e.some(e=>"number"!=typeof e||e<0||e>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(o=t.parse(o,2,W),!o)return null;const a=[];let s=null;"interpolate-hcl"!==r&&"interpolate-lab"!==r||t.expectedType==re?t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType):s=H;for(let e=0;e<i.length;e+=2){const r=i[e],n=i[e+1],o=e+3,l=e+4;if("number"!=typeof r)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(a.length&&a[a.length-1][0]>=r)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',o);const u=t.parse(n,l,s);if(!u)return null;s=s||u.type,a.push([r,u])}return fe(s,W)||fe(s,X)||fe(s,H)||fe(s,te)||fe(s,ne)||fe(s,re)||fe(s,ie)||fe(s,ae(W))?new zt(s,r,n,o,a):t.error(`Type ${se(s)} is not interpolatable.`)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const o=t.length;if(n>=t[o-1])return r[o-1].evaluate(e);const i=gt(t,n),a=t[i],s=t[i+1],l=zt.interpolationFactor(this.interpolation,n,a,s),u=r[i].evaluate(e),p=r[i+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Pe(u,p,l);case"color":return Re.interpolate(u,p,l);case"padding":return Ge.interpolate(u,p,l);case"colorArray":return Je.interpolate(u,p,l);case"numberArray":return Ve.interpolate(u,p,l);case"variableAnchorOffsetCollection":return Be.interpolate(u,p,l);case"array":return Ie(u,p,l);case"projectionDefinition":return Xe.interpolate(u,p,l)}case"interpolate-hcl":switch(this.type.kind){case"color":return Re.interpolate(u,p,l,"hcl");case"colorArray":return Je.interpolate(u,p,l,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Re.interpolate(u,p,l,"lab");case"colorArray":return Je.interpolate(u,p,l,"lab")}}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Mt(e,t,r,n){const o=n-r,i=e-r;return 0===o?0:1===t?i/o:(Math.pow(t,i)-1)/(Math.pow(t,o)-1)}class jt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);const o=[];for(const n of e.slice(1)){const e=t.parse(n,1+o.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,o.push(e)}if(!r)throw new Error("No output type");const i=n&&o.some(e=>ue(n,e.type));return new jt(i?Y:r,o)}evaluate(e){let t,r=null,n=0;for(const o of this.args)if(n++,r=o.evaluate(e),r&&r instanceof He&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function At(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Et(e,t,r,n){return 0===n.compare(t,r)}function $t(e,t,r){const n="=="!==e&&"!="!==e;return class o{constructor(e,t,r){this.type=B,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const r=e[0];let i=t.parse(e[1],1,Y);if(!i)return null;if(!At(r,i.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${se(i.type)}'.`);let a=t.parse(e[2],2,Y);if(!a)return null;if(!At(r,a.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${se(a.type)}'.`);if(i.type.kind!==a.type.kind&&"value"!==i.type.kind&&"value"!==a.type.kind)return t.error(`Cannot compare types '${se(i.type)}' and '${se(a.type)}'.`);n&&("value"===i.type.kind&&"value"!==a.type.kind?i=new nt(a.type,[i]):"value"!==i.type.kind&&"value"===a.type.kind&&(a=new nt(i.type,[a])));let s=null;if(4===e.length){if("string"!==i.type.kind&&"string"!==a.type.kind&&"value"!==i.type.kind&&"value"!==a.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,Q),!s)return null}return new o(i,a,s)}evaluate(o){const i=this.lhs.evaluate(o),a=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){const t=Qe(i),r=Qe(a);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new We(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=Qe(i),r=Qe(a);if("string"!==e.kind||"string"!==r.kind)return t(o,i,a)}return this.collator?r(o,i,a,this.collator.evaluate(o)):t(o,i,a)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const qt=$t("==",function(e,t,r){return t===r},Et),Ct=$t("!=",function(e,t,r){return t!==r},function(e,t,r,n){return!Et(0,t,r,n)}),_t=$t("<",function(e,t,r){return t<r},function(e,t,r,n){return n.compare(t,r)<0}),Tt=$t(">",function(e,t,r){return t>r},function(e,t,r,n){return n.compare(t,r)>0}),Nt=$t("<=",function(e,t,r){return t<=r},function(e,t,r,n){return n.compare(t,r)<=0}),Ot=$t(">=",function(e,t,r){return t>=r},function(e,t,r,n){return n.compare(t,r)>=0});class Pt{constructor(e,t,r){this.type=Q,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,B);if(!n)return null;const o=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,B);if(!o)return null;let i=null;return r.locale&&(i=t.parse(r.locale,1,Z),!i)?null:new Pt(n,o,i)}evaluate(e){return new Fe(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class It{constructor(e,t,r,n,o){this.type=Z,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=o}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,W);if(!r)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let o=null;if(n.locale&&(o=t.parse(n.locale,1,Z),!o))return null;let i=null;if(n.currency&&(i=t.parse(n.currency,1,Z),!i))return null;let a=null;if(n["min-fraction-digits"]&&(a=t.parse(n["min-fraction-digits"],1,W),!a))return null;let s=null;return n["max-fraction-digits"]&&(s=t.parse(n["max-fraction-digits"],1,W),!s)?null:new It(r,o,i,a,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Rt{constructor(e){this.type=ee,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");const n=[];let o=!1;for(let r=1;r<=e.length-1;++r){const i=e[r];if(o&&"object"==typeof i&&!Array.isArray(i)){o=!1;let e=null;if(i["font-scale"]&&(e=t.parse(i["font-scale"],1,W),!e))return null;let r=null;if(i["text-font"]&&(r=t.parse(i["text-font"],1,ae(Z)),!r))return null;let a=null;if(i["text-color"]&&(a=t.parse(i["text-color"],1,H),!a))return null;let s=null;if(i["vertical-align"]){if("string"==typeof i["vertical-align"]&&!Le.includes(i["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${i["vertical-align"]}' instead.`);if(s=t.parse(i["vertical-align"],1,Z),!s)return null}const l=n[n.length-1];l.scale=e,l.font=r,l.textColor=a,l.verticalAlign=s}else{const i=t.parse(e[r],1,Y);if(!i)return null;const a=i.type.kind;if("string"!==a&&"value"!==a&&"null"!==a&&"resolvedImage"!==a)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,n.push({content:i,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Rt(n)}evaluate(e){return new Ue(this.sections.map(t=>{const r=t.content.evaluate(e);return Qe(r)===oe?new De("",r,null,null,null,t.verticalAlign?t.verticalAlign.evaluate(e):null):new De(et(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null,t.verticalAlign?t.verticalAlign.evaluate(e):null)}))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class Ft{constructor(e){this.type=oe,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,Z);return r?new Ft(r):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),r=He.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class Lt{constructor(e){this.type=W,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${se(r.type)} instead.`):new Lt(r):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return[...t].length;if(Array.isArray(t))return t.length;throw new We(`Expected value to be of type string or array, but found ${se(Qe(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Dt=8192;function Ut(e,t){const r=(180+e[0])/360;const n=(o=e[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360);var o;const i=Math.pow(2,t.z);return[Math.round(r*i*Dt),Math.round(n*i*Dt)]}function Gt(e,t){const r=Math.pow(2,t.z),n=(e[0]/Dt+t.x)/r,o=(e[1]/Dt+t.y)/r;return[(a=n,360*a-180),(i=o,360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90)];var i,a}function Vt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Jt(e,t){return!(e[0]<=t[0])&&(!(e[2]>=t[2])&&(!(e[1]<=t[1])&&!(e[3]>=t[3])))}function Wt(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function Zt(e,t,r){const n=e[0]-t[0],o=e[1]-t[1],i=e[0]-r[0],a=e[1]-r[1];return n*a-i*o===0&&n*i<=0&&o*a<=0}function Bt(e,t,r,n){const o=[t[0]-e[0],t[1]-e[1]],i=[n[0]-r[0],n[1]-r[1]];return 0!==(a=i)[0]*(s=o)[1]-a[1]*s[0]&&!(!er(e,t,r,n)||!er(r,n,e,t));var a,s}function Ht(e,t,r){for(const n of r)for(let r=0;r<n.length-1;++r)if(Bt(e,t,n[r],n[r+1]))return!0;return!1}function Xt(e,t,r=!1){let n=!1;for(const o of t)for(let t=0;t<o.length-1;t++){if(Zt(e,o[t],o[t+1]))return r;Wt(e,o[t],o[t+1])&&(n=!n)}return n}function Kt(e,t){for(const r of t)if(Xt(e,r))return!0;return!1}function Yt(e,t){for(const r of e)if(!Xt(r,t))return!1;for(let r=0;r<e.length-1;++r)if(Ht(e[r],e[r+1],t))return!1;return!0}function Qt(e,t){for(const r of t)if(Yt(e,r))return!0;return!1}function er(e,t,r,n){const o=e[0]-r[0],i=e[1]-r[1],a=t[0]-r[0],s=t[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],p=o*u-l*i,c=a*u-l*s;return p>0&&c<0||p<0&&c>0}function tr(e,t,r){const n=[];for(let o=0;o<e.length;o++){const i=[];for(let n=0;n<e[o].length;n++){const a=Ut(e[o][n],r);Vt(t,a),i.push(a)}n.push(i)}return n}function rr(e,t,r){const n=[];for(let o=0;o<e.length;o++){const i=tr(e[o],t,r);n.push(i)}return n}function nr(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){const t=.5*n;let o=e[0]-r[0]>t?-n:r[0]-e[0]>t?n:0;0===o&&(o=e[0]-r[2]>t?-n:r[2]-e[0]>t?n:0),e[0]+=o}Vt(t,e)}function or(e,t,r,n){const o=Math.pow(2,n.z)*Dt,i=[n.x*Dt,n.y*Dt],a=[];for(const n of e)for(const e of n){const n=[e.x+i[0],e.y+i[1]];nr(n,t,r,o),a.push(n)}return a}function ir(e,t,r,n){const o=Math.pow(2,n.z)*Dt,i=[n.x*Dt,n.y*Dt],a=[];for(const r of e){const e=[];for(const n of r){const r=[n.x+i[0],n.y+i[1]];Vt(t,r),e.push(r)}a.push(e)}if(t[2]-t[0]<=o/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of a)for(const n of e)nr(n,t,r,o)}var s;return a}class ar{constructor(e,t){this.type=B,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ye(e[1])){const t=e[1];if("FeatureCollection"===t.type){const e=[];for(const r of t.features){const{type:t,coordinates:n}=r.geometry;"Polygon"===t&&e.push(n),"MultiPolygon"===t&&e.push(...n)}if(e.length){return new ar(t,{type:"MultiPolygon",coordinates:e})}}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new ar(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new ar(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],o=e.canonicalID();if("Polygon"===t.type){const i=tr(t.coordinates,n,o),a=or(e.geometry(),r,n,o);if(!Jt(r,n))return!1;for(const e of a)if(!Xt(e,i))return!1}if("MultiPolygon"===t.type){const i=rr(t.coordinates,n,o),a=or(e.geometry(),r,n,o);if(!Jt(r,n))return!1;for(const e of a)if(!Kt(e,i))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],o=e.canonicalID();if("Polygon"===t.type){const i=tr(t.coordinates,n,o),a=ir(e.geometry(),r,n,o);if(!Jt(r,n))return!1;for(const e of a)if(!Yt(e,i))return!1}if("MultiPolygon"===t.type){const i=rr(t.coordinates,n,o),a=ir(e.geometry(),r,n,o);if(!Jt(r,n))return!1;for(const e of a)if(!Qt(e,i))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class sr{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const o=e-1>>1,i=t[o];if(r(n,i)>=0)break;t[e]=i,e=o}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,o=t[e];for(;e<n;){let n=1+(e<<1);const i=n+1;if(i<this.length&&r(t[i],t[n])<0&&(n=i),r(t[n],o)>=0)break;t[e]=t[n],e=n}t[e]=o}}function lr(e){let t=0;for(let r,n,o=0,i=e.length,a=i-1;o<i;a=o++)r=e[o],n=e[a],t+=(n.x-r.x)*(r.y+n.y);return t}const ur=1/298.257223563,pr=ur*(2-ur),cr=Math.PI/180;class fr{constructor(e){const t=6378.137*cr*1e3,r=Math.cos(e*cr),n=1/(1-pr*(1-r*r)),o=Math.sqrt(n);this.kx=t*o*r,this.ky=t*o*n*(1-pr)}distance(e,t){const r=this.wrap(e[0]-t[0])*this.kx,n=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+n*n)}pointOnLine(e,t){let r,n,o,i,a=1/0;for(let s=0;s<e.length-1;s++){let l=e[s][0],u=e[s][1],p=this.wrap(e[s+1][0]-l)*this.kx,c=(e[s+1][1]-u)*this.ky,f=0;0===p&&0===c||(f=(this.wrap(t[0]-l)*this.kx*p+(t[1]-u)*this.ky*c)/(p*p+c*c),f>1?(l=e[s+1][0],u=e[s+1][1]):f>0&&(l+=p/this.kx*f,u+=c/this.ky*f)),p=this.wrap(t[0]-l)*this.kx,c=(t[1]-u)*this.ky;const d=p*p+c*c;d<a&&(a=d,r=l,n=u,o=s,i=f)}return{point:[r,n],index:o,t:Math.max(0,Math.min(1,i))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function dr(e,t){return t[0]-e[0]}function mr(e){return e[1]-e[0]+1}function yr(e,t){return e[1]>=e[0]&&e[1]<t}function hr(e,t){if(e[0]>e[1])return[null,null];const r=mr(e);if(t){if(2===r)return[e,null];const t=Math.floor(r/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===r)return[e,null];const n=Math.floor(r/2)-1;return[[e[0],e[0]+n],[e[0]+n+1,e[1]]]}function gr(e,t){if(!yr(t,e.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let n=t[0];n<=t[1];++n)Vt(r,e[n]);return r}function br(e){const t=[1/0,1/0,-1/0,-1/0];for(const r of e)for(const e of r)Vt(t,e);return t}function vr(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function xr(e,t,r){if(!vr(e)||!vr(t))return NaN;let n=0,o=0;return e[2]<t[0]&&(n=t[0]-e[2]),e[0]>t[2]&&(n=e[0]-t[2]),e[1]>t[3]&&(o=e[1]-t[3]),e[3]<t[1]&&(o=t[1]-e[3]),r.distance([0,0],[n,o])}function wr(e,t,r){const n=r.pointOnLine(t,e);return r.distance(e,n.point)}function kr(e,t,r,n,o){const i=Math.min(wr(e,[r,n],o),wr(t,[r,n],o)),a=Math.min(wr(r,[e,t],o),wr(n,[e,t],o));return Math.min(i,a)}function Sr(e,t,r,n,o){if(!(yr(t,e.length)&&yr(n,r.length)))return 1/0;let i=1/0;for(let a=t[0];a<t[1];++a){const t=e[a],s=e[a+1];for(let e=n[0];e<n[1];++e){const n=r[e],a=r[e+1];if(Bt(t,s,n,a))return 0;i=Math.min(i,kr(t,s,n,a,o))}}return i}function zr(e,t,r,n,o){if(!(yr(t,e.length)&&yr(n,r.length)))return NaN;let i=1/0;for(let a=t[0];a<=t[1];++a)for(let t=n[0];t<=n[1];++t)if(i=Math.min(i,o.distance(e[a],r[t])),0===i)return i;return i}function Mr(e,t,r){if(Xt(e,t,!0))return 0;let n=1/0;for(const o of t){const t=o[0],i=o[o.length-1];if(t!==i&&(n=Math.min(n,wr(e,[i,t],r)),0===n))return n;const a=r.pointOnLine(o,e);if(n=Math.min(n,r.distance(e,a.point)),0===n)return n}return n}function jr(e,t,r,n){if(!yr(t,e.length))return NaN;for(let n=t[0];n<=t[1];++n)if(Xt(e[n],r,!0))return 0;let o=1/0;for(let i=t[0];i<t[1];++i){const t=e[i],a=e[i+1];for(const e of r)for(let r=0,i=e.length,s=i-1;r<i;s=r++){const i=e[s],l=e[r];if(Bt(t,a,i,l))return 0;o=Math.min(o,kr(t,a,i,l,n))}}return o}function Ar(e,t){for(const r of e)for(const e of r)if(Xt(e,t,!0))return!0;return!1}function Er(e,t,r,n=1/0){const o=br(e),i=br(t);if(n!==1/0&&xr(o,i,r)>=n)return n;if(Jt(o,i)){if(Ar(e,t))return 0}else if(Ar(t,e))return 0;let a=1/0;for(const n of e)for(let e=0,o=n.length,i=o-1;e<o;i=e++){const o=n[i],s=n[e];for(const e of t)for(let t=0,n=e.length,i=n-1;t<n;i=t++){const n=e[i],l=e[t];if(Bt(o,s,n,l))return 0;a=Math.min(a,kr(o,s,n,l,r))}}return a}function $r(e,t,r,n,o,i){if(!i)return;const a=xr(gr(n,i),o,r);a<t&&e.push([a,i,[0,0]])}function qr(e,t,r,n,o,i,a){if(!i||!a)return;const s=xr(gr(n,i),gr(o,a),r);s<t&&e.push([s,i,a])}function Cr(e,t,r,n,o=1/0){let i=Math.min(n.distance(e[0],r[0][0]),o);if(0===i)return i;const a=new sr([[0,[0,e.length-1],[0,0]]],dr),s=br(r);for(;a.length>0;){const o=a.pop();if(o[0]>=i)continue;const l=o[1],u=t?50:100;if(mr(l)<=u){if(!yr(l,e.length))return NaN;if(t){const t=jr(e,l,r,n);if(isNaN(t)||0===t)return t;i=Math.min(i,t)}else for(let t=l[0];t<=l[1];++t){const o=Mr(e[t],r,n);if(i=Math.min(i,o),0===i)return 0}}else{const r=hr(l,t);$r(a,i,n,e,s,r[0]),$r(a,i,n,e,s,r[1])}}return i}function _r(e,t,r,n,o,i=1/0){let a=Math.min(i,o.distance(e[0],r[0]));if(0===a)return a;const s=new sr([[0,[0,e.length-1],[0,r.length-1]]],dr);for(;s.length>0;){const i=s.pop();if(i[0]>=a)continue;const l=i[1],u=i[2],p=t?50:100,c=n?50:100;if(mr(l)<=p&&mr(u)<=c){if(!yr(l,e.length)&&yr(u,r.length))return NaN;let i;if(t&&n)i=Sr(e,l,r,u,o),a=Math.min(a,i);else if(t&&!n){const t=e.slice(l[0],l[1]+1);for(let e=u[0];e<=u[1];++e)if(i=wr(r[e],t,o),a=Math.min(a,i),0===a)return a}else if(!t&&n){const t=r.slice(u[0],u[1]+1);for(let r=l[0];r<=l[1];++r)if(i=wr(e[r],t,o),a=Math.min(a,i),0===a)return a}else i=zr(e,l,r,u,o),a=Math.min(a,i)}else{const i=hr(l,t),p=hr(u,n);qr(s,a,o,e,r,i[0],p[0]),qr(s,a,o,e,r,i[0],p[1]),qr(s,a,o,e,r,i[1],p[0]),qr(s,a,o,e,r,i[1],p[1])}}return a}function Tr(e,t){const r=e.geometry();if(0===r.length||0===r[0].length)return NaN;const n=function(e){if(e.length<=1)return[e];const t=[];let r,n;for(const o of e){const e=lr(o);0!==e&&(o.area=Math.abs(e),void 0===n&&(n=e<0),n===e<0?(r&&t.push(r),r=[o]):r.push(o))}return r&&t.push(r),t}(r).map(t=>t.map(t=>t.map(t=>Gt([t.x,t.y],e.canonical)))),o=new fr(n[0][0][0][1]);let i=1/0;for(const e of t)for(const t of n){switch(e.type){case"Point":i=Math.min(i,Cr([e.coordinates],!1,t,o,i));break;case"LineString":i=Math.min(i,Cr(e.coordinates,!0,t,o,i));break;case"Polygon":i=Math.min(i,Er(t,e.coordinates,o,i))}if(0===i)return i}return i}function Nr(e){return"MultiPolygon"===e.type?e.coordinates.map(e=>({type:"Polygon",coordinates:e})):"MultiLineString"===e.type?e.coordinates.map(e=>({type:"LineString",coordinates:e})):"MultiPoint"===e.type?e.coordinates.map(e=>({type:"Point",coordinates:e})):[e]}class Or{constructor(e,t){this.type=W,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ye(e[1])){const t=e[1];if("FeatureCollection"===t.type)return new Or(t,t.features.map(e=>Nr(e.geometry)).flat());if("Feature"===t.type)return new Or(t,Nr(t.geometry));if("type"in t&&"coordinates"in t)return new Or(t,Nr(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map(t=>Gt([t.x,t.y],e.canonical));if(0===r.length)return NaN;const o=new fr(n[0][1]);let i=1/0;for(const e of t){switch(e.type){case"Point":i=Math.min(i,_r(n,!1,[e.coordinates],!1,o,i));break;case"LineString":i=Math.min(i,_r(n,!1,e.coordinates,!0,o,i));break;case"Polygon":i=Math.min(i,Cr(n,!1,e.coordinates,o,i))}if(0===i)return i}return i}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map(t=>Gt([t.x,t.y],e.canonical));if(0===r.length)return NaN;const o=new fr(n[0][1]);let i=1/0;for(const e of t){switch(e.type){case"Point":i=Math.min(i,_r(n,!0,[e.coordinates],!1,o,i));break;case"LineString":i=Math.min(i,_r(n,!0,e.coordinates,!0,o,i));break;case"Polygon":i=Math.min(i,Cr(n,!0,e.coordinates,o,i))}if(0===i)return i}return i}(e,this.geometries);if("Polygon"===e.geometryType())return Tr(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Pr{constructor(e){this.type=Y,this.key=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=e[1];return null==r?t.error("Global state property must be defined."):"string"!=typeof r?t.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new Pr(r)}evaluate(e){var t;const r=null===(t=e.globals)||void 0===t?void 0:t.globalState;return r&&0!==Object.keys(r).length?$e(r,this.key):null}eachChild(){}outputDefined(){return!1}}const Ir={"==":qt,"!=":Ct,">":Tt,"<":_t,">=":Ot,"<=":Nt,array:nt,at:ct,boolean:nt,case:yt,coalesce:jt,collator:Pt,format:Rt,image:Ft,in:ft,"index-of":dt,interpolate:zt,"interpolate-hcl":zt,"interpolate-lab":zt,length:Lt,let:ut,literal:tt,match:mt,number:nt,"number-format":It,object:nt,slice:ht,step:bt,string:nt,"to-boolean":it,"to-color":it,"to-number":it,"to-string":it,var:pt,within:ar,distance:Or,"global-state":Pr};class Rr{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const r=e[0],n=Rr.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const o=Array.isArray(n)?n[0]:n.type,i=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,a=i.filter(([t])=>!Array.isArray(t)||t.length===e.length-1);let s=null;for(const[n,i]of a){s=new lt(t.registry,Gr,t.path,null,t.scope);const a=[];let l=!1;for(let t=1;t<e.length;t++){const r=e[t],o=Array.isArray(n)?n[t-1]:n.type,i=s.parse(r,1+a.length,o);if(!i){l=!0;break}a.push(i)}if(!l)if(Array.isArray(n)&&n.length!==a.length)s.error(`Expected ${n.length} arguments, but found ${a.length} instead.`);else{for(let e=0;e<a.length;e++){const t=Array.isArray(n)?n[e]:n.type,r=a[e];s.concat(e+1).checkSubtype(t,r.type)}if(0===s.errors.length)return new Rr(r,o,i,a)}}if(1===a.length)t.errors.push(...s.errors);else{const r=(a.length?a:i).map(([e])=>{return t=e,Array.isArray(t)?`(${t.map(se).join(", ")})`:`(${se(t.type)}...)`;var t}).join(" | "),n=[];for(let r=1;r<e.length;r++){const o=t.parse(e[r],1+n.length);if(!o)return null;n.push(se(o.type))}t.error(`Expected arguments of type ${r}, but found (${n.join(", ")}) instead.`)}return null}static register(e,t){Rr.definitions=t;for(const r in t)e[r]=Rr}}function Fr(e,[t,r,n,o]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const i=o?o.evaluate(e):1,a=Ke(t,r,n,i);if(a)throw new We(a);return new Re(t/255,r/255,n/255,i,!1)}function Lr(e,t){return e in t}function Dr(e,t){const r=t[e];return void 0===r?null:r}function Ur(e){return{type:e}}function Gr(e){if(e instanceof pt)return Gr(e.boundExpression);if(e instanceof Rr&&"error"===e.name)return!1;if(e instanceof Pt)return!1;if(e instanceof ar)return!1;if(e instanceof Or)return!1;if(e instanceof Pr)return!1;const t=e instanceof it||e instanceof nt;let r=!0;return e.eachChild(e=>{r=t?r&&Gr(e):r&&e instanceof tt}),!!r&&(Vr(e)&&Wr(e,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]))}function Vr(e){if(e instanceof Rr){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof ar)return!1;if(e instanceof Or)return!1;let t=!0;return e.eachChild(e=>{t&&!Vr(e)&&(t=!1)}),t}function Jr(e){if(e instanceof Rr&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(e=>{t&&!Jr(e)&&(t=!1)}),t}function Wr(e,t){if(e instanceof Rr&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(e=>{r&&!Wr(e,t)&&(r=!1)}),r}function Zr(e){return{result:"success",value:e}}function Br(e){return{result:"error",value:e}}function Hr(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&Qe(e)===K}Rr.register(Ir,{error:[{kind:"error"},[Z],(e,[t])=>{throw new We(t.evaluate(e))}],typeof:[Z,[Y],(e,[t])=>se(Qe(t.evaluate(e)))],"to-rgba":[ae(W,4),[H],(e,[t])=>{const[r,n,o,i]=t.evaluate(e).rgb;return[255*r,255*n,255*o,i]}],rgb:[H,[W,W,W],Fr],rgba:[H,[W,W,W,W],Fr],has:{type:B,overloads:[[[Z],(e,[t])=>Lr(t.evaluate(e),e.properties())],[[Z,K],(e,[t,r])=>Lr(t.evaluate(e),r.evaluate(e))]]},get:{type:Y,overloads:[[[Z],(e,[t])=>Dr(t.evaluate(e),e.properties())],[[Z,K],(e,[t,r])=>Dr(t.evaluate(e),r.evaluate(e))]]},"feature-state":[Y,[Z],(e,[t])=>Dr(t.evaluate(e),e.featureState||{})],properties:[K,[],e=>e.properties()],"geometry-type":[Z,[],e=>e.geometryType()],id:[Y,[],e=>e.id()],zoom:[W,[],e=>e.globals.zoom],"heatmap-density":[W,[],e=>e.globals.heatmapDensity||0],elevation:[W,[],e=>e.globals.elevation||0],"line-progress":[W,[],e=>e.globals.lineProgress||0],accumulated:[Y,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[W,Ur(W),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[W,Ur(W),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:W,overloads:[[[W,W],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[W],(e,[t])=>-t.evaluate(e)]]},"/":[W,[W,W],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[W,[W,W],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[W,[],()=>Math.LN2],pi:[W,[],()=>Math.PI],e:[W,[],()=>Math.E],"^":[W,[W,W],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[W,[W],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[W,[W],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[W,[W],(e,[t])=>Math.log(t.evaluate(e))],log2:[W,[W],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[W,[W],(e,[t])=>Math.sin(t.evaluate(e))],cos:[W,[W],(e,[t])=>Math.cos(t.evaluate(e))],tan:[W,[W],(e,[t])=>Math.tan(t.evaluate(e))],asin:[W,[W],(e,[t])=>Math.asin(t.evaluate(e))],acos:[W,[W],(e,[t])=>Math.acos(t.evaluate(e))],atan:[W,[W],(e,[t])=>Math.atan(t.evaluate(e))],min:[W,Ur(W),(e,t)=>Math.min(...t.map(t=>t.evaluate(e)))],max:[W,Ur(W),(e,t)=>Math.max(...t.map(t=>t.evaluate(e)))],abs:[W,[W],(e,[t])=>Math.abs(t.evaluate(e))],round:[W,[W],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[W,[W],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[W,[W],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[B,[Z,Y],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[B,[Y],(e,[t])=>e.id()===t.value],"filter-type-==":[B,[Z],(e,[t])=>e.geometryType()===t.value],"filter-<":[B,[Z,Y],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n==typeof o&&n<o}],"filter-id-<":[B,[Y],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[B,[Z,Y],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n==typeof o&&n>o}],"filter-id->":[B,[Y],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[B,[Z,Y],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n==typeof o&&n<=o}],"filter-id-<=":[B,[Y],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[B,[Z,Y],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n==typeof o&&n>=o}],"filter-id->=":[B,[Y],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[B,[Y],(e,[t])=>t.value in e.properties()],"filter-has-id":[B,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[B,[ae(Z)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[B,[ae(Y)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[B,[Z,ae(Y)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[B,[Z,ae(Y)],(e,[t,r])=>function(e,t,r,n){for(;r<=n;){const o=r+n>>1;if(t[o]===e)return!0;t[o]>e?n=o-1:r=o+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:B,overloads:[[[B,B],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Ur(B),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:B,overloads:[[[B,B],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Ur(B),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[B,[B],(e,[t])=>!t.evaluate(e)],"is-supported-script":[B,[Z],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[Z,[Z],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[Z,[Z],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[Z,Ur(Y),(e,t)=>t.map(t=>et(t.evaluate(e))).join("")],"resolved-locale":[Z,[Q],(e,[t])=>t.evaluate(e).resolvedLocale()]});class Xr{constructor(e,t,r){this.expression=e,this._warningHistory={},this._evaluator=new st,this._defaultValue=t?function(e){if("color"===e.type&&Hr(e.default))return new Re(0,0,0,0);switch(e.type){case"color":return Re.parse(e.default)||null;case"padding":return Ge.parse(e.default)||null;case"numberArray":return Ve.parse(e.default)||null;case"colorArray":return Je.parse(e.default)||null;case"variableAnchorOffsetCollection":return Be.parse(e.default)||null;case"projectionDefinition":return Xe.parse(e.default)||null;default:return void 0===e.default?null:e.default}}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null,this._globalState=r}evaluateWithoutErrorHandling(e,t,r,n,o,i){return this._globalState&&(e=on(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=i,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,o,i){this._globalState&&(e=on(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=i||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new We(`Expected value to be one of ${Object.keys(this._enumValues).map(e=>JSON.stringify(e)).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function Kr(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Ir}function Yr(e,t,r){const n=new lt(Ir,Gr,[],t?function(e){const t={color:H,string:Z,number:W,enum:Z,boolean:B,formatted:ee,padding:te,numberArray:ne,colorArray:re,projectionDefinition:X,resolvedImage:oe,variableAnchorOffsetCollection:ie};if("array"===e.type)return ae(t[e.value]||Y,e.length);return t[e.type]}(t):void 0),o=n.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return o?Zr(new Xr(o,t,r)):Br(n.errors)}class Qr{constructor(e,t,r){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Jr(t.expression),this.globalStateRefs=nn(t.expression),this._globalState=r}evaluateWithoutErrorHandling(e,t,r,n,o,i){return this._globalState&&(e=on(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,o,i)}evaluate(e,t,r,n,o,i){return this._globalState&&(e=on(e,this._globalState)),this._styleExpression.evaluate(e,t,r,n,o,i)}}class en{constructor(e,t,r,n,o){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Jr(t.expression),this.globalStateRefs=nn(t.expression),this.interpolationType=n,this._globalState=o}evaluateWithoutErrorHandling(e,t,r,n,o,i){return this._globalState&&(e=on(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,o,i)}evaluate(e,t,r,n,o,i){return this._globalState&&(e=on(e,this._globalState)),this._styleExpression.evaluate(e,t,r,n,o,i)}interpolationFactor(e,t,r){return this.interpolationType?zt.interpolationFactor(this.interpolationType,e,t,r):0}}function tn(e,t,r){const n=Yr(e,t,r);if("error"===n.result)return n;const o=n.value.expression,i=Vr(o);if(!i&&("data-driven"!==(a=t)["property-type"]&&"cross-faded-data-driven"!==a["property-type"]))return Br([new G("","data expressions not supported")]);var a;const s=Wr(o,["zoom"]);if(!s&&!function(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}(t))return Br([new G("","zoom expressions not supported")]);const l=rn(o);if(!l&&!s)return Br([new G("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(l instanceof G)return Br([l]);if(l instanceof zt&&!function(e){return!!e.expression&&e.expression.interpolated}(t))return Br([new G("",'"interpolate" expressions cannot be used with this property')]);if(!l)return Zr(new Qr(i?"constant":"source",n.value,r));const u=l instanceof zt?l.interpolation:void 0;return Zr(new en(i?"camera":"composite",n.value,l.labels,u,r))}function rn(e){let t=null;if(e instanceof ut)t=rn(e.result);else if(e instanceof jt){for(const r of e.args)if(t=rn(r),t)break}else(e instanceof bt||e instanceof zt)&&e.input instanceof Rr&&"zoom"===e.input.name&&(t=e);return t instanceof G||e.eachChild(e=>{const r=rn(e);r instanceof G?t=r:!t&&r?t=new G("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new G("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function nn(e,t=new Set){return e instanceof Pr&&t.add(e.key),e.eachChild(e=>{nn(e,t)}),t}function on(e,t){const{zoom:r,heatmapDensity:n,elevation:o,lineProgress:i,isSupportedScript:a,accumulated:s}=null!=e?e:{};return{zoom:r,heatmapDensity:n,elevation:o,lineProgress:i,isSupportedScript:a,accumulated:s,globalState:t}}function an(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!an(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const sn={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ln(e,t){if(null==e)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};an(e)||(e=cn(e));const r=Yr(e,sn,t);if("error"===r.result)throw new Error(r.value.map(e=>`${e.key}: ${e.message}`).join(", "));return{filter:(e,t,n)=>r.value.evaluate(e,t,{},n),needGeometry:pn(e),getGlobalStateRefs:()=>nn(r.value.expression)}}function un(e,t){return e<t?-1:e>t?1:0}function pn(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(pn(e[t]))return!0;return!1}function cn(e){if(!e)return!0;const t=e[0];if(e.length<=1)return"any"!==t;var r;return"=="===t?fn(e[1],e[2],"=="):"!="===t?yn(fn(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?fn(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(cn))):"all"===t?["all"].concat(e.slice(1).map(cn)):"none"===t?["all"].concat(e.slice(1).map(cn).map(yn)):"in"===t?dn(e[1],e.slice(2)):"!in"===t?yn(dn(e[1],e.slice(2))):"has"===t?mn(e[1]):"!has"!==t||yn(mn(e[1]))}function fn(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function dn(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!=typeof t[0])?["filter-in-large",e,["literal",t.sort(un)]]:["filter-in-small",e,["literal",t]]}}function mn(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function yn(e){return["!",e]}function hn(e){return"object"==typeof e?["literal",e]:e}function gn(e,t){let r=e.stops;if(!r)return function(e,t){const r=["get",e.property];if(void 0===e.default)return"string"===t.type?["string",r]:r;if("enum"===t.type)return["match",r,Object.keys(t.values),r,e.default];{const n=["color"===t.type?"to-color":t.type,r,hn(e.default)];return"array"===t.type&&n.splice(1,0,t.value,t.length||null),n}}(e,t);const n=r&&"object"==typeof r[0][0],o=n||void 0!==e.property,i=n||!o;return r=r.map(e=>!o&&t.tokens&&"string"==typeof e[1]?[e[0],zn(e[1])]:[e[0],hn(e[1])]),n?function(e,t,r){const n={},o={},i=[];for(let t=0;t<r.length;t++){const a=r[t],s=a[0].zoom;void 0===n[s]&&(n[s]={zoom:s,type:e.type,property:e.property,default:e.default},o[s]=[],i.push(s)),o[s].push([a[0].value,a[1]])}const a=Sn({},t);if("exponential"===a){const r=[bn(e),["linear"],["zoom"]];for(const e of i){kn(r,e,xn(n[e],t,o[e]),!1)}return r}{const e=["step",["zoom"]];for(const r of i){kn(e,r,xn(n[r],t,o[r]),!0)}return wn(e),e}}(e,t,r):i?function(e,t,r,n=["zoom"]){const o=Sn(e,t);let i,a=!1;if("interval"===o)i=["step",n],a=!0;else{if("exponential"!==o)throw new Error(`Unknown zoom function type "${o}"`);{const t=void 0!==e.base?e.base:1;i=[bn(e),1===t?["linear"]:["exponential",t],n]}}for(const e of r)kn(i,e[0],e[1],a);return wn(i),i}(e,t,r):xn(e,t,r)}function bn(e){switch(e.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function vn(e,t){const r=hn((n=e.default,o=t.default,void 0!==n?n:void 0!==o?o:void 0));var n,o;return void 0===r&&"resolvedImage"===t.type?"":r}function xn(e,t,r){const n=Sn(e,t),o=["get",e.property];if("categorical"===n&&"boolean"==typeof r[0][0]){const n=["case"];for(const e of r)n.push(["==",o,e[0]],e[1]);return n.push(vn(e,t)),n}if("categorical"===n){const n=["match",o];for(const e of r)kn(n,e[0],e[1],!1);return n.push(vn(e,t)),n}if("interval"===n){const t=["step",["number",o]];for(const e of r)kn(t,e[0],e[1],!0);return wn(t),void 0===e.default?t:["case",["==",["typeof",o],"number"],t,hn(e.default)]}if("exponential"===n){const t=void 0!==e.base?e.base:1,n=[bn(e),1===t?["linear"]:["exponential",t],["number",o]];for(const e of r)kn(n,e[0],e[1],!1);return void 0===e.default?n:["case",["==",["typeof",o],"number"],n,hn(e.default)]}throw new Error(`Unknown property function type ${n}`)}function wn(e){"step"===e[0]&&3===e.length&&(e.push(0),e.push(e[3]))}function kn(e,t,r,n){e.length>3&&t===e[e.length-2]||(n&&2===e.length||e.push(t),e.push(r))}function Sn(e,t){return e.type?e.type:t.expression.interpolated?"exponential":"interval"}function zn(e){const t=["concat"],r=/{([^{}]+)}/g;let n=0;for(let o=r.exec(e);null!==o;o=r.exec(e)){const i=e.slice(n,r.lastIndex-o[0].length);n=r.lastIndex,i.length>0&&t.push(i),t.push(["get",o[1]])}if(1===t.length)return e;if(n<e.length)t.push(e.slice(n));else if(2===t.length)return["to-string",t[1]];return t}const Mn=F;var jn={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},An=" ",En=/(italic|oblique)$/i,$n={};function qn(e,t,r){var n=$n[e];if(!n){Array.isArray(e)||(e=[e]);for(var o,i,a=400,s="normal",l=[],u=0,p=e.length;u<p;++u){var c=e[u].split(" "),f=c[c.length-1].toLowerCase();for(var d in"normal"==f||"italic"==f||"oblique"==f?(s=i?s:f,i=!0,c.pop(),f=c[c.length-1].toLowerCase()):En.test(f)&&(f=f.replace(En,""),s=i?s:c[c.length-1].replace(f,""),i=!0),jn){var m=c.length>1?c[c.length-2].toLowerCase():"";if(f==d||f==d.replace("-","")||m+"-"+f==d){a=o?a:jn[d],c.pop(),m&&d.startsWith(m)&&c.pop();break}}o||"number"!=typeof f||(a=f,o=!0);var y=c.join(An).replace("Klokantech Noto Sans","Noto Sans").replace("DIN Pro","Barlow").replace("Arial Unicode MS","Arial");-1!==y.indexOf(An)&&(y='"'+y+'"'),l.push(y)}n=$n[e]=[s,a,l]}return n[0]+An+n[1]+An+t+"px"+(r?"/"+r:"")+An+n[2]}function Cn(e,[t,r,n,o]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const i=o?o.evaluate(e):1;return Re.parse(`hsla(${t}, ${r}%, ${n}%, ${i})`)}function _n(e){if(Array.isArray(e)){if(0===e.length)return e;const t=e[0];if("literal"===t)return e;if("image"===t&&3===e.length&&"object"==typeof e[2]&&null!==e[2]&&!Array.isArray(e[2])){return["image-config",_n(e[1]),["literal",e[2]]]}const r=e.length;for(let n=1;n<r;++n){const o=e[n],i=_n(o);if(i!==o){const o=[t];for(let t=1;t<n;++t)o.push(e[t]);o.push(i);for(let t=n+1;t<r;++t)o.push(_n(e[t]));return o}}}return e}const Tn={},Nn={zoom:0,distanceFromCenter:0};Rr.register(Ir,{...Rr.definitions,pitch:[{kind:"number"},[],e=>Nn.pitch||0],"distance-from-center":[{kind:"number"},[],e=>Nn.distanceFromCenter||0],"to-hsla":[{kind:"array",itemType:{kind:"number"},N:4},[{kind:"string"}],(e,[t])=>function(e){const t=e[0]/255,r=e[1]/255,n=e[2]/255,o=e[3],i=Math.max(t,r,n),a=Math.min(t,r,n),s=(i+a)/2;let l,u;if(i===a)l=0,u=0;else{const e=i-a;switch(u=s>.5?e/(2-i-a):e/(i+a),i){case t:l=(r-n)/e+(r<n?6:0);break;case r:l=(n-t)/e+2;break;case n:l=(t-r)/e+4;break;default:l=0}l/=6}return[360*l,100*u,100*s,o]}(f.fromString(t.evaluate(e)))],hsl:[{kind:"color"},[{kind:"number"},{kind:"number"},{kind:"number"}],Cn],hsla:[{kind:"color"},[{kind:"number"},{kind:"number"},{kind:"number"},{kind:"number"}],Cn],"image-config":[{kind:"value"},[{kind:"string"},{kind:"value"}],(e,[t,r])=>t.evaluate(e)],"measure-light":[{kind:"number"},[{kind:"value"}],()=>1],config:[{kind:"value"},[{kind:"string"}],(e,[t])=>{const r=Tn[t.evaluate(e)];return void 0===r?{}:r}]});const On="https://api.mapbox.com";function Pn(e){const t="mapbox://";return 0!==e.indexOf(t)?"":e.slice(9)}function In(e,t,r){const n=Pn(e);if(!n)return decodeURI(new URL(e,r).href);const o="sprites/";if(0!==n.indexOf(o))throw new Error(`unexpected sprites url: ${e}`);const i=n.slice(8);return`${On}/styles/v1/${i}/sprite?access_token=${t}`}function Rn(e,t){const r=Pn(e);if(!r)return decodeURI(new URL(e,location.href).href);const n="styles/";if(0!==r.indexOf(n))throw new Error(`unexpected style url: ${e}`);const o=r.slice(7);return`${On}/styles/v1/${o}?&access_token=${t}`}const Fn=["a","b","c","d"];function Ln(e,t,r,n){const o=new URL(e,n||location.href),i=Pn(e);if(!i)return t?(o.searchParams.has(r)||o.searchParams.set(r,t),[decodeURI(o.href)]):[decodeURI(o.href)];if("mapbox.satellite"===i){const e=window.devicePixelRatio>=1.5?"@2x":"";return[`https://api.mapbox.com/v4/${i}/{z}/{x}/{y}${e}.webp?access_token=${t}`]}return Fn.map(e=>`https://${e}.tiles.mapbox.com/v4/${i}/{z}/{x}/{y}.vector.pbf?access_token=${t}`)}const Dn=Object.freeze({}),Un={},Gn={};let Vn=0;function Jn(e){return e.id||(e.id=Vn++),e.id}function Wn(e,t){return Jn(e)+"."+g.getUid(t)}function Zn(e){let t=Un[e.id];return t||(t={},Un[Jn(e)]=t),t}function Bn(e){let t=Gn[e.id];return t||(t={},Gn[Jn(e)]=t),t}function Hn(e){return e*Math.PI/180}const Xn=function(){const e=[];for(let t=78271.51696402048;e.length<=24;t/=2)e.push(t);return e}();function Kn(e,t){if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(e,t);const r=document.createElement("canvas");return r.width=e,r.height=t,r}function Yn(e,t){let r=0;const n=t.length;for(;r<n;++r){if(t[r]<e&&r+1<n){const n=t[r]/t[r+1];return r+Math.log(t[r]/e)/Math.log(n)}}return n-1}function Qn(e,t){const r=Math.floor(e),n=Math.pow(2,e-r);return t[r]/n}const eo={};function to(e,t,r={},n){if(t in eo)return n&&(n.url=eo[t][0].url),eo[t][1];const i=r.transformRequest&&r.transformRequest(t,e)||t,a=function(e){return delete eo[t],Promise.reject(new Error("Error fetching source "+t))},s=function(e){return delete eo[t],e.ok?e.json():Promise.reject(new Error("Error fetching source "+t))},l=o.toPromise(()=>i).then(e=>e instanceof Response?(n&&(n.url=e.url),s(e)):(e instanceof Request||(e=new Request(e)),e.headers.get("Accept")||e.headers.set("Accept","application/json"),n&&(n.url=e.url),fetch(e).then(s).catch(a))).catch(a);return eo[t]=[i,l],l}function ro(e,t){if("string"!=typeof e)return Promise.resolve(e);if(!e.trim().startsWith("{"))return to("Style",e=Rn(e,t.accessToken),t);try{const t=JSON.parse(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}const no={};function oo(e,t,r={}){const n=[t,JSON.stringify(e)].toString();let i=no[n];if(!i||r.transformRequest){let a;r.transformRequest&&(a=(e,t)=>{const n=r.transformRequest&&r.transformRequest(t,"Tiles")||t;if(e instanceof y.VectorTile)e.setLoader((t,r,i)=>{const a=function(r){r.arrayBuffer().then(r=>{const n=e.getFormat().readFeatures(r,{extent:t,featureProjection:i});e.setFeatures(n)})};o.toPromise(()=>n).then(t=>{if(t instanceof Response)return a(t);fetch(t).then(a).catch(t=>e.setState(h.ERROR))}).catch(t=>e.setState(h.ERROR))});else{const t=e.getImage();o.toPromise(()=>n).then(r=>{if("string"==typeof r)return void(t.src=r);const n=e=>e.blob().then(e=>{const r=URL.createObjectURL(e);t.addEventListener("load",()=>URL.revokeObjectURL(r)),t.addEventListener("error",()=>URL.revokeObjectURL(r)),t.src=r});if(r instanceof Response)return n(r);fetch(r).then(n).catch(t=>e.setState(h.ERROR))}).catch(t=>e.setState(h.ERROR))}});const s=e.url;if(s&&!e.tiles){const n=Ln(s,r.accessToken,r.accessTokenParam||"access_token",t||location.href);if(s.startsWith("mapbox://"))i=Promise.resolve({tileJson:Object.assign({},e,{url:void 0,tiles:n}),tileLoadFunction:a});else{const e={};i=to("Source",n[0],r,e).then(function(t){return t.tiles=t.tiles.map(function(n){return"tms"===t.scheme&&(n=n.replace("{y}","{-y}")),Ln(n,r.accessToken,r.accessTokenParam||"access_token",e.url)[0]}),Promise.resolve({tileJson:t,tileLoadFunction:a})})}}else e.tiles?(e=Object.assign({},e,{tiles:e.tiles.map(function(n){return"tms"===e.scheme&&(n=n.replace("{y}","{-y}")),Ln(n,r.accessToken,r.accessTokenParam||"access_token",t||location.href)[0]})}),i=Promise.resolve({tileJson:Object.assign({},e),tileLoadFunction:a})):i=Promise.reject(new Error("source has no `tiles` nor `url`"));no[n]=i}return i}function io(e,t,r,n){const o=[2*r*t.pixelRatio+t.width,2*r*t.pixelRatio+t.height],i=Kn(o[0],o[1]),a=i.getContext("2d");a.drawImage(e,t.x,t.y,t.width,t.height,r*t.pixelRatio,r*t.pixelRatio,t.width,t.height);const s=a.getImageData(0,0,o[0],o[1]);a.globalCompositeOperation="destination-over",a.fillStyle=`rgba(${255*n.r},${255*n.g},${255*n.b},${n.a})`;const l=s.data;for(let e=0,n=s.width;e<n;++e)for(let o=0,i=s.height;o<i;++o){l[4*(o*n+e)+3]>0&&a.arc(e,o,r*t.pixelRatio,0,2*Math.PI)}return a.fill(),i}function ao(e,t,r){const n=Math.max(0,Math.min(1,(r-e)/(t-e)));return n*n*(3-2*n)}function so(e,t,r){const n=Kn(t.width,t.height),o=n.getContext("2d");o.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);const i=o.getImageData(0,0,t.width,t.height),a=i.data;for(let e=0,t=i.width;e<t;++e)for(let n=0,o=i.height;n<o;++n){const o=4*(n*t+e),i=.75,s=.1,l=ao(i-s,i+s,a[o+3]/255);l>0?(a[o+0]=Math.round(255*r.r*l),a[o+1]=Math.round(255*r.g*l),a[o+2]=Math.round(255*r.b*l),a[o+3]=Math.round(255*l)):a[o+3]=0}return o.putImageData(i,0,0),n}const lo=Array(256).join("");function uo(e,t){if(t>=.05){let r="";const n=e.split("\n"),o=lo.slice(0,Math.round(t/.1));for(let e=0,t=n.length;e<t;++e)e>0&&(r+="\n"),r+=n[e].split("").join(o);return r}return e}let po;function co(){return po||(po=Kn(1,1).getContext("2d")),po}function fo(e,t){if(/\d+ \d+/.test(e)){const[r,n]=e.split(" ").map(Number);return r<=t&&t<=n}return e==t}function mo(e,t){return co().measureText(e).width+(e.length-1)*t}const yo={};function ho(e,t,r,n){if(-1!==e.indexOf("\n")){const o=e.split("\n"),i=[];for(let e=0,a=o.length;e<a;++e)i.push(ho(o[e],t,r,n));return i.join("\n")}const o=r+","+t+","+e+","+n;let i=yo[o];if(!i){const a=e.split(" ");if(a.length>1){const e=co();e.font=t;const o=e.measureText("M").width*r;let s="";const l=[];for(let e=0,t=a.length;e<t;++e){const t=a[e],r=s+(s?" ":"")+t;mo(r,n)<=o?s=r:(s&&l.push(s),s=t)}s&&l.push(s);for(let e=0,t=l.length;e<t&&t>1;++e){const r=l[e];if(mo(r,n)<.35*o){const o=e>0?mo(l[e-1],n):1/0,i=e<t-1?mo(l[e+1],n):1/0;l.splice(e,1),t-=1,o<i?(l[e-1]+=" "+r,e-=1):l[e]=r+" "+l[e]}}for(let e=0,t=l.length-1;e<t;++e){const r=l[e],i=l[e+1];if(mo(r,n)>.7*o&&mo(i,n)<.6*o){const a=r.split(" "),s=a.pop();mo(s,n)<.2*o&&(l[e]=a.join(" "),l[e+1]=s+" "+i),t-=1}}i=l.join("\n")}else i=e;i=uo(i,n),yo[o]=i}return i}m.checkedFonts.on("propertychange",()=>{for(const e in yo)delete yo[e]});const go=["Arial","Courier New","Times New Roman","Verdana","sans-serif","serif","monospace","cursive","fantasy"],bo={};const vo={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},xo={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},wo=function(e,t){let r=tn(e,t);if("error"===r.result){const n=_n(e);n!==e&&(r=tn(n,t))}if("error"===r.result){const n=r.value[0];return console.error("Error parsing expression:",e,n.key,n.message),{evaluate:()=>t.default}}return r.value};let ko,So;function zo(e,t,r,n,o,i){const a=e.id;o||(o={},console.warn("No functionCache provided to getValue()")),o[a]||(o[a]={});const s=o[a];if(!s[r]){let n=(e[t]||Dn)[r];const o=Mn[`${t}_${e.type}`]&&Mn[`${t}_${e.type}`][r];void 0===n&&o&&(n=o.default);let i=Kr(n);if(!i&&Hr(n)&&(n=gn(n,o),i=!0),i){const e=wo(n,o);s[r]=e.evaluate.bind(e)}else{const e=o?o.type:typeof n;"color"!==e&&"colorArray"!==e||(n=Re.parse(n));let t=!1;if("array"===e)for(let e=0;e<n.length;++e){const r=n[e];if(Kr(r)||Hr(r)){t=!0;break}}if(t){const e=Object.assign({},o,{type:o.value}),t=[];for(let r=0;r<n.length;++r){let o=n[r];if(!Kr(o)&&Hr(o)&&(o=gn(o,e)),Kr(o)){const r=wo(o,e);t.push(r.evaluate.bind(r))}else t.push(function(){return o})}s[r]=function(e,r,n){const o=[];for(let i=0;i<t.length;++i)o[i]=t[i](e,r,n);return o}}else s[r]=function(){return n}}}return s[r](Nn,n,i)}function Mo(e,t,r,n){if(!zo(e,"layout",`${r}-allow-overlap`,t,n))return"declutter";return zo(e,"layout",`${r}-ignore-placement`,t,n)?"none":"obstacle"}function jo(e,t,r,n){if(n||console.warn("No filterCache provided to evaluateFilter()"),!(e in n))try{n[e]=ln(t).filter}catch(t){console.warn("Filter will evaluate to false: "+t.message),n[e]=function(){return!1}}return n[e](Nn,r)}let Ao=!1;function Eo(e,t){if(e){if(!Ao&&(0===e.a||0===t))return;const r=e.a;return t=void 0===t?1:t,0===r?"transparent":"rgba("+Math.round(255*e.r/r)+","+Math.round(255*e.g/r)+","+Math.round(255*e.b/r)+","+r*t+")"}return e}const $o=/\{[^{}}]*\}/g;function qo(e,t){return e.replace($o,function(e){return t[e.slice(1,-1)]||""})}function Co(e,t){let r=e.split(":")[0];return r===e&&(r="default"),t[r]}let _o=!1;const To={};function No(e,f,d,m=Xn,y=void 0,h=void 0,g=void 0,b=void 0){if("string"==typeof f&&(f=JSON.parse(f)),f.schema)for(const e in f.schema){const t=f.schema[e];"default"in t&&(Tn[e]=t.default)}if(8!=f.version)throw new Error("glStyle version 8 required.");To[Wn(f,e)]=Array.from(arguments);const v={};("string"==typeof h||h instanceof Request||h instanceof Response||h instanceof Promise)&&(h={default:h});for(const t in h){const r=h[t];o.toPromise(()=>r).then(async r=>{let n;if("undefined"!=typeof Image){const o=new Image;if("string"==typeof r)o.crossOrigin="anonymous",o.src=r;else{let e;r instanceof Request?e=await fetch(r):r instanceof Response&&(e=r);const t=await e.blob();n=URL.createObjectURL(t),o.src=n}o.addEventListener("load",function r(){o.removeEventListener("load",r),v[t]={image:o,size:[o.width,o.height]},e.changed(),n&&URL.revokeObjectURL(n)}),o.addEventListener("error",function e(){URL.revokeObjectURL(n),o.removeEventListener("error",e)})}else if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){const e=self;e.postMessage({action:"loadImage",src:r}),e.addEventListener("message",function(e){"imageLoaded"===e.data.action&&e.data.src===r&&(v[t]={image:e.data.image,size:[e.data.image.width,e.data.image.height]})})}})}const x=U(f.layers),w={},k=[],S={},z={},M=Zn(f),j=Bn(f);let A;for(let e=0,t=x.length;e<t;++e){const t=x[e],r=t.id;if("string"==typeof d&&t.source==d||Array.isArray(d)&&-1!==d.indexOf(r)){const n=t["source-layer"];if(A){if(t.source!==A)throw new Error(`Layer "${r}" does not use source "${A}`)}else{A=t.source;const e=f.sources[A];if(!e)throw new Error(`Source "${A}" is not defined`);const r=e.type;if("vector"!==r&&"geojson"!==r)throw new Error(`Source "${A}" is not of type "vector" or "geojson", but "${r}"`)}let o=w[n];o||(o=[],w[n]=o),o.push({layer:t,index:e}),k.push(r)}}const E=new u,$=new s,q=[],C=function(o,d,h){const x=e.getSource?.()?.format_?.layerName_??"mvt:layer",k=o.getProperties(),A=w[k[x]];if(!A)return;let C=m.indexOf(d);-1==C&&(C=Yn(d,m)),Nn.zoom=C,Nn.distanceFromCenter=0;const _=o.getGeometry(),T=vo[_.getType()],N=e.get("map");if(N&&N instanceof t&&1===T){const e=N.getSize();if(e){const t=N.getView().getCenter(),o=n.getCenter(_.getExtent());Nn.distanceFromCenter=r.distance(t,o)/d/e[1]}}const O={id:o.getId(),properties:k,type:T},P=e.get("mapbox-featurestate")[o.getId()];let I,R=-1;for(let t=0,r=A.length;t<r;++t){const r=A[t],n=r.layer,m=n.id;if(void 0!==h&&h!==m)continue;const x=n.layout||Dn,w=n.paint||Dn;if("none"===zo(n,"layout","visibility",O,M,P)||"minzoom"in n&&C<n.minzoom||"maxzoom"in n&&C>=n.maxzoom)continue;const _=n.filter;if(!_||jo(m,_,O,j)){let t,m,h,j,A,C;I=n;const _=r.index;if(3==T&&("fill"==n.type||"fill-extrusion"==n.type))if(m=zo(n,"paint",n.type+"-opacity",O,M,P),n.type+"-pattern"in w){const e=zo(n,"paint",n.type+"-pattern",O,M,P);if(e){const t="string"==typeof e?qo(e,k):e.toString(),r=Co(t,v);if(y&&y[t]&&r){++R,C=q[R],C&&C.getFill()&&!C.getStroke()&&!C.getText()||(C=new p({fill:new s}),q[R]=C),h=C.getFill(),C.setZIndex(_);const e=t+"."+m;let n=z[e];if(!n){const o=y[t],i=Kn(o.width,o.height),a=i.getContext("2d");a.globalAlpha=m,a.drawImage(r.image,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n=a.createPattern(i,"repeat"),z[e]=n}h.setColor(n)}}}else if(t=Eo(zo(n,"paint",n.type+"-color",O,M,P),m),n.type+"-outline-color"in w&&(A=Eo(zo(n,"paint",n.type+"-outline-color",O,M,P),m)),A||(A=t),t||A){if(++R,C=q[R],(!C||t&&!C.getFill()||!t&&C.getFill()||A&&!C.getStroke()||!A&&C.getStroke()||C.getText())&&(C=new p({fill:t?new s:void 0,stroke:A?new u:void 0}),q[R]=C),t&&(h=C.getFill(),h.setColor(t)),"fill-extrusion"===n.type){const e=zo(n,"paint","fill-extrusion-height",O,M,P);if(e>0){const t=Math.max(.1,.9-Math.min(e,225)/280);if(A&&"transparent"!==A){const e=Re.parse(A);A=`rgba(${Math.round(255*e.r*t)},${Math.round(255*e.g*t)},${Math.round(255*e.b*t)},${e.a})`}}}A&&(j=C.getStroke(),j.setColor(A),j.setWidth(.5)),C.setZIndex(_)}if(1!=T&&"line"==n.type){t="line-pattern"in w?void 0:Eo(zo(n,"paint","line-color",O,M,P),zo(n,"paint","line-opacity",O,M,P));const e=zo(n,"paint","line-width",O,M,P);t&&e>0&&(++R,C=q[R],C&&C.getStroke()&&!C.getFill()&&!C.getText()||(C=new p({stroke:new u}),q[R]=C),j=C.getStroke(),j.setLineCap(zo(n,"layout","line-cap",O,M,P)),j.setLineJoin(zo(n,"layout","line-join",O,M,P)),j.setMiterLimit(zo(n,"layout","line-miter-limit",O,M,P)),j.setColor(t),j.setWidth(e),j.setLineDash(w["line-dasharray"]?zo(n,"paint","line-dasharray",O,M,P).map(function(t){return t*e}):null),C.setZIndex(_))}let N,F,L,D,U,G,V,J,W,Z=!1,B=null,H=0;if((1==T||2==T)&&"icon-image"in x){const t=zo(n,"layout","icon-image",O,M,P);if(t){let r;N="string"==typeof t?qo(t,k):t.toString();const a=b?b(e,N):void 0,s=Co(N,v);if(y&&y[N]&&s||a){const e=zo(n,"layout","icon-rotation-alignment",O,M,P);if(2==T){const t=o.getGeometry();if(t.getFlatMidpoint||t.getFlatMidpoints){const o=t.getExtent();if(Math.sqrt(Math.max(Math.pow((o[2]-o[0])/d,2),Math.pow((o[3]-o[1])/d,2)))>150){const o="MultiLineString"===t.getType()?t.getFlatMidpoints():t.getFlatMidpoint();So||(ko=[NaN,NaN],So=new i("Point",ko,[],2,{},void 0)),r=So,ko[0]=o[0],ko[1]=o[1];if("line"===zo(n,"layout","symbol-placement",O,M,P)&&"map"===e){const e=t.getStride(),r=t.getFlatCoordinates();for(let t=0,n=r.length-e;t<n;t+=e){const n=r[t],i=r[t+1],a=r[t+e],s=r[t+e+1],l=Math.min(n,a),u=Math.max(n,a),p=o[0],c=(s-i)*(p-n)-(a-n)*(o[1]-i);if(Math.abs(c)<.001&&p<=u&&p>=l){H=Math.atan2(i-s,a-n);break}}}}}}if(2!==T||r){const t=zo(n,"layout","icon-size",O,M,P),o=void 0!==w["icon-color"]?zo(n,"paint","icon-color",O,M,P):null;if(!o||0!==o.a){const r=zo(n,"paint","icon-halo-color",O,M,P),i=zo(n,"paint","icon-halo-width",O,M,P);let u=`${N}.${t}.${i}.${r}`;if(null!==o&&(u+=`.${o}`),F=S[u],!F){const p=Mo(n,O,"icon",M);let c;"icon-offset"in x&&(c=zo(n,"layout","icon-offset",O,M,P).slice(0),c[0]*=t,c[1]*=-t);let f=o?[255*o.r,255*o.g,255*o.b,o.a]:void 0;if(a){const r={color:f,rotateWithView:"map"===e,displacement:c,declutterMode:p,scale:t};"string"==typeof a?r.src=a:(r.img=a,r.imgSize=[a.width,a.height]),F=new l(r)}else{const n=y[N];let a,u,d;if(i)n.sdf?(a=io(so(s.image,n,o||[0,0,0,1]),{x:0,y:0,width:n.width,height:n.height,pixelRatio:n.pixelRatio},i,r),f=void 0):a=io(s.image,n,i,r);else{if(n.sdf&&!s.unSDFed){const e=so(s.image,{x:0,y:0,width:s.size[0],height:s.size[1]},{r:1,g:1,b:1});s.image=e,s.unSDFed=!0}a=s.image,u=[n.width,n.height],d=[n.x,n.y]}F=new l({color:f,img:a,imgSize:s.size,size:u,offset:d,rotateWithView:"map"===e,scale:t/n.pixelRatio,displacement:c,declutterMode:p})}S[u]=F}}F&&(++R,C=q[R],C&&C.getImage()&&!C.getFill()&&!C.getStroke()||(C=new p,q[R]=C),C.setGeometry(r),F.setRotation(H+Hn(zo(n,"layout","icon-rotate",O,M,P))),F.setOpacity(zo(n,"paint","icon-opacity",O,M,P)),F.setAnchor(xo[zo(n,"layout","icon-anchor",O,M,P)]),C.setImage(F),B=C.getText(),C.setText(void 0),C.setZIndex(_),Z=!0,L=!1)}else L=!0}}}if(1==T&&"circle"===n.type){++R,C=q[R],C&&C.getImage()&&!C.getFill()&&!C.getStroke()||(C=new p,q[R]=C);const e="circle-radius"in w?zo(n,"paint","circle-radius",O,M,P):5,t=Eo(zo(n,"paint","circle-stroke-color",O,M,P),zo(n,"paint","circle-stroke-opacity",O,M,P)),r=zo(n,"paint","circle-translate",O,M,P),o=Eo(zo(n,"paint","circle-color",O,M,P),zo(n,"paint","circle-opacity",O,M,P)),i=zo(n,"paint","circle-stroke-width",O,M,P),l=e+"."+t+"."+o+"."+i+"."+r[0]+"."+r[1];F=S[l],F||(F=new a({radius:e,displacement:[r[0],-r[1]],stroke:t&&i>0?new u({width:i,color:t}):void 0,fill:o?new s({color:o}):void 0,declutterMode:"none"}),S[l]=F),C.setImage(F),B=C.getText(),C.setText(void 0),C.setGeometry(void 0),C.setZIndex(_),Z=!0}if("text-field"in x){V=Math.round(zo(n,"layout","text-size",O,M,P));const e=zo(n,"layout","text-font",O,M,P);G=zo(n,"layout","text-line-height",O,M,P),U=qn(g?g(e,f.metadata?f.metadata["ol:webfonts"]:void 0):e,V,G),U.includes("sans-serif")||(U+=",sans-serif"),J=zo(n,"layout","text-letter-spacing",O,M,P),W=zo(n,"layout","text-max-width",O,M,P);const t=zo(n,"layout","text-field",O,M,P);D="object"==typeof t&&t.sections?1===t.sections.length?t.toString():t.sections.reduce((t,r,n)=>{const o=r.fontStack?r.fontStack.split(","):e,i=qn(g?g(o):o,V*(r.scale||1),G);let a=r.text;if("\n"===a)return t.push("\n",""),t;if(2==T)return t.push(uo(a,J),i),t;a=ho(a,i,W,J).split("\n");for(let e=0,r=a.length;e<r;++e)e>0&&t.push("\n",""),t.push(a[e],i);return t},[]):qo(t,k).trim(),m=zo(n,"paint","text-opacity",O,M,P)}if(D&&m&&!L){Z||(++R,C=q[R],C&&C.getText()&&!C.getFill()&&!C.getStroke()||(C=new p,q[R]=C),C.setImage(void 0),C.setGeometry(void 0));const e=Mo(n,O,"text",M);C.getText()||C.setText(B),B=C.getText(),(!B||"getDeclutterMode"in B&&B.getDeclutterMode()!==e)&&(B=new c({padding:[2,2,2,2],declutterMode:e}),C.setText(B));const t=zo(n,"layout","text-transform",O,M,P);"uppercase"==t?D=Array.isArray(D)?D.map((e,t)=>t%2?e:e.toUpperCase()):D.toUpperCase():"lowercase"==t&&(D=Array.isArray(D)?D.map((e,t)=>t%2?e:e.toLowerCase()):D.toLowerCase());const r=Array.isArray(D)?D:2==T?uo(D,J):ho(D,U,W,J);if(B.setText(r),B.setFont(U),B.setRotation(Hn(zo(n,"layout","text-rotate",O,M,P))),"function"==typeof B.setKeepUpright){const e=zo(n,"layout","text-keep-upright",O,M,P);B.setKeepUpright(e)}const o=zo(n,"layout","text-anchor",O,M,P),i=Z||1==T?"point":zo(n,"layout","symbol-placement",O,M,P);let a;if("line-center"===i?(B.setPlacement("line"),a="center"):B.setPlacement(i),"line"===i&&"function"==typeof B.setRepeat){const e=zo(n,"layout","symbol-spacing",O,M,P);B.setRepeat(2*e)}B.setOverflow("point"===i);let s=zo(n,"paint","text-halo-width",O,M,P);const l=zo(n,"layout","text-offset",O,M,P),u=zo(n,"paint","text-translate",O,M,P);let f=0,d=0;if("point"==i){a="center",-1!==o.indexOf("left")?(a="left",d=s):-1!==o.indexOf("right")&&(a="right",d=-s);const e=zo(n,"layout","text-rotation-alignment",O,M,P);B.setRotateWithView("map"==e)}else B.setMaxAngle(Hn(zo(n,"layout","text-max-angle",O,M,P))*D.length/r.length),B.setRotateWithView(!1);B.setTextAlign(a);let y="middle";0==o.indexOf("bottom")?(y="bottom",f=-s-.5*(G-1)*V):0==o.indexOf("top")&&(y="top",f=s+.5*(G-1)*V),B.setTextBaseline(y);const h=zo(n,"layout","text-justify",O,M,P);B.setJustify("auto"===h?void 0:h),B.setOffsetX(l[0]*V+d+u[0]),B.setOffsetY(l[1]*V+f+u[1]),$.setColor(Eo(zo(n,"paint","text-color",O,M,P),m)),B.setFill($);const g=Eo(zo(n,"paint","text-halo-color",O,M,P),m);if(g&&s>0){E.setColor(g),s*=2;const e=.5*V;E.setWidth(s<=e?s:e),B.setStroke(E)}else B.setStroke(void 0);const b=zo(n,"layout","text-padding",O,M,P),v=B.getPadding();b!==v[0]&&(v[0]=b,v[1]=b,v[2]=b,v[3]=b),C.setZIndex(_)}}}return R>-1?(q.length=R+1,_o&&("set"in o?o.set("mapbox-layer",I):o.getProperties()["mapbox-layer"]=I),q):void 0};return e.setStyle(C),e.set("mapbox-layers",k),e.set("mapbox-source",A),e.set("mapbox-featurestate",e.get("mapbox-featurestate")||{}),C}function Oo(e,t){const r=e[0],n=r.width,o=r.height,i=r.data,a=new Uint8ClampedArray(i.length),s=2*t.resolution,l=n-1,u=o-1,p=[0,0,0,0],c=Math.PI,f=t.sunAz*c/180+c,d=t.shadowColor,m=t.highlightColor,y=t.accentColor,h=t.encoding,g=t.exaggeration;let b,v,x,w,k,S,z,M,j,A,E,$,q,C,_,T,N,O,P,I,R,F,L,D,U,G,V;function J(e,t="mapbox"){return"mapbox"===t?.1*(256*e[0]*256+256*e[1]+e[2])-1e4:"terrarium"===t?256*e[0]+e[1]+e[2]/256-32768:0}function W(e,t){return 0!==e?Math.atan2(t,-e):c/2*(t>0?1:-1)}for(v=0;v<=u;++v)for(k=0===v?0:v-1,S=v===u?u:v+1,b=0;b<=l;++b){x=0===b?0:b-1,w=b===l?l:b+1,z=4*(v*n+x),p[0]=i[z],p[1]=i[z+1],p[2]=i[z+2],p[3]=i[z+3],M=J(p,h),z=4*(v*n+w),p[0]=i[z],p[1]=i[z+1],p[2]=i[z+2],p[3]=i[z+3],j=J(p,h),A=(j-M)/s,z=4*(k*n+b),p[0]=i[z],p[1]=i[z+1],p[2]=i[z+2],p[3]=i[z+3],M=J(p,h),z=4*(S*n+b),p[0]=i[z],p[1]=i[z+1],p[2]=i[z+2],p[3]=i[z+3],j=J(p,h),E=(j-M)/s,$=Math.atan(.625*Math.sqrt(A*A+E*E)),q=W(A,E),C=1.875-1.75*g;const e=.5*c;_=.5!==g?(Math.pow(C,$)-1)/(Math.pow(C,e)-1)*e:$,T=Math.cos(_);const t=Math.min(Math.max(2*g,0),1);O=(1-T)*t,D=y.r*O,U=y.g*O,G=y.b*O,V=y.a*O;let r=(q+f)/c+.5;r%=2,r<0&&(r+=2),N=Math.abs(r-1),P=Math.sin(_)*t,I=(d.r*(1-N)+m.r*N)*P,R=(d.g*(1-N)+m.g*N)*P,F=(d.b*(1-N)+m.b*N)*P,L=(d.a*(1-N)+m.a*N)*P;const o=D*(1-L)+I,u=U*(1-L)+R,Z=G*(1-L)+F,B=V*(1-L)+L;z=4*(v*n+b),a[z]=255*o,a[z+1]=255*u,a[z+2]=255*Z,a[z+3]=255*B}return new ImageData(a,n,o)}function Po(e,t){const r=e[0],n=r.width,o=r.height,i=r.data,a=new Uint8ClampedArray(i.length),s=n-1,l=o-1,u=[0,0,0,0];let p,c,f;const d=(m=t.saturation)>0?1-1/(1.001-m):-m;var m;const y=(h=t.contrast)>0?1/(1-h):1+h;var h;const g=function(e){e*=Math.PI/180;const t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}(t.hueRotate),b=g,v=[g[2],g[0],g[1]],x=[g[1],g[2],g[0]],w=t.brightnessLow,k=t.brightnessHigh;for(c=0;c<=l;++c)for(p=0;p<=s;++p){f=4*(c*n+p),u[0]=i[f],u[1]=i[f+1],u[2]=i[f+2],u[3]=i[f+3];const e=u[0],t=u[1],r=u[2],o=(e,t)=>{let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r};let s=o([e,t,r],b),l=o([e,t,r],v),m=o([e,t,r],x);const h=(s+l+m)/3;s+=(h-s)*d,l+=(h-l)*d,m+=(h-m)*d,s=(s-.5)*y+.5,l=(l-.5)*y+.5,m=(m-.5)*y+.5,s=w*(255-s)+k*s,l=w*(255-l)+k*l,m=w*(255-m)+k*m,a[f]=s,a[f+1]=l,a[f+2]=m,a[f+3]=u[3]}return new ImageData(a,n,o)}const Io=["background","circle","fill","fill-extrusion","line","symbol","raster","hillshade"];function Ro(e,t=512){return e.getExtent()?P.createXYZ({extent:e.getExtent(),tileSize:t,maxZoom:22}).getResolutions():Xn}function Fo(e,t){if(!t.accessToken){t=Object.assign({},t);new URL(e).searchParams.forEach((e,r)=>{t.accessToken=e,t.accessTokenParam=r})}return t}function Lo(e,t,r="",n={},o=void 0){let i,a,s,l,u=!0;return"string"==typeof r||Array.isArray(r)?l=r:(s=r,l=s.source||s.layers,n=s),"string"==typeof n?(i=n,s={}):(i=n.styleUrl,s=n),!1===s.updateSource&&(u=!1),o||(o=s.resolutions),i||"string"!=typeof t||t.trim().startsWith("{")||(i=t),i&&(i=i.startsWith("data:")?location.href:Rn(i,s.accessToken),s=Fo(i,s)),new Promise(function(r,n){ro(t,s).then(function(t){if(8!=t.version)return n(new Error("glStyle version 8 required."));if(!(e instanceof M||e instanceof j))return n(new Error("Can only apply to VectorLayer or VectorTileLayer"));const p=e instanceof j?"vector":"geojson";if(l?a=Array.isArray(l)?t.layers.find(function(e){return e.id===l[0]}).source:l:(a=t.layers.find(function(e){return e.source&&t.sources[e.source].type===p}).source,l=a),!a)return n(new Error(`No ${p} source found in the glStyle.`));function c(){if(!u)return Promise.resolve();if(e instanceof j)return Wo(t.sources[a],i,s).then(function(t){const r=e.getSource();r?t!==r&&(r.setTileUrlFunction(t.getTileUrlFunction()),"function"==typeof r.setUrls&&"function"==typeof t.getUrls&&r.setUrls(t.getUrls()),r.format_||(r.format_=t.format_),r.getAttributions()||r.setAttributions(t.getAttributions()),r.getTileLoadFunction()===N.defaultLoadFunction&&r.setTileLoadFunction(t.getTileLoadFunction()),$.equivalent(r.getProjection(),t.getProjection())&&(r.tileGrid=t.getTileGrid())):e.setSource(t);const n=e.getSource().getTileGrid();!isFinite(e.getMaxResolution())&&!isFinite(e.getMinZoom())&&n.getMinZoom()>0&&e.setMaxResolution(Qn(Math.max(0,n.getMinZoom()-1e-12),n.getResolutions()))});const r=t.sources[a];let n=e.getSource();n&&n.get("mapbox-source")===r||(n=Xo(r,i,s));const o=e.getSource();return o?n!==o&&(o.getAttributions()||o.setAttributions(n.getAttributions()),o.format_||(o.format_=n.getFormat()),o.url_=n.getUrl()):e.setSource(n),Promise.resolve()}let f,m;const y={},h={};function g(){if(m||t.sprite&&!y)m?(e.setStyle(m),c().then(r).catch(n)):n(new Error("Something went wrong trying to apply style."));else{if(s.projection&&!o){const e=$.get(s.projection).getUnits();"m"!==e&&(o=Xn.map(t=>t/E.METERS_PER_UNIT[e]))}let i;const u=e.getSource();u instanceof N&&u.format_ instanceof x&&(i=u.format_.layerName_),m=No(e,t,l,o,y,h,(e,t=s.webfonts)=>function(e,t="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){if(d.WORKER_OFFSCREEN_CANVAS)return e;let r;for(let t=0,n=e.length;t<n;++t){const n=e[t];if(n in bo)continue;bo[n]=!0;const o=qn(n,16).split(" ");r||(r=[]),r.push([o.slice(3).join(" ").replace(/"/g,""),o[1],o[0]])}return r?((async()=>{await document.fonts.ready;for(let e=0,n=r.length;e<n;++e){const n=r[e],o=n[0];if(go.includes(o))continue;const i=n[1],a=n[2];if(!(await document.fonts.load(`${a} ${i} 16px "${o}"`)).some(e=>e.family.replace(/^['"]|['"]$/g,"").toLowerCase()===o.toLowerCase()&&fo(e.weight,i)&&e.style===a)){const e=t.replace("{font-family}",o.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",o.replace(/ /g,"+")).replace("{fontweight}",i).replace("{-fontstyle}",a.replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",a);if(!document.querySelector('link[href="'+e+'"]')){const t=document.createElement("link");t.href=e,t.rel="stylesheet",document.head.appendChild(t)}}}})(),e):e}(e,t),s.getImage,i),e.getStyle()?c().then(r).catch(n):n(new Error(`Nothing to show for source [${a}]`))}}if(t.sprite){const e=function(e,t,r){if("string"==typeof e)return[{id:"default",url:In(e,t,r)}];for(const n of e)n.url=In(n.url,t,r);return e}(t.sprite,s.accessToken,i||location.href);f=d.WORKER_OFFSCREEN_CANVAS?1:window.devicePixelRatio>=1.5?.5:1;const r=.5==f?"@2x":"";Promise.all(e.map(function(e){const t=new URL(e.url);let o=t.origin+t.pathname+r+".json"+t.search;return new Promise(function(e,r){to("Sprite",o,s).then(e).catch(function(n){o=t.origin+t.pathname+".json"+t.search,to("Sprite",o,s).then(e).catch(r)})}).then(function(o){let i;if(void 0===o&&n(new Error("No sprites found.")),i=t.origin+t.pathname+r+".png"+t.search,s.transformRequest){const e=s.transformRequest(i,"SpriteImage")||i;(e instanceof Request||e instanceof Promise)&&(i=e)}h[e.id]=i;for(const t in o){const r="default"==e.id?t:`${e.id}:${t}`;y[r]=o[t]}}).catch(function(e){n(new Error(`Sprites cannot be loaded: ${o}: ${e.message}`))})})).then(g).catch(n)}else g()}).catch(n)})}function Do(e,r,n={}){return ro(r,n).then(function(r){!function(e,r,n){r.layers.some(function(r){if("background"===r.type){if(e instanceof S)return e.setBackground(function(e){return Vo(r,e,n,{})}),!0;if(e instanceof t||e instanceof w)return e.getLayers().insertAt(0,Jo(r,n,{})),!0}})}(e,r,n)})}function Uo(e,t){let r;return e.some(function(e){if(e.id==t)return r=e.source,!0}),r}function Go(e,t,r){const o=new _({tileJSON:t,tileSize:e.tileSize||t.tileSize||512}),i=o.getTileJSON(),a=o.getTileGrid(),s=$.get(r.projection||"EPSG:3857"),l=function(e,t){const r=e.bounds;if(r){const e=$.fromLonLat([r[0],r[1]],t),n=$.fromLonLat([r[2],r[3]],t);return[e[0],e[1],n[0],n[1]]}return $.get(t).getExtent()}(i,s),u=s.getExtent(),p=i.minzoom||0,c=i.maxzoom||22,f={attributions:o.getAttributions(),projection:s,tileGrid:new O({origin:u?n.getTopLeft(u):a.getOrigin(0),extent:l||a.getExtent(),minZoom:p,resolutions:Ro(s,t.tileSize).slice(0,c+1),tileSize:a.getTileSize(0)})};return Array.isArray(i.tiles)?f.urls=i.tiles:f.url=i.tiles,f}function Vo(e,t,r,n){const o={id:e.id,type:e.type},i=e.paint||{};let a;o.paint=i,Nn.zoom=Yn(t,r.resolutions||Xn),Nn.distanceFromCenter=0;const s=zo(o,"paint","background-color",Dn,n);return void 0!==i["background-opacity"]&&(a=zo(o,"paint","background-opacity",Dn,n)),"none"===zo(o,"layout","visibility",Dn,n)?void 0:Eo(s,a)}function Jo(e,t,r){const n=d.WORKER_OFFSCREEN_CANVAS?{style:{}}:document.createElement("div");return n.className="ol-mapbox-style-background",n.style.position="absolute",n.style.width="100%",n.style.height="100%",new S({source:new C({}),render(o){const i=Vo(e,o.viewState.resolution,t,r);return n.style.backgroundColor=i,n}})}function Wo(e,t,r){return new Promise(function(n,o){oo(e,t,r).then(function({tileJson:t,tileLoadFunction:o}){const i=Go(e,t,r);i.tileLoadFunction=o,i.format=new x({layerName:"mvt:layer"});const a=new N(i);a.set("mapbox-source",e),n(a)}).catch(o)})}function Zo(e){return`{bbox-${(e?e.getCode():"EPSG:3857").toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}function Bo(e,t,r){return new Promise(function(n,o){oo(e,t,r).then(function({tileJson:t,tileLoadFunction:o}){const i=new _({interpolate:void 0===r.interpolate||r.interpolate,transition:0,crossOrigin:"anonymous",tileJSON:t});i.tileGrid=Go(e,t,r).tileGrid,r.projection&&(i.projection=$.get(r.projection));const a=i.getTileUrlFunction();o&&i.setTileLoadFunction(o),i.setTileUrlFunction(function(e,t,r){const n=Zo(r);let o=a(e,t,r);if(-1!=o.indexOf(n)){const t=i.getTileGrid().getTileCoordExtent(e);o=o.replace(n,t.toString())}return o}),i.set("mapbox-source",e),n(i)}).catch(function(e){o(e)})})}function Ho(e,t,r){const n=new z;return Bo(e,t,r).then(function(e){n.setSource(e)}).catch(function(){n.setSource(void 0)}),n}function Xo(e,t,r){const n=r.projection?new v({dataProjection:r.projection}):new v,o=e.data,i={};if("string"==typeof o){const[i]=Ln(o,r.accessToken,r.accessTokenParam||"access_token",t||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(i)){const t=(e,t,r)=>{const n=Zo(r);return i.replace(n,`${e.join(",")}`)},o=new T({attributions:e.attribution,format:n,loader:(e,n,i,a,s)=>{to("GeoJSON","function"==typeof t?t(e,n,i):t,r).then(e=>{const t=o.getFormat().readFeatures(e,{featureProjection:i});o.addFeatures(t),a(t)}).catch(t=>{o.removeLoadedExtent(e),s()})},strategy:A.bbox});return o.set("mapbox-source",e),o}const a=new T({attributions:e.attribution,format:n,url:i,loader:(e,t,n,o,s)=>{to("GeoJSON",i,r).then(e=>{const t=a.getFormat().readFeatures(e,{featureProjection:n});a.addFeatures(t),o(t)}).catch(t=>{a.removeLoadedExtent(e),s()})}});return a}i.features=n.readFeatures(o,{featureProjection:$.getUserProjection()||"EPSG:3857"});const a=new T(Object.assign({attributions:e.attribution,format:n},i));return a.set("mapbox-source",e),a}function Ko(e,t,r){let n=null;return function(o){e.paint&&"raster-opacity"in e.paint&&o.frameState.viewState.zoom!==n&&(n=o.frameState.viewState.zoom,delete r[e.id],function(e,t,r,n){Nn.zoom=r,Nn.distanceFromCenter=0;const o=zo(e,"paint","raster-opacity",Dn,n);t.setOpacity(o)}(e,t,n,r))}}function Yo(e,t,r,o){const i=Zn(e),a=e.layers,s=r.type;let l=r.source||Uo(a,r.ref);const u=e.sources[l];let p;if("background"==s)p=Jo(r,o,i),l=void 0;else if("vector"==u.type)p=function(e,t,r){const n=new j({declutter:!0,visible:!1});return Wo(e,t,r).then(function(e){n.setSource(e)}).catch(function(e){n.setSource(void 0)}),n}(u,t,o);else if("raster"==u.type){const e=["raster-saturation","raster-contrast","raster-brightness-max","raster-brightness-min","raster-hue-rotate"];!!Object.keys(r.paint||{}).find(t=>e.includes(t))?(p=function(e,t,r){const n=Ho(e,t,r);return new k({source:new q({operationType:"image",operation:Po,sources:[n]})})}(u,t,o),p.getSource().on("beforeoperations",function(e){Nn.zoom=Yn(e.resolution,o.resolutions||Xn),Nn.distanceFromCenter=0;const t=e.data;t.saturation=zo(r,"paint","raster-saturation",Dn,i),t.contrast=zo(r,"paint","raster-contrast",Dn,i),t.brightnessHigh=zo(r,"paint","raster-brightness-max",Dn,i),t.brightnessLow=zo(r,"paint","raster-brightness-min",Dn,i),t.hueRotate=zo(r,"paint","raster-hue-rotate",Dn,i)})):p=Ho(u,t,o),p.setVisible(!r.layout||"none"!==zo(r,"layout","visibility",Dn,i)),p.on("prerender",Ko(r,p,i))}else if("geojson"==u.type)p=function(e,t,r){return new M({declutter:!0,source:Xo(e,t,r),visible:!1})}(u,t,o);else if("raster-dem"==u.type&&"hillshade"==r.type){const e=function(e,t,r){const n=Ho(e,t,r);return new k({source:new q({operationType:"image",operation:Oo,sources:[n]})})}(u,t,o);p=e,e.getSource().on("beforeoperations",function(e){const t=e.data;t.resolution=$.getPointResolution(o.projection||"EPSG:3857",e.resolution,n.getCenter(e.extent),"m"),Nn.zoom=Yn(e.resolution,o.resolutions||Xn),Nn.distanceFromCenter=0,t.encoding=u.encoding,t.exaggeration=zo(r,"paint","hillshade-exaggeration",Dn,i),t.vert=1,t.sunAz=zo(r,"paint","hillshade-illumination-direction",Dn,i),t.highlightColor=zo(r,"paint","hillshade-highlight-color",Dn,i),t.highlightColor&&t.highlightColor.values&&(t.highlightColor=t.highlightColor.values[0]),t.shadowColor=zo(r,"paint","hillshade-shadow-color",Dn,i),t.shadowColor&&t.shadowColor.values&&(t.shadowColor=t.shadowColor.values[0]),t.accentColor=zo(r,"paint","hillshade-accent-color",Dn,i),t.accentColor&&t.accentColor.values&&(t.accentColor=t.accentColor.values[0])}),p.setVisible(!r.layout||"none"!==zo(r,"layout","visibility",Dn,i))}return p&&p.set("mapbox-source",l),p}function Qo(e,r,n,o){e.schema&&Object.assign(Tn,Object.keys(e.schema).reduce((t,r)=>(t[r]=e.schema[r]?.default,t),{}));const i=[];let a=null;if(r instanceof t){if(a=r.getView(),!a.isDef()&&!a.getRotation()&&!a.getResolutions()){const e=o.projection?$.get(o.projection):a.getProjection();a=new b(Object.assign(a.getProperties(),{maxResolution:Xn[0]/E.METERS_PER_UNIT[e.getUnits()],projection:o.projection||a.getProjection()})),r.setView(a)}"center"in e&&!a.getCenter()&&a.setCenter($.fromLonLat(e.center,a.getProjection())),"zoom"in e&&void 0===a.getZoom()&&a.setResolution(Xn[0]/E.METERS_PER_UNIT[a.getProjection().getUnits()]/Math.pow(2,e.zoom)),a.getCenter()&&void 0!==a.getZoom()||a.fit(a.getProjection().getExtent(),{nearest:!0,size:r.getSize()})}r.set("mapbox-style",e),r.set("mapbox-metadata",{styleUrl:n,options:o});const s=e.layers;let l,u,p,c=[];for(let t=0,a=s.length;t<a;++t){const a=s[t],f=a.type;Io.includes(f)?(p=a.source||Uo(s,a.ref),p&&p==u||(c.length&&(i.push(ti(l,c,e,n,r,o)),c=[]),l=Yo(e,n,a,o),l instanceof M||l instanceof j||(c=[]),u=l.get("mapbox-source")),c.push(a.id)):console.warn(`layers[${t}].type "${f}" not supported`)}return i.push(ti(l,c,e,n,r,o)),Promise.all(i)}function ei(e,r,n={}){let o,i;if(d.WORKER_OFFSCREEN_CANVAS){if(!(e instanceof t||e instanceof w))throw new Error("ol-mapbox-style in a web worker requires a Map or a LayerGroup as first argument");i=e}else i="string"==typeof e||e instanceof HTMLElement?new t({target:e}):e;if("string"==typeof r){const e=r.startsWith("data:")?location.href:Rn(r,n.accessToken);n=Fo(e,n),o=new Promise(function(t,o){ro(r,n).then(function(r){Qo(r,i,e,n).then(function(){t(i)}).catch(o)}).catch(function(e){o(new Error(`Could not load ${r}: ${e.message}`))})})}else o=new Promise(function(e,t){Qo(r,i,!n.styleUrl||n.styleUrl.startsWith("data:")?location.href:Rn(n.styleUrl,n.accessToken),n).then(function(){e(i)}).catch(t)});return o}function ti(e,t,r,n,o,i={}){let a=24,s=0;const l=r.layers;for(let e=0,r=l.length;e<r;++e){const r=l[e];-1!==t.indexOf(r.id)&&(a=Math.min("minzoom"in r?r.minzoom:0,a),s=Math.max("maxzoom"in r?r.maxzoom:24,s))}return new Promise(function(l,u){const p=function(){const p=e.getSource();if(p&&"error"!==p.getState()){if("getTileGrid"in p){const t=p.getTileGrid();if(t){const r=t.getMinZoom();(a>0||r>0)&&e.setMaxResolution(Math.min(Qn(Math.max(0,a-1e-12),Xn),Qn(Math.max(0,r-1e-12),t.getResolutions()))),s<24&&e.setMinResolution(Qn(s,Xn))}}else a>0&&e.setMaxResolution(Qn(Math.max(0,a-1e-12),Xn));p instanceof T||p instanceof N?Lo(e,r,t,Object.assign({styleUrl:n},i)).then(function(){!function(e,t,r){function n(){const n=t.get("mapbox-style");if(!n)return;const o=U(n.layers),i=e.get("mapbox-layers"),a=o.filter(function(e){return i.includes(e.id)}).some(function(e){return!e.layout||"visible"===zo(e,"layout","visibility",Dn,r)});e.get("visible")!==a&&e.setVisible(a)}e.on("change",n),n()}(e,o,Zn(r)),l()}).catch(u):l()}else u(new Error("Error accessing data for source "+e.get("mapbox-source")))};e.set("mapbox-layers",t);const c=o.getLayers();-1===c.getArray().indexOf(e)&&c.push(e),e.getSource()?p():e.once("change:source",p)})}function ri(e,t){const r=e.get("mapbox-style").layers.find(function(e){return e.id===t});return r}function ni(e,t){const r=e.getLayers().getArray();for(let e=0,n=r.length;e<n;++e){const n=r[e].get("mapbox-layers");if(n&&-1!==n.indexOf(t))return r[e]}}function oi(e,t){const r=[],n=e.getLayers().getArray();for(let e=0,o=n.length;e<o;++e)n[e].get("mapbox-source")===t&&r.push(n[e]);return r}function ii(e,t){const r=e.getLayers().getArray();for(let e=0,n=r.length;e<n;++e){const n=r[e].getSource();if(r[e].get("mapbox-source")===t)return n}}class ai extends I{constructor(e){super(R.ERROR),this.error=e}}e.MapboxVectorLayer=class extends j{constructor(e){const t=!("declutter"in e)||e.declutter,r=new N({state:"loading",format:new x({layerName:"mvt:layer"})});super({source:r,background:!1===e.background?null:e.background,declutter:t,className:e.className,opacity:e.opacity,visible:e.visible,zIndex:e.zIndex,minResolution:e.minResolution,maxResolution:e.maxResolution,minZoom:e.minZoom,maxZoom:e.maxZoom,renderOrder:e.renderOrder,renderBuffer:e.renderBuffer,renderMode:e.renderMode,map:e.map,updateWhileAnimating:e.updateWhileAnimating,updateWhileInteracting:e.updateWhileInteracting,preload:e.preload,useInterimTilesOnError:e.useInterimTilesOnError,properties:e.properties}),e.accessToken&&(this.accessToken=e.accessToken);const n=[Lo(this,e.styleUrl,e.layers||e.source,{accessToken:this.accessToken})];void 0===this.getBackground()&&n.push(Do(this,e.styleUrl,{accessToken:this.accessToken})),Promise.all(n).then(()=>{r.setState("ready")}).catch(e=>{this.dispatchEvent(new ai(e));this.getSource().setState("error")})}},e.addMapboxLayer=function(e,t,r){const n=e.get("mapbox-style"),o=n.layers;let i,a,s=-1;if(void 0!==r){const t=ri(e,r);if(void 0===t)throw new Error(`Layer with id "${r}" not found.`);i=o.indexOf(t)}else i=o.length;if(i>0&&o[i-1].source===t.source?(s=i-1,a=-1):i<o.length&&o[i].source===t.source&&(s=i,a=0),-1===s){const{options:a,styleUrl:s}=e.get("mapbox-metadata"),l=Yo(n,s,t,a);if(r){const t=ni(e,r),n=e.getLayers().getArray().indexOf(t);e.getLayers().insertAt(n,l)}return o.splice(i,0,t),ti(l,[t.id],n,s,e,a)}if(o.some(e=>e.id===t.id))throw new Error(`Layer with id "${t.id}" already exists.`);const l=o[s].id,u=To[Wn(e.get("mapbox-style"),ni(e,l))];if(o.splice(i,0,t),u){const[e,r,n,o,i,s,p,c]=u;if(Array.isArray(n)){const e=n.indexOf(l)+a;n.splice(e,0,t.id)}No(e,r,n,o,i,s,p,c)}else ni(e,o[s].id).changed();return Promise.resolve()},e.apply=ei,e.applyBackground=Do,e.applyStyle=Lo,e.default=ei,e.getFeatureState=function(e,t){const r="getLayers"in e?oi(e,t.source):[e];for(let e=0,n=r.length;e<n;++e){const n=r[e].get("mapbox-featurestate");if(n&&n[t.id])return n[t.id]}},e.getLayer=ni,e.getLayers=oi,e.getMapboxLayer=ri,e.getSource=ii,e.getStyleForLayer=function(e,t,r,n){const o=r.getStyleFunction();if(3===o.length)return o(e,t,n)},e.recordStyleLayer=function(e=!1){_o=e},e.removeMapboxLayer=function(e,t){const r="string"==typeof t?t:t.id,n=ni(e,r),o=n.get("mapbox-layers");if(1===o.length)throw new Error("Cannot remove last Mapbox layer from an OpenLayers layer.");o.splice(o.indexOf(r),1);const i=e.get("mapbox-style"),a=i.layers;a.splice(a.findIndex(e=>e.id===r),1);const s=To[Wn(i,n)];if(s){const[e,t,n,o,i,a,l,u]=s;Array.isArray(n)&&n.splice(n.findIndex(e=>e===r),1),No(e,t,n,o,i,a,l,u)}else ni(e,r).changed()},e.renderTransparent=function(e){e!==Ao&&(!function(){for(const e in Un)delete Un[e]}(),Ao=e)},e.setFeatureState=function(e,t,r){const n="getLayers"in e?oi(e,t.source):[e];for(let e=0,o=n.length;e<o;++e){const o=n[e].get("mapbox-featurestate");if(!o)throw new Error(`Map or layer for source "${t.source}" not found.`);r?o[t.id]=r:delete o[t.id],n[e].changed()}},e.styleConfig=Tn,e.stylefunction=No,e.updateMapboxLayer=function(e,t){const r=e.get("mapbox-style"),n=r.layers,o=n.findIndex(function(e){return e.id===t.id});if(-1===o)throw new Error(`Layer with id "${t.id}" not found.`);if(n[o].source!==t.source)throw new Error("Updated layer and previous version must use the same source.");delete Zn(r)[t.id],delete Bn(r)[t.id],n[o]=t;const i=To[Wn(e.get("mapbox-style"),ni(e,t.id))];if(i)return No.apply(void 0,i),Promise.resolve();const a=ni(e,t.id),{options:s,styleUrl:l}=e.get("mapbox-metadata");return ti(a,[t.id],r,l,e,s)},e.updateMapboxSource=function(e,t,r){const n=ii(e,t),o=e.getLayers().getArray().filter(function(e){return(e instanceof M||e instanceof z||e instanceof j)&&e.getSource()===n}),i=e.get("mapbox-metadata");let a;switch(r.type){case"vector":a=Wo(r,i.styleUrl,i.options);break;case"geojson":a=Promise.resolve(Xo(r,i.styleUrl,i.options));break;case"raster":case"raster-dem":a=Bo(r,i.styleUrl,i.options);break;default:return Promise.reject(new Error("Unsupported source type "+r.type))}return a.then(function(e){o.forEach(function(t){t.setSource(e)})}),a},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=olms.js.map
